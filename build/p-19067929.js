import{t as n}from"./p-b821ae32.js";import{a as e,hQ as t,bV as o,dg as r}from"./p-3013819f.js";import{t as i}from"./p-1f0b604e.js";import{e as s}from"./p-94b15954.js";const c={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function u(n){return c[n]}function*f(n){switch(n.type){case"Feature":yield n;break;case"FeatureCollection":for(const e of n.features)e&&(yield e)}}function*l(n){if(n)switch(n.type){case"Point":yield n.coordinates;break;case"LineString":case"MultiPoint":yield*n.coordinates;break;case"MultiLineString":case"Polygon":for(const e of n.coordinates)yield*e;break;case"MultiPolygon":for(const e of n.coordinates)for(const n of e)yield*n}}function*a(n,e={}){const{geometryType:t,objectIdField:o}=e;for(const r of n){const{geometry:n,properties:c,id:f}=r;if(n&&u(n.type)!==t)continue;const l=c||{};let a;o&&(a=l[o],null==f||a||(l[o]=a=f));const y=new i(n?w(new s,n,e):null,l,null,a??void 0);yield y}}function y(n){for(const e of n)if(e.length>2)return!0;return!1}function p(n){return!g(n)}function d(n){return g(n)}function g(n){let e=0;for(let t=0;t<n.length;t++){const o=n[t],r=n[(t+1)%n.length];e+=o[0]*r[1]-r[0]*o[1]}return e<=0}function m(n){const e=n[0],t=n[n.length-1];return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||n.push(e),n}function w(n,e,t){switch(e.type){case"LineString":return b(n,e,t);case"MultiLineString":return P(n,e,t);case"MultiPoint":return j(n,e,t);case"MultiPolygon":return S(n,e,t);case"Point":return F(n,e,t);case"Polygon":return G(n,e,t)}}function b(n,e,t){return k(n,e.coordinates,t),n}function P(n,e,t){for(const o of e.coordinates)k(n,o,t);return n}function j(n,e,t){return k(n,e.coordinates,t),n}function S(n,e,t){for(const o of e.coordinates){M(n,o[0],t);for(let e=1;e<o.length;e++)h(n,o[e],t)}return n}function F(n,e,t){return L(n,e.coordinates,t),n}function G(n,e,t){const o=e.coordinates;M(n,o[0],t);for(let e=1;e<o.length;e++)h(n,o[e],t);return n}function M(n,e,t){const o=m(e);p(o)?T(n,o,t):k(n,o,t)}function h(n,e,t){const o=m(e);d(o)?T(n,o,t):k(n,o,t)}function k(n,e,t){for(const o of e)L(n,o,t);n.lengths.push(e.length)}function T(n,e,t){for(let o=e.length-1;o>=0;o--)L(n,e[o],t);n.lengths.push(e.length)}function L(n,e,t){const[o,r,i]=e;n.coords.push(o,r),t.hasZ&&n.coords.push(i||0)}function O(e){switch(typeof e){case"string":return n(e)?"esriFieldTypeDate":"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function I(n,t=4326){if(!n)throw new e("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==n.type&&"FeatureCollection"!==n.type)throw new e("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:n});const{crs:o}=n;if(!o)return;const i="string"==typeof o?o:"name"===o.type?o.properties.name:"EPSG"===o.type?o.properties.code:null,s=r({wkid:t})?new RegExp(".*(CRS84H?|4326)$","i"):new RegExp(`.*(${t})$`,"i");if(!i||!s.test(i))throw new e("geojson:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:o})}function N(n,e={}){const r=[],i=new Set,s=new Set;let c,a=!1,p=null,d=!1,{geometryType:g=null}=e,m=!1;for(const e of f(n)){const{geometry:n,properties:o,id:f}=e;if(!n||(g||(g=u(n.type)),u(n.type)===g)){if(!a){a=y(l(n))}if(d||(d=null!=f,d&&(c=typeof f,o&&(p=Object.keys(o).filter((n=>o[n]===f))))),o&&p&&d&&null!=f&&(p.length>1?p=p.filter((n=>o[n]===f)):1===p.length&&(p=o[p[0]]===f?p:[])),!m&&o){let n=!0;for(const e in o){if(i.has(e))continue;const c=o[e];if(null==c){n=!1,s.add(e);continue}const u=O(c);if("unknown"===u){s.add(e);continue}s.delete(e),i.add(e);const f=t(e);f&&r.push({name:f,alias:e,type:u})}m=n}}}const w=t(1===p?.length&&p[0]||null)??void 0;if(w)for(const n of r)if(n.name===w&&o(n)){n.type="esriFieldTypeOID";break}return{fields:r,geometryType:g,hasZ:a,objectIdFieldName:w,objectIdFieldType:c,unknownFields:Array.from(s)}}function x(n,e){return Array.from(a(f(n),e))}export{I as E,N as I,x as N,u};
//# sourceMappingURL=p-19067929.js.map