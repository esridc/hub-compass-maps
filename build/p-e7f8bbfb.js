import{g7 as t,g8 as n,cB as e,f5 as o,b4 as r,aY as i,aN as s,av as l,cp as a,a as c,g9 as f,ga as u,gb as h,gc as m,gd as x,bt as M,aV as p,ge as y}from"./p-3013819f.js";var w;function d(t,n,e){return!a(t,n,e)}function g(n,e,o){const r=d(n,e,o);if(r&&!t())throw new c("rasterprojectionhelper-project","projection engine is not loaded");return r}!function(t){t[t.None=0]="None",t[t.North=1]="North",t[t.South=2]="South",t[t.Both=3]="Both"}(w||(w={}));const R=(t,n,e,o=0)=>{if(1===e[0])return[0,0];let r=1,i=-1,s=1,l=-1;for(let n=0;n<t.length;n+=2)isNaN(t[n])||(r=r>t[n]?t[n]:r,i=i>t[n]?i:t[n],s=s>t[n+1]?t[n+1]:s,l=l>t[n+1]?l:t[n+1]);const{cols:a,rows:c}=n,f=(i-r)/a/e[0],u=(l-s)/c/e[1],h=2*o;let m=0,x=!1,M=[0,0];for(let n=0;n<a-3;n++){for(let e=0;e<c-3;e++){const o=n*c*2+2*e,r=(t[o]+t[o+4]+t[o+4*c]+t[o+4*c+4])/4,i=(t[o+1]+t[o+5]+t[o+4*c+1]+t[o+4*c+5])/4,s=Math.abs((r-t[o+2*c+2])/f),l=Math.abs((i-t[o+2*c+3])/u);if(s+l>m&&(m=s+l,M=[s,l]),h&&m>h){x=!0;break}}if(x)break}return M},N={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},S=32,b=4,v=b,P=new Map,C=new Map,k=500;async function T(){t()||await n()}function z(t,n,e){g(t.spatialReference,n);return e?y(n,t.spatialReference,t):y(t.spatialReference,n,t)}function j(t,n,i,s=null){const l=t.spatialReference;if(l.equals(n))return t;g(l,n,s);const a=i.center,c=new e({xmin:a.x-t.x/2,xmax:a.x+t.x/2,ymin:a.y-t.y/2,ymax:a.y+t.y/2,spatialReference:l}),f=o(c,n,s),u=J(n);let h;if(null==f||null!=u&&f.width>=u){const e=r(l)/r(n);h={x:t.x*e,y:t.y*e}}else h={x:f.width,y:f.height};return h}function E(t,n=.01){return r(t)?n/r(t):0}function F(t,n,e=null,r=!0){const i=t.spatialReference;if(i.equals(n))return t;g(i,n,e);const s=o(t,n,e);return r&&s?(L([t],[s],i,n),s):s}function L(t,n,e,o){const r=K(e,!0),i=K(o,!0),s=E(e,k),l=E(o,k);if(s&&null!=r&&null!=i)for(let e=0;e<t.length;e++){const o=n[e];if(!o)continue;const{x:a}=t[e],{x:c}=o;c>=i[1]-l&&Math.abs(a-r[0])<s?o.x-=i[1]-i[0]:c<=i[0]+l&&Math.abs(a-r[1])<s&&(o.x+=i[1]-i[0])}}function W(t){const{inSR:n,outSR:e,datumTransformation:o,preferPE:r}=t;if(n.equals(e)){const{points:n}=G(t,null);return n}if(n.isWebMercator&&e.isWGS84||n.isWGS84&&e.isWebMercator)return I(t);if(g(n,e,o)&&r){if(n.isGeographic)return A(t);if(null!=X(n))return A(t)}return B(t)}function B(t){const{points:n}=G(t,null),{inSR:e,outSR:r,datumTransformation:i}=t,s=n.map((t=>new l(t[0],t[1],e))),a=o(s,r,i);return i&&L(s,a,e,r),a.map((t=>t?[t.x,t.y]:[NaN,NaN]))}function A(t){const{inSR:n,outSR:e,datumTransformation:o}=t,r=X(n),{points:i,mask:s}=G(t,r);if(!n.isGeographic){const t=n.wkid?f.coordsys(n.wkid):f.fromString(n.isGeographic?u.PE_TYPE_GEOGCS:u.PE_TYPE_PROJCS,n.wkt2||n.wkt);h.projToGeog(t,i.length,i)}if(null!=o&&o.steps.length){let t;const n=179.9955;if(e.isGeographic&&(t=i.map((([t])=>t>n?1:t<-n?-1:0))),o.steps.forEach((t=>{const n=t.wkid?f.geogtran(t.wkid):f.fromString(u.PE_TYPE_GEOGTRAN,t.wkt);m.geogToGeog(n,i.length,i,null,t.isInverse?u.PE_TRANSFORM_2_TO_1:u.PE_TRANSFORM_1_TO_2)})),t)for(let e=0;e<i.length;e++){const o=t[e],r=i[e][0],s=r>n?1:r<-n?-1:0;o&&s&&o!==s&&(i[e][0]=o>0?r+360:r-360)}}if(!e.isGeographic){const t=X(e,!0),n=null!=t&&t.isEnvelope?[t.bbox[1],t.bbox[3]]:[-90,90];U(i,n);const o=e.wkid?f.coordsys(e.wkid):f.fromString(e.isGeographic?u.PE_TYPE_GEOGCS:u.PE_TYPE_PROJCS,e.wkt2||e.wkt);h.geogToProj(o,i.length,i)}let l=i;if(s&&i.length!==s.length){l=[];for(let t=0,n=0;t<s.length;t++)s[t]?l.push(i[n++]):l.push([NaN,NaN])}return l}function I(t){const{cols:n,rows:e,xres:r,yres:i,usePixelCenter:s,inSR:a,outSR:c}=t;let{xmin:f,ymax:u}=t;s&&(f+=r/2,u-=i/2);const h=[],m=[],x=Math.max(n,e);for(let t=0;t<x;t++){const s=f+r*Math.min(n,t),x=u-i*Math.min(e,t),M=o(new l({x:s,y:x,spatialReference:a}),c);t<=n&&h.push(M.x),t<=e&&m.push(M.y)}const M=[];for(let t=0;t<n;t++)for(let n=0;n<e;n++)M.push([h[t],m[n]]);return M}function X(t,n=!1){let e=t.wkid||t.wkt2||t.wkt;if(!e||t.isGeographic)return null;if(e=String(e),P.has(e)){const t=P.get(e);return n?t?.gcs:t?.pcs}const o=t.wkid?f.coordsys(t.wkid):f.fromString(t.isGeographic?u.PE_TYPE_GEOGCS:u.PE_TYPE_PROJCS,t.wkt2||t.wkt),r=O(o,E(t,1e-4)),i=O(o,0,!0);return P.set(e,{pcs:r,gcs:i}),n?i:r}function O(t,n=0,e=!1){const o=x.generate(t),r=e?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!o||!r?.length)return null;let i=!1,s=r.find((t=>1===t.getInclusive()&&1===t.getKind()));if(!s){if(s=r.find((t=>1===t.getInclusive()&&0===t.getKind())),!s)return null;i=!0}const l=e?0:(2===o.getNorthPoleLocation()?1:0)|(2===o.getSouthPoleLocation()?2:0),a=o.isPannableRectangle(),c=s.getCoord();if(i)return{isEnvelope:i,isPannable:a,vertices:c,coef:null,bbox:[c[0][0]-n,c[0][1]-n,c[1][0]+n,c[1][1]+n],poleLocation:l};let f=0;const u=[];let[h,m]=c[0],[M,p]=c[0];for(let t=0,n=c.length;t<n;t++){f++,f===n&&(f=0);const[e,o]=c[t],[r,i]=c[f];if(i===o)u.push([e,r,o,i,2]);else{const t=(r-e)/(i-o||1e-4),n=e-t*o;o<i?u.push([t,n,o,i,0]):u.push([t,n,i,o,1])}h=h<e?h:e,m=m<o?m:o,M=M>e?M:e,p=p>o?p:o}return{isEnvelope:!1,isPannable:a,vertices:c,coef:u,bbox:[h,m,M,p],poleLocation:l}}function G(t,n){const e=[],{cols:o,rows:r,xres:i,yres:s,usePixelCenter:l}=t;let{xmin:a,ymax:c}=t;if(l&&(a+=i/2,c-=s/2),null==n){for(let t=0;t<o;t++)for(let n=0;n<r;n++)e.push([a+i*t,c-s*n]);return{points:e}}const f=new Uint8Array(o*r);if(n.isEnvelope){const{bbox:[t,l,u,h]}=n;for(let m=0,x=0;m<o;m++){const o=a+i*m,M=n.isPannable||o>=t&&o<=u;for(let t=0;t<r;t++,x++){const n=c-s*t;M&&n>=l&&n<=h&&(e.push([o,n]),f[x]=1)}}return{points:e,mask:f}}const u=n.coef,h=[];for(let t=0;t<r;t++){const n=c-s*t,e=[],o=[];for(let t=0;t<u.length;t++){const[r,i,s,l,a]=u[t];if(n===s&&s===l)e.push(r),e.push(i),o.push(2),o.push(2);else if(n>=s&&n<=l){const t=r*n+i;e.push(t),o.push(a)}}let r=e;if(e.length>2){let t=2===o[0]?0:o[0],n=e[0];r=[];for(let i=1;i<o.length;i++)2===o[i]&&i!==o.length-1||(o[i]!==t&&(r.push(0===t?Math.min(n,e[i-1]):Math.max(n,e[i-1])),t=o[i],n=e[i]),i===o.length-1&&r.push(0===o[i]?Math.min(n,e[i]):Math.max(n,e[i])));r.sort(((t,n)=>t-n))}else e[0]>e[1]&&(r=[e[1],e[0]]);h.push(r)}for(let t=0,n=0;t<o;t++){const o=a+i*t;for(let t=0;t<r;t++,n++){const r=c-s*t,i=h[t];if(2===i.length)o>=i[0]&&o<=i[1]&&(e.push([o,r]),f[n]=1);else if(i.length>2){let t=!1;for(let n=0;n<i.length;n+=2)if(o>=i[n]&&o<=i[n+1]){t=!0;break}t&&(e.push([o,r]),f[n]=1)}}}return{points:e,mask:f}}function U(t,n){const[e,o]=n;for(let n=0;n<t.length;n++){const r=t[n][1];(r<e||r>o)&&(t[n]=[NaN,NaN])}}function V(t,n){const o=J(t[0].spatialReference);if(t.length<2||null==o)return t[0];if(n=n??E(t[0].spatialReference),1===(t=t.filter((t=>t.width>n))).length)return t[0];let{xmin:r,xmax:i,ymin:s,ymax:l}=t[0];for(let n=1;n<t.length;n++){const e=t[n];i=e.xmax+o*n,s=Math.min(s,e.ymin),l=Math.max(l,e.ymax)}return new e({xmin:r,xmax:i,ymin:s,ymax:l,spatialReference:t[0].spatialReference})}function Y(n,o,r=null,s=!0){const l=n.spatialReference;if(l.equals(o))return n;const a=Z(n),c=J(l,!0),f=J(o);if(0===a||null==c||null==f){const e=H(n,o,r,s);if(null==c&&null!=f&&Math.abs(e.width-f)<E(o)&&t()){const t=X(l);if(null!=t&&t.poleLocation===w.None&&n.width<(t.bbox[2]-t.bbox[0])/2)return D(n,o)||e}return e}const u=n.clone().normalize();if(1===u.length&&n.xmax<c&&n.xmax-c/2>E(l)){const{xmin:t,xmax:o}=n;for(let r=0;r<=a;r++){const i=0===r?t:-c/2,s=r===a?o-c*r:c/2;u[r]=new e({xmin:i,xmax:s,ymin:n.ymin,ymax:n.ymax,spatialReference:l})}}return V(u.map((t=>H(t,o,r,s))).filter(i))}function q(t,n,e){if("extent"===t.type){const{xmin:n,ymin:e,xmax:o,ymax:r,spatialReference:i}=t;t=new s({rings:[[[n,r],[o,r],[o,e],[n,e],[n,r]]],spatialReference:i})}return t.spatialReference.equals(n)?t:(g(t.spatialReference,n,e),o(t,n,e))}function D(t,n){const r=J(n);if(null==r)return null;let{xmin:i,ymin:l,xmax:a,ymax:c}=t;const f=t.spatialReference,u=new s({spatialReference:f,rings:[[[i,l],[a,l],[a,c],[i,c],[i,l]]]}),h=o(u,n);if(2!==h.rings.length||!h.rings[0].length||!h.rings[1].length)return null;const{rings:m}=h,x=E(f),M=new e({spatialReference:n});for(let t=0;t<2;t++){i=a=m[t][0][0],l=c=m[t][0][1];for(let n=0;n<m[t].length;n++)i=i>m[t][n][0]?m[t][n][0]:i,a=a<m[t][n][0]?m[t][n][0]:a,l=l>m[t][n][1]?m[t][n][1]:l,c=c<m[t][n][1]?m[t][n][1]:c;if(0===t)M.ymin=l,M.ymax=c,M.xmin=i,M.xmax=a;else if(M.ymin=Math.min(M.ymin,l),M.ymax=Math.max(M.ymax,c),Math.abs(a-r/2)<x)M.xmin=i,M.xmax=M.xmax+r;else{if(!(Math.abs(i+r/2)<x))return null;M.xmax=a+r}}return M}function H(t,n,e=null,r=!0,i=!0){const s=t.spatialReference;if(s.equals(n)||!n)return t;g(s,n,e);const a=o(t,n,e);if(i&&n.isWebMercator&&a&&(a.ymax=Math.min(20037508.342787,a.ymax),a.ymin=Math.max(-20037508.342787,a.ymin),a.ymin>=a.ymax))return null;if(!r||!a)return a;const c=K(s,!0),f=K(n,!0);if(null==c||null==f)return a;const u=E(s,.001),h=E(s,k),m=E(n,.001);if(Math.abs(a.xmin-f[0])<m&&Math.abs(a.xmax-f[1])<m){const o=Math.abs(t.xmin-c[0]),r=Math.abs(c[1]-t.xmax);if(o<u&&r>h){a.xmin=f[0];const o=[];o.push(new l(t.xmax,t.ymin,s)),o.push(new l(t.xmax,(t.ymin+t.ymax)/2,s)),o.push(new l(t.xmax,t.ymax,s));const r=o.map((t=>F(t,n,e))).filter((t=>!isNaN(t?.x))).map((t=>t.x));a.xmax=Math.max.apply(null,r)}if(r<u&&o>h){a.xmax=f[1];const o=[];o.push(new l(t.xmin,t.ymin,s)),o.push(new l(t.xmin,(t.ymin+t.ymax)/2,s)),o.push(new l(t.xmin,t.ymax,s));const r=o.map((t=>F(t,n,e))).filter((t=>!isNaN(t?.x))).map((t=>t.x));a.xmin=Math.min.apply(null,r)}}else{const t=E(n,.001);Math.abs(a.xmin-f[0])<t&&(a.xmin=f[0]),Math.abs(a.xmax-f[1])<t&&(a.xmax=f[1])}return a}function J(t,n=!1){if(!t)return null;const e=n?20037508.342787:20037508.342788905;return t.isWebMercator?2*e:t.wkid&&t.isGeographic?360:2*N[t.wkid]||null}function K(t,n=!1){if(t.isGeographic)return[-180,180];const e=J(t,n);return null!=e?[-e/2,e/2]:null}function Q(t,n,e,o){let r=(t-n)/e;return r-Math.floor(r)!=0?r=Math.floor(r):o&&(r-=1),r}function Z(t,n=!1){const e=J(t.spatialReference);if(null==e)return 0;const o=n?0:-(e/2),r=E(t.spatialReference),i=!n&&Math.abs(t.xmax-e/2)<r?e/2:t.xmax,s=!n&&Math.abs(t.xmin+e/2)<r?-e/2:t.xmin;return Q(i,o,e,!0)-Q(s,o,e,!1)}function $(t){const n=t.storageInfo.origin.x,e=J(t.spatialReference,!0);if(null==e)return{originX:n,halfWorldWidth:null,pyramidsInfo:null};const o=e/2,{nativePixelSize:r,storageInfo:i,extent:s}=t,{maximumPyramidLevel:l,blockWidth:a,pyramidScalingFactor:c}=i;let f=r.x;const u=[],h=null!=t.transform&&"gcs-shift"===t.transform.type,m=n+(h?0:o),x=h?e-n:o-n;for(let t=0;t<=l;t++){const t=(s.xmax-n)/f/a,e=t-Math.floor(t)==0?t:Math.ceil(t),o=x/f/a,r=o-Math.floor(o)==0?o:Math.ceil(o),i=Math.floor(m/f/a),l=Math.round(m/f)%a,h=(a-Math.round(x/f)%a)%a;u.push({resolutionX:f,blockWidth:a,datasetColumnCount:e,worldColumnCountFromOrigin:r,leftMargin:l,rightPadding:h,originColumnOffset:i}),f*=c}return{originX:n,halfWorldWidth:o,pyramidsInfo:u,hasGCSSShiftTransform:h}}function _(t){if(!t||t.isGeographic)return t;const n=String(t.wkid||t.wkt2||t.wkt);let e;if(C.has(n))e=C.get(n);else{e=(t.wkid?f.coordsys(t.wkid):f.fromString(u.PE_TYPE_PROJCS,t.wkt2||t.wkt)).getGeogcs().getCode(),C.set(n,e)}return new M({wkid:e})}function tt(t){const n=t.isAdaptive&&null==t.spacing;let e=t.spacing||[S,S],o=nt(t),r={cols:o.size[0]+1,rows:o.size[1]+1};const i=o.outofBoundPointCount>0&&o.outofBoundPointCount<o.offsets.length/2;let s=o.outofBoundPointCount===o.offsets.length/2||n&&i?[0,0]:R(o.offsets,r,e,v);const l=(s[0]+s[1])/2,a=t.projectedExtent.spatialReference,c=t.srcBufferExtent.spatialReference;if(n&&(i||l>v)){d(a,c,t.datumTransformation)&&(a.isGeographic||X(a)),e=[b,b],o=nt({...t,spacing:e}),r={cols:o.size[0]+1,rows:o.size[1]+1},s=R(o.offsets,r,e,v)}if(o.error=s,e[0]>1&&(o.coefficients=et(o.offsets,r,i)),t.includeGCSGrid&&!a.isGeographic&&!a.isWebMercator)if(c.isGeographic)o.gcsGrid={offsets:o.offsets,coefficients:o.coefficients,spacing:e};else{const n=X(a);if(null!=n&&!n.isEnvelope){const n=_(a),s=Y(t.projectedExtent,n),{offsets:l}=nt({...t,srcBufferExtent:s,spacing:e}),c=et(l,r,i);o.gcsGrid={offsets:l,coefficients:c,spacing:e}}}return o}function nt(t){const{projectedExtent:n,srcBufferExtent:e,pixelSize:o,datumTransformation:r,rasterTransform:i}=t,s=n.spatialReference,a=e.spatialReference,c=g(s,a),{xmin:f,ymin:u,xmax:h,ymax:m}=n,x=J(a),M=null!=x&&(t.hasWrapAround||"gcs-shift"===i?.type),p=t.spacing||[S,S],y=p[0]*o.x,w=p[1]*o.y,d=1===p[0],R=Math.ceil((h-f)/y-.1/p[0])+(d?0:1),N=Math.ceil((m-u)/w-.1/p[1])+(d?0:1),v=W({cols:R,rows:N,xmin:f,ymax:m,xres:y,yres:w,inSR:s,outSR:a,datumTransformation:r,preferPE:p[0]<=b,usePixelCenter:d}),P=[];let C,T=0;const z=d?-1:NaN,{xmin:j,xmax:F,ymax:L,width:B,height:A}=e,I=E(a,k),O=null!=x&&j>0&&F>x/2;let G=!1;if(c){const t=X(s);G=null!=t&&t.poleLocation>0}for(let t=0;t<R;t++){const n=[];for(let e=0;e<N;e++){let o=v[t*N+e];if(M&&o[0]>F&&o[0]>x/2-I?o[0]-=x:M&&0===t&&o[0]<0&&O&&!i&&(o[0]+=x),!o||isNaN(o[0])||isNaN(o[1]))P.push(z),P.push(z),n.push(null),T++;else{if(i){const t=i.inverseTransform(new l({x:o[0],y:o[1],spatialReference:a}));o=[t.x,t.y]}n.push(o),t>0&&M&&C[e]&&o[0]<C[e][0]&&(o[0]+=x,G&&o[0]>F&&o[0]>x&&(o[0]-=x)),P.push((o[0]-j)/B),P.push((L-o[1])/A)}}C=n}return{offsets:P,error:null,coefficients:null,outofBoundPointCount:T,spacing:p,size:d?[R,N]:[R-1,N-1]}}function et(t,n,e){const{cols:o,rows:r}=n,i=new Float32Array((o-1)*(r-1)*2*6),s=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),l=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let n=0;n<o-1;n++){for(let e=0;e<r-1;e++){let a=n*r*2+2*e;const c=t[a],f=t[a+1],u=t[a+2],h=t[a+3];a+=2*r;const m=t[a],x=t[a+1],M=t[a+2],p=t[a+3];let y=0,w=12*(e*(o-1)+n);for(let t=0;t<3;t++)i[w++]=s[y++]*c+s[y++]*u+s[y++]*M;y=0;for(let t=0;t<3;t++)i[w++]=s[y++]*f+s[y++]*h+s[y++]*p;y=0;for(let t=0;t<3;t++)i[w++]=l[y++]*c+l[y++]*m+l[y++]*M;y=0;for(let t=0;t<3;t++)i[w++]=l[y++]*f+l[y++]*x+l[y++]*p}if(e)for(let t=0;t<i.length;t++)isNaN(i[t])&&(i[t]=-1)}return i}function ot(t,n){const e=t.clone().normalize();return 1===e.length?e[0]:V(e,n)}function rt(t){const{spatialReference:n}=t,o=p(n);if(!o)return t;const[r,i]=o.valid,s=i-r;let l=0;if(t.xmin<r){const n=r-t.xmin;l=Math.ceil(n/s)}else if(t.xmin>i){const n=t.xmin-i;l=-Math.ceil(n/s)}return new e({spatialReference:t.spatialReference,xmin:t.xmin+l*s,ymin:t.ymin,xmax:t.xmax+l*s,ymax:t.ymax})}function it(t,n,e){const{storageInfo:o,pixelSize:i}=n;let s=0,a=!1;const{pyramidResolutions:c}=o,f="mixed"===o.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,o.tileInfo.dpi/96)):1,u=(t.x+t.y)/2/f;if(null!=c&&c.length){const t=c[c.length-1],o=(t.x+t.y)/2,f=(i.x+i.y)/2;if(u<=f)s=0;else if(u>=o)s=c.length,a=u/o>8;else{let t,n=f;for(let o=1;o<=c.length;o++){if(t=(c[o-1].x+c[o-1].y)/2,u<=t){u===t?s=o:"down"===e?(s=o-1,a=u/n>8):s="up"===e||u-n>t-u||u/n>2?o:o-1;break}n=t}}const h=0===s?i:c[s-1];if(a){Math.min(h.x,h.y)*r(n.spatialReference)>19567&&(a=!1)}return{pyramidLevel:s,pyramidResolution:new l({x:h.x,y:h.y,spatialReference:n.spatialReference}),excessiveReading:a}}const h=Math.log(t.x/i.x)/Math.LN2,m=Math.log(t.y/i.y)/Math.LN2,x=n.storageInfo.maximumPyramidLevel||0;s="down"===e?Math.floor(Math.min(h,m)):"up"===e?Math.ceil(Math.max(h,m)):Math.round((h+m)/2),s<0?s=0:s>x&&(a=s>x+3,s=x);const M=2**s;return{pyramidLevel:s,pyramidResolution:new l({x:M*n.nativePixelSize.x,y:M*n.nativePixelSize.y,spatialReference:n.spatialReference}),excessiveReading:a}}function st(t,n){const{pixelSize:e,extent:o}=t,r=z(o,n,!1);return Y(ot(o,(e.x+e.y)/16),n,r)}function lt(t,n,e){const o=e?.tileSize??512,i=e?.alignGlobalDatasetWithAGOL??!0,s=!!e?.limitToSrcResolution,{extent:a,spatialReference:c,pixelSize:f}=t,u=j(new l({x:f.x,y:f.y,spatialReference:c}),n,a);if(null==u)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const h=(u.x+u.y)/2,m=r(n),x=h*m*96*39.37,M=n.isGeographic?256/o*295828763.7958547:256/o*591657527.591555;let p="vector-magdir"===t.dataType||"vector-uv"===t.dataType;const y=st(t,n),w=Math.min(Math.ceil(Math.log(Math.min(t.width,t.height)/32)/Math.LN2),Math.ceil(Math.log(M/2/x)/Math.LN2));if(!p&&i&&(n.isGeographic||n.isWebMercator)){const e=J(n);if(p=Z(y)>0||null!=e&&y.width>e/4,!p&&null!=e){let n=-1;if(w<3)n=2**w*h*o;else if(t.storageInfo){const{maximumPyramidLevel:e=0,pyramidScalingFactor:r=2}=t.storageInfo;n=r**e*h*o}const r=Math.ceil(e/n);p=1===r||2===r&&e/2-y.xmax<n}}let d,g=x;const R=1.001,N=Math.min(2,Math.max(1.414,t.storageInfo?.pyramidScalingFactor||2));if(p){g=M;const t=n.isGeographic?1341104507446289e-21:.29858214164761665,e=t*(96*m*39.37),o=n.isGeographic?4326:3857;d=j(new l({x:t,y:t,spatialReference:{wkid:o}}),c,y),d.x*=g/e,d.y*=g/e}else{d={x:f.x,y:f.y};let t=0;for(;g<M*(R/2)&&t<w;)t++,g*=N,d.x*=N,d.y*=N;Math.max(g,M)/Math.min(g,M)<=R&&(g=M)}const S=[g],b=[{x:d.x,y:d.y}],v=70.5310735,P=Math.min(v,x)/R;for(;g>=P;)g/=N,d.x/=N,d.y/=N,S.push(g),b.push({x:d.x,y:d.y});if(s){const t=.001*f.x;let n=b.findIndex((n=>n.x>=f.x-t&&n.x<=f.x+t));n>-1?(b.length=n+1,S.length=n+1):(n=b.findIndex((n=>n.x<=f.x+t)),n>0&&(b.length=n,S.length=n))}return{projectedPixelSize:u,scales:S,srcResolutions:b,isCustomTilingScheme:!p}}export{j as C,J as D,Y as J,d as M,T,q as U,Z as V,$ as Z,lt as a,tt as e,F as j,rt as o,it as r,st as s,z as v};
//# sourceMappingURL=p-e7f8bbfb.js.map