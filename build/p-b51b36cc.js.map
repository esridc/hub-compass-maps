{"version":3,"names":["p","t","getLogger","l","r","s","o","features","geometryType","a","f","fromJSON","assetMaps","u","g","i","sourceSpatialReference","n","WGS84","m","globalIdFieldName","outFields","c","length","y","includes","Set","E","push","e","geometry","attributes","has","get","transformFieldRoles","spatialReference","isGeographic","d","createWithExternalSource","extent","transform","vertexSpace","unitConversionDisabled","createIncomplete","h","Map","parentGlobalId","assetName","assetType","assetHash","assetURL","conversionStatus","seqNo","supportedFormats","error","files","name","type","mimeType","status","S","parts","hash","url","Array","from","values","COMPLETED","PENDING","FAILED"],"sources":["./node_modules/@arcgis/core/rest/support/meshFeatureSet.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../Graphic.js\";import t from\"../../core/Logger.js\";import{getOrCreateMapValue as r}from\"../../core/MapUtils.js\";import s from\"../../geometry/Extent.js\";import o from\"../../geometry/Mesh.js\";import n from\"../../geometry/SpatialReference.js\";import{ServiceAssetPart as a,ServiceAsset as u}from\"../../geometry/support/meshUtils/External.js\";import{getFormatIdMimeType as i}from\"../../layers/support/infoFor3D.js\";import f from\"./FeatureSet.js\";import{extractMeshFeatureOrigin as m,extractMeshFeatureTransform as c}from\"./meshFeatureAttributes.js\";const p=()=>t.getLogger(\"esri.rest.support.meshFeatureSet\");function l(t,r,s){const o=s.features;s.features=[],delete s.geometryType;const a=f.fromJSON(s);if(a.geometryType=\"mesh\",!s.assetMaps)return a;const u=g(r,s.assetMaps),i=t.sourceSpatialReference??n.WGS84,m=s.globalIdFieldName,{outFields:c}=t,p=null!=c&&c.length>0?y(c.includes(\"*\")?null:new Set(c)):()=>({});for(const n of o){const t=E(n,m,i,r,u);a.features.push(new e({geometry:t,attributes:p(n)}))}return a}function y(e){return({attributes:t})=>{if(!t)return{};if(!e)return t;for(const r in t)e.has(r)||delete t[r];return t}}function E(e,t,r,n,a){const u=e.attributes[t],i=a.get(u);if(null==i||!e.geometry)return null;const f=m(e.attributes,r,n.transformFieldRoles),p=s.fromJSON(e.geometry);p.spatialReference=r;const l=c(e.attributes,n.transformFieldRoles),y=r.isGeographic?\"local\":\"georeferenced\",E=d(i);return E?o.createWithExternalSource(f,E,{extent:p,transform:l,vertexSpace:y,unitConversionDisabled:!0}):o.createIncomplete(f,{extent:p,transform:l,vertexSpace:y})}var h;function g(e,t){const s=new Map;for(const o of t){const t=o.parentGlobalId;if(null==t)continue;const n=o.assetName,a=o.assetType,u=o.assetHash,f=o.assetURL,m=o.conversionStatus,c=o.seqNo,l=i(a,e.supportedFormats);if(!l){p().error(\"mesh-feature-set:unknown-format\",`Service returned an asset of type ${a}, but it does not list it as a supported type`);continue}const y=r(s,t,(()=>({files:new Map})));r(y.files,n,(()=>({name:n,type:a,mimeType:l,status:S(m),parts:[]}))).parts[c]={hash:u,url:f}}return s}function d(e){const t=Array.from(e.files.values()),r=new Array;for(const s of t){if(s.status!==h.COMPLETED)return null;const e=new Array;for(const t of s.parts){if(!t)return null;e.push(new a(t.url,t.hash))}r.push(new u(s.name,s.mimeType,e))}return r}function S(e){switch(e){case\"COMPLETED\":case\"SUBMITTED\":return h.COMPLETED;case\"INPROGRESS\":return h.PENDING;default:return h.FAILED}}!function(e){e[e.FAILED=0]=\"FAILED\",e[e.PENDING=1]=\"PENDING\",e[e.COMPLETED=2]=\"COMPLETED\"}(h||(h={}));export{g as assetMapFromAssetMapsJSON,E as extractMesh,l as meshFeatureSetFromJSON};\n"],"mappings":"ksBAIijB,MAAMA,EAAE,IAAIC,EAAEC,UAAU,oCAAoC,SAASC,EAAEF,EAAEG,EAAEC,GAAG,MAAMC,EAAED,EAAEE,SAASF,EAAEE,SAAS,UAAUF,EAAEG,aAAa,MAAMC,EAAEC,EAAEC,SAASN,GAAG,GAAGI,EAAED,aAAa,QAAQH,EAAEO,UAAU,OAAOH,EAAE,MAAMI,EAAEC,EAAEV,EAAEC,EAAEO,WAAWG,EAAEd,EAAEe,wBAAwBC,EAAEC,MAAMC,EAAEd,EAAEe,mBAAmBC,UAAUC,GAAGrB,EAAED,EAAE,MAAMsB,GAAGA,EAAEC,OAAO,EAAEC,EAAEF,EAAEG,SAAS,KAAK,KAAK,IAAIC,IAAIJ,IAAI,MAAO,GAAE,IAAI,MAAML,KAAKX,EAAE,CAAC,MAAML,EAAE0B,EAAEV,EAAEE,EAAEJ,EAAEX,EAAES,GAAGJ,EAAEF,SAASqB,KAAK,IAAIC,EAAE,CAACC,SAAS7B,EAAE8B,WAAW/B,EAAEiB,KAAK,CAAC,OAAOR,CAAC,CAAC,SAASe,EAAEK,GAAG,MAAM,EAAEE,WAAW9B,MAAM,IAAIA,EAAE,MAAM,GAAG,IAAI4B,EAAE,OAAO5B,EAAE,IAAI,MAAMG,KAAKH,EAAE4B,EAAEG,IAAI5B,WAAWH,EAAEG,GAAG,OAAOH,EAAE,CAAC,SAAS0B,EAAEE,EAAE5B,EAAEG,EAAEa,EAAER,GAAG,MAAMI,EAAEgB,EAAEE,WAAW9B,GAAGc,EAAEN,EAAEwB,IAAIpB,GAAG,GAAG,MAAME,IAAIc,EAAEC,SAAS,OAAO,KAAK,MAAMpB,EAAES,EAAEU,EAAEE,WAAW3B,EAAEa,EAAEiB,qBAAqBlC,EAAEK,EAAEM,SAASkB,EAAEC,UAAU9B,EAAEmC,iBAAiB/B,EAAE,MAAMD,EAAEmB,EAAEO,EAAEE,WAAWd,EAAEiB,qBAAqBV,EAAEpB,EAAEgC,aAAa,QAAQ,gBAAgBT,EAAEU,EAAEtB,GAAG,OAAOY,EAAErB,EAAEgC,yBAAyB5B,EAAEiB,EAAE,CAACY,OAAOvC,EAAEwC,UAAUrC,EAAEsC,YAAYjB,EAAEkB,wBAAwB,IAAIpC,EAAEqC,iBAAiBjC,EAAE,CAAC6B,OAAOvC,EAAEwC,UAAUrC,EAAEsC,YAAYjB,GAAG,CAAC,IAAIoB,EAAE,SAAS9B,EAAEe,EAAE5B,GAAG,MAAMI,EAAE,IAAIwC,IAAI,IAAI,MAAMvC,KAAKL,EAAE,CAAC,MAAMA,EAAEK,EAAEwC,eAAe,GAAG,MAAM7C,EAAE,SAAS,MAAMgB,EAAEX,EAAEyC,UAAUtC,EAAEH,EAAE0C,UAAUnC,EAAEP,EAAE2C,UAAUvC,EAAEJ,EAAE4C,SAAS/B,EAAEb,EAAE6C,iBAAiB7B,EAAEhB,EAAE8C,MAAMjD,EAAEY,EAAEN,EAAEoB,EAAEwB,kBAAkB,IAAIlD,EAAE,CAACH,IAAIsD,MAAM,kCAAkC,qCAAqC7C,kDAAkD,QAAQ,CAAC,MAAMe,EAAEpB,EAAEC,EAAEJ,GAAC,KAAE,CAAMsD,MAAM,IAAIV,QAAQzC,EAAEoB,EAAE+B,MAAMtC,GAAC,KAAE,CAAMuC,KAAKvC,EAAEwC,KAAKhD,EAAEiD,SAASvD,EAAEwD,OAAOC,EAAEzC,GAAG0C,MAAM,OAAOA,MAAMvC,GAAG,CAACwC,KAAKjD,EAAEkD,IAAIrD,EAAE,CAAC,OAAOL,CAAC,CAAC,SAASgC,EAAER,GAAG,MAAM5B,EAAE+D,MAAMC,KAAKpC,EAAE0B,MAAMW,UAAU9D,EAAE,IAAI4D,MAAM,IAAI,MAAM3D,KAAKJ,EAAE,CAAC,GAAGI,EAAEsD,SAASf,EAAEuB,UAAU,OAAO,KAAK,MAAMtC,EAAE,IAAImC,MAAM,IAAI,MAAM/D,KAAKI,EAAEwD,MAAM,CAAC,IAAI5D,EAAE,OAAO,KAAK4B,EAAED,KAAK,IAAInB,EAAER,EAAE8D,IAAI9D,EAAE6D,MAAM,CAAC1D,EAAEwB,KAAK,IAAIf,EAAER,EAAEmD,KAAKnD,EAAEqD,SAAS7B,GAAG,CAAC,OAAOzB,CAAC,CAAC,SAASwD,EAAE/B,GAAG,OAAOA,GAAG,IAAI,YAAY,IAAI,YAAY,OAAOe,EAAEuB,UAAU,IAAI,aAAa,OAAOvB,EAAEwB,QAAQ,QAAQ,OAAOxB,EAAEyB,OAAO,EAAE,SAASxC,GAAGA,EAAEA,EAAEwC,OAAO,GAAG,SAASxC,EAAEA,EAAEuC,QAAQ,GAAG,UAAUvC,EAAEA,EAAEsC,UAAU,GAAG,WAAW,CAAxF,CAA0FvB,IAAIA,EAAE,Y"}