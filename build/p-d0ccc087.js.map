{"version":3,"names":["c","Symbol","p","n","l","constructor","super","arguments","this","layerViews","r","_debouncedUpdate","i","layer","e","parent","footprintLayerView","t","_createQuery","features","s","queryFeatures","suspended","map","acquireLayer","removeHandles","addHandles","attach","addAttachHandles","_updatingHandles","addOnCollectionChange","_updateStageChildren","initial","dataUpdating","_updateLayers","a","maximumVisibleSublayers","filter","detach","container","removeAllChildren","update","moveStart","viewChange","moveEnd","isUpdating","some","updating","forEach","addChildAt","addPromise","catch","getLogger","error","itemTypeField","itemSourceField","objectIdField","orderBy","d","createQuery","returnGeometry","num","outFields","where","o","find","field","valueExpression","orderByFields","order","h"],"sources":["./node_modules/@arcgis/core/views/2d/layers/CatalogDynamicGroupLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Collection.js\";import t from\"../../../core/Logger.js\";import{debounce as i}from\"../../../core/promiseUtils.js\";import{when as s,watch as a}from\"../../../core/reactiveUtils.js\";import{sqlAnd as o}from\"../../../core/sql.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as d}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView2DMixin as n}from\"./LayerView2D.js\";import l from\"../../layers/LayerView.js\";const c=Symbol();let p=class extends(n(l)){constructor(){super(...arguments),this.layerViews=new r,this._debouncedUpdate=i((async()=>{const{layer:e,parent:{footprintLayerView:r}}=this;let t=[];if(r){const i=this._createQuery(),{features:s}=await r.queryFeatures(i);this.suspended||(t=s.map((r=>e.acquireLayer(r))))}this.removeHandles(c),this.addHandles(t,c)}))}attach(){this.addAttachHandles([this._updatingHandles.addOnCollectionChange((()=>this.layerViews),(()=>this._updateStageChildren()),{initial:!0}),s((()=>!1===this.parent.footprintLayerView?.dataUpdating),(()=>this._updateLayers())),a((()=>[this.layer.maximumVisibleSublayers,this.suspended,this.parent.footprintLayerView?.filter]),(()=>this._updateLayers()))])}detach(){this.container.removeAllChildren(),this.removeHandles(c)}update(e){}moveStart(){}viewChange(){}moveEnd(){}isUpdating(){return this.layerViews.some((e=>e.updating))}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach(((e,r)=>this.container.addChildAt(e.container,r)))}_updateLayers(){this.suspended?this.removeHandles(c):this._updatingHandles.addPromise(this._debouncedUpdate().catch((e=>{t.getLogger(this).error(e)})))}_createQuery(){const{parent:{footprintLayerView:e},layer:{maximumVisibleSublayers:r,parent:{itemTypeField:t,itemSourceField:i,objectIdField:s,orderBy:a}}}=this,d=`${t} <> 'Scene Service'`,n=e.createQuery();n.returnGeometry=!1,n.num=r,n.outFields=[s,i],n.where=o(n.where,d);const l=a?.find((e=>e.field&&!e.valueExpression));return l?.field&&(n.orderByFields=[`${l.field} ${\"descending\"===l.order?\"DESC\":\"ASC\"}`]),n}};p=e([d(\"esri.views.2d.layers.CatalogDynamicGroupLayerView2D\")],p);const h=p;export{h as default};\n"],"mappings":"uRAIujB,MAAMA,EAAEC,SAAS,IAAIC,EAAE,cAAcC,EAAEC,IAAIC,cAAcC,SAASC,WAAWC,KAAKC,WAAW,IAAIC,EAAEF,KAAKG,iBAAiBC,GAAC,UAAY,MAAMC,MAAMC,EAAEC,QAAQC,mBAAmBN,IAAIF,KAAK,IAAIS,EAAE,GAAG,GAAGP,EAAE,CAAC,MAAME,EAAEJ,KAAKU,gBAAgBC,SAASC,SAASV,EAAEW,cAAcT,GAAGJ,KAAKc,YAAYL,EAAEG,EAAEG,KAAKb,GAAGI,EAAEU,aAAad,KAAK,CAACF,KAAKiB,cAAczB,GAAGQ,KAAKkB,WAAWT,EAAEjB,EAAG,GAAE,CAAC2B,SAASnB,KAAKoB,iBAAiB,CAACpB,KAAKqB,iBAAiBC,uBAAqB,IAAMtB,KAAKC,aAAU,IAAOD,KAAKuB,wBAAwB,CAACC,SAAS,IAAIZ,GAAC,KAAO,IAAIZ,KAAKO,OAAOC,oBAAoBiB,eAAY,IAAOzB,KAAK0B,kBAAkBC,GAAC,IAAM,CAAC3B,KAAKK,MAAMuB,wBAAwB5B,KAAKc,UAAUd,KAAKO,OAAOC,oBAAoBqB,UAAO,IAAO7B,KAAK0B,mBAAmB,CAACI,SAAS9B,KAAK+B,UAAUC,oBAAoBhC,KAAKiB,cAAczB,EAAE,CAACyC,OAAO3B,GAAE,CAAE4B,YAAW,CAAEC,aAAY,CAAEC,UAAS,CAAEC,aAAa,OAAOrC,KAAKC,WAAWqC,MAAMhC,GAAGA,EAAEiC,UAAU,CAAChB,uBAAuBvB,KAAK+B,UAAUC,oBAAoBhC,KAAKC,WAAWuC,SAAO,CAAGlC,EAAEJ,IAAIF,KAAK+B,UAAUU,WAAWnC,EAAEyB,UAAU7B,IAAI,CAACwB,gBAAgB1B,KAAKc,UAAUd,KAAKiB,cAAczB,GAAGQ,KAAKqB,iBAAiBqB,WAAW1C,KAAKG,mBAAmBwC,OAAOrC,IAAIG,EAAEmC,UAAU5C,MAAM6C,MAAMvC,EAAG,IAAG,CAACI,eAAe,MAAMH,QAAQC,mBAAmBF,GAAGD,OAAOuB,wBAAwB1B,EAAEK,QAAQuC,cAAcrC,EAAEsC,gBAAgB3C,EAAE4C,cAAcpC,EAAEqC,QAAQtB,KAAK3B,KAAKkD,EAAE,GAAGzC,uBAAuBd,EAAEW,EAAE6C,cAAcxD,EAAEyD,gBAAgB,EAAEzD,EAAE0D,IAAInD,EAAEP,EAAE2D,UAAU,CAAC1C,EAAER,GAAGT,EAAE4D,MAAMC,EAAE7D,EAAE4D,MAAML,GAAG,MAAMtD,EAAE+B,GAAG8B,MAAMnD,GAAGA,EAAEoD,QAAQpD,EAAEqD,kBAAkB,OAAO/D,GAAG8D,QAAQ/D,EAAEiE,cAAc,CAAC,GAAGhE,EAAE8D,SAAS,eAAe9D,EAAEiE,MAAM,OAAO,UAAUlE,CAAC,GAAGD,EAAEY,EAAE,CAAC4C,EAAE,wDAAwDxD,GAAQ,MAACoE,EAAEpE,iB"}