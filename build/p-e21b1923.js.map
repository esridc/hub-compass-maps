{"version":3,"names":["t","e","xoffset","Math","max","abs","yoffset","n","r","length","o","size","stops","filter","type","map","maxSize","minSize","s","f","floor","renderer","pointerType","visualVariables","symbol","uniqueValueInfos","forEach","classBreakInfos","dpi","gdbVersion","geometry","geometryPrecision","a","height","m","historicMoment","p","layerOption","mapExtent","y","maxAllowableOffset","u","returnFieldName","c","returnGeometry","d","returnUnformattedValues","g","returnZ","x","spatialReference","h","timeExtent","b","tolerance","E","width","O","toJSON","dynamicLayers","S","layerDefs","j","layerIds","N","l","$","I","R","imageDisplay","JSON","stringify","geometryType","U","sr","i","time","start","end","join","xmin","ymin","xmax","ymax","layers","floors","sublayers","find","layer","serviceSublayers","extent","minScale","maxScale","visible","includes","id","popupTemplate","popupEnabled","unshift","toExportImageJSON","definitionExpression","Object","keys","floorInfo","static","constructor","super","this","returnM","writeHistoricMoment","getTime","Number","json","write","prototype","String","types","read","Date","Boolean","displayFieldName","feature","layerId","layerName","readFeature","fromJSON","attributes","writeFeature","async","path","then","query","data","results","exceededTransferLimit","from","Map","set","sourceLayer","get","G","_featuresResolutions","WeakMap","highlightGraphics","highlightGraphicUpdated","updateHighlightedFeatures","destroyed","updatingHandles","addPromise","_updateHighlightedFeaturesGeometries","catch","initialize","_updateHighlightedFeaturesSymbols","_highlightGeometriesResolution","addHandles","added","onListenerAdd","layerView","view","scale","_","A","capabilities","operations","supportsIdentify","version","_fetchPopupFeaturesUsingQueries","_fetchPopupFeaturesUsingIdentify","clearHighlights","removeAll","highlight","isCollection","toArray","Array","isArray","addMany","removeMany","getSymbolAsync","import","o4","getSize","shape","style","supportsQuery","_getTargetResolution","has","getObjectId","createQuery","objectIds","outFields","objectIdField","outSpatialReference","queryFeatures","Promise","all","features","_createIdentifyParameters","parsedUrl","sublayer","load","min","allSublayers","reduce","w","createFetchPopupFeaturesQueryGeometry","round","center","v","Set","F","collectRequiredFields","fieldsIndex","sort","clone","where","arcadeUtils","hasGeometryOperations","T","allSettled","status","value","P","defaultPopupTemplateEnabled","expressionInfos","content","some","resolve","any","defaultSymbol","valueExpression","getSymbol","constructOnly","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","equals"],"sources":["./node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","./node_modules/@arcgis/core/rest/operations/identify.js","./node_modules/@arcgis/core/rest/support/IdentifyParameters.js","./node_modules/@arcgis/core/rest/support/IdentifyResult.js","./node_modules/@arcgis/core/rest/identify.js","./node_modules/@arcgis/core/views/layers/support/MapServiceLayerViewHelper.js","./node_modules/@arcgis/core/views/support/drapedUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const o=t[r].size;\"number\"==typeof o&&(e+=o,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t?.stops?.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:o}=e;return(n(r,t)+n(o,t))/2}));let o=0;const s=r.length;if(0===s)return t;for(let n=0;n<s;n++)o+=r[n];const f=Math.floor(o/s);return Math.max(f,t)}function o(e){const n=e?.renderer,o=e?.pointerType,s=\"touch\"===o?9:6;if(!n)return s;const f=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(f,n.symbol);if(\"unique-value\"===n.type){let e=f;return n.uniqueValueInfos?.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=f;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return\"dot-density\"===n.type||n.type,f}export{o as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{sqlAnd as e}from\"../../core/sql.js\";import{getJsonType as t}from\"../../geometry/support/jsonUtils.js\";import{getScale as r}from\"../../geometry/support/scaleUtils.js\";import{srToRESTValue as i}from\"../../geometry/support/spatialReferenceUtils.js\";import{getLayerFloorFilterClause as n}from\"../../layers/support/floorFilterUtils.js\";import{isExportDynamic as s}from\"../../layers/support/sublayerUtils.js\";function o(e,r){const{dpi:n,gdbVersion:s,geometry:o,geometryPrecision:a,height:m,historicMoment:p,layerOption:f,mapExtent:y,maxAllowableOffset:u,returnFieldName:c,returnGeometry:d,returnUnformattedValues:g,returnZ:x,spatialReference:h,timeExtent:b,tolerance:E,width:O}=e.toJSON(),{dynamicLayers:S,layerDefs:j,layerIds:N}=l(e),$=null!=r?.geometry?r.geometry:null,I={historicMoment:p,geometryPrecision:a,maxAllowableOffset:u,returnFieldName:c,returnGeometry:d,returnUnformattedValues:g,returnZ:x,tolerance:E},R=$&&$.toJSON()||o;I.imageDisplay=`${O},${m},${n}`,s&&(I.gdbVersion=s),R&&(delete R.spatialReference,I.geometry=JSON.stringify(R),I.geometryType=t(R));const U=h??R?.spatialReference??y?.spatialReference;if(U&&(I.sr=i(U)),I.time=b?[b.start,b.end].join(\",\"):null,y){const{xmin:e,ymin:t,xmax:r,ymax:i}=y;I.mapExtent=`${e},${t},${r},${i}`}return j&&(I.layerDefs=j),S&&!j&&(I.dynamicLayers=S),I.layers=\"popup\"===f?\"visible\":f,N&&!S&&(I.layers+=`:${N.join(\",\")}`),I}function l(e){const{mapExtent:t,floors:i,width:o,sublayers:l,layerIds:m,layerOption:p,gdbVersion:f}=e,y=l?.find((e=>null!=e.layer))?.layer?.serviceSublayers,u=\"popup\"===p,c={},d=r({extent:t,width:o,spatialReference:t?.spatialReference}),g=[],x=e=>{const t=0===d,r=0===e.minScale||d<=e.minScale,i=0===e.maxScale||d>=e.maxScale;if(e.visible&&(t||r&&i))if(e.sublayers)e.sublayers.forEach(x);else{if(!1===m?.includes(e.id)||u&&(!e.popupTemplate||!e.popupEnabled))return;g.unshift(e)}};if(l?.forEach(x),l&&!g.length)c.layerIds=[];else{const e=s(g,y,f),t=g.map((e=>{const t=n(i,e);return e.toExportImageJSON(t)}));if(e)c.dynamicLayers=JSON.stringify(t);else{if(l){let e=g.map((({id:e})=>e));m&&(e=e.filter((e=>m.includes(e)))),c.layerIds=e}else m?.length&&(c.layerIds=m);const e=a(i,g);if(null!=e&&e.length){const t={};for(const r of e)r.definitionExpression&&(t[r.id]=r.definitionExpression);Object.keys(t).length&&(c.layerDefs=JSON.stringify(t))}}}return c}function a(t,r){const i=!!t?.length,s=r.filter((e=>null!=e.definitionExpression||i&&null!=e.floorInfo));return s.length?s.map((r=>{const i=n(t,r),s=e(i,r.definitionExpression);return{id:r.id,definitionExpression:s??void 0}})):null}export{o as identifyToIdentifyRESTParameters,l as toDynamicLayersJSON};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import{geometryTypes as e}from\"../../geometry.js\";import o from\"../../TimeExtent.js\";import{JSONSupport as r}from\"../../core/JSONSupport.js\";import{property as i}from\"../../core/accessorSupport/decorators/property.js\";import{ensureClass as s}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/RandomLCG.js\";import\"../../core/has.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as n}from\"../../core/accessorSupport/decorators/writer.js\";import{fromJSON as l}from\"../../geometry/support/jsonUtils.js\";import m from\"../../geometry/Extent.js\";import y from\"../../geometry/SpatialReference.js\";var a;let u=a=class extends r{static from(t){return s(a,t)}constructor(t){super(t),this.dpi=96,this.floors=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=null,this.height=400,this.historicMoment=null,this.layerIds=null,this.layerOption=\"top\",this.mapExtent=null,this.maxAllowableOffset=null,this.returnFieldName=!0,this.returnGeometry=!1,this.returnM=!1,this.returnUnformattedValues=!0,this.returnZ=!1,this.spatialReference=null,this.sublayers=null,this.timeExtent=null,this.tolerance=null,this.width=400}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}};t([i({type:Number,json:{write:!0}})],u.prototype,\"dpi\",void 0),t([i()],u.prototype,\"floors\",void 0),t([i({type:String,json:{write:!0}})],u.prototype,\"gdbVersion\",void 0),t([i({types:e,json:{read:l,write:!0}})],u.prototype,\"geometry\",void 0),t([i({type:Number,json:{write:!0}})],u.prototype,\"geometryPrecision\",void 0),t([i({type:Number,json:{write:!0}})],u.prototype,\"height\",void 0),t([i({type:Date})],u.prototype,\"historicMoment\",void 0),t([n(\"historicMoment\")],u.prototype,\"writeHistoricMoment\",null),t([i({type:[Number],json:{write:!0}})],u.prototype,\"layerIds\",void 0),t([i({type:[\"top\",\"visible\",\"all\",\"popup\"],json:{write:!0}})],u.prototype,\"layerOption\",void 0),t([i({type:m,json:{write:!0}})],u.prototype,\"mapExtent\",void 0),t([i({type:Number,json:{write:!0}})],u.prototype,\"maxAllowableOffset\",void 0),t([i({type:Boolean,json:{write:!0}})],u.prototype,\"returnFieldName\",void 0),t([i({type:Boolean,json:{write:!0}})],u.prototype,\"returnGeometry\",void 0),t([i({type:Boolean,json:{write:!0}})],u.prototype,\"returnM\",void 0),t([i({type:Boolean,json:{write:!0}})],u.prototype,\"returnUnformattedValues\",void 0),t([i({type:Boolean,json:{write:!0}})],u.prototype,\"returnZ\",void 0),t([i({type:y,json:{write:!0}})],u.prototype,\"spatialReference\",void 0),t([i()],u.prototype,\"sublayers\",void 0),t([i({type:o,json:{write:!0}})],u.prototype,\"timeExtent\",void 0),t([i({type:Number,json:{write:!0}})],u.prototype,\"tolerance\",void 0),t([i({type:Number,json:{write:!0}})],u.prototype,\"width\",void 0),u=a=t([p(\"esri.rest.support.IdentifyParameters\")],u);const d=u;export{d as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import e from\"../../Graphic.js\";import{JSONSupport as t}from\"../../core/JSONSupport.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{reader as s}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as i}from\"../../core/accessorSupport/decorators/writer.js\";import{typeKebabDictionary as a}from\"../../geometry/support/typeUtils.js\";let u=class extends t{constructor(r){super(r),this.displayFieldName=null,this.feature=null,this.layerId=null,this.layerName=null}readFeature(r,t){return e.fromJSON({attributes:{...t.attributes},geometry:{...t.geometry}})}writeFeature(r,e){if(!r)return;const{attributes:t,geometry:o}=r;t&&(e.attributes={...t}),null!=o&&(e.geometry=o.toJSON(),e.geometryType=a.toJSON(o.type))}};r([o({type:String,json:{write:!0}})],u.prototype,\"displayFieldName\",void 0),r([o({type:e})],u.prototype,\"feature\",void 0),r([s(\"feature\",[\"attributes\",\"geometry\"])],u.prototype,\"readFeature\",null),r([i(\"feature\")],u.prototype,\"writeFeature\",null),r([o({type:Number,json:{write:!0}})],u.prototype,\"layerId\",void 0),r([o({type:String,json:{write:!0}})],u.prototype,\"layerName\",void 0),u=r([p(\"esri.rest.support.IdentifyResult\")],u);const m=u;export{m as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport r from\"../request.js\";import{normalizeCentralMeridian as e}from\"../geometry/support/normalizeUtils.js\";import{parseUrl as t,encode as o,asValidOptions as s}from\"./utils.js\";import{identifyToIdentifyRESTParameters as n}from\"./operations/identify.js\";import u from\"./support/IdentifyParameters.js\";import i from\"./support/IdentifyResult.js\";async function f(u,i,f){const c=(i=a(i)).geometry?[i.geometry]:[],l=t(u);return l.path+=\"/identify\",e(c).then((e=>{const t=n(i,{geometry:e?.[0]}),u=o({...l.query,f:\"json\",...t}),a=s(u,f);return r(l.path,a).then(m).then((r=>p(r,i.sublayers)))}))}function m(r){const e=r.data;return e.results=e.results||[],e.exceededTransferLimit=Boolean(e.exceededTransferLimit),e.results=e.results.map((r=>i.fromJSON(r))),e}function a(r){return r=u.from(r)}function p(r,e){if(!e?.length)return r;const t=new Map;function o(r){t.set(r.id,r),r.sublayers&&r.sublayers.forEach(o)}e.forEach(o);for(const s of r.results)s.feature.sourceLayer=t.get(s.layerId);return r}export{f as identify};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../Graphic.js\";import r from\"../../../core/Accessor.js\";import{isSome as s}from\"../../../core/arrayUtils.js\";import i from\"../../../core/Collection.js\";import o from\"../../../core/Error.js\";import{makeHandle as a}from\"../../../core/handleUtils.js\";import has from\"../../../core/has.js\";import{getOrCreateMapValue as n}from\"../../../core/MapUtils.js\";import{debounce as l,throwIfAborted as p}from\"../../../core/promiseUtils.js\";import{on as c}from\"../../../core/reactiveUtils.js\";import{getMetersPerUnitForSR as u}from\"../../../core/unitUtils.js\";import{property as h}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/Logger.js\";import{subclass as y}from\"../../../core/accessorSupport/decorators/subclass.js\";import m from\"../../../geometry/Extent.js\";import{getResolutionForScale as f}from\"../../../geometry/support/scaleUtils.js\";import{collectFields as d}from\"../../../layers/support/fieldUtils.js\";import{getLayerFloorFilterClause as g}from\"../../../layers/support/floorFilterUtils.js\";import{calculateTolerance as w}from\"../../../renderers/support/clickToleranceUtils.js\";import{identify as b}from\"../../../rest/identify.js\";import v from\"../../../rest/support/IdentifyParameters.js\";import{loadArcade as j}from\"../../../support/arcadeOnDemand.js\";import x from\"../../../symbols/SimpleMarkerSymbol.js\";import{getRequiredFields as F,getFetchPopupTemplate as P}from\"./popupUtils.js\";let G=null;function S(e,t){return\"tile\"===t.type||\"map-image\"===t.type}let U=class extends r{constructor(e){super(e),this._featuresResolutions=new WeakMap,this.highlightGraphics=null,this.highlightGraphicUpdated=null,this.updateHighlightedFeatures=l((async e=>{this.destroyed||this.updatingHandles.addPromise(this._updateHighlightedFeaturesGeometries(e).catch((()=>{})))}))}initialize(){const e=e=>{this.updatingHandles.addPromise(this._updateHighlightedFeaturesSymbols(e).catch((()=>{}))),this.updateHighlightedFeatures(this._highlightGeometriesResolution)};this.addHandles([c((()=>this.highlightGraphics),\"change\",(t=>e(t.added)),{onListenerAdd:t=>e(t)})])}async fetchPopupFeaturesAtLocation(e,t){const{layerView:{layer:r,view:{scale:s}}}=this;if(!e)throw new o(\"fetchPopupFeatures:invalid-area\",\"Nothing to fetch without area\",{layer:r});const i=_(r.sublayers,s,t);if(!i.length)return[];const a=await A(r,i);if(!((r.capabilities?.operations?.supportsIdentify??!0)&&r.version>=10.5)&&!a)throw new o(\"fetchPopupFeatures:not-supported\",\"query operation is disabled for this service\",{layer:r});return a?this._fetchPopupFeaturesUsingQueries(e,i,t):this._fetchPopupFeaturesUsingIdentify(e,i,t)}clearHighlights(){this.highlightGraphics?.removeAll()}highlight(e){const r=this.highlightGraphics;if(!r)return a();let o=null;if(e instanceof t?o=[e]:i.isCollection(e)&&e.length>0?o=e.toArray():Array.isArray(e)&&e.length>0&&(o=e),o=o?.filter(s),!o?.length)return a();for(const t of o){const e=t.sourceLayer;null!=e&&\"geometryType\"in e&&\"point\"===e.geometryType&&(t.visible=!1)}return r.addMany(o),a((()=>r.removeMany(o??[])))}async _updateHighlightedFeaturesSymbols(e){const{layerView:{view:t},highlightGraphics:r,highlightGraphicUpdated:s}=this;if(r&&s)for(const i of e){const e=i.sourceLayer&&\"renderer\"in i.sourceLayer&&i.sourceLayer.renderer;i.sourceLayer&&\"geometryType\"in i.sourceLayer&&\"point\"===i.sourceLayer.geometryType&&e&&\"getSymbolAsync\"in e&&e.getSymbolAsync(i).then((async o=>{o||=new x;let a=null;const n=\"visualVariables\"in e?e.visualVariables?.find((e=>\"size\"===e.type)):void 0;n&&(G||(G=(await import(\"../../../renderers/visualVariables/support/visualVariableUtils.js\")).getSize),a=G(n,i,{view:t.type,scale:t.scale,shape:\"simple-marker\"===o.type?o.style:null})),a||=\"width\"in o&&\"height\"in o&&null!=o.width&&null!=o.height?Math.max(o.width,o.height):\"size\"in o?o.size:16,r.includes(i)&&(i.symbol=new x({style:\"square\",size:a,xoffset:\"xoffset\"in o?o.xoffset:0,yoffset:\"yoffset\"in o?o.yoffset:0}),s(i,\"symbol\"),i.visible=!0)}))}}async _updateHighlightedFeaturesGeometries(e){const{layerView:{layer:t,view:r},highlightGraphics:s,highlightGraphicUpdated:i}=this;if(this._highlightGeometriesResolution=e,!i||!s?.length||!t.capabilities.operations.supportsQuery)return;const o=this._getTargetResolution(e),a=new Map;for(const c of s)if(!this._featuresResolutions.has(c)||this._featuresResolutions.get(c)>o){const e=c.sourceLayer;n(a,e,(()=>new Map)).set(c.getObjectId(),c)}const l=Array.from(a,(([e,t])=>{const s=e.createQuery();return s.objectIds=[...t.keys()],s.outFields=[e.objectIdField],s.returnGeometry=!0,s.maxAllowableOffset=o,s.outSpatialReference=r.spatialReference,e.queryFeatures(s)})),p=await Promise.all(l);if(!this.destroyed)for(const{features:n}of p)for(const e of n){const t=e.sourceLayer,r=a.get(t).get(e.getObjectId());r&&s.includes(r)&&(r.geometry=e.geometry,i(r,\"geometry\"),this._featuresResolutions.set(r,o))}}_getTargetResolution(e){const t=e*u(this.layerView.view.spatialReference),r=t/16;return r<=10?0:e/t*r}async _fetchPopupFeaturesUsingIdentify(e,t,r){const s=await this._createIdentifyParameters(e,t,r);if(null==s)return[];const{results:i}=await b(this.layerView.layer.parsedUrl,s,r);return i.map((e=>e.feature))}async _createIdentifyParameters(e,t,r){const{floors:s,layer:i,timeExtent:o,view:{spatialReference:a,scale:n}}=this.layerView;if(!t.length)return null;await Promise.all(t.map((({sublayer:e})=>e.load(r).catch((()=>{})))));const l=Math.min(has(\"mapservice-popup-identify-max-tolerance\"),i.allSublayers.reduce(((e,t)=>t.renderer?w({renderer:t.renderer,pointerType:r?.pointerType}):e),2)),p=this.createFetchPopupFeaturesQueryGeometry(e,l),c=f(n,a),u=Math.round(p.width/c),h=new m({xmin:p.center.x-c*u,ymin:p.center.y-c*u,xmax:p.center.x+c*u,ymax:p.center.y+c*u,spatialReference:p.spatialReference});return new v({floors:s,gdbVersion:\"gdbVersion\"in i?i.gdbVersion:void 0,geometry:e,height:u,layerOption:\"popup\",mapExtent:h,returnGeometry:!0,spatialReference:a,sublayers:i.sublayers,timeExtent:o,tolerance:l,width:u})}async _fetchPopupFeaturesUsingQueries(e,t,r){const{layerView:{floors:i,timeExtent:o}}=this,a=t.map((async({sublayer:t,popupTemplate:s})=>{if(await t.load(r).catch((()=>{})),t.capabilities&&!t.capabilities.operations.supportsQuery)return[];const a=t.createQuery(),n=w({renderer:t.renderer,pointerType:r?.pointerType}),l=this.createFetchPopupFeaturesQueryGeometry(e,n),c=new Set,[u]=await Promise.all([F(t,s),t.renderer?.collectRequiredFields(c,t.fieldsIndex)]);p(r),d(c,t.fieldsIndex,u);const h=Array.from(c).sort();if(a.geometry=l,a.outFields=h,a.timeExtent=o,i){const e=i.clone(),r=g(e,t);null!=r&&(a.where=a.where?`(${a.where}) AND (${r})`:r)}const y=this._getTargetResolution(l.width/n),m=await R(s);p(r);const f=\"point\"===t.geometryType||m&&m.arcadeUtils.hasGeometryOperations(s);f||(a.maxAllowableOffset=y);let{features:b}=await t.queryFeatures(a,r);const v=f?0:y;b=await T(t,b,r);for(const e of b)this._featuresResolutions.set(e,v);return b}));return(await Promise.allSettled(a)).reduce(((e,t)=>\"fulfilled\"===t.status?[...e,...t.value]:e),[]).filter(s)}};function _(e,t,r){const s=[];if(!e)return s;const i=e=>{const o=0===e.minScale||t<=e.minScale,a=0===e.maxScale||t>=e.maxScale;if(e.visible&&o&&a)if(e.sublayers)e.sublayers.forEach(i);else if(e.popupEnabled){const t=P(e,{...r,defaultPopupTemplateEnabled:!1});null!=t&&s.unshift({sublayer:e,popupTemplate:t})}};return e.map(i),s}function R(e){return e.expressionInfos?.length||Array.isArray(e.content)&&e.content.some((e=>\"expression\"===e.type))?j():Promise.resolve()}async function A(e,t){if(e.capabilities?.operations?.supportsQuery)return!0;try{return await Promise.any(t.map((({sublayer:e})=>e.load().then((()=>e.capabilities.operations.supportsQuery)))))}catch{return!1}}async function T(e,t,r){const s=e.renderer;return s&&\"defaultSymbol\"in s&&!s.defaultSymbol&&(t=s.valueExpression?await Promise.all(t.map((e=>s.getSymbolAsync(e,r).then((t=>t?e:null))))).then((e=>e.filter((e=>null!=e)))):t.filter((e=>null!=s.getSymbol(e)))),t}e([h({constructOnly:!0})],U.prototype,\"createFetchPopupFeaturesQueryGeometry\",void 0),e([h({constructOnly:!0})],U.prototype,\"layerView\",void 0),e([h({constructOnly:!0})],U.prototype,\"highlightGraphics\",void 0),e([h({constructOnly:!0})],U.prototype,\"highlightGraphicUpdated\",void 0),e([h({constructOnly:!0})],U.prototype,\"updatingHandles\",void 0),U=e([y(\"esri.views.layers.support.MapService\")],U);export{U as MapServiceLayerViewHelper,_ as collectPopupProviders,S as isMapServiceLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{getMetersPerUnitForSR as e}from\"../../core/unitUtils.js\";import{calculateTolerance as t}from\"../../renderers/support/clickToleranceUtils.js\";import n from\"../../geometry/Extent.js\";function r(t,r,i,a=new n){let o=0;if(\"2d\"===i.type)o=r*(i.resolution??0);else if(\"3d\"===i.type){const n=i.overlayPixelSizeInMapUnits(t),a=i.basemapSpatialReference;o=null==a||a.equals(i.spatialReference)?r*n:e(a)/e(i.spatialReference)}const s=t.x-o,l=t.y-o,m=t.x+o,p=t.y+o,{spatialReference:c}=i;return a.xmin=Math.min(s,m),a.ymin=Math.min(l,p),a.xmax=Math.max(s,m),a.ymax=Math.max(l,p),a.spatialReference=c,a}function i(e,n,i){const o=i.toMap(e);if(null==o)return!1;return r(o,t(),i,a).intersects(n)}const a=new n;export{r as createQueryGeometry,i as intersectsDrapedGeometry};\n"],"mappings":"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"}