import{bG as t,bL as e,bT as i,r as s,p as l,q as n,bS as o,az as a,bU as r,bV as h,bW as d,bX as c,w as u,bY as b,bZ as m,ac as p,bD as g,bC as v,bF as f,b_ as y,bI as I,b$ as _,bK as w,c0 as E,n as C,bM as L,bN as M,bO as F,bP as P,bQ as k,bR as T}from"./p-aad64c9f.js";import"./p-2af77f97.js";const N="esri-table-list",B=`${N}__item`,$={base:N,actionMenu:`${N}__action-menu`,actionGroup:`${N}__action-group`,filterNoResults:`${N}__filter-no-results`,item:B,itemContent:`${B}-content`,itemContentBottom:`${B}-content-bottom`,itemMessage:`${B}-message`,itemActionIcon:`${B}-action-icon`,itemActionImage:`${B}-action-image`,itemTemporaryIcon:`${B}-temporary-icon`,publishing:`${N}__publishing`,statusIndicator:`${N}__status-indicator`};let O=class extends(t(o)){constructor(t,e){super(t,e),this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}get disabled(){return!(this.content&&this.listItem)}set disabled(t){this._overrideIfSome("disabled",t)}get icon(){const{image:t}=this,e=this._getFirstWidget();return this._get("icon")??(!t&&e?e.icon:null)}set icon(t){this._overrideIfSome("icon",t)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(t){this._override("title",t)}render(){return e("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(t){const{disabled:s,open:l}=this;return t&&!s&&l?"string"==typeof t?e("div",{innerHTML:t,key:t}):i(t)?e("div",{key:"content-widget"},t.render()):t instanceof HTMLElement?e("div",{afterCreate:this._attachToNode,bind:t,key:"content-element"}):null:null}_renderContents(){const{content:t,open:e}=this;return e?Array.isArray(t)?t.map((t=>this._renderContent(t))):this._renderContent(t):null}_attachToNode(t){t.appendChild(this)}_getWidget(t){return i(t)?t:null}_getFirstWidget(){const{content:t}=this;return Array.isArray(t)?t.map((t=>this._getWidget(t))).find((t=>t)):this._getWidget(t)}};s([l()],O.prototype,"className",void 0),s([l()],O.prototype,"content",void 0),s([l()],O.prototype,"disabled",null),s([l()],O.prototype,"flowEnabled",void 0),s([l()],O.prototype,"icon",null),s([l()],O.prototype,"image",void 0),s([l()],O.prototype,"listItem",void 0),s([l()],O.prototype,"open",void 0),s([l()],O.prototype,"title",null),s([l()],O.prototype,"visible",void 0),O=s([n("esri.widgets.TableList.ListItemPanel")],O);const S=O;var x;const D=a.ofType({key:"type",defaultKeyValue:"button",base:r,typeMap:{button:h,toggle:d,slider:c}}),A=a.ofType(D);let j=x=class extends(t(p)){constructor(t){super(t),this.actionsSections=new A,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.panel=null,this.sortable=!0}initialize(){if(this.addHandles([u((()=>this.panel),(t=>this._setListItemOnPanel(t)),g)]),"function"==typeof this.listItemCreatedFunction){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){this.panel?.destroy()}get error(){return this.layer?.loadError}castPanel(t){return this.panel?.open&&!t.hasOwnProperty("open")&&(t.open=!0),t?new S(t):null}get publishing(){const{layer:t,checkPublishStatusEnabled:e}=this;return(e&&t&&"publishingInfo"in t&&"publishing"===t.publishingInfo?.status)??!1}get title(){const t=b(this,"layer.layer");return(!t||t&&b(this,"layer.layer.loaded")?this.layer?.title:null)??""}set title(t){this._overrideIfSome("title",t)}clone(){return new x({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,panel:this.panel,sortable:this.sortable,title:this.title})}_setListItemOnPanel(t){t&&(t.listItem=this)}};s([l({type:A})],j.prototype,"actionsSections",void 0),s([l()],j.prototype,"actionsOpen",void 0),s([l()],j.prototype,"checkPublishStatusEnabled",void 0),s([l({readOnly:!0})],j.prototype,"error",null),s([l()],j.prototype,"hidden",void 0),s([l()],j.prototype,"layer",void 0),s([l()],j.prototype,"listItemCreatedFunction",void 0),s([l({type:S})],j.prototype,"panel",void 0),s([m("panel")],j.prototype,"castPanel",null),s([l({readOnly:!0})],j.prototype,"publishing",null),s([l()],j.prototype,"sortable",void 0),s([l()],j.prototype,"title",null),j=x=s([n("esri.widgets.TableList.ListItem")],j);const U=j;const G={map:"map",layerListMode:"layer-list-mode"},R="hide",V=a.ofType(U);let z=class extends v.EventedAccessor{constructor(t){super(t),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.tableItems=new V,this.map=null}initialize(){this.addHandles([u((()=>[this.tables,this.map?.allTables.toArray()]),(()=>this._compileList()),g),u((()=>[this.map?.loaded,this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._recompileList()))],G.map)}destroy(){this._removeAllItems(),this.map=null,this.tables=null}get tables(){return this.map?.allTables}set tables(t){this._overrideIfSome("tables",t)}get state(){const{map:t,tables:e}=this;if(!t)return e?"ready":"disabled";const i=t?.loadStatus;return"string"==typeof i?"loaded"===i?"ready":"loading"===i?"loading":"disabled":"ready"}get totalItems(){return this.tableItems.length}triggerAction(t,e){t&&!t.disabled&&this.emit("trigger-action",{action:t,item:e})}_removeAllItems(){this.tableItems.destroyAll()}_getViewableTables(t){return t?this.listModeDisabled?t:t.filter((t=>f(t)!==R)):void 0}_watchTablesListMode(t){this.removeHandles(G.layerListMode),t&&!this.listModeDisabled&&this.addHandles(u((()=>t.filter((t=>"listMode"in t)).map((t=>t.listMode)).toArray()),(()=>this._compileList())),G.layerListMode)}_compileList(){const{tables:t}=this;this._watchTablesListMode(t);const e=this._getViewableTables(t);e?.length?(this._createNewItems(e),this._removeItems(e),this._sortItems(e)):this._removeAllItems()}_createNewItems(t){const{tableItems:e,listItemCreatedFunction:i,checkPublishStatusEnabled:s}=this;t.forEach((t=>{e.some((e=>e.layer===t))||e.add(new U({checkPublishStatusEnabled:s,layer:t,listItemCreatedFunction:i}))}))}_removeItems(t){const{tableItems:e}=this;e.forEach((i=>{if(!i)return;const s=t?.find((t=>i.layer===t));s||(e.remove(i),i.destroy())}))}_sortItems(t){const{tableItems:e}=this;e.sort(((e,i)=>{const s=t.indexOf(e.layer),l=t.indexOf(i.layer);return s>l?-1:s<l?1:0}))}_recompileList(){this._removeAllItems(),this._compileList()}};s([l()],z.prototype,"checkPublishStatusEnabled",void 0),s([l()],z.prototype,"listItemCreatedFunction",void 0),s([l({nonNullable:!0})],z.prototype,"listModeDisabled",void 0),s([l({type:V,readOnly:!0})],z.prototype,"tableItems",void 0),s([l()],z.prototype,"tables",null),s([l()],z.prototype,"map",void 0),s([l({readOnly:!0})],z.prototype,"state",null),s([l()],z.prototype,"totalItems",null),z=s([n("esri.widgets.TableList.TableListViewModel")],z);const W=z;let H=class extends p{constructor(){super(...arguments),this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryTableIndicators=!1}};s([l({type:Boolean,nonNullable:!0})],H.prototype,"closeButton",void 0),s([l({type:Boolean,nonNullable:!0})],H.prototype,"collapseButton",void 0),s([l({type:Boolean,nonNullable:!0})],H.prototype,"errors",void 0),s([l({type:Boolean,nonNullable:!0})],H.prototype,"filter",void 0),s([l({type:Boolean,nonNullable:!0})],H.prototype,"flow",void 0),s([l({type:Boolean,nonNullable:!0})],H.prototype,"heading",void 0),s([l({type:Boolean,nonNullable:!0})],H.prototype,"statusIndicators",void 0),s([l({type:Boolean,nonNullable:!0})],H.prototype,"temporaryTableIndicators",void 0),H=s([n("esri.widgets.TableList.TableListVisibleElements")],H);const K=H;function q(t){return t["data-item"]}function Q(t,e){t?.sort(((t,i)=>{const s=e.indexOf(t.uid),l=e.indexOf(i.uid);return s>l?-1:s<l?1:0}))}const X=a.ofType(U);let Y=class extends(t(o)){constructor(t,e){super(t,e),this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`table-${this.uid}`,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=y,this.minFilterItems=I,this.selectedItems=new X,this.selectionMode="none",this.viewModel=new W,this.visibleElements=new K,this._canMove=({dragEl:t,fromEl:e,toEl:i},s)=>{const l="pull"===s?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,n=q(t);if(!n?.sortable)return!1;const o=q(e),a=_(e),r=q(i),h=_(i),d=!!a&&!!h&&a===h,c={selected:n,from:o,to:r},u=e.group,b=i.group;return u&&b&&"function"==typeof l?l.call(null,c):d},this._onCalciteListOrderChange=t=>{const{_lastDragDetail:e}=this,{toEl:i,fromEl:s,dragEl:l,newIndex:n}=t;if(!s||!i||e?.newIndex===n&&e?.dragEl===l&&e?.toEl===i&&e?.fromEl===s)return;this._lastDragDetail=t;const o=Array.from(s.children).filter((t=>t?.matches("calcite-list-item"))).map((t=>t.value));Q(this.map?.tables,o)},this._onTriggerAction=(t,e)=>{this.triggerAction(t,e)},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onSelectedDragItemLayerUidChange=t=>{this._selectedDragItemLayerUid=t}}loadDependencies(){return w({button:()=>import("./p-5b44be17.js"),flow:()=>import("./p-b1874b0a.js"),"flow-item":()=>import("./p-e9d31c79.js"),list:()=>import("./p-4bdb39fa.js"),notice:()=>import("./p-cebdc047.js")})}get _dragEnabled(){return this.viewModel.totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this.viewModel.totalItems>=this.minFilterItems&&this.visibleElements.filter}get icon(){return"table"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(t){this.viewModel.listItemCreatedFunction=t}get map(){return this.viewModel.map}set map(t){this.viewModel.map=t}get multipleSelectionEnabled(){return E(C.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),"multiple"===this.selectionMode}set multipleSelectionEnabled(t){E(C.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=t?"multiple":this.selectionEnabled?"single":"none"}get selectionEnabled(){return E(C.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),"none"!==this.selectionMode&&this.dragEnabled}set selectionEnabled(t){E(C.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.dragEnabled=t,this.selectionMode=t?this.multipleSelectionEnabled?"multiple":"single":"none"}get tableItems(){return this.viewModel.tableItems}get tables(){return this.viewModel.tables}set tables(t){this.viewModel.tables=t}triggerAction(t,e){return this.viewModel.triggerAction(t,e)}render(){const t=this.viewModel?.state,i={[L.hidden]:"loading"===t,[L.disabled]:"disabled"===t},s=this.tableItems?.filter((t=>!t.hidden&&(this.visibleElements.errors||!t.error)));return e("div",{class:this.classes($.base,L.widget,L.panel,i)},s?.length?this._renderItems(s):this._renderNoItems())}_renderNoItemsMessage(){return e("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return e("div",{class:$.itemMessage,key:"esri-layer-list__no-items"},e("calcite-notice",{icon:"information",kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}_renderPanelFlowItems(t){return t?.toArray().filter((({panel:t})=>t?.open&&!t.disabled&&t.flowEnabled)).map((({title:t,panel:i})=>{const s=()=>this._handlePanelFlowItemBack(i);return e("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:t,heading:i.title,headingLevel:this.headingLevel,key:`flow-panel-${i.uid}`,onCalciteFlowItemBack:t=>{t.preventDefault(),s()}},i.render(),e("calcite-button",{appearance:"transparent",onclick:s,slot:"footer-actions",width:"full"},this.messagesCommon.back))}))}_handlePanelFlowItemBack(t){t.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(t){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,M(t))}_focusPanelFlowItemNode(t){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,M(t))}_renderItems(t){const{visible:i,collapsed:s,visibleElements:{closeButton:l,collapseButton:n,heading:o,flow:a},_dragEnabled:r,_filterEnabled:h,_rootGroupUid:d,selectionMode:c,messages:u,filterPlaceholder:b,filterText:m}=this,p=[e("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:l,closed:!i,collapsed:s,collapsible:n,heading:o?u.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},e("calcite-list",{canPull:t=>this._canMove(t,"pull"),canPut:t=>this._canMove(t,"put"),"data-layer-type":d,dragEnabled:r,filterEnabled:h,filterPlaceholder:b,filterProps:F,filterText:h?m:"",group:d,key:"root-list",label:u.widgetLabel,selectionAppearance:"border",selectionMode:c,onCalciteListChange:t=>this._handleCalciteListChange(t),onCalciteListDragEnd:t=>this._handleCalciteListDragEnd(t.detail),onCalciteListFilter:t=>this.filterText=t.target?.filterText??"",onCalciteListOrderChange:t=>this._onCalciteListOrderChange(t.detail)},t?.toArray().map((t=>this._renderItem(t))),t?.length&&h?e("div",{class:$.filterNoResults,slot:"filter-no-results"},e("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(t)];return i?a?e("calcite-flow",{key:"root-flow"},p):p:null}_handleCalciteListDragEnd(t){const{fromEl:e,dragEl:i,oldIndex:s}=t;e.insertBefore(i,e.children[s])}_renderItem(t){return e(P,{canMove:this._canMove,css:$,dragEnabled:this.dragEnabled,item:t,key:`layerListItem-${t.layer.uid}`,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange})}_handleCalciteListChange(t){const{selectionMode:e,selectedItems:i}=this;if("none"===e)return;const s=t.target.selectedItems.map((t=>q(t))).filter(Boolean);i.removeAll(),i.addMany(s)}};s([l()],Y.prototype,"_focusRootFlowItem",void 0),s([l()],Y.prototype,"_focusPanelFlowItem",void 0),s([l()],Y.prototype,"_dragEnabled",null),s([l()],Y.prototype,"_filterEnabled",null),s([l()],Y.prototype,"collapsed",void 0),s([l()],Y.prototype,"dragEnabled",void 0),s([l()],Y.prototype,"filterPlaceholder",void 0),s([l()],Y.prototype,"filterText",void 0),s([l()],Y.prototype,"headingLevel",void 0),s([l()],Y.prototype,"icon",null),s([l()],Y.prototype,"label",null),s([l()],Y.prototype,"listItemCanGiveFunction",void 0),s([l()],Y.prototype,"listItemCanReceiveFunction",void 0),s([l()],Y.prototype,"listItemCreatedFunction",null),s([l()],Y.prototype,"map",null),s([l(),k("esri/widgets/TableList/t9n/TableList")],Y.prototype,"messages",void 0),s([l(),k("esri/t9n/common")],Y.prototype,"messagesCommon",void 0),s([l()],Y.prototype,"minDragEnabledItems",void 0),s([l()],Y.prototype,"minFilterItems",void 0),s([l()],Y.prototype,"multipleSelectionEnabled",null),s([l()],Y.prototype,"selectionEnabled",null),s([l()],Y.prototype,"selectedItems",void 0),s([l()],Y.prototype,"selectionMode",void 0),s([l({readOnly:!0})],Y.prototype,"tableItems",null),s([l()],Y.prototype,"tables",null),s([T("trigger-action"),l({type:W})],Y.prototype,"viewModel",void 0),s([l({type:K,nonNullable:!0})],Y.prototype,"visibleElements",void 0),Y=s([n("esri.widgets.TableList")],Y);const Z=Y;export default Z;
//# sourceMappingURL=p-efeb9bcb.js.map