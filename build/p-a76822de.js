import{d5 as e,a as s,d6 as t,U as o}from"./p-3013819f.js";import"./p-3b51db5e.js";async function r(s,t={},o){await s.load(o);const r=e(s.itemUrl,"resources"),{start:n=1,num:a=10,sortOrder:c="asc",sortField:i="resource"}=t,u={query:{start:n,num:a,sortOrder:c,sortField:i,token:s.apiKey},signal:o?.signal},l=await s.portal.request(r,u);return{total:l.total,nextStart:l.nextStart,resources:l.resources.map((({created:e,size:t,resource:o})=>({created:new Date(e),size:t,resource:s.resourceFromPath(o)})))}}async function n(t,o,r,n){const a=new Map;for(const{resource:e,content:t,compress:n,access:c}of o){if(!e.hasPath())throw new s(`portal-item-resource-${r}:invalid-path`,"Resource does not have a valid path");const[o,u]=i(e.path),l=`${o}/${n??""}/${c??""}`;a.has(l)||a.set(l,{prefix:o,compress:n,access:c,files:[]});a.get(l).files.push({fileName:u,content:t})}await t.load(n);const c=e(t.userItemUrl,"add"===r?"addResources":"updateResources");for(const{prefix:e,compress:s,access:o,files:r}of a.values()){const a=25;for(let i=0;i<r.length;i+=a){const u=r.slice(i,i+a),l=new FormData;e&&"."!==e&&l.append("resourcesPrefix",e),s&&l.append("compress","true"),o&&l.append("access",o);let f=0;for(const{fileName:e,content:s}of u)l.append("file"+ ++f,s,e);l.append("f","json"),await t.portal.request(c,{method:"post",body:l,signal:n?.signal})}}}async function a(t,o,r){if(!o.hasPath())throw new s("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await t.load(r);const n=e(t.userItemUrl,"removeResources");await t.portal.request(n,{method:"post",query:{resource:o.path},signal:r?.signal}),o.portalItem=null}async function c(s,t){await s.load(t);const o=e(s.userItemUrl,"removeResources");return s.portal.request(o,{method:"post",query:{deleteAll:!0},signal:t?.signal})}function i(e){const s=e.lastIndexOf("/");return-1===s?[".",e]:[e.slice(0,s),e.slice(s+1)]}function u(e){const[s,t]=l(e),[o,r]=i(s);return[o,r,t]}function l(e){const s=t(e);return null==s?[e,""]:[e.slice(0,e.length-s.length-1),`.${s}`]}async function f(e){if("blob"===e.type)return e.blob;if("json"===e.type)return new Blob([e.jsonString],{type:"application/json"});return(await o(e.url,{responseType:"blob"})).data}function p(s,t){if(!s.hasPath())return null;const[o,,r]=u(s.path);return s.portalItem.resourceFromPath(e(o,t+r))}function d(s,t){if(!s.hasPath())return null;const[o,,r]=u(s.path);return s.portalItem.resourceFromPath(e(o,t+r))}export{n as addOrUpdateResources,f as contentToBlob,r as fetchResources,p as getSiblingOfSameType,d as getSiblingOfSameTypeI,c as removeAllResources,a as removeResource,u as splitPrefixFileNameAndExtension};
//# sourceMappingURL=p-a76822de.js.map