import{o as t}from"./p-de84037a.js";import{bl as o,gL as n,dd as r}from"./p-aad64c9f.js";import{t as e}from"./p-559f4b2d.js";const f=.45;function a(t,o=.5){switch(t.type){case"CIMPointSymbol":{const o=t.symbolLayers;if(!o||1!==o.length)return null;const n=o[0];return"CIMVectorMarker"!==n.type?null:a(n)}case"CIMVectorMarker":{const n=t.markerGraphics;if(!n||1!==n.length)return null;const r=n[0];if(!r)return null;const e=r.geometry;if(!e)return null;const f=r.symbol;return!f||"CIMPolygonSymbol"!==f.type&&"CIMLineSymbol"!==f.type||f.symbolLayers?.some((t=>!!t.effects))?null:{type:"sdf",geom:e,sdfPaddingRatio:o,asFill:"CIMPolygonSymbol"===f.type}}}}function l(t){return t?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null}function c(t){let o=1/0,n=-1/0,r=1/0,f=-1/0;for(const e of t)for(const t of e)t[0]<o&&(o=t[0]),t[0]>n&&(n=t[0]),t[1]<r&&(r=t[1]),t[1]>f&&(f=t[1]);return new e(o,r,n-o,f-r)}function i(t){let o=1/0,n=-1/0,r=1/0,e=-1/0;for(const f of t)for(const t of f)t[0]<o&&(o=t[0]),t[0]>n&&(n=t[0]),t[1]<r&&(r=t[1]),t[1]>e&&(e=t[1]);return[o,r,n,e]}function s(t){return t?t.rings?i(t.rings):t.paths?i(t.paths):o(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function u(t,o){const[e,f,a,l]=s(t),c=a-e,i=l-f,u=n,h=r,M=Math.floor(.5*(u*o-h)),d=(u-2*(M+h))/Math.max(c,i),m=Math.round(c*d),g=Math.round(i*d);return{pixelDimensions:[c,i],texelDimensions:[Math.round((m+2*M)/d),Math.round((g+2*M)/d)]}}function h(t,o,e,a,l,c,i){const[s,u,h,M]=t;if(h<s||M<u)return{frameSizeRatio:0,anchorX:0,anchorY:0,widthRatio:1,sdfPaddingRatio:.5};const d=h-s,m=M-u,g=Math.max(d,m);let p=.5;if(null!=c&&null!=e){if(!i&&null!=o){c*=(o.ymax-o.ymin)/e}const t=c/(c+g),n=.1;t>f&&t<1&&(p=Math.min(t+n,.99))}const y=n,R=r,w=Math.floor(.5*(y*p-R)),C=(y-2*(w+R))/g,P=Math.round(d*C)+2*w,b=Math.round(m*C)+2*w;let I=1;if(o){I=b*(1-p)/((o.ymax-o.ymin)*C)}let S=0,v=0,j=1;a&&(l?o&&e&&o.ymax-o.ymin>0&&(j=(o.xmax-o.xmin)/(o.ymax-o.ymin),S=a.x/(e*j),v=a.y/e):(S=a.x,v=a.y)),o&&(S=.5*(o.xmax+o.xmin)+S*(o.xmax-o.xmin),v=.5*(o.ymax+o.ymin)+v*(o.ymax-o.ymin)),S-=s,v-=u,S*=C,v*=C,S+=w,v+=w;let x=S/P-.5,D=v/b-.5;return l&&e&&(x*=e*j,D*=e),{frameSizeRatio:I,anchorX:x,anchorY:D,widthRatio:j,sdfPaddingRatio:p}}function M(t){const o=l(t.geom),e=c(o),f=n,a=r,i=Math.floor(.5*(f*t.sdfPaddingRatio-a)),s=f-2*(i+a),u=s/Math.max(e.width,e.height),h=Math.round(e.width*u)+2*i,M=Math.round(e.height*u)+2*i,p=[];for(const n of o)if(n&&n.length>1){const o=[];for(const r of n){let[n,f]=r;n-=e.x,f-=e.y,n*=u,f*=u,n+=i-.5,f+=i-.5,t.asFill?o.push([n,f]):o.push([Math.round(n),Math.round(f)])}if(t.asFill){const t=o.length-1;o[0][0]===o[t][0]&&o[0][1]===o[t][1]||o.push(o[0])}p.push(o)}const y=d(p,h,M,i);return t.asFill&&m(p,h,M,i,y),{data:g(y,i),width:h,height:M,sdfPaddingRatio:t.sdfPaddingRatio,sdfDecodeCoeff:2*i/s}}function d(t,o,n,r){const e=o*n,f=new Array(e),a=r*r+1;for(let t=0;t<e;++t)f[t]=a;for(const e of t){const t=e.length;for(let a=1;a<t;++a){const t=e[a-1],l=e[a];let c,i,s,u;t[0]<l[0]?(c=t[0],i=l[0]):(c=l[0],i=t[0]),t[1]<l[1]?(s=t[1],u=l[1]):(s=l[1],u=t[1]);let h=Math.floor(c)-r,M=Math.floor(i)+r,d=Math.floor(s)-r,m=Math.floor(u)+r;h<0&&(h=0),M>o&&(M=o),d<0&&(d=0),m>n&&(m=n);const g=l[0]-t[0],p=l[1]-t[1],y=g*g+p*p;for(let r=h;r<M;r++)for(let e=d;e<m;e++){const a=r+.5,c=e+.5;let i,s,u=(a-t[0])*g+(c-t[1])*p;u<0?(i=t[0],s=t[1]):u>y?(i=l[0],s=l[1]):(u/=y,i=t[0]+u*g,s=t[1]+u*p);const h=(a-i)*(a-i)+(c-s)*(c-s),M=(n-e-1)*o+r;h<f[M]&&(f[M]=h)}}}for(let t=0;t<e;++t)f[t]=Math.sqrt(f[t]);return f}function m(t,o,n,r,e){for(const f of t){const t=f.length;for(let a=1;a<t;++a){const t=f[a-1],l=f[a];let c,i,s,u;t[0]<l[0]?(c=t[0],i=l[0]):(c=l[0],i=t[0]),t[1]<l[1]?(s=t[1],u=l[1]):(s=l[1],u=t[1]);let h=Math.floor(c),M=Math.floor(i)+1,d=Math.floor(s),m=Math.floor(u)+1;h<r&&(h=r),M>o-r&&(M=o-r),d<r&&(d=r),m>n-r&&(m=n-r);for(let f=d;f<m;++f){if(t[1]>f==l[1]>f)continue;const a=f+.5,c=(n-f-1)*o;for(let o=h;o<M;++o){o+.5<(l[0]-t[0])*(a-t[1])/(l[1]-t[1])+t[0]&&(e[c+o]=-e[c+o])}for(let t=r;t<h;++t)e[c+t]=-e[c+t]}}}}function g(o,n){const r=2*n,e=o.length,f=new Uint8Array(4*e);for(let n=0;n<e;++n){const e=.5-o[n]/r;t(e,f,4*n)}return f}export{a,u as c,h,s as m,M as u};
//# sourceMappingURL=p-be38a32f.js.map