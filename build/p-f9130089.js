import{m as t}from"./p-1cf43261.js";import{a as n,B as r,U as i,G as e,Q as a,b as o,r as f,av as s,y as u,T as c}from"./p-2b5b515f.js";import{x as p,a as m}from"./p-a20ea8a0.js";import"./p-3013819f.js";import"./p-3b51db5e.js";import"./p-7db7fa08.js";import"./p-4953a39e.js";import"./p-ec95a4fb.js";import"./p-1f0b604e.js";import"./p-347800d3.js";import"./p-94b15954.js";async function j(t,n,e,o,f,c){if(1===o.length){if(i(o[0]))return s(t,o[0],u(o[1],-1));if(a(o[0]))return s(t,o[0].toArray(),u(o[1],-1))}else if(2===o.length){if(i(o[0]))return s(t,o[0],u(o[1],-1));if(a(o[0]))return s(t,o[0].toArray(),u(o[1],-1));if(r(o[0])){const r=await o[0].load(),i=await w(p.create(o[1],r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC),c,f);return b(f,await o[0].calculateStatistic(t,i,u(o[2],1e3),n.abortSignal))}}else if(3===o.length&&r(o[0])){const r=await o[0].load(),i=await w(p.create(o[1],r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC),c,f);return b(f,await o[0].calculateStatistic(t,i,u(o[2],1e3),n.abortSignal))}return s(t,o,-1)}function b(n,r){return r instanceof m?t.fromReaderAsTimeStampOffset(r.toStorageFormat()):r instanceof Date?t.dateJSAndZoneToArcadeDate(r,c(n)):r}async function w(t,n,r){const i=t.getVariables();if(i.length>0){const e=[];for(let t=0;t<i.length;t++){const a={name:i[t]};e.push(await n.evaluateIdentifier(r,a))}const a={};for(let t=0;t<i.length;t++)a[i[t]]=e[t];return t.parameters=a,t}return t}function d(t){"async"===t.mode&&(t.functions.stdev=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("stdev",r,i,e,n,t)))},t.functions.variance=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("variance",r,i,e,n,t)))},t.functions.average=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("mean",r,i,e,n,t)))},t.functions.mean=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("mean",r,i,e,n,t)))},t.functions.sum=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("sum",r,i,e,n,t)))},t.functions.min=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("min",r,i,e,n,t)))},t.functions.max=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("max",r,i,e,n,t)))},t.functions.count=function(s,u){return t.standardFunctionAsync(s,u,((t,c,p)=>{if(n(p,1,1,s,u),r(p[0]))return p[0].count(t.abortSignal);if(i(p[0])||e(p[0]))return p[0].length;if(a(p[0]))return p[0].length();throw new o(s,f.InvalidParameter,u)}))})}export{d as registerFunctions};
//# sourceMappingURL=p-f9130089.js.map