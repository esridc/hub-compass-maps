import{m as t}from"./p-ecde740d.js";import{a as n,B as r,U as i,G as e,Q as a,b as o,r as s,av as u,y as f,T as c}from"./p-32a39338.js";import{x as p,a as m}from"./p-70a81651.js";import"./p-028496e2.js";import"./p-3b51db5e.js";import"./p-7db7fa08.js";import"./p-2b21de69.js";import"./p-854d8fad.js";import"./p-1f0b604e.js";import"./p-347800d3.js";import"./p-94b15954.js";async function j(t,n,e,o,s,c){if(1===o.length){if(i(o[0]))return u(t,o[0],f(o[1],-1));if(a(o[0]))return u(t,o[0].toArray(),f(o[1],-1))}else if(2===o.length){if(i(o[0]))return u(t,o[0],f(o[1],-1));if(a(o[0]))return u(t,o[0].toArray(),f(o[1],-1));if(r(o[0])){const r=await o[0].load(),i=await w(p.create(o[1],r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC),c,s);return d(s,await o[0].calculateStatistic(t,i,f(o[2],1e3),n.abortSignal))}}else if(3===o.length&&r(o[0])){const r=await o[0].load(),i=await w(p.create(o[1],r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC),c,s);return d(s,await o[0].calculateStatistic(t,i,f(o[2],1e3),n.abortSignal))}return u(t,o,-1)}function d(n,r){return r instanceof m?t.fromReaderAsTimeStampOffset(r.toStorageFormat()):r instanceof Date?t.dateJSAndZoneToArcadeDate(r,c(n)):r}async function w(t,n,r){const i=t.getVariables();if(i.length>0){const e=[];for(let t=0;t<i.length;t++){const a={name:i[t]};e.push(await n.evaluateIdentifier(r,a))}const a={};for(let t=0;t<i.length;t++)a[i[t]]=e[t];return t.parameters=a,t}return t}function b(t){"async"===t.mode&&(t.functions.stdev=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("stdev",r,i,e,n,t)))},t.functions.variance=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("variance",r,i,e,n,t)))},t.functions.average=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("mean",r,i,e,n,t)))},t.functions.mean=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("mean",r,i,e,n,t)))},t.functions.sum=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("sum",r,i,e,n,t)))},t.functions.min=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("min",r,i,e,n,t)))},t.functions.max=function(n,r){return t.standardFunctionAsync(n,r,((r,i,e)=>j("max",r,i,e,n,t)))},t.functions.count=function(u,f){return t.standardFunctionAsync(u,f,((t,c,p)=>{if(n(p,1,1,u,f),r(p[0]))return p[0].count(t.abortSignal);if(i(p[0])||e(p[0]))return p[0].length;if(a(p[0]))return p[0].length();throw new o(u,s.InvalidParameter,f)}))})}export{b as registerFunctions};
//# sourceMappingURL=p-76577e1c.js.map