import{N as t,B as e,r as i,c as n,h as s,H as r}from"./p-3b51db5e.js";function o(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}function a(t,e){return function(i,n){e(i,n,t)}}function l(t,e,i,n){function s(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):s(t.value).then(o,a)}l((n=n.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;let u;function c(t){return"function"==typeof u[t]?u[t]=u[t](globalThis):u[t]}u=globalThis.dojoConfig?.has||globalThis.esriConfig?.has?{...globalThis.dojoConfig?.has,...globalThis.esriConfig?.has}:{},c.add=(t,e,i,n)=>((n||void 0===u[t])&&(u[t]=e),i&&c(t)),c.cache=u,c.add("big-integer-warning-enabled",!0),c.add("esri-deprecation-warnings",!0),c.add("esri-tests-disable-screenshots",!1),c.add("esri-tests-use-full-window",!1),c.add("esri-tests-post-to-influx",!0),(()=>{c.add("host-webworker",void 0!==globalThis.WorkerGlobalScope&&self instanceof globalThis.WorkerGlobalScope);const t="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(c.add("host-browser",t),c.add("host-node","object"==typeof globalThis.process&&globalThis.process.versions?.node&&globalThis.process.versions.v8),c.add("dom",t),c("host-browser")){const t=navigator,e=t.userAgent,i=t.appVersion,n=parseFloat(i);if(c.add("wp",parseFloat(e.split("Windows Phone")[1])||void 0),c.add("msapp",parseFloat(e.split("MSAppHost/")[1])||void 0),c.add("khtml",i.includes("Konqueror")?n:void 0),c.add("edge",parseFloat(e.split("Edge/")[1])||void 0),c.add("opr",parseFloat(e.split("OPR/")[1])||void 0),c.add("webkit",!c("wp")&&!c("edge")&&parseFloat(e.split("WebKit/")[1])||void 0),c.add("chrome",!c("edge")&&!c("opr")&&parseFloat(e.split("Chrome/")[1])||void 0),c.add("android",!c("wp")&&parseFloat(e.split("Android ")[1])||void 0),c.add("safari",!i.includes("Safari")||c("wp")||c("chrome")||c("android")||c("edge")||c("opr")?void 0:parseFloat(i.split("Version/")[1])),c.add("mac",i.includes("Macintosh")),!c("wp")&&/(iPhone|iPod|iPad)/.test(e)){const t=RegExp.$1.replace(/P/,"p"),i=/OS ([\d_]+)/.test(e)?RegExp.$1:"1",n=parseFloat(i.replace(/_/,".").replaceAll("_",""));c.add(t,n),c.add("ios",n)}c("webkit")||(!e.includes("Gecko")||c("wp")||c("khtml")||c("edge")||c.add("mozilla",n),c("mozilla")&&c.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&c.add("esri-mobile",e),i&&c.add("esri-iPhone",i),c.add("esri-geolocation",!!navigator.geolocation)}c.add("esri-wasm","WebAssembly"in globalThis),c.add("esri-performance-mode-frames-between-render",20),c.add("esri-force-performance-mode",!1),c.add("esri-shared-array-buffer",(()=>{const t="SharedArrayBuffer"in globalThis,e=!1===globalThis.crossOriginIsolated;return t&&!e})),c.add("wasm-simd",(()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))})),c.add("esri-atomics","Atomics"in globalThis),c.add("esri-workers","Worker"in globalThis),c.add("web-feat:cache","caches"in globalThis),c.add("esri-workers-arraybuffer-transfer",!c("safari")||Number(c("safari"))>=12),c.add("workers-pool-size",8),c.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),c.add("featurelayer-simplify-payload-size-factors",[1,1,4]),c.add("featurelayer-fast-triangulation-enabled",!0),c.add("featurelayer-animation-enabled",!0),c.add("featurelayer-snapshot-enabled",!0),c.add("featurelayer-snapshot-point-min-threshold",8e4),c.add("featurelayer-snapshot-point-max-threshold",4e5),c.add("featurelayer-snapshot-point-coverage",.1),c.add("featurelayer-query-max-depth",4),c.add("featurelayer-query-pausing-enabled",!1),c.add("hittest-2d-mobile-tolerance",3),c.add("hittest-2d-desktop-tolerance",1),c.add("hittest-2d-small-symbol-tolerance",3),c.add("hittest-2d-small-symbol-tolerance-threshold",3),c.add("featurelayer-advanced-symbols",!1),c.add("featurelayer-pbf",!0),c.add("featurelayer-pbf-statistics",!1),c.add("feature-layers-workers",!0),c.add("feature-polyline-generalization-factor",1),c.add("mapview-transitions-duration",200),c.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),c.add("mapserver-pbf-version-support",10.81),c.add("mapservice-popup-identify-max-tolerance",20),c("host-webworker")||c("host-browser")&&(c.add("esri-csp-restrictions",(()=>{try{new Function}catch{return!0}return!1})),c.add("esri-image-decode",(()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then((()=>{c.add("esri-image-decode",!0,!0,!0)})).catch((()=>{c.add("esri-image-decode",!1,!0,!0)}))}return!1})),c.add("esri-url-encodes-apostrophe",(()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")})))})();const h=new WeakMap;function d(t,e,i=!1){const n=`🛑 DEPRECATED - ${e}`;if(!i)return void t.warn(n);let s=h.get(t);s||(s=new Set,h.set(t,s)),s.has(e)||(s.add(e),t.warn(n))}function f(t,e,i={}){if(c("esri-deprecation-warnings")){const{moduleName:n}=i;m(t,`Function: ${(n?n+"::":"")+e+"()"}`,i)}}function p(t,e,i={}){if(c("esri-deprecation-warnings")){const{moduleName:n}=i;m(t,`Property: ${(n?n+"::":"")+e}`,i)}}function m(t,e,i={}){if(c("esri-deprecation-warnings")){const{replacement:n,version:s,see:r,warnOnce:o}=i;let a=e;n&&(a+=`\n\t🛠️ Replacement: ${n}`),s&&(a+=`\n\t⚙️ Version: ${s}`),r&&(a+=`\n\t🔗 See ${r} for more details.`),d(t,a,o)}}function y(t){const e=[];return function*(){yield*e;for(const i of t)e.push(i),yield i}}function g(t,e){for(const i of t)if(null!=i&&e(i))return i}function v(t){return null!=t&&"function"==typeof t[Symbol.iterator]}class w{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach((e=>{t+=e.length})),t}add(t,e){if(v(t)){const i=this._getOrCreateGroup(e);for(const e of t)this._isHandle(e)&&i.push(e)}else if(this._isHandle(t)){this._getOrCreateGroup(e).push(t)}return this}forEach(t,e){if("function"==typeof t)this._groups.forEach((e=>e.forEach(t)));else{const i=this._getGroup(t);i&&e&&i.forEach(e)}}has(t){return this._groups.has(this._ensureGroupKey(t))}remove(t){if("string"!=typeof t&&v(t)){for(const e of t)this.remove(e);return this}return this.has(t)?(this._removeAllFromGroup(this._getGroup(t)),this._groups.delete(this._ensureGroupKey(t)),this):this}removeAll(){return this._groups.forEach((t=>this._removeAllFromGroup(t))),this._groups.clear(),this}_isHandle(t){return t&&(!!t.remove||t instanceof w)}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const e=[];return this._groups.set(this._ensureGroupKey(t),e),e}_getGroup(t){return this._groups.get(this._ensureGroupKey(t))}_ensureGroupKey(t){return t||"_default_"}_removeAllFromGroup(t){for(const e of t)e instanceof w?e.removeAll():e.remove()}}class b{constructor(t=1){this._seed=t}set seed(t){this._seed=t??Math.random()*b._m}getInt(){return this._seed=(b._a*this._seed+b._c)%b._m,this._seed}getFloat(){return this.getInt()/(b._m-1)}getIntRange(t,e){return Math.round(this.getFloatRange(t,e))}getFloatRange(t,e){const i=e-t;return t+this.getInt()/b._m*i}}b._m=2147483647,b._a=48271,b._c=0;function S(t,e){for(let i=t.length-1;i>=0;i--){const n=t[i];if(e(n))return n}}function x(t,e){return e?t.filter(((t,i,n)=>n.findIndex(e.bind(null,t))===i)):Array.from(new Set(t))}function _(t,e,i){if(null==t&&null==e)return!0;if(null==t||null==e||t.length!==e.length)return!1;if(i){for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function M(t,e){let i=t.length!==e.length;i&&(t.length=e.length);for(let n=0;n<e.length;++n)t[n]!==e[n]&&(t[n]=e[n],i=!0);return i}function k(t,e,i){let n,s;return i?(n=e.filter((e=>!t.some((t=>i(t,e))))),s=t.filter((t=>!e.some((e=>i(e,t)))))):(n=e.filter((e=>!t.includes(e))),s=t.filter((t=>!e.includes(t)))),{added:n,removed:s}}function T(t){return t&&"number"==typeof t.length}const A=!!Array.prototype.fill;function I(t,e){if(A)return new Array(t).fill(e);const i=new Array(t);for(let n=0;n<t;n++)i[n]=e;return i}function j(t,e){void 0===e&&(e=t,t=0);const i=new Array(e-t);for(let n=t;n<e;n++)i[n-t]=n;return i}class C{constructor(){this.last=0}}const E=new C;function O(t,e,i,n){n=n||E;const s=Math.max(0,n.last-10);for(let r=s;r<i;++r)if(t[r]===e)return n.last=r,r;const r=Math.min(s,i);for(let i=0;i<r;++i)if(t[i]===e)return n.last=i,i;return-1}function L(t,e,i,n){const s=i??t.length,r=O(t,e,s,n);if(-1!==r)return t[r]=t[s-1],null==i&&t.pop(),e}const N=new Set;function R(t,e,i=t.length,n=e.length,s,r){if(0===n||0===i)return i;N.clear();for(let t=0;t<n;++t)N.add(e[t]);s=s||E;const o=Math.max(0,s.last-10);for(let e=o;e<i;++e)if(N.has(t[e])&&(r?.push(t[e]),N.delete(t[e]),t[e]=t[i-1],--i,--e,0===N.size||0===i))return N.clear(),i;for(let e=0;e<o;++e)if(N.has(t[e])&&(r?.push(t[e]),N.delete(t[e]),t[e]=t[i-1],--i,--e,0===N.size||0===i))return N.clear(),i;return N.clear(),i}function P(t,e){const i=t.indexOf(e);return-1!==i?(t.splice(i,1),e):null}function F(t,e){return null!=t}function D(t){return 32+t.length}function $(){return 16}function z(t){if(!t)return 0;let e=q;for(const i in t)if(t.hasOwnProperty(i)){const n=t[i];switch(typeof n){case"string":e+=D(n);break;case"number":e+=$();break;case"boolean":e+=4}}return e}function U(t){if(!t)return 0;if(Array.isArray(t))return V(t);let e=q;for(const i in t)t.hasOwnProperty(i)&&(e+=G(t[i]));return e}function V(t){const e=t.length;if(0===e||"number"==typeof t[0])return 32+8*e;let i=H;for(let n=0;n<e;n++)i+=G(t[n]);return i}function G(t){switch(typeof t){case"object":return U(t);case"string":return D(t);case"number":return $();case"boolean":return 4;default:return 8}}function B(t,e){return H+t.length*e}const q=32,H=16;function W(t){return t instanceof ArrayBuffer}function Z(t){return"Int8Array"===t?.constructor?.name}function J(t){return"Uint8Array"===t?.constructor?.name}function K(t){return"Uint8ClampedArray"===t?.constructor?.name}function Y(t){return"Int16Array"===t?.constructor?.name}function Q(t){return"Uint16Array"===t?.constructor?.name}function X(t){return"Int32Array"===t?.constructor?.name}function tt(t){return"Uint32Array"===t?.constructor?.name}function et(t){return"Float32Array"===t?.constructor?.name}function it(t){return"Float64Array"===t?.constructor?.name}function nt(t){return!("buffer"in t)}function st(...t){return t.reduce(((t,e)=>t+(e?nt(e)?B(e,$()):e.byteLength+rt:0)),0)}const rt=145,ot=1024;function at(t){return it(t)||et(t)||X(t)||Y(t)||Z(t)}function lt(t){return it(t)||et(t)}function ut(t){return it(t)?179769e303:et(t)?3402823e32:tt(t)?4294967295:Q(t)?65535:J(t)||K(t)?255:X(t)?2147483647:Y(t)?32767:Z(t)?127:256}function ct(t,e){let i;if(e)for(i in t)t.hasOwnProperty(i)&&(void 0===t[i]?delete t[i]:t[i]instanceof Object&&ct(t[i],!0));else for(i in t)t.hasOwnProperty(i)&&void 0===t[i]&&delete t[i];return t}function ht(t){if(!t||"object"!=typeof t||"function"==typeof t)return t;const e=gt(t);if(null!=e)return e;if(ft(t))return t.clone();if(pt(t))return t.map(ht);if(mt(t))return t.clone();const i={};for(const e of Object.getOwnPropertyNames(t))i[e]=ht(t[e]);return i}function dt(t){if(!t||"object"!=typeof t||"function"==typeof t||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=gt(t);if(null!=e)return e;if(pt(t)){let e=!0;const i=t.map((t=>{const i=dt(t);return null!=t&&null==i&&(e=!1),i}));return e?i:null}if(ft(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(!mt(t)){const e=new(Object.getPrototypeOf(t).constructor);for(const i of Object.getOwnPropertyNames(t)){const n=t[i],s=dt(n);if(null!=n&&null==s)return null;e[i]=s}return e}return null}function ft(t){return"function"==typeof t.clone}function pt(t){return"function"==typeof t.map&&"function"==typeof t.forEach}function mt(t){return"function"==typeof t.notifyChange&&"function"==typeof t.watch}function yt(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function gt(t){if(Z(t)||J(t)||K(t)||Y(t)||Q(t)||X(t)||tt(t)||et(t)||it(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer){return t.slice(0,t.byteLength)}if(t instanceof Map){const e=new Map;for(const[i,n]of t)e.set(i,ht(n));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(ht(i));return e}return null}function vt(t,e){return t===e||"number"==typeof t&&isNaN(t)&&"number"==typeof e&&isNaN(e)||"function"==typeof t?.getTime&&"function"==typeof e?.getTime&&t.getTime()===e.getTime()||!1}function wt(t,e){return t===e||(null==t||"string"==typeof t?t===e:"number"==typeof t?t===e||"number"==typeof e&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&_(t,e):t instanceof Set?e instanceof Set&&St(t,e):t instanceof Map?e instanceof Map&&xt(t,e):!!yt(t)&&(yt(e)&&bt(t,e)))}function bt(t,e){if(null===t||null===e)return!1;const i=Object.keys(t);if(null===e||Object.keys(e).length!==i.length)return!1;for(const n of i)if(t[n]!==e[n]||!Object.prototype.hasOwnProperty.call(e,n))return!1;return!0}function St(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function xt(t,e){if(t.size!==e.size)return!1;for(const[i,n]of t){const t=e.get(i);if(t!==n||void 0===t&&!e.has(i))return!1}return!0}function _t(t,e,i=!1){return At(t,e,i)}function Mt(t,e){if(null!=e)return e[t]||Tt(t.split("."),!1,e)}function kt(t,e,i){const n=t.split("."),s=n.pop(),r=Tt(n,!0,i);r&&s&&(r[s]=e)}function Tt(t,e,i){let n=i;for(const i of t){if(null==n)return;if(!(i in n)){if(!e)return;n[i]={}}n=n[i]}return n}function At(t,e,i){return e?Object.keys(e).reduce(((t,n)=>{let s=t[n],r=e[n];return s===r?t:void 0===s?(t[n]=ht(r),t):(Array.isArray(r)||Array.isArray(t)?(s=s?Array.isArray(s)?t[n]=s.concat():t[n]=[s]:t[n]=[],r&&(Array.isArray(r)||(r=[r]),i?r.forEach((t=>{s.includes(t)||s.push(t)})):t[n]=r.concat())):r&&"object"==typeof r?t[n]=At(s,r,i):t.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(t[n]=r),t)}),t||{}):t}const It={apiKey:void 0,applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(_t(It,globalThis.esriConfig,!0),delete It.has),!It.assetsPath){{const t="4.29";It.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}It.defaultAssetsPath=It.assetsPath}const jt=/\{([^\}]+)\}/g;function Ct(t){return t??""}function Et(t,e){return e?t.replaceAll(jt,"object"==typeof e?(t,i)=>Ct(Mt(i,e)):(t,i)=>Ct(e(i))):t}function Ot(t,e){return t.replaceAll(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(t=>e&&e.includes(t)?t:`\\${t}`))}function Lt(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}function Nt(t){return(new DOMParser).parseFromString(t||"","text/html").body.innerText||""}function Rt(t,e){return new RegExp(`{${e}}`,"ig").test(t)}const Pt={info:0,warn:1,error:2,none:3};class Ft{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=t.level&&(this.level=t.level),null!=t.writer&&(this.writer=t.writer),this._module=t.module,Ft._loggers.set(this.module,this);const e=this.module.lastIndexOf(".");-1!==e&&(this._parent=Ft.getLogger(this.module.slice(0,e)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){const t=this;return{loggedMessages:t._loggedMessages,clearLoggedWarnings:()=>t._loggedMessages.warn.clear()}}static get test(){return{resetLoggers(t=new Map){const e=Ft._loggers;return Ft._loggers=t,e},set throttlingDisabled(t){Ft._throttlingDisabled=t}}}static getLogger(t){return t="string"!=typeof t?t.declaredClass:t,Ft._loggers.get(t)||new Ft({module:t})}_log(t,e,...i){if(!this._matchLevel(t))return;if("always"!==e&&!Ft._throttlingDisabled){const n=this._argsToKey(i),s=this._loggedMessages[t].get(n);if("once"===e&&null!=s||"oncePerTick"===e&&s&&s>=Ft._tickCounter)return;this._loggedMessages[t].set(n,Ft._tickCounter),Ft._scheduleTickCounterIncrement()}for(const e of It.log.interceptors)if(e(t,this.module,...i))return;this._inheritedWriter()(t,this.module,...i)}_parentWithMember(t,e){let i=this;for(;null!=i;){const e=i[t];if(null!=e)return e;i=i.parent}return e}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(t,e,...i){console[t](`[${e}]`,...i)}_matchLevel(t){const e=It.log.level||"warn";return Pt[this._parentWithMember("level",e)]<=Pt[t]}_argsToKey(...t){const e=(t,e)=>"object"!=typeof e||Array.isArray(e)?e:"[Object]";return Lt(JSON.stringify(t,e))}static _scheduleTickCounterIncrement(){Ft._tickCounterScheduled||(Ft._tickCounterScheduled=!0,Promise.resolve().then((()=>{Ft._tickCounter++,Ft._tickCounterScheduled=!1})))}}Ft._loggers=new Map,Ft._tickCounter=0,Ft._tickCounterScheduled=!1,Ft._throttlingDisabled=!1;function Dt(t,e){if(null==t)throw new Error(e??"value is None")}function $t(t){return t?.destroy(),null}function zt(t){return t?.dispose(),null}function Ut(t){return t?.remove(),null}function Vt(t){return t?.abort(),null}function Gt(t){return t?.release(),null}function Bt(t,e,i){return null!=t&&null!=e?null!=i?i(t,e):t.equals(e):t===e}function qt(t,e){let i;return t.some(((t,n)=>(i=e(t,n),null!=i))),i??void 0}const Ht=Symbol("Accessor-beforeDestroy");const Wt={remove:()=>{}};function Zt(t){return t?{remove(){t&&(t(),t=void 0)}}:Wt}function Jt(t){t.forEach((t=>t?.remove()))}function Kt(t){return Zt((()=>Jt(t)))}function Yt(t){return t.__accessor__??null}function Qt(t,e){return null!=t?.metadata?.[e]}function Xt(t,e,i){if(i){return te(t,e,{policy:i,path:""})}return te(t,e,null)}function te(t,e,i){return e?Object.keys(e).reduce(((t,n)=>{const s=n;let r=null,o="merge";if(i&&(r=i.path?`${i.path}.${n}`:n,o=i.policy(r)),"replace"===o)return t[s]=e[s],t;if("replace-arrays"===o&&Array.isArray(t[s]))return t[s]=e[s],t;if(void 0===t[s])return t[s]=ht(e[s]),t;let a=t[s],l=e[s];if(a===l)return t;if(Array.isArray(l)||Array.isArray(t))a=a?Array.isArray(a)?t[s]=a.concat():t[s]=[a]:t[s]=[],l&&(Array.isArray(l)||(l=[l]),l.forEach((t=>{a.includes(t)||a.push(t)})));else if(l&&"object"==typeof l)if(i){const e=i.path;i.path=r,t[s]=te(a,l,i),i.path=e}else t[s]=te(a,l,null);else t.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(t[s]=l);return t}),t||{}):t}function ee(t){return Array.isArray(t)?t:t.split(".")}function ie(t){return t.includes(",")?t.split(",").map((t=>t.trim())):[t.trim()]}function ne(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...ie(i));return e}return ie(t)}function se(t,e,i,n){const s=ne(e);if(1!==s.length){const e=s.map((e=>n(t,e,i)));return Kt(e)}return n(t,s[0],i)}function re(t,e){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.at(t)}const n=Yt(e);return Qt(n,i)?n.get(i):e[i]}function oe(t,e,i){if(null==t)return t;const n=re(e[i],t);return!n&&i<e.length-1?void 0:i===e.length-1?n:oe(n,e,i+1)}function ae(t,e,i=0){return"string"!=typeof e||e.includes(".")?oe(t,ee(e),i):re(e,t)}function le(t,e){return ae(t,e)}function ue(t,e){return void 0!==ae(e,t)}var ce;!function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED",t[t.DESTROYED=3]="DESTROYED"}(ce||(ce={}));function he(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const t in e)e[t]=ht(e[t]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function de(t,e){const i=he(t);let n=i[e];return n||(n=i[e]={}),n}function fe(t,e){return Xt(t,e,me)}const pe=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function me(t){return pe.test(t)?"replace":"merge"}function ye(t){return t?.release&&"function"==typeof t.release}function ge(t){return t?.acquire&&"function"==typeof t.acquire}class ve{constructor(t,e,i,n=1,s=0){if(this._ctor=t,this._acquireFunction=e,this._releaseFunction=i,this.allocationSize=n,this._pool=new Array(s),this._initialSize=s,this._ctor)for(let t=0;t<s;t++)this._pool[t]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...t){let e;if(ve.test.disabled)e=new this._ctor;else{if(0===this._pool.length){const t=this.allocationSize;for(let e=0;e<t;e++)this._pool[e]=new this._ctor}e=this._pool.pop()}return this._acquireFunction?this._acquireFunction(e,...t):ge(e)&&e.acquire(...t),e}release(t){t&&!ve.test.disabled&&(this._releaseFunction?this._releaseFunction(t):ye(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let e=t;e<this._pool.length;++e){const t=this._pool[e];this._dispose(t)}this._pool.length=t}}_dispose(t){t.dispose&&"function"==typeof t.dispose&&t.dispose()}}ve.test={disabled:!1};class we{constructor(t,e){this._observers=t,this._observer=e}remove(){P(this._observers,this._observer)}}class be{constructor(){this._observers=null,this.destroyed=!1}observe(t){if(this.destroyed||t.destroyed)return Se;null==this._observers&&(this._observers=[]);const e=this._observers;let i=!1,n=!1;const s=e.length;for(let r=0;r<s;++r){const s=e[r];if(s.destroyed)n=!0;else if(s===t){i=!0;break}}return i||(e.push(t),n&&this._removeDestroyedObservers()),new we(e,t)}_removeDestroyedObservers(){const t=this._observers;if(!t||0===t.length)return;const e=t.length;let i=0;for(let n=0;n<e;++n){for(;n+i<e;){if(!t[n+i].destroyed)break;++i}if(i>0){if(!(n+i<e))break;t[n]=t[n+i]}}t.length=e-i}destroy(){if(this.destroyed)return;this.destroyed=!0;const t=this._observers;if(null!=t){for(const e of t)e.onCommitted();this._observers=null}}}const Se=Zt();var xe;!function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"}(xe||(xe={}));const _e=xe.USER+1;function Me(t){switch(t){case"defaults":return xe.DEFAULTS;case"service":return xe.SERVICE;case"portal-item":return xe.PORTAL_ITEM;case"web-scene":return xe.WEB_SCENE;case"web-map":return xe.WEB_MAP;case"link-chart":return xe.LINK_CHART;case"user":return xe.USER;default:return null}}function ke(t){switch(t){case xe.DEFAULTS:return"defaults";case xe.SERVICE:return"service";case xe.PORTAL_ITEM:return"portal-item";case xe.WEB_SCENE:return"web-scene";case xe.WEB_MAP:return"web-map";case xe.LINK_CHART:return"link-chart";case xe.USER:return"user"}}function Te(t){return ke(t)}var Ae;!function(t){t[t.Dirty=1]="Dirty",t[t.Overridden=2]="Overridden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"}(Ae||(Ae={}));const Ie={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},je=[];let Ce=Ie;function Ee(t){Ce.onObservableAccessed(t)}let Oe=!1,Le=!1;function Ne(t,e,i){if(Oe)return Pe(t,e,i);Fe(t);const n=e.call(i);return De(),n}function Re(t,e){return Ne(Ie,t,e)}function Pe(t,e,i){const n=Oe;Oe=!0,Fe(t);let s=null;try{s=e.call(i)}catch(t){Le&&Ft.getLogger("esri.core.accessorSupport.tracking").error(t)}return De(),Oe=n,s}function Fe(t){Ce=t,je.push(t)}function De(){const t=je.length;if(t>1){const e=je.pop();Ce=je[t-2],e.onTrackingEnd()}else if(1===t){const t=je.pop();Ce=Ie,t.onTrackingEnd()}else Ce=Ie}function $e(t,e){if(e.flags&Ae.DepTrackingInitialized)return;const i=Le;Le=!1,e.flags&Ae.AutoTracked?Pe(e,e.metadata.get,t):Ue(t,e),Le=i}const ze=[];function Ue(t,e){e.flags&Ae.ExplicitlyTracking||(e.flags|=Ae.ExplicitlyTracking,Pe(e,(()=>{const i=e.metadata.dependsOn||ze;for(const e of i)if("string"!=typeof e||e.includes(".")){const i=ee(e);for(let e=0,n=t;e<i.length&&null!=n&&"object"==typeof n;++e)n=Ve(n,i[e],e!==i.length-1)}else Ve(t,e,!1)})),e.flags&=~Ae.ExplicitlyTracking)}function Ve(t,e,i){const n="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(n,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.at(e)}const s=Yt(t);if(s){const e=s.propertiesByName.get(n);e&&(Ee(e),$e(t,e))}return i?t[n]:void 0}class Ge extends be{constructor(t,e){super(),this.propertyName=t,this.metadata=e,this._accessed=null,this._handles=null,this.flags=0,this.flags=Ae.Dirty|(e.nonNullable?Ae.NonNullable:0)|(e.hasOwnProperty("value")?Ae.HasDefaultValue:0)|(void 0===e.get?Ae.DepTrackingInitialized:0)|(void 0===e.dependsOn?Ae.AutoTracked:0)}destroy(){this.flags&Ae.Dirty&&this.onCommitted(),super.destroy(),this._accessed=null,this._clearObservationHandles()}getComputed(t){Ee(this);const e=t.store,i=this.propertyName,n=this.flags,s=e.get(i);if(n&Ae.Computing)return s;if(~n&Ae.Dirty&&e.has(i))return s;this.flags|=Ae.Computing;const r=t.host;let o;n&Ae.AutoTracked?o=Ne(this,this.metadata.get,r):(Ue(r,this),o=this.metadata.get.call(r)),e.set(i,o,xe.COMPUTED);const a=e.get(i);return a===s?this.flags&=~Ae.Dirty:Re(this.commit,this),this.flags&=~Ae.Computing,a}onObservableAccessed(t){if(t===this)return;let e=this._accessed;if(null==e)e=[],this._accessed=e;else if(e.includes(t))return;e.push(t)}onTrackingEnd(){this._clearObservationHandles(),this.flags|=Ae.DepTrackingInitialized;const t=this._accessed;if(null==t||0===t.length)return;let e=this._handles;null==e&&(e=[],this._handles=e);for(let i=0;i<t.length;++i)e.push(t[i].observe(this));t.length=0}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~Ae.Dirty,this.onCommitted()}_clearObservationHandles(){const t=this._handles;if(null!==t){for(let e=0;e<t.length;++e)t[e].remove();t.length=0}}onInvalidated(){~this.flags&Ae.Overridden&&(this.flags|=Ae.Dirty);const t=this._observers;if(t&&t.length>0)for(const e of t)e.onInvalidated()}onCommitted(){const t=this._observers;if(t&&t.length>0){const e=t.slice();for(const t of e)t.onCommitted()}}}class Be{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const e=new Be;return this._values.forEach(((i,n)=>{t&&t.has(n)||e.set(n,ht(i))})),e}get(t){return this._values.get(t)}originOf(){return xe.USER}keys(){return[...this._values.keys()]}set(t,e){this._values.set(t,e)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}}function qe(t,e,i){return void 0!==t}function He(t,e,i,n){return void 0!==t&&(!(null==i&&t.flags&Ae.NonNullable)||!1)}class We{constructor(t){this.host=t,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=ce.INITIALIZING,this.store=new Be,this._origin=xe.USER;const e=this.host.constructor.__accessorMetadata__;for(const t in e){const i=new Ge(t,e[t]);this.propertiesByName.set(t,i)}this.metadata=e}initialize(){this.lifecycle=ce.CONSTRUCTING}constructed(){this.lifecycle=ce.CONSTRUCTED}destroy(){this.lifecycle=ce.DESTROYED,this.propertiesByName.forEach((t=>t.destroy()))}get initialized(){return this.lifecycle!==ce.INITIALIZING}get(t){const e=this.propertiesByName.get(t);if(e.metadata.get)return e.getComputed(this);Ee(e);const i=this.store;return i.has(t)?i.get(t):e.metadata.value}originOf(t){const e=this.store.originOf(t);if(void 0===e){const e=this.propertiesByName.get(t);if(void 0!==e&&e.flags&Ae.HasDefaultValue)return"defaults"}return ke(e)}has(t){return this.propertiesByName.has(t)&&this.store.has(t)}keys(){return[...this.propertiesByName.keys()]}internalGet(t){const e=this.propertiesByName.get(t);if(qe(e))return this.store.has(t)?this.store.get(t):e.metadata.value}internalSet(t,e){const i=this.propertiesByName.get(t);qe(i)&&this._internalSet(i,e)}getDependsInfo(t,e,i){const n=this.propertiesByName.get(e);if(!qe(n))return"";const s=new Set,r=Ne({onObservableAccessed:t=>s.add(t),onTrackingEnd:()=>{}},(()=>n.metadata.get?.call(t)));let o=`${i}${t.declaredClass.split(".").pop()}.${e}: ${r}\n`;if(0===s.size)return o;i+="  ";for(const t of s){if(!(t instanceof Ge))continue;o+=`${i}${t.propertyName}: undefined\n`}return o}setAtOrigin(t,e,i){const n=this.propertiesByName.get(t);if(qe(n))return this._setAtOrigin(n,e,i)}isOverridden(t){const e=this.propertiesByName.get(t);return void 0!==e&&!!(e.flags&Ae.Overridden)}clearOverride(t){const e=this.propertiesByName.get(t);e&&e.flags&Ae.Overridden&&(e.flags&=~Ae.Overridden,e.notifyChange())}override(t,e){const i=this.propertiesByName.get(t);if(!He(i,t,e))return;const n=i.metadata.cast;if(n){const t=this._cast(n,e),{valid:i,value:s}=t;if(Je.release(t),!i)return;e=s}i.flags|=Ae.Overridden,this._internalSet(i,e)}set(t,e){const i=this.propertiesByName.get(t);if(!He(i,t,e))return;const n=i.metadata.cast;if(n){const t=this._cast(n,e),{valid:i,value:s}=t;if(Je.release(t),!i)return;e=s}const s=i.metadata.set;s?s.call(this.host,e):this._internalSet(i,e)}setDefaultOrigin(t){this._origin=Me(t)}getDefaultOrigin(){return ke(this._origin)}notifyChange(t){const e=this.propertiesByName.get(t);void 0!==e&&e.notifyChange()}invalidate(t){const e=this.propertiesByName.get(t);void 0!==e&&e.invalidate()}commit(t){const e=this.propertiesByName.get(t);void 0!==e&&e.commit()}_internalSet(t,e){const i=this.lifecycle!==ce.INITIALIZING?this._origin:xe.DEFAULTS;this._setAtOrigin(t,e,i)}_setAtOrigin(t,e,i){const n=this.store,s=t.propertyName;n.has(s,i)&&vt(e,n.get(s))&&~t.flags&Ae.Overridden&&i===n.originOf(s)||(t.invalidate(),n.set(s,e,i),t.commit(),$e(this.host,t))}_cast(t,e){const i=Je.acquire();return i.valid=!0,i.value=e,t&&(i.value=t.call(this.host,e,i)),i}}class Ze{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}}const Je=new ve(Ze);function Ke(t,e){return t.replaceAll(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,((t,i)=>{if(""===i)return"$";const n=Mt(i,e);return(n??"").toString()}))}class Ye{constructor(t,e,i){this.name=t,this.details=i,this.message=(e&&Ke(e,i))??""}toString(){return"["+this.name+"]: "+this.message}}class Qe extends Ye{constructor(t,e,i){super(t,e,i)}toJSON(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((t,e)=>{if(e&&"object"==typeof e&&"function"==typeof e.toJSON)return e;try{return ht(e)}catch(t){return"[object]"}})))}}catch(t){throw Ft.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new Qe(t.name,t.message,t.details)}}Qe.prototype.type="error";function Xe(t,e,i){if(t&&e)if("object"==typeof e)for(const i of Object.getOwnPropertyNames(e))Xe(t,i,e[i]);else{if(e.includes(".")){const n=e.split("."),s=n.splice(-1,1)[0];return void Xe(le(t,n),s,i)}const n=t.__accessor__;null!=n&&ti(e,n),t[e]=i}}function ti(t,e){if(c("esri-unknown-property-errors")&&!ei(t,e))throw new Qe("set:unknown-property",ii(t,e))}function ei(t,e){return null!=e.metadata[t]}function ii(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let ni;function si(){return ni}var ri;!function(t){t[t.Ignore=0]="Ignore",t[t.Destroy=1]="Destroy",t[t.ThrowError=2]="ThrowError"}(ri||(ri={}));function oi(t){t.length=0}class ai{constructor(t=50,e=50){this._pool=new ve(Array,void 0,oi,e,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return li.acquire()}static release(t){return li.release(t)}static prune(){li.prune()}}const li=new ai(100);class ui extends ve{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const e=super.acquire(...t);return this._set.delete(e),e}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}}const ci=[];function hi(t){ci.push(t),1===ci.length&&queueMicrotask((()=>{const t=ci.slice();ci.length=0;for(const e of t)e()}))}class di{constructor(t,e=30){this.name=t,this._counter=0,this._samples=new Array(e)}record(t){null!=t&&(this._samples[++this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort(((t,e)=>t-e))[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce(((t,e)=>t+e),0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}}var fi;!function(t){const e=(t,e,i,n)=>{let s=e,r=e;const o=i>>>1,a=t[s-1];for(;r<=o;){r=s<<1,r<i&&n(t[r-1],t[r])<0&&++r;const e=t[r-1];if(n(e,a)<=0)break;t[s-1]=e,s=r}t[s-1]=a},i=(t,e)=>t<e?-1:t>e?1:0;function n(t,n,s,r){void 0===n&&(n=0),void 0===s&&(s=t.length),void 0===r&&(r=i);for(let i=s>>>1;i>n;i--)e(t,i,s,r);const o=n+1;for(let i=s-1;i>n;i--){const s=t[n];t[n]=t[i],t[i]=s,e(t,o,i,r)}}function*s(t,n,s,r){void 0===n&&(n=0),void 0===s&&(s=t.length),void 0===r&&(r=i);for(let i=s>>>1;i>n;i--)e(t,i,s,r),yield;const o=n+1;for(let i=s-1;i>n;i--){const s=t[n];t[n]=t[i],t[i]=s,e(t,o,i,r),yield}}t.sort=n,t.iterableSort=s}(fi||(fi={}));const pi=fi;const mi=1.5,yi=1.1;class gi{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new C,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),void 0!==t.deallocator&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>vi(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const e=new Array;for(let i=0;i<this._length;i++){const n=this.data[i];t(n)&&e.push(n)}return e}at(t){if((t=Math.trunc(t)||0)<0&&(t+=this._length),!(t<0||t>=this._length))return this.data[t]}includes(t,e){const i=this.data.indexOf(t,e);return-1!==i&&i<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let e=t;e<this._length;++e)this.data[e]=this._deallocator(this.data[e]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,e=t.length){for(let i=0;i<e;i++)this.data[this._length++]=t[i]}fill(t,e){for(let i=0;i<e;i++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,vi(this)}pop(){if(0===this.length)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const e=O(this.data,t,this.length,this._hint);if(-1!==e)return this.data.splice(e,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(O(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,e=t.length,i){this.length=R(this.data,t,this.length,e,this._hint,i),this._shrink()}front(){if(0!==this.length)return this.data[0]}back(){if(0!==this.length)return this.data[this.length-1]}swapElements(t,e){if(t>=this.length||e>=this.length||t===e)return;const i=this.data[t];this.data[t]=this.data[e],this.data[e]=i}sort(t){pi.sort(this.data,0,this.length,t)}iterableSort(t){return pi.iterableSort(this.data,0,this.length,t)}some(t,e){for(let i=0;i<this.length;++i)if(t.call(e,this.data[i],i,this.data))return!0;return!1}find(t,e){for(let i=0;i<this.length;++i){const n=this.data[i];if(t.call(e,n,i))return n}}filterInPlace(t,e){let i=0;for(let n=0;n<this._length;++n){const s=this.data[n];t.call(e,s,n,this.data)&&(this.data[n]=this.data[i],this.data[i]=s,i++)}if(this._deallocator)for(let t=i;t<this._length;t++)this.data[t]=this._deallocator(this.data[t]);return this._length=i,this._shrink(),this}forAll(t,e){const{data:i,length:n}=this;for(let s=0;s<n;++s)t.call(e,i[s],s,i)}forEach(t,e){this.data.slice(0,this.length).forEach(t,e)}map(t,e){const i=new Array(this.length);for(let n=0;n<this.length;++n)i[n]=t.call(e,this.data[n],n,this.data);return i}reduce(t,e){let i=e;for(let e=0;e<this.length;++e)i=t(i,this.data[e],e,this.data);return i}has(t){const e=this.length,i=this.data;for(let n=0;n<e;++n)if(i[n]===t)return!0;return!1}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.data[t]}}function vi(t){t.data.length>mi*t.length&&(t.data.length=Math.floor(t.length*yi))}function wi(t){return{setTimeout:(e,i)=>{const n=t.setTimeout(e,i);return Zt((()=>t.clearTimeout(n)))}}}const bi=wi(globalThis);function Si(t){return xi(t)||_i(t)}function xi(t){return null!=t&&"object"==typeof t&&"on"in t&&"function"==typeof t.on}function _i(t){return null!=t&&"object"==typeof t&&"addEventListener"in t&&"function"==typeof t.addEventListener}function Mi(t,e,i){if(!Si(t))throw new TypeError("target is not a Evented or EventTarget object");return _i(t)?ki(t,e,i):t.on(e,i)}function ki(t,e,i,n){if(Array.isArray(e)){const s=e.slice();for(const e of s)t.addEventListener(e,i,n);return Zt((()=>{for(const e of s)t.removeEventListener(e,i,n)}))}return t.addEventListener(e,i,n),Zt((()=>t.removeEventListener(e,i,n)))}function Ti(t,e,i){if(!Si(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const n=Mi(t,e,(e=>{n.remove(),i.call(t,e)}));return n}function Ai(t="Aborted"){return new Qe("AbortError",t)}function Ii(t,e="Aborted"){if(Ci(t))throw Ai(e)}function ji(t){return t instanceof AbortSignal?t:t?.signal}function Ci(t){const e=ji(t);return null!=e&&e.aborted}function Ei(t){if(Pi(t))throw t}function Oi(t){if(!Pi(t))throw t}function Li(t,e){const i=ji(t);if(null!=i){if(!i.aborted)return Ti(i,"abort",(()=>e()));e()}}function Ni(t,e){const i=ji(t);if(null!=i)return Ii(i),Ti(i,"abort",(()=>e(Ai())))}function Ri(t,e){return null==ji(e)?t:new Promise(((i,n)=>{let s=Li(e,(()=>n(Ai())));const r=()=>{s=Ut(s)};t.then(r,r),t.then(i,n)}))}function Pi(t){return"AbortError"===t?.name}async function Fi(t){try{return await t}catch(t){if(!Pi(t))throw t;return}}async function Di(t){if(!t)return;if("function"!=typeof t.forEach){const e=Object.keys(t),i=e.map((e=>t[e])),n=await Di(i),s={};return e.map(((t,e)=>s[t]=n[e])),s}const e=t;return Promise.allSettled(e).then((t=>Array.from(e,((e,i)=>{const n=t[i];return"fulfilled"===n.status?{promise:e,value:n.value}:{promise:e,error:n.reason}}))))}async function $i(t){return(await Promise.allSettled(t)).filter((t=>"fulfilled"===t.status)).map((t=>t.value))}async function zi(t){return(await Promise.allSettled(t)).filter((t=>"rejected"===t.status)).map((t=>t.reason))}function Ui(t,e=void 0,i){const n=new AbortController;return Li(i,(()=>n.abort())),new Promise(((i,s)=>{let r=setTimeout((()=>{r=0,i(e)}),t);Li(n,(()=>{r&&(clearTimeout(r),s(Ai()))}))}))}function Vi(t,e){const i=new AbortController,n=setTimeout((()=>i.abort()),e);return Li(t,(()=>{i.abort(),clearTimeout(n)})),{...t,signal:i.signal}}function Gi(t){return t&&"function"==typeof t.then}function Bi(t){return Gi(t)?t:Promise.resolve(t)}function qi(t,e=-1){let i,n,s,r,o=null;const a=(...l)=>{if(i){n=l,r&&r.reject(Ai()),r=Hi();const t=r.promise;if(o){const t=o;o=null,t.abort()}return t}if(s=r||Hi(),r=null,e>0){const n=new AbortController;i=Bi(t(...l,n.signal));const s=i;Ui(e).then((()=>{i===s&&(r?n.abort():o=n)}))}else i=1,i=Bi(t(...l));const u=()=>{const t=n;n=s=i=o=null,null!=t&&a(...t)},c=i,h=s;return c.then(u,u),c.then(h.resolve,h.reject),h.promise};return a}function Hi(){let t,e;const i=new Promise(((i,n)=>{t=i,e=n})),n=e=>{t(e)};return n.resolve=e=>t(e),n.reject=t=>e(t),n.timeout=(t,e)=>bi.setTimeout((()=>n.reject(e)),t),n.promise=i,n}async function Wi(t){await Promise.resolve(),Ii(t)}function Zi(t){return t}function Ji(t){return Zi(1e3*t)}function Ki(t){return t}class Yi{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}}class Qi{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}}let Xi=0;const tn={time:Zi(0),deltaTime:Zi(0),elapsedFrameTime:Zi(0),frameDuration:Zi(0)},en=["prepare","preRender","render","postRender","update","finish"],nn=[],sn=new gi;class rn{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}}function on(){null!=cn&&(cancelAnimationFrame(cn),cn=requestAnimationFrame(dn))}const an={frameTasks:sn,willDispatch:!1,clearFrameTasks:hn,dispatch:yn,executeFrameTasks:fn,reschedule:on};function ln(t){const e=new Qi(t);return nn.push(e),an.willDispatch||(an.willDispatch=!0,hi(yn)),e}function un(t){const e=new Yi(t);return sn.push(e),null==cn&&(Xi=performance.now(),cn=requestAnimationFrame(dn)),new rn(e)}let cn=null;function hn(t=!1){sn.forAll((t=>{t.removed=!0})),t&&mn()}function dn(){const t=performance.now();cn=null,cn=sn.length>0?requestAnimationFrame(dn):null,an.executeFrameTasks(t)}function fn(t){const e=Zi(t-Xi);Xi=t;const i=1e3/60,n=Math.max(0,e-i);tn.time=t,tn.frameDuration=Zi(i-n);for(let i=0;i<en.length;i++){const n=performance.now(),s=en[i];sn.forAll((n=>{if(n.paused||n.removed)return;0===i&&n.ticks++;n.phases[s]&&(tn.elapsedFrameTime=Zi(performance.now()-t),tn.deltaTime=0===n.ticks?Zi(0):e,n.phases[s]?.call(n,tn))})),vn[i].record(performance.now()-n)}mn(),wn.record(performance.now()-t)}const pn=new gi;function mn(){sn.forAll((t=>{t.removed&&pn.push(t)})),sn.removeUnorderedMany(pn.data,pn.length),pn.clear()}function yn(){for(;nn.length;){const t=nn.shift();t.isActive&&t.callback()}an.willDispatch=!1}function gn(t=1,e){const i=Hi(),n=()=>{Ci(e)?i.reject(Ai()):0===t?i():(--t,hi((()=>n())))};return n(),i.promise}const vn=en.map((t=>new di(t))),wn=new di("total");function bn(t,e){for(const i of t.entries())if(e(i[0]))return!0;return!1}function Sn(t,e){if(!e)return t;for(const i of e)t.add(i);return t}function xn(t,e){const i=new Set;return Sn(i,t),Sn(i,e),i}function _n(t,e){const i=new Set;for(const n of e)t.has(n)&&i.add(n);return i}function Mn(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const i of t)if(!e.has(i))return!1;return!0}function kn(t,e){if(null==t&&null==e)return!0;if(null==t||null==e||t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function Tn(t,e){const i=new Set(t);for(const t of e)i.delete(t);return i}function An(t,e){return Tn(xn(t,e),_n(t,e))}let In=0;function jn(){return++In}class Cn{constructor(t){this._accessed=[],this._handles=[],this._observerObject=new En(t),On.register(this,new WeakRef(this._observerObject),this)}destroy(){On.unregister(this._observerObject),this._accessed.length=0,this._observerObject?.destroy(),this.clear()}onObservableAccessed(t){const e=this._accessed;e.includes(t)||e.push(t)}onTrackingEnd(){const t=this._handles,e=this._accessed,i=this._observerObject;for(let n=0;n<e.length;++n)t.push(e[n].observe(i));e.length=0}clear(){const t=this._handles;for(let e=0;e<t.length;++e)t[e].remove();t.length=0}}class En{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(1===t)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=Ln}}const On=new FinalizationRegistry((t=>{t.deref()?.destroy()}));function Ln(){}let Nn=!1;const Rn=[];function Pn(t,e){let i=new Cn(r),n=null,s=!1;function r(){if(!i||s)return;if(Nn)return void $n(r);const o=n;i.clear(),Nn=!0,s=!0,n=Ne(i,t),s=!1,Nn=!1,e(n,o),zn()}function o(){i&&(i.destroy(),i=null,n=null)}return s=!0,n=Ne(i,t),s=!1,Zt(o)}function Fn(t,e){let i=new Cn(s),n=null;function s(){e(n,o)}function r(){i&&(i.destroy(),i=null),n=null}function o(){return i?(i.clear(),n=Ne(i,t),n):null}return o(),Zt(r)}function Dn(t){let e=new Cn(n),i=!1;function n(){e&&!i&&(Nn?$n(n):(e.clear(),Nn=!0,i=!0,Ne(e,t),i=!1,Nn=!1,zn()))}function s(){e&&(e.destroy(),e=null)}return i=!0,Ne(e,t),i=!1,Zt(s)}function $n(t){Rn.includes(t)||Rn.unshift(t)}function zn(){for(;Rn.length;)Rn.pop()()}var Un;!function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"}(Un||(Un={}));class Vn{constructor(){this.uid=jn(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,e,i,n,s){return this.pool.acquire(Un.Untracked,t,e,i,n,s,vt)}static acquireTracked(t,e,i,n){return this.pool.acquire(Un.Tracked,t,e,i,null,null,n)}notify(t,e){this.type===Un.Untracked?this.callback.call(this.target,t,e,this.path,this.target):this.callback.call(null,t,e,void 0,void 0)}acquire(t,e,i,n,s,r,o){this.uid=jn(),this.removed=!1,this.type=t,this.oldValue=e,this.callback=i,this.getValue=n,this.target=s,this.path=r,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=jn(),this.removed=!0}}Vn.pool=new ui(Vn);const Gn=new ai,Bn=new Set;let qn;function Hn(t){Bn.delete(t),Bn.add(t),qn||(qn=ln(Jn))}function Wn(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function Zn(t){for(const e of Bn.values())e.target===t&&(e.removed=!0)}function Jn(){let t=10;for(;qn&&t--;){qn=null;const t=Kn(),e=Gn.acquire();for(const i of t){const t=i.uid;Wn(i),t===i.uid&&i.removed&&e.push(i)}for(const t of Bn)t.removed&&(e.push(t),Bn.delete(t));for(const t of e)Vn.pool.release(t);Gn.release(e),Gn.release(t),Yn.forEach((t=>t()))}}function Kn(){const t=Gn.acquire();t.length=Bn.size;let e=0;for(const i of Bn)t[e]=i,++e;return Bn.clear(),t}const Yn=new Set;function Qn(t){return Yn.add(t),Zt((()=>Yn.delete(t)))}function Xn(t,e,i){let n=se(t,e,i,((t,e,i)=>{let s,r,o=Fn((()=>ae(t,e)),((o,a)=>{t.__accessor__?.lifecycle===ce.DESTROYED||s&&s.uid!==r?n.remove():(s||(s=Vn.acquireUntracked(o,i,a,t,e),r=s.uid),Hn(s))}));return Zt((()=>{o.remove(),s&&(s.uid!==r||s.removed||(s.removed=!0,Hn(s)),s=null),n=o=null}))}));return n}function ts(t,e,i){const n=se(t,e,i,((t,e,i)=>{let s=!1;return Pn((()=>ae(t,e)),((r,o)=>{t.__accessor__.lifecycle!==ce.DESTROYED?s||(s=!0,vt(o,r)||i.call(t,r,o,e,t),s=!1):n.remove()}))}));return n}function es(t,e,i,n=!1){return t.__accessor__&&t.__accessor__.lifecycle!==ce.DESTROYED?n?ts(t,e,i):Xn(t,e,i):Zt()}function is(t,e,i){let n,s,r=Fn(t,((t,o)=>{n&&n.uid!==s?r.remove():(n||(n=Vn.acquireTracked(t,e,o,i),s=n.uid),Hn(n))}));return Zt((()=>{r.remove(),n&&(n.uid!==s||n.removed||(n.removed=!0,Hn(n)),n=null),r=null}))}function ns(t,e,i){let n=!1;return Pn(t,((t,s)=>{n||(n=!0,i(s,t)||e(t,s),n=!1)}))}function ss(t,e,i=!1,n=wt){return i?ns(t,e,n):is(t,e,n)}function rs(t){return bn(Bn,(e=>e.oldValue===t))}function os(t,e){for(const[i,n]of t)if(e(n,i))return!0;return!1}function as(t,e,i){const n=t.get(e);if(void 0!==n)return n;const s=i();return t.set(e,s),s}function ls(t){const e=new Map;return i=>(e.has(i)||e.set(i,t(i)),e.get(i))}const us=()=>Ft.getLogger("esri.core.accessorSupport.ensureTypes");function cs(t){return null==t?t:new Date(t)}function hs(t){return null==t?t:!!t}function ds(t){return null==t?t:t.toString()}function fs(t){return null==t?t:(t=parseFloat(t),isNaN(t)?0:t)}function ps(t){return null==t?t:Math.round(parseFloat(t))}function ms(t){return t?.constructor&&void 0!==t.constructor.__accessorMetadata__}function ys(t,e){return null!=e&&t&&!(e instanceof t)}function gs(t){return t&&"isCollection"in t}function vs(t){return t?.Type?"function"==typeof t.Type?t.Type:t.Type.base:null}function ws(t,e){if(!e?.constructor||!gs(e.constructor))return bs(t,e)?e:new t(e);const i=vs(t.prototype.itemType),n=vs(e.constructor.prototype.itemType);return i?n?i===n?e:i.prototype.isPrototypeOf(n.prototype)?new t(e):(bs(t,e),e):new t(e):e}function bs(t,e){return!!ms(e)&&(us().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+xs(t)+"'"),!0)}function Ss(t,e){return null==e?e:gs(t)?ws(t,e):ys(t,e)?bs(t,e)?e:new t(e):e}function xs(t){return t?.prototype?.declaredClass||"unknown"}const _s=new WeakMap;function Ms(t){switch(t){case Number:return fs;case Ns:return ps;case Boolean:return hs;case String:return ds;case Date:return cs;default:return as(_s,t,(()=>Ss.bind(null,t)))}}function ks(t,e){const i=Ms(t);return 1===arguments.length?i:i(e)}function Ts(t,e,i){return 1===arguments.length?Ts.bind(null,t):e?Array.isArray(e)?e.map((e=>t(e,i))):[t(e,i)]:e}function As(t,e){return 1===arguments.length?Ts((e=>ks(t,e))):Ts((e=>ks(t,e)),e)}function Is(t,e,i){return 0!==e&&Array.isArray(i)?i.map((i=>Is(t,e-1,i))):t(i)}function js(t,e,i){if(2===arguments.length)return i=>js(t,e,i);if(!i)return i;i=Is(t,e,i);let n=e,s=i;for(;n>0&&Array.isArray(s);)n--,s=s[0];if(void 0!==s)for(let t=0;t<n;t++)i=[i];return i}function Cs(t,e,i){return 2===arguments.length?js((e=>ks(t,e)),e):js((e=>ks(t,e)),e,i)}function Es(t){return!!Array.isArray(t)&&!t.some((e=>{const i=typeof e;return!("string"===i||"number"===i||"function"===i&&t.length>1)}))}function Os(t,e){if(2===arguments.length)return Os(t).call(null,e);const i=new Set,n=t.filter((t=>"function"!=typeof t)),s=t.filter((t=>"function"==typeof t));for(const e of t)"string"!=typeof e&&"number"!=typeof e||i.add(e);let r=null,o=null;return(t,e)=>{if(null==t)return t;const a=typeof t,l="string"===a||"number"===a;return l&&(i.has(t)||s.some((t=>"string"===a&&t===String||"number"===a&&t===Number)))||"object"===a&&s.some((e=>!ys(t,e)))?t:(l&&n.length?(r||(r=n.map((t=>"string"==typeof t?`'${t}'`:`${t}`)).join(", ")),us().error("Accessor#set",`'${t}' is not a valid value for this property, only the following values are valid: ${r}`)):"object"==typeof t&&s.length?(o||(o=s.map((t=>xs(t))).join(", ")),us().error("Accessor#set",`'${t}' is not a valid value for this property, value must be one of ${o}`)):us().error("Accessor#set",`'${t}' is not a valid value for this property`),e&&(e.valid=!1),null)}}function Ls(t,e){if(2===arguments.length)return Ls(t).call(null,e);const i={},n=[],s=[];for(const e in t.typeMap){const r=t.typeMap[e];i[e]=ks(r),n.push(xs(r)),s.push(e)}const r=()=>`'${n.join("', '")}'`,o=()=>`'${s.join("', '")}'`,a="string"==typeof t.key?e=>e[t.key]:t.key;return e=>{if(t.base&&!ys(t.base,e))return e;if(null==e)return e;const n=a(e)||t.defaultKeyValue,s=i[n];if(!s)return us().error("Accessor#set",`Invalid property value, value needs to be one of ${r()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!ys(t.typeMap[n],e))return e;if("string"==typeof t.key&&!ms(e)){const i={};for(const n in e)n!==t.key&&(i[n]=e[n]);return s(i)}return s(e)}}class Ns{}const Rs={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function Ps(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function Fs(t){switch(t.type){case"native":return ks(t.value);case"array":return Ts(Fs(t.value));case"one-of":return Ds(t);default:return null}}function Ds(t){let e=null;return(i,n)=>zs(i,t)?i:(null==e&&(e=$s(t)),us().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),n&&(n.valid=!1),null)}function $s(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Ns:return"integer";case Date:return"date";default:return xs(t.value)}case"array":return`array of ${$s(t.value)}`;case"one-of":{const e=t.values.map((t=>$s(t)));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function zs(t,e){if(null==t)return!0;switch(e.type){case"native":switch(e.value){case Number:case Ns:return"number"==typeof t;case Boolean:return"boolean"==typeof t;case String:return"string"==typeof t}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some((t=>!zs(t,e.value)));case"one-of":return e.values.some((e=>zs(t,e)))}}function Us(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const n=Object.getOwnPropertyDescriptor(e,i),s=de(e,i);n&&(n.get||n.set?(s.get=n.get||s.get,s.set=n.set||s.set):"value"in n&&("value"in t&&Ft.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),s.value=t.value=n.value)),null!=t.readOnly&&(s.readOnly=t.readOnly);const r=t.aliasOf;if(r){const t="string"==typeof r?r:r.source,e="string"==typeof r?null:!0===r.overridable;let n;s.dependsOn=[t],s.get=function(){let e=le(this,t);if("function"==typeof e){n||(n=t.split(".").slice(0,-1).join("."));const i=le(this,n);i&&(e=e.bind(i))}return e},s.readOnly||(s.set=e?function(t){this._override(i,t)}:function(e){Xe(this,t,e)})}const o=t.type,a=t.types;s.cast||(o?s.cast=Gs(o):a&&(Array.isArray(a)?s.cast=Ts(Ls(a[0])):s.cast=Ls(a))),fe(s,t),t.range&&(s.cast=Bs(s.cast,t.range))}}function Vs(t,e,i){const n=de(t,i);n.json||(n.json={});let s=n.json;return void 0!==e&&(s.origins||(s.origins={}),s.origins[e]||(s.origins[e]={}),s=s.origins[e]),s}function Gs(t){let e=0,i=t;if(Ps(t))return Fs(t);for(;Array.isArray(i)&&1===i.length&&"string"!=typeof i[0]&&"number"!=typeof i[0];)i=i[0],e++;const n=i;if(Es(n))return 0===e?Os(n):js(Os(n),e);if(1===e)return As(n);if(e>1)return Cs(n,e);const s=t;return s.from?s.from:ks(s)}function Bs(t,e){return i=>{let n=+t(i);return null!=e.step&&(n=Math.round(n/e.step)*e.step),null!=e.min&&(n=Math.max(e.min,n)),null!=e.max&&(n=Math.min(e.max,n)),n}}function qs(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const t in i)if(e[t]){const n=e[t];i[t].forEach((t=>{e[t]=n})),delete e[t]}}}class Hs extends Ye{constructor(t,e,i){super(t,e,i)}}Hs.prototype.type="warning";function Ws(t){return!!t&&t.prototype?.declaredClass&&0===t.prototype.declaredClass.indexOf("esri.core.Collection")}const Zs=()=>Ft.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function Js(t,e,i){t&&(!i&&!e.read||e.read?.reader||!1===e.read?.enabled||nr(t)&&kt("read.reader",Ks(t),e))}function Ks(t){const e=t.ndimArray??0;if(e>1)return tr(t);if(1===e)return er(t);if("type"in t&&ir(t.type)){const e=t.type.prototype?.itemType?.Type,i=er("function"==typeof e?{type:e}:{types:e});return(e,n,s)=>{const r=i(e,n,s);return r?new t.type(r):r}}return Ys(t)}function Ys(t){return"type"in t?Qs(t.type):or(t.types)}function Qs(t){return t.prototype.read?(e,i,n)=>{if(null==e)return e;const s=typeof e;if("object"!==s)return void Zs().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${s}'`);const r=new t;return r.read(e,n),r}:t.fromJSON}function Xs(t,e,i,n){return 0!==n&&Array.isArray(e)?e.map((e=>Xs(t,e,i,n-1))):t(e,void 0,i)}function tr(t){const e=Ys(t),i=Xs.bind(null,e),n=t.ndimArray??0;return(t,e,s)=>{if(null==t)return t;t=i(t,s,n);let r=n,o=t;for(;r>0&&Array.isArray(o);)r--,o=o[0];if(void 0!==o)for(let e=0;e<r;e++)t=[t];return t}}function er(t){const e=Ys(t);return(t,i,n)=>{if(null==t)return t;if(Array.isArray(t)){const i=[];for(const s of t){const t=e(s,void 0,n);void 0!==t&&i.push(t)}return i}const s=e(t,void 0,n);return void 0!==s?[s]:void 0}}function ir(t){if(!Ws(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&("function"==typeof e.Type?sr(e.Type):rr(e.Type))}function nr(t){return"types"in t?rr(t.types):sr(t.type)}function sr(t){return!Array.isArray(t)&&(!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||ir(t)))}function rr(t){for(const e in t.typeMap){if(!sr(t.typeMap[e]))return!1}return!0}function or(t){let e=null;const i=t.errorContext??"type",n=t.validate;return(s,r,o)=>{if(null==s)return s;const a=typeof s;if("object"!==a)return void Zs().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=ar(t));const l=t.key;if("string"!=typeof l)return;const u=s[l],c=u?e[u]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!c){const t=`Type '${u||"unknown"}' is not supported`;return o?.messages&&s&&o.messages.push(new Hs(`${i}:unsupported`,t,{definition:s,context:o})),void Zs().error(t)}const h=new c;return h.read(s,o),n?n(h):h}}function ar(t){const e={};for(const i in t.typeMap){const n=t.typeMap[i],s=he(n.prototype);if("function"==typeof t.key)continue;const r=s[t.key];if(!r)continue;r.json?.type&&Array.isArray(r.json.type)&&1===r.json.type.length&&"string"==typeof r.json.type[0]&&(e[r.json.type[0]]=n);const o=r.json?.write;if(!o?.writer){e[i]=n;continue}const a=o.target,l="string"==typeof a?a:t.key,u={};o.writer(i,u,l),u[l]&&(e[u[l]]=n)}return e}function lr(t){if(t.json||(t.json={}),cr(t.json),hr(t.json),ur(t.json),t.json.origins)for(const e in t.json.origins)cr(t.json.origins[e]),hr(t.json.origins[e]),ur(t.json.origins[e]);return!0}function ur(t){t.name&&(t.read&&"object"==typeof t.read?void 0===t.read.source&&(t.read.source=t.name):t.read={source:t.name},t.write&&"object"==typeof t.write?void 0===t.write.target&&(t.write.target=t.name):t.write={target:t.name})}function cr(t){"boolean"==typeof t.read?t.read={enabled:t.read}:"function"==typeof t.read?t.read={enabled:!0,reader:t.read}:t.read&&"object"==typeof t.read&&void 0===t.read.enabled&&(t.read.enabled=!0)}function hr(t){"boolean"==typeof t.write?t.write={enabled:t.write}:"function"==typeof t.write?t.write={enabled:!0,writer:t.write}:t.write&&"object"==typeof t.write&&void 0===t.write.enabled&&(t.write.enabled=!0)}function dr(t,e){if(!e.write||e.write.writer||!1===e.write.enabled&&!e.write.overridePolicy)return;const i=t?.ndimArray??0;t&&(1===i||"type"in t&&Ws(t.type))?e.write.writer=wr:i>1?e.write.writer=Sr(i):e.types?Array.isArray(e.types)?e.write.writer=mr(e.types[0]):e.write.writer=fr(e.types):e.write.writer=yr}function fr(t){return(e,i,n,s)=>e?pr(e,t,s)?yr(e,i,n,s):void 0:yr(e,i,n,s)}function pr(t,e,i){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(i?.messages){const n=e.errorContext??"type",s=`Values of type '${("function"!=typeof e.key?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new Qe(`${n}:unsupported`,s,{definition:t,context:i})),Ft.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(s)}return!1}function mr(t){return(e,i,n,s)=>{if(!e||!Array.isArray(e))return yr(e,i,n,s);return yr(e.filter((e=>pr(e,t,s))),i,n,s)}}function yr(t,e,i,n){kt(i,gr(t,n),e)}function gr(t,e){return t&&"function"==typeof t.write?t.write({},e):t&&"function"==typeof t.toJSON?t.toJSON():"number"==typeof t?vr(t):t}function vr(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function wr(t,e,i,n){let s;null===t?s=null:t&&"function"==typeof t.map?(s=t.map((t=>gr(t,n))),"function"==typeof s.toArray&&(s=s.toArray())):s=[gr(t,n)],kt(i,s,e)}function br(t,e,i){return 0!==i&&Array.isArray(t)?t.map((t=>br(t,e,i-1))):gr(t,e)}function Sr(t){return(e,i,n,s)=>{let r;if(null===e)r=null;else{r=br(e,s,t);let i=t,n=r;for(;i>0&&Array.isArray(n);)i--,n=n[0];if(void 0!==n)for(let t=0;t<i;t++)r=[r]}kt(n,r,i)}}function xr(t,e){return kr(t,"any",e?.origin)}function _r(t,e){return kr(t,"read",e?.origin)}function Mr(t,e){return kr(t,"write",e?.origin)}function kr(t,e,i){let n=t?.json;if(n?.origins&&i){let t;t="link-chart"===i?n.origins[i]&&("any"===e||e in n.origins[i])?n.origins[i]:n.origins["web-map"]:n.origins[i],t&&("any"===e||e in t)&&(n=t)}return n}function Tr(t){const e=Ar(t);if(t.json.origins)for(const i in t.json.origins){const n=t.json.origins[i],s=n.types?Ir(n):e;Js(s,n,!1),n.types&&!n.write&&t.json.write&&t.json.write.enabled&&(n.write={...t.json.write}),dr(s,n)}Js(e,t.json,!0),dr(e,t.json)}function Ar(t){return t.json.types?Cr(t.json):t.type?jr(t):Cr(t)}function Ir(t){return t.type?jr(t):Cr(t)}function jr(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!Es(i);)i=i[0],e++;return{type:i,ndimArray:e}}function Cr(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function Er(t){lr(t)&&(qs(t),Tr(t))}const Or=new Set,Lr=new Set;function Nr(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,Pr(e);const i=[],n=[];let s=e.prototype;for(;s;)s.hasOwnProperty("initialize")&&!Or.has(s.initialize)&&(Or.add(s.initialize),i.push(s.initialize)),s.hasOwnProperty("destroy")&&!Lr.has(s.destroy)&&(Lr.add(s.destroy),n.push(s.destroy)),s=Object.getPrototypeOf(s);Or.clear(),Lr.clear();const r=class extends e{constructor(...t){if(super(...t),this.constructor===r&&"function"==typeof this.postscript){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let t=i.length-1;t>=0;t--)i[t].call(this)}}),n.length){let t=!1;const e=this[Ht];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!t){t=!0,e.call(this);for(let t=0;t<n.length;t++)n[t].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript(...t)}}};r.__accessorMetadata__=he(e.prototype),r.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(r,"name",{value:o,configurable:!0}),r}}function Rr(t,e){return null==e.get?function(){const e=this.__accessor__,i=e.propertiesByName.get(t);if(void 0===i)return;Ee(i);const n=e.store;return n.has(t)?n.get(t):i.metadata.value}:function(){const e=this.__accessor__,i=e.propertiesByName.get(t);if(void 0!==i)return i.getComputed(e)}}function Pr(t){const e=t.prototype,i=he(e),n={};for(const t of Object.getOwnPropertyNames(i)){const e=i[t];Er(e),n[t]={enumerable:!0,configurable:!0,get:Rr(t,e),set(i){const n=this.__accessor__;if(void 0!==n){if(!Object.isFrozen(this)){if(n.initialized&&e.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${t}' of ${this.declaredClass}`);if(n.lifecycle===ce.CONSTRUCTED&&e.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${t}' of ${this.declaredClass}`);n.set(t,i)}}else Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:i})}}}Object.defineProperties(t.prototype,n)}var Fr,Dr;function $r(t){if(null==t)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const zr=Symbol("Accessor-Handles"),Ur=Symbol("Accessor-Initialized");class Vr{static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:e,declaredClass:i,constructor:n}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const s=this;class r extends s{constructor(...t){super(...t),this.inherited=null,n&&n.apply(this,t)}}he(r.prototype);for(const e in t){const i=t[e];r.prototype[e]="function"==typeof i?function(...t){const n=this.inherited;let r;this.inherited=function(...t){if(s.prototype[e])return s.prototype[e].apply(this,t)};try{r=i.apply(this,t)}catch(t){throw this.inherited=n,t}return this.inherited=n,r}:t[e]}for(const t in e){const i=$r(e[t]);Us(i)(r.prototype,t)}return Nr(i)(r)}constructor(...t){if(this[Fr]=null,this[Dr]=!1,this.constructor===Vr)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const e=new We(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:e}),t.length>0&&this.normalizeCtorArgs&&(e.ctorArgs=this.normalizeCtorArgs.apply(this,t)),si()?.onInstanceConstruct(this)}postscript(t){const e=this.__accessor__,i=e.ctorArgs||t;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize(),this[Ur]=!0}initialize(){}[Ht](){this[zr]=$t(this[zr])}destroy(){this.destroyed||(Zn(this),this.__accessor__.destroy(),si()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[Ur]}get destroyed(){return this.__accessor__?.lifecycle===ce.DESTROYED||!1}commitProperty(t){le(this,t)}get(t){return f(Ft.getLogger(this),"`Accessor.get` is deprecated in favor of using optional chaining",{version:"4.28",see:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining"}),le(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,e){return Xe(this,t,e),this}watch(t,e,i){return es(this,t,e,i)}addHandles(t,e){if(this.destroyed){const e=Array.isArray(t)?t:[t];for(const t of e)t.remove();return}let i=this[zr];null==i&&(i=this[zr]=new w),i.add(t,e)}removeHandles(t){const e=this[zr];null!=e&&e.remove(t)}removeAllHandles(){const t=this[zr];null!=t&&t.removeAll()}hasHandles(t){const e=this[zr];return null!=e&&e.has(t)}_override(t,e){void 0===e?this.__accessor__.clearOverride(t):this.__accessor__.override(t,e)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,e){null==e?this.__accessor__.clearOverride(t):this.__accessor__.override(t,e)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,e){return this.__accessor__.internalSet(t,e),this}}Fr=zr,Dr=Ur;const Gr=t=>{let e=class extends t{clone(){const t=Yt(this);Dt(t,"unable to clone instance of non-accessor class");const e=t.metadata,i=t.store,n={},s=new Map;for(const t in e){const r=e[t],o=i?.originOf(t),a=r.clonable;if(r.readOnly||!1===a||o!==xe.USER&&o!==xe.DEFAULTS&&o!==xe.WEB_MAP&&o!==xe.WEB_SCENE)continue;const l=this[t];let u=null;u="function"==typeof a?a(l):"reference"===a?l:dt(l),null!=l&&null==u||(o===xe.DEFAULTS?s.set(t,u):n[t]=u)}const r=new(Object.getPrototypeOf(this).constructor)(n);if(s.size){const t=Yt(r)?.store;if(t)for(const[e,i]of s)t.set(e,i,xe.DEFAULTS)}return r}};return e=o([Nr("esri.core.Clonable")],e),e};let Br=class extends(Gr(Vr)){};Br=o([Nr("esri.core.Clonable")],Br);let qr=class extends Br{constructor(t){super(t),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(t){return null!=t&&(this.row===t.row&&this.rows===t.rows&&this.column===t.column&&this.columns===t.columns)}};o([Us({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],qr.prototype,"row",void 0),o([Us({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],qr.prototype,"column",void 0),o([Us({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],qr.prototype,"rows",void 0),o([Us({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],qr.prototype,"columns",void 0),qr=o([Nr("esri.CameraLayout")],qr);const Hr=qr;function Wr(){return[0,0,0]}function Zr(t){return[t[0],t[1],t[2]]}function Jr(t,e,i){return[t,e,i]}function Kr(t,e=Wr()){const i=Math.min(3,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function Yr(t,e){return new Float64Array(t,e,3)}function Qr(){return Wr()}function Xr(){return Jr(1,1,1)}function to(){return Jr(1,0,0)}function eo(){return Jr(0,1,0)}function io(){return Jr(0,0,1)}const no=Qr(),so=Xr(),ro=to(),oo=eo(),ao=io();Object.freeze(Object.defineProperty({__proto__:null,ONES:so,UNIT_X:ro,UNIT_Y:oo,UNIT_Z:ao,ZEROS:no,clone:Zr,create:Wr,createView:Yr,fromArray:Kr,fromValues:Jr,ones:Xr,unitX:to,unitY:eo,unitZ:io,zeros:Qr},Symbol.toStringTag,{value:"Module"}));let lo=1e-6;function uo(){return lo}function co(t){lo=t}const ho=Math.random,fo=Math.PI/180,po=180/Math.PI;function mo(t){return t*fo}function yo(t){return t*po}function go(t,e){return Math.abs(t-e)<=lo*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:ho,equals:go,getEpsilon:uo,setEpsilon:co,toDegree:yo,toRadian:mo},Symbol.toStringTag,{value:"Module"}));function vo(t){const e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)}function wo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function bo(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t}function So(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function xo(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function _o(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function Mo(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function ko(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function To(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Ao(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function Io(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function jo(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function Co(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function Eo(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Oo(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Lo(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t}function No(t,e){const i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return Math.sqrt(i*i+n*n+s*s)}function Ro(t,e){const i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return i*i+n*n+s*s}function Po(t){const e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n}function Fo(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Do(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function $o(t,e){const i=e[0],n=e[1],s=e[2];let r=i*i+n*n+s*s;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r),t}function zo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Uo(t,e,i){const n=e[0],s=e[1],r=e[2],o=i[0],a=i[1],l=i[2];return t[0]=s*l-r*a,t[1]=r*o-n*l,t[2]=n*a-s*o,t}function Vo(t,e,i,n){const s=e[0],r=e[1],o=e[2];return t[0]=s+n*(i[0]-s),t[1]=r+n*(i[1]-r),t[2]=o+n*(i[2]-o),t}function Go(t,e,i,n,s,r){const o=r*r,a=o*(2*r-3)+1,l=o*(r-2)+r,u=o*(r-1),c=o*(3-2*r);return t[0]=e[0]*a+i[0]*l+n[0]*u+s[0]*c,t[1]=e[1]*a+i[1]*l+n[1]*u+s[1]*c,t[2]=e[2]*a+i[2]*l+n[2]*u+s[2]*c,t}function Bo(t,e,i,n,s,r){const o=1-r,a=o*o,l=r*r,u=a*o,c=3*r*a,h=3*l*o,d=l*r;return t[0]=e[0]*u+i[0]*c+n[0]*h+s[0]*d,t[1]=e[1]*u+i[1]*c+n[1]*h+s[1]*d,t[2]=e[2]*u+i[2]*c+n[2]*h+s[2]*d,t}function qo(t,e){e=e||1;const i=ho,n=2*i()*Math.PI,s=2*i()-1,r=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=s*e,t}function Ho(t,e,i){const n=e[0],s=e[1],r=e[2];return t[0]=i[0]*n+i[4]*s+i[8]*r+i[12],t[1]=i[1]*n+i[5]*s+i[9]*r+i[13],t[2]=i[2]*n+i[6]*s+i[10]*r+i[14],t}function Wo(t,e,i){const n=e[0],s=e[1],r=e[2];return t[0]=n*i[0]+s*i[3]+r*i[6],t[1]=n*i[1]+s*i[4]+r*i[7],t[2]=n*i[2]+s*i[5]+r*i[8],t}function Zo(t,e,i){const n=i[0],s=i[1],r=i[2],o=i[3],a=e[0],l=e[1],u=e[2],c=s*u-r*l,h=r*a-n*u,d=n*l-s*a,f=s*d-r*h,p=r*c-n*d,m=n*h-s*c,y=2*o;return t[0]=a+c*y+2*f,t[1]=l+h*y+2*p,t[2]=u+d*y+2*m,t}function Jo(t,e,i,n){const s=[],r=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],r[0]=s[0],r[1]=s[1]*Math.cos(n)-s[2]*Math.sin(n),r[2]=s[1]*Math.sin(n)+s[2]*Math.cos(n),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function Ko(t,e,i,n){const s=[],r=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],r[0]=s[2]*Math.sin(n)+s[0]*Math.cos(n),r[1]=s[1],r[2]=s[2]*Math.cos(n)-s[0]*Math.sin(n),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function Yo(t,e,i,n){const s=[],r=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],r[0]=s[0]*Math.cos(n)-s[1]*Math.sin(n),r[1]=s[0]*Math.sin(n)+s[1]*Math.cos(n),r[2]=s[2],t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function Qo(t,e){$o(Xo,t),$o(ta,e);const i=zo(Xo,ta);return i>1?0:i<-1?Math.PI:Math.acos(i)}const Xo=Wr(),ta=Wr();function ea(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function ia(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function na(t,e){if(t===e)return!0;const i=t[0],n=t[1],s=t[2],r=e[0],o=e[1],a=e[2],l=uo();return Math.abs(i-r)<=l*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(n-o)<=l*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(s-a)<=l*Math.max(1,Math.abs(s),Math.abs(a))}function sa(t,e,i){const n=i[0]-e[0],s=i[1]-e[1],r=i[2]-e[2];let o=n*n+s*s+r*r;return o>0?(o=1/Math.sqrt(o),t[0]=n*o,t[1]=s*o,t[2]=r*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const ra=xo,oa=_o,aa=Mo,la=No,ua=Ro,ca=vo,ha=Po;Object.freeze(Object.defineProperty({__proto__:null,abs:Ao,add:So,angle:Qo,bezier:Bo,ceil:ko,copy:wo,cross:Uo,direction:sa,dist:la,distance:No,div:aa,divide:Mo,dot:zo,equals:na,exactEquals:ia,floor:To,hermite:Go,inverse:Do,len:ca,length:vo,lerp:Vo,max:Co,min:jo,mul:oa,multiply:_o,negate:Fo,normalize:$o,random:qo,rotateX:Jo,rotateY:Ko,rotateZ:Yo,round:Eo,scale:Oo,scaleAndAdd:Lo,set:bo,sign:Io,sqrDist:ua,sqrLen:ha,squaredDistance:Ro,squaredLength:Po,str:ea,sub:ra,subtract:xo,transformMat3:Wo,transformMat4:Ho,transformQuat:Zo},Symbol.toStringTag,{value:"Module"}));const da=new Float32Array(1);function fa(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function pa(t,e,i){return Math.min(Math.max(t,e),i)}function ma(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function ya(t,e,i){return t+(e-t)*i}function ga(t,e,i,n,s){return ya(n,s,(t-e)/(i-e))}function va(t){return t*Math.PI/180}function wa(t){return 180*t/Math.PI}function ba(t){return Math.acos(pa(t,-1,1))}function Sa(t){return Math.asin(pa(t,-1,1))}function xa(t,e,i=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;return(t>e?t-e:e-t)<=i}const _a=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function Ma(t){return _a.setFloat64(0,t),_a.getBigInt64(0)}function ka(t){return _a.setBigInt64(0,t),_a.getFloat64(0)}const Ta=BigInt("1000000");Aa(1);function Aa(t){const e=Ma(t=Math.abs(t)),i=ka(e<=Ta?Ta:e-Ta);return Math.abs(t-i)}function Ia(t,e,i=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const n=Math.abs(t-e),s=Math.abs(t),r=Math.abs(e);if(0===t||0===e||s<1e-12&&r<1e-12){if(n>.01*i)return!1}else if(n/(s+r)>i)return!1;return!0}function ja(t){return Ca(Math.max(-La,Math.min(t,La)))}function Ca(t){return da[0]=t,da[0]}function Ea(t,e){const i=vo(t),n=Sa(t[2]/i),s=Math.atan2(t[1]/i,t[0]/i);return bo(e,i,n,s),e}function Oa(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],n=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(xa(e,1)&&xa(i,1)&&xa(n,1))}const La=Ca(34028234663852886e22);class Na{constructor(t,e){this.min=t,this.max=e,this.range=e-t}ndiff(t,e=0){return Math.ceil((t-e)/this.range)*this.range+e}_normalize(t,e,i,n=0,s=!1){return(i-=n)<t?i+=this.ndiff(t-i):i>e&&(i-=this.ndiff(i-e)),s&&i===e&&(i=t),i+n}normalize(t,e=0,i=!1){return this._normalize(this.min,this.max,t,e,i)}clamp(t,e=0){return pa(t-e,this.min,this.max)+e}monotonic(t,e,i){return t<e?e:e+this.ndiff(t-e,i)}minimalMonotonic(t,e,i){return this._normalize(t,t+this.range,e,i)}center(t,e,i){return e=this.monotonic(t,e,i),this.normalize((t+e)/2,i)}diff(t,e,i){return this.monotonic(t,e,i)-t}shortestSignedDiff(t,e){t=this.normalize(t);const i=(e=this.normalize(e))-t,n=e<t?this.minimalMonotonic(t,e)-t:e-this.minimalMonotonic(e,t);return Math.abs(i)<Math.abs(n)?i:n}contains(t,e,i){return e=this.minimalMonotonic(t,e),(i=this.minimalMonotonic(t,i))>t&&i<e}}function Ra(t){for(const e in t){const i=t[e];i instanceof Function&&(t[e]=i.bind(t))}return t}Ra(new Na(0,2*Math.PI));Ra(new Na(-Math.PI,Math.PI));const Pa=Ra(new Na(0,360));class Fa{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const e=new Fa;return this._values.forEach(((i,n)=>{t&&t.has(n)||e.set(n,ht(i.value),i.origin)})),e}get(t,e){e=this._normalizeOrigin(e);const i=this._values.get(t);return null==e||i?.origin===e?i?.value:void 0}originOf(t){return this._values.get(t)?.origin??xe.USER}keys(t){t=this._normalizeOrigin(t);const e=[...this._values.keys()];return null==t?e:e.filter((e=>this._values.get(e)?.origin===t))}set(t,e,i){if((i=this._normalizeOrigin(i))===xe.DEFAULTS){const e=this._values.get(t);if(null!=e?.origin&&e.origin>i)return}this._values.set(t,new Da(e,i))}delete(t,e){null!=(e=this._normalizeOrigin(e))&&this._values.get(t)?.origin!==e||this._values.delete(t)}has(t,e){return null!=(e=this._normalizeOrigin(e))?this._values.get(t)?.origin===e:this._values.has(t)}forEach(t){this._values.forEach((({value:e},i)=>t(e,i)))}_normalizeOrigin(t){if(null!=t)return t===xe.DEFAULTS?t:xe.USER}}class Da{constructor(t,e){this.value=t,this.origin=e}}function $a(t,e,i){e.keys().forEach((t=>{i.set(t,e.get(t),xe.DEFAULTS)}));const n=t.metadata;Object.keys(n).forEach((e=>{t.internalGet(e)&&i.set(e,t.internalGet(e),xe.DEFAULTS)}))}function za(t,e,i){if(!t?.read||!1===t.read.enabled||!t.read.source)return!1;const n=t.read.source;if("string"==typeof n){if(n===e)return!0;if(n.includes(".")&&0===n.indexOf(e)&&ue(n,i))return!0}else for(const t of n){if(t===e)return!0;if(t.includes(".")&&0===t.indexOf(e)&&ue(t,i))return!0}return!1}function Ua(t){return t&&(!t.read||!1!==t.read.enabled&&!t.read.source)}function Va(t,e,i,n,s){let r=_r(e[i],s);Ua(r)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))r=_r(e[o],s),za(r,i,n)&&(t[o]=!0)}function Ga(t,e,i,n){const s=i.metadata,r=xr(s[e],n),o=r?.default;if(void 0===o)return;const a="function"==typeof o?o.call(t,e,n):o;void 0!==a&&i.set(e,a)}const Ba={origin:"service"};function qa(t,e,i=Ba){if(!e||"object"!=typeof e)return;const n=Yt(t),s=n.metadata,r={};for(const t of Object.getOwnPropertyNames(e))Va(r,s,t,e,i);n.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(r)){const r=_r(s[o],i).read,a=r?.source;let l;l=a&&"string"==typeof a?ae(e,a):e[o],r?.reader&&(l=r.reader.call(t,l,e,i)),void 0!==l&&n.set(o,l)}if(!i||!i.ignoreDefaults){n.setDefaultOrigin("defaults");for(const e of Object.getOwnPropertyNames(s))r[e]||Ga(t,e,n,i)}n.setDefaultOrigin("user")}function Ha(t,e,i,n=Ba){const s={...n,messages:[]};i(s),s.messages?.forEach((e=>{"warning"!==e.type||t.loaded?n?.messages&&n.messages.push(e):t.loadWarnings.push(e)}))}function Wa(t,e,i,n,s){const r={};return e.write?.writer?.call(t,n,r,i,s),r}function Za(t,e,i,n,s,r){if(!n?.write)return!1;const o=le(t,i);if(!s&&n.write.overridePolicy){const e=n.write.overridePolicy.call(t,o,i,r??void 0);void 0!==e&&(s=e)}if(s||(s=n.write),!s||!1===s.enabled)return!1;if(s.layerContainerTypes&&r?.layerContainerType&&!s.layerContainerTypes.includes(r.layerContainerType))return!1;if((null===o&&!s.allowNull&&!s.writerEnsuresNonNull||void 0===o)&&s.isRequired){const e=new Qe("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return e&&r?.messages?r.messages.push(e):e&&!r&&Ft.getLogger("esri.core.accessorSupport.write").error(e.name,e.message),!1}if(void 0===o)return!1;if(null===o&&!s.allowNull&&!s.writerEnsuresNonNull)return!1;if(!s.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===xe.DEFAULTS)&&Ja(t,i,r,n,o))return!1;if(!s.ignoreOrigin&&r?.origin&&e.store.multipleOriginsSupported){if(e.store.originOf(i)<Me(r.origin))return!1}return!0}function Ja(t,e,i,n,s){const r=n.default;if(void 0===r)return!1;if(null!=n.defaultEquals)return n.defaultEquals(s);if("function"==typeof r){if(Array.isArray(s)){const n=r.call(t,e,i??void 0);return _(n,s)}return!1}return r===s}function Ka(t,e,i,n){const s=Yt(t),r=s.metadata,o=Mr(r[e],n);return!!o&&Za(t,s,e,o,i,n)}function Ya(t,e,i){if(t&&"function"==typeof t.toJSON&&(!t.toJSON.isDefaultToJSON||!t.write))return Xt(e,t.toJSON(i));const n=Yt(t),s=n.metadata;for(const r in s){const o=Mr(s[r],i);if(!Za(t,n,r,o,void 0,i))continue;const a=le(t,r),l=Wa(t,o,o.write&&"string"==typeof o.write.target?o.write.target:r,a,i);Object.keys(l).length>0&&(e=Xt(e,l),i?.resources?.pendingOperations?.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then((()=>Xt(e,l,(()=>"replace-arrays"))))),i?.writtenProperties&&i.writtenProperties.push({target:t,propName:r,oldOrigin:Te(n.store.originOf(r)),newOrigin:i.origin}))}return e}const Qa=t=>{let e=class extends t{constructor(...t){super(...t);const e=Yt(this),i=e.store,n=new Fa;e.store=n,$a(e,i,n)}read(t,e){qa(this,t,e)}write(t,e){return Ya(this,t??{},e)}toJSON(t){return this.write({},t)}static fromJSON(t,e){return Xa.call(this,t,e)}};return e=o([Nr("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function Xa(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}function tl(t){return t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}let el=class extends(Qa(Vr)){};el=o([Nr("esri.core.JSONSupport")],el);const il=Object.prototype.toString;function nl(t){const e="__accessorMetadata__"in t?ks(t):t;return function(...t){if(t.push(e),"number"==typeof t[2])throw new Error("Using @cast has parameter decorator is not supported since 4.16");return sl.apply(this,t)}}function sl(t,e,i,n){de(t,e).cast=n}function rl(t){return(e,i)=>{de(e,t).cast=e[i]}}function ol(...t){if(3!==t.length||"string"!=typeof t[1])return 1===t.length&&"[object Function]"===il.call(t[0])?nl(t[0]):1===t.length&&"string"==typeof t[0]?rl(t[0]):void 0}function al(t,e,i){let n,s;return void 0===e||Array.isArray(e)?(s=t,i=e,n=[void 0]):(s=e,n=Array.isArray(t)?t:[t]),(t,e)=>{const r=t.constructor.prototype;n.forEach((n=>{const o=Vs(t,n,s);o.read&&"object"==typeof o.read||(o.read={}),o.read.reader=r[e],i&&(o.read.source=(o.read.source||[]).concat(i))}))}}function ll(t,e,i){let n,s;return void 0===e?(s=t,n=[void 0]):"string"!=typeof e?(s=t,n=[void 0],i=e):(s=e,n=Array.isArray(t)?t:[t]),(t,e)=>{const r=t.constructor.prototype;for(const o of n){const n=Vs(t,o,s);n.write&&"object"==typeof n.write||(n.write={}),i&&(n.write.target=i),n.write.writer=r[e]}}}class ul{constructor(t,e={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=t,this._options=e,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(t),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=t=>this.fromJSON(t),this.write=(t,e,i)=>{const n=this.toJSON(t);void 0!==n&&kt(i,n,e)},this.write.isJSONMapWriter=!0}toJSON(t){if(null==t)return null;if(this._apiToJSON.hasOwnProperty(t)){const e=this._apiToJSON[t];return this._options.useNumericKeys?+e:e}return this._options.ignoreUnknown?void 0:t}fromJSON(t){return null!=t&&this._jsonToAPI.hasOwnProperty(t)?this._jsonToAPI[t]:this._options.ignoreUnknown?void 0:t}_invertMap(t){const e={};for(const i in t)e[t[i]]=i;return e}_getKeysSorted(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}}function cl(){return function(t,e){return new ul(t,{ignoreUnknown:!0,...e})}}class hl{constructor(t,e,i,n){this.semiMajorAxis=t,this.flattening=e,this.outerAtmosphereRimWidth=i;const s=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*s,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=n||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}}const dl=new hl(6378137,1/298.257223563,3e5,.006694379990137799),fl=new hl(3396190,1/169.8944472236118,23e4),pl=new hl(1737400,0,0);const ml=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,yl={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function gl(t){const e=t?.match(ml);if(!e)return null;const[,i,n,s]=e;if(!i)return null;let r=null,o=null,a=null;const{devext:l,qaext:u,www:c}=yl;if(n)if(r=i,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}else({customBaseUrl:o,portalHostname:a}=c);else switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=u);break;case"www":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:r}}function vl(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function wl(t){const e=atob(t),i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return i.buffer}function bl(t){const e=new Uint8Array(t);let i="";for(let t=0;t<e.length;t++)i+=String.fromCharCode(e[t]);return btoa(i)}const Sl=()=>Ft.getLogger("esri.core.urlUtils"),xl=It.request,_l="esri/config: esriConfig.request.proxyUrl is not set.",Ml=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,kl=/^\s*http:/i,Tl=/^\s*https:/i,Al=/^\s*file:/i,Il=/:\d+$/,jl=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Cl=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),El=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");class Ol{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let e=this.uri.match(Cl);this.scheme=e[2]||(e[1]?"":null),this.authority=e[4]||(e[3]?"":null),this.path=e[5],this.query=e[7]||(e[6]?"":null),this.fragment=e[9]||(e[8]?"":null),null!=this.authority&&(e=this.authority.match(El),this.user=e[3]||null,this.password=e[4]||null,this.host=e[6]||e[7],this.port=e[9]||null)}toString(){return this.uri}}const Ll={},Nl=new Ol(It.applicationUrl);let Rl=Nl;const Pl=zl();let Fl=Pl;const Dl=()=>Rl,$l=()=>Fl;function zl(){const t=Rl.path,e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return`${`${Rl.scheme}://${Rl.host}${null!=Rl.port?`:${Rl.port}`:""}`}${e}`}function Ul(t){if(!t)return null;const e={path:null,query:null},i=new Ol(t),n=t.indexOf("?");return null===i.query?e.path=t:(e.path=t.substring(0,n),e.query=Vl(i.query)),i.fragment&&(e.hash=i.fragment,null===i.query&&(e.path=e.path.substring(0,e.path.length-(i.fragment.length+1)))),e}function Vl(t){const e=t.split("&"),i={};for(const t of e){if(!t)continue;const e=t.indexOf("=");let n,s;e<0?(n=decodeURIComponent(t),s=""):(n=decodeURIComponent(t.slice(0,e)),s=decodeURIComponent(t.slice(e+1)));let r=i[n];"string"==typeof r&&(r=i[n]=[r]),Array.isArray(r)?r.push(s):i[n]=s}return i}function Gl(t,e){return t?e&&"function"==typeof e?Object.keys(t).map((i=>encodeURIComponent(i)+"="+encodeURIComponent(e(i,t[i])))).join("&"):Object.keys(t).map((i=>{const n=t[i];if(null==n)return"";const s=encodeURIComponent(i)+"=",r=e?.[i];return r?s+encodeURIComponent(r(n)):Array.isArray(n)?n.map((t=>tl(t)?s+encodeURIComponent(JSON.stringify(t)):s+encodeURIComponent(t))).join("&"):tl(n)?s+encodeURIComponent(JSON.stringify(n)):s+encodeURIComponent(n)})).filter((t=>t)).join("&"):""}function Bl(t=!1){let e,i=xl.proxyUrl;if("string"==typeof t){e=_u(t);const n=Kl(t);n&&(i=n.proxyUrl)}else e=!!t;if(!i)throw Sl().warn(_l),new Qe("urlUtils:proxy-not-set",_l);e&&Iu()&&(i=Tu(i));return Ul(i)}function ql(t){const e=Kl(t);let i,n;if(e){const t=Wl(e.proxyUrl);i=t.path,n=t.query?Vl(t.query):null}if(i){const e=Ul(t);t=i+"?"+e.path;const s=Gl({...n,...e.query});s&&(t=`${t}?${s}`)}return t}const Hl={path:"",query:""};function Wl(t){const e=t.indexOf("?");return-1!==e?(Hl.path=t.slice(0,e),Hl.query=t.slice(e+1)):(Hl.path=t,Hl.query=null),Hl}function Zl(t){return t=(t=ju(t=Lu(t=Wl(t).path),!0)).toLowerCase()}function Jl(t){const e={proxyUrl:t.proxyUrl,urlPrefix:Zl(t.urlPrefix)},i=xl.proxyRules,n=e.urlPrefix;let s=i.length;for(let t=0;t<i.length;t++){const e=i[t].urlPrefix;if(0===n.indexOf(e)){if(n.length===e.length)return-1;s=t;break}0===e.indexOf(n)&&(s=t+1)}return i.splice(s,0,e),s}function Kl(t){const e=xl.proxyRules,i=Zl(t);for(let t=0;t<e.length;t++)if(0===i.indexOf(e[t].urlPrefix))return e[t]}function Yl(t,e){if(!t||!e)return!1;t=Xl(t),e=Xl(e);const i=gl(t),n=gl(e);return null!=i&&null!=n?i.portalHostname===n.portalHostname:null==i&&null==n&&eu(t,e,!0)}function Ql(t,e){return t=Xl(t),e=Xl(e),ju(t)===ju(e)}function Xl(t){const e=(t=ou(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function tu(t){const e=e=>null==e||e instanceof RegExp&&e.test(t)||"string"==typeof e&&t.startsWith(e),i=xl.interceptors;if(i)for(const t of i)if(Array.isArray(t.urls)){if(t.urls.some(e))return t}else if(e(t.urls))return t;return null}function eu(t,e,i=!1){if(!t||!e)return!1;const n=$u(t),s=$u(e);return!(!i&&n.scheme!==s.scheme)&&(null!=n.host&&null!=s.host&&(n.host.toLowerCase()===s.host.toLowerCase()&&n.port===s.port))}function iu(t){if("string"==typeof t){if(!uu(t))return!0;t=$u(t)}if(eu(t,Rl))return!0;const e=xl.trustedServers||[];for(let i=0;i<e.length;i++){const n=nu(e[i]);for(let e=0;e<n.length;e++)if(eu(t,n[e]))return!0}return!1}function nu(t){return Ll[t]||(xu(t)||Su(t)?Ll[t]=[new Ol(su(t))]:Ll[t]=[new Ol(`http://${t}`),new Ol(`https://${t}`)]),Ll[t]}function su(t,e=Fl,i){return Su(t)?i&&i.preserveProtocolRelative?t:"http"===Rl.scheme&&Rl.authority===lu(t).slice(2)?`http:${t}`:`https:${t}`:xu(t)?t:au("/"===t[0]?Cu(e):e,t)}function ru(t,e=Fl,i){if(null==t||!uu(t))return t;const n=ou(t),s=n.toLowerCase(),r=ou(e).toLowerCase().replace(/\/+$/,""),o=i?ou(i).toLowerCase().replace(/\/+$/,""):null;if(o&&0!==r.indexOf(o))return t;const a=(t,e,i)=>-1===(i=t.indexOf(e,i))?t.length:i;let l=a(s,"/",s.indexOf("//")+2),u=-1;for(;s.slice(0,l+1)===r.slice(0,l)+"/"&&(u=l+1,l!==s.length);)l=a(s,"/",l+1);if(-1===u)return t;if(o&&u<o.length)return t;t=n.slice(u);const c=r.slice(u-1).replaceAll(/[^/]+/g,"").length;if(c>0)for(let e=0;e<c;e++)t=`../${t}`;else t=`./${t}`;return t}function ou(t){return t=Fu(t=Pu(t=Ru(t=su(t=t.trim()))))}function au(...t){const e=t.filter(F);if(!e?.length)return;const i=[];if(uu(e[0])){const t=e[0],n=t.indexOf("//");-1!==n&&(i.push(t.slice(0,n+1)),ku(e[0])&&(i[0]+="/"),e[0]=t.slice(n+2))}else"/"===e[0][0]&&i.push("");const n=e.reduce(((t,e)=>e?t.concat(e.split("/")):t),[]);for(let t=0;t<n.length;t++){const e=n[t];".."===e&&i.length>0&&".."!==i[i.length-1]?i.pop():(!e&&t===n.length-1||e&&("."!==e||0===i.length))&&i.push(e)}return i.join("/")}function lu(t,e=!1){if(null==t||cu(t)||hu(t))return null;let i=t.indexOf("://");if(-1===i&&Su(t))i=2;else{if(-1===i)return null;i+=3}const n=t.indexOf("/",i);return-1!==n&&(t=t.slice(0,n)),e&&(t=ju(t,!0)),t}function uu(t){return Su(t)||xu(t)}function cu(t){return null!=t&&"blob:"===t.slice(0,5)}function hu(t){return null!=t&&"data:"===t.slice(0,5)}function du(t){const e=mu(t);return e&&e.isBase64?wl(e.data):null}function fu(t){return bl(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const pu=/^data:(.*?)(;base64)?,(.*)$/;function mu(t){const e=t.match(pu);if(!e)return null;const[,i,n,s]=e;return{mediaType:i,isBase64:!!n,data:s}}function yu(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function gu(t){return(await fetch(t)).blob()}function vu(t){const e=du(t);if(!e)return null;const i=mu(t);return new Blob([e],{type:i.mediaType})}function wu(t,e){bu(t,e)}function bu(t,e){if(!t)return!1;const i=document.createElement("a");if(!("download"in i))return!1;const n=URL.createObjectURL(t);return i.download=e,i.href=n,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),!0}function Su(t){return null!=t&&"/"===t[0]&&"/"===t[1]}function xu(t){return null!=t&&Ml.test(t)}function _u(t){return null!=t&&Tl.test(t)||"https"===Rl.scheme&&Su(t)}function Mu(t){return null!=t&&kl.test(t)||"http"===Rl.scheme&&Su(t)}function ku(t){return null!=t&&Al.test(t)}function Tu(t){return Su(t)?`https:${t}`:t.replace(kl,"https:")}function Au(){return"http"===Rl.scheme}function Iu(){return"https"===Rl.scheme}function ju(t,e=!1){return Su(t)?t.slice(2):(t=t.replace(Ml,""),e&&t.length>1&&"/"===t[0]&&"/"===t[1]&&(t=t.slice(2)),t)}function Cu(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return-1===i?t:t.slice(0,i)}function Eu(t){let e=0;if(uu(t)){const i=t.indexOf("//");-1!==i&&(e=i+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function Ou(t,e){if(!t)return"";const i=Ul(t).path.replace(/\/+$/,""),n=i.substring(i.lastIndexOf("/")+1);if(!e?.length)return n;const s=new RegExp(`.(${e.join("|")})$`,"ig");return n.replace(s,"")}function Lu(t){return t.endsWith("/")?t:`${t}/`}function Nu(t){return t.replace(/\/+$/,"")}function Ru(t){if(/^https?:\/\//i.test(t)){const e=Wl(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function Pu(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function Fu(t){const e=xl.httpsDomains;if(!Mu(t))return t;const i=t.indexOf("/",7);let n;if(n=-1===i?t:t.slice(0,i),n=n.toLowerCase().slice(7),Il.test(n)){if(!n.endsWith(":80"))return t;n=n.slice(0,-3),t=t.replace(":80","")}return Au()&&n===Rl.authority&&!jl.test(t)||(Iu()&&n===Rl.authority||e&&e.some((t=>n===t||n.endsWith(`.${t}`)))||Iu()&&!Kl(t))&&(t=Tu(t)),t}function Du(t,e,i){if(!(e&&i&&t&&uu(t)))return t;const n=t.indexOf("//"),s=t.indexOf("/",n+2),r=t.indexOf(":",n+2),o=Math.min(s<0?t.length:s,r<0?t.length:r);if(t.slice(n+2,o).toLowerCase()!==e.toLowerCase())return t;return`${t.slice(0,n+2)}${i}${t.slice(o)}`}function $u(t){return"string"==typeof t?new Ol(su(t)):(t.scheme||(t.scheme=Rl.scheme),t)}function zu(t){return Zu.test(t)}function Uu(t,e){const i=Ul(t),n=Object.keys(i.query||{});return n.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${n.join(", ")}.`),i.path}function Vu(t,e,i){const n=Ul(t),s=n.query||{};return s[e]=String(i),`${n.path}?${Gl(s)}`}function Gu(t,e){if(!e)return t;const i=Ul(t),n=i.query||{};for(const[t,i]of Object.entries(e))null!=i&&(n[t]=i);const s=Gl(n);return s?`${i.path}?${s}`:i.path}function Bu(t){if(null==t)return null;const e=t.match(Wu);return e?e[2]:null}function qu(t){if(null==t)return null;const e=t.match(Wu);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function Hu(t){if("string"==typeof t){return mu(t)??{data:t}}return new Promise(((e,i)=>{const n=new FileReader;n.readAsDataURL(t),n.onload=()=>e(mu(n.result)),n.onerror=t=>i(t)}))}const Wu=/([^.]*)\.([^\/]*)$/,Zu=/(^data:image\/svg|\.svg$)/i;const Ju="20240321",Ku="9cf5a4b8555fda94595b625a40b922e012baf071";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const Yu="4.29";let Qu,Xu=Yu;Xu="4.29.10";function tc(t){Qu=t}function ec(t){const e=Qu?.findCredential(t);return e?.token?Vu(t,"token",e.token):t}c("host-webworker");const ic=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function nc(t){const e=lu(t,!0);return!!e&&(e.endsWith(".arcgis.com")&&!ic.has(e)&&!t.endsWith("/sharing/rest/generateToken"))}function sc(t,e,i=!1,n){return new Promise(((s,r)=>{if(Ci(n))return void r(rc());let o=()=>{u(),r(new Error(`Unable to load ${e}`))},a=()=>{const e=t;u(),s(e)},l=()=>{if(!t)return;const e=t;u(),e.src="",r(rc())};const u=()=>{c("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,null!=n&&n.removeEventListener("abort",l),l=null,i&&URL.revokeObjectURL(e)};null!=n&&n.addEventListener("abort",l),c("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))}))}function rc(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const oc="Timeout exceeded";function ac(){return new Error(oc)}function lc(t){It.request.crossOriginNoCorsDomains||(It.request.crossOriginNoCorsDomains={});const e=It.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[lu(i)??""]=0:(e[lu("http://"+i)??""]=0,e[lu("https://"+i)??""]=0)}function uc(t){const e=It.request.crossOriginNoCorsDomains;if(e){let i=lu(t);if(i)return i=i.toLowerCase(),!eu(i,Dl())&&e[i]<Date.now()-36e5}return!1}async function cc(t){const e=It.request.crossOriginNoCorsDomains,i=lu(t);e&&i&&(e[i.toLowerCase()]=Date.now());const n=Ul(t);t=n.path,"json"===n.query?.f&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}}async function hc(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=Vl(e.query.toString().replaceAll("+"," ")));const i=hu(t),n=cu(t);n||i||(t=ou(t));const s={url:t,requestOptions:{...e}};let r=tu(t);if(r){const t=await Ic(r,s);if(null!=t)return{data:t,getAllHeaders:vc,getHeader:vc,httpStatus:200,requestOptions:s.requestOptions,url:s.url};r.after||r.error||(r=null)}if(t=s.url,"image"===(e=s.requestOptions).responseType&&(c("host-webworker")||c("host-node")))throw xc("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if("head"===e.method){if(e.body)throw xc("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(i||n)throw xc("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(await _c(),dc)return dc.execute(t,e);const o=new AbortController;Li(e,(()=>o.abort()));const a={controller:o,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:r,params:s,redoRequest:!1,useIdentity:fc.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},l=await Ec(a);return r?.after?.(l),l}let dc;const fc=It.request,pc="FormData"in globalThis,mc=new Set([499,498,403,401]),yc=new Set(["COM_0056","COM_0057","SB_0008"]),gc=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],vc=()=>null,wc=Symbol();function bc(t){const e=lu(t);e&&!hc._corsServers.includes(e)&&hc._corsServers.push(e)}function Sc(t){const e=lu(t);return!e||e.endsWith(".arcgis.com")||hc._corsServers.includes(e)||iu(e)}function xc(t,e,i,n){let s="Error";const r={url:i.url,requestOptions:i.requestOptions,getAllHeaders:vc,getHeader:vc,ssl:!1};if(e instanceof Qe)return e.details?(e.details=ht(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=r,e;if(e){const t=n&&(()=>Array.from(n.headers)),i=n&&(t=>n.headers.get(t)),o=n?.status,a=e.message;a&&(s=a),t&&i&&(r.getAllHeaders=t,r.getHeader=i),r.httpStatus=(null!=e.httpCode?e.httpCode:e.code)||o||0,r.subCode=e.subcode,r.messageCode=e.messageCode,"string"==typeof e.details?r.messages=[e.details]:r.messages=e.details,r.raw=wc in e?e[wc]:e}return Pi(e)?Ai():new Qe(t,s,r)}async function _c(){c("host-webworker")&&!dc&&(dc=await import("./p-8cef5f76.js"))}async function Mc(){Qu||await Promise.resolve().then((function(){return Xjt}))}async function kc(t){const e=t.params.url,i=t.params.requestOptions,n=t.controller.signal,s=i.body;let r=null,o=null;if(pc&&"HTMLFormElement"in globalThis&&(s instanceof FormData?r=s:s instanceof HTMLFormElement&&(r=new FormData(s))),"string"==typeof s&&(o=s),t.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:"head"===i.method?"HEAD":"GET",mode:"cors",priority:fc.priority,redirect:"follow",signal:n},(r||o)&&(t.fetchOptions.body=r||o),"anonymous"===i.authMode&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||i.query?.token||r?.get("token")),!t.hasToken&&It.apiKey&&nc(e)&&(i.query||(i.query={}),i.query.token=It.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!Tc(e)&&!Ci(n)){let s;"immediate"===i.authMode?(await Mc(),s=await Qu.getCredential(e,{signal:n}),t.credential=s):"no-prompt"===i.authMode?(await Mc(),s=await Qu.getCredential(e,{prompt:!1,signal:n}).catch((()=>{})),t.credential=s):Qu&&(s=Qu.findCredential(e)),s&&(t.credentialToken=s.token,t.useSSL=!!s.ssl)}}function Tc(t){return gc.some((e=>e.test(t)))}async function Ac(t){let e=t.params.url;const i=t.params.requestOptions,n=t.fetchOptions??{},s=cu(e)||hu(e),r=i.responseType||"json",o=s?0:null!=i.timeout?i.timeout:fc.timeout;let a=!1;if(!s){t.useSSL&&(e=Tu(e));let s={...i.query};t.credentialToken&&(s.token=t.credentialToken);let r=Gl(s);c("esri-url-encodes-apostrophe")&&(r=r.replaceAll("'","%27"));const o=e.length+1+r.length;let l;a="delete"===i.method||"post"===i.method||"put"===i.method||!!i.body||o>fc.maxUrlLength;const u=i.useProxy||!!Kl(e);if(u){const t=Bl(e);l=t.path,!a&&l.length+1+o>fc.maxUrlLength&&(a=!0),t.query&&(s={...t.query,...s})}if("HEAD"===n.method&&(a||u)){if(a){if(o>fc.maxUrlLength)throw xc("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params);throw xc("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params)}if(u)throw xc("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(a?(n.method="delete"===i.method?"DELETE":"put"===i.method?"PUT":"POST",i.body?e=Gu(e,s):(n.body=Gl(s),n.headers||(n.headers={}),n.headers["Content-Type"]="application/x-www-form-urlencoded")):e=Gu(e,s),u&&(t.useProxy=!0,e=`${l}?${e}`),s.token&&pc&&n.body instanceof FormData&&!vl(e)&&n.body.set("token",s.token),i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!eu(e,Dl()))if(iu(e))t.withCredentials=!0;else if(Qu){const i=Qu.findServerInfo(e);i?.webTierAuth&&(t.withCredentials=!0)}t.withCredentials&&(n.credentials="include",uc(e)&&await cc(a?Gu(e,s):e))}let l,u,h=0,d=!1;o>0&&(h=setTimeout((()=>{d=!0,t.controller.abort()}),o));try{if("native-request-init"===i.responseType)u=n,u.url=e;else if("image"!==i.responseType||"default"!==n.cache||"GET"!==n.method||a||jc(i.headers)||!s&&!t.useProxy&&fc.proxyUrl&&!Sc(e)){if(hc._beforeFetch&&await hc._beforeFetch(e,n),l=await fetch(e,n),hc._afterFetch&&await hc._afterFetch(l),t.useProxy||bc(e),"native"===i.responseType)u=l;else if("HEAD"!==n.method)if(l.ok){switch(r){case"array-buffer":u=await l.arrayBuffer();break;case"blob":case"image":u=await l.blob();break;default:u=await l.text()}if(h&&(clearTimeout(h),h=0),"json"===r||"xml"===r||"document"===r)if(u)switch(r){case"json":u=JSON.parse(u);break;case"xml":u=Cc(u,"application/xml");break;case"document":u=Cc(u,"text/html")}else u=null;if(u){if("array-buffer"===r||"blob"===r){const t=l.headers.get("Content-Type");if(t&&/application\/json|text\/plain/i.test(t)&&u["blob"===r?"size":"byteLength"]<=750)try{const t=await new Response(u).json();t.error&&(u=t)}catch{}}"image"===r&&u instanceof Blob&&(u=await Lc(URL.createObjectURL(u),t,!0))}}else{u=await l.text();try{u=JSON.parse(u)}catch{}}}else u=await Lc(e,t)}catch(n){if("AbortError"===n.name){if(d)throw ac();throw Ai("Request canceled")}if(!(!l&&n instanceof TypeError&&fc.proxyUrl)||i.body||"delete"===i.method||"head"===i.method||"post"===i.method||"put"===i.method||t.useProxy||Sc(e))throw n;t.redoRequest=!0,Jl({proxyUrl:fc.proxyUrl,urlPrefix:lu(e)??""})}finally{h&&clearTimeout(h)}return[l,u]}async function Ic(t,e){if(null!=t.responseData)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,n;try{n=await t.before(e)}catch(t){i=xc("request:interceptor",t,e)}if((n instanceof Error||n instanceof Qe)&&(i=xc("request:interceptor",n,e)),i)throw t.error&&t.error(i),i;return n}}function jc(t){if(t)for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0;return!1}function Cc(t,e){let i;try{i=(new DOMParser).parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function Ec(t){let e,i;await kc(t);try{do{[e,i]=await Ac(t)}while(!await Oc(t,e,i))}catch(i){const n=xc("request:server",i,t.params,e);throw n.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(n),n}const n=t.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(n)){if(!t.hasToken&&!t.credentialToken&&i.user?.username&&!iu(n)){const t=lu(n,!0);t&&fc.trustedServers.push(t)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&lc(i.authorizedCrossOriginNoCorsDomains)}const s=t.credential;if(s&&Qu){const t=Qu.findServerInfo(s.server);let e=t?.owningSystemUrl;if(e){e=e.replace(/\/?$/,"/sharing");const t=Qu.findCredential(e,s.userId);t&&-1===Qu._getIdenticalSvcIdx(e,t)&&t.resources.unshift(e)}}return{data:i,getAllHeaders:e?()=>Array.from(e.headers):vc,getHeader:e?t=>e.headers.get(t):vc,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function Oc(t,e,i){if(t.redoRequest)return t.redoRequest=!1,!1;const n=t.params.requestOptions;if(!e||"native"===n.responseType||"native-request-init"===n.responseType)return!0;let s,r;if(i&&(i.error?s=i.error:"error"===i.status&&Array.isArray(i.messages)&&(s={...i},s[wc]=i,s.details=i.messages)),!s&&!e.ok)throw s=new Error(`Unable to load ${e.url} status: ${e.status}`),s[wc]=i,s;let o,a=null;s&&(r=Number(s.code),a=s.hasOwnProperty("subcode")?Number(s.subcode):null,o=s.messageCode,o=o?.toUpperCase());const l=n.authMode;if(403===r&&(4===a||s.message?.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&("no-prompt"!==l||498===r)&&void 0!==r&&mc.has(r)&&!Tc(t.params.url)&&(403!==r||(!o||!yc.has(o))&&(null==a||2===a&&t.credentialToken))){await Mc();try{const e=await Qu.getCredential(t.params.url,{error:xc("request:server",s,t.params),prompt:"no-prompt"!==l,signal:t.controller.signal,token:t.credentialToken});return t.credential=e,t.credentialToken=e.token,t.useSSL=t.useSSL||e.ssl,!1}catch(e){if("no-prompt"===l)return t.credential=void 0,t.credentialToken=void 0,!1;s=e}}if(s)throw s;return!0}function Lc(t,e,i=!1){const n=e.controller.signal,s=new Image;return e.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=fc.priority,s.src=t,sc(s,t,i,n)}hc._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],hc._beforeFetch=void 0,hc._afterFetch=void 0;function Nc(t){if(!It.assetsPath)throw Ft.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Qe("assets:path-not-set","config.assetsPath is not set");return au(It.assetsPath,t)}let Rc,Pc=null;function Fc(){return!!Pc}function Dc(){return!!c("esri-wasm")}function $c(){return Rc||(Rc=import("./p-5b88783a.js").then((t=>t.p)).then((({default:t})=>t({locateFile:t=>Nc(`esri/geometry/support/${t}`)}))).then((t=>{Xc(t)})),Rc)}var zc,Uc,Vc;!function(t){function e(t,e,i){Pc.ensureCache.prepare();const n=ih(i),s=i===n,r=Pc.ensureFloat64(n),o=Pc._pe_geog_to_proj(Pc.getPointer(t),e,r);return o&&nh(i,e,r,s),o}function i(t,i,s,r){switch(r){case Uc.PE_TRANSFORM_P_TO_G:return n(t,i,s);case Uc.PE_TRANSFORM_G_TO_P:return e(t,i,s)}return 0}function n(t,e,i){return s(t,e,i,0)}function s(t,e,i,n){Pc.ensureCache.prepare();const s=ih(i),r=i===s,o=Pc.ensureFloat64(s),a=Pc._pe_proj_to_geog_center(Pc.getPointer(t),e,o,n);return a&&nh(i,e,o,r),a}t.geogToProj=e,t.projGeog=i,t.projToGeog=n,t.projToGeogCenter=s}(zc||(zc={})),function(t){function e(){t.PE_BUFFER_MAX=Pc.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=Pc.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=Pc.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=Pc.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=Pc.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=Pc.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=Pc.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=Pc.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=Pc.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=Pc.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=Pc.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=Pc.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=Pc.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=Pc.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=Pc.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=Pc.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=Pc.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=Pc.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=Pc.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=Pc.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_STR_FMT_WKT=Pc.PeDefs.prototype.PE_STR_FMT_WKT,t.PE_STR_FMT_WKT2=Pc.PeDefs.prototype.PE_STR_FMT_WKT2,t.PE_PARM_X0=Pc.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=Pc.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=Pc.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=Pc.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=Pc.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=Pc.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=Pc.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=Pc.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=Pc.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=Pc.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e}(Uc||(Uc={})),function(t){const e={},i={},n=t=>{if(t){const e=t.getType();switch(e){case Uc.PE_TYPE_GEOGCS:t=Pc.castObject(t,Pc.PeGeogcs);break;case Uc.PE_TYPE_PROJCS:t=Pc.castObject(t,Pc.PeProjcs);break;case Uc.PE_TYPE_GEOGTRAN:t=Pc.castObject(t,Pc.PeGeogtran);break;default:e&Uc.PE_TYPE_UNIT&&(t=Pc.castObject(t,Pc.PeUnit))}}return t};function s(){Pc.PeFactory.prototype.initialize(null)}function r(t){return o(Uc.PE_TYPE_COORDSYS,t)}function o(t,i){let s=null,r=e[t];if(r||(r={},e[t]=r),r.hasOwnProperty(String(i)))s=r[i];else{const e=Pc.PeFactory.prototype.factoryByType(t,i);Pc.compare(e,Pc.NULL)||(s=e,r[i]=s)}return s=n(s),s}function a(t,e){let s=null,r=i[t];if(r||(r={},i[t]=r),r.hasOwnProperty(e))s=r[e];else{const i=Pc.PeFactory.prototype.fromString(t,e);Pc.compare(i,Pc.NULL)||(s=i,r[e]=s)}return s=n(s),s}function l(t){return o(Uc.PE_TYPE_GEOGCS,t)}function u(t){return o(Uc.PE_TYPE_GEOGTRAN,t)}function c(t){return Pc.PeFactory.prototype.getCode(t)}function h(t){return o(Uc.PE_TYPE_PROJCS,t)}function d(t){return o(Uc.PE_TYPE_UNIT,t)}t.initialize=s,t.coordsys=r,t.factoryByType=o,t.fromString=a,t.geogcs=l,t.geogtran=u,t.getCode=c,t.projcs=h,t.unit=d}(Vc||(Vc={}));let Gc=null;var Bc,qc,Hc,Wc,Zc,Jc,Kc,Yc,Qc;function Xc(t){function e(t,e,i){t[e]=i(t[e])}Pc=t,Uc.init(),Bc.init(),Zc.init(),Kc.init(),Yc.init(),Gc=class extends Pc.PeGCSExtent{destroy(){Pc.destroy(this)}};const i=[Pc.PeDatum,Pc.PeGeogcs,Pc.PeGeogtran,Pc.PeObject,Pc.PeParameter,Pc.PePrimem,Pc.PeProjcs,Pc.PeSpheroid,Pc.PeUnit];for(const t of i)e(t.prototype,"getName",(t=>function(){return t.call(this,new Array(Uc.PE_NAME_MAX))}));for(const t of[Pc.PeGeogtran,Pc.PeProjcs])e(t.prototype,"getParameters",(t=>function(){const e=new Array(Uc.PE_PARM_MAX);let i=t.call(this);for(let t=0;t<e.length;t++){const n=Pc.getValue(i,"*");e[t]=n?Pc.wrapPointer(n,Pc.PeParameter):null,i+=Int32Array.BYTES_PER_ELEMENT}return e}));e(Pc.PeHorizon.prototype,"getCoord",(t=>function(){const e=this.getSize();if(!e)return null;const i=[];return nh(i,e,t.call(this)),i})),e(Pc.PeGTlistExtendedEntry.prototype,"getEntries",(t=>{const e=Pc._pe_getPeGTlistExtendedGTsSize();return function(){let i=null;const n=t.call(this);if(!Pc.compare(n,Pc.NULL)){i=[n];const t=this.getSteps();if(t>1){const s=Pc.getPointer(n);for(let n=1;n<t;n++)i.push(Pc.wrapPointer(s+e*n,Pc.PeGTlistExtendedGTs))}}return i}}));const n=Pc._pe_getPeHorizonSize(),s=t=>function(){let e=this._cache;if(e||(e=new Map,this._cache=e),e.has(t))return e.get(t);let i=null;const s=t.call(this);if(!Pc.compare(s,Pc.NULL)){i=[s];const t=s.getNump();if(t>1){const e=Pc.getPointer(s);for(let s=1;s<t;s++)i.push(Pc.wrapPointer(e+n*s,Pc.PeHorizon))}}return e.set(t,i),i};e(Pc.PeProjcs.prototype,"horizonGcsGenerate",s),e(Pc.PeProjcs.prototype,"horizonPcsGenerate",s),Pc.PeObject.prototype.toString=function(t=Uc.PE_STR_OPTS_NONE){Pc.ensureCache.prepare();const e=Pc.getPointer(this),i=Pc.ensureInt8(new Array(Uc.PE_BUFFER_MAX));return Pc.UTF8ToString(Pc._pe_object_to_string_ext(e,t,i))}}function th(t){if(!t)return;const e=Pc.getClass(t);if(!e)return;const i=Pc.getCache(e);if(!i)return;const n=Pc.getPointer(t);n&&delete i[n]}function eh(t,e){const i=[],n=new Array(e);for(let e=0;e<t;e++)i.push(Pc.ensureInt8(n));return i}function ih(t){let e;return Array.isArray(t[0])?(e=[],t.forEach((t=>{e.push(t[0],t[1])}))):e=t,e}function nh(t,e,i,n=!1){if(n)for(let n=0;n<2*e;n++)t[n]=Pc.getValue(i+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=0===t.length;for(let s=0;s<e;s++)n&&(t[s]=new Array(2)),t[s][0]=Pc.getValue(i,"double"),t[s][1]=Pc.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}!function(t){let e;function i(){t.PE_GTLIST_OPTS_COMMON=Pc.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=Pc._pe_getPeGTlistExtendedEntrySize()}function n(t,i,n,s,r,o){let a=null;const l=new Pc.PeInteger(o);try{const u=Pc.PeGTlistExtended.prototype.getGTlist(t,i,n,s,r,l);if((o=l.val)&&(a=[u],o>1)){const t=Pc.getPointer(u);for(let i=1;i<o;i++)a.push(Pc.wrapPointer(t+e*i,Pc.PeGTlistExtendedEntry))}}finally{Pc.destroy(l)}return a}t.init=i,t.getGTlist=n}(Bc||(Bc={})),function(t){function e(t){if(t?.length){for(const e of t)th(e),e.getEntries().forEach((t=>{th(t);const e=t.getGeogtran();th(e),e.getParameters().forEach(th),[e.getGeogcs1(),e.getGeogcs2()].forEach((t=>{th(t);const e=t.getDatum();th(e),th(e.getSpheroid()),th(t.getPrimem()),th(t.getUnit())}))}));Pc.PeGTlistExtendedEntry.prototype.Delete(t[0])}}t.destroy=e}(qc||(qc={})),function(t){function e(t,e,i,n,s){Pc.ensureCache.prepare();const r=ih(i),o=i===r,a=Pc.ensureFloat64(r);let l=0;n&&(l=Pc.ensureFloat64(n));const u=Pc._pe_geog_to_geog(Pc.getPointer(t),e,a,l,s);return u&&nh(i,e,a,o),u}t.geogToGeog=e}(Hc||(Hc={})),function(t){const e=(t,e,i,n,s,r)=>{let o,a;switch(Pc.ensureCache.prepare(),t){case"dd":o=Pc._pe_geog_to_dd,a=Uc.PE_DD_MAX;break;case"ddm":o=Pc._pe_geog_to_ddm,a=Uc.PE_DDM_MAX;break;case"dms":o=Pc._pe_geog_to_dms,a=Uc.PE_DMS_MAX}let l=0;e&&(l=Pc.getPointer(e));const u=ih(n),c=Pc.ensureFloat64(u),h=eh(i,a),d=o(l,i,c,s,Pc.ensureInt32(h));if(d)for(let t=0;t<i;t++)r[t]=Pc.UTF8ToString(h[t]);return d},i=(t,e,i,n,s)=>{let r;switch(Pc.ensureCache.prepare(),t){case"dd":r=Pc._pe_dd_to_geog;break;case"ddm":r=Pc._pe_ddm_to_geog;break;case"dms":r=Pc._pe_dms_to_geog}let o=0;e&&(o=Pc.getPointer(e));const a=n.map((t=>Pc.ensureString(t))),l=Pc.ensureInt32(a),u=Pc.ensureFloat64(new Array(2*i)),c=r(o,i,l,u);return c&&nh(s,i,u),c};function n(t,i,n,s,r){return e("dms",t,i,n,s,r)}function s(t,e,n,s){return i("dms",t,e,n,s)}function r(t,i,n,s,r){return e("ddm",t,i,n,s,r)}function o(t,e,n,s){return i("ddm",t,e,n,s)}function a(t,i,n,s,r){return e("dd",t,i,n,s,r)}function l(t,e,n,s){return i("dd",t,e,n,s)}t.geogToDms=n,t.dmsToGeog=s,t.geogToDdm=r,t.ddmToGeog=o,t.geogToDd=a,t.ddToGeog=l}(Wc||(Wc={})),function(t){function e(){t.PE_MGRS_STYLE_NEW=Pc.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=Pc.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=Pc.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=Pc.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=Pc.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(t,e,i,n,s,r,o){Pc.ensureCache.prepare();let a=0;t&&(a=Pc.getPointer(t));const l=ih(i),u=Pc.ensureFloat64(l),c=eh(e,Uc.PE_MGRS_MAX),h=Pc.ensureInt32(c),d=Pc._pe_geog_to_mgrs_extended(a,e,u,n,s,r,h);if(d)for(let t=0;t<e;t++)o[t]=Pc.UTF8ToString(c[t]);return d}function n(t,e,i,n,s){Pc.ensureCache.prepare();let r=0;t&&(r=Pc.getPointer(t));const o=i.map((t=>Pc.ensureString(t))),a=Pc.ensureInt32(o),l=Pc.ensureFloat64(new Array(2*e)),u=Pc._pe_mgrs_to_geog_extended(r,e,a,n,l);return u&&nh(s,e,l),u}t.init=e,t.geogToMgrsExtended=i,t.mgrsToGeogExtended=n}(Zc||(Zc={})),function(t){function e(t,e,i,n,s,r,o){Pc.ensureCache.prepare();let a=0;t&&(a=Pc.getPointer(t));const l=ih(i),u=Pc.ensureFloat64(l),c=eh(e,Uc.PE_MGRS_MAX),h=Pc.ensureInt32(c),d=Pc._pe_geog_to_usng(a,e,u,n,s,r,h);if(d)for(let t=0;t<e;t++)o[t]=Pc.UTF8ToString(c[t]);return d}function i(t,e,i,n){Pc.ensureCache.prepare();let s=0;t&&(s=Pc.getPointer(t));const r=i.map((t=>Pc.ensureString(t))),o=Pc.ensureInt32(r),a=Pc.ensureFloat64(new Array(2*e)),l=Pc._pe_usng_to_geog(s,e,o,a);return l&&nh(n,e,a),l}t.geogToUsng=e,t.usngToGeog=i}(Jc||(Jc={})),function(t){function e(){t.PE_UTM_OPTS_NONE=Pc.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=Pc.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=Pc.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(t,e,i,n,s){Pc.ensureCache.prepare();let r=0;t&&(r=Pc.getPointer(t));const o=ih(i),a=Pc.ensureFloat64(o),l=eh(e,Uc.PE_UTM_MAX),u=Pc.ensureInt32(l),c=Pc._pe_geog_to_utm(r,e,a,n,u);if(c)for(let t=0;t<e;t++)s[t]=Pc.UTF8ToString(l[t]);return c}function n(t,e,i,n,s){Pc.ensureCache.prepare();let r=0;t&&(r=Pc.getPointer(t));const o=i.map((t=>Pc.ensureString(t))),a=Pc.ensureInt32(o),l=Pc.ensureFloat64(new Array(2*e)),u=Pc._pe_utm_to_geog(r,e,a,n,l);return u&&nh(s,e,l),u}t.init=e,t.geogToUtm=i,t.utmToGeog=n}(Kc||(Kc={})),function(t){const e=new Map;function i(){t.PE_PCSINFO_OPTION_NONE=Pc.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=Pc.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=Pc.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=Pc.PePCSInfo.prototype.PE_POLE_POINT}function n(i,n=t.PE_PCSINFO_OPTION_DOMAIN){let s=null,r=null;return e.has(i)&&(r=e.get(i),r[n]&&(s=r[n])),s||(s=Pc.PePCSInfo.prototype.generate(i,n),r||(r=[],e.set(i,r)),r[n]=s),s}t.init=i,t.generate=n}(Yc||(Yc={})),function(t){function e(){return Pc.PeVersion.prototype.version_string()}t.versionString=e}(Qc||(Qc={}));const sh=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return zc},get PeDefs(){return Uc},get PeFactory(){return Vc},get PeGCSExtent(){return Gc},get PeGTTransformations(){return Hc},get PeGTlistExtended(){return Bc},get PeGTlistExtendedEntry(){return qc},get PeNotationDms(){return Wc},get PeNotationMgrs(){return Zc},get PeNotationUsng(){return Jc},get PeNotationUtm(){return Kc},get PePCSInfo(){return Yc},get PeVersion(){return Qc},_init:Xc,get _pe(){return Pc},isLoaded:Fc,isSupported:Dc,load:$c},Symbol.toStringTag,{value:"Module"}));var rh;!function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"}(rh||(rh={}));let oh;const ah={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1};for(oh=2e3;oh<=2045;oh++)ah[oh]=0;for(oh=2056;oh<=2065;oh++)ah[oh]=0;for(oh=2067;oh<=2135;oh++)ah[oh]=0;for(oh=2137;oh<=2154;oh++)ah[oh]=0;for(oh=2161;oh<=2170;oh++)ah[oh]=0;for(oh=2172;oh<=2193;oh++)ah[oh]=0;for(oh=2195;oh<=2198;oh++)ah[oh]=0;for(oh=2200;oh<=2203;oh++)ah[oh]=0;for(oh=2205;oh<=2217;oh++)ah[oh]=0;for(oh=2222;oh<=2224;oh++)ah[oh]=1;for(oh=2225;oh<=2250;oh++)ah[oh]=2;for(oh=2251;oh<=2253;oh++)ah[oh]=1;for(oh=2257;oh<=2264;oh++)ah[oh]=2;for(oh=2274;oh<=2279;oh++)ah[oh]=2;for(oh=2280;oh<=2282;oh++)ah[oh]=1;for(oh=2283;oh<=2289;oh++)ah[oh]=2;for(oh=2290;oh<=2292;oh++)ah[oh]=0;for(oh=2308;oh<=2313;oh++)ah[oh]=0;for(oh=2315;oh<=2491;oh++)ah[oh]=0;for(oh=2494;oh<=2866;oh++)ah[oh]=0;for(oh=2867;oh<=2869;oh++)ah[oh]=1;for(oh=2870;oh<=2888;oh++)ah[oh]=2;for(oh=2891;oh<=2895;oh++)ah[oh]=2;for(oh=2896;oh<=2898;oh++)ah[oh]=1;for(oh=2902;oh<=2908;oh++)ah[oh]=2;for(oh=2915;oh<=2920;oh++)ah[oh]=2;for(oh=2921;oh<=2923;oh++)ah[oh]=1;for(oh=2924;oh<=2930;oh++)ah[oh]=2;for(oh=2931;oh<=2962;oh++)ah[oh]=0;for(oh=2964;oh<=2968;oh++)ah[oh]=2;for(oh=2969;oh<=2973;oh++)ah[oh]=0;for(oh=2975;oh<=2991;oh++)ah[oh]=0;for(oh=2995;oh<=3051;oh++)ah[oh]=0;for(oh=3054;oh<=3079;oh++)ah[oh]=0;for(oh=3081;oh<=3088;oh++)ah[oh]=0;for(oh=3092;oh<=3101;oh++)ah[oh]=0;for(oh=3106;oh<=3138;oh++)ah[oh]=0;for(oh=3146;oh<=3151;oh++)ah[oh]=0;for(oh=3153;oh<=3166;oh++)ah[oh]=0;for(oh=3168;oh<=3172;oh++)ah[oh]=0;for(oh=3174;oh<=3203;oh++)ah[oh]=0;for(oh=3294;oh<=3358;oh++)ah[oh]=0;for(oh=3367;oh<=3403;oh++)ah[oh]=0;for(oh=3408;oh<=3416;oh++)ah[oh]=0;for(oh=3417;oh<=3438;oh++)ah[oh]=2;for(oh=3441;oh<=3446;oh++)ah[oh]=2;for(oh=3447;oh<=3450;oh++)ah[oh]=0;for(oh=3451;oh<=3459;oh++)ah[oh]=2;for(oh=3460;oh<=3478;oh++)ah[oh]=0;for(oh=3554;oh<=3559;oh++)ah[oh]=0;for(oh=3560;oh<=3570;oh++)ah[oh]=2;for(oh=3571;oh<=3581;oh++)ah[oh]=0;for(oh=3594;oh<=3597;oh++)ah[oh]=0;for(oh=3601;oh<=3604;oh++)ah[oh]=0;for(oh=3637;oh<=3639;oh++)ah[oh]=0;for(oh=3665;oh<=3667;oh++)ah[oh]=0;for(oh=3693;oh<=3695;oh++)ah[oh]=0;for(oh=3701;oh<=3727;oh++)ah[oh]=0;for(oh=3728;oh<=3739;oh++)ah[oh]=2;for(oh=3740;oh<=3751;oh++)ah[oh]=0;for(oh=3753;oh<=3760;oh++)ah[oh]=2;for(oh=3761;oh<=3773;oh++)ah[oh]=0;for(oh=3775;oh<=3777;oh++)ah[oh]=0;for(oh=3779;oh<=3781;oh++)ah[oh]=0;for(oh=3783;oh<=3785;oh++)ah[oh]=0;for(oh=3788;oh<=3791;oh++)ah[oh]=0;for(oh=3797;oh<=3802;oh++)ah[oh]=0;for(oh=3814;oh<=3816;oh++)ah[oh]=0;for(oh=3825;oh<=3829;oh++)ah[oh]=0;for(oh=3832;oh<=3841;oh++)ah[oh]=0;for(oh=3844;oh<=3852;oh++)ah[oh]=0;for(oh=3873;oh<=3885;oh++)ah[oh]=0;for(oh=3890;oh<=3893;oh++)ah[oh]=0;for(oh=3907;oh<=3912;oh++)ah[oh]=0;for(oh=3942;oh<=3950;oh++)ah[oh]=0;for(oh=3968;oh<=3970;oh++)ah[oh]=0;for(oh=3973;oh<=3976;oh++)ah[oh]=0;for(oh=3986;oh<=3989;oh++)ah[oh]=0;for(oh=3994;oh<=3997;oh++)ah[oh]=0;for(oh=4048;oh<=4051;oh++)ah[oh]=0;for(oh=4056;oh<=4063;oh++)ah[oh]=0;for(oh=4093;oh<=4096;oh++)ah[oh]=0;for(oh=4390;oh<=4398;oh++)ah[oh]=0;for(oh=4399;oh<=4413;oh++)ah[oh]=2;for(oh=4418;oh<=4433;oh++)ah[oh]=2;for(oh=4455;oh<=4457;oh++)ah[oh]=2;for(oh=4484;oh<=4489;oh++)ah[oh]=0;for(oh=4491;oh<=4554;oh++)ah[oh]=0;for(oh=4568;oh<=4589;oh++)ah[oh]=0;for(oh=4652;oh<=4656;oh++)ah[oh]=0;for(oh=4766;oh<=4800;oh++)ah[oh]=0;for(oh=5014;oh<=5016;oh++)ah[oh]=0;for(oh=5069;oh<=5072;oh++)ah[oh]=0;for(oh=5105;oh<=5130;oh++)ah[oh]=0;for(oh=5167;oh<=5188;oh++)ah[oh]=0;for(oh=5253;oh<=5259;oh++)ah[oh]=0;for(oh=5269;oh<=5275;oh++)ah[oh]=0;for(oh=5292;oh<=5311;oh++)ah[oh]=0;for(oh=5329;oh<=5331;oh++)ah[oh]=0;for(oh=5343;oh<=5349;oh++)ah[oh]=0;for(oh=5355;oh<=5357;oh++)ah[oh]=0;for(oh=5387;oh<=5389;oh++)ah[oh]=0;for(oh=5459;oh<=5463;oh++)ah[oh]=0;for(oh=5479;oh<=5482;oh++)ah[oh]=0;for(oh=5518;oh<=5520;oh++)ah[oh]=0;for(oh=5530;oh<=5539;oh++)ah[oh]=0;for(oh=5550;oh<=5552;oh++)ah[oh]=0;for(oh=5562;oh<=5583;oh++)ah[oh]=0;for(oh=5623;oh<=5625;oh++)ah[oh]=2;for(oh=5631;oh<=5639;oh++)ah[oh]=0;for(oh=5649;oh<=5653;oh++)ah[oh]=0;for(oh=5663;oh<=5680;oh++)ah[oh]=0;for(oh=5682;oh<=5685;oh++)ah[oh]=0;for(oh=5875;oh<=5877;oh++)ah[oh]=0;for(oh=5896;oh<=5899;oh++)ah[oh]=0;for(oh=5921;oh<=5940;oh++)ah[oh]=0;for(oh=6050;oh<=6125;oh++)ah[oh]=0;for(oh=6244;oh<=6275;oh++)ah[oh]=0;for(oh=6328;oh<=6348;oh++)ah[oh]=0;for(oh=6350;oh<=6356;oh++)ah[oh]=0;for(oh=6366;oh<=6372;oh++)ah[oh]=0;for(oh=6381;oh<=6387;oh++)ah[oh]=0;for(oh=6393;oh<=6404;oh++)ah[oh]=0;for(oh=6480;oh<=6483;oh++)ah[oh]=0;for(oh=6511;oh<=6514;oh++)ah[oh]=0;for(oh=6579;oh<=6581;oh++)ah[oh]=0;for(oh=6619;oh<=6624;oh++)ah[oh]=0;for(oh=6625;oh<=6627;oh++)ah[oh]=2;for(oh=6628;oh<=6632;oh++)ah[oh]=0;for(oh=6634;oh<=6637;oh++)ah[oh]=0;for(oh=6669;oh<=6692;oh++)ah[oh]=0;for(oh=6707;oh<=6709;oh++)ah[oh]=0;for(oh=6720;oh<=6723;oh++)ah[oh]=0;for(oh=6732;oh<=6738;oh++)ah[oh]=0;for(oh=6931;oh<=6933;oh++)ah[oh]=0;for(oh=6956;oh<=6959;oh++)ah[oh]=0;for(oh=7005;oh<=7007;oh++)ah[oh]=0;for(oh=7057;oh<=7070;oh++)ah[oh]=2;for(oh=7074;oh<=7082;oh++)ah[oh]=0;for(oh=7109;oh<=7118;oh++)ah[oh]=0;for(oh=7119;oh<=7127;oh++)ah[oh]=1;for(oh=7374;oh<=7376;oh++)ah[oh]=0;for(oh=7528;oh<=7586;oh++)ah[oh]=0;for(oh=7587;oh<=7645;oh++)ah[oh]=2;for(oh=7692;oh<=7696;oh++)ah[oh]=0;for(oh=7755;oh<=7787;oh++)ah[oh]=0;for(oh=7791;oh<=7795;oh++)ah[oh]=0;for(oh=7799;oh<=7801;oh++)ah[oh]=0;for(oh=7803;oh<=7805;oh++)ah[oh]=0;for(oh=7825;oh<=7831;oh++)ah[oh]=0;for(oh=7845;oh<=7859;oh++)ah[oh]=0;for(oh=8013;oh<=8032;oh++)ah[oh]=0;for(oh=8065;oh<=8068;oh++)ah[oh]=1;for(oh=8518;oh<=8529;oh++)ah[oh]=2;for(oh=8533;oh<=8536;oh++)ah[oh]=2;for(oh=8538;oh<=8540;oh++)ah[oh]=2;for(oh=8677;oh<=8679;oh++)ah[oh]=0;for(oh=8836;oh<=8840;oh++)ah[oh]=0;for(oh=8857;oh<=8859;oh++)ah[oh]=0;for(oh=8908;oh<=8910;oh++)ah[oh]=0;for(oh=9154;oh<=9159;oh++)ah[oh]=0;for(oh=9205;oh<=9218;oh++)ah[oh]=0;for(oh=9271;oh<=9273;oh++)ah[oh]=0;for(oh=9295;oh<=9297;oh++)ah[oh]=0;for(oh=9356;oh<=9360;oh++)ah[oh]=0;for(oh=9404;oh<=9407;oh++)ah[oh]=0;for(oh=9476;oh<=9482;oh++)ah[oh]=0;for(oh=9487;oh<=9494;oh++)ah[oh]=0;for(oh=9697;oh<=9699;oh++)ah[oh]=0;for(oh=9821;oh<=9865;oh++)ah[oh]=0;for(oh=10285;oh<=10291;oh++)ah[oh]=0;for(oh=10314;oh<=10317;oh++)ah[oh]=0;for(oh=10448;oh<=10465;oh++)ah[oh]=0;for(oh=11114;oh<=11118;oh++)ah[oh]=0;for(oh=20004;oh<=20032;oh++)ah[oh]=0;for(oh=20047;oh<=20049;oh++)ah[oh]=0;for(oh=20062;oh<=20092;oh++)ah[oh]=0;for(oh=20135;oh<=20138;oh++)ah[oh]=0;for(oh=20248;oh<=20258;oh++)ah[oh]=0;for(oh=20348;oh<=20358;oh++)ah[oh]=0;for(oh=20436;oh<=20440;oh++)ah[oh]=0;for(oh=20822;oh<=20824;oh++)ah[oh]=0;for(oh=20904;oh<=20932;oh++)ah[oh]=0;for(oh=20934;oh<=20936;oh++)ah[oh]=0;for(oh=21004;oh<=21032;oh++)ah[oh]=0;for(oh=21035;oh<=21037;oh++)ah[oh]=0;for(oh=21095;oh<=21097;oh++)ah[oh]=0;for(oh=21148;oh<=21150;oh++)ah[oh]=0;for(oh=21207;oh<=21264;oh++)ah[oh]=0;for(oh=21307;oh<=21364;oh++)ah[oh]=0;for(oh=21413;oh<=21423;oh++)ah[oh]=0;for(oh=21453;oh<=21463;oh++)ah[oh]=0;for(oh=21473;oh<=21483;oh++)ah[oh]=0;for(oh=21780;oh<=21782;oh++)ah[oh]=0;for(oh=21891;oh<=21894;oh++)ah[oh]=0;for(oh=21896;oh<=21899;oh++)ah[oh]=0;for(oh=22171;oh<=22177;oh++)ah[oh]=0;for(oh=22181;oh<=22187;oh++)ah[oh]=0;for(oh=22191;oh<=22197;oh++)ah[oh]=0;for(oh=22207;oh<=22222;oh++)ah[oh]=0;for(oh=22229;oh<=22232;oh++)ah[oh]=0;for(oh=22234;oh<=22236;oh++)ah[oh]=0;for(oh=22243;oh<=22250;oh++)ah[oh]=0;for(oh=22262;oh<=22265;oh++)ah[oh]=0;for(oh=22307;oh<=22322;oh++)ah[oh]=0;for(oh=22348;oh<=22357;oh++)ah[oh]=0;for(oh=22407;oh<=22422;oh++)ah[oh]=0;for(oh=22462;oh<=22465;oh++)ah[oh]=0;for(oh=22521;oh<=22525;oh++)ah[oh]=0;for(oh=22607;oh<=22622;oh++)ah[oh]=0;for(oh=22641;oh<=22646;oh++)ah[oh]=0;for(oh=22648;oh<=22657;oh++)ah[oh]=0;for(oh=22707;oh<=22722;oh++)ah[oh]=0;for(oh=22762;oh<=22765;oh++)ah[oh]=0;for(oh=22807;oh<=22822;oh++)ah[oh]=0;for(oh=22991;oh<=22994;oh++)ah[oh]=0;for(oh=23028;oh<=23038;oh++)ah[oh]=0;for(oh=23301;oh<=23333;oh++)ah[oh]=2;for(oh=23830;oh<=23853;oh++)ah[oh]=0;for(oh=23866;oh<=23872;oh++)ah[oh]=0;for(oh=23877;oh<=23884;oh++)ah[oh]=0;for(oh=23886;oh<=23894;oh++)ah[oh]=0;for(oh=23946;oh<=23948;oh++)ah[oh]=0;for(oh=24311;oh<=24313;oh++)ah[oh]=0;for(oh=24342;oh<=24347;oh++)ah[oh]=0;for(oh=24370;oh<=24374;oh++)ah[oh]=10;for(oh=24375;oh<=24381;oh++)ah[oh]=0;for(oh=24718;oh<=24721;oh++)ah[oh]=0;for(oh=24817;oh<=24821;oh++)ah[oh]=0;for(oh=24877;oh<=24882;oh++)ah[oh]=0;for(oh=24891;oh<=24893;oh++)ah[oh]=0;for(oh=25391;oh<=25395;oh++)ah[oh]=0;for(oh=25828;oh<=25838;oh++)ah[oh]=0;for(oh=26191;oh<=26195;oh++)ah[oh]=0;for(oh=26391;oh<=26393;oh++)ah[oh]=0;for(oh=26701;oh<=26722;oh++)ah[oh]=0;for(oh=26729;oh<=26799;oh++)ah[oh]=2;for(oh=26801;oh<=26803;oh++)ah[oh]=2;for(oh=26811;oh<=26813;oh++)ah[oh]=2;for(oh=26847;oh<=26870;oh++)ah[oh]=2;for(oh=26891;oh<=26899;oh++)ah[oh]=0;for(oh=26901;oh<=26923;oh++)ah[oh]=0;for(oh=26929;oh<=26946;oh++)ah[oh]=0;for(oh=26948;oh<=26998;oh++)ah[oh]=0;for(oh=27037;oh<=27040;oh++)ah[oh]=0;for(oh=27205;oh<=27232;oh++)ah[oh]=0;for(oh=27258;oh<=27260;oh++)ah[oh]=0;for(oh=27391;oh<=27398;oh++)ah[oh]=0;for(oh=27561;oh<=27564;oh++)ah[oh]=0;for(oh=27571;oh<=27574;oh++)ah[oh]=0;for(oh=27581;oh<=27584;oh++)ah[oh]=0;for(oh=27591;oh<=27594;oh++)ah[oh]=0;for(oh=28191;oh<=28193;oh++)ah[oh]=0;for(oh=28348;oh<=28358;oh++)ah[oh]=0;for(oh=28402;oh<=28432;oh++)ah[oh]=0;for(oh=28462;oh<=28492;oh++)ah[oh]=0;for(oh=29118;oh<=29122;oh++)ah[oh]=0;for(oh=29168;oh<=29172;oh++)ah[oh]=0;for(oh=29177;oh<=29185;oh++)ah[oh]=0;for(oh=29187;oh<=29195;oh++)ah[oh]=0;for(oh=29900;oh<=29903;oh++)ah[oh]=0;for(oh=30161;oh<=30179;oh++)ah[oh]=0;for(oh=30491;oh<=30494;oh++)ah[oh]=0;for(oh=30729;oh<=30732;oh++)ah[oh]=0;for(oh=31251;oh<=31259;oh++)ah[oh]=0;for(oh=31265;oh<=31268;oh++)ah[oh]=0;for(oh=31275;oh<=31279;oh++)ah[oh]=0;for(oh=31281;oh<=31297;oh++)ah[oh]=0;for(oh=31461;oh<=31469;oh++)ah[oh]=0;for(oh=31491;oh<=31495;oh++)ah[oh]=0;for(oh=31917;oh<=31922;oh++)ah[oh]=0;for(oh=31965;oh<=32e3;oh++)ah[oh]=0;for(oh=32001;oh<=32003;oh++)ah[oh]=2;for(oh=32005;oh<=32031;oh++)ah[oh]=2;for(oh=32033;oh<=32060;oh++)ah[oh]=2;for(oh=32064;oh<=32067;oh++)ah[oh]=2;for(oh=32074;oh<=32077;oh++)ah[oh]=2;for(oh=32081;oh<=32086;oh++)ah[oh]=0;for(oh=32107;oh<=32130;oh++)ah[oh]=0;for(oh=32133;oh<=32159;oh++)ah[oh]=0;for(oh=32164;oh<=32167;oh++)ah[oh]=2;for(oh=32180;oh<=32199;oh++)ah[oh]=0;for(oh=32201;oh<=32260;oh++)ah[oh]=0;for(oh=32301;oh<=32360;oh++)ah[oh]=0;for(oh=32401;oh<=32460;oh++)ah[oh]=0;for(oh=32501;oh<=32560;oh++)ah[oh]=0;for(oh=32601;oh<=32662;oh++)ah[oh]=0;for(oh=32664;oh<=32667;oh++)ah[oh]=2;for(oh=32701;oh<=32761;oh++)ah[oh]=0;for(oh=53001;oh<=53004;oh++)ah[oh]=0;for(oh=53008;oh<=53019;oh++)ah[oh]=0;for(oh=53021;oh<=53032;oh++)ah[oh]=0;for(oh=53034;oh<=53037;oh++)ah[oh]=0;for(oh=53042;oh<=53046;oh++)ah[oh]=0;for(oh=53074;oh<=53080;oh++)ah[oh]=0;for(oh=54001;oh<=54004;oh++)ah[oh]=0;for(oh=54008;oh<=54019;oh++)ah[oh]=0;for(oh=54021;oh<=54032;oh++)ah[oh]=0;for(oh=54034;oh<=54037;oh++)ah[oh]=0;for(oh=54042;oh<=54046;oh++)ah[oh]=0;for(oh=54048;oh<=54053;oh++)ah[oh]=0;for(oh=54074;oh<=54080;oh++)ah[oh]=0;for(oh=54098;oh<=54101;oh++)ah[oh]=0;for(oh=102001;oh<=102040;oh++)ah[oh]=0;for(oh=102042;oh<=102063;oh++)ah[oh]=0;for(oh=102065;oh<=102067;oh++)ah[oh]=0;for(oh=102070;oh<=102117;oh++)ah[oh]=0;for(oh=102122;oh<=102216;oh++)ah[oh]=0;for(oh=102221;oh<=102377;oh++)ah[oh]=0;for(oh=102382;oh<=102388;oh++)ah[oh]=0;for(oh=102389;oh<=102398;oh++)ah[oh]=2;for(oh=102399;oh<=102444;oh++)ah[oh]=0;for(oh=102445;oh<=102447;oh++)ah[oh]=2;for(oh=102448;oh<=102458;oh++)ah[oh]=0;for(oh=102459;oh<=102468;oh++)ah[oh]=2;for(oh=102469;oh<=102499;oh++)ah[oh]=0;for(oh=102500;oh<=102519;oh++)ah[oh]=1;for(oh=102520;oh<=102524;oh++)ah[oh]=0;for(oh=102525;oh<=102529;oh++)ah[oh]=2;for(oh=102530;oh<=102588;oh++)ah[oh]=0;for(oh=102590;oh<=102598;oh++)ah[oh]=0;for(oh=102601;oh<=102603;oh++)ah[oh]=0;for(oh=102605;oh<=102628;oh++)ah[oh]=0;for(oh=102629;oh<=102646;oh++)ah[oh]=2;for(oh=102648;oh<=102700;oh++)ah[oh]=2;for(oh=102701;oh<=102703;oh++)ah[oh]=0;for(oh=102707;oh<=102730;oh++)ah[oh]=2;for(oh=102733;oh<=102758;oh++)ah[oh]=2;for(oh=102767;oh<=102900;oh++)ah[oh]=0;for(oh=102901;oh<=102933;oh++)ah[oh]=2;for(oh=102934;oh<=102950;oh++)ah[oh]=13;for(oh=102951;oh<=102955;oh++)ah[oh]=0;for(oh=102961;oh<=102963;oh++)ah[oh]=0;for(oh=102965;oh<=102969;oh++)ah[oh]=0;for(oh=102971;oh<=102973;oh++)ah[oh]=0;for(oh=102975;oh<=102989;oh++)ah[oh]=0;for(oh=102990;oh<=102992;oh++)ah[oh]=1;for(oh=102997;oh<=103002;oh++)ah[oh]=0;for(oh=103003;oh<=103008;oh++)ah[oh]=2;for(oh=103009;oh<=103011;oh++)ah[oh]=0;for(oh=103012;oh<=103014;oh++)ah[oh]=2;for(oh=103019;oh<=103021;oh++)ah[oh]=0;for(oh=103022;oh<=103024;oh++)ah[oh]=2;for(oh=103029;oh<=103031;oh++)ah[oh]=0;for(oh=103032;oh<=103034;oh++)ah[oh]=2;for(oh=103065;oh<=103068;oh++)ah[oh]=0;for(oh=103074;oh<=103076;oh++)ah[oh]=0;for(oh=103077;oh<=103079;oh++)ah[oh]=1;for(oh=103080;oh<=103082;oh++)ah[oh]=0;for(oh=103083;oh<=103085;oh++)ah[oh]=2;for(oh=103090;oh<=103093;oh++)ah[oh]=0;for(oh=103097;oh<=103099;oh++)ah[oh]=0;for(oh=103100;oh<=103102;oh++)ah[oh]=2;for(oh=103107;oh<=103109;oh++)ah[oh]=0;for(oh=103110;oh<=103112;oh++)ah[oh]=2;for(oh=103113;oh<=103116;oh++)ah[oh]=0;for(oh=103117;oh<=103120;oh++)ah[oh]=2;for(oh=103153;oh<=103157;oh++)ah[oh]=0;for(oh=103158;oh<=103162;oh++)ah[oh]=2;for(oh=103163;oh<=103165;oh++)ah[oh]=0;for(oh=103166;oh<=103168;oh++)ah[oh]=1;for(oh=103169;oh<=103171;oh++)ah[oh]=2;for(oh=103186;oh<=103188;oh++)ah[oh]=0;for(oh=103189;oh<=103191;oh++)ah[oh]=2;for(oh=103192;oh<=103195;oh++)ah[oh]=0;for(oh=103196;oh<=103199;oh++)ah[oh]=2;for(oh=103200;oh<=103224;oh++)ah[oh]=0;for(oh=103225;oh<=103227;oh++)ah[oh]=1;for(oh=103232;oh<=103237;oh++)ah[oh]=0;for(oh=103238;oh<=103243;oh++)ah[oh]=2;for(oh=103244;oh<=103246;oh++)ah[oh]=0;for(oh=103247;oh<=103249;oh++)ah[oh]=2;for(oh=103254;oh<=103256;oh++)ah[oh]=0;for(oh=103257;oh<=103259;oh++)ah[oh]=2;for(oh=103264;oh<=103266;oh++)ah[oh]=0;for(oh=103267;oh<=103269;oh++)ah[oh]=2;for(oh=103300;oh<=103375;oh++)ah[oh]=0;for(oh=103381;oh<=103383;oh++)ah[oh]=0;for(oh=103384;oh<=103386;oh++)ah[oh]=1;for(oh=103387;oh<=103389;oh++)ah[oh]=0;for(oh=103390;oh<=103392;oh++)ah[oh]=2;for(oh=103397;oh<=103399;oh++)ah[oh]=0;for(oh=103400;oh<=103471;oh++)ah[oh]=2;for(oh=103476;oh<=103478;oh++)ah[oh]=0;for(oh=103479;oh<=103481;oh++)ah[oh]=2;for(oh=103486;oh<=103488;oh++)ah[oh]=0;for(oh=103489;oh<=103491;oh++)ah[oh]=2;for(oh=103492;oh<=103495;oh++)ah[oh]=0;for(oh=103496;oh<=103499;oh++)ah[oh]=2;for(oh=103528;oh<=103543;oh++)ah[oh]=0;for(oh=103544;oh<=103548;oh++)ah[oh]=2;for(oh=103549;oh<=103551;oh++)ah[oh]=0;for(oh=103552;oh<=103554;oh++)ah[oh]=1;for(oh=103555;oh<=103557;oh++)ah[oh]=2;for(oh=103558;oh<=103560;oh++)ah[oh]=0;for(oh=103571;oh<=103573;oh++)ah[oh]=0;for(oh=103574;oh<=103576;oh++)ah[oh]=2;for(oh=103577;oh<=103580;oh++)ah[oh]=0;for(oh=103581;oh<=103583;oh++)ah[oh]=2;for(oh=103595;oh<=103694;oh++)ah[oh]=0;for(oh=103696;oh<=103699;oh++)ah[oh]=0;for(oh=103700;oh<=103793;oh++)ah[oh]=2;for(oh=103794;oh<=103890;oh++)ah[oh]=0;for(oh=103891;oh<=103896;oh++)ah[oh]=2;for(oh=103900;oh<=103971;oh++)ah[oh]=2;for(oh=103972;oh<=103977;oh++)ah[oh]=0;for(oh=112e3;oh<=112101;oh++)ah[oh]=0;const lh=[102100,102113,3857,3785],uh=[104905,104971],ch=[4326,...lh,...uh],hh='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',dh=[-20037508.342788905,20037508.342788905],fh=[-20037508.342787,20037508.342787],ph={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:dh,origin:fh,dx:1e-5},102100:{wkTemplate:hh,valid:dh,origin:fh,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:dh,origin:fh,dx:1e-5},3857:{wkTemplate:hh,valid:dh,origin:fh,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function mh(t,e){if(t===e)return!0;if(null==t||null==e)return!1;const i=t.wkid,n=e.wkid;if(null!=i||null!=n){if(i===n)return!0;if(_h(t)&&_h(e))return!0;const s=t.latestWkid;if(null!=s&&n===s)return!0;const r=e.latestWkid;return null!=r&&i===r}let s,r;return t.wkt2&&e.wkt2?(s=t.wkt2,r=e.wkt2):t.wkt&&e.wkt&&(s=t.wkt,r=e.wkt),!(!s||!r)&&s.toUpperCase()===r.toUpperCase()}function yh(t){const e=t?.wkid;return null!=e&&e>=2e3&&ph[e]||null}function gh(t){if(!t)return;const{wkid:e,vcsWkid:i}=t;if(e)return i?JSON.stringify({wkid:e,vcsWkid:i}):String(e);const n=t.wkt||t.wkt2;return JSON.stringify(n?i?{wkt:n,vcsWkid:i}:{wkt:n}:{})}function vh(t){if(!Ch(t))return!1;const{wkid:e}=t;if(e)return null==ah[e];const i=t.wkt2||t.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function wh(t){return!(Th(t)||Ih(t))}function bh(t){return 4326===t?.wkid}function Sh(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function xh(t){return t?.wkid===rh.CGCS2000}function _h(t){const e=t?.wkid;return null!=e&&e>=2e3&&lh.includes(e)}function Mh(t){return 32662===t?.wkid}function kh(t){return t===rh.GCSMARS2000||t===rh.GCSMARS2000_SPHERE}function Th(t){return kh(t?.wkid)}function Ah(t){return t===rh.GCSMOON2000}function Ih(t){return Ah(t?.wkid)}function jh(t){const e=t?.wkid;return null!=e&&e>=2e3&&ch.includes(e)}function Ch(t){if(null==t)return!1;const e=t.wkid;return null!=e&&e>=2e3||(null!=t.wkt2||null!=t.wkt)}const Eh={wkid:4326,wkt:Et(ph[4326].wkTemplate,{Central_Meridian:"0.0"})},Oh={wkid:102100,latestWkid:3857},Lh={wkid:32662};function Nh(t){return{wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${t.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`}}const Rh=Nh(dl),Ph=Nh(fl),Fh=Nh(pl),Dh={wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${dl.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`},$h=Ph.wkt.toUpperCase(),zh=Fh.wkt.toUpperCase();function Uh(t){if(null!=t&&Ch(t)){const e=t.wkid,i=t.wkt2??t.wkt;if(kh(e))return fl;const n=i?.toUpperCase();if(i&&n===$h)return fl;if(Ah(e)||n&&n===zh)return pl}return dl}function Vh(t){return kh(t)?fl:Ah(t)?pl:dl}function Gh(t){return mh(t,Rh)}function Bh(t){return Gh(t)||mh(t,Ph)||mh(t,Fh)}const qh=39.37,Hh=dl.radius*Math.PI/200,Wh=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,Zh=ah,Jh=/UNIT\[([^\]]+)]/i,Kh=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),Yh=cl()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),Qh=t=>t*t,Xh=t=>t*t*t,td={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Qh(.001)},"square-centimeters":{inBaseUnits:Qh(.01)},"square-decimeters":{inBaseUnits:Qh(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Qh(1e3)},"square-inches":{inBaseUnits:Qh(.0254)},"square-feet":{inBaseUnits:Qh(.3048)},"square-yards":{inBaseUnits:Qh(.9144)},"square-miles":{inBaseUnits:Qh(1609.344)},"square-us-feet":{inBaseUnits:Qh(1200/3937)},acres:{inBaseUnits:.0015625*Qh(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Xh(.001)},"cubic-centimeters":{inBaseUnits:1e3*Xh(.01)},"cubic-decimeters":{inBaseUnits:1e3*Xh(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Xh(1e3)},"cubic-inches":{inBaseUnits:1e3*Xh(.0254)},"cubic-feet":{inBaseUnits:1e3*Xh(.3048)},"cubic-yards":{inBaseUnits:1e3*Xh(.9144)},"cubic-miles":{inBaseUnits:1e3*Xh(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},ed=(()=>{const t={};for(const e in td)for(const i in td[e].units)t[i]=e;return t})();function id(t,e,i){return t*td[i].units[e].inBaseUnits}function nd(t,e,i){return t/td[i].units[e].inBaseUnits}function sd(t){const e=ed[t];if(!e)throw new Error("unknown type");return e}function rd(t,e=null){return e=e||sd(t),td[e].baseUnit===t}function od(t,e,i){if(e===i)return t;const n=sd(e);if(n!==sd(i))throw new Error("incompatible units");const s=rd(e,n)?t:id(t,e,n);return rd(i,n)?s:nd(s,i,n)}function ad(t,e,i){return od(t,e,"meters")/(i*Math.PI/180)}function ld(t){return Yh.fromJSON(t.toLowerCase())||null}function ud(t){if(null!=t&&!wh(t))return 1;const e=hd(t);return e>1e5?1:e}function cd(t){return hd(t)>=Uh(t).metersPerDegree?"meters":yd(t)}function hd(t,e=dl.metersPerDegree){return dd(t,!0)??e}function dd(t,e=!1){const i=t?.wkid??null,n=t?.wkt2??t?.wkt??null;let s=null;if(i){if(kh(i))return fl.metersPerDegree;if(Ah(i))return pl.metersPerDegree;s=Zh.values[Zh[i]],!s&&e&&Kh.has(i)&&(s=Hh)}else n&&(vd(n)?s=pd(Wh.exec(n),s):gd(n)&&(s=pd(Jh.exec(n),s)));return s}function fd(t){return vh(t)?1:hd(t)}function pd(t,e){return t?.[1]?md(t[1]):e}function md(t){return parseFloat(t.split(",")[1])}function yd(t){const e=t?.wkid??null,i=t?.wkt2??t?.wkt??null;let n=null;if(e)n=Zh.units[Zh[e]];else if(i){const t=vd(i)?Wh:gd(i)?Jh:null;if(t){const e=t.exec(i);e?.[1]&&(n=bd(e[1]))}}return null!=n?ld(n):null}function gd(t){return/^GEOCCS/i.test(t)}function vd(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const wd=1e-7;function bd(t){const e=/[\\"']{1}([^\\"']+)/.exec(t);let i=e?.[1];if(!i||!Zh.units.includes(i)){const e=md(t);i=null;const n=Zh.values;for(let t=0;t<n.length;++t)if(Math.abs(e-n[t])<wd){i=Zh.units[t];break}}return i}const Sd={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},xd={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},_d={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},Md=cl()(Sd),kd=cl()(xd),Td=cl()(_d);var Ad;let Id=Ad=class extends el{static fromJSON(t){if(!t)return null;if(t.wkid){if(102100===t.wkid)return Ad.WebMercator;if(4326===t.wkid)return Ad.WGS84}const e=new Ad;return e.read(t),e}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){if(t&&"object"==typeof t)return t;return{["string"==typeof t?"wkt":"wkid"]:t}}get isWGS84(){return bh(this)}get isWebMercator(){return _h(this)}get isGeographic(){return vh(this)}get isWrappable(){return jh(this)}get metersPerUnit(){return hd(this)}get unit(){return yd(this)||(this.isGeographic?"degrees":null)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===Ad.WGS84)return new Ad(Eh);if(this===Ad.WebMercator)return new Ad(Oh);const t=new Ad;return null!=this.wkid?(t.wkid=this.wkid,null!=this.latestWkid&&(t.latestWkid=this.latestWkid),null!=this.vcsWkid&&(t.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(t.latestVcsWkid=this.latestVcsWkid)):(null!=this.wkt&&(t.wkt=this.wkt),null!=this.wkt2&&(t.wkt2=this.wkt2)),this.imageCoordinateSystem&&(t.imageCoordinateSystem=ht(this.imageCoordinateSystem)),t}equals(t){if(null==t)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==t.imageCoordinateSystem)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:n}=t.imageCoordinateSystem,s=this.imageCoordinateSystem;return null==e||n?JSON.stringify(s)===JSON.stringify(t.imageCoordinateSystem):i?s.id===e&&s.referenceServiceName===i:s.id===e}return mh(this,t)}toJSON(t){return this.write(void 0,t)}};Id.GCS_NAD_1927=null,Id.WGS84=null,Id.WebMercator=null,Id.PlateCarree=null,o([Us({readOnly:!0})],Id.prototype,"isWGS84",null),o([Us({readOnly:!0})],Id.prototype,"isWebMercator",null),o([Us({readOnly:!0})],Id.prototype,"isGeographic",null),o([Us({readOnly:!0})],Id.prototype,"isWrappable",null),o([Us({type:Ns,json:{write:!0}})],Id.prototype,"latestWkid",void 0),o([Us({readOnly:!0})],Id.prototype,"metersPerUnit",null),o([Us({readOnly:!0})],Id.prototype,"unit",null),o([Us({type:Ns,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null==this.wkt}}}}}}})],Id.prototype,"wkid",void 0),o([Us({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null==this.wkid}}}}}}})],Id.prototype,"wkt",void 0),o([ll("wkt"),ll("web-scene","wkt")],Id.prototype,"writeWkt",null),o([Us({type:String,json:{write:!1}})],Id.prototype,"wkt2",void 0),o([Us({type:Ns,json:{write:!0}})],Id.prototype,"vcsWkid",void 0),o([Us({type:Ns,json:{write:!0}})],Id.prototype,"latestVcsWkid",void 0),o([Us()],Id.prototype,"imageCoordinateSystem",void 0),Id=Ad=o([Nr("esri.geometry.SpatialReference")],Id),Id.prototype.toJSON.isDefaultToJSON=!0,Id.GCS_NAD_1927=new Id({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),Id.WGS84=new Id(Eh),Id.WebMercator=new Id(Oh),Id.PlateCarree=new Id(Lh),Object.freeze&&(Object.freeze(Id.GCS_NAD_1927),Object.freeze(Id.WGS84),Object.freeze(Id.WebMercator),Object.freeze(Id.PlateCarree));const jd=Id;let Cd=class extends el{constructor(...t){super(...t),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=jd.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(t,e){if(t instanceof jd)return t;if(null!=t){const i=new jd;return i.read(t,e),i}return t}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(t){return this.cache[t]}setCacheValue(t,e){this.cache[t]=e}};o([Us()],Cd.prototype,"type",void 0),o([Us({readOnly:!0})],Cd.prototype,"cache",null),o([Us({readOnly:!0})],Cd.prototype,"extent",null),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Cd.prototype,"hasM",void 0),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Cd.prototype,"hasZ",void 0),o([Us({type:jd,json:{write:!0},value:jd.WGS84})],Cd.prototype,"spatialReference",void 0),o([al("spatialReference")],Cd.prototype,"readSpatialReference",null),Cd=o([Nr("esri.geometry.Geometry")],Cd);const Ed=Cd;function Od(t,e){const i=t.x-e.x,n=t.y-e.y,s=t.hasZ&&e.hasZ?t.z-e.z:0;return Math.sqrt(i*i+n*n+s*s)}const Ld=57.29577951308232,Nd=.017453292519943;function Rd(t){return t*Ld}function Pd(t){return t*Nd}function Fd(t){return t/dl.radius}function Dd(t){return Math.PI/2-2*Math.atan(Math.exp(-t/dl.radius))}function $d(t){return null!=t.wkid||null!=t.wkt}const zd=[0,0];function Ud(t,e,i,n,s){const r=t,o=s;if(o.spatialReference=i,"x"in r&&"x"in o)[o.x,o.y]=e(r.x,r.y,zd,n);else if("xmin"in r&&"xmin"in o)[o.xmin,o.ymin]=e(r.xmin,r.ymin,zd,n),[o.xmax,o.ymax]=e(r.xmax,r.ymax,zd,n);else if("paths"in r&&"paths"in o||"rings"in r&&"rings"in o){const t="paths"in r?r.paths:r.rings,i=[];let s;for(let r=0;r<t.length;r++){const o=t[r];s=[],i.push(s);for(let t=0;t<o.length;t++)s.push(e(o[t][0],o[t][1],[0,0],n)),o[t].length>2&&s[t].push(o[t][2]),o[t].length>3&&s[t].push(o[t][3])}"paths"in o?o.paths=i:o.rings=i}else if("points"in r&&"points"in o){const t=r.points,i=[];for(let s=0;s<t.length;s++)i[s]=e(t[s][0],t[s][1],[0,0],n),t[s].length>2&&i[s].push(t[s][2]),t[s].length>3&&i[s].push(t[s][3]);o.points=i}return s}function Vd(t,e){const i=t&&($d(t)?t:t.spatialReference),n=e&&($d(e)?e:e.spatialReference);return!(t&&"type"in t&&"mesh"===t.type||e&&"type"in e&&"mesh"===e.type||!i||!n)&&(!!mh(n,i)||(_h(n)&&bh(i)||_h(i)&&bh(n)))}function Gd(t,e){if(null==t)return null;const i=t.spatialReference,n=e&&($d(e)?e:e.spatialReference);return Vd(i,n)?mh(i,n)?ht(t):_h(n)?Ud(t,Bd,jd.WebMercator,!1,ht(t)):bh(n)?Ud(t,qd,jd.WGS84,!1,ht(t)):null:null}function Bd(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const n=Pd(e);return i[0]=Pd(t)*dl.radius,i[1]=dl.halfSemiMajorAxis*Math.log((1+Math.sin(n))/(1-Math.sin(n))),i}function qd(t,e,i=[0,0],n=!1){const s=Rd(t/dl.radius);return i[0]=n?s:s-360*Math.floor((s+180)/360),i[1]=Rd(Math.PI/2-2*Math.atan(Math.exp(-e/dl.radius))),i}function Hd(t,e=!1,i=ht(t)){return Ud(t,Bd,jd.WebMercator,e,i)}function Wd(t,e=!1,i=ht(t)){return Ud(t,qd,jd.WGS84,e,i)}var Zd;const Jd=[0,0];function Kd(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}let Yd=Zd=class extends Ed{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Object.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,n,s){let r;if(Array.isArray(t))r=t,s=e,t=r[0],e=r[1],i=r[2],n=r[3];else if(t&&"object"==typeof t){if(r=t,t=null!=r.x?r.x:r.longitude,e=null!=r.y?r.y:r.latitude,i=r.z,n=r.m,(s=r.spatialReference)&&"esri.geometry.SpatialReference"!==s.declaredClass&&(s=new jd(s)),null!=r.longitude||null!=r.latitude)if(null==r.longitude)Ft.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(null==r.latitude)Ft.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!r.declaredClass&&s&&s.isWebMercator){const i=Bd(r.longitude,r.latitude,Jd);t=i[0],e=i[1]}}else Kd(i)?(s=i,i=null):Kd(n)&&(s=n,n=null);const o={x:t,y:e};return null==o.x&&null!=o.y?Ft.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):null==o.y&&null!=o.x&&Ft.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),null!=s&&(o.spatialReference=s),null!=i&&(o.z=i),null!=n&&(o.m=n),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return void 0!==this.m}set hasM(t){t!==(void 0!==this._get("m"))&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return void 0!==this.z}set hasZ(t){t!==(void 0!==this._get("z"))&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){const{spatialReference:t,x:e,y:i}=this;if(t){if(t.isWebMercator)return qd(e,i,Jd)[1];if(t.isGeographic)return i}return null}set latitude(t){const{spatialReference:e,x:i}=this;null!=t&&e&&(e.isWebMercator?this._set("y",Bd(i,t,Jd)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){const{x:t,y:e,spatialReference:i}=this;if(i){if(i.isWebMercator)return qd(t,e,Jd)[0];if(i.isGeographic)return t}return null}set longitude(t){const{y:e,spatialReference:i}=this;null!=t&&i&&(i.isWebMercator?this._set("x",Bd(t,e,Jd)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return"string"==typeof t?NaN:t}clone(){const t=new Zd;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return Zd.copy(t,this),this}equals(t){if(null==t)return!1;const{x:e,y:i,z:n,m:s,spatialReference:r}=this,{z:o,m:a}=t;let{x:l,y:u,spatialReference:c}=t;if(!r.equals(c))if(r.isWebMercator&&c.isWGS84)[l,u]=Bd(l,u),c=r;else{if(!r.isWGS84||!c.isWebMercator)return!1;[l,u]=qd(l,u),c=r}return e===l&&i===u&&n===o&&s===a&&r.wkid===c.wkid}offset(t,e,i){return this.x+=t,this.y+=e,null!=i&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=yh(this.spatialReference);if(!t)return this;let e=this.x;const[i,n]=t.valid,s=2*n;let r;return e>n?(r=Math.ceil(Math.abs(e-n)/s),e-=r*s):e<i&&(r=Math.ceil(Math.abs(e-i)/s),e+=r*s),this._set("x",e),this}distance(t){return Od(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};o([Us({readOnly:!0})],Yd.prototype,"cache",null),o([Us({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Yd.prototype,"hasM",null),o([Us({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Yd.prototype,"hasZ",null),o([Us({type:Number})],Yd.prototype,"latitude",null),o([Us({type:Number})],Yd.prototype,"longitude",null),o([Us({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),ol((t=>isNaN(t)?t:fs(t)))],Yd.prototype,"x",void 0),o([ll("x")],Yd.prototype,"writeX",null),o([al("x")],Yd.prototype,"readX",null),o([Us({type:Number,json:{write:!0}})],Yd.prototype,"y",void 0),o([Us({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Yd.prototype,"z",void 0),o([Us({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Yd.prototype,"m",void 0),Yd=Zd=o([Nr("esri.geometry.Point")],Yd),Yd.prototype.toJSON.isDefaultToJSON=!0;const Qd=Yd;let Xd=class extends(Gr(el)){constructor(...t){super(...t),this.position=new Qd([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new Hr}normalizeCtorArgs(t,e,i,n){if(t&&"object"==typeof t&&("x"in t||Array.isArray(t))){const s={position:t};return null!=e&&(s.heading=e),null!=i&&(s.tilt=i),null!=n&&(s.fov=n),s}return t}writePosition(t,e,i,n){const s=t.clone();s.x=fs(t.x||0),s.y=fs(t.y||0),s.z=t.hasZ?fs(t.z||0):t.z,e[i]=s.write({},n)}readPosition(t,e){const i=new Qd;return i.read(t,e),i.x=fs(i.x||0),i.y=fs(i.y||0),i.z=i.hasZ?fs(i.z||0):i.z,i}equals(t){return null!=t&&(this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)&&this.layout.equals(t.layout))}};o([Us({type:Qd,json:{write:{isRequired:!0}}})],Xd.prototype,"position",void 0),o([ll("position")],Xd.prototype,"writePosition",null),o([al("position")],Xd.prototype,"readPosition",null),o([Us({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),ol((t=>Pa.normalize(fs(t))))],Xd.prototype,"heading",void 0),o([Us({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),ol((t=>pa(fs(t),-180,180)))],Xd.prototype,"tilt",void 0),o([Us({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Xd.prototype,"fov",void 0),o([Us({type:Hr,nonNullable:!0,json:{read:!1,write:!1}})],Xd.prototype,"layout",void 0),Xd=o([Nr("esri.Camera")],Xd);const tf=Xd;const ef=[0,0];function nf(t,e){return null!=e&&lf(t,e.x,e.y,e.z)}function sf(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!of(t,i))return!1;return!0}function rf(t,e){const{xmin:i,ymin:n,zmin:s,xmax:r,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?lf(t,i,n,s)&&lf(t,i,o,s)&&lf(t,r,o,s)&&lf(t,r,n,s)&&lf(t,i,n,a)&&lf(t,i,o,a)&&lf(t,r,o,a)&&lf(t,r,n,a):lf(t,i,n)&&lf(t,i,o)&&lf(t,r,o)&&lf(t,r,n)}function of(t,e){return lf(t,e[0],e[1])}function af(t,e){return lf(t,e[0],e[1],e[2])}function lf(t,e,i,n){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(null==n||!t.hasZ||n>=t.zmin&&n<=t.zmax)}function uf(t,e){return ef[1]=e.y,ef[0]=e.x,cf(t,ef)}function cf(t,e){return hf(t.rings,e)}function hf(t,e){if(!t)return!1;if(df(t))return ff(!1,t,e);let i=!1;for(let n=0,s=t.length;n<s;n++)i=ff(i,t[n],e);return i}function df(t){return!Array.isArray(t[0][0])}function ff(t,e,i){const[n,s]=i;let r=t,o=0;for(let t=0,i=e.length;t<i;t++){o++,o===i&&(o=0);const[a,l]=e[t],[u,c]=e[o];(l<s&&c>=s||c<s&&l>=s)&&a+(s-l)/(c-l)*(u-a)<n&&(r=!r)}return r}function pf(t,e){return nf(t,e)}function mf(t,e){const i=t.hasZ&&e.hasZ;let n,s,r;if(t.xmin<=e.xmin){if(n=e.xmin,t.xmax<n)return!1}else if(n=t.xmin,e.xmax<n)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(i&&e.hasZ)if(t.zmin<=e.zmin){if(r=e.zmin,t.zmax<r)return!1}else if(r=t.zmin,e.zmax<r)return!1;return!0}function yf(t,e){const{points:i,hasZ:n}=e,s=n?af:of;for(const e of i)if(s(t,e))return!0;return!1}const gf=[0,0],vf=[0,0],wf=[0,0],bf=[0,0],Sf=[gf,vf,wf,bf],xf=[[wf,gf],[gf,vf],[vf,bf],[bf,wf]];function _f(t,e){return Mf(t,e.rings)}function Mf(t,e){gf[0]=t.xmin,gf[1]=t.ymax,vf[0]=t.xmax,vf[1]=t.ymax,wf[0]=t.xmin,wf[1]=t.ymin,bf[0]=t.xmax,bf[1]=t.ymin;for(const t of Sf)if(hf(e,t))return!0;for(const i of e){if(!i.length)continue;let e=i[0];if(of(t,e))return!0;for(let n=1;n<i.length;n++){const s=i[n];if(of(t,s)||If(e,s,xf))return!0;e=s}}return!1}function kf(t,e){gf[0]=t.xmin,gf[1]=t.ymax,vf[0]=t.xmax,vf[1]=t.ymax,wf[0]=t.xmin,wf[1]=t.ymin,bf[0]=t.xmax,bf[1]=t.ymin;const i=e.paths;for(const e of i){if(!i.length)continue;let n=e[0];if(of(t,n))return!0;for(let i=1;i<e.length;i++){const s=e[i];if(of(t,s)||If(n,s,xf))return!0;n=s}}return!1}const Tf=[0,0];function Af(t){for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<i.length-1;n++){const s=i[n],r=i[n+1];for(let i=e+1;i<t.length;i++)for(let e=0;e<t[i].length-1;e++){const n=t[i][e],o=t[i][e+1];if(jf(s,r,n,o,Tf)&&!(Tf[0]===s[0]&&Tf[1]===s[1]||Tf[0]===n[0]&&Tf[1]===n[1]||Tf[0]===r[0]&&Tf[1]===r[1]||Tf[0]===o[0]&&Tf[1]===o[1]))return!0}}const n=i.length;if(!(n<=4))for(let t=0;t<n-3;t++){let e=n-1;0===t&&(e=n-2);const s=i[t],r=i[t+1];for(let n=t+2;n<e;n++){const t=i[n],e=i[n+1];if(jf(s,r,t,e,Tf)&&!(Tf[0]===s[0]&&Tf[1]===s[1]||Tf[0]===t[0]&&Tf[1]===t[1]||Tf[0]===r[0]&&Tf[1]===r[1]||Tf[0]===e[0]&&Tf[1]===e[1]))return!0}}}return!1}function If(t,e,i){for(let n=0;n<i.length;n++)if(jf(t,e,i[n][0],i[n][1]))return!0;return!1}function jf(t,e,i,n,s){const[r,o]=t,[a,l]=e,[u,c]=i,[h,d]=n,f=h-u,p=r-u,m=a-r,y=d-c,g=o-c,v=l-o,w=y*m-f*v;if(0===w)return!1;const b=(f*g-y*p)/w,S=(m*g-v*p)/w;return b>=0&&b<=1&&S>=0&&S<=1&&(s&&(s[0]=r+b*(a-r),s[1]=o+b*(l-o)),!0)}function Cf(t){switch(t){case"esriGeometryEnvelope":case"extent":return mf;case"esriGeometryMultipoint":case"multipoint":return yf;case"esriGeometryPoint":case"point":return pf;case"esriGeometryPolygon":case"polygon":return _f;case"esriGeometryPolyline":case"polyline":return kf}}var Ef;function Of(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}function Lf(t,e,i){return null==e?i:null==i?e:t(e,i)}let Nf=Ef=class extends Ed{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,n,s){return Of(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:"object"==typeof t?(t.spatialReference=null==t.spatialReference?jd.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:n,spatialReference:s??jd.WGS84}}static fromBounds(t,e){return new Ef({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}static fromPoint(t){return new Ef({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new Qd({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return null!=this.mmin&&null!=this.mmax}get hasZ(){return null!=this.zmin&&null!=this.zmax}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return null!=t.z&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Ef;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,null!=this.zmin&&(t.zmin=this.zmin,t.zmax=this.zmax),null!=this.mmin&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Vd(e,i)&&(t=e.isWebMercator?Hd(t):Wd(t,!0)),"point"===t.type?nf(this,t):"extent"===t.type&&rf(this,t)}equals(t){if(this===t)return!0;if(null==t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Vd(e,i)&&(t=e.isWebMercator?Hd(t):Wd(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,n=this.height*e;if(this.xmin+=i,this.ymin+=n,this.xmax-=i,this.ymax-=n,this.hasZ){const t=(this.zmax-this.zmin)*e;this.zmin+=t,this.zmax-=t}if(this.hasM){const t=(this.mmax-this.mmin)*e;this.mmin+=t,this.mmax-=t}return this}intersects(t){if(null==t)return!1;"mesh"===t.type&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;e&&i&&!mh(e,i)&&Vd(e,i)&&(t=e.isWebMercator?Hd(t):Wd(t,!0));return Cf(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,null!=i&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Lf(Math.min,this.zmin,t.zmin),this.zmax=Lf(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Lf(Math.min,this.mmin,t.mmin),this.mmax=Lf(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:null!=t&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Lf(Math.max,this.zmin,t.zmin),this.zmax=Lf(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Lf(Math.max,this.mmin,t.mmin),this.mmax=Lf(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=yh(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const n=e.isWebMercator?Wd(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(n.x=this._normalizeX(n.x,t).x),this.spatialReference=new jd(Et((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:n.x}))}return this}_getCM(t){let e=null;const[i,n]=t.valid,s=this.xmin,r=this.xmax;return s>=i&&s<=n&&(r>=i&&r<=n)||(e=this.center),e}_normalize(t,e,i){const n=this.spatialReference;if(!n)return this;const s=i??yh(n);if(null==s)return this;const r=this._getParts(s).map((t=>t.extent));if(r.length<2)return r[0]||this;if(r.length>2)return t?this._shiftCM(s):this.set({xmin:s.valid[0],xmax:s.valid[1]});if(t)return this._shiftCM(s);if(e)return r;let o=!0,a=!0;return r.forEach((t=>{t.hasZ||(o=!1),t.hasM||(a=!1)})),{rings:r.map((t=>{const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(o){const i=(t.zmax-t.zmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}if(a){const i=(t.mmax-t.mmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}return e})),hasZ:o,hasM:a,spatialReference:n}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:n,spatialReference:s}=this,r=this.width,o=this.xmin,a=this.xmax;let l;t=t||yh(s);const[u,c]=t.valid;l=this._normalizeX(this.xmin,t);const h=l.x,d=l.frameId;l=this._normalizeX(this.xmax,t);const f=l.x,p=l.frameId,m=h===f&&r>0;if(r>2*c){const t=new Ef(o<a?h:f,i,c,n,s),r=new Ef(u,i,o<a?f:h,n,s),l=new Ef(0,i,c,n,s),m=new Ef(u,i,0,n,s),y=[],g=[];t.contains(l)&&y.push(d),t.contains(m)&&g.push(d),r.contains(l)&&y.push(p),r.contains(m)&&g.push(p);for(let t=d+1;t<p;t++)y.push(t),g.push(t);e.push({extent:t,frameIds:[d]},{extent:r,frameIds:[p]},{extent:l,frameIds:y},{extent:m,frameIds:g})}else h>f||m?e.push({extent:new Ef(h,i,c,n,s),frameIds:[d]},{extent:new Ef(u,i,f,n,s),frameIds:[p]}):e.push({extent:new Ef(h,i,f,n,s),frameIds:[d]});this.cache._parts=e}const i=this.hasZ,n=this.hasM;if(i||n){const t={};i&&(t.zmin=this.zmin,t.zmax=this.zmax),n&&(t.mmin=this.mmin,t.mmax=this.mmax);for(let i=0;i<e.length;i++)e[i].extent.set(t)}return e}_normalizeX(t,e){const[i,n]=e.valid,s=2*n;let r,o=0;return t>n?(r=Math.ceil(Math.abs(t-n)/s),t-=r*s,o=r):t<i&&(r=Math.ceil(Math.abs(t-i)/s),t+=r*s,o=-r),{x:t,frameId:o}}};o([Us({readOnly:!0})],Nf.prototype,"cache",null),o([Us({readOnly:!0})],Nf.prototype,"center",null),o([Us({readOnly:!0})],Nf.prototype,"extent",null),o([Us({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Nf.prototype,"hasM",null),o([Us({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Nf.prototype,"hasZ",null),o([Us({readOnly:!0})],Nf.prototype,"height",null),o([Us({readOnly:!0})],Nf.prototype,"width",null),o([Us({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Nf.prototype,"xmin",void 0),o([Us({type:Number,json:{write:!0}})],Nf.prototype,"ymin",void 0),o([Us({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Nf.prototype,"mmin",void 0),o([Us({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Nf.prototype,"zmin",void 0),o([Us({type:Number,json:{write:!0}})],Nf.prototype,"xmax",void 0),o([Us({type:Number,json:{write:!0}})],Nf.prototype,"ymax",void 0),o([Us({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Nf.prototype,"mmax",void 0),o([Us({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Nf.prototype,"zmax",void 0),Nf=Ef=o([Nr("esri.geometry.Extent")],Nf),Nf.prototype.toJSON.isDefaultToJSON=!0;const Rf=Nf;function Pf(t,e,i=!1){let{hasM:n,hasZ:s}=t;Array.isArray(e)?4!==e.length||n||s?3===e.length&&i&&!n?(s=!0,n=!1):3===e.length&&n&&s&&(n=!1,s=!1):(n=!0,s=!0):(s=!s&&e.hasZ&&(!n||e.hasM),n=!n&&e.hasM&&(!s||e.hasZ)),t.hasZ=s,t.hasM=n}var Ff;function Df(t){return(e,i)=>null==e?i:null==i?e:t(e,i)}function $f(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}let zf=Ff=class extends Ed{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){if(!t&&!e)return{};const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):$f(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const n=i.points?.[0];return n&&(void 0===i.hasZ&&void 0===i.hasM?(i.hasZ=n.length>2,i.hasM=!1):void 0===i.hasZ?i.hasZ=n.length>3:void 0===i.hasM&&(i.hasM=n.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new Rf,i=this.hasZ,n=this.hasM,s=i?3:2,r=t[0],o=Df(Math.min),a=Df(Math.max);let l,u,c,h,[d,f]=r,[p,m]=r;for(let e=0,r=t.length;e<r;e++){const r=t[e],[y,g]=r;if(d=o(d,y),f=o(f,g),p=a(p,y),m=a(m,g),i&&r.length>2){const t=r[2];l=o(l,t),c=a(c,t)}if(n&&r.length>s){const t=r[s];u=o(u,t),h=a(h,t)}}return e.xmin=d,e.ymin=f,e.xmax=p,e.ymax=m,e.spatialReference=this.spatialReference,i?(e.zmin=l,e.zmax=c):(e.zmin=void 0,e.zmax=void 0),n?(e.mmin=u,e.mmax=h):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=ht(this.points)}addPoint(t){return Pf(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:ht(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new Ff(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let n=2;return this.hasZ&&(i.z=e[2],n=3),this.hasM&&(i.m=e[n]),new Qd(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new Qd(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(Pf(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return null!=t&&t>=0&&t<this.points.length}};o([Us({readOnly:!0})],zf.prototype,"cache",null),o([Us()],zf.prototype,"extent",null),o([Us({type:[[Number]],json:{write:{isRequired:!0}}})],zf.prototype,"points",void 0),o([ll("points")],zf.prototype,"writePoints",null),zf=Ff=o([Nr("esri.geometry.Multipoint")],zf),zf.prototype.toJSON.isDefaultToJSON=!0;const Uf=zf;function Vf(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function Gf(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}var Bf;!function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"}(Bf||(Bf={}));function qf(t,e){const i=e[0]-t[0],n=e[1]-t[1];if(t.length>2&&e.length>2){const s=t[2]-e[2];return Math.sqrt(i*i+n*n+s*s)}return Math.sqrt(i*i+n*n)}function Hf(t,e,i){const n=t[0]+i*(e[0]-t[0]),s=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[n,s,t[2]+i*(e[2]-t[2])]:[n,s]}function Wf(t,e,i,n){return Zf(t,e,i[n],i[n+1])}function Zf(t,e,i,n){const[s,r]=e,[o,a]=i,[l,u]=n,c=l-o,h=u-a,d=c*c+h*h,f=(s-o)*c+(r-a)*h,p=Math.min(1,Math.max(0,f/d));return t[0]=o+c*p,t[1]=a+h*p,t}function Jf(t,e,i,n,s,r){let o=i,a=n,l=s-o,u=r-a;if(0!==l||0!==u){const i=((t-o)*l+(e-a)*u)/(l*l+u*u);i>1?(o=s,a=r):i>0&&(o+=l*i,a+=u*i)}return l=t-o,u=e-a,l*l+u*u}function Kf(t,e){return Hf(t,e,.5)}function Yf(t,e=Bf.X,i=Bf.Y){let n=0;const s=t.length;let r=t[0];for(let o=0;o<s-1;o++){const s=t[o+1];n+=(s[e]-r[e])*(s[i]+r[i]),r=s}return n>=0}function Qf(t){const e=t.length;return e>2&&_(t[0],t[e-1])}function Xf(t){if("rings"in t&&(tp(t),t.rings.length>0&&!Yf(t.rings[0])))for(const e of t.rings)e.reverse()}function tp(t){if("rings"in t)for(const e of t.rings)Qf(e)||e.push(e[0].slice())}function ep(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function ip(t){return t?np(t.rings,t.hasZ??!1):null}function np(t,e){if(!t?.length)return null;const i=[],n=[],s=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let i=0,r=t.length;i<r;i++){const r=sp(t[i],e,s);r&&n.push(r)}if(n.sort(((t,i)=>{let n=t[2]-i[2];return 0===n&&e&&(n=t[4]-i[4]),n})),n.length&&(i[0]=n[0][0],i[1]=n[0][1],e&&(i[2]=n[0][3]),(i[0]<s[0]||i[0]>s[1]||i[1]<s[2]||i[1]>s[3]||e&&(i[2]<s[4]||i[2]>s[5]))&&(i.length=0)),!i.length){const n=t[0]&&t[0].length?op(t[0],e):null;if(!n)return null;i[0]=n[0],i[1]=n[1],e&&n.length>2&&(i[2]=n[2])}return i}function sp(t,e,i){let n=0,s=0,r=0,o=0,a=0;const l=t.length?t[0][0]:0,u=t.length?t[0][1]:0,c=t.length&&e?t[0][2]:0;for(let h=0;h<t.length;h++){const d=t[h],f=t[(h+1)%t.length],[p,m,y]=d,g=p-l,v=m-u,[w,b,S]=f,x=w-l,_=b-u,M=g*_-x*v;if(o+=M,n+=(g+x)*M,s+=(v+_)*M,e&&d.length>2&&f.length>2){const t=y-c,e=S-c,i=g*e-x*t;r+=(t+e)*i,a+=i}p<i[0]&&(i[0]=p),p>i[1]&&(i[1]=p),m<i[2]&&(i[2]=m),m>i[3]&&(i[3]=m),e&&(y<i[4]&&(i[4]=y),y>i[5]&&(i[5]=y))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[n/(6*o)+l,s/(6*o)+u,o];return e&&(i[4]===i[5]||0===a?(h[3]=(i[4]+i[5])/2,h[4]=0):(h[3]=r/(6*a)+c,h[4]=a)),h}function rp(t,e){let i=0,n=0,s=0;t.nextPoint();const r=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const u=[t.x,t.y],[c,h]=l,d=c-r,f=h-o,[p,m]=u,y=p-r,g=m-o,v=d*g-y*f;s+=v,i+=(d+y)*v,n+=(f+g)*v,c<e[0]&&(e[0]=c),c>e[1]&&(e[1]=c),h<e[2]&&(e[2]=h),h>e[3]&&(e[3]=h)}if(s>0&&(s*=-1),!s)return null;s*=.5;return[i/(6*s)+r,n/(6*s)+o,s]}function op(t,e){const i=e?[0,0,0]:[0,0],n=e?[0,0,0]:[0,0];let s=0,r=0,o=0,a=0;for(let l=0,u=t.length;l<u-1;l++){const u=t[l],c=t[l+1];if(u&&c){i[0]=u[0],i[1]=u[1],n[0]=c[0],n[1]=c[1],e&&u.length>2&&c.length>2&&(i[2]=u[2],n[2]=c[2]);const t=qf(i,n);if(t){s+=t;const i=Kf(u,c);r+=t*i[0],o+=t*i[1],e&&i.length>2&&(a+=t*i[2])}}}return s>0?e?[r/s,o/s,a/s]:[r/s,o/s]:t.length?t[0]:null}function ap(t){const{hasZ:e,totalSize:i}=t;if(0===i)return null;const n=[],s=[],r=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const e=sp(Gf(t),t.hasZ,r);e&&s.push(e)}if(s.sort(((t,i)=>{let n=t[2]-i[2];return 0===n&&e&&(n=t[4]-i[4]),n})),s.length&&(n[0]=s[0][0],n[1]=s[0][1],e&&(n[2]=s[0][3]),(n[0]<r[0]||n[0]>r[1]||n[1]<r[2]||n[1]>r[3]||e&&(n[2]<r[4]||n[2]>r[5]))&&(n.length=0)),!n.length){t.reset(),t.nextPath();const i=t.pathSize?lp(t):null;if(!i)return null;n[0]=i[0],n[1]=i[1],e&&i.length>2&&(n[2]=i[2])}return n}function lp(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],n=e?[0,0,0]:[0,0];let s=0,r=0,o=0,a=0;if(t.nextPoint()){let l=t.x,u=t.y,c=t.z;for(;t.nextPoint();){const h=t.x,d=t.y,f=t.z;i[0]=l,i[1]=u,n[0]=h,n[1]=d,e&&(i[2]=c,n[2]=f);const p=qf(i,n);if(p){s+=p;const t=Kf(i,n);r+=p*t[0],o+=p*t[1],e&&t.length>2&&(a+=p*t[2])}l=h,u=d,c=f}}return s>0?e?[r/s,o/s,a/s]:[r/s,o/s]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const up=1e-6;function cp(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<up){const e=ap(t);return e?[e[0],e[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const n=[t.x,t.y];for(t.reset();t.nextPath();)dp(i,n,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=n[0],i[1]+=n[1],i}const hp=1/3;function dp(t,e,i){if(!t||!i||i.pathSize<3)return null;i.nextPoint();const n=i.x,s=i.y;i.nextPoint();let r,o=i.x-n,a=i.y-s,l=0,u=0;for(;i.nextPoint();)l=i.x-n,u=i.y-s,r=.5*hp*(l*a-u*o),t[0]+=r*(o+l),t[1]+=r*(a+u),o=l,a=u;const c=i.getCurrentRingArea(),h=[n,s];return h[0]-=e[0],h[1]-=e[1],h[0]*=c,h[1]*=c,t[0]+=h[0],t[1]+=h[1],t}function fp(t){return t}function pp(t=Lp){return fp([t[0],t[1],t[2],t[3]])}function mp(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function yp(t,e,i,n,s=pp()){return s[0]=t,s[1]=e,s[2]=i,s[3]=n,s}function gp(t,e=pp()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function vp(t,e){return new Rf({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function wp(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function bp(t,e,i){if(null!=e)if("length"in e)Cp(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):2!==e.length&&3!==e.length||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else mp(i,t)}function Sp(t){return null==t||t[0]>=t[2]?0:t[2]-t[0]}function xp(t){return null==t||t[1]>=t[3]?0:t[3]-t[1]}function _p(t){return Sp(t)*xp(t)}function Mp(t,e){return kp(t,e[0],e[1])}function kp(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function Tp(t,e,i){return e[0]>=t[0]-i&&e[1]>=t[1]-i&&e[0]<=t[2]+i&&e[1]<=t[3]+i}function Ap(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function Ip(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function jp(t){return t?mp(t,Op):pp(Op)}function Cp(t){return null!=t&&4===t.length}function Ep(t,e){return Cp(t)&&Cp(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const Op=fp([1/0,1/0,-1/0,-1/0]),Lp=fp([0,0,0,0]);function Np(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function Rp(t){return void 0!==t.points}function Pp(t){return void 0!==t.x&&void 0!==t.y}function Fp(t){return void 0!==t.paths}function Dp(t){return void 0!==t.rings}function $p(t){function e(e,i){return null==e?i:null==i?e:t(e,i)}return e}const zp=$p(Math.min),Up=$p(Math.max);function Vp(t,e){return Fp(e)?Hp(t,e.paths,!1,!1):Dp(e)?Hp(t,e.rings,!1,!1):Rp(e)?Zp(t,e.points,!1,!1,!1,!1):Np(e)?Wp(t,e):(Pp(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Gp(t){let e,i,n,s;for(t.reset(),e=n=1/0,i=s=-1/0;t.nextPath();){const r=Bp(t);e=Math.min(r[0],e),n=Math.min(r[1],n),i=Math.max(r[2],i),s=Math.max(r[3],s)}return pp([e,n,i,s])}function Bp(t){let e,i,n,s;for(e=n=1/0,i=s=-1/0;t.nextPoint();)e=Math.min(t.x,e),n=Math.min(t.y,n),i=Math.max(t.x,i),s=Math.max(t.y,s);return pp([e,n,i,s])}function qp(t,e){return Fp(e)?Hp(t,e.paths,!0,!1):Dp(e)?Hp(t,e.rings,!0,!1):Rp(e)?Zp(t,e.points,!0,!1,!0,!1):Np(e)?Wp(t,e,!0,!1,!0,!1):(Pp(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function Hp(t,e,i,n){const s=i?3:2;if(!e.length||!e[0].length)return null;let r,o,a,l,[u,c]=e[0][0],[h,d]=e[0][0];for(let t=0;t<e.length;t++){const f=e[t];for(let t=0;t<f.length;t++){const e=f[t],[p,m]=e;if(u=zp(u,p),c=zp(c,m),h=Up(h,p),d=Up(d,m),i&&e.length>2){const t=e[2];r=zp(r,t),o=Up(o,t)}if(n&&e.length>s){const t=e[s];a=zp(r,t),l=Up(o,t)}}}return i?n?(t[0]=u,t[1]=c,t[2]=r,t[3]=a,t[4]=h,t[5]=d,t[6]=o,t[7]=l,t.length=8,t):(t[0]=u,t[1]=c,t[2]=r,t[3]=h,t[4]=d,t[5]=o,t.length=6,t):n?(t[0]=u,t[1]=c,t[2]=a,t[3]=h,t[4]=d,t[5]=l,t.length=6,t):(t[0]=u,t[1]=c,t[2]=h,t[3]=d,t.length=4,t)}function Wp(t,e,i,n,s,r){const o=e.xmin,a=e.xmax,l=e.ymin,u=e.ymax;let c=e.zmin,h=e.zmax,d=e.mmin,f=e.mmax;return s?(c=c||0,h=h||0,r?(d=d||0,f=f||0,t[0]=o,t[1]=l,t[2]=c,t[3]=d,t[4]=a,t[5]=u,t[6]=h,t[7]=f,t):(t[0]=o,t[1]=l,t[2]=c,t[3]=a,t[4]=u,t[5]=h,t)):r?(d=d||0,f=f||0,t[0]=o,t[1]=l,t[2]=d,t[3]=a,t[4]=u,t[5]=f,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=u,t)}function Zp(t,e,i,n,s,r){const o=i?3:2,a=n&&r,l=i&&s;if(!e.length||!e[0].length)return null;let u,c,h,d,[f,p]=e[0],[m,y]=e[0];for(let t=0;t<e.length;t++){const i=e[t],[n,s]=i;if(f=zp(f,n),p=zp(p,s),m=Up(m,n),y=Up(y,s),l&&i.length>2){const t=i[2];u=zp(u,t),c=Up(c,t)}if(a&&i.length>o){const t=i[o];h=zp(u,t),d=Up(c,t)}}return s?(u=u||0,c=c||0,r?(h=h||0,d=d||0,t[0]=f,t[1]=p,t[2]=u,t[3]=h,t[4]=m,t[5]=y,t[6]=c,t[7]=d,t):(t[0]=f,t[1]=p,t[2]=u,t[3]=m,t[4]=y,t[5]=c,t)):r?(h=h||0,d=d||0,t[0]=f,t[1]=p,t[2]=h,t[3]=m,t[4]=y,t[5]=d,t):(t[0]=f,t[1]=p,t[2]=m,t[3]=y,t)}function Jp(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function Kp(t){return void 0!==t.points}function Yp(t){return void 0!==t.x&&void 0!==t.y}function Qp(t){return void 0!==t.paths}function Xp(t){return void 0!==t.rings}const tm=[];function em(t,e,i,n){return{xmin:t,ymin:e,xmax:i,ymax:n}}function im(t,e,i,n,s,r){return{xmin:t,ymin:e,zmin:i,xmax:n,ymax:s,zmax:r}}function nm(t,e,i,n,s,r){return{xmin:t,ymin:e,mmin:i,xmax:n,ymax:s,mmax:r}}function sm(t,e,i,n,s,r,o,a){return{xmin:t,ymin:e,zmin:i,mmin:n,xmax:s,ymax:r,zmax:o,mmax:a}}function rm(t,e=!1,i=!1){return e?i?sm(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):im(t[0],t[1],t[2],t[3],t[4],t[5]):i?nm(t[0],t[1],t[2],t[3],t[4],t[5]):em(t[0],t[1],t[2],t[3])}function om(t){return t?Jp(t)?t:Yp(t)?lm(t):Xp(t)?um(t):Qp(t)?cm(t):Kp(t)?am(t):null:null}function am(t){const{hasZ:e,hasM:i,points:n}=t;return rm(Zp(tm,n,e??!1,i??!1),e,i)}function lm(t){const{x:e,y:i,z:n,m:s}=t,r=null!=s;return null!=n?r?sm(e,i,n,s,e,i,n,s):im(e,i,n,e,i,n):r?nm(e,i,s,e,i,s):em(e,i,e,i)}function um(t){const{hasZ:e,hasM:i,rings:n}=t,s=Hp(tm,n,e??!1,i??!1);return s?rm(s,e,i):null}function cm(t){const{hasZ:e,hasM:i,paths:n}=t,s=Hp(tm,n,e??!1,i??!1);return s?rm(s,e,i):null}var hm;function dm(t){return!Array.isArray(t[0])}let fm=hm=class extends Ed{static fromExtent(t){const e=t.clone().normalize(),i=t.spatialReference;let n=!1,s=!1;for(const t of e)t.hasZ&&(n=!0),t.hasM&&(s=!0);const r={rings:e.map((t=>{const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(n&&t.hasZ){const i=t.zmin+.5*(t.zmax-t.zmin);for(let t=0;t<e.length;t++)e[t].push(i)}if(s&&t.hasM){const i=t.mmin+.5*(t.mmax-t.mmin);for(let t=0;t<e.length;t++)e[t].push(i)}return e})),spatialReference:i};return n&&(r.hasZ=!0),s&&(r.hasM=!0),new hm(r)}constructor(...t){super(...t),this.rings=[],this.type="polygon"}normalizeCtorArgs(t,e){let i,n,s=null,r=null;return t&&!Array.isArray(t)?(s=t.rings??null,e||(t.spatialReference?e=t.spatialReference:t.rings||(e=t)),i=t.hasZ,n=t.hasM):s=t,s=s||[],e=e||jd.WGS84,s.length&&null!=s[0]?.[0]&&"number"==typeof s[0][0]&&(s=[s]),r=s[0]?.[0],r&&(void 0===i&&void 0===n?(i=r.length>2,n=r.length>3):void 0===i?i=n?r.length>3:r.length>2:void 0===n&&(n=i?r.length>3:r.length>2)),{rings:s,spatialReference:e,hasZ:i,hasM:n}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const t=ip(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new Qd;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=um(this);if(!e)return null;const i=new Rf(e);return i.spatialReference=t,i}get isSelfIntersecting(){return Af(this.rings)}writeRings(t,e){e.rings=ht(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(dm(t)){const n=[];for(let e=0,i=t.length;e<i;e++)n[e]=t[e].toArray();e[i]=n}else e[i]=t.concat();return this.notifyChange("rings"),this}clone(){const t=new hm;return t.spatialReference=this.spatialReference,t.rings=ht(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(null==t)return!1;const e=this.spatialReference,i=t.spatialReference;if(null!=e!=(null!=i))return!1;if(null!=e&&null!=i&&!e.equals(i))return!1;if(this.rings.length!==t.rings.length)return!1;const n=([t,e,i,n],[s,r,o,a])=>t===s&&e===r&&(null==i&&null==o||i===o)&&(null==n&&null==a||n===a);for(let e=0;e<this.rings.length;e++){const i=this.rings[e],s=t.rings[e];if(!_(i,s,n))return!1}return!0}contains(t){if(!t)return!1;const e=Gd(t,this.spatialReference);return uf(this,null!=e?e:t)}isClockwise(t){let e;return e=dm(t)?t.map((t=>this.hasZ?this.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])):t,Yf(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],n=this.hasZ,s=this.hasM;return n&&!s?new Qd(i[0],i[1],i[2],void 0,this.spatialReference):s&&!n?new Qd(i[0],i[1],void 0,i[2],this.spatialReference):n&&s?new Qd(i[0],i[1],i[2],i[3],this.spatialReference):new Qd(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(Pf(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new Qd(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,n=e.map((t=>new Qd(t,i)));return this.notifyChange("rings"),n}setPoint(t,e,i){return this._validateInputs(t,e)?(Pf(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.rings.length)return!1;if(null!=e){const n=this.rings[t];if(i&&(e<0||e>n.length))return!1;if(!i&&(e<0||e>=n.length))return!1}return!0}toJSON(t){return this.write({},t)}};o([Us({readOnly:!0})],fm.prototype,"cache",null),o([Us({readOnly:!0})],fm.prototype,"centroid",null),o([Us({readOnly:!0})],fm.prototype,"extent",null),o([Us({readOnly:!0})],fm.prototype,"isSelfIntersecting",null),o([Us({type:[[[Number]]],json:{write:{isRequired:!0}}})],fm.prototype,"rings",void 0),o([ll("rings")],fm.prototype,"writeRings",null),fm=hm=o([Nr("esri.geometry.Polygon")],fm),fm.prototype.toJSON.isDefaultToJSON=!0;const pm=fm;var mm;function ym(t){return!Array.isArray(t[0])}let gm=mm=class extends Ed{constructor(...t){super(...t),this.paths=[],this.type="polyline"}normalizeCtorArgs(t,e){let i,n,s=null,r=null;return t&&!Array.isArray(t)?(s=t.paths??null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),i=t.hasZ,n=t.hasM):s=t,s=s||[],e=e||jd.WGS84,s.length&&null!=s[0]?.[0]&&"number"==typeof s[0][0]&&(s=[s]),r=s[0]?.[0],r&&(void 0===i&&void 0===n?(i=r.length>2,n=!1):void 0===i?i=!n&&r.length>3:void 0===n&&(n=!i&&r.length>3)),{paths:s,spatialReference:e,hasZ:i,hasM:n}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=cm(this);if(!e)return null;const i=new Rf(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=ht(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(ym(t)){const n=[];for(let e=0,i=t.length;e<i;e++)n[e]=t[e].toArray();e[i]=n}else e[i]=t.concat();return this.notifyChange("paths"),this}clone(){const t=new mm;return t.spatialReference=this.spatialReference,t.paths=ht(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],n=this.hasZ,s=this.hasM;return n&&!s?new Qd(i[0],i[1],i[2],void 0,this.spatialReference):s&&!n?new Qd(i[0],i[1],void 0,i[2],this.spatialReference):n&&s?new Qd(i[0],i[1],i[2],i[3],this.spatialReference):new Qd(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(Pf(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,n=e.map((t=>new Qd(t,i)));return this.notifyChange("paths"),n}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new Qd(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(Pf(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.paths.length)return!1;if(null!=e){const n=this.paths[t];if(i&&(e<0||e>n.length))return!1;if(!i&&(e<0||e>=n.length))return!1}return!0}toJSON(t){return this.write({},t)}};o([Us({readOnly:!0})],gm.prototype,"cache",null),o([Us({readOnly:!0})],gm.prototype,"extent",null),o([Us({type:[[[Number]]],json:{write:{isRequired:!0}}})],gm.prototype,"paths",void 0),o([ll("paths")],gm.prototype,"writePaths",null),gm=mm=o([Nr("esri.geometry.Polyline")],gm),gm.prototype.toJSON.isDefaultToJSON=!0;const vm=gm;const wm=cl()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),bm=cl()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function Sm(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function xm(t){return void 0!==t.points}function _m(t){return void 0!==t.x&&void 0!==t.y}function Mm(t){return void 0!==t.paths}function km(t){return void 0!==t.rings}function Tm(t){return null==t?null:t instanceof Ed?t:_m(t)?Qd.fromJSON(t):Mm(t)?vm.fromJSON(t):km(t)?pm.fromJSON(t):xm(t)?Uf.fromJSON(t):Sm(t)?Rf.fromJSON(t):null}function Am(t){return t?_m(t)?"esriGeometryPoint":Mm(t)?"esriGeometryPolyline":km(t)?"esriGeometryPolygon":Sm(t)?"esriGeometryEnvelope":xm(t)?"esriGeometryMultipoint":null:null}const Im={esriGeometryPoint:Qd,esriGeometryPolyline:vm,esriGeometryPolygon:pm,esriGeometryEnvelope:Rf,esriGeometryMultipoint:Uf};function jm(t){return t&&Im[t]||null}const Cm={base:Ed,key:"type",typeMap:{extent:Rf,multipoint:Uf,point:Qd,polyline:vm,polygon:pm}};Ls(Cm);var Em;let Om=Em=class extends el{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new Em({rotation:this.rotation,scale:this.scale,targetGeometry:null!=this.targetGeometry?this.targetGeometry.clone():null,camera:null!=this.camera?this.camera.clone():null})}};function Lm(){return{enabled:!this.camera}}o([Us({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Lm}}}}})],Om.prototype,"rotation",void 0),o([ol("rotation")],Om.prototype,"castRotation",null),o([Us({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Lm}}}}})],Om.prototype,"scale",void 0),o([Us({types:Cm,json:{read:Tm,write:!0,origins:{"web-scene":{read:Tm,write:{overridePolicy:Lm}}}}})],Om.prototype,"targetGeometry",void 0),o([Us({type:tf,json:{write:!0}})],Om.prototype,"camera",void 0),Om=Em=o([Nr("esri.Viewpoint")],Om);const Nm=Om;class Rm{constructor(){this._emitter=new Rm.EventEmitter(this)}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(t){class e{constructor(t=null){this._target=t,this._listenersMap=null}clear(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clear()}emit(t,e){let i=this._listenersMap?.get(t);if(!i)return!1;const n=this._target||this;let s=!1;for(const t of i.slice()){const i="deref"in t?t.deref():t;i?i?.call(n,e):s=!0}return s&&(i=i.filter((t=>!("deref"in t)||null!=t.deref())),this._listenersMap.set(t,i)),i.length>0}on(t,e){if(Array.isArray(t)){const i=t.map((t=>this.on(t,e)));return Kt(i)}if(t.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const i=this._listenersMap.get(t)||[];return i.push(e),this._listenersMap.set(t,i),Zt((()=>{const i=this._listenersMap?.get(t),n=i?.indexOf(e)??-1;n>=0&&i.splice(n,1)}))}once(t,e){const i=this.on(t,(t=>{i.remove();const n="deref"in e?e.deref():e;n?.call(null,t)}));return i}hasEventListener(t){const e=this._listenersMap?.get(t);return null!=e&&e.length>0}}t.EventEmitter=e,t.EventedMixin=t=>{let i=class extends t{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return i=o([Nr("esri.core.Evented")],i),i};let i=class extends Vr{constructor(){super(...arguments),this._emitter=new Rm.EventEmitter(this)}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};i=o([Nr("esri.core.Evented")],i),t.EventedAccessor=i}(Rm||(Rm={}));const Pm=Rm;var Fm;!function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"}(Fm||(Fm={}));function Dm(t){return(e,i)=>{e[i]=t}}class $m extends be{notify(){const t=this._observers;if(t&&t.length>0){const e=t.slice();for(const t of e)t.onInvalidated(),t.onCommitted()}}}var zm;class Um{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}}class Vm{constructor(t,e,i,n,s){this.target=t,this.added=e,this.removed=i,this.start=n,this.deleteCount=s}}const Gm=new ve(Um,void 0,(t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1}));function Bm(t){return t?t instanceof Xm?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function qm(t){if(t?.length)return t[0]}function Hm(t,e,i,n){const s=Math.min(t.length-i,e.length-n);let r=0;for(;r<s&&t[i+r]===e[n+r];)r++;return r}function Wm(t,e,i,n){e&&e.forEach(((e,s,r)=>{t.push(e),Wm(t,i.call(n,e,s,r),i,n)}))}const Zm=new Set,Jm=new Set,Km=new Set,Ym=new Map;let Qm=0,Xm=zm=class extends Pm.EventedAccessor{static isCollection(t){return null!=t&&t instanceof zm}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new $m,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Qm++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof zm?{items:t}:t:{}}destroy(){this._removeAllRaw()}*[Symbol.iterator](){yield*this.items}get items(){return Ee(this._observable),this._items}set items(t){this._emitBeforeChanges(Fm.ADD)||(this._splice(0,this.length,Bm(t)),this._emitAfterChanges(Fm.ADD))}hasEventListener(t){return"change"===t?this._chgListeners.length>0:this._emitter.hasEventListener(t)}on(t,e){if("change"===t){const t=this._chgListeners,i={removed:!1,callback:e};return t.push(i),this._notifications&&this._notifications.push({listeners:t.slice(),items:this._items.slice(),changes:[]}),Zt((()=>{i.removed=!0,t.splice(t.indexOf(i),1)}))}return this._emitter.on(t,e)}once(t,e){const i="deref"in e?()=>e.deref():()=>e,n=this.on(t,(t=>{i()?.call(null,t),n.remove()}));return n}add(t,e){if(Ee(this._observable),this._emitBeforeChanges(Fm.ADD))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(Fm.ADD),this}addMany(t,e=this._items.length){if(Ee(this._observable),!t?.length)return this;if(this._emitBeforeChanges(Fm.ADD))return this;const i=this.getNextIndex(e);return this._splice(i,0,Bm(t)),this._emitAfterChanges(Fm.ADD),this}at(t){if(Ee(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(Ee(this._observable),!this.length||this._emitBeforeChanges(Fm.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(Fm.REMOVE),t}_removeAllRaw(){return 0===this.length?[]:this._splice(0,this.length)||[]}clone(){return Ee(this._observable),this._createNewInstance({items:this._items.map(ht)})}concat(...t){Ee(this._observable);const e=t.map(Bm);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(Ee(this._observable),!this.length||this._emitBeforeChanges(Fm.REMOVE))return;const i=this._splice(0,this.length),n=i.length;for(let s=0;s<n;s++)t.call(e,i[s],s,i);this._emitAfterChanges(Fm.REMOVE)}every(t,e){return Ee(this._observable),this._items.every(t,e)}filter(t,e){let i;return Ee(this._observable),i=2===arguments.length?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return Ee(this._observable),this._items.find(t,e)}findIndex(t,e){return Ee(this._observable),this._items.findIndex(t,e)}flatten(t,e){Ee(this._observable);const i=[];return Wm(i,this,t,e),new zm(i)}forEach(t,e){return Ee(this._observable),this._items.forEach(t,e)}getItemAt(t){return Ee(this._observable),this._items[t]}getNextIndex(t){Ee(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return Ee(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return Ee(this._observable),this._items.indexOf(t,e)}join(t=","){return Ee(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return Ee(this._observable),this._items.lastIndexOf(t,e)}map(t,e){Ee(this._observable);const i=this._items.map(t,e);return new zm({items:i})}reorder(t,e=this.length-1){Ee(this._observable);const i=this.indexOf(t);if(-1!==i){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(Fm.MOVE))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(Fm.MOVE)}return t}}pop(){if(Ee(this._observable),!this.length||this._emitBeforeChanges(Fm.REMOVE))return;const t=qm(this._splice(this.length-1,1));return this._emitAfterChanges(Fm.REMOVE),t}push(...t){return Ee(this._observable),this._emitBeforeChanges(Fm.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(Fm.ADD)),this.length}reduce(t,e){Ee(this._observable);const i=this._items;return 2===arguments.length?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){Ee(this._observable);const i=this._items;return 2===arguments.length?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return Ee(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(Ee(this._observable),t<0||t>=this.length||this._emitBeforeChanges(Fm.REMOVE))return;const e=qm(this._splice(t,1));return this._emitAfterChanges(Fm.REMOVE),e}removeMany(t){if(Ee(this._observable),!t?.length||this._emitBeforeChanges(Fm.REMOVE))return[];const e=t instanceof zm?t.toArray():t,i=this._items,n=[],s=e.length;for(let t=0;t<s;t++){const s=e[t],r=i.indexOf(s);if(r>-1){const s=1+Hm(e,i,t+1,r+1),o=this._splice(r,s);o&&o.length>0&&n.push.apply(n,o),t+=s-1}}return this._emitAfterChanges(Fm.REMOVE),n}reverse(){if(Ee(this._observable),this._emitBeforeChanges(Fm.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(Fm.MOVE),this}shift(){if(Ee(this._observable),!this.length||this._emitBeforeChanges(Fm.REMOVE))return;const t=qm(this._splice(0,1));return this._emitAfterChanges(Fm.REMOVE),t}slice(t=0,e=this.length){return Ee(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return Ee(this._observable),this._items.some(t,e)}sort(t){if(Ee(this._observable),!this.length||this._emitBeforeChanges(Fm.MOVE))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(Fm.MOVE),this}splice(t,e,...i){Ee(this._observable);const n=(e?Fm.REMOVE:0)|(i.length?Fm.ADD:0);if(this._emitBeforeChanges(n))return[];const s=this._splice(t,e,i)||[];return this._emitAfterChanges(n),s}toArray(){return Ee(this._observable),this._items.slice()}toJSON(){return Ee(this._observable),this.toArray()}toLocaleString(){return Ee(this._observable),this._items.toLocaleString()}toString(){return Ee(this._observable),this._items.toString()}unshift(...t){return Ee(this._observable),!t.length||this._emitBeforeChanges(Fm.ADD)||(this._splice(0,0,t),this._emitAfterChanges(Fm.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const n=this._items,s=this.itemType;let r,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=ln((()=>this._dispatchChange()))),t<0&&(t+=this.length),e){if(o=n.splice(t,e),this.hasEventListener("before-remove")){const e=Gm.acquire();e.target=this,e.cancellable=!0;for(let i=0,s=o.length;i<s;i++)r=o[i],e.reset(r),this.emit("before-remove",e),e.defaultPrevented&&(o.splice(i,1),n.splice(t,0,r),t+=1,i-=1,s-=1);Gm.release(e)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const t=Gm.acquire();t.target=this,t.cancellable=!1;const e=o.length;for(let i=0;i<e;i++)t.reset(o[i]),this.emit("after-remove",t);Gm.release(t)}}if(i?.length){if(s){const t=[];for(const e of i){const i=s.ensureType(e);null==i&&null!=e||t.push(i)}i=t}const e=this.hasEventListener("before-add"),r=this.hasEventListener("after-add"),o=t===this.length;if(e||r){const s=Gm.acquire();s.target=this,s.cancellable=!0;const a=Gm.acquire();a.target=this,a.cancellable=!1;for(const l of i)e?(s.reset(l),this.emit("before-add",s),s.defaultPrevented||(o?n.push(l):n.splice(t++,0,l),this._set("length",n.length),r&&(a.reset(l),this.emit("after-add",a)))):(o?n.push(l):n.splice(t++,0,l),this._set("length",n.length),a.reset(l),this.emit("after-add",a));Gm.release(a),Gm.release(s)}else{if(o)for(const t of i)n.push(t);else n.splice(t,0,...i);this._set("length",n.length)}}if((i?.length||o?.length)&&this._notifyChangeEvent(i,o),this.hasEventListener("after-splice")){const n=new Vm(this,i,o,t,e);this.emit("after-splice",n)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Gm.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Gm.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Gm.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Gm.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const t=e.changes;Zm.clear(),Jm.clear(),Km.clear();for(const{added:e,removed:i}of t){if(e)if(0===Km.size&&0===Jm.size)for(const t of e)Zm.add(t);else for(const t of e)Jm.has(t)?(Km.add(t),Jm.delete(t)):Km.has(t)||Zm.add(t);if(i)if(0===Km.size&&0===Zm.size)for(const t of i)Jm.add(t);else for(const t of i)Zm.has(t)?Zm.delete(t):(Km.delete(t),Jm.add(t))}const i=ai.acquire();Zm.forEach((t=>{i.push(t)}));const n=ai.acquire();Jm.forEach((t=>{n.push(t)}));const s=this._items,r=e.items,o=ai.acquire();if(Km.forEach((t=>{r.indexOf(t)!==s.indexOf(t)&&o.push(t)})),e.listeners&&(i.length||n.length||o.length)){const t={target:this,added:i,removed:n,moved:o},s=e.listeners.length;for(let i=0;i<s;i++){const n=e.listeners[i];n.removed||n.callback.call(this,t)}}ai.release(i),ai.release(n),ai.release(o)}Zm.clear(),Jm.clear(),Km.clear()}};Xm.ofType=t=>{if(!t)return zm;if(Ym.has(t))return Ym.get(t);let e=null;if("function"==typeof t)e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const i in t.typeMap){const n=t.typeMap[i].prototype.declaredClass;e?e+=` | ${n}`:e=n}let i=class extends zm{};return o([Dm({Type:t,ensureType:"function"==typeof t?ks(t):Ls(t)})],i.prototype,"itemType",void 0),i=o([Nr(`esri.core.Collection<${e}>`)],i),Ym.set(t,i),i},o([Us()],Xm.prototype,"_updating",void 0),o([Us()],Xm.prototype,"length",void 0),o([Us()],Xm.prototype,"items",null),o([Us({readOnly:!0})],Xm.prototype,"updating",null),Xm=zm=o([Nr("esri.core.Collection")],Xm);const ty=Xm;function ey(t,e,i){return Di(t.map(((t,n)=>e.apply(i,[t,n]))))}async function iy(t,e,i){return(await Di(t.map(((t,n)=>e.apply(i,[t,n]))))).map((t=>t.value))}function ny(t){return{ok:!0,value:t}}function sy(t){return{ok:!1,error:t}}function ry(t){return null!=t&&!0===t.ok?t.value:null}function oy(t){return null!=t&&!1===t.ok?t.error:null}async function ay(t){if(null==t)return{ok:!1,error:new Error("no promise provided")};try{return ny(await t)}catch(t){return sy(t)}}async function ly(t){try{return ny(await t)}catch(t){return Ei(t),sy(t)}}function uy(t,e){return new cy(t,e)}let cy=class extends Vr{get value(){return ry(this._result)}get error(){return oy(this._result)}get finished(){return null!=this._result}constructor(t,e){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=Vt(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=t(i),this.promise.then((t=>{this._result=ny(t),this._cleanup()}),(t=>{this._result=sy(t),this._cleanup()})),this._abortHandle=Li(e,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=Ut(this._abortHandle),this._abortController=null}};o([Us()],cy.prototype,"value",null),o([Us()],cy.prototype,"error",null),o([Us()],cy.prototype,"finished",null),o([Us()],cy.prototype,"promise",void 0),o([Us()],cy.prototype,"_result",void 0),cy=o([Nr("esri.core.asyncUtils.ReactiveTask")],cy);let hy=class extends ty{constructor(t){super(t),this.getCollections=null}initialize(){this.addHandles(Dn((()=>this._refresh())))}destroy(){this.getCollections=null}_refresh(){const t=null!=this.getCollections?this.getCollections():null;if(null==t)return void this.removeAll();let e=0;for(const i of t)null!=i&&(e=this._processCollection(e,i));this.splice(e,this.length)}_createNewInstance(t){return new ty(t)}_processCollection(t,e){if(!e)return t;const i=this.itemFilterFunction??(t=>!!t);for(const n of e)if(n){if(i(n)){const e=this.indexOf(n,t);e>=0?e!==t&&this.reorder(n,t):this.add(n,t),++t}if(this.getChildrenFunction){const e=this.getChildrenFunction(n);if(Array.isArray(e))for(const i of e)t=this._processCollection(t,i);else t=this._processCollection(t,e)}}return t}};o([Us()],hy.prototype,"getCollections",void 0),o([Us()],hy.prototype,"getChildrenFunction",void 0),o([Us()],hy.prototype,"itemFilterFunction",void 0),hy=o([Nr("esri.core.CollectionFlattener")],hy);const dy=hy;function fy(t,e,i={}){return my(t,e,i,wy)}function py(t,e,i={}){return my(t,e,i,by)}function my(t,e,i={},n){let s=null;const r=i.once?(t,i)=>{n(t)&&(Ut(s),e(t,i))}:(t,i)=>{n(t)&&e(t,i)};if(s=ss(t,r,i.sync,i.equals),i.initial){const e=t();r(e,e)}return s}function yy(t,e,i,n={}){let s=null,r=null,o=null;function a(){s&&r&&(r.remove(),n.onListenerRemove?.(s),s=null,r=null)}function l(t){n.once&&n.once&&Ut(o),i(t)}const u=fy(t,((t,i)=>{a(),Si(t)&&(s=t,r=Mi(t,e,l),n.onListenerAdd?.(t))}),{sync:n.sync,initial:!0});return o=Zt((()=>{u.remove(),a()})),o}function gy(t,e){return vy(t,by,e)}function vy(t,e,i){if(Ci(i))return Promise.reject(Ai());const n=t();if(e?.(n))return Promise.resolve(n);let s=null;function r(){s=Ut(s)}return new Promise(((n,o)=>{s=Kt([Li(i,(()=>{r(),o(Ai())})),my(t,(t=>{r(),n(t)}),{sync:!1,once:!0},e??wy)])}))}function wy(t){return!0}function by(t){return!!t}function Sy(t,e,i={}){let n=!1;const s=fy(t,((t,i)=>{n||e(t,i)}),i);return{remove(){s.remove()},pause(){n=!0},resume(){n=!1}}}const xy={sync:!0},_y={initial:!0},My={sync:!0,initial:!0};class ky{constructor(t=(t=>t.values().next().value)){this._peeker=t,this._observable=new $m,this._items=new Set}get length(){return Ee(this._observable),this._items.size}clear(){0!==this.length&&(this._items.clear(),this._observable.notify())}last(){if(0===this.length)return;let t;for(t of this._items);return t}peek(){if(0!==this.length)return this._peeker(this._items)}push(t){this.contains(t)||(this._items.add(t),this._observable.notify())}contains(t){return Ee(this._observable),this._items.has(t)}pop(){if(0===this.length)return;const t=this.peek();return this._items.delete(t),this._observable.notify(),t}popLast(){if(0===this.length)return;const t=this.last();return this._items.delete(t),this._observable.notify(),t}remove(t){this.contains(t)&&(this._items.delete(t),this._observable.notify())}filter(t){const e=this.length;return this._items.forEach((e=>{t(e)||this._items.delete(e)})),e!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){Ee(this._observable),yield*this._items}}const Ty=new FinalizationRegistry((t=>{t.close()}));function Ay(t,e){Ty.register(t,e,e)}function Iy(t){Ty.unregister(t)}const jy="worker:port-closed";var Cy;!function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"}(Cy||(Cy={}));let Ey=0;function Oy(){return Ey++}function Ly(t){return t&&"object"==typeof t&&("result"in t||"transferList"in t)}function Ny(t){return t?"string"==typeof t?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function Ry(t,e,i,n){if(e.type===Cy.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==Cy.INVOKE&&e.type!==Cy.RESPONSE)return void t.postMessage(e);let s;if(Ly(i)?(s=Fy(i.transferList),e.data=i.result):(s=Fy(n),e.data=i),s){if(c("ff"))for(const i of s)if("byteLength"in i&&i.byteLength>267386880){const i="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case Cy.INVOKE:throw i;case Cy.RESPONSE:return void Ry(t,{type:Cy.RESPONSE,jobId:e.jobId,error:Ny(i)})}}t.postMessage(e,s)}else t.postMessage(e)}function Py(t){if(!t)return null;const e=t.data;return e?"string"==typeof e?JSON.parse(e):e:null}function Fy(t){if(!t?.length)return null;if(c("esri-workers-arraybuffer-transfer"))return t;const e=t.filter((t=>!Dy(t)));return e.length?e:null}function Dy(t){return t instanceof ArrayBuffer||"ArrayBuffer"===t?.constructor?.name}async function $y(t){try{return await t}catch(t){const e=t?.name===jy;if(!(Pi(t)||e))throw t;return}}function zy(t,e,i){return new Proxy({},{get:(n,s,r)=>(...n)=>{let r,o;const a=n[n.length-1];Uy(a)&&(r=a.signal,o=a.transferList,n.pop());const l=t.apply(e?`${e}.${s.toString()}`:s.toString(),n,{transferList:o,signal:r});return i?.ignoreConnectionErrors?$y(l):l}})}function Uy(t){return"object"==typeof t&&!Array.isArray(t)&&null!=t&&("signal"in t||"transferList"in t||0===Object.keys(t).length)}const Vy={statsWorker:()=>import("./p-21de0cfe.js"),geometryEngineWorker:()=>import("./p-b8f6f342.js"),CSVSourceWorker:()=>import("./p-17629174.js"),EdgeProcessingWorker:()=>import("./p-60afcf60.js"),ElevationSamplerWorker:()=>import("./p-457e4e13.js"),FeatureServiceSnappingSourceWorker:()=>import("./p-ea4e8d0c.js"),GeoJSONSourceWorker:()=>import("./p-87d03a34.js"),LercWorker:()=>import("./p-a22715d1.js"),MemorySourceWorker:()=>import("./p-162fa646.js"),PBFDecoderWorker:()=>import("./p-c91ee7ed.js"),FeaturePipelineWorker:()=>import("./p-d10bd432.js"),PointCloudWorker:()=>import("./p-ced0bfe5.js"),RasterWorker:()=>import("./p-ff457548.js"),SceneLayerSnappingSourceWorker:()=>import("./p-0bfa082d.js"),SceneLayerWorker:()=>import("./p-d24dc1be.js"),WFSSourceWorker:()=>import("./p-c4d805ec.js"),WorkerTileHandler:()=>import("./p-839d7c5c.js"),Lyr3DWorker:()=>import("./p-3f77b58f.js")};const{CLOSE:Gy,ABORT:By,INVOKE:qy,RESPONSE:Hy,OPEN_PORT:Wy,ON:Zy}=Cy,Jy=2;class Ky{constructor(t){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}push(t){t.type===Cy.ABORT?this._cancelledJobIds.add(t.jobId):(this._invokeMessages.push(t),null===this._timer&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const t of this._invokeMessages)this._cancelledJobIds.has(t.jobId)||this._invoke(t);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class Yy{static connect(t){const e=new MessageChannel;let i;i="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t;const n=new Yy(e.port1,{channel:e,client:i});return"object"==typeof i&&"remoteClient"in i&&(i.remoteClient=n),Yy.clients.set(n,i),e.port2}static loadWorker(t){const e=Vy[t];return e?e():Promise.resolve(null)}constructor(t,e,i){this._port=t,this._jobQueue=i,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new Ky((t=>this._onInvokeMessage(t))),this._client=e.client,this._onMessage=this._onMessage.bind(this),this._channel=e.channel,this._schedule=e.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:Gy}),this._close()}isBusy(){return this._outJobs.size>0}invoke(t,e,i){return this.apply(t,[e],i)}apply(t,e,i){const n=i?.signal,s=i?.transferList;if(!this._port)return Promise.reject(new Qe(jy,`Cannot call invoke('${t}'), port is closed`,{methodName:t,data:e}));const r=Oy();return new Promise(((i,o)=>{if(Ci(n))return this._processWork(),void o(Ai());const a=Li(n,(()=>{const t=this._outJobs.get(r);t&&(this._outJobs.delete(r),this._processWork(),Ut(t.abortHandle),this._post({type:By,jobId:r}),o(Ai()))})),l={resolve:i,reject:o,abortHandle:a,debugInfo:t};this._outJobs.set(r,l),this._post({type:qy,jobId:r,methodName:t,abortable:null!=n},e,s)}))}createInvokeProxy(t,e){return zy(this,t,e)}on(t,e){const i=new MessageChannel;function n(t){e(t.data)}return this._port.postMessage({type:Cy.ON,eventType:t,port:i.port2},[i.port2]),i.port1.addEventListener("message",n),i.port1.start(),Zt((()=>{i.port1.postMessage({type:Cy.CLOSE}),i.port1.close(),i.port1.removeEventListener("message",n)}))}jobAdded(){this._processWork()}openPort(){const t=new MessageChannel;return this._post({type:Wy,port:t.port2}),t.port1}_processWork(){if(this._outJobs.size>=Jy)return;const t=this._jobQueue?.pop();if(!t)return;const{methodName:e,data:i,invokeOptions:n,resolver:s}=t;this.apply(e,i,n).then((t=>s.resolve(t))).catch((t=>s.reject(t)))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((t=>{Ut(t.abortHandle),t.reject(Ai(`Worker closing, aborting job calling '${t.debugInfo}'`))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(t){null!=this._schedule?this._schedule((()=>this._processMessage(t))):this._processMessage(t)}_processMessage(t){const e=Py(t);if(e)switch(e.type){case Hy:this._onResponseMessage(e);break;case qy:this._invokeQueue.push(e);break;case By:this._onAbortMessage(e);break;case Gy:this._onCloseMessage();break;case Wy:this._onOpenPortMessage(e);break;case Zy:this._onOnMessage(e)}}_onAbortMessage(t){const e=this._inJobs,i=t.jobId,n=e.get(i);this._invokeQueue.push(t),n&&(n.controller&&n.controller.abort(),e.delete(i))}_onCloseMessage(){const t=this._client;this._close(),t&&"destroy"in t&&Yy.clients.get(this)===t&&t.destroy(),Yy.clients.delete(this),t?.remoteClient&&(t.remoteClient=null)}_onInvokeMessage(t){const{methodName:e,jobId:i,data:n=[],abortable:s}=t,r=s?new AbortController:null,o=this._inJobs;let a,l=this._client,u=l[e];try{if(!u&&e&&e.includes(".")){const t=e.split(".");for(let e=0;e<t.length-1;e++)l=l[t[e]],u=l[t[e+1]]}if("function"!=typeof u)throw new TypeError(`${e} is not a function`);n.push({client:this,signal:r?r.signal:null}),a=u.apply(l,n)}catch(t){return void this._post({type:Hy,jobId:i,error:Ny(t)})}Gi(a)?(o.set(i,{controller:r,promise:a}),a.then((t=>{o.has(i)&&(o.delete(i),this._post({type:Hy,jobId:i},t))}),(t=>{o.has(i)&&(o.delete(i),Pi(t)||this._post({type:Hy,jobId:i,error:Ny(t||{message:`Error encountered at method ${e}`})}))}))):this._post({type:Hy,jobId:i},a)}_onOpenPortMessage(t){new Yy(t.port,{client:this._client})}_onOnMessage(t){const{port:e}=t,i=this._client.on(t.eventType,(t=>{e.postMessage(t)})),n=Mi(t.port,"message",(t=>{const s=Py(t);s?.type===Cy.CLOSE&&(n.remove(),i.remove(),e.close())}))}_onResponseMessage(t){const{jobId:e,error:i,data:n}=t,s=this._outJobs;if(!s.has(e))return;const r=s.get(e);s.delete(e),this._processWork(),Ut(r.abortHandle),i?r.reject(Qe.fromJSON(JSON.parse(i))):r.resolve(n)}_post(t,e,i){return Ry(this._port,t,e,i)}}Yy.kernelInfo={buildDate:Ju,fullVersion:Xu,revision:Ku},Yy.clients=new Map;class Qy{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new ky}destroy(){this.close()}get closed(){return!this._clients?.length}open(t,e){return new Promise(((i,n)=>{let s=!0;const r=t=>{Ii(e.signal),s&&(s=!1,t())};this._clients.length=t.length,this._clientPromises.length=t.length,this._inUseClients.length=t.length;for(let s=0;s<t.length;++s){const o=t[s];Gi(o)?this._clientPromises[s]=o.then((t=>(this._clients[s]=new Yy(t,e,this._ongoingJobsQueue),r(i),this._clients[s])),(()=>(r(n),null))):(this._clients[s]=new Yy(o,e,this._ongoingJobsQueue),this._clientPromises[s]=Promise.resolve(this._clients[s]),r(i))}}))}broadcast(t,e,i){const n=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const r=this._clientPromises[s];n[s]=r.then((n=>n?.invoke(t,e,i)))}return n}close(){let t;for(;t=this._ongoingJobsQueue.pop();)t.resolver.reject(Ai(`Worker closing, aborting job calling '${t.methodName}'`));for(const t of this._clientPromises)t.then((t=>t?.close()));this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,Iy(this)}invoke(t,e,i){return this.apply(t,[e],i)}apply(t,e,i){const n=Hi();this._ongoingJobsQueue.push({methodName:t,data:e,invokeOptions:i,resolver:n});for(let t=0;t<this._clientPromises.length;t++){const e=this._clients[t];e?e.jobAdded():this._clientPromises[t].then((t=>t?.jobAdded()))}return n.promise}createInvokeProxy(t){return zy(this,t)}on(t,e){return Promise.all(this._clientPromises).then((()=>Kt(this._clients.map((i=>i.on(t,e))))))}openPorts(){return new Promise((t=>{const e=new Array(this._clientPromises.length);let i=e.length;for(let n=0;n<this._clientPromises.length;++n){this._clientPromises[n].then((s=>{s&&(e[n]=s.openPort()),0==--i&&t(e)}))}}))}get test(){return{numClients:this._clients.length}}}const Xy={async request(t,e){const i=t.options,n=i.responseType;i.signal=e?.signal,i.responseType="native"===n||"native-request-init"===n?"native-request-init":n&&["blob","json","text"].includes(n)&&tu(t.url)?.after?n:"array-buffer";const s=await hc(t.url,i),r={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch(s.requestOptions?.responseType){case"native-request-init":return delete r.data.signal,r;case"blob":r.data=await r.data.arrayBuffer();break;case"json":r.data=(new TextEncoder).encode(JSON.stringify(r.data)).buffer;break;case"text":r.data=(new TextEncoder).encode(r.data).buffer}return{result:r,transferList:[r.data]}}};let tg;const eg=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale;function ig(){return eg??globalThis.navigator?.language??"en"}function ng(){return void 0===tg&&(tg=ig()),tg}function sg(t=ng()){const e=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(t);return e?.[1].toLowerCase()}const rg=[];function og(t){return rg.push(t),Zt((()=>rg.splice(rg.indexOf(t),1)))}const ag=[];function lg(t){return ag.push(t),Zt((()=>rg.splice(ag.indexOf(t),1)))}function ug(){const t=ig();tg!==t&&(tg=t,[...ag].forEach((e=>{e.call(null,t)})),[...rg].forEach((e=>{e.call(null,t)})))}globalThis.addEventListener?.("languagechange",ug);const cg=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Almaty"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);function hg(t,e,i){return i={path:e,exports:{},require:function(t,e){return dg()}},t(i,i.exports),i.exports}function dg(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var fg=hg((function(t,e){Object.defineProperty(e,"__esModule",{value:true});function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,g(n.key),n)}}function n(t,e,n){if(e)i(t.prototype,e);if(n)i(t,n);Object.defineProperty(t,"prototype",{writable:false});return t}function s(){s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i){if(Object.prototype.hasOwnProperty.call(i,n)){t[n]=i[n]}}}return t};return s.apply(this,arguments)}function r(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;a(t,e)}function o(t){o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function t(e){return e.__proto__||Object.getPrototypeOf(e)};return o(t)}function a(t,e){a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,i){e.__proto__=i;return e};return a(t,e)}function l(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(t){return false}}function u(t,e,i){if(l()){u=Reflect.construct.bind()}else{u=function t(e,i,n){var s=[null];s.push.apply(s,i);var r=Function.bind.apply(e,s);var o=new r;if(n)a(o,n.prototype);return o}}return u.apply(null,arguments)}function c(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function h(t){var e=typeof Map==="function"?new Map:undefined;h=function t(i){if(i===null||!c(i))return i;if(typeof i!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof e!=="undefined"){if(e.has(i))return e.get(i);e.set(i,n)}function n(){return u(i,arguments,o(this).constructor)}n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:false,writable:true,configurable:true}});return a(n,i)};return h(t)}function d(t,e){if(t==null)return{};var i={};var n=Object.keys(t);var s,r;for(r=0;r<n.length;r++){s=n[r];if(e.indexOf(s)>=0)continue;i[s]=t[s]}return i}function f(t,e){if(!t)return;if(typeof t==="string")return p(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor)i=t.constructor.name;if(i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(t,e)}function p(t,e){if(e==null||e>t.length)e=t.length;for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function m(t,e){var i=typeof Symbol!=="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=f(t))||e&&t&&typeof t.length==="number"){if(i)t=i;var n=0;return function(){if(n>=t.length)return{done:true};return{done:false,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(t,e){if(typeof t!=="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==undefined){var n=i.call(t,e||"default");if(typeof n!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g(t){var e=y(t,"string");return typeof e==="symbol"?e:String(e)}var v=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}return e}(h(Error));var w=function(t){r(e,t);function e(e){return t.call(this,"Invalid DateTime: "+e.toMessage())||this}return e}(v);var b=function(t){r(e,t);function e(e){return t.call(this,"Invalid Interval: "+e.toMessage())||this}return e}(v);var S=function(t){r(e,t);function e(e){return t.call(this,"Invalid Duration: "+e.toMessage())||this}return e}(v);var x=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}return e}(v);var _=function(t){r(e,t);function e(e){return t.call(this,"Invalid unit "+e)||this}return e}(v);var M=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}return e}(v);var k=function(t){r(e,t);function e(){return t.call(this,"Zone is an abstract class")||this}return e}(v);var T="numeric",A="short",I="long";var j={year:T,month:T,day:T};var C={year:T,month:A,day:T};var E={year:T,month:A,day:T,weekday:A};var O={year:T,month:I,day:T};var L={year:T,month:I,day:T,weekday:I};var N={hour:T,minute:T};var R={hour:T,minute:T,second:T};var P={hour:T,minute:T,second:T,timeZoneName:A};var F={hour:T,minute:T,second:T,timeZoneName:I};var D={hour:T,minute:T,hourCycle:"h23"};var $={hour:T,minute:T,second:T,hourCycle:"h23"};var z={hour:T,minute:T,second:T,hourCycle:"h23",timeZoneName:A};var U={hour:T,minute:T,second:T,hourCycle:"h23",timeZoneName:I};var V={year:T,month:T,day:T,hour:T,minute:T};var G={year:T,month:T,day:T,hour:T,minute:T,second:T};var B={year:T,month:A,day:T,hour:T,minute:T};var q={year:T,month:A,day:T,hour:T,minute:T,second:T};var H={year:T,month:A,day:T,weekday:A,hour:T,minute:T};var W={year:T,month:I,day:T,hour:T,minute:T,timeZoneName:A};var Z={year:T,month:I,day:T,hour:T,minute:T,second:T,timeZoneName:A};var J={year:T,month:I,day:T,weekday:I,hour:T,minute:T,timeZoneName:I};var K={year:T,month:I,day:T,weekday:I,hour:T,minute:T,second:T,timeZoneName:I};var Y=function(){function t(){}var e=t.prototype;e.offsetName=function t(e,i){throw new k};e.formatOffset=function t(e,i){throw new k};e.offset=function t(e){throw new k};e.equals=function t(e){throw new k};n(t,[{key:"type",get:function t(){throw new k}},{key:"name",get:function t(){throw new k}},{key:"ianaName",get:function t(){return this.name}},{key:"isUniversal",get:function t(){throw new k}},{key:"isValid",get:function t(){throw new k}}]);return t}();var Q=null;var X=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.offsetName=function t(e,i){var n=i.format,s=i.locale;return Ne(e,n,s)};i.formatOffset=function t(e,i){return De(this.offset(e),i)};i.offset=function t(e){return-new Date(e).getTimezoneOffset()};i.equals=function t(e){return e.type==="system"};n(e,[{key:"type",get:function t(){return"system"}},{key:"name",get:function t(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}},{key:"isUniversal",get:function t(){return false}},{key:"isValid",get:function t(){return true}}],[{key:"instance",get:function t(){if(Q===null){Q=new e}return Q}}]);return e}(Y);var tt={};function et(t){if(!tt[t]){tt[t]=new Intl.DateTimeFormat("en-US",{hour12:false,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})}return tt[t]}var it={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function nt(t,e){var i=t.format(e).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),s=n[1],r=n[2],o=n[3],a=n[4],l=n[5],u=n[6],c=n[7];return[o,s,r,a,l,u,c]}function st(t,e){var i=t.formatToParts(e);var n=[];for(var s=0;s<i.length;s++){var r=i[s],o=r.type,a=r.value;var l=it[o];if(o==="era"){n[l]=a}else if(!le(l)){n[l]=parseInt(a,10)}}return n}var rt={};var ot=function(t){r(e,t);e.create=function t(i){if(!rt[i]){rt[i]=new e(i)}return rt[i]};e.resetCache=function t(){rt={};tt={}};e.isValidSpecifier=function t(e){return this.isValidZone(e)};e.isValidZone=function t(e){if(!e){return false}try{new Intl.DateTimeFormat("en-US",{timeZone:e}).format();return true}catch(t){return false}};function e(i){var n;n=t.call(this)||this;n.zoneName=i;n.valid=e.isValidZone(i);return n}var i=e.prototype;i.offsetName=function t(e,i){var n=i.format,s=i.locale;return Ne(e,n,s,this.name)};i.formatOffset=function t(e,i){return De(this.offset(e),i)};i.offset=function t(e){var i=new Date(e);if(isNaN(i))return NaN;var n=et(this.name);var s=n.formatToParts?st(n,i):nt(n,i),r=s[0],o=s[1],a=s[2],l=s[3],u=s[4],c=s[5],h=s[6];if(l==="BC"){r=-Math.abs(r)+1}var d=u===24?0:u;var f=Ce({year:r,month:o,day:a,hour:d,minute:c,second:h,millisecond:0});var p=+i;var m=p%1e3;p-=m>=0?m:1e3+m;return(f-p)/(60*1e3)};i.equals=function t(e){return e.type==="iana"&&e.name===this.name};n(e,[{key:"type",get:function t(){return"iana"}},{key:"name",get:function t(){return this.zoneName}},{key:"isUniversal",get:function t(){return false}},{key:"isValid",get:function t(){return this.valid}}]);return e}(Y);var at=["base"],lt=["padTo","floor"];var ut={};function ct(t,e){if(e===void 0){e={}}var i=JSON.stringify([t,e]);var n=ut[i];if(!n){n=new Intl.ListFormat(t,e);ut[i]=n}return n}var ht={};function dt(t,e){if(e===void 0){e={}}var i=JSON.stringify([t,e]);var n=ht[i];if(!n){n=new Intl.DateTimeFormat(t,e);ht[i]=n}return n}var ft={};function pt(t,e){if(e===void 0){e={}}var i=JSON.stringify([t,e]);var n=ft[i];if(!n){n=new Intl.NumberFormat(t,e);ft[i]=n}return n}var mt={};function yt(t,e){if(e===void 0){e={}}var i=e;var n=d(i,at);var s=JSON.stringify([t,n]);var r=mt[s];if(!r){r=new Intl.RelativeTimeFormat(t,e);mt[s]=r}return r}var gt=null;function vt(){if(gt){return gt}else{gt=(new Intl.DateTimeFormat).resolvedOptions().locale;return gt}}var wt={};function bt(t){var e=wt[t];if(!e){var i=new Intl.Locale(t);e="getWeekInfo"in i?i.getWeekInfo():i.weekInfo;wt[t]=e}return e}function St(t){var e=t.indexOf("-x-");if(e!==-1){t=t.substring(0,e)}var i=t.indexOf("-u-");if(i===-1){return[t]}else{var n;var s;try{n=dt(t).resolvedOptions();s=t}catch(e){var r=t.substring(0,i);n=dt(r).resolvedOptions();s=r}var o=n,a=o.numberingSystem,l=o.calendar;return[s,a,l]}}function xt(t,e,i){if(i||e){if(!t.includes("-u-")){t+="-u"}if(i){t+="-ca-"+i}if(e){t+="-nu-"+e}return t}else{return t}}function _t(t){var e=[];for(var i=1;i<=12;i++){var n=Is.utc(2009,i,1);e.push(t(n))}return e}function Mt(t){var e=[];for(var i=1;i<=7;i++){var n=Is.utc(2016,11,13+i);e.push(t(n))}return e}function kt(t,e,i,n){var s=t.listingMode();if(s==="error"){return null}else if(s==="en"){return i(e)}else{return n(e)}}function Tt(t){if(t.numberingSystem&&t.numberingSystem!=="latn"){return false}else{return t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}}var At=function(){function t(t,e,i){this.padTo=i.padTo||0;this.floor=i.floor||false;var n=d(i,lt);if(!e||Object.keys(n).length>0){var r=s({useGrouping:false},i);if(i.padTo>0)r.minimumIntegerDigits=i.padTo;this.inf=pt(t,r)}}var e=t.prototype;e.format=function t(e){if(this.inf){var i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{var n=this.floor?Math.floor(e):Te(e,3);return xe(n,this.padTo)}};return t}();var It=function(){function t(t,e,i){this.opts=i;this.originalZone=undefined;var n=undefined;if(this.opts.timeZone){this.dt=t}else if(t.zone.type==="fixed"){var r=-1*(t.offset/60);var o=r>=0?"Etc/GMT+"+r:"Etc/GMT"+r;if(t.offset!==0&&ot.create(o).valid){n=o;this.dt=t}else{n="UTC";this.dt=t.offset===0?t:t.setZone("UTC").plus({minutes:t.offset});this.originalZone=t.zone}}else if(t.zone.type==="system"){this.dt=t}else if(t.zone.type==="iana"){this.dt=t;n=t.zone.name}else{n="UTC";this.dt=t.setZone("UTC").plus({minutes:t.offset});this.originalZone=t.zone}var a=s({},this.opts);a.timeZone=a.timeZone||n;this.dtf=dt(e,a)}var e=t.prototype;e.format=function t(){if(this.originalZone){return this.formatToParts().map((function(t){var e=t.value;return e})).join("")}return this.dtf.format(this.dt.toJSDate())};e.formatToParts=function t(){var e=this;var i=this.dtf.formatToParts(this.dt.toJSDate());if(this.originalZone){return i.map((function(t){if(t.type==="timeZoneName"){var i=e.originalZone.offsetName(e.dt.ts,{locale:e.dt.locale,format:e.opts.timeZoneName});return s({},t,{value:i})}else{return t}}))}return i};e.resolvedOptions=function t(){return this.dtf.resolvedOptions()};return t}();var jt=function(){function t(t,e,i){this.opts=s({style:"long"},i);if(!e&&fe()){this.rtf=yt(t,i)}}var e=t.prototype;e.format=function t(e,i){if(this.rtf){return this.rtf.format(e,i)}else{return ni(i,e,this.opts.numeric,this.opts.style!=="long")}};e.formatToParts=function t(e,i){if(this.rtf){return this.rtf.formatToParts(e,i)}else{return[]}};return t}();var Ct={firstDay:1,minimalDays:4,weekend:[6,7]};var Et=function(){t.fromOpts=function e(i){return t.create(i.locale,i.numberingSystem,i.outputCalendar,i.weekSettings,i.defaultToEN)};t.create=function e(i,n,s,r,o){if(o===void 0){o=false}var a=i||Bt.defaultLocale;var l=a||(o?"en-US":vt());var u=n||Bt.defaultNumberingSystem;var c=s||Bt.defaultOutputCalendar;var h=we(r)||Bt.defaultWeekSettings;return new t(l,u,c,h,a)};t.resetCache=function t(){gt=null;ht={};ft={};mt={}};t.fromObject=function e(i){var n=i===void 0?{}:i,s=n.locale,r=n.numberingSystem,o=n.outputCalendar,a=n.weekSettings;return t.create(s,r,o,a)};function t(t,e,i,n,s){var r=St(t),o=r[0],a=r[1],l=r[2];this.locale=o;this.numberingSystem=e||a||null;this.outputCalendar=i||l||null;this.weekSettings=n;this.intl=xt(this.locale,this.numberingSystem,this.outputCalendar);this.weekdaysCache={format:{},standalone:{}};this.monthsCache={format:{},standalone:{}};this.meridiemCache=null;this.eraCache={};this.specifiedLocale=s;this.fastNumbersCached=null}var e=t.prototype;e.listingMode=function t(){var e=this.isEnglish();var i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"};e.clone=function e(i){if(!i||Object.getOwnPropertyNames(i).length===0){return this}else{return t.create(i.locale||this.specifiedLocale,i.numberingSystem||this.numberingSystem,i.outputCalendar||this.outputCalendar,we(i.weekSettings)||this.weekSettings,i.defaultToEN||false)}};e.redefaultToEN=function t(e){if(e===void 0){e={}}return this.clone(s({},e,{defaultToEN:true}))};e.redefaultToSystem=function t(e){if(e===void 0){e={}}return this.clone(s({},e,{defaultToEN:false}))};e.months=function t(e,i){var n=this;if(i===void 0){i=false}return kt(this,e,Ge,(function(){var t=i?{month:e,day:"numeric"}:{month:e},s=i?"format":"standalone";if(!n.monthsCache[s][e]){n.monthsCache[s][e]=_t((function(e){return n.extract(e,t,"month")}))}return n.monthsCache[s][e]}))};e.weekdays=function t(e,i){var n=this;if(i===void 0){i=false}return kt(this,e,We,(function(){var t=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=i?"format":"standalone";if(!n.weekdaysCache[s][e]){n.weekdaysCache[s][e]=Mt((function(e){return n.extract(e,t,"weekday")}))}return n.weekdaysCache[s][e]}))};e.meridiems=function t(){var e=this;return kt(this,undefined,(function(){return Ze}),(function(){if(!e.meridiemCache){var t={hour:"numeric",hourCycle:"h12"};e.meridiemCache=[Is.utc(2016,11,13,9),Is.utc(2016,11,13,19)].map((function(i){return e.extract(i,t,"dayperiod")}))}return e.meridiemCache}))};e.eras=function t(e){var i=this;return kt(this,e,Qe,(function(){var t={era:e};if(!i.eraCache[e]){i.eraCache[e]=[Is.utc(-40,1,1),Is.utc(2017,1,1)].map((function(e){return i.extract(e,t,"era")}))}return i.eraCache[e]}))};e.extract=function t(e,i,n){var s=this.dtFormatter(e,i),r=s.formatToParts(),o=r.find((function(t){return t.type.toLowerCase()===n}));return o?o.value:null};e.numberFormatter=function t(e){if(e===void 0){e={}}return new At(this.intl,e.forceSimple||this.fastNumbers,e)};e.dtFormatter=function t(e,i){if(i===void 0){i={}}return new It(e,this.intl,i)};e.relFormatter=function t(e){if(e===void 0){e={}}return new jt(this.intl,this.isEnglish(),e)};e.listFormatter=function t(e){if(e===void 0){e={}}return ct(this.intl,e)};e.isEnglish=function t(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")};e.getWeekSettings=function t(){if(this.weekSettings){return this.weekSettings}else if(!pe()){return Ct}else{return bt(this.locale)}};e.getStartOfWeek=function t(){return this.getWeekSettings().firstDay};e.getMinDaysInFirstWeek=function t(){return this.getWeekSettings().minimalDays};e.getWeekendDays=function t(){return this.getWeekSettings().weekend};e.equals=function t(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar};n(t,[{key:"fastNumbers",get:function t(){if(this.fastNumbersCached==null){this.fastNumbersCached=Tt(this)}return this.fastNumbersCached}}]);return t}();var Ot=null;var Lt=function(t){r(e,t);e.instance=function t(i){return i===0?e.utcInstance:new e(i)};e.parseSpecifier=function t(i){if(i){var n=i.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n){return new e(Re(n[1],n[2]))}}return null};function e(e){var i;i=t.call(this)||this;i.fixed=e;return i}var i=e.prototype;i.offsetName=function t(){return this.name};i.formatOffset=function t(e,i){return De(this.fixed,i)};i.offset=function t(){return this.fixed};i.equals=function t(e){return e.type==="fixed"&&e.fixed===this.fixed};n(e,[{key:"type",get:function t(){return"fixed"}},{key:"name",get:function t(){return this.fixed===0?"UTC":"UTC"+De(this.fixed,"narrow")}},{key:"ianaName",get:function t(){if(this.fixed===0){return"Etc/UTC"}else{return"Etc/GMT"+De(-this.fixed,"narrow")}}},{key:"isUniversal",get:function t(){return true}},{key:"isValid",get:function t(){return true}}],[{key:"utcInstance",get:function t(){if(Ot===null){Ot=new e(0)}return Ot}}]);return e}(Y);var Nt=function(t){r(e,t);function e(e){var i;i=t.call(this)||this;i.zoneName=e;return i}var i=e.prototype;i.offsetName=function t(){return null};i.formatOffset=function t(){return""};i.offset=function t(){return NaN};i.equals=function t(){return false};n(e,[{key:"type",get:function t(){return"invalid"}},{key:"name",get:function t(){return this.zoneName}},{key:"isUniversal",get:function t(){return false}},{key:"isValid",get:function t(){return false}}]);return e}(Y);function Rt(t,e){if(le(t)||t===null){return e}else if(t instanceof Y){return t}else if(he(t)){var i=t.toLowerCase();if(i==="default")return e;else if(i==="local"||i==="system")return X.instance;else if(i==="utc"||i==="gmt")return Lt.utcInstance;else return Lt.parseSpecifier(i)||ot.create(t)}else if(ue(t)){return Lt.instance(t)}else if(typeof t==="object"&&"offset"in t&&typeof t.offset==="function"){return t}else{return new Nt(t)}}var Pt=function t(){return Date.now()},Ft="system",Dt=null,$t=null,zt=null,Ut=60,Vt,Gt=null;var Bt=function(){function t(){}t.resetCaches=function t(){Et.resetCache();ot.resetCache()};n(t,null,[{key:"now",get:function t(){return Pt},set:function t(e){Pt=e}},{key:"defaultZone",get:function t(){return Rt(Ft,X.instance)},set:function t(e){Ft=e}},{key:"defaultLocale",get:function t(){return Dt},set:function t(e){Dt=e}},{key:"defaultNumberingSystem",get:function t(){return $t},set:function t(e){$t=e}},{key:"defaultOutputCalendar",get:function t(){return zt},set:function t(e){zt=e}},{key:"defaultWeekSettings",get:function t(){return Gt},set:function t(e){Gt=we(e)}},{key:"twoDigitCutoffYear",get:function t(){return Ut},set:function t(e){Ut=e%100}},{key:"throwOnInvalid",get:function t(){return Vt},set:function t(e){Vt=e}}]);return t}();var qt=function(){function t(t,e){this.reason=t;this.explanation=e}var e=t.prototype;e.toMessage=function t(){if(this.explanation){return this.reason+": "+this.explanation}else{return this.reason}};return t}();var Ht=[0,31,59,90,120,151,181,212,243,273,304,334],Wt=[0,31,60,91,121,152,182,213,244,274,305,335];function Zt(t,e){return new qt("unit out of range","you specified "+e+" (of type "+typeof e+") as a "+t+", which is invalid")}function Jt(t,e,i){var n=new Date(Date.UTC(t,e-1,i));if(t<100&&t>=0){n.setUTCFullYear(n.getUTCFullYear()-1900)}var s=n.getUTCDay();return s===0?7:s}function Kt(t,e,i){return i+(Ae(t)?Wt:Ht)[e-1]}function Yt(t,e){var i=Ae(t)?Wt:Ht,n=i.findIndex((function(t){return t<e})),s=e-i[n];return{month:n+1,day:s}}function Qt(t,e){return(t-e+7)%7+1}function Xt(t,e,i){if(e===void 0){e=4}if(i===void 0){i=1}var n=t.year,r=t.month,o=t.day,a=Kt(n,r,o),l=Qt(Jt(n,r,o),i);var u=Math.floor((a-l+14-e)/7),c;if(u<1){c=n-1;u=Oe(c,e,i)}else if(u>Oe(n,e,i)){c=n+1;u=1}else{c=n}return s({weekYear:c,weekNumber:u,weekday:l},$e(t))}function te(t,e,i){if(e===void 0){e=4}if(i===void 0){i=1}var n=t.weekYear,r=t.weekNumber,o=t.weekday,a=Qt(Jt(n,1,e),i),l=Ie(n);var u=r*7+o-a-7+e,c;if(u<1){c=n-1;u+=Ie(c)}else if(u>l){c=n+1;u-=Ie(n)}else{c=n}var h=Yt(c,u),d=h.month,f=h.day;return s({year:c,month:d,day:f},$e(t))}function ee(t){var e=t.year,i=t.month,n=t.day;var r=Kt(e,i,n);return s({year:e,ordinal:r},$e(t))}function ie(t){var e=t.year,i=t.ordinal;var n=Yt(e,i),r=n.month,o=n.day;return s({year:e,month:r,day:o},$e(t))}function ne(t,e){var i=!le(t.localWeekday)||!le(t.localWeekNumber)||!le(t.localWeekYear);if(i){var n=!le(t.weekday)||!le(t.weekNumber)||!le(t.weekYear);if(n){throw new x("Cannot mix locale-based week fields with ISO-based week fields")}if(!le(t.localWeekday))t.weekday=t.localWeekday;if(!le(t.localWeekNumber))t.weekNumber=t.localWeekNumber;if(!le(t.localWeekYear))t.weekYear=t.localWeekYear;delete t.localWeekday;delete t.localWeekNumber;delete t.localWeekYear;return{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else{return{minDaysInFirstWeek:4,startOfWeek:1}}}function se(t,e,i){if(e===void 0){e=4}if(i===void 0){i=1}var n=ce(t.weekYear),s=be(t.weekNumber,1,Oe(t.weekYear,e,i)),r=be(t.weekday,1,7);if(!n){return Zt("weekYear",t.weekYear)}else if(!s){return Zt("week",t.weekNumber)}else if(!r){return Zt("weekday",t.weekday)}else return false}function re(t){var e=ce(t.year),i=be(t.ordinal,1,Ie(t.year));if(!e){return Zt("year",t.year)}else if(!i){return Zt("ordinal",t.ordinal)}else return false}function oe(t){var e=ce(t.year),i=be(t.month,1,12),n=be(t.day,1,je(t.year,t.month));if(!e){return Zt("year",t.year)}else if(!i){return Zt("month",t.month)}else if(!n){return Zt("day",t.day)}else return false}function ae(t){var e=t.hour,i=t.minute,n=t.second,s=t.millisecond;var r=be(e,0,23)||e===24&&i===0&&n===0&&s===0,o=be(i,0,59),a=be(n,0,59),l=be(s,0,999);if(!r){return Zt("hour",e)}else if(!o){return Zt("minute",i)}else if(!a){return Zt("second",n)}else if(!l){return Zt("millisecond",s)}else return false}function le(t){return typeof t==="undefined"}function ue(t){return typeof t==="number"}function ce(t){return typeof t==="number"&&t%1===0}function he(t){return typeof t==="string"}function de(t){return Object.prototype.toString.call(t)==="[object Date]"}function fe(){try{return typeof Intl!=="undefined"&&!!Intl.RelativeTimeFormat}catch(t){return false}}function pe(){try{return typeof Intl!=="undefined"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch(t){return false}}function me(t){return Array.isArray(t)?t:[t]}function ye(t,e,i){if(t.length===0){return undefined}return t.reduce((function(t,n){var s=[e(n),n];if(!t){return s}else if(i(t[0],s[0])===t[0]){return t}else{return s}}),null)[1]}function ge(t,e){return e.reduce((function(e,i){e[i]=t[i];return e}),{})}function ve(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function we(t){if(t==null){return null}else if(typeof t!=="object"){throw new M("Week settings must be an object")}else{if(!be(t.firstDay,1,7)||!be(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some((function(t){return!be(t,1,7)}))){throw new M("Invalid week settings")}return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}}function be(t,e,i){return ce(t)&&t>=e&&t<=i}function Se(t,e){return t-e*Math.floor(t/e)}function xe(t,e){if(e===void 0){e=2}var i=t<0;var n;if(i){n="-"+(""+-t).padStart(e,"0")}else{n=(""+t).padStart(e,"0")}return n}function _e(t){if(le(t)||t===null||t===""){return undefined}else{return parseInt(t,10)}}function Me(t){if(le(t)||t===null||t===""){return undefined}else{return parseFloat(t)}}function ke(t){if(le(t)||t===null||t===""){return undefined}else{var e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function Te(t,e,i){if(i===void 0){i=false}var n=Math.pow(10,e),s=i?Math.trunc:Math.round;return s(t*n)/n}function Ae(t){return t%4===0&&(t%100!==0||t%400===0)}function Ie(t){return Ae(t)?366:365}function je(t,e){var i=Se(e-1,12)+1,n=t+(e-i)/12;if(i===2){return Ae(n)?29:28}else{return[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}}function Ce(t){var e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);if(t.year<100&&t.year>=0){e=new Date(e);e.setUTCFullYear(t.year,t.month-1,t.day)}return+e}function Ee(t,e,i){var n=Qt(Jt(t,1,e),i);return-n+e-1}function Oe(t,e,i){if(e===void 0){e=4}if(i===void 0){i=1}var n=Ee(t,e,i);var s=Ee(t+1,e,i);return(Ie(t)-n+s)/7}function Le(t){if(t>99){return t}else return t>Bt.twoDigitCutoffYear?1900+t:2e3+t}function Ne(t,e,i,n){if(n===void 0){n=null}var r=new Date(t),o={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};if(n){o.timeZone=n}var a=s({timeZoneName:e},o);var l=new Intl.DateTimeFormat(i,a).formatToParts(r).find((function(t){return t.type.toLowerCase()==="timezonename"}));return l?l.value:null}function Re(t,e){var i=parseInt(t,10);if(Number.isNaN(i)){i=0}var n=parseInt(e,10)||0,s=i<0||Object.is(i,-0)?-n:n;return i*60+s}function Pe(t){var e=Number(t);if(typeof t==="boolean"||t===""||Number.isNaN(e))throw new M("Invalid unit value "+t);return e}function Fe(t,e){var i={};for(var n in t){if(ve(t,n)){var s=t[n];if(s===undefined||s===null)continue;i[e(n)]=Pe(s)}}return i}function De(t,e){var i=Math.trunc(Math.abs(t/60)),n=Math.trunc(Math.abs(t%60)),s=t>=0?"+":"-";switch(e){case"short":return""+s+xe(i,2)+":"+xe(n,2);case"narrow":return""+s+i+(n>0?":"+n:"");case"techie":return""+s+xe(i,2)+xe(n,2);default:throw new RangeError("Value format "+e+" is out of range for property format")}}function $e(t){return ge(t,["hour","minute","second","millisecond"])}var ze=["January","February","March","April","May","June","July","August","September","October","November","December"];var Ue=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var Ve=["J","F","M","A","M","J","J","A","S","O","N","D"];function Ge(t){switch(t){case"narrow":return[].concat(Ve);case"short":return[].concat(Ue);case"long":return[].concat(ze);case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var Be=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];var qe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];var He=["M","T","W","T","F","S","S"];function We(t){switch(t){case"narrow":return[].concat(He);case"short":return[].concat(qe);case"long":return[].concat(Be);case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var Ze=["AM","PM"];var Je=["Before Christ","Anno Domini"];var Ke=["BC","AD"];var Ye=["B","A"];function Qe(t){switch(t){case"narrow":return[].concat(Ye);case"short":return[].concat(Ke);case"long":return[].concat(Je);default:return null}}function Xe(t){return Ze[t.hour<12?0:1]}function ti(t,e){return We(e)[t.weekday-1]}function ei(t,e){return Ge(e)[t.month-1]}function ii(t,e){return Qe(e)[t.year<0?0:1]}function ni(t,e,i,n){if(i===void 0){i="always"}if(n===void 0){n=false}var s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]};var r=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&r){var o=t==="days";switch(e){case 1:return o?"tomorrow":"next "+s[t][0];case-1:return o?"yesterday":"last "+s[t][0];case 0:return o?"today":"this "+s[t][0]}}var a=Object.is(e,-0)||e<0,l=Math.abs(e),u=l===1,c=s[t],h=n?u?c[1]:c[2]||c[1]:u?s[t][0]:t;return a?l+" "+h+" ago":"in "+l+" "+h}function si(t,e){var i="";for(var n=m(t),s;!(s=n()).done;){var r=s.value;if(r.literal){i+=r.val}else{i+=e(r.val)}}return i}var ri={D:j,DD:C,DDD:O,DDDD:L,t:N,tt:R,ttt:P,tttt:F,T:D,TT:$,TTT:z,TTTT:U,f:V,ff:B,fff:W,ffff:J,F:G,FF:q,FFF:Z,FFFF:K};var oi=function(){t.create=function e(i,n){if(n===void 0){n={}}return new t(i,n)};t.parseFormat=function t(e){var i=null,n="",s=false;var r=[];for(var o=0;o<e.length;o++){var a=e.charAt(o);if(a==="'"){if(n.length>0){r.push({literal:s||/^\s+$/.test(n),val:n})}i=null;n="";s=!s}else if(s){n+=a}else if(a===i){n+=a}else{if(n.length>0){r.push({literal:/^\s+$/.test(n),val:n})}n=a;i=a}}if(n.length>0){r.push({literal:s||/^\s+$/.test(n),val:n})}return r};t.macroTokenToFormatOpts=function t(e){return ri[e]};function t(t,e){this.opts=e;this.loc=t;this.systemLoc=null}var e=t.prototype;e.formatWithSystemDefault=function t(e,i){if(this.systemLoc===null){this.systemLoc=this.loc.redefaultToSystem()}var n=this.systemLoc.dtFormatter(e,s({},this.opts,i));return n.format()};e.dtFormatter=function t(e,i){if(i===void 0){i={}}return this.loc.dtFormatter(e,s({},this.opts,i))};e.formatDateTime=function t(e,i){return this.dtFormatter(e,i).format()};e.formatDateTimeParts=function t(e,i){return this.dtFormatter(e,i).formatToParts()};e.formatInterval=function t(e,i){var n=this.dtFormatter(e.start,i);return n.dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())};e.resolvedOptions=function t(e,i){return this.dtFormatter(e,i).resolvedOptions()};e.num=function t(e,i){if(i===void 0){i=0}if(this.opts.forceSimple){return xe(e,i)}var n=s({},this.opts);if(i>0){n.padTo=i}return this.loc.numberFormatter(n).format(e)};e.formatDateTimeFromString=function e(i,n){var s=this;var r=this.loc.listingMode()==="en",o=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",a=function t(e,n){return s.loc.extract(i,e,n)},l=function t(e){if(i.isOffsetFixed&&i.offset===0&&e.allowZ){return"Z"}return i.isValid?i.zone.formatOffset(i.ts,e.format):""},u=function t(){return r?Xe(i):a({hour:"numeric",hourCycle:"h12"},"dayperiod")},c=function t(e,n){return r?ei(i,e):a(n?{month:e}:{month:e,day:"numeric"},"month")},h=function t(e,n){return r?ti(i,e):a(n?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday")},d=function e(n){var r=t.macroTokenToFormatOpts(n);if(r){return s.formatWithSystemDefault(i,r)}else{return n}},f=function t(e){return r?ii(i,e):a({era:e},"era")},p=function t(e){switch(e){case"S":return s.num(i.millisecond);case"u":case"SSS":return s.num(i.millisecond,3);case"s":return s.num(i.second);case"ss":return s.num(i.second,2);case"uu":return s.num(Math.floor(i.millisecond/10),2);case"uuu":return s.num(Math.floor(i.millisecond/100));case"m":return s.num(i.minute);case"mm":return s.num(i.minute,2);case"h":return s.num(i.hour%12===0?12:i.hour%12);case"hh":return s.num(i.hour%12===0?12:i.hour%12,2);case"H":return s.num(i.hour);case"HH":return s.num(i.hour,2);case"Z":return l({format:"narrow",allowZ:s.opts.allowZ});case"ZZ":return l({format:"short",allowZ:s.opts.allowZ});case"ZZZ":return l({format:"techie",allowZ:s.opts.allowZ});case"ZZZZ":return i.zone.offsetName(i.ts,{format:"short",locale:s.loc.locale});case"ZZZZZ":return i.zone.offsetName(i.ts,{format:"long",locale:s.loc.locale});case"z":return i.zoneName;case"a":return u();case"d":return o?a({day:"numeric"},"day"):s.num(i.day);case"dd":return o?a({day:"2-digit"},"day"):s.num(i.day,2);case"c":return s.num(i.weekday);case"ccc":return h("short",true);case"cccc":return h("long",true);case"ccccc":return h("narrow",true);case"E":return s.num(i.weekday);case"EEE":return h("short",false);case"EEEE":return h("long",false);case"EEEEE":return h("narrow",false);case"L":return o?a({month:"numeric",day:"numeric"},"month"):s.num(i.month);case"LL":return o?a({month:"2-digit",day:"numeric"},"month"):s.num(i.month,2);case"LLL":return c("short",true);case"LLLL":return c("long",true);case"LLLLL":return c("narrow",true);case"M":return o?a({month:"numeric"},"month"):s.num(i.month);case"MM":return o?a({month:"2-digit"},"month"):s.num(i.month,2);case"MMM":return c("short",false);case"MMMM":return c("long",false);case"MMMMM":return c("narrow",false);case"y":return o?a({year:"numeric"},"year"):s.num(i.year);case"yy":return o?a({year:"2-digit"},"year"):s.num(i.year.toString().slice(-2),2);case"yyyy":return o?a({year:"numeric"},"year"):s.num(i.year,4);case"yyyyyy":return o?a({year:"numeric"},"year"):s.num(i.year,6);case"G":return f("short");case"GG":return f("long");case"GGGGG":return f("narrow");case"kk":return s.num(i.weekYear.toString().slice(-2),2);case"kkkk":return s.num(i.weekYear,4);case"W":return s.num(i.weekNumber);case"WW":return s.num(i.weekNumber,2);case"n":return s.num(i.localWeekNumber);case"nn":return s.num(i.localWeekNumber,2);case"ii":return s.num(i.localWeekYear.toString().slice(-2),2);case"iiii":return s.num(i.localWeekYear,4);case"o":return s.num(i.ordinal);case"ooo":return s.num(i.ordinal,3);case"q":return s.num(i.quarter);case"qq":return s.num(i.quarter,2);case"X":return s.num(Math.floor(i.ts/1e3));case"x":return s.num(i.ts);default:return d(e)}};return si(t.parseFormat(n),p)};e.formatDurationFromString=function e(i,n){var s=this;var r=function t(e){switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},o=function t(e){return function(t){var i=r(t);if(i){return s.num(e.get(i),t.length)}else{return t}}},a=t.parseFormat(n),l=a.reduce((function(t,e){var i=e.literal,n=e.val;return i?t:t.concat(n)}),[]),u=i.shiftTo.apply(i,l.map(r).filter((function(t){return t})));return si(a,o(u))};return t}();var ai=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function li(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++){e[i]=arguments[i]}var n=e.reduce((function(t,e){return t+e.source}),"");return RegExp("^"+n+"$")}function ui(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++){e[i]=arguments[i]}return function(t){return e.reduce((function(e,i){var n=e[0],r=e[1],o=e[2];var a=i(t,o),l=a[0],u=a[1],c=a[2];return[s({},n,l),u||r,c]}),[{},null,1]).slice(0,2)}}function ci(t){if(t==null){return[null,null]}for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++){i[n-1]=arguments[n]}for(var s=0,r=i;s<r.length;s++){var o=r[s],a=o[0],l=o[1];var u=a.exec(t);if(u){return l(u)}}return[null,null]}function hi(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++){e[i]=arguments[i]}return function(t,i){var n={};var s;for(s=0;s<e.length;s++){n[e[s]]=_e(t[i+s])}return[n,null,i+s]}}var di=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/;var fi="(?:"+di.source+"?(?:\\[("+ai.source+")\\])?)?";var pi=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/;var mi=RegExp(""+pi.source+fi);var yi=RegExp("(?:T"+mi.source+")?");var gi=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/;var vi=/(\d{4})-?W(\d\d)(?:-?(\d))?/;var wi=/(\d{4})-?(\d{3})/;var bi=hi("weekYear","weekNumber","weekDay");var Si=hi("year","ordinal");var xi=/(\d{4})-(\d\d)-(\d\d)/;var _i=RegExp(pi.source+" ?(?:"+di.source+"|("+ai.source+"))?");var Mi=RegExp("(?: "+_i.source+")?");function ki(t,e,i){var n=t[e];return le(n)?i:_e(n)}function Ti(t,e){var i={year:ki(t,e),month:ki(t,e+1,1),day:ki(t,e+2,1)};return[i,null,e+3]}function Ai(t,e){var i={hours:ki(t,e,0),minutes:ki(t,e+1,0),seconds:ki(t,e+2,0),milliseconds:ke(t[e+3])};return[i,null,e+4]}function Ii(t,e){var i=!t[e]&&!t[e+1],n=Re(t[e+1],t[e+2]),s=i?null:Lt.instance(n);return[{},s,e+3]}function ji(t,e){var i=t[e]?ot.create(t[e]):null;return[{},i,e+1]}var Ci=RegExp("^T?"+pi.source+"$");var Ei=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Oi(t){var e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8];var c=e[0]==="-";var h=l&&l[0]==="-";var d=function t(e,i){if(i===void 0){i=false}return e!==undefined&&(i||e&&c)?-e:e};return[{years:d(Me(i)),months:d(Me(n)),weeks:d(Me(s)),days:d(Me(r)),hours:d(Me(o)),minutes:d(Me(a)),seconds:d(Me(l),l==="-0"),milliseconds:d(ke(u),h)}]}var Li={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Ni(t,e,i,n,s,r,o){var a={year:e.length===2?Le(_e(e)):_e(e),month:Ue.indexOf(i)+1,day:_e(n),hour:_e(s),minute:_e(r)};if(o)a.second=_e(o);if(t){a.weekday=t.length>3?Be.indexOf(t)+1:qe.indexOf(t)+1}return a}var Ri=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Pi(t){var e=t[1],i=t[2],n=t[3],s=t[4],r=t[5],o=t[6],a=t[7],l=t[8],u=t[9],c=t[10],h=t[11],d=Ni(e,s,n,i,r,o,a);var f;if(l){f=Li[l]}else if(u){f=0}else{f=Re(c,h)}return[d,new Lt(f)]}function Fi(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var Di=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,$i=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,zi=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Ui(t){var e=t[1],i=t[2],n=t[3],s=t[4],r=t[5],o=t[6],a=t[7],l=Ni(e,s,n,i,r,o,a);return[l,Lt.utcInstance]}function Vi(t){var e=t[1],i=t[2],n=t[3],s=t[4],r=t[5],o=t[6],a=t[7],l=Ni(e,a,i,n,s,r,o);return[l,Lt.utcInstance]}var Gi=li(gi,yi);var Bi=li(vi,yi);var qi=li(wi,yi);var Hi=li(mi);var Wi=ui(Ti,Ai,Ii,ji);var Zi=ui(bi,Ai,Ii,ji);var Ji=ui(Si,Ai,Ii,ji);var Ki=ui(Ai,Ii,ji);function Yi(t){return ci(t,[Gi,Wi],[Bi,Zi],[qi,Ji],[Hi,Ki])}function Qi(t){return ci(Fi(t),[Ri,Pi])}function Xi(t){return ci(t,[Di,Ui],[$i,Ui],[zi,Vi])}function tn(t){return ci(t,[Ei,Oi])}var en=ui(Ai);function nn(t){return ci(t,[Ci,en])}var sn=li(xi,Mi);var rn=li(_i);var on=ui(Ai,Ii,ji);function an(t){return ci(t,[sn,Wi],[rn,on])}var ln="Invalid Duration";var un={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},cn=s({years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3}},un),hn=146097/400,dn=146097/4800,fn=s({years:{quarters:4,months:12,weeks:hn/7,days:hn,hours:hn*24,minutes:hn*24*60,seconds:hn*24*60*60,milliseconds:hn*24*60*60*1e3},quarters:{months:3,weeks:hn/28,days:hn/4,hours:hn*24/4,minutes:hn*24*60/4,seconds:hn*24*60*60/4,milliseconds:hn*24*60*60*1e3/4},months:{weeks:dn/7,days:dn,hours:dn*24,minutes:dn*24*60,seconds:dn*24*60*60,milliseconds:dn*24*60*60*1e3}},un);var pn=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"];var mn=pn.slice(0).reverse();function yn(t,e,i){if(i===void 0){i=false}var n={values:i?e.values:s({},t.values,e.values||{}),loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new bn(n)}function gn(t,e){var i;var n=(i=e.milliseconds)!=null?i:0;for(var s=m(mn.slice(1)),r;!(r=s()).done;){var o=r.value;if(e[o]){n+=e[o]*t[o]["milliseconds"]}}return n}function vn(t,e){var i=gn(t,e)<0?-1:1;pn.reduceRight((function(n,s){if(!le(e[s])){if(n){var r=e[n]*i;var o=t[s][n];var a=Math.floor(r/o);e[s]+=a*i;e[n]-=a*o*i}return s}else{return n}}),null);pn.reduce((function(i,n){if(!le(e[n])){if(i){var s=e[i]%1;e[i]-=s;e[n]+=s*t[i][n]}return n}else{return i}}),null)}function wn(t){var e={};for(var i=0,n=Object.entries(t);i<n.length;i++){var s=n[i],r=s[0],o=s[1];if(o!==0){e[r]=o}}return e}var bn=function(t){function e(t){var e=t.conversionAccuracy==="longterm"||false;var i=e?fn:cn;if(t.matrix){i=t.matrix}this.values=t.values;this.loc=t.loc||Et.create();this.conversionAccuracy=e?"longterm":"casual";this.invalid=t.invalid||null;this.matrix=i;this.isLuxonDuration=true}e.fromMillis=function t(i,n){return e.fromObject({milliseconds:i},n)};e.fromObject=function t(i,n){if(n===void 0){n={}}if(i==null||typeof i!=="object"){throw new M("Duration.fromObject: argument expected to be an object, got "+(i===null?"null":typeof i))}return new e({values:Fe(i,e.normalizeUnit),loc:Et.fromObject(n),conversionAccuracy:n.conversionAccuracy,matrix:n.matrix})};e.fromDurationLike=function t(i){if(ue(i)){return e.fromMillis(i)}else if(e.isDuration(i)){return i}else if(typeof i==="object"){return e.fromObject(i)}else{throw new M("Unknown duration argument "+i+" of type "+typeof i)}};e.fromISO=function t(i,n){var s=tn(i),r=s[0];if(r){return e.fromObject(r,n)}else{return e.invalid("unparsable",'the input "'+i+"\" can't be parsed as ISO 8601")}};e.fromISOTime=function t(i,n){var s=nn(i),r=s[0];if(r){return e.fromObject(r,n)}else{return e.invalid("unparsable",'the input "'+i+"\" can't be parsed as ISO 8601")}};e.invalid=function t(i,n){if(n===void 0){n=null}if(!i){throw new M("need to specify a reason the Duration is invalid")}var t=i instanceof qt?i:new qt(i,n);if(Bt.throwOnInvalid){throw new S(t)}else{return new e({invalid:t})}};e.normalizeUnit=function t(e){var i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!i)throw new _(e);return i};e.isDuration=function t(e){return e&&e.isLuxonDuration||false};var i=e.prototype;i.toFormat=function t(e,i){if(i===void 0){i={}}var n=s({},i,{floor:i.round!==false&&i.floor!==false});return this.isValid?oi.create(this.loc,n).formatDurationFromString(this,e):ln};i.toHuman=function t(e){var i=this;if(e===void 0){e={}}if(!this.isValid)return ln;var n=pn.map((function(t){var n=i.values[t];if(le(n)){return null}return i.loc.numberFormatter(s({style:"unit",unitDisplay:"long"},e,{unit:t.slice(0,-1)})).format(n)})).filter((function(t){return t}));return this.loc.listFormatter(s({type:"conjunction",style:e.listStyle||"narrow"},e)).format(n)};i.toObject=function t(){if(!this.isValid)return{};return s({},this.values)};i.toISO=function t(){if(!this.isValid)return null;var e="P";if(this.years!==0)e+=this.years+"Y";if(this.months!==0||this.quarters!==0)e+=this.months+this.quarters*3+"M";if(this.weeks!==0)e+=this.weeks+"W";if(this.days!==0)e+=this.days+"D";if(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)e+="T";if(this.hours!==0)e+=this.hours+"H";if(this.minutes!==0)e+=this.minutes+"M";if(this.seconds!==0||this.milliseconds!==0)e+=Te(this.seconds+this.milliseconds/1e3,3)+"S";if(e==="P")e+="T0S";return e};i.toISOTime=function t(e){if(e===void 0){e={}}if(!this.isValid)return null;var i=this.toMillis();if(i<0||i>=864e5)return null;e=s({suppressMilliseconds:false,suppressSeconds:false,includePrefix:false,format:"extended"},e,{includeOffset:false});var n=Is.fromMillis(i,{zone:"UTC"});return n.toISOTime(e)};i.toJSON=function t(){return this.toISO()};i.toString=function t(){return this.toISO()};i[t]=function(){if(this.isValid){return"Duration { values: "+JSON.stringify(this.values)+" }"}else{return"Duration { Invalid, reason: "+this.invalidReason+" }"}};i.toMillis=function t(){if(!this.isValid)return NaN;return gn(this.matrix,this.values)};i.valueOf=function t(){return this.toMillis()};i.plus=function t(i){if(!this.isValid)return this;var n=e.fromDurationLike(i),s={};for(var r=0,o=pn;r<o.length;r++){var a=o[r];if(ve(n.values,a)||ve(this.values,a)){s[a]=n.get(a)+this.get(a)}}return yn(this,{values:s},true)};i.minus=function t(i){if(!this.isValid)return this;var n=e.fromDurationLike(i);return this.plus(n.negate())};i.mapUnits=function t(e){if(!this.isValid)return this;var i={};for(var n=0,s=Object.keys(this.values);n<s.length;n++){var r=s[n];i[r]=Pe(e(this.values[r],r))}return yn(this,{values:i},true)};i.get=function t(i){return this[e.normalizeUnit(i)]};i.set=function t(i){if(!this.isValid)return this;var n=s({},this.values,Fe(i,e.normalizeUnit));return yn(this,{values:n})};i.reconfigure=function t(e){var i=e===void 0?{}:e,n=i.locale,s=i.numberingSystem,r=i.conversionAccuracy,o=i.matrix;var a=this.loc.clone({locale:n,numberingSystem:s});var l={loc:a,matrix:o,conversionAccuracy:r};return yn(this,l)};i.as=function t(e){return this.isValid?this.shiftTo(e).get(e):NaN};i.normalize=function t(){if(!this.isValid)return this;var e=this.toObject();vn(this.matrix,e);return yn(this,{values:e},true)};i.rescale=function t(){if(!this.isValid)return this;var e=wn(this.normalize().shiftToAll().toObject());return yn(this,{values:e},true)};i.shiftTo=function t(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++){n[s]=arguments[s]}if(!this.isValid)return this;if(n.length===0){return this}n=n.map((function(t){return e.normalizeUnit(t)}));var r={},o={},a=this.toObject();var l;for(var u=0,c=pn;u<c.length;u++){var h=c[u];if(n.indexOf(h)>=0){l=h;var d=0;for(var f in o){d+=this.matrix[f][h]*o[f];o[f]=0}if(ue(a[h])){d+=a[h]}var p=Math.trunc(d);r[h]=p;o[h]=(d*1e3-p*1e3)/1e3}else if(ue(a[h])){o[h]=a[h]}}for(var m in o){if(o[m]!==0){r[l]+=m===l?o[m]:o[m]/this.matrix[l][m]}}vn(this.matrix,r);return yn(this,{values:r},true)};i.shiftToAll=function t(){if(!this.isValid)return this;return this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds")};i.negate=function t(){if(!this.isValid)return this;var e={};for(var i=0,n=Object.keys(this.values);i<n.length;i++){var s=n[i];e[s]=this.values[s]===0?0:-this.values[s]}return yn(this,{values:e},true)};i.equals=function t(e){if(!this.isValid||!e.isValid){return false}if(!this.loc.equals(e.loc)){return false}function i(t,e){if(t===undefined||t===0)return e===undefined||e===0;return t===e}for(var n=0,s=pn;n<s.length;n++){var r=s[n];if(!i(this.values[r],e.values[r])){return false}}return true};n(e,[{key:"locale",get:function t(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function t(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function t(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function t(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function t(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function t(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function t(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function t(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function t(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function t(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function t(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function t(){return this.invalid===null}},{key:"invalidReason",get:function t(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function t(){return this.invalid?this.invalid.explanation:null}}]);return e}(Symbol.for("nodejs.util.inspect.custom"));var Sn="Invalid Interval";function xn(t,e){if(!t||!t.isValid){return _n.invalid("missing or invalid start")}else if(!e||!e.isValid){return _n.invalid("missing or invalid end")}else if(e<t){return _n.invalid("end before start","The end of an interval must be after its start, but you had start="+t.toISO()+" and end="+e.toISO())}else{return null}}var _n=function(t){function e(t){this.s=t.start;this.e=t.end;this.invalid=t.invalid||null;this.isLuxonInterval=true}e.invalid=function t(i,n){if(n===void 0){n=null}if(!i){throw new M("need to specify a reason the Interval is invalid")}var t=i instanceof qt?i:new qt(i,n);if(Bt.throwOnInvalid){throw new b(t)}else{return new e({invalid:t})}};e.fromDateTimes=function t(i,n){var s=js(i),r=js(n);var o=xn(s,r);if(o==null){return new e({start:s,end:r})}else{return o}};e.after=function t(i,n){var s=bn.fromDurationLike(n),r=js(i);return e.fromDateTimes(r,r.plus(s))};e.before=function t(i,n){var s=bn.fromDurationLike(n),r=js(i);return e.fromDateTimes(r.minus(s),r)};e.fromISO=function t(i,n){var s=(i||"").split("/",2),r=s[0],o=s[1];if(r&&o){var a,l;try{a=Is.fromISO(r,n);l=a.isValid}catch(o){l=false}var u,c;try{u=Is.fromISO(o,n);c=u.isValid}catch(o){c=false}if(l&&c){return e.fromDateTimes(a,u)}if(l){var h=bn.fromISO(o,n);if(h.isValid){return e.after(a,h)}}else if(c){var d=bn.fromISO(r,n);if(d.isValid){return e.before(u,d)}}}return e.invalid("unparsable",'the input "'+i+"\" can't be parsed as ISO 8601")};e.isInterval=function t(e){return e&&e.isLuxonInterval||false};var i=e.prototype;i.length=function t(e){if(e===void 0){e="milliseconds"}return this.isValid?this.toDuration.apply(this,[e]).get(e):NaN};i.count=function t(e,i){if(e===void 0){e="milliseconds"}if(!this.isValid)return NaN;var n=this.start.startOf(e,i);var s;if(i!=null&&i.useLocaleWeeks){s=this.end.reconfigure({locale:n.locale})}else{s=this.end}s=s.startOf(e,i);return Math.floor(s.diff(n,e).get(e))+(s.valueOf()!==this.end.valueOf())};i.hasSame=function t(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):false};i.isEmpty=function t(){return this.s.valueOf()===this.e.valueOf()};i.isAfter=function t(e){if(!this.isValid)return false;return this.s>e};i.isBefore=function t(e){if(!this.isValid)return false;return this.e<=e};i.contains=function t(e){if(!this.isValid)return false;return this.s<=e&&this.e>e};i.set=function t(i){var n=i===void 0?{}:i,s=n.start,r=n.end;if(!this.isValid)return this;return e.fromDateTimes(s||this.s,r||this.e)};i.splitAt=function t(){var i=this;if(!this.isValid)return[];for(var n=arguments.length,s=new Array(n),r=0;r<n;r++){s[r]=arguments[r]}var o=s.map(js).filter((function(t){return i.contains(t)})).sort((function(t,e){return t.toMillis()-e.toMillis()})),a=[];var l=this.s,u=0;while(l<this.e){var c=o[u]||this.e,h=+c>+this.e?this.e:c;a.push(e.fromDateTimes(l,h));l=h;u+=1}return a};i.splitBy=function t(i){var n=bn.fromDurationLike(i);if(!this.isValid||!n.isValid||n.as("milliseconds")===0){return[]}var s=this.s,r=1,o;var a=[];while(s<this.e){var l=this.start.plus(n.mapUnits((function(t){return t*r})));o=+l>+this.e?this.e:l;a.push(e.fromDateTimes(s,o));s=o;r+=1}return a};i.divideEqually=function t(e){if(!this.isValid)return[];return this.splitBy(this.length()/e).slice(0,e)};i.overlaps=function t(e){return this.e>e.s&&this.s<e.e};i.abutsStart=function t(e){if(!this.isValid)return false;return+this.e===+e.s};i.abutsEnd=function t(e){if(!this.isValid)return false;return+e.e===+this.s};i.engulfs=function t(e){if(!this.isValid)return false;return this.s<=e.s&&this.e>=e.e};i.equals=function t(e){if(!this.isValid||!e.isValid){return false}return this.s.equals(e.s)&&this.e.equals(e.e)};i.intersection=function t(i){if(!this.isValid)return this;var n=this.s>i.s?this.s:i.s,s=this.e<i.e?this.e:i.e;if(n>=s){return null}else{return e.fromDateTimes(n,s)}};i.union=function t(i){if(!this.isValid)return this;var n=this.s<i.s?this.s:i.s,s=this.e>i.e?this.e:i.e;return e.fromDateTimes(n,s)};e.merge=function t(e){var i=e.sort((function(t,e){return t.s-e.s})).reduce((function(t,e){var i=t[0],n=t[1];if(!n){return[i,e]}else if(n.overlaps(e)||n.abutsStart(e)){return[i,n.union(e)]}else{return[i.concat([n]),e]}}),[[],null]),n=i[0],s=i[1];if(s){n.push(s)}return n};e.xor=function t(i){var n;var s=null,r=0;var o=[],a=i.map((function(t){return[{time:t.s,type:"s"},{time:t.e,type:"e"}]})),l=(n=Array.prototype).concat.apply(n,a),u=l.sort((function(t,e){return t.time-e.time}));for(var c=m(u),h;!(h=c()).done;){var d=h.value;r+=d.type==="s"?1:-1;if(r===1){s=d.time}else{if(s&&+s!==+d.time){o.push(e.fromDateTimes(s,d.time))}s=null}}return e.merge(o)};i.difference=function t(){var i=this;for(var n=arguments.length,s=new Array(n),r=0;r<n;r++){s[r]=arguments[r]}return e.xor([this].concat(s)).map((function(t){return i.intersection(t)})).filter((function(t){return t&&!t.isEmpty()}))};i.toString=function t(){if(!this.isValid)return Sn;return"["+this.s.toISO()+" – "+this.e.toISO()+")"};i[t]=function(){if(this.isValid){return"Interval { start: "+this.s.toISO()+", end: "+this.e.toISO()+" }"}else{return"Interval { Invalid, reason: "+this.invalidReason+" }"}};i.toLocaleString=function t(e,i){if(e===void 0){e=j}if(i===void 0){i={}}return this.isValid?oi.create(this.s.loc.clone(i),e).formatInterval(this):Sn};i.toISO=function t(e){if(!this.isValid)return Sn;return this.s.toISO(e)+"/"+this.e.toISO(e)};i.toISODate=function t(){if(!this.isValid)return Sn;return this.s.toISODate()+"/"+this.e.toISODate()};i.toISOTime=function t(e){if(!this.isValid)return Sn;return this.s.toISOTime(e)+"/"+this.e.toISOTime(e)};i.toFormat=function t(e,i){var n=i===void 0?{}:i,s=n.separator,r=s===void 0?" – ":s;if(!this.isValid)return Sn;return""+this.s.toFormat(e)+r+this.e.toFormat(e)};i.toDuration=function t(e,i){if(!this.isValid){return bn.invalid(this.invalidReason)}return this.e.diff(this.s,e,i)};i.mapEndpoints=function t(i){return e.fromDateTimes(i(this.s),i(this.e))};n(e,[{key:"start",get:function t(){return this.isValid?this.s:null}},{key:"end",get:function t(){return this.isValid?this.e:null}},{key:"isValid",get:function t(){return this.invalidReason===null}},{key:"invalidReason",get:function t(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function t(){return this.invalid?this.invalid.explanation:null}}]);return e}(Symbol.for("nodejs.util.inspect.custom"));var Mn=function(){function t(){}t.hasDST=function t(e){if(e===void 0){e=Bt.defaultZone}var i=Is.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset};t.isValidIANAZone=function t(e){return ot.isValidZone(e)};t.normalizeZone=function t(e){return Rt(e,Bt.defaultZone)};t.getStartOfWeek=function t(e){var i=e===void 0?{}:e,n=i.locale,s=n===void 0?null:n,r=i.locObj,o=r===void 0?null:r;return(o||Et.create(s)).getStartOfWeek()};t.getMinimumDaysInFirstWeek=function t(e){var i=e===void 0?{}:e,n=i.locale,s=n===void 0?null:n,r=i.locObj,o=r===void 0?null:r;return(o||Et.create(s)).getMinDaysInFirstWeek()};t.getWeekendWeekdays=function t(e){var i=e===void 0?{}:e,n=i.locale,s=n===void 0?null:n,r=i.locObj,o=r===void 0?null:r;return(o||Et.create(s)).getWeekendDays().slice()};t.months=function t(e,i){if(e===void 0){e="long"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=n.locObj,u=l===void 0?null:l,c=n.outputCalendar,h=c===void 0?"gregory":c;return(u||Et.create(r,a,h)).months(e)};t.monthsFormat=function t(e,i){if(e===void 0){e="long"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=n.locObj,u=l===void 0?null:l,c=n.outputCalendar,h=c===void 0?"gregory":c;return(u||Et.create(r,a,h)).months(e,true)};t.weekdays=function t(e,i){if(e===void 0){e="long"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=n.locObj,u=l===void 0?null:l;return(u||Et.create(r,a,null)).weekdays(e)};t.weekdaysFormat=function t(e,i){if(e===void 0){e="long"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=n.locObj,u=l===void 0?null:l;return(u||Et.create(r,a,null)).weekdays(e,true)};t.meridiems=function t(e){var i=e===void 0?{}:e,n=i.locale,s=n===void 0?null:n;return Et.create(s).meridiems()};t.eras=function t(e,i){if(e===void 0){e="short"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s;return Et.create(r,null,"gregory").eras(e)};t.features=function t(){return{relative:fe(),localeWeek:pe()}};return t}();function kn(t,e){var i=function t(e){return e.toUTC(0,{keepLocalTime:true}).startOf("day").valueOf()},n=i(e)-i(t);return Math.floor(bn.fromMillis(n).as("days"))}function Tn(t,e,i){var n=[["years",function(t,e){return e.year-t.year}],["quarters",function(t,e){return e.quarter-t.quarter+(e.year-t.year)*4}],["months",function(t,e){return e.month-t.month+(e.year-t.year)*12}],["weeks",function(t,e){var i=kn(t,e);return(i-i%7)/7}],["days",kn]];var s={};var r=t;var o,a;for(var l=0,u=n;l<u.length;l++){var c=u[l],h=c[0],d=c[1];if(i.indexOf(h)>=0){o=h;s[h]=d(t,e);a=r.plus(s);if(a>e){s[h]--;t=r.plus(s);if(t>e){a=t;s[h]--;t=r.plus(s)}}else{t=a}}}return[t,s,a,o]}function An(t,e,i,n){var s=Tn(t,e,i),r=s[0],o=s[1],a=s[2],l=s[3];var u=e-r;var c=i.filter((function(t){return["hours","minutes","seconds","milliseconds"].indexOf(t)>=0}));if(c.length===0){if(a<e){var h;a=r.plus((h={},h[l]=1,h))}if(a!==r){o[l]=(o[l]||0)+u/(a-r)}}var d=bn.fromObject(o,n);if(c.length>0){var f;return(f=bn.fromMillis(u,n)).shiftTo.apply(f,c).plus(d)}else{return d}}var In={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"};var jn={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]};var Cn=In.hanidec.replace(/[\[|\]]/g,"").split("");function En(t){var e=parseInt(t,10);if(isNaN(e)){e="";for(var i=0;i<t.length;i++){var n=t.charCodeAt(i);if(t[i].search(In.hanidec)!==-1){e+=Cn.indexOf(t[i])}else{for(var s in jn){var r=jn[s],o=r[0],a=r[1];if(n>=o&&n<=a){e+=n-o}}}}return parseInt(e,10)}else{return e}}function On(t,e){var i=t.numberingSystem;if(e===void 0){e=""}return new RegExp(""+In[i||"latn"]+e)}var Ln="missing Intl.DateTimeFormat.formatToParts support";function Nn(t,e){if(e===void 0){e=function t(e){return e}}return{regex:t,deser:function t(i){var n=i[0];return e(En(n))}}}var Rn=String.fromCharCode(160);var Pn="[ "+Rn+"]";var Fn=new RegExp(Pn,"g");function Dn(t){return t.replace(/\./g,"\\.?").replace(Fn,Pn)}function $n(t){return t.replace(/\./g,"").replace(Fn," ").toLowerCase()}function zn(t,e){if(t===null){return null}else{return{regex:RegExp(t.map(Dn).join("|")),deser:function i(n){var s=n[0];return t.findIndex((function(t){return $n(s)===$n(t)}))+e}}}}function Un(t,e){return{regex:t,deser:function t(e){var i=e[1],n=e[2];return Re(i,n)},groups:e}}function Vn(t){return{regex:t,deser:function t(e){var i=e[0];return i}}}function Gn(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Bn(t,e){var i=On(e),n=On(e,"{2}"),s=On(e,"{3}"),r=On(e,"{4}"),o=On(e,"{6}"),a=On(e,"{1,2}"),l=On(e,"{1,3}"),u=On(e,"{1,6}"),c=On(e,"{1,9}"),h=On(e,"{2,4}"),d=On(e,"{4,6}"),f=function t(e){return{regex:RegExp(Gn(e.val)),deser:function t(e){var i=e[0];return i},literal:true}},p=function p(m){if(t.literal){return f(m)}switch(m.val){case"G":return zn(e.eras("short"),0);case"GG":return zn(e.eras("long"),0);case"y":return Nn(u);case"yy":return Nn(h,Le);case"yyyy":return Nn(r);case"yyyyy":return Nn(d);case"yyyyyy":return Nn(o);case"M":return Nn(a);case"MM":return Nn(n);case"MMM":return zn(e.months("short",true),1);case"MMMM":return zn(e.months("long",true),1);case"L":return Nn(a);case"LL":return Nn(n);case"LLL":return zn(e.months("short",false),1);case"LLLL":return zn(e.months("long",false),1);case"d":return Nn(a);case"dd":return Nn(n);case"o":return Nn(l);case"ooo":return Nn(s);case"HH":return Nn(n);case"H":return Nn(a);case"hh":return Nn(n);case"h":return Nn(a);case"mm":return Nn(n);case"m":return Nn(a);case"q":return Nn(a);case"qq":return Nn(n);case"s":return Nn(a);case"ss":return Nn(n);case"S":return Nn(l);case"SSS":return Nn(s);case"u":return Vn(c);case"uu":return Vn(a);case"uuu":return Nn(i);case"a":return zn(e.meridiems(),0);case"kkkk":return Nn(r);case"kk":return Nn(h,Le);case"W":return Nn(a);case"WW":return Nn(n);case"E":case"c":return Nn(i);case"EEE":return zn(e.weekdays("short",false),1);case"EEEE":return zn(e.weekdays("long",false),1);case"ccc":return zn(e.weekdays("short",true),1);case"cccc":return zn(e.weekdays("long",true),1);case"Z":case"ZZ":return Un(new RegExp("([+-]"+a.source+")(?::("+n.source+"))?"),2);case"ZZZ":return Un(new RegExp("([+-]"+a.source+")("+n.source+")?"),2);case"z":return Vn(/[a-z_+-/]{1,256}?/i);case" ":return Vn(/[^\S\n\r]/);default:return f(m)}};var m=p(t)||{invalidReason:Ln};m.token=t;return m}var qn={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function Hn(t,e,i){var n=t.type,s=t.value;if(n==="literal"){var r=/^\s+$/.test(s);return{literal:!r,val:r?" ":s}}var o=e[n];var a=n;if(n==="hour"){if(e.hour12!=null){a=e.hour12?"hour12":"hour24"}else if(e.hourCycle!=null){if(e.hourCycle==="h11"||e.hourCycle==="h12"){a="hour12"}else{a="hour24"}}else{a=i.hour12?"hour12":"hour24"}}var l=qn[a];if(typeof l==="object"){l=l[o]}if(l){return{literal:false,val:l}}return undefined}function Wn(t){var e=t.map((function(t){return t.regex})).reduce((function(t,e){return t+"("+e.source+")"}),"");return["^"+e+"$",t]}function Zn(t,e,i){var n=t.match(e);if(n){var s={};var r=1;for(var o in i){if(ve(i,o)){var a=i[o],l=a.groups?a.groups+1:1;if(!a.literal&&a.token){s[a.token.val[0]]=a.deser(n.slice(r,r+l))}r+=l}}return[n,s]}else{return[n,{}]}}function Jn(t){var e=function t(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};var i=null;var n;if(!le(t.z)){i=ot.create(t.z)}if(!le(t.Z)){if(!i){i=new Lt(t.Z)}n=t.Z}if(!le(t.q)){t.M=(t.q-1)*3+1}if(!le(t.h)){if(t.h<12&&t.a===1){t.h+=12}else if(t.h===12&&t.a===0){t.h=0}}if(t.G===0&&t.y){t.y=-t.y}if(!le(t.u)){t.S=ke(t.u)}var s=Object.keys(t).reduce((function(i,n){var s=e(n);if(s){i[s]=t[n]}return i}),{});return[s,i,n]}var Kn=null;function Yn(){if(!Kn){Kn=Is.fromMillis(1555555555555)}return Kn}function Qn(t,e){if(t.literal){return t}var i=oi.macroTokenToFormatOpts(t.val);var n=is(i,e);if(n==null||n.includes(undefined)){return t}return n}function Xn(t,e){var i;return(i=Array.prototype).concat.apply(i,t.map((function(t){return Qn(t,e)})))}function ts(t,e,i){var n=Xn(oi.parseFormat(i),t),s=n.map((function(e){return Bn(e,t)})),r=s.find((function(t){return t.invalidReason}));if(r){return{input:e,tokens:n,invalidReason:r.invalidReason}}else{var o=Wn(s),a=o[0],l=o[1],u=RegExp(a,"i"),c=Zn(e,u,l),h=c[0],d=c[1],f=d?Jn(d):[null,null,undefined],p=f[0],m=f[1],y=f[2];if(ve(d,"a")&&ve(d,"H")){throw new x("Can't include meridiem when specifying 24-hour format")}return{input:e,tokens:n,regex:u,rawMatches:h,matches:d,result:p,zone:m,specificOffset:y}}}function es(t,e,i){var n=ts(t,e,i),s=n.result,r=n.zone,o=n.specificOffset,a=n.invalidReason;return[s,r,o,a]}function is(t,e){if(!t){return null}var i=oi.create(e,t);var n=i.dtFormatter(Yn());var s=n.formatToParts();var r=n.resolvedOptions();return s.map((function(e){return Hn(e,t,r)}))}var ns="Invalid DateTime";var ss=864e13;function rs(t){return new qt("unsupported zone",'the zone "'+t.name+'" is not supported')}function os(t){if(t.weekData===null){t.weekData=Xt(t.c)}return t.weekData}function as(t){if(t.localWeekData===null){t.localWeekData=Xt(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())}return t.localWeekData}function ls(t,e){var i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Is(s({},i,e,{old:i}))}function us(t,e,i){var n=t-e*60*1e3;var s=i.offset(n);if(e===s){return[n,e]}n-=(s-e)*60*1e3;var r=i.offset(n);if(s===r){return[n,s]}return[t-Math.min(s,r)*60*1e3,Math.max(s,r)]}function cs(t,e){t+=e*60*1e3;var i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function hs(t,e,i){return us(Ce(t),e,i)}function ds(t,e){var i=t.o,n=t.c.year+Math.trunc(e.years),r=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,o=s({},t.c,{year:n,month:r,day:Math.min(t.c.day,je(n,r))+Math.trunc(e.days)+Math.trunc(e.weeks)*7}),a=bn.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),l=Ce(o);var u=us(l,i,t.zone),c=u[0],h=u[1];if(a!==0){c+=a;h=t.zone.offset(c)}return{ts:c,o:h}}function fs(t,e,i,n,r,o){var a=i.setZone,l=i.zone;if(t&&Object.keys(t).length!==0||e){var u=e||l,c=Is.fromObject(t,s({},i,{zone:u,specificOffset:o}));return a?c:c.setZone(l)}else{return Is.invalid(new qt("unparsable",'the input "'+r+"\" can't be parsed as "+n))}}function ps(t,e,i){if(i===void 0){i=true}return t.isValid?oi.create(Et.create("en-US"),{allowZ:i,forceSimple:true}).formatDateTimeFromString(t,e):null}function ms(t,e){var i=t.c.year>9999||t.c.year<0;var n="";if(i&&t.c.year>=0)n+="+";n+=xe(t.c.year,i?6:4);if(e){n+="-";n+=xe(t.c.month);n+="-";n+=xe(t.c.day)}else{n+=xe(t.c.month);n+=xe(t.c.day)}return n}function ys(t,e,i,n,s,r){var o=xe(t.c.hour);if(e){o+=":";o+=xe(t.c.minute);if(t.c.millisecond!==0||t.c.second!==0||!i){o+=":"}}else{o+=xe(t.c.minute)}if(t.c.millisecond!==0||t.c.second!==0||!i){o+=xe(t.c.second);if(t.c.millisecond!==0||!n){o+=".";o+=xe(t.c.millisecond,3)}}if(s){if(t.isOffsetFixed&&t.offset===0&&!r){o+="Z"}else if(t.o<0){o+="-";o+=xe(Math.trunc(-t.o/60));o+=":";o+=xe(Math.trunc(-t.o%60))}else{o+="+";o+=xe(Math.trunc(t.o/60));o+=":";o+=xe(Math.trunc(t.o%60))}}if(r){o+="["+t.zone.ianaName+"]"}return o}var gs={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},vs={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},ws={ordinal:1,hour:0,minute:0,second:0,millisecond:0};var bs=["year","month","day","hour","minute","second","millisecond"],Ss=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],xs=["year","ordinal","hour","minute","second","millisecond"];function _s(t){var e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new _(t);return e}function Ms(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return _s(t)}}function ks(t,e){var i=Rt(e.zone,Bt.defaultZone),n=Et.fromObject(e),s=Bt.now();var r,o;if(!le(t.year)){for(var a=0,l=bs;a<l.length;a++){var u=l[a];if(le(t[u])){t[u]=gs[u]}}var c=oe(t)||ae(t);if(c){return Is.invalid(c)}var h=i.offset(s);var d=hs(t,h,i);r=d[0];o=d[1]}else{r=s}return new Is({ts:r,zone:i,loc:n,o})}function Ts(t,e,i){var n=le(i.round)?true:i.round,s=function t(s,r){s=Te(s,n||i.calendary?0:2,true);var o=e.loc.clone(i).relFormatter(i);return o.format(s,r)},r=function n(s){if(i.calendary){if(!e.hasSame(t,s)){return e.startOf(s).diff(t.startOf(s),s).get(s)}else return 0}else{return e.diff(t,s).get(s)}};if(i.unit){return s(r(i.unit),i.unit)}for(var o=m(i.units),a;!(a=o()).done;){var l=a.value;var u=r(l);if(Math.abs(u)>=1){return s(u,l)}}return s(t>e?-0:0,i.units[i.units.length-1])}function As(t){var e={},i;if(t.length>0&&typeof t[t.length-1]==="object"){e=t[t.length-1];i=Array.from(t).slice(0,t.length-1)}else{i=Array.from(t)}return[e,i]}var Is=function(t){function e(t){var e=t.zone||Bt.defaultZone;var i=t.invalid||(Number.isNaN(t.ts)?new qt("invalid input"):null)||(!e.isValid?rs(e):null);this.ts=le(t.ts)?Bt.now():t.ts;var n=null,s=null;if(!i){var r=t.old&&t.old.ts===this.ts&&t.old.zone.equals(e);if(r){var o=[t.old.c,t.old.o];n=o[0];s=o[1]}else{var a=e.offset(this.ts);n=cs(this.ts,a);i=Number.isNaN(n.year)?new qt("invalid input"):null;n=i?null:n;s=i?null:a}}this._zone=e;this.loc=t.loc||Et.create();this.invalid=i;this.weekData=null;this.localWeekData=null;this.c=n;this.o=s;this.isLuxonDateTime=true}e.now=function t(){return new e({})};e.local=function t(){var e=As(arguments),i=e[0],n=e[1],s=n[0],r=n[1],o=n[2],a=n[3],l=n[4],u=n[5],c=n[6];return ks({year:s,month:r,day:o,hour:a,minute:l,second:u,millisecond:c},i)};e.utc=function t(){var e=As(arguments),i=e[0],n=e[1],s=n[0],r=n[1],o=n[2],a=n[3],l=n[4],u=n[5],c=n[6];i.zone=Lt.utcInstance;return ks({year:s,month:r,day:o,hour:a,minute:l,second:u,millisecond:c},i)};e.fromJSDate=function t(i,n){if(n===void 0){n={}}var s=de(i)?i.valueOf():NaN;if(Number.isNaN(s)){return e.invalid("invalid input")}var r=Rt(n.zone,Bt.defaultZone);if(!r.isValid){return e.invalid(rs(r))}return new e({ts:s,zone:r,loc:Et.fromObject(n)})};e.fromMillis=function t(i,n){if(n===void 0){n={}}if(!ue(i)){throw new M("fromMillis requires a numerical input, but received a "+typeof i+" with value "+i)}else if(i<-ss||i>ss){return e.invalid("Timestamp out of range")}else{return new e({ts:i,zone:Rt(n.zone,Bt.defaultZone),loc:Et.fromObject(n)})}};e.fromSeconds=function t(i,n){if(n===void 0){n={}}if(!ue(i)){throw new M("fromSeconds requires a numerical input")}else{return new e({ts:i*1e3,zone:Rt(n.zone,Bt.defaultZone),loc:Et.fromObject(n)})}};e.fromObject=function t(i,n){if(n===void 0){n={}}i=i||{};var s=Rt(n.zone,Bt.defaultZone);if(!s.isValid){return e.invalid(rs(s))}var r=Et.fromObject(n);var o=Fe(i,Ms);var a=ne(o,r),l=a.minDaysInFirstWeek,u=a.startOfWeek;var c=Bt.now(),h=!le(n.specificOffset)?n.specificOffset:s.offset(c),d=!le(o.ordinal),f=!le(o.year),p=!le(o.month)||!le(o.day),y=f||p,g=o.weekYear||o.weekNumber;if((y||d)&&g){throw new x("Can't mix weekYear/weekNumber units with year/month/day or ordinals")}if(p&&d){throw new x("Can't mix ordinal dates with month/day")}var v=g||o.weekday&&!y;var w,b,S=cs(c,h);if(v){w=Ss;b=vs;S=Xt(S,l,u)}else if(d){w=xs;b=ws;S=ee(S)}else{w=bs;b=gs}var _=false;for(var M=m(w),k;!(k=M()).done;){var T=k.value;var A=o[T];if(!le(A)){_=true}else if(_){o[T]=b[T]}else{o[T]=S[T]}}var I=v?se(o,l,u):d?re(o):oe(o),j=I||ae(o);if(j){return e.invalid(j)}var C=v?te(o,l,u):d?ie(o):o,E=hs(C,h,s),O=E[0],L=E[1],N=new e({ts:O,zone:s,o:L,loc:r});if(o.weekday&&y&&i.weekday!==N.weekday){return e.invalid("mismatched weekday","you can't specify both a weekday of "+o.weekday+" and a date of "+N.toISO())}return N};e.fromISO=function t(e,i){if(i===void 0){i={}}var n=Yi(e),s=n[0],r=n[1];return fs(s,r,i,"ISO 8601",e)};e.fromRFC2822=function t(e,i){if(i===void 0){i={}}var n=Qi(e),s=n[0],r=n[1];return fs(s,r,i,"RFC 2822",e)};e.fromHTTP=function t(e,i){if(i===void 0){i={}}var n=Xi(e),s=n[0],r=n[1];return fs(s,r,i,"HTTP",i)};e.fromFormat=function t(i,n,s){if(s===void 0){s={}}if(le(i)||le(n)){throw new M("fromFormat requires an input string and a format")}var r=s,o=r.locale,a=o===void 0?null:o,l=r.numberingSystem,u=l===void 0?null:l,c=Et.fromOpts({locale:a,numberingSystem:u,defaultToEN:true}),h=es(c,i,n),d=h[0],f=h[1],p=h[2],m=h[3];if(m){return e.invalid(m)}else{return fs(d,f,s,"format "+n,i,p)}};e.fromString=function t(i,n,s){if(s===void 0){s={}}return e.fromFormat(i,n,s)};e.fromSQL=function t(e,i){if(i===void 0){i={}}var n=an(e),s=n[0],r=n[1];return fs(s,r,i,"SQL",e)};e.invalid=function t(i,n){if(n===void 0){n=null}if(!i){throw new M("need to specify a reason the DateTime is invalid")}var t=i instanceof qt?i:new qt(i,n);if(Bt.throwOnInvalid){throw new w(t)}else{return new e({invalid:t})}};e.isDateTime=function t(e){return e&&e.isLuxonDateTime||false};e.parseFormatForOpts=function t(e,i){if(i===void 0){i={}}var n=is(e,Et.fromObject(i));return!n?null:n.map((function(t){return t?t.val:null})).join("")};e.expandFormat=function t(e,i){if(i===void 0){i={}}var n=Xn(oi.parseFormat(e),Et.fromObject(i));return n.map((function(t){return t.val})).join("")};var i=e.prototype;i.get=function t(e){return this[e]};i.getPossibleOffsets=function t(){if(!this.isValid||this.isOffsetFixed){return[this]}var e=864e5;var i=6e4;var n=Ce(this.c);var s=this.zone.offset(n-e);var r=this.zone.offset(n+e);var o=this.zone.offset(n-s*i);var a=this.zone.offset(n-r*i);if(o===a){return[this]}var l=n-o*i;var u=n-a*i;var c=cs(l,o);var h=cs(u,a);if(c.hour===h.hour&&c.minute===h.minute&&c.second===h.second&&c.millisecond===h.millisecond){return[ls(this,{ts:l}),ls(this,{ts:u})]}return[this]};i.resolvedLocaleOptions=function t(e){if(e===void 0){e={}}var i=oi.create(this.loc.clone(e),e).resolvedOptions(this),n=i.locale,s=i.numberingSystem,r=i.calendar;return{locale:n,numberingSystem:s,outputCalendar:r}};i.toUTC=function t(e,i){if(e===void 0){e=0}if(i===void 0){i={}}return this.setZone(Lt.instance(e),i)};i.toLocal=function t(){return this.setZone(Bt.defaultZone)};i.setZone=function t(i,n){var s=n===void 0?{}:n,r=s.keepLocalTime,o=r===void 0?false:r,a=s.keepCalendarTime,l=a===void 0?false:a;i=Rt(i,Bt.defaultZone);if(i.equals(this.zone)){return this}else if(!i.isValid){return e.invalid(rs(i))}else{var u=this.ts;if(o||l){var c=i.offset(this.ts);var h=this.toObject();var d=hs(h,c,i);u=d[0]}return ls(this,{ts:u,zone:i})}};i.reconfigure=function t(e){var i=e===void 0?{}:e,n=i.locale,s=i.numberingSystem,r=i.outputCalendar;var o=this.loc.clone({locale:n,numberingSystem:s,outputCalendar:r});return ls(this,{loc:o})};i.setLocale=function t(e){return this.reconfigure({locale:e})};i.set=function t(e){if(!this.isValid)return this;var i=Fe(e,Ms);var n=ne(i,this.loc),r=n.minDaysInFirstWeek,o=n.startOfWeek;var a=!le(i.weekYear)||!le(i.weekNumber)||!le(i.weekday),l=!le(i.ordinal),u=!le(i.year),c=!le(i.month)||!le(i.day),h=u||c,d=i.weekYear||i.weekNumber;if((h||l)&&d){throw new x("Can't mix weekYear/weekNumber units with year/month/day or ordinals")}if(c&&l){throw new x("Can't mix ordinal dates with month/day")}var f;if(a){f=te(s({},Xt(this.c,r,o),i),r,o)}else if(!le(i.ordinal)){f=ie(s({},ee(this.c),i))}else{f=s({},this.toObject(),i);if(le(i.day)){f.day=Math.min(je(f.year,f.month),f.day)}}var p=hs(f,this.o,this.zone),m=p[0],y=p[1];return ls(this,{ts:m,o:y})};i.plus=function t(e){if(!this.isValid)return this;var i=bn.fromDurationLike(e);return ls(this,ds(this,i))};i.minus=function t(e){if(!this.isValid)return this;var i=bn.fromDurationLike(e).negate();return ls(this,ds(this,i))};i.startOf=function t(e,i){var n=i===void 0?{}:i,s=n.useLocaleWeeks,r=s===void 0?false:s;if(!this.isValid)return this;var o={},a=bn.normalizeUnit(e);switch(a){case"years":o.month=1;case"quarters":case"months":o.day=1;case"weeks":case"days":o.hour=0;case"hours":o.minute=0;case"minutes":o.second=0;case"seconds":o.millisecond=0;break}if(a==="weeks"){if(r){var l=this.loc.getStartOfWeek();var u=this.weekday;if(u<l){o.weekNumber=this.weekNumber-1}o.weekday=l}else{o.weekday=1}}if(a==="quarters"){var c=Math.ceil(this.month/3);o.month=(c-1)*3+1}return this.set(o)};i.endOf=function t(e,i){var n;return this.isValid?this.plus((n={},n[e]=1,n)).startOf(e,i).minus(1):this};i.toFormat=function t(e,i){if(i===void 0){i={}}return this.isValid?oi.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):ns};i.toLocaleString=function t(e,i){if(e===void 0){e=j}if(i===void 0){i={}}return this.isValid?oi.create(this.loc.clone(i),e).formatDateTime(this):ns};i.toLocaleParts=function t(e){if(e===void 0){e={}}return this.isValid?oi.create(this.loc.clone(e),e).formatDateTimeParts(this):[]};i.toISO=function t(e){var i=e===void 0?{}:e,n=i.format,s=n===void 0?"extended":n,r=i.suppressSeconds,o=r===void 0?false:r,a=i.suppressMilliseconds,l=a===void 0?false:a,u=i.includeOffset,c=u===void 0?true:u,h=i.extendedZone,d=h===void 0?false:h;if(!this.isValid){return null}var f=s==="extended";var p=ms(this,f);p+="T";p+=ys(this,f,o,l,c,d);return p};i.toISODate=function t(e){var i=e===void 0?{}:e,n=i.format,s=n===void 0?"extended":n;if(!this.isValid){return null}return ms(this,s==="extended")};i.toISOWeekDate=function t(){return ps(this,"kkkk-'W'WW-c")};i.toISOTime=function t(e){var i=e===void 0?{}:e,n=i.suppressMilliseconds,s=n===void 0?false:n,r=i.suppressSeconds,o=r===void 0?false:r,a=i.includeOffset,l=a===void 0?true:a,u=i.includePrefix,c=u===void 0?false:u,h=i.extendedZone,d=h===void 0?false:h,f=i.format,p=f===void 0?"extended":f;if(!this.isValid){return null}var m=c?"T":"";return m+ys(this,p==="extended",o,s,l,d)};i.toRFC2822=function t(){return ps(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",false)};i.toHTTP=function t(){return ps(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")};i.toSQLDate=function t(){if(!this.isValid){return null}return ms(this,true)};i.toSQLTime=function t(e){var i=e===void 0?{}:e,n=i.includeOffset,s=n===void 0?true:n,r=i.includeZone,o=r===void 0?false:r,a=i.includeOffsetSpace,l=a===void 0?true:a;var u="HH:mm:ss.SSS";if(o||s){if(l){u+=" "}if(o){u+="z"}else if(s){u+="ZZ"}}return ps(this,u,true)};i.toSQL=function t(e){if(e===void 0){e={}}if(!this.isValid){return null}return this.toSQLDate()+" "+this.toSQLTime(e)};i.toString=function t(){return this.isValid?this.toISO():ns};i[t]=function(){if(this.isValid){return"DateTime { ts: "+this.toISO()+", zone: "+this.zone.name+", locale: "+this.locale+" }"}else{return"DateTime { Invalid, reason: "+this.invalidReason+" }"}};i.valueOf=function t(){return this.toMillis()};i.toMillis=function t(){return this.isValid?this.ts:NaN};i.toSeconds=function t(){return this.isValid?this.ts/1e3:NaN};i.toUnixInteger=function t(){return this.isValid?Math.floor(this.ts/1e3):NaN};i.toJSON=function t(){return this.toISO()};i.toBSON=function t(){return this.toJSDate()};i.toObject=function t(e){if(e===void 0){e={}}if(!this.isValid)return{};var i=s({},this.c);if(e.includeConfig){i.outputCalendar=this.outputCalendar;i.numberingSystem=this.loc.numberingSystem;i.locale=this.loc.locale}return i};i.toJSDate=function t(){return new Date(this.isValid?this.ts:NaN)};i.diff=function t(e,i,n){if(i===void 0){i="milliseconds"}if(n===void 0){n={}}if(!this.isValid||!e.isValid){return bn.invalid("created by diffing an invalid DateTime")}var r=s({locale:this.locale,numberingSystem:this.numberingSystem},n);var o=me(i).map(bn.normalizeUnit),a=e.valueOf()>this.valueOf(),l=a?this:e,u=a?e:this,c=An(l,u,o,r);return a?c.negate():c};i.diffNow=function t(i,n){if(i===void 0){i="milliseconds"}if(n===void 0){n={}}return this.diff(e.now(),i,n)};i.until=function t(e){return this.isValid?_n.fromDateTimes(this,e):this};i.hasSame=function t(e,i,n){if(!this.isValid)return false;var s=e.valueOf();var r=this.setZone(e.zone,{keepLocalTime:true});return r.startOf(i,n)<=s&&s<=r.endOf(i,n)};i.equals=function t(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)};i.toRelative=function t(i){if(i===void 0){i={}}if(!this.isValid)return null;var n=i.base||e.fromObject({},{zone:this.zone}),r=i.padding?this<n?-i.padding:i.padding:0;var o=["years","months","days","hours","minutes","seconds"];var a=i.unit;if(Array.isArray(i.unit)){o=i.unit;a=undefined}return Ts(n,this.plus(r),s({},i,{numeric:"always",units:o,unit:a}))};i.toRelativeCalendar=function t(i){if(i===void 0){i={}}if(!this.isValid)return null;return Ts(i.base||e.fromObject({},{zone:this.zone}),this,s({},i,{numeric:"auto",units:["years","months","days"],calendary:true}))};e.min=function t(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++){n[s]=arguments[s]}if(!n.every(e.isDateTime)){throw new M("min requires all arguments be DateTimes")}return ye(n,(function(t){return t.valueOf()}),Math.min)};e.max=function t(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++){n[s]=arguments[s]}if(!n.every(e.isDateTime)){throw new M("max requires all arguments be DateTimes")}return ye(n,(function(t){return t.valueOf()}),Math.max)};e.fromFormatExplain=function t(e,i,n){if(n===void 0){n={}}var s=n,r=s.locale,o=r===void 0?null:r,a=s.numberingSystem,l=a===void 0?null:a,u=Et.fromOpts({locale:o,numberingSystem:l,defaultToEN:true});return ts(u,e,i)};e.fromStringExplain=function t(i,n,s){if(s===void 0){s={}}return e.fromFormatExplain(i,n,s)};n(e,[{key:"isValid",get:function t(){return this.invalid===null}},{key:"invalidReason",get:function t(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function t(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function t(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function t(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function t(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function t(){return this._zone}},{key:"zoneName",get:function t(){return this.isValid?this.zone.name:null}},{key:"year",get:function t(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function t(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function t(){return this.isValid?this.c.month:NaN}},{key:"day",get:function t(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function t(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function t(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function t(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function t(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function t(){return this.isValid?os(this).weekYear:NaN}},{key:"weekNumber",get:function t(){return this.isValid?os(this).weekNumber:NaN}},{key:"weekday",get:function t(){return this.isValid?os(this).weekday:NaN}},{key:"isWeekend",get:function t(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}},{key:"localWeekday",get:function t(){return this.isValid?as(this).weekday:NaN}},{key:"localWeekNumber",get:function t(){return this.isValid?as(this).weekNumber:NaN}},{key:"localWeekYear",get:function t(){return this.isValid?as(this).weekYear:NaN}},{key:"ordinal",get:function t(){return this.isValid?ee(this.c).ordinal:NaN}},{key:"monthShort",get:function t(){return this.isValid?Mn.months("short",{locObj:this.loc})[this.month-1]:null}},{key:"monthLong",get:function t(){return this.isValid?Mn.months("long",{locObj:this.loc})[this.month-1]:null}},{key:"weekdayShort",get:function t(){return this.isValid?Mn.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}},{key:"weekdayLong",get:function t(){return this.isValid?Mn.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}},{key:"offset",get:function t(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function t(){if(this.isValid){return this.zone.offsetName(this.ts,{format:"short",locale:this.locale})}else{return null}}},{key:"offsetNameLong",get:function t(){if(this.isValid){return this.zone.offsetName(this.ts,{format:"long",locale:this.locale})}else{return null}}},{key:"isOffsetFixed",get:function t(){return this.isValid?this.zone.isUniversal:null}},{key:"isInDST",get:function t(){if(this.isOffsetFixed){return false}else{return this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}}},{key:"isInLeapYear",get:function t(){return Ae(this.year)}},{key:"daysInMonth",get:function t(){return je(this.year,this.month)}},{key:"daysInYear",get:function t(){return this.isValid?Ie(this.year):NaN}},{key:"weeksInWeekYear",get:function t(){return this.isValid?Oe(this.weekYear):NaN}},{key:"weeksInLocalWeekYear",get:function t(){return this.isValid?Oe(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}}],[{key:"DATE_SHORT",get:function t(){return j}},{key:"DATE_MED",get:function t(){return C}},{key:"DATE_MED_WITH_WEEKDAY",get:function t(){return E}},{key:"DATE_FULL",get:function t(){return O}},{key:"DATE_HUGE",get:function t(){return L}},{key:"TIME_SIMPLE",get:function t(){return N}},{key:"TIME_WITH_SECONDS",get:function t(){return R}},{key:"TIME_WITH_SHORT_OFFSET",get:function t(){return P}},{key:"TIME_WITH_LONG_OFFSET",get:function t(){return F}},{key:"TIME_24_SIMPLE",get:function t(){return D}},{key:"TIME_24_WITH_SECONDS",get:function t(){return $}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function t(){return z}},{key:"TIME_24_WITH_LONG_OFFSET",get:function t(){return U}},{key:"DATETIME_SHORT",get:function t(){return V}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function t(){return G}},{key:"DATETIME_MED",get:function t(){return B}},{key:"DATETIME_MED_WITH_SECONDS",get:function t(){return q}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function t(){return H}},{key:"DATETIME_FULL",get:function t(){return W}},{key:"DATETIME_FULL_WITH_SECONDS",get:function t(){return Z}},{key:"DATETIME_HUGE",get:function t(){return J}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function t(){return K}}]);return e}(Symbol.for("nodejs.util.inspect.custom"));function js(t){if(Is.isDateTime(t)){return t}else if(t&&t.valueOf&&ue(t.valueOf())){return Is.fromJSDate(t)}else if(t&&typeof t==="object"){return Is.fromObject(t)}else{throw new M("Unknown datetime argument: "+t+", of type "+typeof t)}}var Cs="3.4.4";e.DateTime=Is;e.Duration=bn;e.FixedOffsetZone=Lt;e.IANAZone=ot;e.Info=Mn;e.Interval=_n;e.InvalidZone=Nt;e.Settings=Bt;e.SystemZone=X;e.VERSION=Cs;e.Zone=Y}));const pg="system",mg="unknown",yg="UTC",gg=Intl.DateTimeFormat().resolvedOptions().timeZone,vg="shortOffset";function wg(t){return"timeZoneIANA"in t}function bg(t){return t.startsWith("UTC")}function Sg(t,e=!1){return{json:{read:{source:t,reader:(e,i)=>i[t]?xg(i[t]):null},write:!!e&&{allowNull:!0,writer(e,i){i[t]=e?_g(e):null}}}}}function xg(t,e=pg){return t?wg(t)?t.timeZoneIANA:Mg(t,e):e}function _g(t){return{timeZoneIANA:t}}function Mg(t,e=pg){if(!t||!cg.has(t.timeZone))return e;const i=cg.get(t.timeZone);return bg(t.timeZone)||t.respectsDaylightSaving?i:kg(i)}function kg(t){const e=fg.DateTime.local().setZone(t),i=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);if(0===i)return"Etc/UTC";return`Etc/GMT${fg.FixedOffsetZone.instance(-i).formatOffset(0,"narrow")}`}function Tg(t,e,i,n,s){if(e&&"date"===s)return{timeZone:yg,timeZoneName:void 0};const r=n.timeStyle||n.hour,o=i===mg;return{timeZone:o?"timestamp-offset"===s?void 0:t??yg:i,timeZoneName:o&&r?vg:void 0}}const Ag={year:void 0,month:void 0,day:void 0,weekday:void 0},Ig={hour:void 0,minute:void 0,second:void 0},jg={timeZone:yg},Cg={year:"numeric",month:"numeric",day:"numeric"},Eg={year:"numeric",month:"long",day:"numeric"},Og={year:"numeric",month:"short",day:"numeric"},Lg={year:"numeric",month:"long",weekday:"long",day:"numeric"},Ng={hour:"numeric",minute:"numeric"},Rg={...Ng,second:"numeric"},Pg={hourCycle:"h23"},Fg={...Ng,...Pg},Dg={...Rg,...Pg},$g={"short-date":Cg,"short-date-short-time":{...Cg,...Ng},"short-date-short-time-24":{...Cg,...Fg},"short-date-long-time":{...Cg,...Rg},"short-date-long-time-24":{...Cg,...Dg},"short-date-le":Cg,"short-date-le-short-time":{...Cg,...Ng},"short-date-le-short-time-24":{...Cg,...Fg},"short-date-le-long-time":{...Cg,...Rg},"short-date-le-long-time-24":{...Cg,...Dg},"long-month-day-year":Eg,"long-month-day-year-short-time":{...Eg,...Ng},"long-month-day-year-short-time-24":{...Eg,...Fg},"long-month-day-year-long-time":{...Eg,...Rg},"long-month-day-year-long-time-24":{...Eg,...Dg},"day-short-month-year":Og,"day-short-month-year-short-time":{...Og,...Ng},"day-short-month-year-short-time-24":{...Og,...Fg},"day-short-month-year-long-time":{...Og,...Rg},"day-short-month-year-long-time-24":{...Og,...Dg},"long-date":Lg,"long-date-short-time":{...Lg,...Ng},"long-date-short-time-24":{...Lg,...Fg},"long-date-long-time":{...Lg,...Rg},"long-date-long-time-24":{...Lg,...Dg},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Ng,"long-time":Rg},zg=cl()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),Ug={ar:"ar-u-nu-latn-ca-gregory"};let Vg=new WeakMap;const Gg=$g["short-date-short-time"];function Bg(t){let e=Vg.get(t);if(!e){const i=ng(),n=Ug[i]||i,s=Kg(t.timeZone??pg),r={...t,timeZone:s};e=new Intl.DateTimeFormat(n,r),Vg.set(t,e)}return e}function qg(t){return $g[t]}function Hg(t,e=Gg){return Bg(e).format(t)}function Wg(t,e=Gg){return Hg(new Date(t),{...e,...jg,...Ig})}function Zg(t,e=Gg){return Hg(new Date(`1970-01-01T${t}Z`),{...e,...jg,...Ag})}function Jg(t,e=Gg){if(e.timeZone)return Hg(new Date(t),e);const i=fg.DateTime.fromISO(t,{setZone:!0}),n=ng(),s=Ug[n]??n,r=0===i.offset?yg:e.timeZone,o={...e,timeZone:r};return i.toLocaleString(o,{locale:s})}function Kg(t){switch(t){case pg:return gg;case mg:return yg;default:return t}}lg((()=>{Vg=new WeakMap}));const Yg={ar:"ar-u-nu-latn"};let Qg=new WeakMap,Xg={};function tv(t){const e=t||Xg;if(!Qg.has(e)){const i=ng(),n=Yg[ng()]||i;Qg.set(e,new Intl.NumberFormat(n,t))}return Qg.get(e)}function ev(t={}){const e={};return null!=t.digitSeparator&&(e.useGrouping=t.digitSeparator),null!=t.places&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function iv(t,e){return Object.is(t,-0)&&(t=0),tv(e).format(t)}lg((()=>{Qg=new WeakMap,Xg={}}));const nv=()=>Ft.getLogger("esri.intl.substitute");function sv(t,e,i={}){const{format:n={}}=i;return Et(t,(t=>rv(t,e,n)))}function rv(t,e,i){let n,s;const r=t.indexOf(":");if(-1===r?n=t.trim():(n=t.slice(0,r).trim(),s=t.slice(r+1).trim()),!n)return"";const o=Mt(n,e);if(null==o)return"";const a=(s?i?.[s]:null)??i?.[n];return a?ov(o,a):s?av(o,s):lv(o)}function ov(t,e){switch(e.type){case"date":return Hg(t,e.intlOptions);case"number":return iv(t,e.intlOptions);default:return nv().warn("missing format descriptor for key {key}"),lv(t)}}function av(t,e){switch(e.toLowerCase()){case"dateformat":return Hg(t);case"numberformat":return iv(t);default:return nv().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?Hg(t):/^numberformat/i.test(e)?iv(t):lv(t)}}function lv(t){switch(typeof t){case"string":return t;case"number":return iv(t);case"boolean":return""+t;default:return t instanceof Date?Hg(t):""}}const uv=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,cv={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function hv(t){return t in cv}const dv=[],fv=new Map;function pv(t){for(const e of fv.keys())wv(t.pattern,e)&&fv.delete(e)}function mv(t){return dv.includes(t)||(pv(t),dv.unshift(t)),Zt((()=>{const e=dv.indexOf(t);e>-1&&(dv.splice(e,1),pv(t))}))}async function yv(t){const e=ng();fv.has(t)||fv.set(t,vv(t,e));const i=fv.get(t);return i&&await bv.add(i),i}function gv(t){if(!uv.test(t))return null;const e=uv.exec(t);if(null===e)return null;const[,i,n]=e,s=i+(n?"-"+n.toUpperCase():"");return hv(s)?s:hv(i)?i:null}async function vv(t,e){const i=[];for(const n of dv)if(wv(n.pattern,t))try{return await n.fetchMessageBundle(t,e)}catch(t){i.push(t)}if(i.length)throw new Qe("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i});throw new Qe("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function wv(t,e){return"string"==typeof t?e.startsWith(t):t.test(e)}lg((()=>{fv.clear()}));const bv=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=Hi())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}};async function Sv(t,e,i,n){const s=e.exec(i);if(!s)throw new Qe("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const r=s[1]?`${s[1]}/`:"",o=s[2],a=gv(n),l=`${r}${o}.json`,u=a?`${r}${o}_${a}.json`:l;let c;try{c=await xv(t(u))}catch(e){if(u===l)throw new Qe("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:e});try{c=await xv(t(l))}catch(t){throw new Qe("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:t})}}return c}async function xv(t){if(null!=kv.fetchBundleAsset)return kv.fetchBundleAsset(t);const e=await hc(t,{responseType:"text"});return JSON.parse(e.data)}class _v{constructor({base:t="",pattern:e,location:i=new URL(window.location.href)}){let n;n="string"==typeof i?t=>new URL(t,new URL(i,window.location.href)).href:i instanceof URL?t=>new URL(t,i).href:i,this.pattern="string"==typeof e?new RegExp(`^${e}`):e,this.getAssetUrl=n,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=new RegExp(`^${t}(?:(.*)/)?(.*)$`)}fetchMessageBundle(t,e){return Sv(this.getAssetUrl,this.matcher,t,e)}}function Mv(t){return new _v(t)}const kv={};mv(Mv({pattern:"esri/",location:Nc}));const Tv={};function Av(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.concat()||[],paths:{...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=Tv.baseUrl),e}class Iv{constructor(){const t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((e=>{this[e]=(...i)=>t[e](...i)}))}}class jv{constructor(){this._dispatcher=new Iv,this._workerPostMessage({type:Cy.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(t){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=t,t&&this.addEventListener("message",t)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(t){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=t,t&&this.addEventListener("messageerror",t)}get onerror(){return this._onerrorHandler}set onerror(t){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=t,t&&this.addEventListener("error",t)}postMessage(t){hi((()=>{this._workerMessageHandler(new MessageEvent("message",{data:t}))}))}dispatchEvent(t){return this._dispatcher.dispatchEvent(t)}addEventListener(t,e,i){this._dispatcher.addEventListener(t,e,i)}removeEventListener(t,e,i){this._dispatcher.removeEventListener(t,e,i)}_workerPostMessage(t){hi((()=>{this.dispatchEvent(new MessageEvent("message",{data:t}))}))}async _workerMessageHandler(t){const e=Py(t);if(e&&e.type===Cy.OPEN){const{modulePath:t,jobId:i}=e;let n=await Yy.loadWorker(t);n||(n=await import(t));const s=Yy.connect(n);this._workerPostMessage({type:Cy.OPENED,jobId:i,data:s})}}}const Cv=()=>Ft.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:Ev}=Cy,Ov='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,s)=>{if(t){if(t.aborted)return s(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:ABORT,jobId:n}),s(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:s}),self.postMessage({type:INVOKE,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\\nModules version: ${r}\\nAssets version: ${n??s}\\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case OPEN:let n;function t(e){const o=n.connect(e);self.postMessage({type:OPENED,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case RESPONSE:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let Lv,Nv;const Rv="Failed to create Worker. Fallback to execute module in main thread";async function Pv(){if(!c("esri-workers"))return Fv(new jv);if(!Lv&&!Nv)try{const t=Ov.split('"{CONFIGURATION}"').join(`'${Dv()}'`);Lv=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(t){Nv=t||{}}let t;if(Lv)try{t=new Worker(Lv,{name:"esri-worker-"+$v++})}catch(e){Cv().warn(Rv,Nv),t=new jv}else Cv().warn(Rv,Nv),t=new jv;return Fv(t)}async function Fv(t){return new Promise((e=>{function i(s){const r=Py(s);r&&r.type===Ev&&(t.removeEventListener("message",i),t.removeEventListener("error",n),e(t))}function n(e){e.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",n),Cv().warn("Failed to create Worker. Fallback to execute module in main thread",e),(t=new jv).addEventListener("message",i),t.addEventListener("error",n)}t.addEventListener("message",i),t.addEventListener("error",n)}))}function Dv(){let t;if(null!=It.default){const e={...It};delete e.default,t=JSON.parse(JSON.stringify(e))}else t=JSON.parse(JSON.stringify(It));t.assetsPath=su(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?su(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=ng(),t.has={"esri-csp-restrictions":c("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":c("esri-2d-update-debug"),"esri-2d-log-updating":c("esri-2d-log-updating"),"featurelayer-pbf":c("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":c("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":c("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":c("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":c("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":c("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":c("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":c("featurelayer-snapshot-enabled"),"esri-atomics":c("esri-atomics"),"esri-shared-array-buffer":c("esri-shared-array-buffer"),"esri-tiles-debug":c("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":c("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":c("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=su(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=su(t.workers.workerPath):t.workers.workerPath=su(Nc("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=It.workers.loaderConfig,i=Av({baseUrl:e?.baseUrl,locale:ng(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]}),n={buildDate:Ju,fullVersion:Xu,revision:Ku};return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:n})}let $v=0;const{ABORT:zv,INVOKE:Uv,OPEN:Vv,OPENED:Gv,RESPONSE:Bv}=Cy;class qv{static async create(t){const e=await Pv();return new qv(e,t)}constructor(t,e){this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=e,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",(t=>{t.preventDefault(),Ft.getLogger("esri.core.workers.WorkerOwner").error(t)}))}terminate(){this.worker.terminate()}async open(t,e={}){const{signal:i}=e,n=Oy();return new Promise(((e,s)=>{const r={resolve:e,reject:s,abortHandle:Ni(i,(()=>{this._outJobs.delete(n),this._post({type:zv,jobId:n})}))};this._outJobs.set(n,r),this._post({type:Vv,jobId:n,modulePath:t})}))}_onMessage(t){const e=Py(t);if(e)switch(e.type){case Gv:this._onOpenedMessage(e);break;case Bv:this._onResponseMessage(e);break;case zv:this._onAbortMessage(e);break;case Uv:this._onInvokeMessage(e)}}_onAbortMessage(t){const e=this._inJobs,i=t.jobId,n=e.get(i);n&&(n.controller&&n.controller.abort(),e.delete(i))}_onInvokeMessage(t){const{methodName:e,jobId:i,data:n,abortable:s}=t,r=s?new AbortController:null,o=this._inJobs,a=Xy[e];let l;try{if("function"!=typeof a)throw new TypeError(`${e} is not a function`);l=a.call(null,n,{signal:r?r.signal:null})}catch(t){return void this._post({type:Bv,jobId:i,error:Ny(t)})}Gi(l)?(o.set(i,{controller:r,promise:l}),l.then((t=>{o.has(i)&&(o.delete(i),this._post({type:Bv,jobId:i},t))}),(t=>{o.has(i)&&(o.delete(i),t||(t={message:"Error encountered at method"+e}),Pi(t)||this._post({type:Bv,jobId:i,error:Ny(t||{message:`Error encountered at method ${e}`})}))}))):this._post({type:Bv,jobId:i},l)}_onOpenedMessage(t){const{jobId:e,data:i}=t,n=this._outJobs.get(e);n&&(this._outJobs.delete(e),Ut(n.abortHandle),n.resolve(i))}_onResponseMessage(t){const{jobId:e,error:i,data:n}=t,s=this._outJobs.get(e);s&&(this._outJobs.delete(e),Ut(s.abortHandle),i?s.reject(Qe.fromJSON(JSON.parse(i))):s.resolve(n))}_post(t,e,i){return Ry(this.worker,t,e,i)}}const Hv=c("host-browser")?Math.min(navigator.hardwareConcurrency-1,c("workers-pool-size")):0;let Wv=c("esri-mobile")?Math.min(Hv,3):Hv;Wv||(Wv=c("safari")&&c("mac")?7:2);let Zv=0;const Jv=[];function Kv(){tw()}async function Yv(t,e){const i=new Qy,{registryTarget:n,...s}=e;return await i.open(t,s),n&&Ay(n,i),i}async function Qv(t,e={}){if("string"!=typeof t)throw new Qe("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(c("host-webworker")&&!c("esri-workers")&&(i="local"),"local"===i){let i=await Yy.loadWorker(t);i||(i=await import(t)),Ii(e.signal);const n=e.client||i;return Yv([Yy.connect(i)],{...e,client:n})}if(await tw(),Ii(e.signal),"dedicated"===i){const i=Zv++%Wv;return Yv([await Jv[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,Wv);if(i<Wv){const n=new Array(i);for(let s=0;s<i;++s){const i=Zv++%Wv;n[s]=Jv[i].open(t,e)}return Yv(n,e)}}return Yv(Jv.map((i=>i.open(t,e))),e)}let Xv=null;async function tw(){if(Xv)return Xv;new AbortController;const t=[];for(let e=0;e<Wv;e++){const i=qv.create(e).then((t=>(Jv[e]=t,t)));t.push(i)}return Xv=Promise.all(t),Xv}const ew=dl.radius,iw=dl.eccentricitySquared,nw={a1:ew*iw,a2:ew*iw*ew*iw,a3:ew*iw*iw/2,a4:ew*iw*ew*iw*2.5,a5:ew*iw+ew*iw*iw/2,a6:1-iw};var sw;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",t[t.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=8]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=10]="GCSMOON2000",t[t.LON_LAT=11]="LON_LAT",t[t.PLATE_CARREE=12]="PLATE_CARREE"}(sw||(sw={}));const rw={[sw.WGS84]:{[sw.CGCS2000]:null,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:null,[sw.LON_LAT]:uw,[sw.WGS84_COMPARABLE_LON_LAT]:uw,[sw.SPHERICAL_ECEF]:Tw,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:pw,[sw.PLATE_CARREE]:mw,[sw.WGS84]:uw,[sw.WGS84_ECEF]:Nw},[sw.CGCS2000]:{[sw.CGCS2000]:uw,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:null,[sw.LON_LAT]:uw,[sw.WGS84_COMPARABLE_LON_LAT]:uw,[sw.SPHERICAL_ECEF]:Tw,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:null,[sw.PLATE_CARREE]:mw,[sw.WGS84]:null,[sw.WGS84_ECEF]:Nw},[sw.GCSMARS2000]:{[sw.CGCS2000]:null,[sw.GCSMARS2000]:uw,[sw.GCSMOON2000]:null,[sw.LON_LAT]:uw,[sw.WGS84_COMPARABLE_LON_LAT]:null,[sw.SPHERICAL_ECEF]:null,[sw.SPHERICAL_MARS_PCPF]:kw,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:null,[sw.PLATE_CARREE]:null,[sw.WGS84]:null,[sw.WGS84_ECEF]:null},[sw.GCSMOON2000]:{[sw.CGCS2000]:null,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:uw,[sw.LON_LAT]:uw,[sw.WGS84_COMPARABLE_LON_LAT]:null,[sw.SPHERICAL_ECEF]:null,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:Mw,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:null,[sw.PLATE_CARREE]:null,[sw.WGS84]:null,[sw.WGS84_ECEF]:null},[sw.WEB_MERCATOR]:{[sw.CGCS2000]:null,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:null,[sw.LON_LAT]:cw,[sw.WGS84_COMPARABLE_LON_LAT]:cw,[sw.SPHERICAL_ECEF]:hw,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:uw,[sw.PLATE_CARREE]:gw,[sw.WGS84]:cw,[sw.WGS84_ECEF]:dw},[sw.WGS84_ECEF]:{[sw.CGCS2000]:Rw,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:null,[sw.LON_LAT]:Rw,[sw.WGS84_COMPARABLE_LON_LAT]:Rw,[sw.SPHERICAL_ECEF]:Pw,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:Fw,[sw.PLATE_CARREE]:vw,[sw.WGS84]:Rw,[sw.WGS84_ECEF]:uw},[sw.SPHERICAL_ECEF]:{[sw.CGCS2000]:Cw,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:null,[sw.LON_LAT]:Cw,[sw.WGS84_COMPARABLE_LON_LAT]:Cw,[sw.SPHERICAL_ECEF]:uw,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:Ew,[sw.PLATE_CARREE]:ww,[sw.WGS84]:Cw,[sw.WGS84_ECEF]:Ow},[sw.SPHERICAL_MARS_PCPF]:{[sw.CGCS2000]:null,[sw.GCSMARS2000]:jw,[sw.GCSMOON2000]:null,[sw.LON_LAT]:jw,[sw.WGS84_COMPARABLE_LON_LAT]:null,[sw.SPHERICAL_ECEF]:null,[sw.SPHERICAL_MARS_PCPF]:uw,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:null,[sw.PLATE_CARREE]:null,[sw.WGS84]:null,[sw.WGS84_ECEF]:null},[sw.SPHERICAL_MOON_PCPF]:{[sw.CGCS2000]:null,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:Iw,[sw.LON_LAT]:Iw,[sw.WGS84_COMPARABLE_LON_LAT]:null,[sw.SPHERICAL_ECEF]:null,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:uw,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:null,[sw.PLATE_CARREE]:null,[sw.WGS84]:null,[sw.WGS84_ECEF]:null},[sw.UNKNOWN]:{[sw.CGCS2000]:null,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:null,[sw.LON_LAT]:null,[sw.WGS84_COMPARABLE_LON_LAT]:null,[sw.SPHERICAL_ECEF]:null,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:uw,[sw.WEB_MERCATOR]:null,[sw.PLATE_CARREE]:null,[sw.WGS84]:null,[sw.WGS84_ECEF]:null},[sw.LON_LAT]:{[sw.CGCS2000]:uw,[sw.GCSMARS2000]:uw,[sw.GCSMOON2000]:uw,[sw.LON_LAT]:uw,[sw.WGS84_COMPARABLE_LON_LAT]:uw,[sw.SPHERICAL_ECEF]:Tw,[sw.SPHERICAL_MARS_PCPF]:kw,[sw.SPHERICAL_MOON_PCPF]:Mw,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:pw,[sw.PLATE_CARREE]:mw,[sw.WGS84]:uw,[sw.WGS84_ECEF]:Nw},[sw.WGS84_COMPARABLE_LON_LAT]:{[sw.CGCS2000]:null,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:null,[sw.LON_LAT]:uw,[sw.WGS84_COMPARABLE_LON_LAT]:uw,[sw.SPHERICAL_ECEF]:Tw,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:null,[sw.PLATE_CARREE]:mw,[sw.WGS84]:uw,[sw.WGS84_ECEF]:Nw},[sw.PLATE_CARREE]:{[sw.CGCS2000]:yw,[sw.GCSMARS2000]:null,[sw.GCSMOON2000]:null,[sw.LON_LAT]:yw,[sw.WGS84_COMPARABLE_LON_LAT]:yw,[sw.SPHERICAL_ECEF]:bw,[sw.SPHERICAL_MARS_PCPF]:null,[sw.SPHERICAL_MOON_PCPF]:null,[sw.UNKNOWN]:null,[sw.WEB_MERCATOR]:Sw,[sw.PLATE_CARREE]:uw,[sw.WGS84]:yw,[sw.WGS84_ECEF]:xw}};function ow(t){const e=lw(t,zw);return rw[e][sw.WGS84_COMPARABLE_LON_LAT]}function aw(t,e,i=$w()){return null==t||null==e?null:Dw(t,e,i).projector}function lw(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=hd(t,1)),Gh(t)?e.spatialReferenceId=sw.SPHERICAL_ECEF:bh(t)?e.spatialReferenceId=sw.WGS84:_h(t)?e.spatialReferenceId=sw.WEB_MERCATOR:Mh(t)?e.spatialReferenceId=sw.PLATE_CARREE:t.wkt===Dh.wkt?e.spatialReferenceId=sw.WGS84_ECEF:t.wkid===rh.CGCS2000?e.spatialReferenceId=sw.CGCS2000:t.wkt===Ph.wkt?e.spatialReferenceId=sw.SPHERICAL_MARS_PCPF:t.wkt===Fh.wkt?e.spatialReferenceId=sw.SPHERICAL_MOON_PCPF:Th(t)?e.spatialReferenceId=sw.GCSMARS2000:Ih(t)?e.spatialReferenceId=sw.GCSMOON2000:e.spatialReferenceId=sw.UNKNOWN):sw.UNKNOWN}function uw(t,e,i,n){t!==i&&(i[n++]=t[e++],i[n++]=t[e++],i[n]=t[e])}function cw(t,e,i,n){i[n]=Bw*(t[e]/Ww),i[n+1]=Bw*(Hw-2*Math.atan(Math.exp(-t[e+1]/Ww))),i[n+2]=t[e+2]}function hw(t,e,i,n){const s=t[e]/Ww,r=Hw-2*Math.atan(Math.exp(-t[e+1]/Ww)),o=Ww+t[e+2],a=Math.cos(r)*o;i[n]=Math.cos(s)*a,i[n+1]=Math.sin(s)*a,i[n+2]=Math.sin(r)*o}function dw(t,e,i,n){cw(t,e,i,n),Nw(i,n,i,n)}function fw(t,e,i,n,s){const r=.4999999*qw,o=pa(Gw*t[e+1],-r,r),a=Math.sin(o);i[n++]=Gw*t[e]*s.radius,i[n++]=s.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[n]=t[e+2]}function pw(t,e,i,n){fw(t,e,i,n,dl)}function mw(t,e,i,n){i[n]=t[e]*Zw,i[n+1]=t[e+1]*Zw,i[n+2]=t[e+2]}function yw(t,e,i,n){i[n]=t[e]*Jw,i[n+1]=t[e+1]*Jw,i[n+2]=t[e+2]}function gw(t,e,i,n){cw(t,e,i,n),mw(i,n,i,n)}function vw(t,e,i,n){Rw(t,e,i,n),mw(i,n,i,n)}function ww(t,e,i,n){Cw(t,e,i,n),mw(i,n,i,n)}function bw(t,e,i,n){yw(t,e,i,n),Tw(i,n,i,n)}function Sw(t,e,i,n){yw(t,e,i,n),pw(i,n,i,n)}function xw(t,e,i,n){yw(t,e,i,n),Nw(i,n,i,n)}function _w(t,e,i,n,s){const r=s+t[e+2],o=Gw*t[e+1],a=Gw*t[e],l=Math.cos(o)*r;i[n]=Math.cos(a)*l,i[n+1]=Math.sin(a)*l,i[n+2]=Math.sin(o)*r}function Mw(t,e,i,n){_w(t,e,i,n,pl.radius)}function kw(t,e,i,n){_w(t,e,i,n,fl.radius)}function Tw(t,e,i,n){_w(t,e,i,n,dl.radius)}function Aw(t,e,i,n,s){const r=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(r*r+o*o+a*a),u=Sa(a/(0===l?1:l)),c=Math.atan2(o,r);i[n++]=Bw*c,i[n++]=Bw*u,i[n]=l-s}function Iw(t,e,i,n){Aw(t,e,i,n,pl.radius)}function jw(t,e,i,n){Aw(t,e,i,n,fl.radius)}function Cw(t,e,i,n){Aw(t,e,i,n,dl.radius)}function Ew(t,e,i,n){Cw(t,e,i,n),pw(i,n,i,n)}function Ow(t,e,i,n){Cw(t,e,i,n),Nw(i,n,i,n)}function Lw(t,e,i,n,s){const r=Gw*t[e],o=Gw*t[e+1],a=t[e+2],l=Math.sin(o),u=Math.cos(o),c=s.radius/Math.sqrt(1-s.eccentricitySquared*l*l);i[n++]=(c+a)*u*Math.cos(r),i[n++]=(c+a)*u*Math.sin(r),i[n++]=(c*(1-s.eccentricitySquared)+a)*l}function Nw(t,e,i,n){Lw(t,e,i,n,dl)}function Rw(t,e,i,n){const s=nw,r=t[e],o=t[e+1],a=t[e+2];let l,u,c,h,d,f,p,m,y,g,v,w,b,S,x,_,M,k,T,A,I;l=Math.abs(a),u=r*r+o*o,c=Math.sqrt(u),h=u+a*a,d=Math.sqrt(h),A=Math.atan2(o,r),f=a*a/h,p=u/h,S=s.a2/d,x=s.a3-s.a4/d,p>.3?(m=l/d*(1+p*(s.a1+S+f*x)/d),T=Math.asin(m),g=m*m,y=Math.sqrt(1-g)):(y=c/d*(1-f*(s.a5-S-p*x)/d),T=Math.acos(y),g=1-y*y,m=Math.sqrt(g)),v=1-dl.eccentricitySquared*g,w=dl.radius/Math.sqrt(v),b=s.a6*w,S=c-w*y,x=l-b*m,M=y*S+m*x,_=y*x-m*S,k=_/(b/v+M),T+=k,I=M+_*k/2,a<0&&(T=-T),i[n++]=Bw*A,i[n++]=Bw*T,i[n]=I}function Pw(t,e,i,n){Rw(t,e,i,n),Tw(i,n,i,n)}function Fw(t,e,i,n){Rw(t,e,i,n),pw(i,n,i,n)}function Dw(t,e,i){if(null==t||null==e||i.source.spatialReference===t&&i.dest.spatialReference===e)return i;const n=lw(t,i.source),s=lw(e,i.dest);return n===sw.UNKNOWN&&s===sw.UNKNOWN?mh(t,e)?i.projector=uw:i.projector=null:i.projector=rw[n][s],i}function $w(){return{source:{spatialReference:null,spatialReferenceId:sw.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:sw.UNKNOWN,metersPerUnit:1},projector:uw}}const zw={spatialReference:null,spatialReferenceId:sw.UNKNOWN},Uw={spatialReference:null,spatialReferenceId:sw.UNKNOWN},Vw=$w(),Gw=va(1),Bw=wa(1),qw=Math.PI,Hw=.5*qw,Ww=dl.radius,Zw=Ww*qw/180,Jw=180/(Ww*qw);function Kw(t,e,i,n,s,r,o=1){const a=aw(e,s,Vw);if(null==a)return!1;if(a===uw){if(t===n&&i===r)return!0;const e=i+3*o;for(let s=i,o=r;s<e;s++,o++)n[o]=t[s];return!0}const l=i+3*o;for(let e=i,s=r;e<l;e+=3,s+=3)a(t,e,n,s);return!0}const Yw=Object.freeze({__proto__:null,projectBuffer:Kw});function Qw(t,e,i,n,s,r){return Xw[0]=t,Xw[1]=e,Xw[2]=i,Kw(Xw,n,0,s,r,0,1)}const Xw=Wr();let tb=0;class eb{static fromGE(t){const e=new eb;return e._wkt=t.wkt,e._wkid=t.wkid,e._isInverse=t.isInverse,e}constructor(t){this.uid=tb++,t?(this._wkt=null!=t.wkt?t.wkt:null,this._wkid=null!=t.wkid?t.wkid:-1,this._isInverse=null!=t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=tb++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=tb++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=tb++}getInverse(){const t=new eb;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}class ib{static cacheKey(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}static fromGE(t){const e=new ib;let i="";for(const n of t.steps){const t=eb.fromGE(n);e.steps.push(t),i+=t.uid.toString()+","}return e._cachedProjection={},e._gtlistentry=null,e._chain=i,e}constructor(t){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,t?.steps)for(const e of t.steps)e instanceof eb?this.steps.push(e):this.steps.push(new eb({wkid:e.wkid,wkt:e.wkt,isInverse:e.isInverse}))}getInverse(){const t=new ib;t.steps=[];for(let e=this.steps.length-1;e>=0;e--){const i=this.steps[e];t.steps.push(i.getInverse())}return t}getGTListEntry(){let t="";for(const e of this.steps)t+=e.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=t),this._gtlistentry}assignCachedGe(t,e,i){this._cachedProjection[ib.cacheKey(t,e)]=i}getCachedGeTransformation(t,e){let i="";for(const t of this.steps)i+=t.uid.toString()+",";i!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=i);const n=this._cachedProjection[ib.cacheKey(t,e)];return void 0===n?null:n}}function nb(t,e,i){if(null==e||null==i||i.vcsWkid||mh(e,i)||Bh(e)||Bh(i))return null;const n=ud(e)/ud(i);if(1===n)return null;switch(t){case"point":case"esriGeometryPoint":return t=>sb(t,n);case"polyline":case"esriGeometryPolyline":return t=>ob(t,n);case"polygon":case"esriGeometryPolygon":return t=>rb(t,n);case"multipoint":case"esriGeometryMultipoint":return t=>ab(t,n);case"extent":case"esriGeometryEnvelope":return t=>lb(t,n);default:return null}}function sb(t,e){null!=t?.z&&(t.z*=e)}function rb(t,e){if(t)for(const i of t.rings)for(const t of i)t.length>2&&(t[2]*=e)}function ob(t,e){if(t)for(const i of t.paths)for(const t of i)t.length>2&&(t[2]*=e)}function ab(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}function lb(t,e){t&&null!=t.zmin&&null!=t.zmax&&(t.zmin*=e,t.zmax*=e)}let ub=null,cb=null,hb=null,db={};const fb=new $m;function pb(){return!!ub&&Fc()}function mb(){return!!pb()||(Ee(fb),vb(),!1)}function yb(t,e){return!t||!e||(Cb(t,e)||mb())}function gb(t,e){return!Cb(t,e)&&!pb()}function vb(t){return null==hb&&(hb=Promise.all([$c(),import("./p-3c20266a.js").then((t=>t.g)),import("./p-386e90ef.js")])),hb.then((([,e,{hydratedAdapter:i}])=>{Ii(t),cb=i,ub=e.default,ub._enableProjection(sh),fb.notify()}))}function wb(t,e,i=null,n=null){return Array.isArray(t)?0===t.length?[]:bb(cb,t,t[0].spatialReference,e,i,n):bb(cb,[t],t.spatialReference,e,i,n)[0]}function bb(t,e,i,n,s=null,r=null){if(null==i||null==n)return e;if(Cb(i,n,s))return e.map((t=>Ob(t,i,n)));if(null==s&&Gh(i)){return e.map((t=>Ob(t,i,jd.WGS84))).map((t=>Ib(t,n)))}if(null==s&&Gh(n)){return e.map((t=>Ib(t,jd.WGS84))).map((t=>Ob(t,jd.WGS84,n)))}if(null==s){const t=ib.cacheKey(i,n);void 0!==db[t]?s=db[t]:(null==(s=_b(i,n,void 0))&&(s=new ib),db[t]=s)}if(null==ub||null==t)throw new kb;return null!=r?ub._project(t,e,i,n,s,r):ub._project(t,e,i,n,s)}function Sb(t,e){const i=xb([t],e);return null!=i.pending?{pending:i.pending,geometry:null}:null!=i.geometries?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function xb(t,e){if(!pb())for(const i of t)if(null!=i&&!mh(i.spatialReference,e)&&Ch(i.spatialReference)&&Ch(e)&&!Cb(i.spatialReference,e))return Ee(fb),{pending:vb(),geometries:null};return{pending:null,geometries:t.map((t=>null==t?null:mh(t.spatialReference,e)?t:Ch(t.spatialReference)&&Ch(e)?Ib(t,e):null))}}function _b(t,e,i=null){if(null==t||null==e)return null;if(null==ub||null==cb)throw new kb;const n=ub._getTransformation(cb,t,e,i,i?.spatialReference);return null!==n?ib.fromGE(n):null}function Mb(t,e,i=null){if(null==ub||null==cb)throw new kb;const n=ub._getTransformationBySuitability(cb,t,e,i,i?.spatialReference);if(null!==n){const t=[];for(const e of n)t.push(ib.fromGE(e));return t}return[]}class kb extends Qe{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}}function Tb(){ub=null,cb=null,hb=null,db={}}const Ab={get loadPromise(){return hb}};function Ib(t,e){try{const i=wb(t,e);if(null==i)return null;"xmin"in t&&"xmin"in i&&(i.zmin=t.zmin,i.zmax=t.zmax);const n=nb(i.type,t.spatialReference,e);return null!=n&&n(i),i}catch(t){if(!(t instanceof kb))throw t;return null}}async function jb(t,e,i){const n=t.spatialReference;return null!=n&&null!=e&&await Eb(n,e,null,i),Ib(t,e)}function Cb(t,e,i){return!i&&(!!mh(t,e)||Ch(t)&&Ch(e)&&!!aw(t,e,Vw))}async function Eb(t,e,i,n){if(pb())return Wi(n);if(Array.isArray(t)){for(const{source:e,dest:i,geographicTransformation:s}of t)if(e&&i&&!Cb(e,i,s))return vb(n)}else if(t&&e&&!Cb(t,e,i))return vb(n);return Wi(n)}function Ob(t,e,i){return t?"x"in t?Nb(t,e,new Qd,i,0):"xmin"in t?Vb(t,e,new Rf,i,0):"rings"in t?zb(t,e,new pm,i,0):"paths"in t?Db(t,e,new vm,i,0):"points"in t?Pb(t,e,new Uf,i,0):null:null}function Lb(t,e,i=e.spatialReference,n=0){return null!=i&&null!=t.spatialReference&&null!=Nb(t,t.spatialReference,e,i,n)}function Nb(t,e,i,n,s){qb[0]=t.x,qb[1]=t.y;const r=t.z;return qb[2]=void 0!==r?r:s,Kw(qb,e,0,qb,n,0,1)?(i.x=qb[0],i.y=qb[1],i.spatialReference=n,void 0!==r||Bh(n)?(i.z=qb[2],i.hasZ=!0):(i.z=void 0,i.hasZ=!1),void 0===t.m?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}function Rb(t,e,i=e.spatialReference,n=0){return null!=t.spatialReference&&null!=i&&null!=Pb(t,t.spatialReference,e,i,n)}function Pb(t,e,i,n,s){const{points:r,hasZ:o,hasM:a}=t,l=[],u=r.length,c=[];for(const t of r)c.push(t[0],t[1],o?t[2]:s);if(!Kw(c,e,0,c,n,0,u))return null;const h=o||Bh(n);for(let t=0;t<u;++t){const e=3*t,i=c[e],n=c[e+1];h&&a?l.push([i,n,c[e+2],r[t][3]]):h?l.push([i,n,c[e+2]]):a?l.push([i,n,r[t][2]]):l.push([i,n])}return i.points=l,i.spatialReference=n,i.hasZ=o,i.hasM=a,i}function Fb(t,e,i=e.spatialReference,n=0){return null!=t.spatialReference&&null!=i&&null!=Db(t,t.spatialReference,e,i,n)}function Db(t,e,i,n,s){const{paths:r,hasZ:o,hasM:a}=t,l=[];if(!Gb(r,o??!1,a??!1,e,l,n,s))return null;const u=o||Bh(n);return i.paths=l,i.spatialReference=n,i.hasZ=u,i.hasM=a,i}function $b(t,e,i=e.spatialReference,n=0){return null!=t.spatialReference&&null!=i&&null!=zb(t,t.spatialReference,e,i,n)}function zb(t,e,i,n,s){const{rings:r,hasZ:o,hasM:a}=t,l=[];if(!Gb(r,o??!1,a??!1,e,l,n,s))return null;const u=o||Bh(n);return i.rings=l,i.spatialReference=n,i.hasZ=u,i.hasM=a,i}function Ub(t,e,i=e.spatialReference,n=0){return null!=t.spatialReference&&null!=i&&null!=Vb(t,t.spatialReference,e,i,n)}function Vb(t,e,i,n,s){const{xmin:r,ymin:o,xmax:a,ymax:l,hasZ:u,hasM:c}=t,h=u?t.zmin:s;if(!Qw(r,o,h,e,qb,n))return null;const d=u||Bh(n);i.xmin=qb[0],i.ymin=qb[1],d&&(i.zmin=qb[2]);const f=u?t.zmax:s;return Qw(a,l,f,e,qb,n)?(i.xmax=qb[0],i.ymax=qb[1],d&&(i.zmax=qb[2]),c&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=n,i):null}function Gb(t,e,i,n,s,r,o=0){const a=new Array;for(const i of t)for(const t of i)a.push(t[0],t[1],e?t[2]:o);if(!Kw(a,n,0,a,r,0,a.length/3))return!1;let l=0;s.length=0;const u=e||Bh(r);for(const e of t){const t=new Array;for(const n of e)u&&i?t.push([a[l++],a[l++],a[l++],n[3]]):u?t.push([a[l++],a[l++],a[l++]]):i?(t.push([a[l++],a[l++],n[2]]),l++):(t.push([a[l++],a[l++]]),l++);s.push(t)}return!0}function Bb(t){return null!=t&&null!=ow(t)}const qb=Wr();const Hb=Object.freeze({__proto__:null,canProjectToWGS84ComparableLonLat:Bb,canProjectWithoutEngine:Cb,getTransformation:_b,getTransformations:Mb,initializeProjection:Eb,isLoaded:pb,isLoadedOrLoad:mb,isLoadedOrLoadFor:yb,load:vb,project:wb,projectExtent:Ub,projectMany:bb,projectMultipoint:Rb,projectOrLoad:Sb,projectOrLoadMany:xb,projectPoint:Lb,projectPolygon:$b,projectPolyline:Fb,projectWithZConversion:jb,projectWithoutEngine:Ob,requiresLoad:gb,test:Ab,tryProjectWithZConversion:Ib,unload:Tb});var Wb;let Zb=Wb=class extends el{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new Wb({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};o([Us({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Zb.prototype,"cols",void 0),o([Us({type:Ns,json:{write:!0}})],Zb.prototype,"level",void 0),o([Us({type:String,json:{write:!0}})],Zb.prototype,"levelValue",void 0),o([Us({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Zb.prototype,"origin",void 0),o([Us({type:Number,json:{write:!0}})],Zb.prototype,"resolution",void 0),o([Us({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Zb.prototype,"rows",void 0),o([Us({type:Number,json:{write:!0}})],Zb.prototype,"scale",void 0),Zb=Wb=o([Nr("esri.layers.support.LOD")],Zb);const Jb=Zb;class Kb{constructor(t,e,i,n,s=void 0){this.id=t,this.level=e,this.row=i,this.col=n,this.extent=s}}var Yb;const Qb=new ul({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let Xb=Yb=class extends el{static create(t={}){const{resolutionFactor:e=1,scales:i,size:n=256,spatialReference:s=jd.WebMercator,numLODs:r=24}=t;if(!Ch(s)){const t=[];if(i)for(let e=0;e<i.length;e++){const n=i[e];t.push(new Jb({level:e,scale:n,resolution:n}))}else{let e=5e-4;for(let i=r-1;i>=0;i--)t.unshift(new Jb({level:i,scale:e,resolution:e})),e*=2}return new Yb({dpi:96,lods:t,origin:new Qd(0,0,s),size:[n,n],spatialReference:s})}const o=yh(s),a=t.origin?new Qd({x:t.origin.x,y:t.origin.y,spatialReference:s}):new Qd(o?{x:o.origin[0],y:o.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),l=96,u=1/(hd(s)*39.37*l),c=[];if(i)for(let t=0;t<i.length;t++){const e=i[t],n=e*u;c.push(new Jb({level:t,scale:e,resolution:n}))}else{let t=vh(s)?512/n*591657527.5917094:256/n*591657527.591555;const i=Math.ceil(r/e);c.push(new Jb({level:0,scale:t,resolution:t*u}));for(let n=1;n<i;n++){const i=t/2**e,s=i*u;c.push(new Jb({level:n,scale:i,resolution:s})),t=i}}return new Yb({dpi:l,lods:c,origin:a,size:[n,n],spatialReference:s})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=yh(t);return t.isWrappable&&!!i&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return Qd.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){const e=[],i=this._levelToLOD={};t&&t.forEach((t=>{e.push(t.scale),i[t.level]=t})),this._set("scales",e),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];const i=Math.floor(t),n=i+1;return e[i]/(e[i]/e[n])**(t-i)}scaleToZoom(t){const e=this.scales,i=e.length-1;let n=0;for(;n<i;n++){const i=e[n],s=e[n+1];if(i<=t)return n;if(s===t)return n+1;if(i>t&&s<t)return n+Math.log(i/t)/Math.log(i/s)}return n}snapScale(t,e=.95){const i=this.scaleToZoom(t);return i%Math.floor(i)>=e?this.zoomToScale(Math.ceil(i)):this.zoomToScale(Math.floor(i))}tileAt(t,e,i,n){const s=this.lodAt(t);if(!s)return null;let r,o;if("number"==typeof e)r=e,o=i;else if(mh(e.spatialReference,this.spatialReference))r=e.x,o=e.y,n=i;else{const t=Gd(e,this.spatialReference);if(null==t)return null;r=t.x,o=t.y,n=i}const a=s.resolution*this.size[0],l=s.resolution*this.size[1];return n||(n=new Kb(null,0,0,0,pp())),n.level=t,n.row=Math.floor((this.origin.y-o)/l+.001),n.col=Math.floor((r-this.origin.x)/a+.001),this.updateTileInfo(n),n}updateTileInfo(t,e=Yb.ExtrapolateOptions.NONE){let i=this.lodAt(t.level);if(!i&&e===Yb.ExtrapolateOptions.POWER_OF_TWO){const e=this.lods[this.lods.length-1];e.level<t.level&&(i=e)}if(!i)return;const n=t.level-i.level,s=i.resolution*this.size[0]/2**n,r=i.resolution*this.size[1]/2**n;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=pp()),t.extent[0]=this.origin.x+t.col*s,t.extent[1]=this.origin.y-(t.row+1)*r,t.extent[2]=t.extent[0]+s,t.extent[3]=t.extent[1]+r}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||-1===e.parentLevel)&&(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,e){const i=this.lodAt(e.level);if(null==i)return null;const{resolution:n}=i,s=n*this.size[0],r=n*this.size[1];return t[0]=this.origin.x+e.col*s,t[1]=this.origin.y-(e.row+1)*r,t[2]=t[0]+s,t[3]=t[1]+r,t}lodAt(t){return this._levelToLOD?.[t]??null}clone(){return Yb.fromJSON(this.write({}))}getOrCreateCompatible(t,e){if(256===this.size[0]&&256===this.size[1])return 256===t?this:null;const i=[],n=this.lods.length;for(let t=0;t<n;t++){const n=this.lods[t],s=n.resolution*e;i.push(new Jb({level:n.level,scale:n.scale,resolution:s}))}return new Yb({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const n=t[i];this._upsampleLevels[n.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/n.resolution:0},e=n}}};o([Us({type:Number,json:{write:!0}})],Xb.prototype,"compressionQuality",void 0),o([Us({type:Number,json:{write:!0}})],Xb.prototype,"dpi",void 0),o([Us({type:String,json:{read:Qb.read,write:Qb.write,origins:{"web-scene":{read:!1,write:!1}}}})],Xb.prototype,"format",void 0),o([Us({readOnly:!0})],Xb.prototype,"isWrappable",null),o([Us({type:Qd,json:{write:!0}})],Xb.prototype,"origin",void 0),o([al("origin")],Xb.prototype,"readOrigin",null),o([Us({type:[Jb],value:null,json:{write:!0}})],Xb.prototype,"lods",null),o([Us({readOnly:!0})],Xb.prototype,"scales",void 0),o([Us({cast:t=>Array.isArray(t)?t:"number"==typeof t?[t,t]:[256,256]})],Xb.prototype,"size",void 0),o([al("size",["rows","cols"])],Xb.prototype,"readSize",null),o([ll("size",{cols:{type:Ns},rows:{type:Ns}})],Xb.prototype,"writeSize",null),o([Us({type:jd,json:{write:!0}})],Xb.prototype,"spatialReference",void 0),Xb=Yb=o([Nr("esri.layers.support.TileInfo")],Xb),function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"}(Xb||(Xb={}));const tS=Xb;const eS={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],n=e[1],s=this.values;return n>=i?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},iS={xsmall:544,small:768,medium:992,large:1200};function nS(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function sS(t,e){return e?eS[t].valueToClassName[e].split(" "):[]}const rS=t=>{let e=class extends t{constructor(...t){super(...t),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=iS}initialize(){this.addHandles(fy((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),_y))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(t){if(t===this._get("breakpoints"))return;const e=nS(t);if(!e){const t=JSON.stringify(iS,null,2);console.warn("provided breakpoints are not valid, using defaults:"+t)}t=e?t:iS,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=ai.acquire(),e=ai.acquire();let i,n=!1;for(i in eS){const s=this[i],r=eS[i].getValue({viewSize:this.size,breakpoints:this.breakpoints});s!==r&&(n=!0,this[i]=r,sS(i,s).forEach((t=>e.push(t))),sS(i,r).forEach((e=>t.push(e))))}n&&(this._applyClassNameChanges(t,e),ai.release(t),ai.release(e))}_applyClassNameChanges(t,e){const i=this.container;i&&(e.forEach((t=>i.classList.remove(t))),t.forEach((t=>i.classList.add(t))))}_removeActiveClassNames(){const t=this.container;if(!t)return;let e;for(e in eS)sS(e,this[e]).forEach((e=>t.classList.remove(e)))}};return o([Us()],e.prototype,"breakpoints",null),o([Us()],e.prototype,"orientation",void 0),o([Us()],e.prototype,"widthBreakpoint",void 0),o([Us()],e.prototype,"heightBreakpoint",void 0),e=o([Nr("esri.views.BreakpointsOwner")],e),e};function oS(t){return"string"==typeof t?document.getElementById(t):t??null}function aS(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)}function lS(t,e){const i=e.parentNode;i&&i.insertBefore(t,e)}function uS(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}let cS=class extends Vr{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(t,e,i={}){return this._installWatch(t,e,i,fy)}addWhen(t,e,i={}){return this._installWatch(t,e,i,py)}addOnCollectionChange(t,e,{initial:i=!1,final:n=!1}={}){const s=++this._handleId;return this.addHandles([yy(t,"after-changes",this._createSyncUpdatingCallback(),xy),yy(t,"change",e,{onListenerAdd:i?t=>e({added:t.toArray(),removed:[]}):void 0,onListenerRemove:n?t=>e({added:[],removed:t.toArray()}):void 0})],s),Zt((()=>this.removeHandles(s)))}addPromise(t){if(null==t)return t;const e=++this._handleId;this.addHandles(Zt((()=>{this._pendingPromises.delete(t)&&(0!==this._pendingPromises.size||this.hasHandles(hS)||this._set("updating",!1))})),e),this._pendingPromises.add(t),this._set("updating",!0);const i=()=>this.removeHandles(e);return t.then(i,i),t}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(t,e,i={},n){const s=++this._handleId;i.sync||this._installSyncUpdatingWatch(t,s);const r=n(t,e,i);return this.addHandles(r,s),Zt((()=>this.removeHandles(s)))}_installSyncUpdatingWatch(t,e){const i=this._createSyncUpdatingCallback(),n=fy(t,i,{sync:!0,equals:()=>!1});return this.addHandles(n,e),n}_createSyncUpdatingCallback(){return()=>{this.removeHandles(hS),++this._scheduleHandleId;const t=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(ln((()=>{t===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(hS))})),hS)}}};o([Us({readOnly:!0})],cS.prototype,"updating",void 0),cS=o([Nr("esri.core.support.UpdatingHandles")],cS);const hS=-42;
/*!
 * @esri/arcgis-html-sanitizer - v3.0.1 - Tue Nov 15 2022 09:46:54 GMT-0800 (Pacific Standard Time)
 * Copyright (c) 2022 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */var dS=function(t){if(typeof t!=="object"||t===null){return false}if(Object.prototype.toString.call(t)!=="[object Object]"){return false}var e=Object.getPrototypeOf(t);if(e===null){return true}while(Object.getPrototypeOf(e)!==null){e=Object.getPrototypeOf(e)}return Object.getPrototypeOf(t)===e};var fS={exports:{}};var pS={};var mS={exports:{}};var yS={};function gS(){var t={};t["align-content"]=false;t["align-items"]=false;t["align-self"]=false;t["alignment-adjust"]=false;t["alignment-baseline"]=false;t["all"]=false;t["anchor-point"]=false;t["animation"]=false;t["animation-delay"]=false;t["animation-direction"]=false;t["animation-duration"]=false;t["animation-fill-mode"]=false;t["animation-iteration-count"]=false;t["animation-name"]=false;t["animation-play-state"]=false;t["animation-timing-function"]=false;t["azimuth"]=false;t["backface-visibility"]=false;t["background"]=true;t["background-attachment"]=true;t["background-clip"]=true;t["background-color"]=true;t["background-image"]=true;t["background-origin"]=true;t["background-position"]=true;t["background-repeat"]=true;t["background-size"]=true;t["baseline-shift"]=false;t["binding"]=false;t["bleed"]=false;t["bookmark-label"]=false;t["bookmark-level"]=false;t["bookmark-state"]=false;t["border"]=true;t["border-bottom"]=true;t["border-bottom-color"]=true;t["border-bottom-left-radius"]=true;t["border-bottom-right-radius"]=true;t["border-bottom-style"]=true;t["border-bottom-width"]=true;t["border-collapse"]=true;t["border-color"]=true;t["border-image"]=true;t["border-image-outset"]=true;t["border-image-repeat"]=true;t["border-image-slice"]=true;t["border-image-source"]=true;t["border-image-width"]=true;t["border-left"]=true;t["border-left-color"]=true;t["border-left-style"]=true;t["border-left-width"]=true;t["border-radius"]=true;t["border-right"]=true;t["border-right-color"]=true;t["border-right-style"]=true;t["border-right-width"]=true;t["border-spacing"]=true;t["border-style"]=true;t["border-top"]=true;t["border-top-color"]=true;t["border-top-left-radius"]=true;t["border-top-right-radius"]=true;t["border-top-style"]=true;t["border-top-width"]=true;t["border-width"]=true;t["bottom"]=false;t["box-decoration-break"]=true;t["box-shadow"]=true;t["box-sizing"]=true;t["box-snap"]=true;t["box-suppress"]=true;t["break-after"]=true;t["break-before"]=true;t["break-inside"]=true;t["caption-side"]=false;t["chains"]=false;t["clear"]=true;t["clip"]=false;t["clip-path"]=false;t["clip-rule"]=false;t["color"]=true;t["color-interpolation-filters"]=true;t["column-count"]=false;t["column-fill"]=false;t["column-gap"]=false;t["column-rule"]=false;t["column-rule-color"]=false;t["column-rule-style"]=false;t["column-rule-width"]=false;t["column-span"]=false;t["column-width"]=false;t["columns"]=false;t["contain"]=false;t["content"]=false;t["counter-increment"]=false;t["counter-reset"]=false;t["counter-set"]=false;t["crop"]=false;t["cue"]=false;t["cue-after"]=false;t["cue-before"]=false;t["cursor"]=false;t["direction"]=false;t["display"]=true;t["display-inside"]=true;t["display-list"]=true;t["display-outside"]=true;t["dominant-baseline"]=false;t["elevation"]=false;t["empty-cells"]=false;t["filter"]=false;t["flex"]=false;t["flex-basis"]=false;t["flex-direction"]=false;t["flex-flow"]=false;t["flex-grow"]=false;t["flex-shrink"]=false;t["flex-wrap"]=false;t["float"]=false;t["float-offset"]=false;t["flood-color"]=false;t["flood-opacity"]=false;t["flow-from"]=false;t["flow-into"]=false;t["font"]=true;t["font-family"]=true;t["font-feature-settings"]=true;t["font-kerning"]=true;t["font-language-override"]=true;t["font-size"]=true;t["font-size-adjust"]=true;t["font-stretch"]=true;t["font-style"]=true;t["font-synthesis"]=true;t["font-variant"]=true;t["font-variant-alternates"]=true;t["font-variant-caps"]=true;t["font-variant-east-asian"]=true;t["font-variant-ligatures"]=true;t["font-variant-numeric"]=true;t["font-variant-position"]=true;t["font-weight"]=true;t["grid"]=false;t["grid-area"]=false;t["grid-auto-columns"]=false;t["grid-auto-flow"]=false;t["grid-auto-rows"]=false;t["grid-column"]=false;t["grid-column-end"]=false;t["grid-column-start"]=false;t["grid-row"]=false;t["grid-row-end"]=false;t["grid-row-start"]=false;t["grid-template"]=false;t["grid-template-areas"]=false;t["grid-template-columns"]=false;t["grid-template-rows"]=false;t["hanging-punctuation"]=false;t["height"]=true;t["hyphens"]=false;t["icon"]=false;t["image-orientation"]=false;t["image-resolution"]=false;t["ime-mode"]=false;t["initial-letters"]=false;t["inline-box-align"]=false;t["justify-content"]=false;t["justify-items"]=false;t["justify-self"]=false;t["left"]=false;t["letter-spacing"]=true;t["lighting-color"]=true;t["line-box-contain"]=false;t["line-break"]=false;t["line-grid"]=false;t["line-height"]=false;t["line-snap"]=false;t["line-stacking"]=false;t["line-stacking-ruby"]=false;t["line-stacking-shift"]=false;t["line-stacking-strategy"]=false;t["list-style"]=true;t["list-style-image"]=true;t["list-style-position"]=true;t["list-style-type"]=true;t["margin"]=true;t["margin-bottom"]=true;t["margin-left"]=true;t["margin-right"]=true;t["margin-top"]=true;t["marker-offset"]=false;t["marker-side"]=false;t["marks"]=false;t["mask"]=false;t["mask-box"]=false;t["mask-box-outset"]=false;t["mask-box-repeat"]=false;t["mask-box-slice"]=false;t["mask-box-source"]=false;t["mask-box-width"]=false;t["mask-clip"]=false;t["mask-image"]=false;t["mask-origin"]=false;t["mask-position"]=false;t["mask-repeat"]=false;t["mask-size"]=false;t["mask-source-type"]=false;t["mask-type"]=false;t["max-height"]=true;t["max-lines"]=false;t["max-width"]=true;t["min-height"]=true;t["min-width"]=true;t["move-to"]=false;t["nav-down"]=false;t["nav-index"]=false;t["nav-left"]=false;t["nav-right"]=false;t["nav-up"]=false;t["object-fit"]=false;t["object-position"]=false;t["opacity"]=false;t["order"]=false;t["orphans"]=false;t["outline"]=false;t["outline-color"]=false;t["outline-offset"]=false;t["outline-style"]=false;t["outline-width"]=false;t["overflow"]=false;t["overflow-wrap"]=false;t["overflow-x"]=false;t["overflow-y"]=false;t["padding"]=true;t["padding-bottom"]=true;t["padding-left"]=true;t["padding-right"]=true;t["padding-top"]=true;t["page"]=false;t["page-break-after"]=false;t["page-break-before"]=false;t["page-break-inside"]=false;t["page-policy"]=false;t["pause"]=false;t["pause-after"]=false;t["pause-before"]=false;t["perspective"]=false;t["perspective-origin"]=false;t["pitch"]=false;t["pitch-range"]=false;t["play-during"]=false;t["position"]=false;t["presentation-level"]=false;t["quotes"]=false;t["region-fragment"]=false;t["resize"]=false;t["rest"]=false;t["rest-after"]=false;t["rest-before"]=false;t["richness"]=false;t["right"]=false;t["rotation"]=false;t["rotation-point"]=false;t["ruby-align"]=false;t["ruby-merge"]=false;t["ruby-position"]=false;t["shape-image-threshold"]=false;t["shape-outside"]=false;t["shape-margin"]=false;t["size"]=false;t["speak"]=false;t["speak-as"]=false;t["speak-header"]=false;t["speak-numeral"]=false;t["speak-punctuation"]=false;t["speech-rate"]=false;t["stress"]=false;t["string-set"]=false;t["tab-size"]=false;t["table-layout"]=false;t["text-align"]=true;t["text-align-last"]=true;t["text-combine-upright"]=true;t["text-decoration"]=true;t["text-decoration-color"]=true;t["text-decoration-line"]=true;t["text-decoration-skip"]=true;t["text-decoration-style"]=true;t["text-emphasis"]=true;t["text-emphasis-color"]=true;t["text-emphasis-position"]=true;t["text-emphasis-style"]=true;t["text-height"]=true;t["text-indent"]=true;t["text-justify"]=true;t["text-orientation"]=true;t["text-overflow"]=true;t["text-shadow"]=true;t["text-space-collapse"]=true;t["text-transform"]=true;t["text-underline-position"]=true;t["text-wrap"]=true;t["top"]=false;t["transform"]=false;t["transform-origin"]=false;t["transform-style"]=false;t["transition"]=false;t["transition-delay"]=false;t["transition-duration"]=false;t["transition-property"]=false;t["transition-timing-function"]=false;t["unicode-bidi"]=false;t["vertical-align"]=false;t["visibility"]=false;t["voice-balance"]=false;t["voice-duration"]=false;t["voice-family"]=false;t["voice-pitch"]=false;t["voice-range"]=false;t["voice-rate"]=false;t["voice-stress"]=false;t["voice-volume"]=false;t["volume"]=false;t["white-space"]=false;t["widows"]=false;t["width"]=true;t["will-change"]=false;t["word-break"]=true;t["word-spacing"]=true;t["word-wrap"]=true;t["wrap-flow"]=false;t["wrap-through"]=false;t["writing-mode"]=false;t["z-index"]=false;return t}function vS(t,e,i){}function wS(t,e,i){}var bS=/javascript\s*\:/gim;function SS(t,e){if(bS.test(e))return"";return e}yS.whiteList=gS();yS.getDefaultWhiteList=gS;yS.onAttr=vS;yS.onIgnoreAttr=wS;yS.safeAttrValue=SS;var xS={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf){return t.indexOf(e)}for(i=0,n=t.length;i<n;i++){if(t[i]===e){return i}}return-1},forEach:function(t,e,i){var n,s;if(Array.prototype.forEach){return t.forEach(e,i)}for(n=0,s=t.length;n<s;n++){e.call(i,t[n],n,t)}},trim:function(t){if(String.prototype.trim){return t.trim()}return t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){if(String.prototype.trimRight){return t.trimRight()}return t.replace(/(\s*$)/g,"")}};var _S=xS;function MS(t,e){t=_S.trimRight(t);if(t[t.length-1]!==";")t+=";";var i=t.length;var n=false;var s=0;var r=0;var o="";function a(){if(!n){var i=_S.trim(t.slice(s,r));var a=i.indexOf(":");if(a!==-1){var l=_S.trim(i.slice(0,a));var u=_S.trim(i.slice(a+1));if(l){var c=e(s,o.length,l,u,i);if(c)o+=c+"; "}}}s=r+1}for(;r<i;r++){var l=t[r];if(l==="/"&&t[r+1]==="*"){var u=t.indexOf("*/",r+2);if(u===-1)break;r=u+1;s=r+1;n=false}else if(l==="("){n=true}else if(l===")"){n=false}else if(l===";"){if(n);else{a()}}else if(l==="\n"){a()}}return _S.trim(o)}var kS=MS;var TS=yS;var AS=kS;function IS(t){return t===undefined||t===null}function jS(t){var e={};for(var i in t){e[i]=t[i]}return e}function CS(t){t=jS(t||{});t.whiteList=t.whiteList||TS.whiteList;t.onAttr=t.onAttr||TS.onAttr;t.onIgnoreAttr=t.onIgnoreAttr||TS.onIgnoreAttr;t.safeAttrValue=t.safeAttrValue||TS.safeAttrValue;this.options=t}CS.prototype.process=function(t){t=t||"";t=t.toString();if(!t)return"";var e=this;var i=e.options;var n=i.whiteList;var s=i.onAttr;var r=i.onIgnoreAttr;var o=i.safeAttrValue;var a=AS(t,(function(t,e,i,a,l){var u=n[i];var c=false;if(u===true)c=u;else if(typeof u==="function")c=u(a);else if(u instanceof RegExp)c=u.test(a);if(c!==true)c=false;a=o(i,a);if(!a)return;var h={position:e,sourcePosition:t,source:l,isWhite:c};if(c){var d=s(i,a,h);if(IS(d)){return i+":"+a}else{return d}}else{var d=r(i,a,h);if(!IS(d)){return d}}}));return a};var ES=CS;(function(t,e){var i=yS;var n=ES;function s(t,e){var i=new n(e);return i.process(t)}e=t.exports=s;e.FilterCSS=n;for(var r in i)e[r]=i[r]})(mS,mS.exports);var OS={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf){return t.indexOf(e)}for(i=0,n=t.length;i<n;i++){if(t[i]===e){return i}}return-1},forEach:function(t,e,i){var n,s;if(Array.prototype.forEach){return t.forEach(e,i)}for(n=0,s=t.length;n<s;n++){e.call(i,t[n],n,t)}},trim:function(t){if(String.prototype.trim){return t.trim()}return t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/;var i=e.exec(t);return i?i.index:-1}};var LS=mS.exports.FilterCSS;var NS=mS.exports.getDefaultWhiteList;var RS=OS;function PS(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var FS=new LS;function DS(t,e,i){}function $S(t,e,i){}function zS(t,e,i){}function US(t,e,i){}function VS(t){return t.replace(BS,"&lt;").replace(qS,"&gt;")}function GS(t,e,i,n){i=rx(i);if(e==="href"||e==="src"){i=RS.trim(i);if(i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/")){return""}}else if(e==="background"){YS.lastIndex=0;if(YS.test(i)){return""}}else if(e==="style"){QS.lastIndex=0;if(QS.test(i)){return""}XS.lastIndex=0;if(XS.test(i)){YS.lastIndex=0;if(YS.test(i)){return""}}if(n!==false){n=n||FS;i=n.process(i)}}i=ox(i);return i}var BS=/</g;var qS=/>/g;var HS=/"/g;var WS=/&quot;/g;var ZS=/&#([a-zA-Z0-9]*);?/gim;var JS=/&colon;?/gim;var KS=/&newline;?/gim;var YS=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi;var QS=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi;var XS=/u\s*r\s*l\s*\(.*/gi;function tx(t){return t.replace(HS,"&quot;")}function ex(t){return t.replace(WS,'"')}function ix(t){return t.replace(ZS,(function t(e,i){return i[0]==="x"||i[0]==="X"?String.fromCharCode(parseInt(i.substr(1),16)):String.fromCharCode(parseInt(i,10))}))}function nx(t){return t.replace(JS,":").replace(KS," ")}function sx(t){var e="";for(var i=0,n=t.length;i<n;i++){e+=t.charCodeAt(i)<32?" ":t.charAt(i)}return RS.trim(e)}function rx(t){t=ex(t);t=ix(t);t=nx(t);t=sx(t);return t}function ox(t){t=tx(t);t=VS(t);return t}function ax(){return""}function lx(t,e){if(typeof e!=="function"){e=function(){}}var i=!Array.isArray(t);function n(e){if(i)return true;return RS.indexOf(t,e)!==-1}var s=[];var r=false;return{onIgnoreTag:function(t,i,o){if(n(t)){if(o.isClosing){var a="[/removed]";var l=o.position+a.length;s.push([r!==false?r:o.position,l]);r=false;return a}else{if(!r){r=o.position}return"[removed]"}}else{return e(t,i,o)}},remove:function(t){var e="";var i=0;RS.forEach(s,(function(n){e+=t.slice(i,n[0]);i=n[1]}));e+=t.slice(i);return e}}}function ux(t){var e="";var i=0;while(i<t.length){var n=t.indexOf("\x3c!--",i);if(n===-1){e+=t.slice(i);break}e+=t.slice(i,n);var s=t.indexOf("--\x3e",n);if(s===-1){break}i=s+3}return e}function cx(t){var e=t.split("");e=e.filter((function(t){var e=t.charCodeAt(0);if(e===127)return false;if(e<=31){if(e===10||e===13)return true;return false}return true}));return e.join("")}pS.whiteList=PS();pS.getDefaultWhiteList=PS;pS.onTag=DS;pS.onIgnoreTag=$S;pS.onTagAttr=zS;pS.onIgnoreTagAttr=US;pS.safeAttrValue=GS;pS.escapeHtml=VS;pS.escapeQuote=tx;pS.unescapeQuote=ex;pS.escapeHtmlEntities=ix;pS.escapeDangerHtml5Entities=nx;pS.clearNonPrintableCharacter=sx;pS.friendlyAttrValue=rx;pS.escapeAttrValue=ox;pS.onIgnoreTagStripAll=ax;pS.StripTagBody=lx;pS.stripCommentTag=ux;pS.stripBlankChar=cx;pS.cssFilter=FS;pS.getDefaultCSSWhiteList=NS;var hx={};var dx=OS;function fx(t){var e=dx.spaceIndex(t);var i;if(e===-1){i=t.slice(1,-1)}else{i=t.slice(1,e+1)}i=dx.trim(i).toLowerCase();if(i.slice(0,1)==="/")i=i.slice(1);if(i.slice(-1)==="/")i=i.slice(0,-1);return i}function px(t){return t.slice(0,2)==="</"}function mx(t,e,i){var n="";var s=0;var r=false;var o=false;var a=0;var l=t.length;var u="";var c="";t:for(a=0;a<l;a++){var h=t.charAt(a);if(r===false){if(h==="<"){r=a;continue}}else{if(o===false){if(h==="<"){n+=i(t.slice(s,a));r=a;s=a;continue}if(h===">"){n+=i(t.slice(s,r));c=t.slice(r,a+1);u=fx(c);n+=e(r,n.length,u,c,px(c));s=a+1;r=false;continue}if(h==='"'||h==="'"){var d=1;var f=t.charAt(a-d);while(f.trim()===""||f==="="){if(f==="="){o=h;continue t}f=t.charAt(a-++d)}}}else{if(h===o){o=false;continue}}}}if(s<t.length){n+=i(t.substr(s))}return n}var yx=/[^a-zA-Z0-9\\_:.-]/gim;function gx(t,e){var i=0;var n=0;var s=[];var r=false;var o=t.length;function a(t,i){t=dx.trim(t);t=t.replace(yx,"").toLowerCase();if(t.length<1)return;var n=e(t,i||"");if(n)s.push(n)}for(var l=0;l<o;l++){var u=t.charAt(l);var c,h;if(r===false&&u==="="){r=t.slice(i,l);i=l+1;n=t.charAt(i)==='"'||t.charAt(i)==="'"?i:wx(t,l+1);continue}if(r!==false){if(l===n){h=t.indexOf(u,l+1);if(h===-1){break}else{c=dx.trim(t.slice(n+1,h));a(r,c);r=false;l=h;i=l+1;continue}}}if(/\s|\n|\t/.test(u)){t=t.replace(/\s|\n|\t/g," ");if(r===false){h=vx(t,l);if(h===-1){c=dx.trim(t.slice(i,l));a(c);r=false;i=l+1;continue}else{l=h-1;continue}}else{h=bx(t,l-1);if(h===-1){c=dx.trim(t.slice(i,l));c=xx(c);a(r,c);r=false;i=l+1;continue}else{continue}}}}if(i<t.length){if(r===false){a(t.slice(i))}else{a(r,xx(dx.trim(t.slice(i))))}}return dx.trim(s.join(" "))}function vx(t,e){for(;e<t.length;e++){var i=t[e];if(i===" ")continue;if(i==="=")return e;return-1}}function wx(t,e){for(;e<t.length;e++){var i=t[e];if(i===" ")continue;if(i==="'"||i==='"')return e;return-1}}function bx(t,e){for(;e>0;e--){var i=t[e];if(i===" ")continue;if(i==="=")return e;return-1}}function Sx(t){if(t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"){return true}else{return false}}function xx(t){if(Sx(t)){return t.substr(1,t.length-2)}else{return t}}hx.parseTag=mx;hx.parseAttr=gx;var _x=mS.exports.FilterCSS;var Mx=pS;var kx=hx;var Tx=kx.parseTag;var Ax=kx.parseAttr;var Ix=OS;function jx(t){return t===undefined||t===null}function Cx(t){var e=Ix.spaceIndex(t);if(e===-1){return{html:"",closing:t[t.length-2]==="/"}}t=Ix.trim(t.slice(e+1,-1));var i=t[t.length-1]==="/";if(i)t=Ix.trim(t.slice(0,-1));return{html:t,closing:i}}function Ex(t){var e={};for(var i in t){e[i]=t[i]}return e}function Ox(t){var e={};for(var i in t){if(Array.isArray(t[i])){e[i.toLowerCase()]=t[i].map((function(t){return t.toLowerCase()}))}else{e[i.toLowerCase()]=t[i]}}return e}function Lx(t){t=Ex(t||{});if(t.stripIgnoreTag){if(t.onIgnoreTag){console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time')}t.onIgnoreTag=Mx.onIgnoreTagStripAll}if(t.whiteList||t.allowList){t.whiteList=Ox(t.whiteList||t.allowList)}else{t.whiteList=Mx.whiteList}t.onTag=t.onTag||Mx.onTag;t.onTagAttr=t.onTagAttr||Mx.onTagAttr;t.onIgnoreTag=t.onIgnoreTag||Mx.onIgnoreTag;t.onIgnoreTagAttr=t.onIgnoreTagAttr||Mx.onIgnoreTagAttr;t.safeAttrValue=t.safeAttrValue||Mx.safeAttrValue;t.escapeHtml=t.escapeHtml||Mx.escapeHtml;this.options=t;if(t.css===false){this.cssFilter=false}else{t.css=t.css||{};this.cssFilter=new _x(t.css)}}Lx.prototype.process=function(t){t=t||"";t=t.toString();if(!t)return"";var e=this;var i=e.options;var n=i.whiteList;var s=i.onTag;var r=i.onIgnoreTag;var o=i.onTagAttr;var a=i.onIgnoreTagAttr;var l=i.safeAttrValue;var u=i.escapeHtml;var c=e.cssFilter;if(i.stripBlankChar){t=Mx.stripBlankChar(t)}if(!i.allowCommentTag){t=Mx.stripCommentTag(t)}var h=false;if(i.stripIgnoreTagBody){h=Mx.StripTagBody(i.stripIgnoreTagBody,r);r=h.onIgnoreTag}var d=Tx(t,(function(t,e,i,h,d){var f={sourcePosition:t,position:e,isClosing:d,isWhite:Object.prototype.hasOwnProperty.call(n,i)};var p=s(i,h,f);if(!jx(p))return p;if(f.isWhite){if(f.isClosing){return"</"+i+">"}var m=Cx(h);var y=n[i];var g=Ax(m.html,(function(t,e){var n=Ix.indexOf(y,t)!==-1;var s=o(i,t,e,n);if(!jx(s))return s;if(n){e=l(i,t,e,c);if(e){return t+'="'+e+'"'}else{return t}}else{s=a(i,t,e,n);if(!jx(s))return s;return}}));h="<"+i;if(g)h+=" "+g;if(m.closing)h+=" /";h+=">";return h}else{p=r(i,h,f);if(!jx(p))return p;return u(h)}}),u);if(h){d=h.remove(d)}return d};var Nx=Lx;(function(t,e){var i=pS;var n=hx;var s=Nx;function r(t,e){var i=new s(e);return i.process(t)}e=t.exports=r;e.filterXSS=r;e.FilterXSS=s;(function(){for(var t in i){e[t]=i[t]}for(var s in n){e[s]=n[s]}})();function o(){return typeof self!=="undefined"&&typeof DedicatedWorkerGlobalScope!=="undefined"&&self instanceof DedicatedWorkerGlobalScope}if(o()){self.filterXSS=t.exports}})(fS,fS.exports);var Rx=function(){function t(t,e){var i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]};this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"];this.arcgisFilterOptions={allowCommentTag:true,safeAttrValue:function(t,e,n,s){if(t==="a"&&e==="href"||(t==="img"||t==="source")&&e==="src"){return i.sanitizeUrl(n)}return fS.exports.safeAttrValue(t,e,n,s)}};this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var n;if(t&&!e){n=t}else if(t&&e){n=Object.create(this.arcgisFilterOptions);Object.keys(t).forEach((function(e){if(e==="whiteList"){n.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,t.whiteList||{}])}else{n[e]=t[e]}}))}else{n=Object.create(this.arcgisFilterOptions);n.whiteList=this.arcgisWhiteList}this.xssFilterOptions=n;this._xssFilter=new fS.exports.FilterXSS(n)}t.prototype.sanitize=function(t,e){if(e===void 0){e={}}switch(typeof t){case"number":if(isNaN(t)||!isFinite(t)){return null}return t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,e);default:if(e.allowUndefined&&typeof t==="undefined"){return}return null}};t.prototype.sanitizeUrl=function(t,e){var i=(e!==null&&e!==void 0?e:{}).isProtocolRequired,n=i===void 0?true:i;var s=this._trim(t.substring(0,t.indexOf(":")));var r=t==="/";var o=/^#/.test(t);var a=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;if(r||o||a){return fS.exports.escapeAttrValue(t)}if(!s&&!n){return fS.exports.escapeAttrValue("https://".concat(t))}return""};t.prototype.sanitizeHTMLAttribute=function(t,e,i,n){if(typeof this.xssFilterOptions.safeAttrValue==="function"){return this.xssFilterOptions.safeAttrValue(t,e,i,n)}return fS.exports.safeAttrValue(t,e,i,n)};t.prototype.validate=function(t,e){if(e===void 0){e={}}var i=this.sanitize(t,e);return{isValid:t===i,sanitized:i}};t.prototype.encodeHTML=function(t){var e=this;return String(t).replace(/[&<>"'\/]/g,(function(t){return e._entityMap[t]}))};t.prototype.encodeAttrValue=function(t){var e=/^[a-zA-Z0-9]$/;return String(t).replace(/[\x00-\xFF]/g,(function(i,n){return!e.test(i)?"&#x".concat(Number(t.charCodeAt(n)).toString(16),";"):i}))};t.prototype._extendObjectOfArrays=function(t){var e={};t.forEach((function(t){Object.keys(t).forEach((function(i){if(Array.isArray(t[i])&&Array.isArray(e[i])){e[i]=e[i].concat(t[i])}else{e[i]=t[i]}}))}));return e};t.prototype._iterateOverObject=function(t,e){var i=this;if(e===void 0){e={}}try{var n=false;var s=void 0;if(Array.isArray(t)){s=t.reduce((function(t,s){var r=i.validate(s,e);if(r.isValid){return t.concat([s])}else{n=true;return t.concat([r.sanitized])}}),[])}else if(!dS(t)){if(e.allowUndefined&&typeof t==="undefined"){return}return null}else{var r=Object.keys(t);s=r.reduce((function(s,r){var o=t[r];var a=i.validate(o,e);if(a.isValid){s[r]=o}else{n=true;s[r]=a.sanitized}return s}),{})}if(n){return s}return t}catch(t){return null}};t.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")};return t}();const Px=new Map;function Fx(){Px.clear()}function Dx(t){return Px.get(t)}function $x(t,e){Px.set(t,e)}function zx(t){Px.delete(t)}const Ux=()=>Ft.getLogger("esri.widgets.support.widgetUtils");function Vx(...t){const e=ai.acquire();for(let i=0;i<t.length;i++){const n=t[i],s=typeof n;if("string"===s)e.push(n);else if(Array.isArray(n))e.push.apply(e,n);else if("object"===s)for(const t in n)n[t]&&e.push(t)}const i=e.join(" ");return ai.release(e),i}const Gx=(()=>{const t=new Map,e=new ResizeObserver((e=>{Fx();for(const i of e)t.get(i.target)?.(i)})),i=(i,n,s)=>(t.has(i)&&Ux().error("Already observing element",i),t.set(i,n),e.observe(i,s),Zt((()=>{e.unobserve(i),t.delete(i)})));return(t,e,n)=>{let s=null;return Kt([fy((()=>"function"==typeof t?t():t),(t=>{s?.remove(),t&&(s=i(t,e,n))}),My),Zt((()=>s?.remove()))])}})();function Bx(t){const e=t?.closest("[dir]");return null!==e&&e instanceof HTMLElement&&"rtl"===e.dir||"rtl"===document.dir}function qx(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function Hx(t){const e="data-node-ref";this[t.getAttribute(e)]=t}const Wx=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup",...["animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"]],Zx=Wx.reduce(((t,e)=>(t[e]=[],t)),{}),Jx=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],Kx=new Rx({whiteList:Zx,onTagAttr:(t,e,i)=>{const n=`${e}="${i}"`;if(Jx.includes(e))return n},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function Yx(t,e){const i=t.getBoundingClientRect(),n=e.getBoundingClientRect(),s=i.top+i.height,r=n.top+n.height,o=i.top,a=n.top;(s>r||o<a)&&t.scrollIntoView({block:"end"})}function Qx(t){return"Enter"===t||" "===t}const Xx="http://www.w3.org/",t_=`${Xx}2000/svg`,e_=`${Xx}1999/xlink`;let i_=[],n_=(t,e)=>{let i={};return Object.keys(t).forEach((e=>{i[e]=t[e]})),e&&Object.keys(e).forEach((t=>{i[t]=e[t]})),i},s_=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),r_=t=>{if("string"!=typeof t)throw new Error("Style values must be strings")},o_=(t,e,i)=>{if(""!==e.vnodeSelector)for(let n=i;n<t.length;n++)if(s_(t[n],e))return n;return-1},a_=(t,e,i,n)=>{let s=t[e];if(""===s.vnodeSelector)return;let r=s.properties;if(!(r?void 0===r.key?r.bind:r.key:void 0))for(let r=0;r<t.length;r++)if(r!==e){let e=t[r];if(s_(e,s))throw new Error(`${i.vnodeSelector} had a ${s.vnodeSelector} child ${"added"===n?n:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},l_=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},u_=[],c_=!1,h_=t=>{(t.children||[]).forEach(h_),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},d_=()=>{c_=!1,u_.forEach(h_),u_.length=0},f_=t=>{u_.push(t),c_||(c_=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(d_,{timeout:16}):setTimeout(d_,16))},p_=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i){e.style.pointerEvents="none";let n=()=>{e.parentNode&&(e.parentNode.removeChild(e),f_(t))};return void i(e,n,t.properties)}}e.parentNode&&(e.parentNode.removeChild(e),f_(t))},m_=(t,e,i)=>{if(!e)return;let n=i.eventHandlerInterceptor,s=Object.keys(e),r=s.length;for(let o=0;o<r;o++){let r=s[o],a=e[r];if("className"===r)throw new Error('Property "className" is not supported, use "class".');if("class"===r)S_(t,a,!0);else if("classes"===r){let e=Object.keys(a),i=e.length;for(let n=0;n<i;n++){let i=e[n];a[i]&&t.classList.add(i)}}else if("styles"===r){let e=Object.keys(a),n=e.length;for(let s=0;s<n;s++){let n=e[s],r=a[n];r&&(r_(r),i.styleApplyer(t,n,r))}}else if("key"!==r&&null!=a){let s=typeof a;"function"===s?(0===r.lastIndexOf("on",0)&&(n&&(a=n(r,a,t,e)),"oninput"===r&&function(){let t=a;a=function(e){t.apply(this,[e]),e.target["oninput-value"]=e.target.value}}()),t[r]=a):i.namespace===t_?"href"===r?t.setAttributeNS(e_,r,a):t.setAttribute(r,a):"string"===s&&"value"!==r?"innerHTML"===r?t[r]=Kx.sanitize(a):y_(t)&&r in t?t[r]=a:t.setAttribute(r,a):t[r]=a}}};function y_(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let g_,v_=(t,e,i)=>{if(e)for(let n of e)b_(n,t,void 0,i)},w_=(t,e,i)=>{v_(t,e.children,i),e.text&&(t.textContent=e.text),m_(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},b_=(t,e,i,n)=>{let s,r=0,o=t.vnodeSelector,a=e.ownerDocument;if(""===o)s=t.domNode=a.createTextNode(t.text),void 0!==i?e.insertBefore(s,i):e.appendChild(s);else{for(let l=0;l<=o.length;++l){let u=o.charAt(l);if(l===o.length||"."===u||"#"===u){let u=o.charAt(r-1),c=o.slice(r,l);"."===u?s.classList.add(c):"#"===u?s.id=c:("svg"===c&&(n=n_(n,{namespace:t_})),void 0!==n.namespace?s=t.domNode=a.createElementNS(n.namespace,c):(s=t.domNode=t.domNode||a.createElement(c),"input"===c&&t.properties&&void 0!==t.properties.type&&s.setAttribute("type",t.properties.type)),void 0!==i?e.insertBefore(s,i):s.parentNode!==e&&e.appendChild(s)),r=l+1}}w_(s,t,n)}},S_=(t,e,i)=>{e&&e.split(" ").forEach((e=>{e&&t.classList.toggle(e,i)}))},x_=(t,e,i,n)=>{if(!i)return;let s=!1,r=Object.keys(i),o=r.length;for(let a=0;a<o;a++){let o=r[a],l=i[o],u=e[o];if("class"===o)u!==l&&(S_(t,u,!1),S_(t,l,!0));else if("classes"===o){let e=t.classList,i=Object.keys(l),n=i.length;for(let t=0;t<n;t++){let n=i[t],r=!!l[n];r!==!!u[n]&&(s=!0,r?e.add(n):e.remove(n))}}else if("styles"===o){let e=Object.keys(l),i=e.length;for(let r=0;r<i;r++){let i=e[r],o=l[i];o!==u[i]&&(s=!0,o?(r_(o),n.styleApplyer(t,i,o)):n.styleApplyer(t,i,""))}}else if(l||"string"!=typeof u||(l=""),"value"!==o||y_(t)){if(l!==u){let e=typeof l;"function"===e&&n.eventHandlerInterceptor||(n.namespace===t_?"href"===o?t.setAttributeNS(e_,o,l):t.setAttribute(o,l):"string"===e?"innerHTML"===o?t[o]=Kx.sanitize(l):"role"===o&&""===l?t.removeAttribute(o):y_(t)&&o in t?t[o]=l:t.setAttribute(o,l):t[o]!==l&&(t[o]=l),s=!0)}}else{let e=t[o];e!==l&&(t["oninput-value"]?e===t["oninput-value"]:l!==u)&&(t[o]=l,t["oninput-value"]=void 0),l!==u&&(s=!0)}}return s},__=(t,e,i,n,s)=>{if(i===n)return!1;n=n||i_;let r,o=(i=i||i_).length,a=n.length,l=0,u=0,c=!1;for(;u<a;){let a=l<o?i[l]:void 0,h=n[u];if(void 0!==a&&s_(a,h))c=g_(a,h,s)||c,l++;else{let a=o_(i,h,l+1);if(a>=0){for(r=l;r<a;r++)p_(i[r]),a_(i,r,t,"removed");c=g_(i[a],h,s)||c,l=a+1}else b_(h,e,l<o?i[l].domNode:void 0,s),l_(h),a_(n,u,t,"added")}u++}if(o>l)for(r=l;r<o;r++)p_(i[r]),a_(i,r,t,"removed");return c};g_=(t,e,i)=>{let n=t.domNode,s=!1;if(t===e)return!1;let r=!1;if(""===e.vnodeSelector){if(e.text!==t.text){let t=n.ownerDocument.createTextNode(e.text);return n.parentNode.replaceChild(t,n),e.domNode=t,s=!0,s}e.domNode=n}else 0===e.vnodeSelector.lastIndexOf("svg",0)&&(i=n_(i,{namespace:t_})),t.text!==e.text&&(r=!0,void 0===e.text?n.removeChild(n.firstChild):n.textContent=e.text),e.domNode=n,r=__(e,n,t.children,e.children,i)||r,r=x_(n,t.properties,e.properties,i)||r,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[n,i,e.vnodeSelector,e.properties,e.children]);return r&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(n,e.properties,t.properties),s};let M_=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let n=t;t=i,g_(n,i,e)},domNode:t.domNode});const k_={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}};let T_=t=>n_(k_,t),A_={create:(t,e)=>(e=T_(e),b_(t,document.createElement("div"),void 0,e),M_(t,e)),append:(t,e,i)=>(i=T_(i),b_(e,t,void 0,i),M_(e,i)),insertBefore:(t,e,i)=>(i=T_(i),b_(e,t.parentNode,t,i),M_(e,i)),merge:(t,e,i)=>(i=T_(i),e.domNode=t,w_(t,e,i),M_(e,i)),replace:(t,e,i)=>(i=T_(i),b_(e,t.parentNode,t,i),t.parentNode.removeChild(t),M_(e,i))};let I_,j_=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};I_=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let C_=(t,e)=>{let i=t;return e.forEach((t=>{i=i&&i.children?I_(i.children,(e=>e.domNode===t)):void 0})),i},E_=(t,e,i)=>{let n=function(n){i("domEvent",n);let s=e(),r=j_(n.currentTarget,s.domNode);r.reverse();let o,a=C_(s.getLastRender(),r);return t.scheduleRender(),a&&(o=a.properties[`on${n.type}`].apply(a.properties.bind||this,arguments)),i("domEventProcessed",n),o};return(t,e,i,s)=>n},O_=t=>{let e,i,n=T_(t),s=n.performanceLogger,r=!0,o=!1,a=[],l=[],u=(t,i,r)=>{let o,u=()=>o;n.eventHandlerInterceptor=E_(e,u,s),o=t(i,r(),n),a.push(o),l.push(r)},c=()=>{if(i=void 0,r){r=!1,s("renderStart",void 0);for(let t=0;t<a.length;t++){let e=l[t]();s("rendered",void 0),a[t].update(e),s("patched",void 0)}s("renderDone",void 0),r=!0}};return e={renderNow:c,scheduleRender:()=>{i||o||(i=requestAnimationFrame(c))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,r=!0,e.scheduleRender()},append:(t,e)=>{u(A_.append,t,e)},insertBefore:(t,e)=>{u(A_.insertBefore,t,e)},merge:(t,e)=>{u(A_.merge,t,e)},replace:(t,e)=>{u(A_.replace,t,e)},detach:t=>{for(let e=0;e<l.length;e++)if(l[e]===t)return l.splice(e,1),a.splice(e,1)[0];throw new Error("renderFunction was not found")}},e};let L_=class extends Vr{constructor(){super(...arguments),this.items=new ty,this._watchUpdatingTracking=new cS,this._callbacks=new Map,this._projector=O_(),this._hiddenProjector=O_()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(t=>{for(const e of t.added){const t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t)}for(const e of t.removed){const t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e)}}))}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const e=this._hiddenSurface,i=this._hiddenProjector;let n;const s=()=>(n=t.render(),n);i.append(e,s),i.renderNow();const r={left:0,top:0,right:0,bottom:0};if(n?.domNode){const t=n.domNode.getBoundingClientRect();r.left=t.left,r.top=t.top,r.right=t.right,r.bottom=t.bottom}for(i.detach(s);e.firstChild;)e.removeChild(e.firstChild);return r}overlaps(t,e){const i=this.computeBoundingRect(t),n=this.computeBoundingRect(e);return Math.max(i.left,n.left)<=Math.min(i.right,n.right)&&Math.max(i.top,n.top)<=Math.min(i.bottom,n.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(t,e){const i=!!e?.disableDecorations;if(!this.items.some((t=>t.visible&&!(i&&t.isDecoration))))return;const n=t.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach((t=>{i&&t.isDecoration||(n.save(),t.renderCanvas(n),n.restore())})),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};o([Us({readOnly:!0})],L_.prototype,"surface",void 0),o([Us({readOnly:!0})],L_.prototype,"items",void 0),o([Us({readOnly:!0})],L_.prototype,"needsRender",null),o([Us({readOnly:!0})],L_.prototype,"_watchUpdatingTracking",void 0),o([Us({readOnly:!0})],L_.prototype,"updating",null),L_=o([Nr("esri.views.overlay.ViewOverlay")],L_);const N_=L_;const R_=[0,0];function P_(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return R_[0]=i.left+(e?.pageXOffset??0),R_[1]=i.top+(e?.pageYOffset??0),R_}function F_(t){t&&(aS(t),t.parentNode&&t.parentNode.removeChild(t))}function D_(t){const e=document.createElement("div");return t.appendChild(e),e}const $_=16,z_=750,U_=512,V_=2,G_=t=>{let e=class extends t{constructor(...t){super(...t),this._freqInfo={freq:$_,time:z_},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([fy((()=>this.cursor),(t=>{const{surface:e}=this;e&&e.setAttribute("data-cursor",t)})),fy((()=>this.navigating),(t=>{const{surface:e}=this;e&&e.setAttribute("data-navigating",t.toString())}))])}initialize(){const t=c("mac"),e=async()=>{t&&(await gy((()=>this.ready)),this.messagesCommon=await yv("esri/t9n/common").catch((()=>{})))};e(),this.addHandles([fy((()=>this.ui),((t,e)=>this._handleUIChange(t,e)),_y),this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused"))),og(e),fy((()=>[this.surface,this.messagesCommon]),(()=>{t&&this.surface?.setAttribute("aria-label",this.messagesCommon?.ariaLabels?.navigationMacVoiceOver??"")}))])}destroy(){this.destroyed||(this.ui=$t(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(t){const e=this._get("container"),i=oS(t);if(i||"string"!=typeof t||Ft.getLogger(this).error("#container",`element with id '${t}' not found`),e===i)return;if(this._stopMeasuring(),e&&(e.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(F_(this.root),this._set("root",null)),this.userContent&&(uS(this.userContent,e),F_(this.userContent),this._set("userContent",null))),!i)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);i.classList.add("esri-view");const n=document.createElement("div");n.className="esri-view-user-storage",uS(i,n),i.appendChild(n),this._set("userContent",n);const s=document.createElement("div");s.className="esri-view-root",i.insertBefore(s,i.firstChild),this._set("root",s);const r=document.createElement("div");r.className="esri-view-surface",r.setAttribute("role","application"),r.tabIndex=0,s.appendChild(r),this._set("surface",r);const o=new N_;s.appendChild(o.surface),this._set("overlay",o),this.addHandles(fy((()=>o.needsRender),(t=>{t&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=un({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=Ut(this._overlayRenderTaskHandle)}))),this.forceDOMReadyCycle(),this._set("container",i),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}get size(){return[this.width,this.height]}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(t,e,i){const n=this.position;return t-=n?n[0]:0,e-=n?n[1]:0,i?(i[0]=t,i[1]=e):i=[t,e],i}containerToPage(t,e,i){const n=this.position;return t+=n?n[0]:0,e+=n?n[1]:0,i?(i[0]=t,i[1]=e):i=[t,e],i}_handleUIChange(t,e){this.removeHandles("ui"),e&&e!==t&&e.destroy(),t&&(t.view=this,this.addHandles(fy((()=>this.root),(e=>{t.container=e?D_(e):null}),_y),"ui")),this._set("ui",t)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=$_,t.time=z_,this.addHandles([Mi(window,"resize",(()=>{t.freq=$_,t.time=z_})),un({prepare:t=>{const e=this._measure(),i=this._freqInfo;if(i.time+=t.deltaTime,e&&(i.freq=$_,this._get("resizing")||this._set("resizing",!0)),i.time<i.freq)return;i.time=0;const n=this._position();i.freq=n||e?$_:Math.min(z_,i.freq*V_),!e&&i.freq>=U_&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,e=t?t.clientWidth:0,i=t?t.clientHeight:0;if(0===e||0===i)return this.suspended||this._set("suspended",!0),!1;const n=this.width,s=this.height;return e===n&&i===s?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",e),this._set("height",i),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:s,width:e,height:i}),!0)}_position(){const t=this.container,e=this.position,i=t&&P_(t);return!!i&&((!e||i[0]!==e[0]||i[1]!==e[1])&&(this._set("position",[i[0],i[1]]),!0))}forceDOMReadyCycle(){}};return o([Us()],e.prototype,"container",null),o([Us({readOnly:!0})],e.prototype,"focused",null),o([Us({readOnly:!0})],e.prototype,"height",void 0),o([Us()],e.prototype,"messagesCommon",void 0),o([Us({type:N_})],e.prototype,"overlay",void 0),o([Us({readOnly:!0})],e.prototype,"position",void 0),o([Us({readOnly:!0})],e.prototype,"resizing",void 0),o([Us({readOnly:!0})],e.prototype,"root",void 0),o([Us({value:null,readOnly:!0})],e.prototype,"size",null),o([Us({readOnly:!0})],e.prototype,"surface",void 0),o([Us({readOnly:!0})],e.prototype,"suspended",void 0),o([Us()],e.prototype,"ui",void 0),o([Us({readOnly:!0})],e.prototype,"userContent",void 0),o([Us({readOnly:!0})],e.prototype,"width",void 0),o([Us()],e.prototype,"widthBreakpoint",void 0),e=o([Nr("esri.views.DOMContainer")],e),e};class B_{constructor(t,e){this._owner=e,this._properties={},this._afterDispatchHandle=null;for(const e in t){const i=t[e],n=new ui(i,void 0,void 0,2,2);this._properties[e]={pool:n,acquired:[]}}this._afterDispatchHandle=Qn((()=>this._release()))}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const t in this._properties){const e=this._properties[t];for(const t of e.acquired)rs(t)||e.pool.release(t);e.pool.destroy(),e.pool=null,e.acquired=null}this._properties=null,this._owner=null}get(t){const e=this._owner._get(t),i=this._properties[t];let n=i.pool.acquire();for(i.acquired.push(n);n===e;)i.acquired.push(n),n=i.pool.acquire();return n}_release(){for(const t in this._properties){const e=this._properties[t];let i=0;for(const t of e.acquired)rs(t)?e.acquired[i++]=t:e.pool.release(t);e.acquired.length=i}}}const q_=c("mac")?"Meta":"Ctrl",H_=new Set(["Alt","Ctrl","Meta","Shift","Primary"]),W_=t=>H_.has(t);class Z_{constructor(t,e=[]){this.eventType=t,this.keyModifiers=e}matches(t){if(t.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;const e=t.modifiers;for(const t of this.keyModifiers)if(!e.has(t))return!1;return!0}}const J_=()=>Ft.getLogger("esri.views.input.InputHandler");class K_{constructor(t){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const t in this._incoming){const e=this._incoming[t];for(const t of e)this._incomingEventMatches.push(t.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((t=>t.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(t){this._manager?J_().error("This InputHandler has already been registered with an InputManager"):(t.setEventCallback((t=>this._handleEvent(t))),t.setUninstallCallback((()=>this._onUninstall())),this._manager=t)}onUninstall(){}registerIncoming(t,e,i){let n;"function"==typeof e?(i=e,n=[]):n=e||[];const s="string"==typeof t?new Z_(t,n):t,r=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},o=t=>{const e=this._incoming[t.match.eventType];if(e){const i=e.indexOf(t);e.splice(i,1),r(),this._manager&&this._manager.updateDependencies()}},a=new Y_(s,i,{onPause:o,onRemove:o,onResume:t=>{const e=this._incoming[t.match.eventType];e&&!e.includes(t)&&(e.push(t),r(),this._manager&&this._manager.updateDependencies())}});let l=this._incoming[s.eventType];return l||(l=[],this._incoming[s.eventType]=l),l.push(a),r(),this._manager&&this._manager.updateDependencies(),a}registerOutgoing(t){if(this._outgoing[t])throw new Error("There is already a callback registered for this outgoing InputEvent: "+t);const e=new Q_(t,{onEmit:(t,e,i,n)=>{this._manager?.emit(t.eventType,e,i,n)},onRemove:t=>{delete this._outgoing[t.eventType],this._manager?.updateDependencies()}});return this._outgoing[t]=e,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),e}startCapturingPointer(t){this._manager?.setPointerCapture(t,!0)}stopCapturingPointer(t){this._manager?.setPointerCapture(t,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):J_().error("This InputHandler is not registered with an InputManager")}_handleEvent(t){const e=this._incoming[t.type];if(e)for(const i of e)if(i.match.matches(t)&&(i.callback?.(t),t.shouldStopPropagation()))break}}class Y_{constructor(t,e,i){this.match=t,this._callback=e,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}}class Q_{constructor(t,e){this.eventType=t,this._removed=!1,this._handler=e}emit(t,e,i){this._removed||this._handler.onEmit(this,t,e,i)}remove(){this._removed=!0,this._handler.onRemove(this)}}class X_ extends K_{constructor(t){super(!0),this._onChange=t,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",(t=>{this._update(t.data)}))}_update(t){const e="touch"===t.native.pointerType?"touch":"mouse",{x:i,y:n}=t;e===this._value&&this._x===i&&this._y===n||(this._value=e,this._x=i,this._y=n,this._onChange(e,i,n))}}class tM{constructor(t,e){this._observable=new $m,this._value=t,this._equalityFunction=e}get value(){return Ee(this._observable),this._value}set value(t){this._equalityFunction(t,this._value)||(this._value=t,this._observable.notify())}mutate(t){t(this._value),this._observable.notify()}}function eM(t,e=wt){return new tM(t,e)}class iM extends K_{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=eM(!1),this._onPointerAdd=({data:t})=>{"touch"===t.pointerType&&(this._activeTouchPointerIds.add(t.native.pointerId),this._update())},this._onPointerRemove=({data:t})=>{"touch"===t.pointerType&&(this._activeTouchPointerIds.delete(t.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}}let nM=class extends Vr{constructor(t){super(t),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=q_,this._latestPointerType="mouse",this._propertiesPool=new B_({latestPointerLocation:lM},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const t=Object.keys(this._nameToGroup);for(const e of t)this.uninstallHandlers(e);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some((t=>t.handler.hasPendingInputs))}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(t,e,i=oM.INTERNAL){if(this._nameToGroup[t])return void Ft.getLogger(this).error("There is already an InputHandler group registered under the name `"+t+"`");if(0===e.length)return void Ft.getLogger(this).error("Can't register a group of zero handlers");const n={name:t,handlers:e.map((t=>({handler:t,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[t]=n;for(let t=n.handlers.length-1;t>=0;t--){const e=n.handlers[t];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(t,i,n,s,r)=>{this._emitInputEvent(e.priorityIndex+1,t,i,n,r,s)},setPointerCapture:(t,i)=>{this._setPointerCapture(n,e,t,i)},setEventCallback:t=>{e.eventCallback=t},setUninstallCallback:t=>{e.uninstallCallback=t},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(t){const e=this._nameToGroup[t];e?(e.handlers.forEach((t=>{t.removed=!0,t.uninstallCallback?.()})),delete this._nameToGroup[t],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):Ft.getLogger(this).error("There is no InputHandler group registered under the name `"+t+"`")}hasHandlers(t){return void 0!==this._nameToGroup[t]}isModifierKeyDown(t){return this._activeKeyModifiers&&this._activeKeyModifiers.has(t)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const t=new Set,e=new Set;this._handlersPriority=[];for(let t=this._handlers.length-1;t>=0;t--){const e=this._handlers[t];e.priorityIndex=t,this._handlersPriority.push(e)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const n=this._handlersPriority[i];n.priorityIndex=i;let s=n.handler.hasSideEffects;if(!s)for(const e of n.handler.outgoingEventTypes)if(t.has(e)){s=!0;break}if(s)for(const i of n.handler.incomingEventMatches){t.add(i.eventType);for(const t of i.keyModifiers)W_(t)||e.add(t)}n.active=s}this._sourceEvents=t,this._keyModifiers=e,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(t,e,i){this._latestPointerType=t;const n=this._get("latestPointerLocation");if(null==n||n.x!==e||n.y!==i){const t=this._propertiesPool.get("latestPointerLocation");t.x=e,t.y=i,this._set("latestPointerLocation",t)}}_onEventReceived(t,e){if("pointer-capture-lost"===t){const t=e;this._pointerCaptures.delete(t.native.pointerId)}this._updateKeyModifiers(t,e);const i=null!=this.test.timestamp?this.test.timestamp:e.native?e.native.timestamp:void 0,n=e.native?e.native.cancelable:void 0;this._emitInputEventFromSource(t,e,i,n)}_updateKeyModifiers(t,e){if(!e)return;let i=!1;const n=()=>{if(!i){const t=new Set;this._activeKeyModifiers.forEach((e=>{t.add(e)})),this._activeKeyModifiers=t,i=!0}},s=(t,e)=>{e&&!this._activeKeyModifiers.has(t)?(n(),this._activeKeyModifiers.add(t)):!e&&this._activeKeyModifiers.has(t)&&(n(),this._activeKeyModifiers.delete(t))};if("key-down"===t||"key-up"===t){const i=e.key;this._keyModifiers.has(i)&&s(i,"key-down"===t)}const r=e.native;s("Alt",!(!r||!r.altKey)),s("Ctrl",!(!r||!r.ctrlKey)),s("Shift",!(!r||!r.shiftKey)),s("Meta",!(!r||!r.metaKey)),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new X_(((t,e,i)=>this._setLatestPointer(t,e,i))),this._multiTouchHandler=new iM,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],oM.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,oM.INTERNAL)}_setPointerCapture(t,e,i,n){const s=t.name+"-"+e.priorityIndex,r=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,r),n?(r.add(s),1===r.size&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):r.has(s)&&(r.delete(s),0===r.size&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((t=>!t.removed)),this.updateDependencies()}_emitInputEventFromSource(t,e,i,n){this._emitInputEvent(0,t,e,i,n)}_emitInputEvent(t,e,i,n,s,r){const o=void 0!==n?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==s&&s,l={event:new sM(e,i,o,r||this._activeKeyModifiers,a),priorityIndex:t};this._currentPropagation?this._currentPropagation.events.push(l):this._doNewPropagation(l)}_doNewPropagation(t){this._currentPropagation={events:new ky,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:t.event.timestamp},this._currentPropagation.events.push(t),this._continuePropagation()}_continuePropagation(){this._paused=!1;const t=this._currentPropagation;if(t){for(;t.events.length>0;){const{event:e,priorityIndex:i}=t.events.pop(),n=e.data?.eventId;if(!(null!=n&&this._stoppedPropagationEventIds.has(n)))for(t.currentHandler=this._handlersPriority[i];t.currentHandler;){if(t.currentHandler.removed)t.needsHandlerGarbageCollect=!0;else{if(t.currentHandler.active&&!e.shouldStopPropagation()&&t.currentHandler.eventCallback?.(e),e.shouldStopPropagation()){null!=n&&this._stoppedPropagationEventIds.add(n);break}if(e.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:e,priorityIndex:t.currentHandler.priorityIndex+1})}t.currentHandler=this._handlersPriority[t.currentHandler.priorityIndex+1]}}t.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(t){const e=new ky;e.push(t);const i=this._currentPropagation;if(i){for(;i.events.length;)e.push(i.events.pop());i.events=e,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(t,e){if(t.handler.hasSideEffects!==e.handler.hasSideEffects)return t.handler.hasSideEffects?1:-1;if(t.groupPriority!==e.groupPriority)return t.groupPriority>e.groupPriority?-1:1;for(const i of t.handler.incomingEventMatches)for(const t of e.handler.incomingEventMatches){if(i.eventType!==t.eventType)continue;const e=i.keyModifiers.filter((e=>t.keyModifiers.includes(e)));if(e.length===i.keyModifiers.length!==(e.length===t.keyModifiers.length))return i.keyModifiers.length>t.keyModifiers.length?-1:1}return t.priorityIndex>e.priorityIndex?-1:1}_sortHandlersPriority(t){const e=[];for(const i of t){let t=0;for(;t<e.length&&this._compareHandlerPriority(i,e[t])>=0;)t++;e.splice(t,0,i)}return e}get debug(){const t=t=>{const e=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=e};return{injectEvent:(e,i)=>{t((()=>{this._onEventReceived(e,i)}))},disablePointerCapture:t}}};o([Us({readOnly:!0})],nM.prototype,"hasPendingInputs",null),o([Us({constructOnly:!0})],nM.prototype,"eventSource",void 0),o([Us({constructOnly:!0})],nM.prototype,"recognizers",void 0),o([Us()],nM.prototype,"_latestPointerType",void 0),o([Us()],nM.prototype,"latestPointerType",null),o([Us()],nM.prototype,"multiTouchActive",null),o([Us({readOnly:!0})],nM.prototype,"latestPointerLocation",void 0),o([Us()],nM.prototype,"_paused",void 0),o([Us({readOnly:!0})],nM.prototype,"updating",null),nM=o([Nr("esri.views.input.InputManager")],nM);class sM{constructor(t,e,i,n,s){this.type=t,this.data=e,this.timestamp=i,this.modifiers=n,this.cancelable=s,this._propagationState=rM.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=rM.STOPPED}shouldStopPropagation(){return 0!=(this._propagationState&rM.STOPPED)}async(t){this._propagationState|=rM.PAUSED;const e=(t,e)=>{this._propagationState&=~rM.PAUSED;const i=this._resumeCallback;if(this._resumeCallback=null,i&&i(),e)throw t;return t};return("function"==typeof t?t():t).then((t=>e(t,!1)),(t=>e(t,!0)))}shouldPausePropagation(t){return!!(this._propagationState&rM.PAUSED)&&(this._resumeCallback=t,!0)}preventDefault(){this.data.native.preventDefault()}}var rM;!function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"}(rM||(rM={}));const oM={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};class aM{}const lM=aM;function uM(t){return null!=t&&"open"in t&&"declaredClass"in t}function cM(t){return null!=t&&"declaredClass"in t&&"dockOptions"in t}const hM=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([fy((()=>[this.ui,this.popup]),(([t,e],i)=>{const n="popup",s="manual";if(i){const[t,e]=i;t&&uM(e)&&(e.view=null,cM(e)&&t.remove(e,n))}t&&uM(e)&&(e.view=this,cM(e)&&t.add(e,{key:n,position:s,internal:!0}))}),_y),this.on("click",(t=>{this.popup&&this.popupEnabled&&("mouse"!==t.pointerType||0===t.button)&&(!uM(this.popup)&&"autoOpenEnabled"in this.popup&&!1===this.popup.autoOpenEnabled||(uM(this.popup)?this.popup.viewModel.handleViewClick(t):t.async((async()=>{await this.setupPopup(),uM(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(t)}))))}),oM.WIDGET)]),gy((()=>this.ready&&this.popupEnabled&&!this.updating)).then((()=>{import("./p-28b5901f.js")}))}destroy(){this.destroyed||this.closePopup()}async openPopup(t){if(uM(this.popup))return this.popup.open(t);try{if(await this.setupPopup(),!this.popup)return void Ft.getLogger(this).error(new Qe("view:null-popup","Popup is null and can't be opened"));this.popup.open(t)}catch{}}closePopup(){this._popupSetupTask?.abort(),uM(this.popup)&&this.popup.close()}async fetchPopupFeatures(t,e){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(t,e),e)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!uM(this.popup))return this._popupSetupTask=uy((async t=>{const{default:e}=await import("./p-28b5901f.js");if(Ii(t),!this.popup||uM(this.popup))return;const i=this.popup;delete i.open,delete i.close,this.popup=new e(i)})),this._popupSetupTask.promise}async _popupHitsToFeatures({location:t,hits:e},i){const n=[],s=[];let r=!1;const o=Vi(i,c("popup-view-fetch-timeout")??fM),a=t=>{const e=new dM(t);return s.push(e),n.push(e.promise),e},l=t=>{const e=s.at(-1);return e&&e.layerView===t&&!r?e:a(t)};for(const t of e)if("graphic"in t){l(t.layerView).graphics.push(t.graphic),r=!1}else n.push(t.layerView.fetchPopupFeaturesAtLocation(t.mapPoint,o)),r=!0;s.map((t=>t.resolve(o)));const u=$i(n).then((t=>t.filter((t=>!!t)).flat()));return{pendingFeatures:n,allGraphicsPromise:u,location:t}}async _getPopupHits(t,e){const{hits:i,location:n}=await this.popupHitTest(t);Ii(e);const s=[];for(const t of i)if("graphic"in t){if(this._isValidPopupGraphic(t.graphic,e)){const e=this._isValidPopupGraphicsLayerView(t.layerView)?t.layerView:void 0;s.push({graphic:t.graphic,layerView:e})}}else this._isValidPopupLocationLayerView(t.layerView)&&s.push({mapPoint:t.mapPoint,layerView:t.layerView});return{hits:s,location:n}}_isValidPopupGraphic(t,e){return t&&!!t.getEffectivePopupTemplate(null!=e&&e.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(t){return!t||(!("layer"in t)||!t.suspended)&&"fetchPopupFeaturesFromGraphics"in t}_isValidPopupLocationLayerView(t){return(!("layer"in t)||!t.suspended)&&"fetchPopupFeaturesAtLocation"in t}};return o([Us({cast(t){return!t||uM(t)||"object"==typeof t&&(t.open=t=>(m(Ft.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(t)),t.close=()=>(m(Ft.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),t}})],e.prototype,"popup",void 0),o([Us()],e.prototype,"popupEnabled",void 0),e=o([Nr("esri.views.PopupView")],e),e};class dM{constructor(t){this.layerView=t,this._resolver=Hi(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(t){const{layerView:e,graphics:i,_resolver:n}=this;if(!e)return n.resolve(i),n.promise;let s;return e.fetchPopupFeaturesFromGraphics(i,t).catch((t=>(s=t,null))).then((t=>{t?n.resolve(t):n.reject(s)})),n.promise}}const fM=5e3;function pM(t,e,i=ty){return e||(e=new i),e===t||(e.removeAll(),yM(t)?e.addMany(t):t&&e.add(t)),e}function mM(t){return t}function yM(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}var gM;!function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(gM||(gM={}));class vM{constructor(){this._resolver=Hi(),this._status=gM.PENDING,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=gM.RESOLVED,this._cleanUp()}),(()=>{this._status=gM.REJECTED,this._cleanUp()})),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return this._status===gM.RESOLVED}isRejected(){return this._status===gM.REJECTED}isFulfilled(){return this._status!==gM.PENDING}abort(){this._resolver.reject(Ai())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const t=Hi(),e=[...this._resolvingPromises,t.promise],i=this._allPromise=Promise.all(e);i.then((()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()}),(t=>{this.isFulfilled()||this._allPromise!==i||Pi(t)||this._resolver.reject(t)})),t.resolve()}}const wM=t=>{let e=class extends t{constructor(...t){super(...t),this._promiseProps=new vM,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(t,e){return this._promiseProps.promise.then((()=>this)).then(t,e)}catch(t){return this.when(null,t)}addResolvingPromise(t){t&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in t?t.when():t)}};return e=o([Nr("esri.core.Promise")],e),e};let bM=class extends(wM(Vr)){};bM=o([Nr("esri.core.Promise")],bM);const SM="not-loaded",xM="loading",_M="failed",MM="loaded",kM=t=>{let e=class extends t{constructor(...t){super(...t),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((t=>{const e=this.load.bind(this);this.load=i=>{const n=new Promise(((t,e)=>{const n=Ni(i,e);this.destroyed&&e(new Qe("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(t,e).finally((()=>{n&&n.remove()}))}));if(this.loadStatus===SM){this._set("loadStatus",xM);const t=this._loadController=new AbortController;e({signal:t.signal})}return t(),n}}))),this.when((()=>{this._set("loadStatus",MM),this._loadController=null}),(t=>{this._set("loadStatus",_M),this._set("loadError",t),this._loadController=null}))}destroy(){this._loadController&&(this._loadController=Vt(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===MM}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new Qe("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return o([Us({readOnly:!0})],e.prototype,"loaded",null),o([Us({readOnly:!0})],e.prototype,"loadError",void 0),o([Us({clonable:!1})],e.prototype,"loadStatus",void 0),o([Us({type:[Hs],readOnly:!0})],e.prototype,"loadWarnings",null),e=o([Nr("esri.core.Loadable")],e),e};let TM=class extends(kM(bM)){};TM=o([Nr("esri.core.Loadable")],TM),function(t){function e(t){return!(!t||!t.load)}t.LoadableMixin=kM,t.isLoadable=e}(TM||(TM={}));const AM=TM;async function IM(t,e){return await t.load(),jM(t,e)}async function jM(t,e){const i=[],n=(...t)=>{for(const e of t)null!=e&&(Array.isArray(e)?n(...e):ty.isCollection(e)?e.forEach((t=>n(t))):AM.isLoadable(e)&&i.push(e))};e(n);let s=null;if(await iy(i,(async t=>{const e=await ay(CM(t)?t.loadAll():t.load());!1!==e.ok||s||(s=e)})),s)throw s.error;return t}function CM(t){return"loadAll"in t&&"function"==typeof t.loadAll}let EM;function OM(t){return EM&&!EM.destroyed||(EM=t()),EM}var LM;const NM=new ul({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let RM=LM=class extends Vr{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){"asc"!==t&&"desc"!==t||this._set("sortOrder",t)}clone(){return new LM({categories:this.categories?ht(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map((t=>Array.isArray(t)?JSON.stringify(t):t)));let n="";if(this.extent){const t=Gd(this.extent,jd.WGS84);null!=t&&(n=`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`)}let s=this.query;!this.disableExtraQuery&&t.extraQuery&&(s="("+s+")"+t.extraQuery);const r={categories:i,bbox:n,q:s,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(r.sortField=this.sortField.split(",").map((t=>NM.toJSON(t.trim()))).join(","),r.sortOrder=this.sortOrder),{query:{...e,...r}}}};o([Us()],RM.prototype,"categories",void 0),o([Us()],RM.prototype,"disableExtraQuery",void 0),o([Us({type:Rf})],RM.prototype,"extent",void 0),o([Us()],RM.prototype,"filter",void 0),o([Us()],RM.prototype,"num",void 0),o([Us()],RM.prototype,"query",void 0),o([Us()],RM.prototype,"sortField",void 0),o([Us()],RM.prototype,"sortOrder",null),o([Us()],RM.prototype,"start",void 0),RM=LM=o([Nr("esri.portal.PortalQueryParams")],RM);const PM=RM;var FM;let DM=FM=class extends el{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then((e=>{const i=e.categorySchema||[];return i.some((t=>"contentCategorySetsGroupQuery.LivingAtlas"===t.source))?this._fetchCategorySchemaSet("LivingAtlas",t):i}))}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new Qe("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new FM;return e.sourceJSON=t,e.read(t),e}queryItems(t,e){let i=ks(PM,t);const n=this.portal;return parseFloat(n.currentVersion)>5?(i=i||new PM,n.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new PM,i.query="group:"+this.id+(i.query?" "+i.query:""),n.queryItems(i,e))}_fetchCategorySchemaSet(t,e){const i=this.portal;return i.fetchSelf(i.authMode,!0,e).then((t=>{const n=t.contentCategorySetsGroupQuery;if(n){const t=new PM;return t.disableExtraQuery=!0,t.num=1,t.query=n,i.queryGroups(t,e)}throw new Qe("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((i=>{if(i.total){const n=i.results[0],s=new PM;return s.num=1,s.query=`typekeywords:"${t}"`,n.queryItems(s,e)}throw new Qe("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((t=>{if(t.total){return t.results[0].fetchData("json",e).then((t=>{const e=t?.categorySchema;return e?.length?e:[]}))}return[]}))}};o([Us()],DM.prototype,"access",void 0),o([Us({type:Date})],DM.prototype,"created",void 0),o([Us()],DM.prototype,"description",void 0),o([Us()],DM.prototype,"id",void 0),o([Us()],DM.prototype,"isInvitationOnly",void 0),o([Us({type:Date})],DM.prototype,"modified",void 0),o([Us()],DM.prototype,"owner",void 0),o([Us()],DM.prototype,"portal",void 0),o([Us()],DM.prototype,"snippet",void 0),o([Us()],DM.prototype,"sortField",void 0),o([Us()],DM.prototype,"sortOrder",void 0),o([Us()],DM.prototype,"sourceJSON",void 0),o([Us()],DM.prototype,"tags",void 0),o([Us()],DM.prototype,"thumbnail",void 0),o([Us({readOnly:!0})],DM.prototype,"thumbnailUrl",null),o([Us()],DM.prototype,"title",void 0),o([Us({readOnly:!0})],DM.prototype,"url",null),DM=FM=o([Nr("esri.portal.PortalGroup")],DM);const $M=DM;let zM=class extends Vr{constructor(t){super(t),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};o([Us()],zM.prototype,"nextQueryParams",void 0),o([Us()],zM.prototype,"queryParams",void 0),o([Us()],zM.prototype,"results",void 0),o([Us()],zM.prototype,"total",void 0),zM=o([Nr("esri.portal.PortalQueryResult")],zM);const UM=zM;let VM=class extends el{constructor(t){super(t),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Qe("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};o([Us({type:Date})],VM.prototype,"created",void 0),o([Us()],VM.prototype,"id",void 0),o([Us()],VM.prototype,"portal",void 0),o([Us()],VM.prototype,"title",void 0),o([Us({readOnly:!0})],VM.prototype,"url",null),o([Us()],VM.prototype,"username",void 0),VM=o([Nr("esri.portal.PortalFolder")],VM);const GM=VM;var BM;let qM=BM=class extends el{constructor(...t){super(...t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.username}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t?.data,n=t?.folder,s={method:"post"};e&&(s.query=e.createPostQuery(),null!=i&&("string"==typeof i?s.query.text=i:"object"==typeof i&&(s.query.text=JSON.stringify(i))));let r=this.userContentUrl;return n&&(r+="/"+("string"==typeof n?n:n.id)),this.portal.request(r+"/addItem",s).then((t=>(e.id=t.id,e.portal=this.portal,e.loaded?e.reload():e.load())))}deleteItem(t){let e=this.userContentUrl;return t.ownerFolder&&(e+="/"+t.ownerFolder),this.portal.request(e+`/items/${t.id}/delete`,{method:"post"}).then((()=>{t.id=null,t.portal=null}))}deleteItems(t){const e=this.userContentUrl+"/deleteItems",i=t.map((t=>t.id));if(i.length){const n={method:"post",query:{items:i.join(",")}};return this.portal.request(e,n).then((()=>{t.forEach((t=>{t.id=null,t.portal=null}))}))}return Promise.resolve(void 0)}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then((t=>{let e;return e=t&&t.folders?t.folders.map((t=>{const e=GM.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchGroups(){return this.portal.request(this.url??"").then((t=>{let e;return e=t&&t.groups?t.groups.map((t=>{const e=$M.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchItems(t){const e=t??{};let i,n=this.userContentUrl??"";return e.folder&&(n+="/"+e.folder.id),Promise.resolve().then((function(){return _k})).then((({default:t})=>{i=t;const s={folders:!1,num:e.num||10,start:e.start||1,sortField:e.sortField||"created",sortOrder:e.sortOrder||"asc"};return this.portal.request(n,{query:s})})).then((t=>{let e;return t?.items?(e=t.items.map((t=>{const e=i.fromJSON(t);return e.portal=this.portal,e})),Promise.all(e.map((t=>t.load()))).catch((t=>t)).then((()=>({items:e,nextStart:t.nextStart,total:t.total})))):{items:[],nextStart:-1,total:0}}))}fetchTags(){return this.portal.request(this.url+"/tags").then((t=>t.tags))}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new $M({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Qe("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new Qe("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new BM;return e.sourceJSON=t,e.read(t),e}};o([Us()],qM.prototype,"access",void 0),o([Us({type:Date})],qM.prototype,"created",void 0),o([Us()],qM.prototype,"culture",void 0),o([Us()],qM.prototype,"description",void 0),o([Us()],qM.prototype,"email",void 0),o([Us()],qM.prototype,"favGroupId",void 0),o([Us()],qM.prototype,"fullName",void 0),o([Us({type:Date})],qM.prototype,"modified",void 0),o([Us()],qM.prototype,"orgId",void 0),o([Us()],qM.prototype,"portal",void 0),o([Us()],qM.prototype,"preferredView",void 0),o([Us()],qM.prototype,"privileges",void 0),o([Us()],qM.prototype,"region",void 0),o([Us()],qM.prototype,"role",void 0),o([Us()],qM.prototype,"roleId",void 0),o([Us()],qM.prototype,"sourceJSON",void 0),o([Us()],qM.prototype,"thumbnail",void 0),o([Us({readOnly:!0})],qM.prototype,"thumbnailUrl",null),o([Us()],qM.prototype,"units",void 0),o([Us({readOnly:!0})],qM.prototype,"userContentUrl",null),o([Us({readOnly:!0})],qM.prototype,"url",null),o([Us()],qM.prototype,"username",void 0),o([Us()],qM.prototype,"userType",void 0),qM=BM=o([Nr("esri.portal.PortalUser")],qM);const HM=qM;var WM;let ZM;const JM={PortalGroup:()=>Promise.resolve({default:$M}),PortalItem:()=>Promise.resolve().then((function(){return _k})),PortalUser:()=>Promise.resolve({default:HM})};let KM=WM=class extends(Qa(AM)){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=It.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return"string"==typeof t?{url:t}:t}destroy(){QM.unregister(this),this.defaultBasemap=$t(this.defaultBasemap),this.defaultDevBasemap=$t(this.defaultDevBasemap),this.defaultVectorBasemap=$t(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=Ut(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)It.request.trustedServers.includes(e)||It.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){const t=this.user?.orgId,e=!t||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.substring(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t?t.toLowerCase():t}readUser(t){let e=null;return t&&(e=HM.fromJSON(t),e.portal=this),e}load(t){const e=Promise.resolve().then((function(){return aT})).then((({default:e})=>{Ii(t),ZM=e})).then((()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t))).then((t=>{if(Qu){const t=Qu;this.credential=t.findCredential(this.restUrl),this.credential||this.authMode!==WM.AUTH_MODE_AUTO&&this.authMode!==WM.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=t.on("credential-create",XM(new WeakRef(this))),QM.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(e),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await import("./p-6802401c.js")).default;return t?t.map((t=>new e({id:t.id,url:t.url}))):[]}async fetchBasemaps(t,e){const i=await this._fetchBasemaps(t,e);if(!0===e?.include3d&&!1!==this.use3dBasemaps){const n=await this._fetchBasemaps3D(t,e);i.unshift(...n)}return i}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then((t=>t.categorySchema)):Ci(t)?Promise.reject(Ai()):Promise.resolve([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new PM;if(i.num=100,i.sortField="title",e&&e.length){const n=[];for(const t of e)n.push(`(title:"${t.title}" AND owner:${t.owner})`);return i.query=n.join(" OR "),this.queryGroups(i,t).then((t=>t.results))}return Ci(t)?Promise.reject(Ai()):Promise.resolve([])}fetchRegions(t){const e=this.user?.culture||this.culture||ng();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}fetchSettings(t){const e=this.user?.culture||this.culture||ng();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:e}})}static getDefault(){return OM((()=>new WM))}queryGroups(t,e){return this.queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this.queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",e)}fetchSelf(t=this.authMode,e=!1,i){const n=this.restUrl+"/portals/self",s={authMode:t,query:{culture:ng().toLowerCase()},withCredentials:!0,...i};return"auto"===s.authMode&&(s.authMode="no-prompt"),e&&(s.query.default=!0),this.request(n,s)}queryPortal(t,e,i,n){const s=ks(PM,e),r=e=>this.request(this.restUrl+t,{...s.toRequestOptions(this),...n}).then((t=>{const i=s.clone();return i.start=t.nextStart,new UM({nextQueryParams:i,queryParams:s,total:t.total,results:WM._resultsToTypedArray(e,{portal:this},t,n)})})).then((t=>Promise.all(t.results.map((e=>"function"==typeof e.when?e.when():t))).then((()=>t),(e=>(Ei(e),t)))));return i&&JM[i]?JM[i]().then((({default:t})=>(Ii(n),r(t)))):r()}signIn(){if(this.authMode===WM.AUTH_MODE_ANONYMOUS||this.authMode===WM.AUTH_MODE_NO_PROMPT&&!Qu)return Promise.reject(new Qe("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const t=t=>Promise.resolve().then((()=>"not-loaded"===this.loadStatus?(t||(this.authMode="immediate"),this.load().then((()=>null))):"loading"===this.loadStatus?this.load().then((()=>this.credential?null:(this.credential=t,this.fetchSelf("immediate")))):this.user&&this.credential===t?null:(this.credential=t,this.fetchSelf("immediate")))).then((t=>{t&&(this.sourceJSON=t,this.read(t))}));return Qu?Qu.getCredential(this.restUrl,{prompt:this.authMode!==WM.AUTH_MODE_NO_PROMPT}).then((e=>t(e))):t(this.credential)}normalizeUrl(t){const e=this.credential?.token;return this._normalizeSSL(e?t+(t.includes("?")?"&":"?")+"token="+e:t)}requestToTypedArray(t,e,i){return this.request(t,e).then((t=>{const e=WM._resultsToTypedArray(i,{portal:this},t);return Promise.all(e.map((e=>"function"==typeof e.when?e.when():t))).then((()=>e),(()=>e))}))}request(t,e={}){const i={f:"json",...e.query},{authMode:n=(this.authMode===WM.AUTH_MODE_ANONYMOUS||this.authMode===WM.AUTH_MODE_NO_PROMPT?this.authMode:"auto"),body:s=null,cacheBust:r=!1,method:o="auto",responseType:a="json",signal:l}=e,u={authMode:n,body:s,cacheBust:r,method:o,query:i,responseType:a,timeout:0,signal:l};return e.withCredentials&&(u.withCredentials=!0),hc(this._normalizeSSL(t),u).then((t=>t.data))}toJSON(){throw new Qe("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new WM({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new Qe("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}async _fetchBasemaps(t,e){const i=new PM;i.query=t||(It.apiKey&&nc(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const n=await this.queryGroups(i,e);if(!n.total)return[];const s=n.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=s.sortField||"name",i.sortOrder=s.sortOrder||"desc";const r=await s.queryItems(i,e);if(!r.total)return[];return r.results.filter((t=>"Web Map"===t.type)).map((t=>new ZM({portalItem:t})))}async _fetchBasemaps3D(t,e){const i=t||this.basemapGalleryGroupQuery3D;if(!i)return[];const n=new PM({query:i,disableExtraQuery:!0}),s=await this.queryGroups(n,e);if(!s.total)return[];const r=s.results[0];n.num=100,n.query='type:"Web Scene"',n.sortField=r.sortField||"name",n.sortOrder=r.sortOrder||"desc";const o=await r.queryItems(n,e);if(!o.total)return[];return o.results.filter((t=>"Web Scene"===t.type)).map((t=>new ZM({portalItem:t})))}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const e=ZM.fromJSON(t);return e.portalItem={portal:this},e}return null}static _resultsToTypedArray(t,e,i,n){let s=[];if(i){const r=null!=n?n.signal:null;s=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(s=s.map((i=>{const n=Object.assign(t?t.fromJSON(i):i,e);return"function"==typeof n.load&&n.load(r),n})))}else s=[];return s}};KM.AUTH_MODE_ANONYMOUS="anonymous",KM.AUTH_MODE_AUTO="auto",KM.AUTH_MODE_IMMEDIATE="immediate",KM.AUTH_MODE_NO_PROMPT="no-prompt",o([Us()],KM.prototype,"access",void 0),o([Us()],KM.prototype,"allSSL",void 0),o([Us()],KM.prototype,"authMode",void 0),o([Us()],KM.prototype,"authorizedCrossOriginDomains",void 0),o([al("authorizedCrossOriginDomains")],KM.prototype,"readAuthorizedCrossOriginDomains",null),o([Us()],KM.prototype,"basemapGalleryGroupQuery",void 0),o([Us({json:{name:"3DBasemapGalleryGroupQuery"}})],KM.prototype,"basemapGalleryGroupQuery3D",void 0),o([Us()],KM.prototype,"bingKey",void 0),o([Us()],KM.prototype,"canListApps",void 0),o([Us()],KM.prototype,"canListData",void 0),o([Us()],KM.prototype,"canListPreProvisionedItems",void 0),o([Us()],KM.prototype,"canProvisionDirectPurchase",void 0),o([Us()],KM.prototype,"canSearchPublic",void 0),o([Us()],KM.prototype,"canShareBingPublic",void 0),o([Us()],KM.prototype,"canSharePublic",void 0),o([Us()],KM.prototype,"canSignInArcGIS",void 0),o([Us()],KM.prototype,"canSignInIDP",void 0),o([Us()],KM.prototype,"colorSetsGroupQuery",void 0),o([Us()],KM.prototype,"commentsEnabled",void 0),o([Us({type:Date})],KM.prototype,"created",void 0),o([Us()],KM.prototype,"credential",void 0),o([Us()],KM.prototype,"culture",void 0),o([Us()],KM.prototype,"currentVersion",void 0),o([Us()],KM.prototype,"customBaseUrl",void 0),o([Us()],KM.prototype,"defaultBasemap",void 0),o([al("defaultBasemap")],KM.prototype,"readDefaultBasemap",null),o([Us()],KM.prototype,"defaultDevBasemap",void 0),o([al("defaultDevBasemap")],KM.prototype,"readDefaultDevBasemap",null),o([Us({type:Rf})],KM.prototype,"defaultExtent",void 0),o([Us()],KM.prototype,"defaultVectorBasemap",void 0),o([al("defaultVectorBasemap")],KM.prototype,"readDefaultVectorBasemap",null),o([Us()],KM.prototype,"description",void 0),o([Us()],KM.prototype,"devBasemapGalleryGroupQuery",void 0),o([Us()],KM.prototype,"eueiEnabled",void 0),o([Us({readOnly:!0})],KM.prototype,"extraQuery",null),o([Us()],KM.prototype,"featuredGroups",void 0),o([Us()],KM.prototype,"featuredItemsGroupQuery",void 0),o([Us()],KM.prototype,"galleryTemplatesGroupQuery",void 0),o([Us()],KM.prototype,"layoutGroupQuery",void 0),o([Us()],KM.prototype,"livingAtlasGroupQuery",void 0),o([Us()],KM.prototype,"hasCategorySchema",void 0),o([Us()],KM.prototype,"helpBase",void 0),o([Us()],KM.prototype,"helperServices",void 0),o([Us()],KM.prototype,"helpMap",void 0),o([Us()],KM.prototype,"homePageFeaturedContent",void 0),o([Us()],KM.prototype,"homePageFeaturedContentCount",void 0),o([Us()],KM.prototype,"httpPort",void 0),o([Us()],KM.prototype,"httpsPort",void 0),o([Us()],KM.prototype,"id",void 0),o([Us()],KM.prototype,"ipCntryCode",void 0),o([Us({readOnly:!0})],KM.prototype,"isOrganization",null),o([Us()],KM.prototype,"isPortal",void 0),o([Us()],KM.prototype,"isReadOnly",void 0),o([Us({readOnly:!0})],KM.prototype,"itemPageUrl",null),o([Us()],KM.prototype,"layerTemplatesGroupQuery",void 0),o([Us()],KM.prototype,"maxTokenExpirationMinutes",void 0),o([Us({type:Date})],KM.prototype,"modified",void 0),o([Us()],KM.prototype,"name",void 0),o([Us()],KM.prototype,"portalHostname",void 0),o([Us()],KM.prototype,"portalMode",void 0),o([Us()],KM.prototype,"portalProperties",void 0),o([Us()],KM.prototype,"region",void 0),o([Us({readOnly:!0})],KM.prototype,"restUrl",null),o([Us()],KM.prototype,"rotatorPanels",void 0),o([Us()],KM.prototype,"showHomePageDescription",void 0),o([Us()],KM.prototype,"sourceJSON",void 0),o([Us()],KM.prototype,"staticImagesUrl",void 0),o([Us({json:{name:"2DStylesGroupQuery"}})],KM.prototype,"stylesGroupQuery2d",void 0),o([Us({json:{name:"stylesGroupQuery"}})],KM.prototype,"stylesGroupQuery3d",void 0),o([Us()],KM.prototype,"supportsHostedServices",void 0),o([Us()],KM.prototype,"symbolSetsGroupQuery",void 0),o([Us()],KM.prototype,"templatesGroupQuery",void 0),o([Us()],KM.prototype,"thumbnail",void 0),o([Us({readOnly:!0})],KM.prototype,"thumbnailUrl",null),o([Us()],KM.prototype,"units",void 0),o([Us()],KM.prototype,"url",void 0),o([Us()],KM.prototype,"urlKey",void 0),o([al("urlKey")],KM.prototype,"readUrlKey",null),o([Us()],KM.prototype,"user",void 0),o([al("user")],KM.prototype,"readUser",null),o([Us()],KM.prototype,"use3dBasemaps",void 0),o([Us()],KM.prototype,"useStandardizedQuery",void 0),o([Us()],KM.prototype,"useVectorBasemaps",void 0),o([Us()],KM.prototype,"vectorBasemapGalleryGroupQuery",void 0),KM=WM=o([Nr("esri.portal.Portal")],KM);const YM=KM,QM=new FinalizationRegistry((t=>{t.remove()}));function XM(t){const e=Qu;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch((()=>{}))}}let tk=class extends Vr{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t?.portalItem&&t.path?{...t,path:this._normalizePath(t.path,t.portalItem)}:t}set path(t){null!=t&&uu(t)?Ft.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return this._normalizePath(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",e){const i=this.cdnUrl;if(null==i)throw new Qe("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(i,{responseType:t,query:{token:this.portalItem.apiKey},signal:e?.signal})}async update(t,e){const{addOrUpdateResources:i}=await import("./p-d5b8a8c9.js");return await i(this.portalItem,[{resource:this,content:t,compress:e?.compress,access:e?.access}],"update",e),this}hasPath(){return null!=this.path}_normalizePath(t,e){return null==t?t:(t=t.replace(/^\/+/,""),null!=e&&uu(t)&&(t=ru(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};o([Us()],tk.prototype,"portalItem",void 0),o([Us({type:String,value:null})],tk.prototype,"path",null),o([ol("path")],tk.prototype,"_castPath",null),o([Us({type:String,readOnly:!0})],tk.prototype,"url",null),o([Us({type:String,readOnly:!0})],tk.prototype,"cdnUrl",null),o([Us({type:String,readOnly:!0})],tk.prototype,"itemRelativeUrl",null),tk=o([Nr("esri.portal.PortalItemResource")],tk);const ek=tk;let ik=class extends Vr{constructor(t){super(t),this.created=null,this.rating=null}};o([Us()],ik.prototype,"created",void 0),o([Us()],ik.prototype,"rating",void 0),ik=o([Nr("esri.portal.PortalRating")],ik);const nk=ik;function sk(t,e){const i=e?.url?.path;if(t&&i&&(t=su(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=ru(t,e.portalItem.itemUrl);null!=i&&uk.test(i)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return(t=fk(t,e?.portal))&&lk.test(t)?pk(t):t}function rk(t,e,i=yk.YES){if(null==(t=t&&lk.test(t)?mk(t):t))return t;!uu(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let n=su(t);if(e){const i=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(i){const s=fk(i,e.portal),r=fk(n,e.portal);n=ru(r,s,s);null!=n&&n!==r&&n!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(n)}}return n=dk(n,e?.portal),uu(n)&&(n=ou(n)),e?.resources&&e?.portalItem&&!uu(n)&&!hu(n)&&i===yk.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(n),compress:!1}),n}function ok(t,e,i){return sk(t,i)}function ak(t,e,i,n){const s=rk(t,n);void 0!==s&&(e[i]=s)}const lk=/\/items\/([^\/]+)\/resources\/(.*)/,uk=/^\.\/resources\//;function ck(t){const e=t?.match(lk)??null;return e?.[1]??null}function hk(t){const e=t?.match(lk)??null;if(null==e)return null;const i=e[2],n=i.lastIndexOf("/");if(-1===n){const{path:t,extension:e}=qu(i);return{prefix:null,filename:t,extension:e}}const{path:s,extension:r}=qu(i.slice(n+1));return{prefix:i.slice(0,n),filename:s,extension:r}}function dk(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?Du(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function fk(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,n=Dl();return eu(n,`${n.scheme}://${i}`)?Du(t,e.portalHostname,i):Du(t,i,e.portalHostname)}function pk(t){if(!t)return t||null;let e=t;return e&&Qu&&!Qu.findCredential(e)&&(e=Qu._normalizeAGOLorgDomain(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function mk(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Qu&&!Qu.findCredential(e)&&(e=Qu._normalizeAGOLorgDomain(e)),e}var yk;!function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"}(yk||(yk={}));const gk=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return yk},ensureMainOnlineDomain:dk,fromCDNUrl:mk,fromJSON:sk,itemIdFromResourceUrl:ck,prefixAndFilenameFromResourceUrl:hk,read:ok,toCDNUrl:pk,toJSON:rk,write:ak},Symbol.toStringTag,{value:"Module"}));var vk;const wk=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Map Service","Media Layer","Scene Service","Stream Service","Vector Tile Service","WFS","WMS","WMTS"]),bk=new Set(["KML","GeoJson","CSV"]);let Sk=vk=class extends(Qa(AM)){static from(t){return Ss(vk,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return"Feature Service"===t||"Feature Collection"===t?i=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":"Image Service"===t?i=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===t?i="Scene Layer":"Video Service"===t?i="Video Layer":"Scene Package"===t?i="Scene Layer Package":"Stream Service"===t?i="Feature Layer":"Geoprocessing Service"===t?i=e.includes("Web Tool")?"Tool":"Geoprocessing Service":"Geoenrichment Service"===t?i="GeoEnrichment Service":"Geocoding Service"===t?i="Locator":"Microsoft Powerpoint"===t?i="Microsoft PowerPoint":"GeoJson"===t?i="GeoJSON":"Globe Service"===t?i="Globe Layer":"Vector Tile Service"===t?i="Tile Layer":"netCDF"===t?i="NetCDF":"Map Service"===t?i=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t&&t.toLowerCase().includes("add in")?i=t.replaceAll(/(add in)/gi,"Add-In"):"datastore catalog service"===t?i="Big Data File Share":"Compact Tile Package"===t?i="Tile Package (tpkx)":"Raster function template"===t?i="Raster Function Template":"OGCFeatureServer"===t?i="OGC Feature Layer":"web mapping application"===t&&e.includes("configurableApp")?i="Instant App":"Insights Page"===t?i="Insights Report":"Excalibur Imagery Project"===t?i="Excalibur Project":"3DTiles Service"===t?i="3D tiles layer":"3DTiles Package"===t&&(i="3D tiles package"),i}readExtent(t){return t&&t.length?new Rf(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],i="esri/images/portal/",n="16";let s,r=!1,o=!1,a=!1,l=!1,u=!1,c=!1,h=!1,d=!1;return t.indexOf("service")>0||"feature collection"===t||"kml"===t||"wms"===t||"wmts"===t||"wfs"===t?(r=e.includes("Hosted Service"),"feature service"===t||"feature collection"===t||"kml"===t||"wfs"===t?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),u=e.includes("Spatiotemporal"),c=e.includes("UtilityNetwork"),s=u&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":u?"spatiotemporal":c?"utilitynetwork":r?"featureshosted":"features"):"map service"===t||"wms"===t||"wmts"===t?(u=e.includes("Spatiotemporal"),h=e.includes("Relational"),s=u||h?"mapimages":r||e.includes("Tiled")||"wmts"===t?"maptiles":"mapimages"):s="scene service"===t?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===t?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===t?"streamlayer":"vector tile service"===t?"vectortile":"datastore catalog service"===t?"datastorecollection":"geocoding service"===t?"geocodeservice":"video service"===t?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":"geoprocessing service"===t?e.includes("Web Tool")?"tool":"layers":"geodata service"===t?"geodataservice":"3dtiles service"===t?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):"web map"===t||"cityengine web scene"===t?s="maps":"web scene"===t?s=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===t&&e.includes("configurableApp")?s="instantapps":"web mapping application"===t||"mobile application"===t||"application"===t||"operation view"===t||"desktop application"===t?s="apps":"map document"===t||"map package"===t||"published map"===t||"scene document"===t||"globe document"===t||"basemap package"===t||"mobile basemap package"===t||"mobile map package"===t||"project package"===t||"project template"===t||"pro map"===t||"layout"===t||"layer"===t&&e.includes("ArcGIS Pro")||"explorer map"===t&&e.indexOf("Explorer Document")?s="mapsgray":"service definition"===t||"shapefile"===t||"cad drawing"===t||"geojson"===t||"netcdf"===t||"administrative report"===t?s="datafiles":"360 vr experience"===t?s="360vr":"explorer add in"===t||"desktop add in"===t||"windows viewer add in"===t||"windows viewer configuration"===t?s="appsgray":"arcgis pro add in"===t||"arcgis pro configuration"===t?s="addindesktop":"pdf"===t?s="pdf":"microsoft word"===t?s="word":"microsoft excel"===t?s="excel":"microsoft powerpoint"===t?s="ppt":"rule package"===t||"file geodatabase"===t||"sqlite geodatabase"===t||"csv collection"===t||"kml collection"===t||"windows mobile package"===t||"map template"===t||"desktop application template"===t||"gml"===t||"arcpad package"===t||"code sample"===t||"document link"===t||"earth configuration"===t||"operations dashboard add in"===t||"rules package"===t||"workflow manager package"===t||"explorer map"===t&&e.includes("Explorer Mapping Application")||e.includes("Document")?s="datafilesgray":"network analysis service"===t||"geoprocessing service"===t||"geodata service"===t||"geometry service"===t||"geoprocessing package"===t||"locator package"===t||"geoprocessing sample"===t||"workflow manager service"===t?s="toolsgray":"layer"===t||"layer package"===t||"explorer layer"===t?s="layersgray":"scene package"===t?s="scenepackage":"3dtiles package"===t?s="3dtileslayerpackage":"3dtiles service"===t?s="3dtileslayer":"mobile scene package"===t?s="mobilescenepackage":"tile package"===t||"compact tile package"===t?s="tilepackage":"task file"===t?s="taskfile":"report template"===t?s="report-template":"statistical data collection"===t?s="statisticaldatacollection":"insights workbook"===t?s="workbook":"insights model"===t?s="insightsmodel":"insights page"===t?s="insightspage":"insights theme"===t?s="insightstheme":"hub initiative"===t?s="hubinitiative":"hub page"===t?s="hubpage":"hub site application"===t?s="hubsite":"hub event"===t?s="hubevent":"hub project"===t?s="hubproject":"relational database connection"===t?s="relationaldatabaseconnection":"big data file share"===t?s="datastorecollection":"image collection"===t?s="imagecollection":"desktop style"===t?s="desktopstyle":"style"===t?s="style":"dashboard"===t?s="dashboard":"raster function template"===t?s="rasterprocessingtemplate":"vector tile package"===t?s="vectortilepackage":"ortho mapping project"===t?s="orthomappingproject":"ortho mapping template"===t?s="orthomappingtemplate":"solution"===t?s="solutions":"geopackage"===t?s="geopackage":"deep learning package"===t?s="deeplearningpackage":"real time analytic"===t?s="realtimeanalytics":"big data analytic"===t?s="bigdataanalytics":"feed"===t?s="feed":"excalibur imagery project"===t?s="excaliburimageryproject":"notebook"===t?s="notebook":"storymap"===t?s="storymap":"survey123 add in"===t?s="survey123addin":"mission"===t?s="mission":"mission report"===t?s="missionreport":"mission template"===t?s="missiontemplate":"quickcapture project"===t?s="quickcaptureproject":"pro report"===t?s="proreport":"pro report template"===t?s="proreporttemplate":"urban model"===t?s="urbanmodel":"web experience"===t?s="experiencebuilder":"web experience template"===t?s="webexperiencetemplate":"experience builder widget"===t?s="experiencebuilderwidget":"experience builder widget package"===t?s="experiencebuilderwidgetpackage":"workflow"===t?s="workflow":"kernel gateway connection"===t?s="kernelgatewayconnection":"insights script"===t?s="insightsscript":"hub initiative template"===t?s="hubinitiativetemplate":"storymap theme"===t?s="storymaptheme":"knowledge graph"===t?s="knowledgegraph":"knowledge studio project"===t?s="knowledgestudio":"native application"===t?s="nativeapp":"native application installer"===t?s="nativeappinstaller":"web link chart"===t?s="linkchart":"knowledge graph web investigation"===t?s="investigation":"ogcfeatureserver"===t?s="features":"pro project"===t?s="proproject":"insights workbook package"===t?s="insightsworkbookpackage":"apache parquet"===t?s="apacheparquet":"notebook code snippets"===t||"notebook code snippet library"===t?s="notebookcodesnippets":"suitability model"===t?s="suitabilitymodel":"esri classifier definition"===t?s="classifierdefinition":"esri classification schema"===t?s="classificationschema":"insights data engineering workbook"===t?s="dataengineeringworkbook":"insights data engineering model"===t?s="dataengineeringmodel":"deep learning studio project"===t?s="deeplearningproject":"discussion"===t?s="discussion":"allsource project"===t?s="allsourceproject":"api key"===t?s="apikey":"data pipeline"===t?s="datapipelines":"group layer"===t?(d=e.includes("Map"),s=d?"layergroup2d":"layergroup"):s="media layer"===t?"onlinemedialayer":"form"===t?e.includes("Survey123")?"survey":"datafilesgray":"csv"===t?"csv":"image"===t?"image":"maps",s?Nc(i+s+n+".png"):null}get isLayer(){return null!=this.type&&wk.has(this.type)}get itemCdnUrl(){return pk(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.username;if(!e)return null;return`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`}load(t){const e=this.portal??(this.portal=YM.getDefault()),i=e.load(t).then((()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:null!=t?t.signal:null,query:{token:this.apiKey}}):{})).then((t=>{this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}};return t instanceof nk&&(t=t.rating),null==t||isNaN(t)||"number"!=typeof t||(e.query.rating=t),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new nk({rating:t,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:ht(this.applicationProxies),avgRating:this.avgRating,categories:ht(this.categories),created:ht(this.created),culture:this.culture,description:this.description,extent:ht(this.extent),groupCategories:ht(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:ht(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:ht(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:ht(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:ht(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new vk({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");const{extent:e}=t;return e&&(t.extent=JSON.stringify(e)),t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return null!=e.rating?(e.created=new Date(e.created),new nk(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},vk)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then((t=>(this.sourceJSON=t,this.read(t),this)))}update(t){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const e=t?.data,i={method:"post"};i.query=this.createPostQuery();for(const t in i.query)null===i.query[t]&&(i.query[t]="");return i.query.clearEmptyFields=!0,null!=e&&("string"==typeof e?i.query.text=e:"object"==typeof e&&(i.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,i).then((()=>this.reload()))})):Promise.reject(new Qe("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new Qe("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:i}=this;await e.signIn();const{copyResources:n,folder:s,tags:r,title:o}=t||{},a={method:"post",query:{copyPrivateResources:"all"===n,folder:"string"==typeof s?s:s?.id,includeResources:!!n,tags:r?.join(","),title:o}},{itemId:l}=await e.request(`${i}/copy`,a);return new vk({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const e=t.thumbnail,i=t.filename,n={method:"post"};if("string"==typeof e)hu(e)?n.query={data:e}:n.query={url:su(e)},null!=i&&(n.query.filename=i);else{const t=new FormData;null!=i?t.append("file",e,i):t.append("file",e),n.body=t}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,n).then((()=>this.reload()))})):Promise.reject(new Qe("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:i}=await import("./p-d5b8a8c9.js");return i(this,t,e)}async addResource(t,e,i){const{addOrUpdateResources:n}=await import("./p-d5b8a8c9.js");return t.portalItem=this,await n(this,[{resource:t,content:e,compress:i?.compress,access:i?.access}],"add",i),t}async removeResource(t,e){const{removeResource:i}=await import("./p-d5b8a8c9.js");if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new Qe("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await import("./p-d5b8a8c9.js");return e(this,t)}resourceFromPath(t){return new ek({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:ht(this.categories),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:ht(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:ht(this.typeKeywords),url:this.url};return ct(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new vk({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)"tags"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"typeKeywords"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"extent"===e&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};o([Us({type:["private","shared","org","public"]})],Sk.prototype,"access",void 0),o([Us()],Sk.prototype,"accessInformation",void 0),o([Us({type:String})],Sk.prototype,"apiKey",void 0),o([Us({json:{read:{source:"appProxies"}}})],Sk.prototype,"applicationProxies",void 0),o([Us()],Sk.prototype,"avgRating",void 0),o([Us()],Sk.prototype,"categories",void 0),o([Us({type:Date})],Sk.prototype,"created",void 0),o([Us()],Sk.prototype,"culture",void 0),o([Us()],Sk.prototype,"description",void 0),o([Us({readOnly:!0})],Sk.prototype,"displayName",null),o([Us({type:Rf})],Sk.prototype,"extent",void 0),o([al("extent")],Sk.prototype,"readExtent",null),o([Us()],Sk.prototype,"groupCategories",void 0),o([Us({readOnly:!0})],Sk.prototype,"iconUrl",null),o([Us()],Sk.prototype,"id",void 0),o([Us({readOnly:!0})],Sk.prototype,"isLayer",null),o([Us({type:Boolean,readOnly:!0})],Sk.prototype,"isOrgItem",void 0),o([Us()],Sk.prototype,"itemControl",void 0),o([Us({readOnly:!0})],Sk.prototype,"itemPageUrl",null),o([Us({readOnly:!0})],Sk.prototype,"itemUrl",null),o([Us()],Sk.prototype,"licenseInfo",void 0),o([Us({type:Date})],Sk.prototype,"modified",void 0),o([Us()],Sk.prototype,"name",void 0),o([Us()],Sk.prototype,"numComments",void 0),o([Us()],Sk.prototype,"numRatings",void 0),o([Us()],Sk.prototype,"numViews",void 0),o([Us()],Sk.prototype,"owner",void 0),o([Us()],Sk.prototype,"ownerFolder",void 0),o([Us({type:YM})],Sk.prototype,"portal",void 0),o([Us()],Sk.prototype,"screenshots",void 0),o([Us()],Sk.prototype,"size",void 0),o([Us()],Sk.prototype,"snippet",void 0),o([Us()],Sk.prototype,"sourceJSON",void 0),o([Us({type:String})],Sk.prototype,"sourceUrl",void 0),o([Us({type:String})],Sk.prototype,"spatialReference",void 0),o([Us()],Sk.prototype,"tags",void 0),o([Us()],Sk.prototype,"thumbnail",void 0),o([Us({readOnly:!0})],Sk.prototype,"thumbnailUrl",null),o([Us()],Sk.prototype,"title",void 0),o([Us()],Sk.prototype,"type",void 0),o([Us()],Sk.prototype,"typeKeywords",void 0),o([Us({type:String,json:{read(t,e){if(bk.has(e.type)){const e=this.portal?.restUrl;t||=e&&this.id?`${e}/content/items/${this.id}/data`:null}return t}}})],Sk.prototype,"url",void 0),o([Us({readOnly:!0})],Sk.prototype,"userItemUrl",null),Sk=vk=o([Nr("esri.portal.PortalItem")],Sk);const xk=Sk;const _k=Object.freeze({__proto__:null,default:xk});async function Mk(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,i=await yv("esri/t9n/basemaps");return i[t]||i[e]}const kk={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Nc("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return Nc("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return Nc("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return Nc("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return Nc("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return Nc("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return Nc("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return Nc("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return Nc("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return Nc("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return Nc("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return Nc("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return Nc("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return Nc("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return Nc("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return Nc("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};const Tk=new Set(["ar","bs","ca","hr","cs","da","nl","en","et","fi","fr","de","el","he","hu","id","it","ja","ko","lv","lt","nb","pl","ro","ru","sr","es","sv","th","tr","uk","vi"]);let Ak=class extends Vr{constructor(t){super(t),this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps",this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;const t=ng().toLowerCase();switch(t){case"pt-br":return"pt-BR";case"pt-pt":return"pt-PT";case"zh-cn":return"zh-CN";case"zh-hk":return"zh-HK";case"zh-tw":return"zh-TW"}const e=sg(t);return"pt"===e?"pt-BR":e&&Tk.has(e)?e:"global"}};o([Us()],Ak.prototype,"id",void 0),o([Us()],Ak.prototype,"language",void 0),o([Us()],Ak.prototype,"places",void 0),o([Us()],Ak.prototype,"serviceUrl",void 0),o([Us()],Ak.prototype,"worldview",void 0),Ak=o([Nr("esri.support.BasemapStyle")],Ak);const Ik=Ak;function jk(t){return Nk(t)||Ek(t)}function Ck(t){return null!=t&&"object"==typeof t&&"type"in t&&"feature"===t.type}function Ek(t){return"scene"===t?.type}function Ok(t){return null!=t&&"object"==typeof t&&"type"in t&&"subtype-group"===t.type&&"sublayers"in t}function Lk(t){return"subtype-sublayer"===t?.type}function Nk(t){const e=t?.type;return"imagery-tile"===e||"tile"===e||"open-street-map"===e||"vector-tile"===e||"web-tile"===e||"wmts"===e}function Rk(t){const e=t?.type;return"base-tile"===e||"tile"===e||"elevation"===e||"imagery-tile"===e||"base-elevation"===e||"open-street-map"===e||"wcs"===e||"web-tile"===e||"wmts"===e||"vector-tile"===e}const Pk={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function Fk(t){const e=t?.type;return"building-scene"===e||"integrated-mesh"===e||"point-cloud"===e||"scene"===e}function Dk(t){return"feature"===t?.type&&!t.url&&"memory"===t.source?.type}function $k(t){return("feature"===t?.type||"subtype-group"===t?.type)&&"feature-layer"===t.source?.type}function zk(t){if(t.activeLayer){const e=t.activeLayer.tileMatrixSet;if(e)return e;const i=t.activeLayer.tileMatrixSets;if(i)return i}return null}async function Uk(t,e){const i=Qu?.findServerInfo(t);if(null!=i?.currentVersion)return i.owningSystemUrl||null;const n=t.toLowerCase().indexOf("/rest/services");if(-1===n)return null;const s=`${t.substring(0,n)}/rest/info`,r=null!=e?e.signal:null,{data:o}=await hc(s,{query:{f:"json"},responseType:"json",signal:r});return o?.owningSystemUrl||null}function Vk(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function Gk(t){return Vk(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function Bk(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function qk(t){return!!Bk(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}const Hk=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),Wk=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function Zk(t){return"basemap"===t.layerContainerType?Hk:"operational-layers"===t.layerContainerType?Wk:null}function Jk(t,e){if(e.restrictedWebMapWriting){const i=Zk(e);return null==i||i.has(t.type)&&!Dk(t)}return!0}function Kk(t,e){if(e)if(Dk(t)){const i=Mt("featureCollection.layers",e),n=i?.[0]?.layerDefinition;n&&Yk(t,n)}else"group"!==t.type&&Yk(t,e)}function Yk(t,e){"maxScale"in t&&(e.maxScale=vr(t.maxScale)??void 0),"minScale"in t&&(e.minScale=vr(t.minScale)??void 0)}function Qk(t,e){if(Kk(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,"normal"===e.blendMode&&delete e.blendMode),e.opacity=vr(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&"wmts"!==t.type))if(Dk(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function Xk(t,e,i){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return i?.messages&&i.messages.push(new Qe("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(Dk(t)&&!t.isTable)e=t.resourceInfo;else if(Jk(t,i)){const e={};return t.write(e,i)?e:null}return null!=e&&Qk(t,e=ht(e)),e}var tT;let eT=0;const iT="esri.Basemap";let nT=tT=class extends(Qa(AM)){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+eT++,this.baseLayers=new ty,this.referenceLayers=new ty;const e=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,"elevation"===t.type&&Ft.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=t=>{t.parent=null};this.addHandles([this.baseLayers.on("after-add",(t=>e(t.item))),this.referenceLayers.on("after-add",(t=>e(t.item))),this.baseLayers.on("after-remove",(t=>i(t.item))),this.referenceLayers.on("after-remove",(t=>i(t.item)))])}initialize(){this.when().catch((t=>{Ft.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.baseLayers.toArray();for(const e of t)e.destroy();const e=this.referenceLayers.toArray();for(const t of e)t.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=$t(this.portalItem)}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",pM(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const n=[];t?(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach((t=>{const e=Xk(t,i.webmap?i.webmap.getLayerJSONFromResourceInfo(t):null,i);null!=e&&n.push(e)})),this.referenceLayers.forEach((t=>{const e=Xk(t,i.webmap?i.webmap.getLayerJSONFromResourceInfo(t):null,i);null!=e&&("scene"!==t.type&&(e.isReference=!0),n.push(e))})),e.baseMapLayers=n):e.baseMapLayers=n}set referenceLayers(t){this._set("referenceLayers",pM(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return IM(this,(t=>{t(this.baseLayers,this.referenceLayers)}))}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map((t=>ft(t)?t.clone():t)),referenceLayers:this.referenceLayers.map((t=>ft(t)?t.clone():t))};return this.loaded&&(t.loadStatus="loaded"),new tT({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){return t=t||{},e?.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((t=>{const e=ht(t);return e.url&&Su(e.url)&&(e.url=`https:${e.url}`),e.templateUrl&&Su(e.templateUrl)&&(e.templateUrl=`https:${e.templateUrl}`),e}))),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i,style:n}=this;Ii(t);const s=[];if(e){const i=e.context?e.context.url:null;if(s.push(this._loadLayersFromJSON(e.data,i,t)),e.data.id&&!e.data.title){const t=e.data.id;s.push(Mk(t).then((t=>{t&&this.read({title:t},e.context)})))}}else i?s.push(this._loadFromItem(i,t)):n&&s.push(this._loadFromStylesService(n,t));await Promise.all(s)}async _loadLayersFromJSON(t,e,i){const n=this.resourceInfo?.context,s=this.portalItem?.portal||n?.portal||null,r=rT[n?.origin||""]??"web-map",{populateOperationalLayers:o}=await import("./p-6684cc8f.js"),a=[];if(Ii(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const i={context:{...n,origin:r,url:e,portal:s,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},l=t=>"web-scene"===r&&"ArcGISSceneServiceLayer"===t.layerType||t.isReference,u=o(this.baseLayers,t.baseMapLayers.filter((t=>!l(t))),i);a.push(u);const c=o(this.referenceLayers,t.baseMapLayers.filter(l),i);a.push(c)}await Promise.allSettled(a)}async _loadFromItem(t,e){const i=await t.load(e),n=await i.fetchData("json",e),s=Ul(t.itemUrl??"");return this._set("resourceInfo",{data:n.baseMap??{},context:{origin:sT[t.type||""]??"web-map",portal:t.portal||YM.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||YM.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,e)}async _loadFromStylesService(t,e){const i=`${t.serviceUrl}/${t.id}`,n=(await hc(i,{query:{language:t.getLanguageParamValue(),places:t.places,worldview:t.worldview},signal:e?.signal})).data,s=Ul(i);return this._set("resourceInfo",{data:n.baseMap??{},context:{origin:"web-map",url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),this._loadLayersFromJSON(this.resourceInfo.data,s,e)}static fromId(t){const e=kk[t];return e?e.itemId?new tT({portalItem:{id:e.itemId,portal:{url:"https://www.arcgis.com"}}}):tT.fromJSON(e,{origin:e.is3d?"web-scene":"web-map"}):null}};o([Us({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,n){this._writeBaseLayers(t,e,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:ty}},writer(t,e,i,n){this._writeBaseLayers(t,e,n)}}}}}})],nT.prototype,"baseLayers",null),o([Us({type:String,json:{origins:{"web-scene":{write:!0}}}})],nT.prototype,"id",void 0),o([Us({type:xk})],nT.prototype,"portalItem",void 0),o([Us()],nT.prototype,"referenceLayers",null),o([Us({readOnly:!0})],nT.prototype,"resourceInfo",void 0),o([Us({type:jd})],nT.prototype,"spatialReference",void 0),o([Us({type:Ik})],nT.prototype,"style",void 0),o([Us()],nT.prototype,"thumbnailUrl",void 0),o([Us({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],nT.prototype,"title",void 0),o([ll("title")],nT.prototype,"writeTitle",null),nT=tT=o([Nr(iT)],nT);const sT={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},rT={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},oT=nT;const aT=Object.freeze({__proto__:null,default:oT});const lT={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function uT(t){return!!lT[t]||!!lT[t.toLowerCase()]}function cT(t){return lT[t]??lT[t.toLowerCase()]}function hT(t){return[...cT(t)]}function dT(t,e,i){i<0&&++i,i>1&&--i;const n=6*i;return n<1?t+(e-t)*n:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function fT(t,e,i,n=1){const s=(t%360+360)%360/360,r=i<=.5?i*(e+1):i+e-i*e,o=2*i-r;return[Math.round(255*dT(o,r,s+1/3)),Math.round(255*dT(o,r,s)),Math.round(255*dT(o,r,s-1/3)),n]}function pT(t){const e=t.length>5,i=e?8:4,n=(1<<i)-1,s=e?1:17,r=e?9===t.length:5===t.length;let o=Number("0x"+t.substr(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return r&&(l=o&n,o>>=i,a[3]=s*l/255),l=o&n,o>>=i,a[2]=s*l,l=o&n,o>>=i,a[1]=s*l,l=o&n,o>>=i,a[0]=s*l,a}function mT(t){return pa(ps(t),0,255)}function yT(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}function gT(t,e){const i=t.toString(16).padStart(2,"0");return e?i.substring(0,1):i}class vT{static blendColors(t,e,i,n=new vT){return n.r=Math.round(t.r+(e.r-t.r)*i),n.g=Math.round(t.g+(e.g-t.g)*i),n.b=Math.round(t.b+(e.b-t.b)*i),n.a=t.a+(e.a-t.a)*i,n._sanitize()}static fromRgb(t,e){const i=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(i){const t=i[2].split(/\s*,\s*/),n=i[1];if("rgb"===n&&3===t.length||"rgba"===n&&4===t.length){const i=t[0];if("%"===i.charAt(i.length-1)){const i=t.map((t=>2.56*parseFloat(t)));return 4===t.length&&(i[3]=parseFloat(t[3])),vT.fromArray(i,e)}return vT.fromArray(t.map((t=>parseFloat(t))),e)}if("hsl"===n&&3===t.length||"hsla"===n&&4===t.length)return vT.fromArray(fT(parseFloat(t[0]),parseFloat(t[1])/100,parseFloat(t[2])/100,parseFloat(t[3])),e)}return null}static fromHex(t,e=new vT){if("#"!==t[0]||isNaN(Number(`0x${t.substring(1)}`)))return null;switch(t.length){case 4:case 5:{const i=parseInt(t.substring(1,2),16),n=parseInt(t.substring(2,3),16),s=parseInt(t.substring(3,4),16),r=5===t.length?15:parseInt(t.substring(4),16);return vT.fromArray([i+16*i,n+16*n,s+16*s,(r+16*r)/255],e)}case 7:case 9:{const i=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),s=parseInt(t.substring(5,7),16),r=7===t.length?255:parseInt(t.substring(7),16);return vT.fromArray([i,n,s,r/255],e)}default:return null}}static fromArray(t,e=new vT){return e._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(e.a)&&(e.a=1),e._sanitize()}static fromString(t,e){const i=uT(t)?cT(t):null;return i&&vT.fromArray(i,e)||vT.fromRgb(t,e)||vT.fromHex(t,e)}static fromJSON(t){return null!=t?new vT([t[0],t[1],t[2],(t[3]??255)/255]):void 0}static toUnitRGB(t){return null!=t?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return null!=t?[t.r/255,t.g/255,t.b/255,null!=t.a?t.a:1]:null}constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}get isBright(){return.299*this.r+.587*this.g+.114*this.b>=127}setColor(t){return"string"==typeof t?vT.fromString(t,this):Array.isArray(t)?vT.fromArray(t,this):(this._set(t.r??0,t.g??0,t.b??0,t.a??1),t instanceof vT||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(t){const e=t?.capitalize??!1,i=t?.digits??6,n=3===i||4===i,s=4===i||8===i,r=`#${gT(this.r,n)}${gT(this.g,n)}${gT(this.b,n)}${s?gT(Math.round(255*this.a),n):""}`;return e?r.toUpperCase():r}toCss(t=!1){const e=this.r+", "+this.g+", "+this.b;return t?`rgba(${e}, ${this.a})`:`rgb(${e})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=vT.AlphaMode.ALWAYS){const e=mT(this.r),i=mT(this.g),n=mT(this.b);return t===vT.AlphaMode.ALWAYS||1!==this.a?[e,i,n,mT(255*this.a)]:[e,i,n]}clone(){return new vT(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(t){return null!=t&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a}_sanitize(){return this.r=Math.round(yT(this.r,0,255)),this.g=Math.round(yT(this.g,0,255)),this.b=Math.round(yT(this.b,0,255)),this.a=yT(this.a,0,1),this}_set(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n}}vT.prototype.declaredClass="esri.Color",function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(vT||(vT={}));const wT=vT;function bT(t){return()=>t}function ST(t,e={}){const i=t instanceof ul?t:new ul(t,e),n={type:e?.ignoreUnknown??1?i.apiValues:String,json:{type:i.jsonValues,read:!e?.readOnly&&{reader:i.read},write:{writer:i.write}}};return void 0!==e?.readOnly&&(n.readOnly=!!e.readOnly),void 0!==e?.default&&(n.json.default=e.default),void 0!==e?.name&&(n.json.name=e.name),void 0!==e?.nonNullable&&(n.nonNullable=e.nonNullable),Us(n)}var xT;let _T=xT=class extends el{constructor(t){super(t),this.type="none"}clone(){return new xT({type:this.type})}};o([ST({none:"none",stayAbove:"stay-above"})],_T.prototype,"type",void 0),_T=xT=o([Nr("esri.ground.NavigationConstraint")],_T);function MT(t){const e=ps(100*(1-t));return Math.max(0,Math.min(e,100))}function kT(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var TT;let AT=TT=class extends(Qa(AM)){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new ty;const e=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,"elevation"!==t.type&&"base-elevation"!==t.type&&Ft.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=t=>{t.parent=null};this.addHandles([this.layers.on("after-add",(t=>e(t.item))),this.layers.on("after-remove",(t=>i(t.item)))])}initialize(){this.when().catch((t=>{Pi(t)||Ft.getLogger(this).error("#load()","Failed to load ground",t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)$t(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",pM(t,this._get("layers")))}writeLayers(t,e,i,n){const s=[];t?(n={...n,layerContainerType:"ground"},t.forEach((t=>{if("write"in t){const e={};bT(t)().write(e,n)&&s.push(e)}else n?.messages&&n.messages.push(new Qe("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted in the ground`,{layer:t}))})),e.layers=s):e.layers=s}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return IM(this,(t=>{t(this.layers)}))}async queryElevation(t,e){await this.load({signal:e?.signal});const{ElevationQuery:i}=await import("./p-91bdbe1b.js");Ii(e);const n=new i,s=this.layers.filter(jT).toArray();return n.queryAll(s,t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{ElevationQuery:i}=await import("./p-91bdbe1b.js");Ii(e);const n=new i,s=this.layers.filter(jT).toArray();return n.createSamplerAll(s,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:ht(this.surfaceColor),navigationConstraint:ht(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new TT({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,i){const n=e?.origin||"web-scene",s=e?.portal||null,r=e?.url||null,{populateOperationalLayers:o}=await import("./p-6684cc8f.js");Ii(i);const a=[];if(t.layers&&Array.isArray(t.layers)){const e={context:{origin:n,url:r,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,e))}await Promise.allSettled(a)}};function IT(t){return t&&"createElevationSampler"in t}function jT(t){return"elevation"===t.type||IT(t)}o([Us({json:{read:!1}})],AT.prototype,"layers",null),o([ll("layers")],AT.prototype,"writeLayers",null),o([Us({readOnly:!0})],AT.prototype,"resourceInfo",void 0),o([Us({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Ns,read:{reader:kT,source:"transparency"},write:{writer:(t,e)=>{e.transparency=MT(t)},target:"transparency"}}})],AT.prototype,"opacity",void 0),o([Us({type:wT,json:{type:[Ns],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],AT.prototype,"surfaceColor",void 0),o([Us({type:_T,json:{write:!0}})],AT.prototype,"navigationConstraint",void 0),AT=TT=o([Nr("esri.Ground")],AT);const CT=AT;function ET(t){return!(!(t&&"object"==typeof t&&"loaded"in t&&t.loaded&&Gk(t)?.operations?.supportsEditing&&"type"in t)||"editingEnabled"in t&&!qk(t))}const OT=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,LT="screenUtils.toPt: input not recognized!",NT=96;function RT(t){return t?t/72*NT:0}function PT(t){return t?72*t/NT:0}function FT(t){if("string"==typeof t){const e=t.match(OT);if(e){const i=Number(e[1]),n=e[3]&&e[3].toLowerCase(),s="-"===t.charAt(0),r="px"===n?PT(i):i;return s?-r:r}return console.warn(LT),null}return t}function DT(t=0,e=0){return{x:t,y:e}}function $T(t=0,e=0){return[t,e]}function zT(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function UT(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function VT(t,e,i,n,s,r,o,a,l,u,c,h,d,f,p,m){const y=new Float32Array(16);return y[0]=t,y[1]=e,y[2]=i,y[3]=n,y[4]=s,y[5]=r,y[6]=o,y[7]=a,y[8]=l,y[9]=u,y[10]=c,y[11]=h,y[12]=d,y[13]=f,y[14]=p,y[15]=m,y}function GT(t,e){return new Float32Array(t,e,16)}const BT=zT();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:BT,clone:UT,create:zT,createView:GT,fromValues:VT},Symbol.toStringTag,{value:"Module"}));function qT(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function HT(t,e,i,n,s,r,o,a,l,u,c,h,d,f,p,m,y){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=f,t[13]=p,t[14]=m,t[15]=y,t}function WT(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ZT(t,e){if(t===e){const i=e[1],n=e[2],s=e[3],r=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=r,t[11]=e[14],t[12]=s,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function JT(t,e){return KT(t,e)||WT(t),t}function KT(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],y=e[14],g=e[15],v=i*a-n*o,w=i*l-s*o,b=i*u-r*o,S=n*l-s*a,x=n*u-r*a,_=s*u-r*l,M=c*m-h*p,k=c*y-d*p,T=c*g-f*p,A=h*y-d*m,I=h*g-f*m,j=d*g-f*y;let C=v*j-w*I+b*A+S*T-x*k+_*M;return C?(C=1/C,t[0]=(a*j-l*I+u*A)*C,t[1]=(s*I-n*j-r*A)*C,t[2]=(m*_-y*x+g*S)*C,t[3]=(d*x-h*_-f*S)*C,t[4]=(l*T-o*j-u*k)*C,t[5]=(i*j-s*T+r*k)*C,t[6]=(y*b-p*_-g*w)*C,t[7]=(c*_-d*b+f*w)*C,t[8]=(o*I-a*T+u*M)*C,t[9]=(n*T-i*I-r*M)*C,t[10]=(p*x-m*b+g*v)*C,t[11]=(h*b-c*x-f*v)*C,t[12]=(a*k-o*A-l*M)*C,t[13]=(i*A-n*k+s*M)*C,t[14]=(m*w-p*S-y*v)*C,t[15]=(c*S-h*w+d*v)*C,t):null}function YT(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],y=e[14],g=e[15];return t[0]=a*(d*g-f*y)-h*(l*g-u*y)+m*(l*f-u*d),t[1]=-(n*(d*g-f*y)-h*(s*g-r*y)+m*(s*f-r*d)),t[2]=n*(l*g-u*y)-a*(s*g-r*y)+m*(s*u-r*l),t[3]=-(n*(l*f-u*d)-a*(s*f-r*d)+h*(s*u-r*l)),t[4]=-(o*(d*g-f*y)-c*(l*g-u*y)+p*(l*f-u*d)),t[5]=i*(d*g-f*y)-c*(s*g-r*y)+p*(s*f-r*d),t[6]=-(i*(l*g-u*y)-o*(s*g-r*y)+p*(s*u-r*l)),t[7]=i*(l*f-u*d)-o*(s*f-r*d)+c*(s*u-r*l),t[8]=o*(h*g-f*m)-c*(a*g-u*m)+p*(a*f-u*h),t[9]=-(i*(h*g-f*m)-c*(n*g-r*m)+p*(n*f-r*h)),t[10]=i*(a*g-u*m)-o*(n*g-r*m)+p*(n*u-r*a),t[11]=-(i*(a*f-u*h)-o*(n*f-r*h)+c*(n*u-r*a)),t[12]=-(o*(h*y-d*m)-c*(a*y-l*m)+p*(a*d-l*h)),t[13]=i*(h*y-d*m)-c*(n*y-s*m)+p*(n*d-s*h),t[14]=-(i*(a*y-l*m)-o*(n*y-s*m)+p*(n*l-s*a)),t[15]=i*(a*d-l*h)-o*(n*d-s*h)+c*(n*l-s*a),t}function QT(t){const e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],y=t[15];return(e*o-i*r)*(h*y-d*m)-(e*a-n*r)*(c*y-d*p)+(e*l-s*r)*(c*m-h*p)+(i*a-n*o)*(u*y-d*f)-(i*l-s*o)*(u*m-h*f)+(n*l-s*a)*(u*p-c*f)}function XT(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],m=e[12],y=e[13],g=e[14],v=e[15];let w=i[0],b=i[1],S=i[2],x=i[3];return t[0]=w*n+b*a+S*h+x*m,t[1]=w*s+b*l+S*d+x*y,t[2]=w*r+b*u+S*f+x*g,t[3]=w*o+b*c+S*p+x*v,w=i[4],b=i[5],S=i[6],x=i[7],t[4]=w*n+b*a+S*h+x*m,t[5]=w*s+b*l+S*d+x*y,t[6]=w*r+b*u+S*f+x*g,t[7]=w*o+b*c+S*p+x*v,w=i[8],b=i[9],S=i[10],x=i[11],t[8]=w*n+b*a+S*h+x*m,t[9]=w*s+b*l+S*d+x*y,t[10]=w*r+b*u+S*f+x*g,t[11]=w*o+b*c+S*p+x*v,w=i[12],b=i[13],S=i[14],x=i[15],t[12]=w*n+b*a+S*h+x*m,t[13]=w*s+b*l+S*d+x*y,t[14]=w*r+b*u+S*f+x*g,t[15]=w*o+b*c+S*p+x*v,t}function tA(t,e,i){const n=i[0],s=i[1],r=i[2];if(e===t)t[12]=e[0]*n+e[4]*s+e[8]*r+e[12],t[13]=e[1]*n+e[5]*s+e[9]*r+e[13],t[14]=e[2]*n+e[6]*s+e[10]*r+e[14],t[15]=e[3]*n+e[7]*s+e[11]*r+e[15];else{const i=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7],f=e[8],p=e[9],m=e[10],y=e[11];t[0]=i,t[1]=o,t[2]=a,t[3]=l,t[4]=u,t[5]=c,t[6]=h,t[7]=d,t[8]=f,t[9]=p,t[10]=m,t[11]=y,t[12]=i*n+u*s+f*r+e[12],t[13]=o*n+c*s+p*r+e[13],t[14]=a*n+h*s+m*r+e[14],t[15]=l*n+d*s+y*r+e[15]}return t}function eA(t,e,i){const n=i[0],s=i[1],r=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function iA(t,e,i,n){let s,r,o,a,l,u,c,h,d,f,p,m,y,g,v,w,b,S,x,_,M,k,T,A,I=n[0],j=n[1],C=n[2],E=Math.sqrt(I*I+j*j+C*C);return E<uo()?null:(E=1/E,I*=E,j*=E,C*=E,s=Math.sin(i),r=Math.cos(i),o=1-r,a=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],f=e[6],p=e[7],m=e[8],y=e[9],g=e[10],v=e[11],w=I*I*o+r,b=j*I*o+C*s,S=C*I*o-j*s,x=I*j*o-C*s,_=j*j*o+r,M=C*j*o+I*s,k=I*C*o+j*s,T=j*C*o-I*s,A=C*C*o+r,t[0]=a*w+h*b+m*S,t[1]=l*w+d*b+y*S,t[2]=u*w+f*b+g*S,t[3]=c*w+p*b+v*S,t[4]=a*x+h*_+m*M,t[5]=l*x+d*_+y*M,t[6]=u*x+f*_+g*M,t[7]=c*x+p*_+v*M,t[8]=a*k+h*T+m*A,t[9]=l*k+d*T+y*A,t[10]=u*k+f*T+g*A,t[11]=c*k+p*T+v*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function nA(t,e,i){const n=Math.sin(i),s=Math.cos(i),r=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*s+u*n,t[5]=o*s+c*n,t[6]=a*s+h*n,t[7]=l*s+d*n,t[8]=u*s-r*n,t[9]=c*s-o*n,t[10]=h*s-a*n,t[11]=d*s-l*n,t}function sA(t,e,i){const n=Math.sin(i),s=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*s-u*n,t[1]=o*s-c*n,t[2]=a*s-h*n,t[3]=l*s-d*n,t[8]=r*n+u*s,t[9]=o*n+c*s,t[10]=a*n+h*s,t[11]=l*n+d*s,t}function rA(t,e,i){const n=Math.sin(i),s=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*s+u*n,t[1]=o*s+c*n,t[2]=a*s+h*n,t[3]=l*s+d*n,t[4]=u*s-r*n,t[5]=c*s-o*n,t[6]=h*s-a*n,t[7]=d*s-l*n,t}function oA(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function aA(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function lA(t,e,i){if(0===e)return WT(t);let n,s,r,o=i[0],a=i[1],l=i[2],u=Math.sqrt(o*o+a*a+l*l);return u<uo()?null:(u=1/u,o*=u,a*=u,l*=u,n=Math.sin(e),s=Math.cos(e),r=1-s,t[0]=o*o*r+s,t[1]=a*o*r+l*n,t[2]=l*o*r-a*n,t[3]=0,t[4]=o*a*r-l*n,t[5]=a*a*r+s,t[6]=l*a*r+o*n,t[7]=0,t[8]=o*l*r+a*n,t[9]=a*l*r-o*n,t[10]=l*l*r+s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function uA(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cA(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function hA(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function dA(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=n+n,l=s+s,u=r+r,c=n*a,h=n*l,d=n*u,f=s*l,p=s*u,m=r*u,y=o*a,g=o*l,v=o*u;return t[0]=1-(f+m),t[1]=h+v,t[2]=d-g,t[3]=0,t[4]=h-v,t[5]=1-(c+m),t[6]=p+y,t[7]=0,t[8]=d+g,t[9]=p-y,t[10]=1-(c+f),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function fA(t,e){const i=pA,n=-e[0],s=-e[1],r=-e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=n*n+s*s+r*r+o*o;return h>0?(i[0]=2*(a*o+c*n+l*r-u*s)/h,i[1]=2*(l*o+c*s+u*n-a*r)/h,i[2]=2*(u*o+c*r+a*s-l*n)/h):(i[0]=2*(a*o+c*n+l*r-u*s),i[1]=2*(l*o+c*s+u*n-a*r),i[2]=2*(u*o+c*r+a*s-l*n)),dA(t,e,i),t}const pA=Wr();function mA(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function yA(t,e){const i=e[0],n=e[1],s=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(i*i+n*n+s*s),t[1]=Math.sqrt(r*r+o*o+a*a),t[2]=Math.sqrt(l*l+u*u+c*c),t}function gA(t,e){const i=e[0]+e[5]+e[10];let n=0;return i>0?(n=2*Math.sqrt(i+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t}function vA(t,e,i,n){const s=e[0],r=e[1],o=e[2],a=e[3],l=s+s,u=r+r,c=o+o,h=s*l,d=s*u,f=s*c,p=r*u,m=r*c,y=o*c,g=a*l,v=a*u,w=a*c,b=n[0],S=n[1],x=n[2];return t[0]=(1-(p+y))*b,t[1]=(d+w)*b,t[2]=(f-v)*b,t[3]=0,t[4]=(d-w)*S,t[5]=(1-(h+y))*S,t[6]=(m+g)*S,t[7]=0,t[8]=(f+v)*x,t[9]=(m-g)*x,t[10]=(1-(h+p))*x,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function wA(t,e,i,n,s){const r=e[0],o=e[1],a=e[2],l=e[3],u=r+r,c=o+o,h=a+a,d=r*u,f=r*c,p=r*h,m=o*c,y=o*h,g=a*h,v=l*u,w=l*c,b=l*h,S=n[0],x=n[1],_=n[2],M=s[0],k=s[1],T=s[2],A=(1-(m+g))*S,I=(f+b)*S,j=(p-w)*S,C=(f-b)*x,E=(1-(d+g))*x,O=(y+v)*x,L=(p+w)*_,N=(y-v)*_,R=(1-(d+m))*_;return t[0]=A,t[1]=I,t[2]=j,t[3]=0,t[4]=C,t[5]=E,t[6]=O,t[7]=0,t[8]=L,t[9]=N,t[10]=R,t[11]=0,t[12]=i[0]+M-(A*M+C*k+L*T),t[13]=i[1]+k-(I*M+E*k+N*T),t[14]=i[2]+T-(j*M+O*k+R*T),t[15]=1,t}function bA(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=i+i,a=n+n,l=s+s,u=i*o,c=n*o,h=n*a,d=s*o,f=s*a,p=s*l,m=r*o,y=r*a,g=r*l;return t[0]=1-h-p,t[1]=c+g,t[2]=d-y,t[3]=0,t[4]=c-g,t[5]=1-u-p,t[6]=f+m,t[7]=0,t[8]=d+y,t[9]=f-m,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function SA(t,e,i,n,s,r,o){const a=1/(i-e),l=1/(s-n),u=1/(r-o);return t[0]=2*r*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*l,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(s+n)*l,t[10]=(o+r)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*r*2*u,t[15]=0,t}function xA(t,e,i,n,s){const r=1/Math.tan(e/2);let o;return t[0]=r/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=s&&s!==1/0?(o=1/(n-s),t[10]=(s+n)*o,t[14]=2*s*n*o):(t[10]=-1,t[14]=-2*n),t}function _A(t,e,i,n){const s=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(s+r);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(s-r)*u*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t}function MA(t,e,i,n,s,r,o){const a=1/(e-i),l=1/(n-s),u=1/(r-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*a,t[13]=(s+n)*l,t[14]=(o+r)*u,t[15]=1,t}function kA(t,e,i,n){const s=e[0],r=e[1],o=e[2];let a=s-i[0],l=r-i[1],u=o-i[2];const c=uo();if(Math.abs(a)<c&&Math.abs(l)<c&&Math.abs(u)<c)return void WT(t);let h=1/Math.sqrt(a*a+l*l+u*u);a*=h,l*=h,u*=h;const d=n[0],f=n[1],p=n[2];let m=f*u-p*l,y=p*a-d*u,g=d*l-f*a;h=Math.sqrt(m*m+y*y+g*g),h?(h=1/h,m*=h,y*=h,g*=h):(m=0,y=0,g=0);let v=l*g-u*y,w=u*m-a*g,b=a*y-l*m;h=Math.sqrt(v*v+w*w+b*b),h?(h=1/h,v*=h,w*=h,b*=h):(v=0,w=0,b=0),t[0]=m,t[1]=v,t[2]=a,t[3]=0,t[4]=y,t[5]=w,t[6]=l,t[7]=0,t[8]=g,t[9]=b,t[10]=u,t[11]=0,t[12]=-(m*s+y*r+g*o),t[13]=-(v*s+w*r+b*o),t[14]=-(a*s+l*r+u*o),t[15]=1}function TA(t,e,i,n){const s=e[0],r=e[1],o=e[2],a=n[0],l=n[1],u=n[2];let c=s-i[0],h=r-i[1],d=o-i[2],f=c*c+h*h+d*d;f>0&&(f=1/Math.sqrt(f),c*=f,h*=f,d*=f);let p=l*d-u*h,m=u*c-a*d,y=a*h-l*c;return f=p*p+m*m+y*y,f>0&&(f=1/Math.sqrt(f),p*=f,m*=f,y*=f),t[0]=p,t[1]=m,t[2]=y,t[3]=0,t[4]=h*y-d*m,t[5]=d*p-c*y,t[6]=c*m-h*p,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=s,t[13]=r,t[14]=o,t[15]=1,t}function AA(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function IA(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function jA(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function CA(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function EA(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}function OA(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t[9]=e[9]+i[9]*n,t[10]=e[10]+i[10]*n,t[11]=e[11]+i[11]*n,t[12]=e[12]+i[12]*n,t[13]=e[13]+i[13]*n,t[14]=e[14]+i[14]*n,t[15]=e[15]+i[15]*n,t}function LA(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function NA(t,e){if(t===e)return!0;const i=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],y=t[14],g=t[15],v=e[0],w=e[1],b=e[2],S=e[3],x=e[4],_=e[5],M=e[6],k=e[7],T=e[8],A=e[9],I=e[10],j=e[11],C=e[12],E=e[13],O=e[14],L=e[15],N=uo();return Math.abs(i-v)<=N*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(n-w)<=N*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(s-b)<=N*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(r-S)<=N*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(o-x)<=N*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-_)<=N*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(l-M)<=N*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-k)<=N*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(c-T)<=N*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(h-A)<=N*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(d-I)<=N*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-j)<=N*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(p-C)<=N*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(m-E)<=N*Math.max(1,Math.abs(m),Math.abs(E))&&Math.abs(y-O)<=N*Math.max(1,Math.abs(y),Math.abs(O))&&Math.abs(g-L)<=N*Math.max(1,Math.abs(g),Math.abs(L))}function RA(t){const e=uo(),i=t[0],n=t[1],s=t[2],r=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(n*n+o*o+u*u))<=e&&Math.abs(1-(s*s+a*a+c*c))<=e}function PA(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[8]&&0===t[9]&&1===t[10]}const FA=XT,DA=CA;Object.freeze(Object.defineProperty({__proto__:null,add:jA,adjoint:YT,copy:qT,determinant:QT,equals:NA,exactEquals:LA,frob:IA,fromQuat:bA,fromQuat2:fA,fromRotation:lA,fromRotationTranslation:dA,fromRotationTranslationScale:vA,fromRotationTranslationScaleOrigin:wA,fromScaling:aA,fromTranslation:oA,fromXRotation:uA,fromYRotation:cA,fromZRotation:hA,frustum:SA,getRotation:gA,getScaling:yA,getTranslation:mA,hasIdentityRotation:PA,identity:WT,invert:KT,invertOrIdentity:JT,isOrthoNormal:RA,lookAt:kA,mul:FA,multiply:XT,multiplyScalar:EA,multiplyScalarAndAdd:OA,ortho:MA,perspective:xA,perspectiveFromFieldOfView:_A,rotate:iA,rotateX:nA,rotateY:sA,rotateZ:rA,scale:eA,set:HT,str:AA,sub:DA,subtract:CA,targetTo:TA,translate:tA,transpose:ZT},Symbol.toStringTag,{value:"Module"}));const $A=(t,e)=>{const i=HT(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return ZT(i,i)},zA=(t,e)=>{const i=HT(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return ZT(i,i)},UA=(t,e)=>{const i=1-e,n=HT(t,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return ZT(n,n)},VA=(t,e)=>{const i=Math.sin(e*Math.PI/180),n=Math.cos(e*Math.PI/180),s=HT(t,.213+.787*n-.213*i,.715-.715*n-.715*i,.072-.072*n+.928*i,0,.213-.213*n+.143*i,.715+.285*n+.14*i,.072-.072*n-.283*i,0,.213-.213*n-.787*i,.715-.715*n+.715*i,.072+.928*n+.072*i,0,0,0,0,1);return ZT(s,s)},GA=(t,e)=>{const i=1-2*e,n=HT(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return ZT(n,n)},BA=(t,e)=>{const i=HT(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return ZT(i,i)},qA=(t,e)=>{const i=1-e,n=HT(t,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return ZT(n,n)};class HA{constructor(t,e,i){this.strength=t,this.radius=e,this.threshold=i,this.type="bloom"}interpolate(t,e,i){this.strength=QA(t.strength,e.strength,i),this.radius=QA(t.radius,e.radius,i),this.threshold=QA(t.threshold,e.threshold,i)}clone(){return new HA(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:XA(this.radius),strength:this.strength,threshold:this.threshold}}}class WA{constructor(t){this.radius=t,this.type="blur"}interpolate(t,e,i){this.radius=Math.round(QA(t.radius,e.radius,i))}clone(){return new WA(this.radius)}toJSON(){return{type:"blur",radius:XA(this.radius)}}}class ZA{constructor(t,e){this.type=t,this.amount=e,"invert"!==this.type&&"grayscale"!==this.type&&"sepia"!==this.type||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,e,i){this.amount=QA(t.amount,e.amount,i),this._updateMatrix()}clone(){return new ZA(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||zT();switch(this.type){case"brightness":this._colorMatrix=$A(t,this.amount);break;case"contrast":this._colorMatrix=zA(t,this.amount);break;case"grayscale":this._colorMatrix=UA(t,this.amount);break;case"invert":this._colorMatrix=GA(t,this.amount);break;case"saturate":this._colorMatrix=BA(t,this.amount);break;case"sepia":this._colorMatrix=qA(t,this.amount)}}}class JA{constructor(t,e,i,n){this.offsetX=t,this.offsetY=e,this.blurRadius=i,this.color=n,this.type="drop-shadow"}interpolate(t,e,i){this.offsetX=QA(t.offsetX,e.offsetX,i),this.offsetY=QA(t.offsetY,e.offsetY,i),this.blurRadius=QA(t.blurRadius,e.blurRadius,i),this.color[0]=Math.round(QA(t.color[0],e.color[0],i)),this.color[1]=Math.round(QA(t.color[1],e.color[1],i)),this.color[2]=Math.round(QA(t.color[2],e.color[2],i)),this.color[3]=QA(t.color[3],e.color[3],i)}clone(){return new JA(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:XA(this.offsetX),yoffset:XA(this.offsetY),blurRadius:XA(this.blurRadius),color:t}}}class KA{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,e,i){this.angle=QA(t.angle,e.angle,i),this._updateMatrix()}clone(){return new KA(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||zT();this._colorMatrix=VA(t,this.angle)}}class YA{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,e,i){this.amount=QA(t.amount,e.amount,i)}clone(){return new YA(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function QA(t,e,i){return t+(e-t)*i}function XA(t){return Math.round(1e3*PT(t))/1e3}function tI(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new ZA(t.type,0);case"saturate":case"brightness":case"contrast":return new ZA(t.type,1);case"opacity":return new YA(1);case"hue-rotate":return new KA(0);case"blur":return new WA(0);case"drop-shadow":return new JA(0,0,0,[...cT("transparent")]);case"bloom":return new HA(0,0,1)}}function eI(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every(((t,e)=>t.type===i[e].type))}function iI(t,e){const i=t.length>e.length?t:e,n=t.length>e.length?e:t;for(let t=n.length;t<i.length;t++)n.push(tI(i[t]))}function nI(t){const e=t[0];return!!e&&"type"in e}function sI(t,e){return JSON.stringify(t??null)===JSON.stringify(e??null)}const rI=()=>Ft.getLogger("esri.support.basemapUtils");function oI(){return{}}function aI(t){for(const e in t){const i=t[e];$t(i),delete t[e]}}function lI(t,e){let i;if("string"==typeof t){const n=t in kk,s=!n&&t.includes("/");if(!n&&!s){const e=Object.entries(kk).filter((([t,e])=>It.apiKey&&!e.classic||!It.apiKey&&(e.classic||e.is3d))).map((([t])=>`"${t}"`)).sort().join(", ");return rI().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${e}`),null}e&&(i=e[t]),i||(i=n?oT.fromId(t):new oT({style:{id:t}}),e&&(e[t]=i))}else i=ks(oT,t);return i?.destroyed&&(rI().warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function uI(t){return"Web Scene"===t.portalItem?.type||t.referenceLayers.some((t=>"scene"===t.type))}function cI(t){return!!t?.portalItem?.tags?.some((t=>"beta"===t.toLowerCase()))}function hI(t){let e=null;const i=vI(t),n=!i?.baseLayers.length;for(const t in kk){const s=kI(i,xI(kk[t]),{mustMatchReferences:n});if("equal"===s){e=t;break}"base-layers-equal"===s&&(e=t)}return e}function dI(t,e){if(t===e)return!0;if(null!=t?.portalItem?.id&&t.portalItem.id===e?.portalItem?.id)return!0;return"equal"===kI(vI(t),vI(e),{mustMatchReferences:!0})}function fI(t){return!!t?.baseLayers.concat(t.referenceLayers).some(pI)}function pI(t){if(gI(t.url))return!0;if("vector-tile"===t.type)for(const e in t.sourceNameToSource){const i=t.sourceNameToSource[e];if(gI(i?.sourceUrl))return!0}return!1}function mI(t,e){if(null==e||null==t)return{spatialReference:null,updating:!1};if("not-loaded"===e.loadStatus)return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(0===e.baseLayers.length)return{spatialReference:null,updating:!1};const i=e.baseLayers.at(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const n=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?i.tileInfo?.spatialReference:i.spatialReference]).filter(Boolean),s=t.spatialReference;return s?{spatialReference:n.find((t=>s.equals(t)))??n[0]??null,updating:!1}:{spatialReference:n[0],updating:!1}}const yI=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function gI(t){if(!t)return!1;const e=new Ol(su(t));return!!e.authority&&yI.test(e.authority)}function vI(t){return t?!t.loaded&&t.resourceInfo?xI(t.resourceInfo.data):{baseLayers:wI(t.baseLayers),referenceLayers:wI(t.referenceLayers)}:null}function wI(t){return(ty.isCollection(t)?t.toArray():t).map(bI)}function bI(t){return{type:t.type,effect:"effect"in t?t.effect:void 0,url:II("urlTemplate"in t&&t.urlTemplate||t.url||"styleUrl"in t&&t.styleUrl||""),minScale:"minScale"in t&&null!=t.minScale?t.minScale:0,maxScale:"maxScale"in t&&null!=t.maxScale?t.maxScale:0,opacity:null!=t.opacity?t.opacity:1,visible:null==t.visible||!!t.visible,sublayers:"map-image"!==t.type&&"wms"!==t.type||null==t.sublayers?void 0:t.sublayers?.map((t=>({id:t.id,visible:t.visible}))),activeLayerId:"wmts"===t.type?t.activeLayer?.id:void 0}}function SI(t){return t.isReference||"ArcGISSceneServiceLayer"===t.layerType}function xI(t){return t?{baseLayers:_I((t.baseMapLayers??[]).filter((t=>!SI(t)))),referenceLayers:_I((t.baseMapLayers??[]).filter((t=>SI(t))))}:null}function _I(t){return t.map((t=>MI(t)))}function MI(t){let e;switch(t.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;case"ArcGISSceneServiceLayer":e="scene";break;default:e="unknown"}return{type:e,effect:t.effect,url:II(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:t.minScale??0,maxScale:t.maxScale??0,opacity:t.opacity??1,visible:null==t.visibility||!!t.visibility,sublayers:void 0,activeLayerId:void 0}}function kI(t,e,i){if(null!=t!=(null!=e))return"not-equal";if(!t||!e)return"equal";if(!TI(t.baseLayers,e.baseLayers))return"not-equal";return TI(t.referenceLayers,e.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal"}function TI(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!AI(t[i],e[i]))return!1;return!0}function AI(t,e){if(t.type!==e.type||t.url!==e.url||t.minScale!==e.minScale||t.maxScale!==e.maxScale||t.visible!==e.visible||t.opacity!==e.opacity)return!1;if(!sI(t.effect,e.effect))return!1;if(null!=t.activeLayerId||null!=e.activeLayerId)return t.activeLayerId===e.activeLayerId;if(null!=t.sublayers||null!=e.sublayers){if(null==t.sublayers||null==e.sublayers||t.sublayers.length!==e.sublayers.length)return!1;for(let i=0;i<t.sublayers.length;i++){const n=t.sublayers.at(i),s=e.sublayers.at(i);if(n?.id!==s?.id||n?.visible!==s?.visible)return!1}}return!0}function II(t){return t?ou(t).replace(/^\s*https?:/i,"").toLowerCase():""}function jI(t){if(!t)return null;const{thumbnailUrl:e}=t;if(e)return e;const i=hI(t);return i?kk[i].thumbnailUrl:qt(t.baseLayers,CI)}function CI(t){return"portalItem"in t?t.portalItem?.thumbnailUrl:void 0}function EI(t){return new dy({getCollections:()=>[t.tables,t.layers],getChildrenFunction:t=>{const e=[];return"tables"in t&&e.push(t.tables),"layers"in t&&e.push(t.layers),e},itemFilterFunction:t=>{const e=t.parent;return!!e&&"tables"in e&&e.tables.includes(t)}})}function OI(t){for(const e of t.values())e?.destroy();t.clear()}const LI={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function NI(t){let e=null;if("string"==typeof t)if(t in LI){const i=LI[t];e=new CT({resourceInfo:{data:{layers:[i]}}})}else Ft.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=ks(CT,t);return e}let RI=0;const PI=t=>{let e=class extends t{constructor(...t){super(...t),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+RI++})}};return e=o([Nr("esri.core.Identifiable")],e),e},FI=t=>{let e=class extends t{constructor(...t){super(...t),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:RI++})}};return e=o([Nr("esri.core.NumericIdentifiable")],e),e};let DI=class extends(PI(class{})){};DI=o([Nr("esri.core.Identifiable")],DI);async function $I(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await import("./p-29f2499f.js").then((function(t){return t.p}));try{return await i(e)}catch(t){const i=e&&e.portalItem,n=i?.id||"unset",s=i&&i.portal&&i.portal.url||It.portalUrl;throw Ft.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+s+"', id: '"+n+"')",t),t}}let zI=0,UI=class extends(Pm.EventedMixin(PI(AM))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Rf(-180,-90,180,90,jd.WGS84),this.id=Date.now().toString(16)+"-layer-"+zI++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=jd.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(t){const e="string"==typeof t?{url:t}:t;return(await import("./p-524ef299.js")).fromUrl(e)}static fromPortalItem(t){return $I(t)}initialize(){this.when().catch((t=>{Pi(t)||Ft.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})}))}destroy(){const t=this.parent;if(t){const e=this;"layers"in t&&t.layers.includes(e)?t.layers.remove(e):"tables"in t&&t.tables.includes(e)?t.tables.remove(e):"baseLayers"in t&&t.baseLayers.includes(e)?t.baseLayers.remove(e):"referenceLayers"in t&&t.referenceLayers.includes(e)&&t.referenceLayers.remove(e),this._set("parent",null)}}get hasAttributionData(){return null!=this.attributionDataUrl}get parsedUrl(){return Ul(this.url)}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t){return(await hc(t,{query:{f:"json"},responseType:"json"})).data}throw new Qe("layer:no-attribution-data","Layer does not have attribution data")}};o([Us({type:String})],UI.prototype,"attributionDataUrl",void 0),o([Us({type:Rf})],UI.prototype,"fullExtent",void 0),o([Us({readOnly:!0})],UI.prototype,"hasAttributionData",null),o([Us({type:String,clonable:!1})],UI.prototype,"id",void 0),o([Us({type:Boolean,nonNullable:!0})],UI.prototype,"legendEnabled",void 0),o([Us({type:["show","hide","hide-children"]})],UI.prototype,"listMode",void 0),o([Us({type:Number,range:{min:0,max:1},nonNullable:!0})],UI.prototype,"opacity",void 0),o([Us({clonable:!1})],UI.prototype,"parent",void 0),o([Us({readOnly:!0})],UI.prototype,"parsedUrl",null),o([Us({type:Boolean,readOnly:!0})],UI.prototype,"persistenceEnabled",void 0),o([Us({type:Boolean})],UI.prototype,"popupEnabled",void 0),o([Us({type:Boolean})],UI.prototype,"attributionVisible",void 0),o([Us({type:jd})],UI.prototype,"spatialReference",void 0),o([Us({type:String})],UI.prototype,"title",void 0),o([Us({readOnly:!0,json:{read:!1}})],UI.prototype,"type",void 0),o([Us()],UI.prototype,"url",void 0),o([Us({type:Boolean,nonNullable:!0})],UI.prototype,"visible",void 0),UI=o([Nr("esri.layers.Layer")],UI);const VI=UI;function GI(t,e,i){let n,s;if(t)for(let r=0,o=t.length;r<o;r++){if(n=t.at(r),n?.[e]===i)return n;if("group"===n?.type&&(s=GI(n.layers,e,i),s))return s}}const BI=t=>{let e=class extends t{constructor(...t){super(...t),this.layers=new ty;const e=t=>{t.parent&&"remove"in t.parent&&t.parent.remove(t)},i=t=>{t.parent=this,this.layerAdded(t),"elevation"!==t.type&&"base-elevation"!==t.type||Ft.getLogger(this).error(`Layer 'title:${t.title}, id:${t.id}' of type '${t.type}' is not supported as an operational layer and will therefore be ignored.`)},n=t=>{t.parent=null,this.layerRemoved(t)};this.addHandles([this.layers.on("before-add",(t=>e(t.item))),this.layers.on("after-add",(t=>i(t.item))),this.layers.on("after-remove",(t=>n(t.item)))])}destroy(){const t=this.layers.toArray();for(const e of t)e.destroy();this.layers.destroy()}set layers(t){this._set("layers",pM(t,this._get("layers")))}add(t,e){const i=this.layers;if(e=i.getNextIndex(e),t instanceof VI){const n=t;n.parent===this?this.reorder(n,e):i.add(n,e)}else Gi(t)?t.then((t=>{this.destroyed||this.add(t,e)})):Ft.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(t,e){const i=this.layers;let n=i.getNextIndex(e);t.slice().forEach((t=>{t.parent!==this?(i.add(t,n),n+=1):this.reorder(t,n)}))}findLayerById(t){return GI(this.layers,"id",t)}findLayerByUid(t){return GI(this.layers,"uid",t)}remove(t){return this.layers.remove(t)}removeMany(t){return this.layers.removeMany(t)}removeAll(){return this.layers.removeAll()}reorder(t,e){return this.layers.reorder(t,e)}layerAdded(t){}layerRemoved(t){}};return o([Us()],e.prototype,"layers",null),e=o([Nr("esri.support.LayersMixin")],e),e};function qI(t,e,i){if(t)for(let n=0,s=t.length;n<s;n++){const s=t.at(n);if(s[e]===i)return s;if("group"===s?.type){const t=qI(s.tables,e,i);if(t)return t}}}const HI=t=>{let e=class extends t{constructor(...t){super(...t),this.tables=new ty,this.addHandles([this.tables.on("after-add",(t=>{const e=t.item;e.parent&&e.parent!==this&&"tables"in e.parent&&e.parent.tables.remove(e),e.parent=this,"feature"!==e.type&&Ft.getLogger(this).error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as a table and will therefore be ignored.`)})),this.tables.on("after-remove",(t=>{t.item.parent=null}))])}destroy(){const t=this.tables.toArray();for(const e of t)e.destroy();this.tables.destroy()}set tables(t){this._set("tables",pM(t,this._get("tables")))}findTableById(t){return qI(this.tables,"id",t)}findTableByUid(t){return qI(this.tables,"uid",t)}};return o([Us()],e.prototype,"tables",null),e=o([Nr("esri.support.TablesMixin")],e),e};let WI=class extends(HI(BI(Pm.EventedMixin(Vr)))){constructor(t){super(t),this.allLayers=new dy({getCollections:()=>[this.basemap?.baseLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=EI(this),this.basemap=null,this.editableLayers=new dy({getCollections:()=>[this.allLayers],itemFilterFunction:ET}),this.ground=new CT,this._basemapCache=oI()}destroy(){aI(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=$t(this.basemap),$t(this.ground),this._set("ground",null)}castBasemap(t){return lI(t,this._basemapCache)}castGround(t){const e=NI(t);return e??this._get("ground")}findLayerById(t){return this.allLayers.find((e=>e.id===t))}findTableById(t){return this.allTables.find((e=>e.id===t))}};o([Us({readOnly:!0,dependsOn:[]})],WI.prototype,"allLayers",void 0),o([Us({readOnly:!0})],WI.prototype,"allTables",void 0),o([Us({type:oT,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],WI.prototype,"basemap",void 0),o([ol("basemap")],WI.prototype,"castBasemap",null),o([Us({readOnly:!0})],WI.prototype,"editableLayers",void 0),o([Us({type:CT,nonNullable:!0})],WI.prototype,"ground",void 0),o([ol("ground")],WI.prototype,"castGround",null),o([Us()],WI.prototype,"undoRedo",void 0),WI=o([Nr("esri.Map")],WI);const ZI=WI;const JI={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function KI(t,e,i,n=pg){const s=new fg.IANAZone(Kg(n)),r=fg.DateTime.fromJSDate(t,{zone:s}),o="decades"===i||"centuries"===i?"year":XI(i);return"decades"===i&&(e*=10),"centuries"===i&&(e*=100),r.plus({[o]:e}).toJSDate()}function YI(t,e,i=pg){const n=new fg.IANAZone(Kg(i)),s=fg.DateTime.fromJSDate(t,{zone:n});if("decades"===e||"centuries"===e){const t=s.startOf("year"),{year:i}=t,n=i-i%("decades"===e?10:100);return t.set({year:n}).toJSDate()}const r=XI(e);return s.startOf(r).toJSDate()}function QI(t,e,i){if(0===t)return 0;return t*JI[e]/JI[i]}function XI(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var tj;let ej=tj=class extends el{static get allTime(){return ij}static get empty(){return nj}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,e){return null!=e.end?new Date(e.end):null}writeEnd(t,e){e.end=t?.getTime()??null}get isAllTime(){return this.equals(tj.allTime)}get isEmpty(){return this.equals(tj.empty)}readStart(t,e){return null!=e.start?new Date(e.start):null}writeStart(t,e){e.start=t?.getTime()??null}clone(){return new tj({end:this.end,start:this.start})}equals(t){if(!t)return!1;const e=this.start?.getTime()??this.start,i=this.end?.getTime()??this.end,n=t.start?.getTime()??t.start,s=t.end?.getTime()??t.end;return e===n&&i===s}expandTo(t,e=pg){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=YI(i,t,e));let n=this.end;if(n){const i=YI(n,t,e);n=n.getTime()===i.getTime()?i:KI(i,1,t,e)}return new tj({start:i,end:n})}intersection(t){if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return tj.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=this.start?.getTime()??-1/0,i=this.end?.getTime()??1/0,n=t.start?.getTime()??-1/0,s=t.end?.getTime()??1/0;let r,o;if(n>=e&&n<=i?r=n:e>=n&&e<=s&&(r=e),i>=n&&i<=s?o=i:s>=e&&s<=i&&(o=s),null!=r&&null!=o&&!isNaN(r)&&!isNaN(o)){const t=new tj;return t.start=r===-1/0?null:new Date(r),t.end=o===1/0?null:new Date(o),t}return tj.empty}offset(t,e,i=pg){if(this.isEmpty||this.isAllTime)return this.clone();const n=new tj,{start:s,end:r}=this;return null!=s&&(n.start=KI(s,t,e,i)),null!=r&&(n.end=KI(r,t,e,i)),n}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return ij.clone();const e=null!=this.start&&null!=t.start?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=null!=this.end&&null!=t.end?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new tj({start:e,end:i})}};o([Us({type:Date,json:{write:{allowNull:!0}}})],ej.prototype,"end",void 0),o([al("end")],ej.prototype,"readEnd",null),o([ll("end")],ej.prototype,"writeEnd",null),o([Us({readOnly:!0,json:{read:!1}})],ej.prototype,"isAllTime",null),o([Us({readOnly:!0,json:{read:!1}})],ej.prototype,"isEmpty",null),o([Us({type:Date,json:{write:{allowNull:!0}}})],ej.prototype,"start",void 0),o([al("start")],ej.prototype,"readStart",null),o([ll("start")],ej.prototype,"writeStart",null),ej=tj=o([Nr("esri.TimeExtent")],ej);const ij=new ej,nj=new ej({start:void 0,end:void 0}),sj=ej;let rj=class extends ty{constructor(t){super(t),this.addHandles([this.on("before-add",(t=>{null==t.item&&t.preventDefault()})),this.on("after-add",(t=>this._own(t.item))),this.on("after-remove",(t=>this._release(t.item)))])}get owner(){return this._get("owner")}set owner(t){t!==this._get("owner")&&(this._releaseAll(),this._set("owner",t),this._ownAll())}_ownAll(){for(const t of this.items)this._own(t)}_releaseAll(){for(const t of this.items)this._release(t)}_createNewInstance(t){return this.itemType?new(ty.ofType(this.itemType.Type))(t):new ty(t)}};function oj(t,e){return{type:t,cast:mM,set(i){const n=pM(i,this._get(e),t);n.owner=this,this._set(e,n)}}}o([Us()],rj.prototype,"owner",null),rj=o([Nr("esri.core.support.OwningCollection")],rj);var aj;const lj=cl()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),uj=lj.jsonValues.slice();L(uj,"orthometric");const cj=cl()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let hj=aj=class extends el{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return lj.write(t,e,i)}readHeightModel(t,e,i){const n=lj.read(t);return n||(i?.messages&&i.messages.push(fj(t,{context:i})),null)}readHeightUnit(t,e,i){const n=cj.read(t);return n||(i?.messages&&i.messages.push(dj(t,{context:i})),null)}readHeightUnitService(t,e,i){const n=ld(t)||cj.read(t);return n||(i?.messages&&i.messages.push(dj(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new aj({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=cd(e);return new aj({heightModel:t.heightModel,heightUnit:i??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new aj;return e.read(t,{origin:"web-scene"}),e}};function dj(t,e){return new Hs("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function fj(t,e){return new Hs("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}o([Us({type:lj.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:uj,default:"ellipsoidal"}}}})],hj.prototype,"heightModel",void 0),o([ll("web-scene","heightModel")],hj.prototype,"writeHeightModel",null),o([al(["web-scene","service"],"heightModel")],hj.prototype,"readHeightModel",null),o([Us({type:cj.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:cj.jsonValues,write:cj.write}}}})],hj.prototype,"heightUnit",void 0),o([al("web-scene","heightUnit")],hj.prototype,"readHeightUnit",null),o([al("service","heightUnit")],hj.prototype,"readHeightUnitService",null),o([Us({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],hj.prototype,"vertCRS",void 0),o([al("service","vertCRS",["vertCRS","ellipsoid","geoid"])],hj.prototype,"readVertCRS",null),hj=aj=o([Nr("esri.geometry.HeightModelInfo")],hj);const pj=hj;let mj=class extends rj{constructor(t){super(t),this.addHandles(this.on("before-add",(t=>{null!=t.item&&t.item.parent===this.owner&&(Ft.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())})))}_own(t){t.parent=this.owner}_release(t){t.parent=null}};mj=o([Nr("esri.support.AnalysesCollection")],mj);async function yj(t,e){const{WhereClause:i}=await import("./p-70a81651.js").then((function(t){return t.W}));return i.create(t,e)}function gj(t,e){return null!=t&&""!==t?null!=e&&""!==e?`(${t}) AND (${e})`:t:e}function vj(t){return"number"==typeof t}function wj(t){return"string"==typeof t||t instanceof String}const bj=yg,Sj={date:null,time:null,timeZoneOffset:null},xj=new Map([["hours",3600],["minutes",60],["seconds",1],["deciseconds",.1],["centiseconds",.01],["milliseconds",.001]]),_j="yyyy-MM-dd",Mj="TT";var kj;!function(t){t.HM="HH:mm",t.HMS="HH:mm:ss",t.HMS_MS="HH:mm:ss.SSS"}(kj||(kj={}));const Tj=[kj.HMS_MS,kj.HMS,kj.HM,Mj],Aj="latn",Ij=new Set(["date-only","time-only","timestamp-offset"]),jj=t=>"valueAsDate"in t;function Cj(t){return{locale:ng(),numberingSystem:Aj,zone:t??bj}}function Ej(t,e){return null===t?null:fg.DateTime.fromMillis(t,Cj(e))}function Oj(t,e){if(null==t||!wj(t)||""===t){if(e){const t=fg.DateTime.local().setZone(e);return{date:null,time:null,timeZoneOffset:t.isValid?t.offset.toString():null}}return Sj}const i=fg.DateTime.fromISO(t,{setZone:!0});return{date:i.toFormat(_j,Cj()),time:i.toFormat(kj.HMS_MS,Cj()),timeZoneOffset:i.offset.toString()}}function Lj(t,e){if(null==t||!vj(t)||isNaN(t))return Sj;const i=Ej(t,e);return i?{date:i.toFormat(_j,Cj(e)),time:i.toFormat(Mj,Cj(e))}:Sj}function Nj(t){switch(t.type){case"date":default:return qg("short-date-short-time");case"date-only":return qg("short-date");case"time-only":return qg("short-time");case"timestamp-offset":return{...qg("short-date-short-time"),timeZone:void 0,timeZoneName:"short"}}}function Rj(t,e,i){if(!t||null==e)return null;switch(t.type){case"date":return Hg(e,i);case"date-only":return Wg(e,i);case"time-only":return Zg(e,i);case"timestamp-offset":return Jg(e,i);default:return null}}function Pj(t){const{dateComponent:e,defaultTimeZone:i,timeComponent:n,timeZoneComponent:s,oldValue:r}=t;if(!e?.value||!n?.value)return null;const{year:o,month:a,day:l}=fg.DateTime.fromFormat(e.value,_j),{hour:u,minute:c,second:h,millisecond:d}=Dj(n,yg)??fg.DateTime.now(),f=Oj(r,i),p=null!=s?.value?parseInt(s.value,10):null!=f.timeZoneOffset?parseInt(f.timeZoneOffset,10):(new Date).getTimezoneOffset(),m=fg.FixedOffsetZone.instance(p),y=fg.DateTime.fromObject({year:o,month:a,day:l,hour:u,minute:c,second:h,millisecond:d},{zone:m});return y.isValid?y.toISO({includeOffset:!0}):null}function Fj(t){const{dateComponent:e,timeComponent:i,timeZone:n,max:s,min:r,oldValue:o}=t,a=Dj(e,n);let l=!!t.applyRange;if(!a)return null;let u=null;if(null!=i?.value){const t=Dj(i,n),e=Date.now(),r=null!=s&&s<e?s:e,o=fg.DateTime.fromMillis(r,Cj(n)),l=a||o,{year:c,month:h,day:d}=l,{hour:f,minute:p,second:m,millisecond:y}=t||o;u=l.set({year:c,month:h,day:d,hour:f,minute:p,second:m,millisecond:y})}else{const t=Ej(zj({value:o??Date.now(),max:s,min:r}),n),{year:e,month:i,day:c}=a,{hour:h,minute:d,second:f,millisecond:p}=t;l=!0,u=a.set({year:e,month:i,day:c,hour:h,minute:d,second:f,millisecond:p})}if(!u.isValid)return null;const c=u.toMillis();return l?zj({value:c,max:s,min:r}):c}function Dj(t,e){if(null==t?.value||Array.isArray(t.value))return null;let i=null;return i=jj(t)?fg.DateTime.fromFormat(t.value,_j,Cj(e)):qj(t.value),i?.isValid?i:null}function $j(t){const{max:e,min:i,value:n}=t;return!isNaN(n)&&(!(null!=e&&n>e)&&!(null!=i&&n<i))}function zj(t){const{max:e,min:i,value:n}=t;return null!=e&&null!=i?pa(n,i,e):null!=e&&n>e?e:null!=i&&n<i?i:n}function Uj(t){if(!t)return"";const e=t.split(".").at(0);if(!e||e.length<1)throw new Qe("invalid time-only field",`Cannot parse valid time-only field value from ${t}`);const i=e.split(":"),n=new Array(3);for(let t=0;t<3;t++){const e=i.at(t)??"";n[t]=e.padStart(2,"0")}return n.join(":")}function Vj(t,e){switch(e){case"date":return t.getTime();case"date-only":return t.toISODate();case"time-only":return Uj(t.toISOTime(!0,!1));case"timestamp-offset":return t.toISOString(!1);default:return null}}function Gj(t){return!!t&&"object"==typeof t&&"getTime"in t&&"toISOString"in t&&"timeZone"in t}function Bj(t){if(!t||!wj(t))return null;const e=fg.DateTime.fromFormat(t,_j);return e.isValid?e:null}function qj(t){return t&&wj(t)?qt(Tj,(e=>{const i=fg.DateTime.fromFormat(t,e);return i.isValid?i:null}))??null:null}function Hj(t){if(!t||!wj(t))return null;const e=fg.DateTime.fromISO(t);return e.isValid?e:null}function Wj(t){const{type:e,range:i,value:n}=t;if(null==n||!i||n===i.min||n===i.max)return!0;if("date"===e)return $j({value:n,min:i.min,max:i.max});const{rawMax:s,rawMin:r}=i;let o=null,a=null,l=null;switch(e){case"date-only":o=Bj(s),a=Bj(r),l=Bj(n);break;case"time-only":o=qj(s),a=qj(r),l=qj(n);break;case"timestamp-offset":o=Hj(s),a=Hj(r),l=Hj(n)}return!l||$j({value:l.valueOf(),min:a?.valueOf(),max:o?.valueOf()})}var Zj;!function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"}(Zj||(Zj={}));const Jj=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function Kj(t){return null!=t&&Jj.has(t.type)}function Yj(t){return null!=t&&("date-only"===t.type||"esriFieldTypeDateOnly"===t.type)}function Qj(t){return null!=t&&("timestamp-offset"===t.type||"esriFieldTypeTimestampOffset"===t.type)}function Xj(t){return null!=t&&("time-only"===t.type||"esriFieldTypeTimeOnly"===t.type)}function tC(t,e){const i=t?.domain;if(!i)return null;switch(i.type){case"range":{const{min:i,max:n}=eC(t);if(null!=i&&+e<i||null!=n&&+e>n)return Zj.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(null==i.codedValues||i.codedValues.every((t=>null==t||t.code!==e)))return Zj.INVALID_CODED_VALUE}return null}function eC(t,e){const i=e??t?.domain;if(!i||"range"!==i.type)return;const n="range"in i?i.range[0]:i.minValue,s="range"in i?i.range[1]:i.maxValue,r=Kj(t);return Yj(t)||Xj(t)||Qj(t)?{...iC(t,s,n),isInteger:r}:{min:null!=n&&"number"==typeof n?n:null,max:null!=s&&"number"==typeof s?s:null,rawMin:n,rawMax:s,isInteger:r}}function iC(t,e,i){return Yj(t)?{min:Bj(i)?.toMillis(),max:Bj(e)?.toMillis(),rawMin:i,rawMax:e}:Xj(t)?{min:qj(i)?.toMillis(),max:qj(e)?.toMillis(),rawMin:i,rawMax:e}:Qj(t)?{min:Hj(i)?.toMillis(),max:Hj(e)?.toMillis(),rawMin:i,rawMax:e}:{max:null,min:null}}const nC=()=>Ft.getLogger("esri.support.arcadeOnDemand");let sC;function rC(){return sC||(sC=(async()=>{const t=await import("./p-32a39338.js").then((function(t){return t.aK}));return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),sC}const oC=(t,e,i)=>lC.create(t,e,i,null,["$feature","$view"],[]),aC=(t,e,i,n)=>lC.create(t,e,i,n,["$feature","$view"],[]);class lC{constructor(t,e,i,n,s,r,o){this.services=null,this.script=t,this.evaluate=n;const a=Array.isArray(r)?r:r?.fields;this.fields=a??[],this._syntaxTree=i,this._arcade=e,this._arcadeFeature=s,this._spatialReference=o,this._referencesGeometry=e.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(t,e,i,n,s,r){const{arcade:o,Feature:a,Dictionary:l}=await rC(),u=jd.fromJSON(e);let c;try{c=o.parseScript(t,r)}catch(e){return nC().error(new Qe("arcade-bad-expression","Failed to parse arcade script",{script:t,error:e})),null}const h=s.reduce(((t,e)=>({...t,[e]:null})),{});let d=null;null!=n&&(d=new l(n),d.immutable=!0,h.$config=null);const f=o.scriptUsesGeometryEngine(c),p=f&&o.enableGeometrySupport(),m=o.scriptUsesFeatureSet(c)&&o.enableFeatureSetSupport(),y=o.scriptIsAsync(c),g=y&&o.enableAsyncSupport(),v={vars:h,spatialReference:u,useAsync:!!g};await Promise.all([p,m,g]);const w=new Set;await o.loadDependentModules(w,c,null,y,f);const b=new l;b.immutable=!1,b.setField("scale",0);const S=o.compileScript(c,v),x=(t,e)=>{const i=t.$view?.timeZone;return"$view"in t&&t.$view&&(b.setField("scale","object"==typeof t.$view&&"scale"in t.$view?t.$view.scale:void 0),t.$view=b),d&&(t.$config=d),S({vars:t,spatialReference:u,services:e,timeZone:i})};return new lC(t,o,c,x,new a,i,u)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}}const uC=/^([0-9_])/,cC=/[^a-z0-9_\u0080-\uffff]+/gi;function hC(t){if(null==t)return null;return t.trim().replaceAll(cC,"_").replace(uC,"F$1")||null}const dC=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],fC=["field","normalizationField"];function pC(t,e){if(null!=t&&null!=e)for(const i of Array.isArray(t)?t:[t])if(mC(dC,i,e),"visualVariables"in i&&i.visualVariables)for(const t of i.visualVariables)mC(fC,t,e)}function mC(t,e,i){if(t)for(const n of t){const t=Mt(n,e),s=t&&"function"!=typeof t&&i.get(t);s&&kt(n,s.name,e)}}function yC(t,e){if(null!=t&&e?.fields?.length)if("startField"in t){const i=e.get(t.startField),n=e.get(t.endField);t.startField=i?.name??null,t.endField=n?.name??null}else{const i=e.get(t.startTimeField),n=e.get(t.endTimeField);t.startTimeField=i?.name??null,t.endTimeField=n?.name??null}}const gC=new Set;function vC(t,e){return t&&e?(gC.clear(),wC(gC,t,e),Array.from(gC).sort()):[]}function wC(t,e,i){if(i)if(e?.fields?.length)if(i.includes("*"))for(const{name:i}of e.fields)t.add(i);else for(const n of i)bC(t,e,n);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const e of i)null!=e&&t.add(e)}}function bC(t,e,i){if("string"==typeof i)if(e){const n=e.get(i);n&&t.add(n.name)}else t.add(i)}function SC(t,e){return null==e||null==t?[]:e.includes("*")?(t.fields??[]).map((t=>t.name)):e}function xC(t,e,i=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const n=vC(t,e);return n.length/t.fields.length>=i?["*"]:n}async function _C(t,e,i){if(!i)return;const{arcadeUtils:n}=await rC(),s=n.extractFieldNames(i,e?.fields?.map((t=>t.name)));for(const i of s)bC(t,e,i)}async function MC(t,e,i){if(i&&"1=1"!==i){const n=await yj(i,e);if(!n.isStandardized)throw new Qe("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});wC(t,e,n.fieldNames)}}function kC({displayField:t,fields:e}){return t||(e?.length?AC(e,"name-or-title")||AC(e,"unique-identifier")||AC(e,"type-or-category")||TC(e):null)}function TC(t){for(const e of t){if(!e?.name)continue;const t=e.name.toLowerCase();if(t.includes("name")||t.includes("title"))return e.name}return null}function AC(t,e){for(const i of t)if(i?.valueType&&i.valueType===e)return i.name;return null}async function IC(t,e){if(!e)return;const i=e.elevationInfo?.featureExpressionInfo;return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}function jC(t,e,i){i.onStatisticExpression?_C(t,e,i.onStatisticExpression.expression):t.add(i.onStatisticField)}async function CC(t,e,i){if(!e||!i||!("fields"in i))return;const n=[],s=i.popupTemplate;n.push(EC(t,e,s)),i.fields&&n.push(...i.fields.map((async i=>jC(t,e.fieldsIndex,i)))),await Promise.all(n)}async function EC(t,e,i){const n=[];i?.expressionInfos&&n.push(...i.expressionInfos.map((i=>_C(t,e.fieldsIndex,i.expression))));const s=i?.content;if(Array.isArray(s))for(const i of s)"expression"===i.type&&i.expressionInfo&&n.push(_C(t,e.fieldsIndex,i.expressionInfo.expression));await Promise.all(n)}async function OC(t,e,i){e&&(e.timeInfo&&i?.timeExtent&&wC(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&wC(t,e.fieldsIndex,[e.floorInfo.floorField]),null!=i?.where&&await MC(t,e.fieldsIndex,i.where))}async function LC(t,e,i){e&&i&&await Promise.all(i.map((i=>NC(t,e,i))))}async function NC(t,e,i){e&&i&&(i.valueExpression?await _C(t,e.fieldsIndex,i.valueExpression):i.field&&bC(t,e.fieldsIndex,i.field))}function RC(t){return t?vC(t.fieldsIndex,UC(t)):[]}function PC(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?vC(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}const FC=new Set(["oid","global-id","guid"]),DC=new Set(["oid","global-id"]),$C=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function zC(t){const e=new Set;VC(t).forEach((t=>e.add(t))),PC(t).forEach((t=>e.add(t.toLowerCase())));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach((t=>e.add(t.toLowerCase()))),Object.values(i.transformFieldRoles).forEach((t=>e.add(t.toLowerCase())))),Array.from(e)}function UC(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:n,editDateField:s,editorField:r}=e;return[i,n,s,r].filter(Boolean)}function VC(t){return UC(t).map((t=>t.toLowerCase()))}function GC(t,e){return t.editable&&!FC.has(t.type)&&!VC(e).includes(t.name?.toLowerCase()??"")}function BC(t,e){const i=t.name?.toLowerCase()??"";return!(null!=e?.objectIdField&&i===e.objectIdField.toLowerCase()||null!=e?.globalIdField&&i===e.globalIdField.toLowerCase()||zC(e).includes(i)||DC.has(t.type)||$C.some((t=>t.test(i))))}async function qC(t,e){const{labelingInfo:i,fieldsIndex:n}=e;i?.length&&await Promise.all(i.map((e=>HC(t,n,e))))}async function HC(t,e,i){if(!i)return;const n=i.getLabelExpression(),s=i.where;if("arcade"===n.type)await _C(t,e,n.expression);else{const i=n.expression.match(/{[^}]*}/g);i&&i.forEach((i=>{bC(t,e,i.slice(1,-1))}))}await MC(t,e,s)}function WC(t){const e=t.defaultValue;return void 0!==e&&eE(t,e)?e:t.nullable?null:void 0}function ZC(t){const e="string"==typeof t?{type:t}:t;return cE(e)?255:"esriFieldTypeDate"===e.type||"date"===e.type?8:void 0}function JC(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function KC(t){return null===t||JC(t)}function YC(t){return null===t||Number.isInteger(t)}function QC(t){return null!=t&&"string"==typeof t}function XC(t){return null===t||QC(t)}function tE(){return!0}function eE(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=t.nullable?YC:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?KC:JC;break;case"string":case"esriFieldTypeString":i=t.nullable?XC:QC;break;default:i=tE}return 1===arguments.length?i:i(e)}const iE=["integer","small-integer","big-integer"],nE=["single","double"],sE=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],rE=["esriFieldTypeSingle","esriFieldTypeDouble"],oE=new Set([...iE,...sE]),aE=new Set([...nE,...rE]),lE=xn(oE,aE);function uE(t){return null!=t&&lE.has(t.type)}function cE(t){return null!=t&&("string"===t.type||"esriFieldTypeString"===t.type)}function hE(t){return null!=t&&("date"===t.type||"esriFieldTypeDate"===t.type)}function dE(t){return null!=t&&("date-only"===t.type||"esriFieldTypeDateOnly"===t.type)}function fE(t){return null!=t&&("timestamp-offset"===t.type||"esriFieldTypeTimestampOffset"===t.type)}function pE(t){return null!=t&&("time-only"===t.type||"esriFieldTypeTimeOnly"===t.type)}function mE(t){return null!=t&&("oid"===t.type||"esriFieldTypeOID"===t.type)}function yE(t){return null!=t&&("global-id"===t.type||"esriFieldTypeGlobalID"===t.type)}function gE(t,e){return null===SE(t,e)}var vE,wE;function bE(t){return null==t||"number"==typeof t&&isNaN(t)?null:t}function SE(t,e){return null==t||t.nullable&&null===e?null:uE(t)&&!xE(t.type,Number(e))?vE.OUT_OF_RANGE:eE(t,e)?t.domain?tC(t,e):null:wE.INVALID_TYPE}function xE(t,e){const i="string"==typeof t?ME(t):t;if(!i)return!1;const n=i.min,s=i.max;return i.isInteger?Number.isInteger(e)&&e>=n&&e<=s:e>=n&&e<=s}function _E(t,e){const i=eC(t,e);return i||(uE(t)?ME(t.type):void 0)}function ME(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return kE;case"esriFieldTypeInteger":case"integer":return TE;case"esriFieldTypeBigInteger":case"big-integer":return AE;case"esriFieldTypeSingle":case"single":return IE;case"esriFieldTypeDouble":case"double":return jE}}!function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"}(vE||(vE={})),function(t){t.INVALID_TYPE="type-validation-error::invalid-type"}(wE||(wE={}));const kE={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},TE={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},AE={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},IE={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},jE={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function CE(t,e,i){switch(t){case Zj.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case Zj.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case wE.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case vE.OUT_OF_RANGE:{const{min:t,max:n}=ME(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${t} to ${n}`}}}function EE(t,e){return!OE(t,e,null)}function OE(t,e,i){if(!e?.attributes||!t){if(null!=i)for(const e of t??[])i.add(e);return!0}const n=new Set(Object.keys(e.attributes));let s=!1;for(const e of t)if(!n.has(e)){if(s=!0,null==i)break;i.add(e)}return s}function LE(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some((e=>t.toLowerCase().startsWith(e)))}let NE=class extends el{constructor(t){super(t),this.type=null}};o([Us({type:["attachments","custom","fields","media","text","expression","relationship"],readOnly:!0,json:{read:!1,write:!0}})],NE.prototype,"type",void 0),NE=o([Nr("esri.popup.content.Content")],NE);const RE=NE;var PE;let FE=PE=class extends RE{constructor(t){super(t),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new PE({description:this.description,displayType:this.displayType,title:this.title})}};o([Us({type:String,json:{write:!0}})],FE.prototype,"description",void 0),o([Us({type:["auto","preview","list"],json:{write:!0}})],FE.prototype,"displayType",void 0),o([Us({type:String,json:{write:!0}})],FE.prototype,"title",void 0),o([Us({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],FE.prototype,"type",void 0),FE=PE=o([Nr("esri.popup.content.AttachmentsContent")],FE);const DE=FE;var $E;let zE=$E=class extends RE{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new $E({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?ht(this.outFields):null})}};o([Us()],zE.prototype,"creator",void 0),o([Us()],zE.prototype,"destroyer",void 0),o([Us()],zE.prototype,"outFields",void 0),o([Us({type:["custom"],readOnly:!0})],zE.prototype,"type",void 0),zE=$E=o([Nr("esri.popup.content.CustomContent")],zE);const UE=zE;var VE;let GE=VE=class extends el{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new VE({title:this.title,expression:this.expression})}};o([Us({type:String,json:{write:!0}})],GE.prototype,"title",void 0),o([Us({type:String,json:{write:!0}})],GE.prototype,"expression",void 0),o([Us({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],GE.prototype,"returnType",void 0),GE=VE=o([Nr("esri.popup.ElementExpressionInfo")],GE);const BE=GE;var qE;let HE=qE=class extends RE{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new qE({expressionInfo:this.expressionInfo?.clone()})}};o([Us({type:BE,json:{write:!0}})],HE.prototype,"expressionInfo",void 0),o([Us({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],HE.prototype,"type",void 0),HE=qE=o([Nr("esri.popup.content.ExpressionContent")],HE);const WE=HE;let ZE=class extends(Gr(el)){constructor(t){super(t),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};o([ST(zg)],ZE.prototype,"dateFormat",void 0),o([Us({type:Boolean,json:{write:!0}})],ZE.prototype,"digitSeparator",void 0),o([Us({type:Ns,json:{write:!0}})],ZE.prototype,"places",void 0),ZE=o([Nr("esri.popup.support.FieldInfoFormat")],ZE);const JE=ZE;var KE;let YE=KE=class extends el{constructor(t){super(t),this.fieldName=null,this.format=null,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new KE({fieldName:this.fieldName,format:this.format?ht(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};o([Us({type:String,json:{write:!0}})],YE.prototype,"fieldName",void 0),o([Us({type:JE,json:{write:!0}})],YE.prototype,"format",void 0),o([Us({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],YE.prototype,"isEditable",void 0),o([Us({type:String,json:{write:!0}})],YE.prototype,"label",void 0),o([ST(new ul({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],YE.prototype,"stringFieldOption",void 0),o([Us({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],YE.prototype,"statisticType",void 0),o([Us({type:String,json:{write:!0}})],YE.prototype,"tooltip",void 0),o([Us({type:Boolean,json:{write:!0}})],YE.prototype,"visible",void 0),YE=KE=o([Nr("esri.popup.FieldInfo")],YE);const QE=YE;var XE;let tO=XE=class extends RE{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map((t=>t.toJSON()))}clone(){return new XE(ht({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};o([Us({type:Object,json:{write:!0}})],tO.prototype,"attributes",void 0),o([Us({type:String,json:{write:!0}})],tO.prototype,"description",void 0),o([Us({type:[QE]})],tO.prototype,"fieldInfos",void 0),o([ll("fieldInfos")],tO.prototype,"writeFieldInfos",null),o([Us({type:String,json:{write:!0}})],tO.prototype,"title",void 0),o([Us({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],tO.prototype,"type",void 0),tO=XE=o([Nr("esri.popup.content.FieldsContent")],tO);const eO=tO;let iO=class extends el{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};o([Us({type:String,json:{write:!0}})],iO.prototype,"altText",void 0),o([Us({type:String,json:{write:!0}})],iO.prototype,"caption",void 0),o([Us({type:String,json:{write:!0}})],iO.prototype,"title",void 0),o([Us({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],iO.prototype,"type",void 0),iO=o([Nr("esri.popup.content.mixins.MediaInfo")],iO);const nO=iO;var sO;let rO=sO=class extends Vr{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new sO({fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};o([Us()],rO.prototype,"color",void 0),o([Us()],rO.prototype,"fieldName",void 0),o([Us()],rO.prototype,"tooltip",void 0),o([Us()],rO.prototype,"value",void 0),rO=sO=o([Nr("esri.popup.content.support.ChartMediaInfoValueSeries")],rO);const oO=rO;var aO;let lO=aO=class extends el{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new aO({colors:ht(this.colors),fields:ht(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};o([Us({type:[wT],json:{type:[[Ns]],write:!0}})],lO.prototype,"colors",void 0),o([Us({type:[String],json:{write:!0}})],lO.prototype,"fields",void 0),o([Us({type:String,json:{write:!0}})],lO.prototype,"normalizeField",void 0),o([Us({type:[oO],json:{read:!1}})],lO.prototype,"series",void 0),o([Us({type:String,json:{write:!0}})],lO.prototype,"tooltipField",void 0),lO=aO=o([Nr("esri.popup.content.support.ChartMediaInfoValue")],lO);const uO=lO;let cO=class extends nO{constructor(t){super(t),this.type=null,this.value=null}};o([Us({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],cO.prototype,"type",void 0),o([Us({type:uO,json:{write:!0}})],cO.prototype,"value",void 0),cO=o([Nr("esri.popup.content.mixins.ChartMediaInfo")],cO);const hO=cO;const dO=cl()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var fO;let pO=fO=class extends hO{constructor(t){super(t),this.type="bar-chart"}clone(){return new fO({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};o([Us({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:dO.write}})],pO.prototype,"type",void 0),pO=fO=o([Nr("esri.popup.content.BarChartMediaInfo")],pO);const mO=pO;var yO;let gO=yO=class extends hO{constructor(t){super(t),this.type="column-chart"}clone(){return new yO({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};o([Us({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:dO.write}})],gO.prototype,"type",void 0),gO=yO=o([Nr("esri.popup.content.ColumnChartMediaInfo")],gO);const vO=gO;var wO;let bO=wO=class extends el{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new wO({linkURL:this.linkURL,sourceURL:this.sourceURL})}};o([Us({type:String,json:{write:!0}})],bO.prototype,"linkURL",void 0),o([Us({type:String,json:{write:!0}})],bO.prototype,"sourceURL",void 0),bO=wO=o([Nr("esri.popup.content.support.ImageMediaInfoValue")],bO);const SO=bO;var xO;let _O=xO=class extends nO{constructor(t){super(t),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new xO({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};o([Us({type:Number,json:{write:!0}})],_O.prototype,"refreshInterval",void 0),o([Us({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],_O.prototype,"type",void 0),o([Us({type:SO,json:{write:!0}})],_O.prototype,"value",void 0),_O=xO=o([Nr("esri.popup.content.ImageMediaInfo")],_O);const MO=_O;var kO;let TO=kO=class extends hO{constructor(t){super(t),this.type="line-chart"}clone(){return new kO({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};o([Us({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:dO.write}})],TO.prototype,"type",void 0),TO=kO=o([Nr("esri.popup.content.LineChartMediaInfo")],TO);const AO=TO;var IO;let jO=IO=class extends hO{constructor(t){super(t),this.type="pie-chart"}clone(){return new IO({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};o([Us({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:dO.write}})],jO.prototype,"type",void 0),jO=IO=o([Nr("esri.popup.content.PieChartMediaInfo")],jO);const CO=jO;const EO={base:nO,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":mO,"column-chart":vO,"line-chart":AO,"pie-chart":CO,image:MO}};var OO;let LO=OO=class extends RE{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map((t=>"image"===t.type?MO.fromJSON(t):"barchart"===t.type?mO.fromJSON(t):"columnchart"===t.type?vO.fromJSON(t):"linechart"===t.type?AO.fromJSON(t):"piechart"===t.type?CO.fromJSON(t):void 0)).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map((t=>t.toJSON()))}clone(){return new OO(ht({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};o([Us()],LO.prototype,"activeMediaInfoIndex",void 0),o([Us({type:Object,json:{write:!0}})],LO.prototype,"attributes",void 0),o([Us({type:String,json:{write:!0}})],LO.prototype,"description",void 0),o([Us({types:[EO]})],LO.prototype,"mediaInfos",void 0),o([al("mediaInfos")],LO.prototype,"readMediaInfos",null),o([ll("mediaInfos")],LO.prototype,"writeMediaInfos",null),o([Us({type:String,json:{write:!0}})],LO.prototype,"title",void 0),o([Us({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],LO.prototype,"type",void 0),LO=OO=o([Nr("esri.popup.content.MediaContent")],LO);const NO=LO;var RO;let PO=RO=class extends el{constructor(t){super(t),this.field=null,this.order=null}clone(){return new RO({field:this.field,order:this.order})}};o([Us({type:String,json:{write:!0}})],PO.prototype,"field",void 0),o([Us({type:["asc","desc"],json:{write:!0}})],PO.prototype,"order",void 0),PO=RO=o([Nr("esri.popup.support.RelatedRecordsInfoFieldOrder")],PO);const FO=PO;let DO=class extends(Gr(RE)){constructor(t){super(t),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};o([Us({type:String,json:{write:!0}})],DO.prototype,"description",void 0),o([Us({type:Number,json:{type:Ns,write:!0}})],DO.prototype,"displayCount",void 0),o([Us({type:["list"],json:{write:!0}})],DO.prototype,"displayType",void 0),o([Us({type:[FO],json:{write:!0}})],DO.prototype,"orderByFields",void 0),o([Us({type:Number,json:{type:Ns,write:!0}})],DO.prototype,"relationshipId",void 0),o([Us({type:String,json:{write:!0}})],DO.prototype,"title",void 0),o([Us({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],DO.prototype,"type",void 0),DO=o([Nr("esri.popup.content.RelationshipContent")],DO);const $O=DO;var zO;let UO=zO=class extends RE{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new zO({text:this.text})}};o([Us({type:String,json:{write:!0}})],UO.prototype,"text",void 0),o([Us({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],UO.prototype,"type",void 0),UO=zO=o([Nr("esri.popup.content.TextContent")],UO);const VO=UO;const GO={base:null,key:"type",typeMap:{attachment:DE,media:NO,text:VO,expression:WE,field:eO,relationship:$O}};var BO;let qO=BO=class extends el{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new BO({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};o([Us({type:String,json:{write:!0}})],qO.prototype,"name",void 0),o([Us({type:String,json:{write:!0}})],qO.prototype,"title",void 0),o([Us({type:String,json:{write:!0}})],qO.prototype,"expression",void 0),o([Us({type:["string","number"],json:{write:!0}})],qO.prototype,"returnType",void 0),qO=BO=o([Nr("esri.popup.ExpressionInfo")],qO);const HO=qO;var WO;let ZO=WO=class extends el{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new WO({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};o([Us({type:Boolean,json:{write:!0}})],ZO.prototype,"returnTopmostRaster",void 0),o([Us({type:Boolean,json:{write:!0}})],ZO.prototype,"showNoDataRecords",void 0),ZO=WO=o([Nr("esri.popup.LayerOptions")],ZO);const JO=ZO;var KO;let YO=KO=class extends el{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new KO({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?ht(this.orderByFields):null})}};o([Us({type:Boolean,json:{write:!0}})],YO.prototype,"showRelatedRecords",void 0),o([Us({type:[FO],json:{write:!0}})],YO.prototype,"orderByFields",void 0),YO=KO=o([Nr("esri.popup.RelatedRecordsInfo")],YO);const QO=YO;var XO;let tL=XO=class extends(PI(Vr)){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new XO({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};o([Us()],tL.prototype,"active",void 0),o([Us()],tL.prototype,"className",void 0),o([Us()],tL.prototype,"disabled",void 0),o([Us()],tL.prototype,"icon",void 0),o([Us()],tL.prototype,"id",void 0),o([Us()],tL.prototype,"indicator",void 0),o([Us()],tL.prototype,"title",void 0),o([Us()],tL.prototype,"type",void 0),o([Us()],tL.prototype,"visible",void 0),tL=XO=o([Nr("esri.support.actions.ActionBase")],tL);const eL=tL;var iL;let nL=iL=class extends eL{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new iL({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};o([Us()],nL.prototype,"image",void 0),nL=iL=o([Nr("esri.support.Action.ActionButton")],nL);const sL=nL;var rL;let oL=rL=class extends eL{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new rL({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};o([Us()],oL.prototype,"image",void 0),o([Us()],oL.prototype,"value",void 0),oL=rL=o([Nr("esri.support.Action.ActionToggle")],oL);const aL=oL;const lL="relationships/",uL="expression/",cL=ty.ofType({key:"type",defaultKeyValue:"button",base:eL,typeMap:{button:sL,toggle:aL}}),hL={base:RE,key:"type",typeMap:{media:NO,custom:UE,text:VO,attachments:DE,fields:eO,expression:WE,relationship:$O}},dL=new Set(["attachments","fields","media","text","expression","relationship"]);let fL=class extends(Gr(el)){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(t){return Array.isArray(t)?t.map((t=>Ls(hL,t))):"string"==typeof t||"function"==typeof t||t instanceof HTMLElement||Gi(t)?t:(Ft.getLogger(this).error("content error","unsupported content value",{value:t}),null)}readContent(t,e){const{popupElements:i}=e;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(e.description,e.mediaInfos,i):this._readPopupInfo(e)}writeContent(t,e,i,n){"string"!=typeof t?Array.isArray(t)&&(e.popupElements=t.filter((t=>dL.has(t.type))).map((t=>t?.toJSON(n))),e.popupElements.forEach((t=>{"attachments"===t.type?this._writeAttachmentContent(e):"media"===t.type?this._writeMediaContent(t,e):"text"===t.type?this._writeTextContent(t,e):"relationship"===t.type&&this._writeRelationshipContent(t,e)}))):e.description=t}writeFieldInfos(t,e,i,n){const{content:s}=this,r=Array.isArray(s)?s:null;if(t){const i=r?r.filter((t=>"fields"===t.type)):[],s=i.length&&i.every((t=>t.fieldInfos?.length));e.fieldInfos=t.filter(Boolean).map((t=>{const e=t.toJSON(n);return s&&(e.visible=!1),e}))}if(r)for(const t of r)"fields"===t.type&&this._writeFieldsContent(t,e)}writeLayerOptions(t,e,i,n){e[i]=!t||null===t.showNoDataRecords&&null===t.returnTopmostRaster?null:t.toJSON(n)}writeTitle(t,e){e.title=t||""}async collectRequiredFields(t,e){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(t,e,[...i,...this._getContentExpressionInfos(this.content,i)]),wC(t,e,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t){const e=new Set;return await this.collectRequiredFields(e,t),[...e].sort()}_writeFieldsContent(t,e){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const i=ht(t.fieldInfos);Array.isArray(e.fieldInfos)?i.forEach((t=>{const i=e.fieldInfos.find((e=>e.fieldName.toLowerCase()===t.fieldName.toLowerCase()));i?i.visible=!0:e.fieldInfos.push(t)})):e.fieldInfos=i}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeRelationshipContent(t,e){const i=t.orderByFields?.map((e=>this._toFieldOrderJSON(e,t.relationshipId)))||[],n=[...e.relatedRecordsInfo?.orderByFields||[],...i];e.relatedRecordsInfo={showRelatedRecords:!0,...n?.length&&{orderByFields:n}}}_writeTextContent(t,e){!e.description&&t.text&&(e.description=t.text)}_writeMediaContent(t,e){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const i=ht(t.mediaInfos);Array.isArray(e.mediaInfos)?e.mediaInfos=[...e.mediaInfos,...i]:e.mediaInfos=i}_readPopupInfoElements(t,e,i){const n={description:!1,mediaInfos:!1};return i.map((i=>"media"===i.type?(i.mediaInfos||!e||n.mediaInfos||(i.mediaInfos=e,n.mediaInfos=!0),NO.fromJSON(i)):"text"===i.type?(i.text||!t||n.description||(i.text=t,n.description=!0),VO.fromJSON(i)):"attachments"===i.type?DE.fromJSON(i):"fields"===i.type?eO.fromJSON(i):"expression"===i.type?WE.fromJSON(i):"relationship"===i.type?$O.fromJSON(i):void 0)).filter(Boolean)}_toRelationshipContent(t){const{field:e,order:i}=t;if(!e?.startsWith(lL))return null;const n=e.replace(lL,"").split("/");if(2!==n.length)return null;const s=parseInt(n[0],10),r=n[1];return"number"==typeof s&&r?$O.fromJSON({relationshipId:s,orderByFields:[{field:r,order:i}]}):null}_toFieldOrderJSON(t,e){const{order:i,field:n}=t;return{field:`${lL}${e}/${n}`,order:i}}_readPopupInfo({description:t,mediaInfos:e,showAttachments:i,relatedRecordsInfo:n={showRelatedRecords:!1}}){const s=[];t?s.push(new VO({text:t})):s.push(new eO),Array.isArray(e)&&e.length&&s.push(NO.fromJSON({mediaInfos:e})),i&&s.push(DE.fromJSON({displayType:"auto"}));const{showRelatedRecords:r,orderByFields:o}=n;return r&&o?.length&&o.forEach((t=>{const e=this._toRelationshipContent(t);e&&s.push(e)})),s.length?s:t}_getContentElementFields(t){const e=t?.type;if("attachments"===e)return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)];if("custom"===e)return t.outFields||[];if("fields"===e)return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...this._getFieldInfoFields(t.fieldInfos??this.fieldInfos)];if("media"===e){const e=t.mediaInfos||[];return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...e.reduce(((t,e)=>[...t,...this._getMediaInfoFields(e)]),[])]}return"text"===e?this._extractFieldNames(t.text):[]}_getMediaInfoFields(t){const{caption:e,title:i,value:n}=t,s=n||{},{fields:r,normalizeField:o,tooltipField:a,sourceURL:l,linkURL:u}=s,c=[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(l),...this._extractFieldNames(u),...r??[]];return o&&c.push(o),a&&c.push(a),c}_getContentExpressionInfos(t,e){return Array.isArray(t)?t.reduce(((t,e)=>[...t,..."expression"===e.type&&e.expressionInfo?[e.expressionInfo]:[]]),e):[]}_getContentFields(t){return"string"==typeof t?this._extractFieldNames(t):Array.isArray(t)?t.reduce(((t,e)=>[...t,...this._getContentElementFields(e)]),[]):[]}async _collectExpressionInfoFields(t,e,i){i&&await Promise.all(i.map((i=>_C(t,e,i.expression))))}_getFieldInfoFields(t){return t?t.filter((t=>void 0===t.visible||!!t.visible)).map((t=>t.fieldName)).filter((t=>!t.startsWith(lL)&&!t.startsWith(uL))):[]}_getActionsFields(t){return t?t.toArray().reduce(((t,e)=>[...t,...this._getActionFields(e)]),[]):[]}_getActionFields(t){const{className:e,title:i,type:n}=t,s="button"===n||"toggle"===n?t.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(s)]}_getTitleFields(t){return"string"==typeof t?this._extractFieldNames(t):[]}_extractFieldNames(t){if(!t||"string"!=typeof t)return[];const e=/{[^}]*}/g,i=t.match(e);if(!i)return[];const n=/\{(\w+):.+\}/,s=i.filter((t=>!(0===t.indexOf(`{${lL}`)||0===t.indexOf(`{${uL}`)))).map((t=>t.replace(n,"{$1}")));return s?s.map((t=>t.slice(1,-1))):[]}};o([Us({type:cL})],fL.prototype,"actions",void 0),o([Us()],fL.prototype,"content",void 0),o([ol("content")],fL.prototype,"castContent",null),o([al("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],fL.prototype,"readContent",null),o([ll("content",{popupElements:{type:ty.ofType(GO)},showAttachments:{type:Boolean},mediaInfos:{type:ty.ofType(EO)},description:{type:String},relatedRecordsInfo:{type:QO}})],fL.prototype,"writeContent",null),o([Us({type:[HO],json:{write:!0}})],fL.prototype,"expressionInfos",void 0),o([Us({type:[QE]})],fL.prototype,"fieldInfos",void 0),o([ll("fieldInfos")],fL.prototype,"writeFieldInfos",null),o([Us({type:JO})],fL.prototype,"layerOptions",void 0),o([ll("layerOptions")],fL.prototype,"writeLayerOptions",null),o([Us({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],fL.prototype,"lastEditInfoEnabled",void 0),o([Us()],fL.prototype,"outFields",void 0),o([Us()],fL.prototype,"overwriteActions",void 0),o([Us()],fL.prototype,"returnGeometry",void 0),o([Us({json:{type:String}})],fL.prototype,"title",void 0),o([ll("title")],fL.prototype,"writeTitle",null),fL=o([Nr("esri.PopupTemplate")],fL);const pL=fL;const mL=new ul({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let yL=0,gL=class extends el{constructor(t){super(t),this.id="sym"+yL++,this.type=null,this.color=new wT([0,0,0,1])}readColor(t){return null!=t?.[0]?[t[0],t[1],t[2],t[3]/255]:t}async collectRequiredFields(t,e){}hash(){return JSON.stringify(this.toJSON())}clone(){}};o([Us({type:mL.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:mL.write}}})],gL.prototype,"type",void 0),o([Us({type:wT,json:{write:{allowNull:!0}}})],gL.prototype,"color",void 0),o([al("color")],gL.prototype,"readColor",null),gL=o([Nr("esri.symbols.Symbol")],gL);const vL=gL;var wL;let bL=wL=class extends vL{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if("CIMSymbolReference"===this.data?.type){const i=this.data.primitiveOverrides;if(i){const n=i.map((i=>{const n=i.valueExpressionInfo;return n?_C(t,e,n.expression):null}));await Promise.all(n)}}}clone(){return new wL({data:ht(this.data)})}hash(){return Lt(JSON.stringify(this.data)).toString()}};o([Us({json:{write:!1}})],bL.prototype,"color",void 0),o([Us({json:{write:!0}})],bL.prototype,"data",void 0),o([al("data",["symbol"])],bL.prototype,"readData",null),o([ll("data",{})],bL.prototype,"writeData",null),o([ST({CIMSymbolReference:"cim"},{readOnly:!0})],bL.prototype,"type",void 0),bL=wL=o([Nr("esri.symbols.CIMSymbol")],bL);const SL=bL;let xL=class extends el{constructor(t){super(t),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(t,e,i){t||(e[i]=t)}};o([Us({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],xL.prototype,"enabled",void 0),o([ll("enabled")],xL.prototype,"writeEnabled",null),o([Us({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],xL.prototype,"type",void 0),xL=o([Nr("esri.symbols.Symbol3DLayer")],xL);const _L=xL;function ML(t,e){const i=null!=e.transparency?kT(e.transparency):1,n=e.color;return n&&Array.isArray(n)?new wT([n[0]||0,n[1]||0,n[2]||0,i]):null}function kL(t,e){e.color=t.toJSON().slice(0,3);const i=MT(t.a);0!==i&&(e.transparency=i)}const TL={type:wT,json:{type:[Ns],default:null,read:{source:["color","transparency"],reader:ML},write:{target:{color:{type:[Ns]},transparency:{type:Ns}},writer:kL}}},AL={type:Number,cast:FT,json:{write:!0}};let IL=class extends el{constructor(t){super(t),this.color=new wT([0,0,0,1]),this.extensionLength=0,this.size=PT(1)}clone(){}cloneProperties(){return{color:ht(this.color),size:this.size,extensionLength:this.extensionLength}}};o([Us({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],IL.prototype,"type",void 0),o([Us(TL)],IL.prototype,"color",void 0),o([Us({...AL,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],IL.prototype,"extensionLength",void 0),o([Us(AL)],IL.prototype,"size",void 0),IL=o([Nr("esri.symbols.edges.Edges3D")],IL);const jL=IL;var CL;let EL=CL=class extends jL{constructor(t){super(t),this.type="sketch"}clone(){return new CL(this.cloneProperties())}};o([ST({sketch:"sketch"},{readOnly:!0})],EL.prototype,"type",void 0),EL=CL=o([Nr("esri.symbols.edges.SketchEdges3D")],EL);const OL=EL;var LL;let NL=LL=class extends jL{constructor(t){super(t),this.type="solid"}clone(){return new LL(this.cloneProperties())}};o([ST({solid:"solid"},{readOnly:!0})],NL.prototype,"type",void 0),NL=LL=o([Nr("esri.symbols.support.SolidEdges3D")],NL);const RL=NL;const PL={types:{key:"type",base:jL,typeMap:{solid:RL,sketch:OL}},json:{write:!0}};var FL;let DL=FL=class extends el{constructor(t){super(t),this.color=null}clone(){const t={color:null!=this.color?this.color.clone():null};return new FL(t)}};o([Us(TL)],DL.prototype,"color",void 0),DL=FL=o([Nr("esri.symbols.support.Symbol3DMaterial")],DL);var $L;let zL=$L=class extends _L{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new $L({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:null!=this.material?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};o([ST({Extrude:"extrude"},{readOnly:!0})],zL.prototype,"type",void 0),o([Us({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],zL.prototype,"size",void 0),o([Us({type:DL,json:{write:!0}})],zL.prototype,"material",void 0),o([Us({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],zL.prototype,"castShadows",void 0),o([Us(PL)],zL.prototype,"edges",void 0),zL=$L=o([Nr("esri.symbols.ExtrudeSymbol3DLayer")],zL);const UL=zL;let VL=class extends vL{constructor(t){super(t),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};o([ST({esriSLS:"simple-line"},{readOnly:!0})],VL.prototype,"type",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],VL.prototype,"width",void 0),VL=o([Nr("esri.symbols.LineSymbol")],VL);const GL=VL;const BL=["begin","end","begin-end"],qL=["arrow","circle","square","diamond","cross","x"];var HL;let WL=HL=class extends el{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,n){e[i]="web-map"===n?.origin?"arrow":t}set color(t){this._set("color",t)}readColor(t){return null!=t?.[0]?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,n){"web-map"===n?.origin||(e[i]=t)}clone(){return new HL({color:ht(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};o([Us({type:["begin","end","begin-end"],json:{write:!0}})],WL.prototype,"placement",void 0),o([ST({"line-marker":"line-marker"},{readOnly:!0}),Us({json:{origins:{"web-map":{write:!1}}}})],WL.prototype,"type",void 0),o([Us({type:qL})],WL.prototype,"style",void 0),o([ll("style")],WL.prototype,"writeStyle",null),o([Us({type:wT,value:null,json:{write:{allowNull:!0}}})],WL.prototype,"color",null),o([al("color")],WL.prototype,"readColor",null),o([ll("color")],WL.prototype,"writeColor",null),WL=HL=o([Nr("esri.symbols.LineSymbolMarker")],WL);const ZL=WL;var JL;const KL=new ul({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let YL=JL=class extends GL{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,n,s,r){if(t&&"string"!=typeof t)return t;const o={};return null!=t&&(o.style=t),null!=e&&(o.color=e),null!=i&&(o.width=FT(i)),null!=n&&(o.cap=n),null!=s&&(o.join=s),null!=r&&(o.miterLimit=FT(r)),o}clone(){return new JL({color:ht(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};o([ST({esriSLS:"simple-line"},{readOnly:!0})],YL.prototype,"type",void 0),o([Us({type:KL.apiValues,json:{read:KL.read,write:KL.write}})],YL.prototype,"style",void 0),o([Us({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&null==i?.origin})}}})],YL.prototype,"cap",void 0),o([Us({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&null==i?.origin})}}})],YL.prototype,"join",void 0),o([Us({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":ZL}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],YL.prototype,"marker",void 0),o([Us({type:Number,json:{read:!1,write:!1}})],YL.prototype,"miterLimit",void 0),YL=JL=o([Nr("esri.symbols.SimpleLineSymbol")],YL);const QL=YL;let XL=class extends vL{constructor(t){super(t),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};o([Us({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":QL}},json:{default:null,write:!0}})],XL.prototype,"outline",void 0),o([Us({type:["simple-fill","picture-fill"],readOnly:!0})],XL.prototype,"type",void 0),XL=o([Nr("esri.symbols.FillSymbol")],XL);const tN=XL;let eN=class extends el{constructor(t){super(t)}clone(){}};o([Us({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],eN.prototype,"type",void 0),eN=o([Nr("esri.symbols.patterns.LinePattern3D")],eN);const iN=eN;const nN=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var sN;const rN=cl()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let oN=sN=class extends iN{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new sN(t)}};o([Us({type:["style"]})],oN.prototype,"type",void 0),o([ST(rN),Us({type:nN})],oN.prototype,"style",void 0),oN=sN=o([Nr("esri.symbols.patterns.LineStylePattern3D")],oN);const aN=oN;let lN=class extends el{constructor(t){super(t)}clone(){}};o([Us({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],lN.prototype,"type",void 0),lN=o([Nr("esri.symbols.patterns.Pattern3D")],lN);const uN=lN;const cN=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var hN;let dN=hN=class extends uN{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new hN(t)}};o([Us({type:["style"]})],dN.prototype,"type",void 0),o([Us({type:cN,json:{read:!0,write:!0}})],dN.prototype,"style",void 0),dN=hN=o([Nr("esri.symbols.patterns.StylePattern3D")],dN);const fN=dN;const pN={types:{key:"type",base:uN,typeMap:{style:fN}},json:{write:!0}},mN={types:{key:"type",base:iN,typeMap:{style:aN}},json:{write:!0}};const yN=new wT("white");new wT("black");const gN=new wT([255,255,255,0]);function vN(t){return 0===t.r&&0===t.g&&0===t.b}var wN;let bN=wN=class extends DL{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:null!=this.color?this.color.clone():null,colorMixMode:this.colorMixMode};return new wN(t)}};o([ST({multiply:"multiply",replace:"replace",tint:"tint"})],bN.prototype,"colorMixMode",void 0),bN=wN=o([Nr("esri.symbols.support.Symbol3DFillMaterial")],bN);function SN(t){return t}function xN(t=UN){return SN([t[0],t[1],t[2],t[3],t[4],t[5]])}function _N(t,e,i,n,s,r,o=xN()){return o[0]=t,o[1]=e,o[2]=i,o[3]=n,o[4]=s,o[5]=r,o}function MN(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new Rf(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function kN(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function TN(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function AN(t,e,i=0,n=e.length/3){let s=t[0],r=t[1],o=t[2],a=t[3],l=t[4],u=t[5];for(let t=0;t<n;t++)s=Math.min(s,e[i+3*t]),r=Math.min(r,e[i+3*t+1]),o=Math.min(o,e[i+3*t+2]),a=Math.max(a,e[i+3*t]),l=Math.max(l,e[i+3*t+1]),u=Math.max(u,e[i+3*t+2]);t[0]=s,t[1]=r,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function IN(t){return t[0]>=t[3]?0:t[3]-t[0]}function jN(t){return t[1]>=t[4]?0:t[4]-t[1]}function CN(t){return t[2]>=t[5]?0:t[5]-t[2]}function EN(t,e=[0,0,0]){return e[0]=IN(t),e[1]=jN(t),e[2]=CN(t),e}function ON(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function LN(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function NN(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function RN(t){return t?NN(t,zN):xN(zN)}function PN(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function FN(t,e,i,n,s){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=n,t[4]=s,t[5]=Number.POSITIVE_INFINITY,t}function DN(t){return 6===t.length}function $N(t,e,i){if(null==t||null==e)return t===e;if(!DN(t)||!DN(e))return!1;if(i){for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const zN=SN([1/0,1/0,1/0,-1/0,-1/0,-1/0]),UN=SN([0,0,0,0,0,0]);const VN=_N(-.5,-.5,-.5,.5,.5,.5),GN=_N(-.5,-.5,0,.5,.5,1),BN=_N(-.5,-.5,0,.5,.5,.5);function qN(t){switch(t){case"sphere":case"cube":case"diamond":return VN;case"cylinder":case"cone":case"inverted-cone":return GN;case"tetrahedron":return BN;default:return}}const HN=["butt","square","round"],WN=[...HN,"none"],ZN=["miter","bevel","round"];var JN;let KN=JN=class extends el{constructor(t){super(t),this.color=new wT([0,0,0,1]),this.size=PT(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:null!=this.color?this.color.clone():null,size:this.size,pattern:null!=this.pattern?this.pattern.clone():null,patternCap:this.patternCap};return new JN(t)}};o([Us(TL)],KN.prototype,"color",void 0),o([Us(AL)],KN.prototype,"size",void 0),o([Us(mN)],KN.prototype,"pattern",void 0),o([Us({type:HN,json:{default:"butt",write:{overridePolicy(){return{enabled:null!=this.pattern}}}}})],KN.prototype,"patternCap",void 0),KN=JN=o([Nr("esri.symbols.support.Symbol3DOutline")],KN);var YN;let QN=YN=class extends _L{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:null!=this.edges?this.edges.clone():null,enabled:this.enabled,material:null!=this.material?this.material.clone():null,pattern:null!=this.pattern?this.pattern.clone():null,castShadows:this.castShadows,outline:null!=this.outline?this.outline.clone():null};return new YN(t)}static fromSimpleFillSymbol(t){const e=t.outline&&t.outline.style&&"inside-frame"!==t.outline.style&&"solid"!==t.outline.style?new aN({style:t.outline.style}):null,i={size:t.outline?.width??0,color:(t.outline?.color??yN).clone(),pattern:e};return e&&t.outline?.cap&&(i.patternCap=t.outline.cap),new YN({material:new bN({color:(t.color??gN).clone()}),pattern:t.style&&"solid"!==t.style?new fN({style:t.style}):null,outline:i})}};o([ST({Fill:"fill"},{readOnly:!0})],QN.prototype,"type",void 0),o([Us({type:bN,json:{write:!0}})],QN.prototype,"material",void 0),o([Us(pN)],QN.prototype,"pattern",void 0),o([Us({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],QN.prototype,"castShadows",void 0),o([Us({type:KN,json:{write:!0}})],QN.prototype,"outline",void 0),o([Us(PL)],QN.prototype,"edges",void 0),QN=YN=o([Nr("esri.symbols.FillSymbol3DLayer")],QN);const XN=QN;const tR=["none","underline","line-through"],eR=["normal","italic","oblique"],iR=["normal","lighter","bold","bolder"],nR={type:Number,cast:t=>{const e=fs(t);return 0===e?1:pa(e,.1,4)},nonNullable:!0},sR=["left","right","center"],rR=["baseline","top","middle","bottom"],oR={type:sR,nonNullable:!0},aR={type:rR,nonNullable:!0},lR=8;var uR;let cR=uR=class extends el{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return FT(t)}clone(){return new uR({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};o([Us({type:tR,json:{default:"none",write:!0}})],cR.prototype,"decoration",void 0),o([Us({type:String,json:{write:!0}})],cR.prototype,"family",void 0),o([Us({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],cR.prototype,"size",void 0),o([ol("size")],cR.prototype,"castSize",null),o([Us({type:eR,json:{default:"normal",write:!0}})],cR.prototype,"style",void 0),o([Us({type:iR,json:{default:"normal",write:!0}})],cR.prototype,"weight",void 0),cR=uR=o([Nr("esri.symbols.Font")],cR);const hR=cR;var dR;const fR=cl()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let pR=dR=class extends el{constructor(t){super(t)}readHref(t,e,i){return t?sk(t,i):e.dataURI}writeHref(t,e,i,n){t&&(hu(t)?e.dataURI=t:(e.href=rk(t,n),uu(e.href)&&(e.href=ou(e.href))))}clone(){return new dR({href:this.href,primitive:this.primitive})}};o([Us({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],pR.prototype,"href",void 0),o([al("href")],pR.prototype,"readHref",null),o([ll("href",{href:{type:String},dataURI:{type:String}})],pR.prototype,"writeHref",null),o([ST(fR)],pR.prototype,"primitive",void 0),pR=dR=o([Nr("esri.symbols.support.IconSymbol3DLayerResource")],pR);const mR="circle";var yR;let gR=yR=class extends Vr{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new yR({x:this.x,y:this.y})}};o([Us({type:Number})],gR.prototype,"x",void 0),o([Us({type:Number})],gR.prototype,"y",void 0),gR=yR=o([Nr("esri.symbols.support.Symbol3DAnchorPosition2D")],gR);var vR;let wR=vR=class extends el{constructor(t){super(t),this.color=new wT([0,0,0,1]),this.size=PT(1)}clone(){const t={color:null!=this.color?this.color.clone():null,size:this.size};return new vR(t)}};o([Us(TL)],wR.prototype,"color",void 0),o([Us(AL)],wR.prototype,"size",void 0),wR=vR=o([Nr("esri.symbols.support.Symbol3DIconOutline")],wR);var bR;const SR="esri.symbols.IconSymbol3DLayer";let xR=bR=class extends _L{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new bR({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:null!=this.material?this.material.clone():null,outline:null!=this.outline?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||yN,i=_R(t),n=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||yN).clone()}:null;return new bR({size:t.size,resource:{primitive:TR(t.style)},material:{color:e},outline:n,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||vN(t.color)?yN:t.color,i=_R(t);return new bR({size:t.width<=t.height?t.height:t.width,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new bR({resource:{href:yu({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};function _R(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,n=MR(t.xoffset),s=MR(t.yoffset);return(n||s)&&e&&i?{x:-n/e,y:s/i}:null}function MR(t){return isFinite(t)?t:0}o([Us({type:DL,json:{write:!0}})],xR.prototype,"material",void 0),o([Us({type:pR,json:{write:!0}})],xR.prototype,"resource",void 0),o([ST({Icon:"icon"},{readOnly:!0})],xR.prototype,"type",void 0),o([Us(AL)],xR.prototype,"size",void 0),o([ST({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),Us({json:{default:"center"}})],xR.prototype,"anchor",void 0),o([Us({type:gR,json:{type:[Number],read:{reader:t=>new gR({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],xR.prototype,"anchorPosition",void 0),o([Us({type:wR,json:{write:!0}})],xR.prototype,"outline",void 0),xR=bR=o([Nr(SR)],xR);const kR={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function TR(t){const e=kR[t];return e||(Ft.getLogger(SR).warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const AR=xR;let IR=class extends(Gr(el)){constructor(t){super(t),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(t){return null!=t&&t.placement===this.placement&&t.style===this.style&&(null==this.color&&null==t.color||null!=this.color&&null!=t.color&&this.color.toJSON()===t.color.toJSON())}};o([Us({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],IR.prototype,"type",void 0),o([Us({type:BL,json:{default:"begin-end",write:!0}})],IR.prototype,"placement",void 0),o([Us({type:qL,json:{default:"arrow",write:!0}})],IR.prototype,"style",void 0),o([Us({type:wT,json:{type:[Ns],default:null,write:!0}})],IR.prototype,"color",void 0),IR=o([Nr("esri.symbols.LineStyleMarker3D")],IR);const jR=IR;var CR;let ER=CR=class extends _L{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=PT(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:null!=this.material?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:null!=this.pattern?this.pattern.clone():null,marker:null!=this.marker?this.marker.clone():null};return new CR(t)}static fromSimpleLineSymbol(t){const e={enabled:!0,size:t.width??PT(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style&&"inside-frame"!==t.style?new aN({style:t.style}):null,material:new DL({color:(t.color||yN).clone()}),marker:t.marker?new jR({placement:t.marker.placement,style:t.marker.style,color:t.marker.color?.clone()??null}):null};return new CR(e)}};o([Us({type:DL,json:{write:!0}})],ER.prototype,"material",void 0),o([ST({Line:"line"},{readOnly:!0})],ER.prototype,"type",void 0),o([Us({type:ZN,json:{write:!0,default:"miter"}})],ER.prototype,"join",void 0),o([Us({type:HN,json:{write:!0,default:"butt"}})],ER.prototype,"cap",void 0),o([Us(AL)],ER.prototype,"size",void 0),o([Us(mN)],ER.prototype,"pattern",void 0),o([Us({types:{key:"type",base:jR,typeMap:{style:jR}},json:{write:!0}})],ER.prototype,"marker",void 0),ER=CR=o([Nr("esri.symbols.LineSymbol3DLayer")],ER);const OR=ER;var LR;const NR=cl()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let RR=LR=class extends el{clone(){return new LR({href:this.href,primitive:this.primitive})}};o([Us({type:String,json:{read:ok,write:ak}})],RR.prototype,"href",void 0),o([ST(NR)],RR.prototype,"primitive",void 0),RR=LR=o([Nr("esri.symbols.support.ObjectSymbol3DLayerResource")],RR);const PR="sphere";var FR;let DR=FR=class extends Vr{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new FR({x:this.x,y:this.y,z:this.z})}};o([Us({type:Number})],DR.prototype,"x",void 0),o([Us({type:Number})],DR.prototype,"y",void 0),o([Us({type:Number})],DR.prototype,"z",void 0),DR=FR=o([Nr("esri.symbols.support.Symbol3DAnchorPosition3D")],DR);var $R;let zR=$R=class extends _L{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new $R({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||"string"!=typeof this.resource.href}};o([Us({type:DL,json:{write:!0}})],zR.prototype,"material",void 0),o([Us({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],zR.prototype,"castShadows",void 0),o([Us({type:RR,json:{write:!0}})],zR.prototype,"resource",void 0),o([ST({Object:"object"},{readOnly:!0})],zR.prototype,"type",void 0),o([Us({type:Number,json:{write:!0}})],zR.prototype,"width",void 0),o([Us({type:Number,json:{write:!0}})],zR.prototype,"height",void 0),o([Us({type:Number,json:{write:!0}})],zR.prototype,"depth",void 0),o([ST({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),Us({json:{default:"origin"}})],zR.prototype,"anchor",void 0),o([Us({type:DR,json:{type:[Number],read:{reader:t=>new DR({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],zR.prototype,"anchorPosition",void 0),o([Us({type:Number,json:{write:!0}})],zR.prototype,"heading",void 0),o([Us({type:Number,json:{write:!0}})],zR.prototype,"tilt",void 0),o([Us({type:Number,json:{write:!0}})],zR.prototype,"roll",void 0),o([Us({readOnly:!0})],zR.prototype,"isPrimitive",null),zR=$R=o([Nr("esri.symbols.ObjectSymbol3DLayer")],zR);const UR=zR;var VR;let GR=VR=class extends _L{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return null!=t?t:null==e.height&&null!=e.size?e.size:void 0}readHeight(t,e){return null!=t?t:null==e.width&&null!=e.size?e.size:void 0}clone(){return new VR({enabled:this.enabled,material:null!=this.material?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};o([Us({type:DL,json:{write:!0}})],GR.prototype,"material",void 0),o([Us({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],GR.prototype,"castShadows",void 0),o([ST({Path:"path"},{readOnly:!0})],GR.prototype,"type",void 0),o([Us({type:["circle","quad"],json:{write:!0,default:"circle"}})],GR.prototype,"profile",void 0),o([Us({type:ZN,json:{write:!0,default:"miter"}})],GR.prototype,"join",void 0),o([Us({type:WN,json:{write:!0,default:"butt"}})],GR.prototype,"cap",void 0),o([Us({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],GR.prototype,"width",void 0),o([al("width",["width","size","height"])],GR.prototype,"readWidth",null),o([Us({type:Number,json:{write:!0}})],GR.prototype,"height",void 0),o([al("height",["height","size","width"])],GR.prototype,"readHeight",null),o([Us({type:["center","bottom","top"],json:{write:!0,default:"center"}})],GR.prototype,"anchor",void 0),o([Us({type:["heading","all"],json:{write:!0,default:"all"}})],GR.prototype,"profileRotation",void 0),GR=VR=o([Nr("esri.symbols.PathSymbol3DLayer")],GR);const BR=GR;var qR;let HR=qR=class extends el{constructor(){super(...arguments),this.color=new wT([0,0,0,1]),this.size=0}clone(){const t={color:ht(this.color),size:this.size};return new qR(t)}};o([Us(TL)],HR.prototype,"color",void 0),o([Us(AL)],HR.prototype,"size",void 0),HR=qR=o([Nr("esri.symbols.support.Symbol3DHalo")],HR);let WR=class extends(Gr(el)){constructor(t){super(t),this.color=null}};o([Us(TL)],WR.prototype,"color",void 0),WR=o([Nr("esri.symbols.support.Symbol3DTextBackground")],WR);var ZR;let JR=ZR=class extends _L{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){null!=t&&null!=this._userSize&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,n){const s={...n,textSymbol3D:!0};e.font=t.write({},s),delete e.font.size}get size(){return null!=this._userSize?this._userSize:null!=this.font?.size?this.font.size:9}set size(t){this._userSize=t,null!=this.font&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new ZR({enabled:this.enabled,font:this.font&&ht(this.font),halo:this.halo&&ht(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:null!=this.material?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:ht(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new ZR({font:null!=t.font?t.font.clone():new hR,halo:KR(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new DL({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new WR({color:t.backgroundColor.clone()}):null})}};function KR(t,e){return t&&null!=e&&e>0?new HR({color:ht(t),size:e}):null}o([Us({type:hR,json:{write:!0}})],JR.prototype,"font",null),o([ll("font")],JR.prototype,"writeFont",null),o([Us({type:HR,json:{write:!0}})],JR.prototype,"halo",void 0),o([Us({...oR,json:{default:"center",write:!0}})],JR.prototype,"horizontalAlignment",void 0),o([Us({...nR,json:{default:1,write:!0}})],JR.prototype,"lineHeight",void 0),o([Us({type:DL,json:{write:!0}})],JR.prototype,"material",void 0),o([Us({type:WR,json:{write:!0}})],JR.prototype,"background",void 0),o([Us(AL)],JR.prototype,"size",null),o([Us({type:String,json:{write:!0}})],JR.prototype,"text",void 0),o([ST({Text:"text"},{readOnly:!0})],JR.prototype,"type",void 0),o([Us({...aR,json:{default:"baseline",write:!0}})],JR.prototype,"verticalAlignment",void 0),JR=ZR=o([Nr("esri.symbols.TextSymbol3DLayer")],JR);const YR=JR;var QR;let XR=QR=class extends _L{constructor(t){super(t),this.color=tP.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new QR({color:ht(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};o([Us({type:wT,nonNullable:!0,json:{type:[Ns],write:(t,e,i)=>e[i]=t.toArray(wT.AlphaMode.UNLESS_OPAQUE),default:()=>tP.clone(),defaultEquals:t=>t.toCss(!0)===tP.toCss(!0)}})],XR.prototype,"color",void 0),o([ST({Water:"water"},{readOnly:!0})],XR.prototype,"type",void 0),o([Us({type:["small","medium","large"],json:{write:!0,default:"medium"}})],XR.prototype,"waterbodySize",void 0),o([Us({type:Number,json:{write:!0,default:null}})],XR.prototype,"waveDirection",void 0),o([Us({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],XR.prototype,"waveStrength",void 0),XR=QR=o([Nr("esri.symbols.WaterSymbol3DLayer")],XR);const tP=new wT([0,119,190]),eP=XR;var iP;let nP=iP=class extends Vr{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new iP({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};o([Us({type:String})],nP.prototype,"name",void 0),o([Us({type:String})],nP.prototype,"styleUrl",void 0),o([Us({type:String})],nP.prototype,"styleName",void 0),o([Us({type:YM})],nP.prototype,"portal",void 0),nP=iP=o([Nr("esri.symbols.support.StyleOrigin")],nP);const sP=nP;var rP;let oP=rP=class extends Vr{constructor(){super(...arguments),this.url=""}clone(){return new rP({url:this.url})}};o([Us({type:String})],oP.prototype,"url",void 0),oP=rP=o([Nr("esri.symbols.support.Thumbnail")],oP);const aP={icon:AR,object:UR,line:OR,path:BR,fill:XN,extrude:UL,text:YR,water:eP},lP=ty.ofType({base:_L,key:"type",typeMap:aP,errorContext:"symbol-layer"});let uP=class extends vL{constructor(t){super(t),this.styleOrigin=null,this.thumbnail=null,this.type=null;const e=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,i=e?.type,n=i||ty;this._set("symbolLayers",new n)}get color(){return null}set color(t){this.constructed&&Ft.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(t){pM(t,this._get("symbolLayers"))}readStyleOrigin(t,e,i){if(t.styleUrl&&t.name){const e=sk(t.styleUrl,i);return new sP({styleUrl:e,name:t.name})}if(t.styleName&&t.name)return new sP({portal:i?.portal||YM.getDefault(),styleName:t.styleName,name:t.name});i?.messages&&i.messages.push(new Hs("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:t}))}writeStyleOrigin(t,e,i,n){if(t.styleUrl&&t.name){let i=rk(t.styleUrl,n);uu(i)&&(i=ou(i)),e.styleOrigin={styleUrl:i,name:t.name}}else t.styleName&&t.name&&(t.portal&&n?.portal&&!Ql(t.portal.restUrl,n.portal.restUrl)?n?.messages&&n.messages.push(new Hs("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):e.styleOrigin={styleName:t.styleName,name:t.name})}normalizeCtorArgs(t){return t instanceof _L||t&&aP[t.type]?{symbolLayers:[t]}:Array.isArray(t)?{symbolLayers:t}:t}};o([Us({json:{read:!1,write:!1}})],uP.prototype,"color",null),o([Us({type:lP,nonNullable:!0,json:{write:!0}}),ol(mM)],uP.prototype,"symbolLayers",null),o([Us({type:sP})],uP.prototype,"styleOrigin",void 0),o([al("styleOrigin")],uP.prototype,"readStyleOrigin",null),o([ll("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],uP.prototype,"writeStyleOrigin",null),o([Us({type:oP,json:{read:!1}})],uP.prototype,"thumbnail",void 0),o([Us({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],uP.prototype,"type",void 0),uP=o([Nr("esri.symbols.Symbol3D")],uP);const cP=uP;let hP=class extends el{constructor(t){super(t),this.visible=!0}clone(){}};o([Us({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],hP.prototype,"type",void 0),o([Us({readOnly:!0})],hP.prototype,"visible",void 0),hP=o([Nr("esri.symbols.callouts.Callout3D")],hP);const dP=hP;var fP;let pP=fP=class extends el{constructor(t){super(t),this.color=new wT("white")}clone(){return new fP({color:ht(this.color)})}};o([Us(TL)],pP.prototype,"color",void 0),pP=fP=o([Nr("esri.symbols.callouts.LineCallout3DBorder")],pP);const mP=pP;var yP;let gP=yP=class extends dP{constructor(t){super(t),this.type="line",this.color=new wT([0,0,0,1]),this.size=PT(1),this.border=null}get visible(){return this.size>0&&null!=this.color&&this.color.a>0}clone(){return new yP({color:ht(this.color),size:this.size,border:ht(this.border)})}};o([ST({line:"line"})],gP.prototype,"type",void 0),o([Us(TL)],gP.prototype,"color",void 0),o([Us(AL)],gP.prototype,"size",void 0),o([Us({type:mP,json:{write:!0}})],gP.prototype,"border",void 0),o([Us({readOnly:!0})],gP.prototype,"visible",null),gP=yP=o([Nr("esri.symbols.callouts.LineCallout3D")],gP);const vP=gP;function wP(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||null!=e.maxWorldLength&&e.maxWorldLength<=0)}function bP(t){if(!t)return!1;if(!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&(!!e.visible&&!!wP(t))}const SP={types:{key:"type",base:dP,typeMap:{line:vP}},json:{write:!0}};var xP;let _P=xP=class extends el{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new xP({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};o([Us(AL)],_P.prototype,"screenLength",void 0),o([Us({type:Number,nonNullable:!0,json:{write:!0,default:0}})],_P.prototype,"minWorldLength",void 0),o([Us({type:Number,json:{write:!0}})],_P.prototype,"maxWorldLength",void 0),_P=xP=o([Nr("esri.symbols.support.Symbol3DVerticalOffset")],_P);const MP=_P;var kP;const TP=ty.ofType({base:null,key:"type",typeMap:{text:YR}});let AP=kP=class extends cP{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new TP,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return bP(this)}hasVisibleVerticalOffset(){return wP(this)}clone(){return new kP({styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail),callout:ht(this.callout),verticalOffset:ht(this.verticalOffset)})}static fromTextSymbol(t){return new kP({symbolLayers:new ty([YR.fromTextSymbol(t)])})}};o([Us({type:MP,json:{write:!0}})],AP.prototype,"verticalOffset",void 0),o([Us(SP)],AP.prototype,"callout",void 0),o([Us({json:{read:!1,write:!1}})],AP.prototype,"styleOrigin",void 0),o([Us({type:TP})],AP.prototype,"symbolLayers",void 0),o([ST({LabelSymbol3D:"label-3d"},{readOnly:!0})],AP.prototype,"type",void 0),AP=kP=o([Nr("esri.symbols.LabelSymbol3D")],AP);const IP=AP;var jP;const CP=ty.ofType({base:null,key:"type",typeMap:{line:OR,path:BR}}),EP=ty.ofType({base:null,key:"type",typeMap:{line:OR,path:BR}});let OP=jP=class extends cP{constructor(t){super(t),this.symbolLayers=new CP,this.type="line-3d"}clone(){return new jP({styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail)})}static fromSimpleLineSymbol(t){return new jP({symbolLayers:new ty([OR.fromSimpleLineSymbol(t)])})}};o([Us({type:CP,json:{type:EP}})],OP.prototype,"symbolLayers",void 0),o([ST({LineSymbol3D:"line-3d"},{readOnly:!0})],OP.prototype,"type",void 0),OP=jP=o([Nr("esri.symbols.LineSymbol3D")],OP);const LP=OP;let NP=class extends vL{constructor(t){super(t),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};o([Us({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],NP.prototype,"angle",void 0),o([Us({type:["simple-marker","picture-marker"],readOnly:!0})],NP.prototype,"type",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],NP.prototype,"xoffset",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],NP.prototype,"yoffset",void 0),o([Us({type:Number,cast:t=>"auto"===t?t:FT(t),json:{write:!0}})],NP.prototype,"size",void 0),NP=o([Nr("esri.symbols.MarkerSymbol")],NP);const RP=NP;var PP;const FP=ty.ofType({base:null,key:"type",typeMap:{fill:XN}});let DP=PP=class extends cP{constructor(t){super(t),this.symbolLayers=new FP,this.type="mesh-3d"}clone(){return new PP({styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail)})}static fromSimpleFillSymbol(t){return new PP({symbolLayers:new ty([XN.fromSimpleFillSymbol(t)])})}};o([Us({type:FP})],DP.prototype,"symbolLayers",void 0),o([ST({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],DP.prototype,"type",void 0),DP=PP=o([Nr("esri.symbols.MeshSymbol3D")],DP);const $P=DP;function zP(t,e,i){return e.imageData?yu({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):UP(e.url,i)}function UP(t,e){if(!uu(t)){const i=qP(e);if(i)return au(i,"images",t)}return sk(t,e)}function VP(t,e,i,n){if(hu(t)){const s=mu(t);if(!s)return;e.contentType=s.mediaType,e.imageData=s.data,i&&i.imageData===e.imageData&&i.url&&ak(i.url,e,"url",n)}else ak(t,e,"url",n)}const GP={json:{read:{source:["imageData","url"],reader:zP},write:{writer(t,e,i,n){VP(t,e,this.source,n)}}}},BP={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const n={};return e.imageData&&(n.imageData=e.imageData),e.contentType&&(n.contentType=e.contentType),e.url&&(n.url=UP(e.url,i)),n}}}};function qP(t){if(!t)return null;const{origin:e,layer:i}=t;if("service"!==e&&"portal-item"!==e)return null;const n=i?.type;return"feature"===n||"stream"===n?i.parsedUrl?.path:"map-image"===n||"tile"===n?t.url?.path:null}var HP;let WP=HP=class extends tN{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,n){if(t&&"string"!=typeof t&&null==t.imageData)return t;const s={};return t&&(s.url=t),e&&(s.outline=e),null!=i&&(s.width=FT(i)),null!=n&&(s.height=FT(n)),s}clone(){const t=new HP({color:ht(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",ht(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};o([ST({esriPFS:"picture-fill"},{readOnly:!0})],WP.prototype,"type",void 0),o([Us(GP)],WP.prototype,"url",void 0),o([Us({type:Number,json:{write:!0}})],WP.prototype,"xscale",void 0),o([Us({type:Number,json:{write:!0}})],WP.prototype,"yscale",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],WP.prototype,"width",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],WP.prototype,"height",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],WP.prototype,"xoffset",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],WP.prototype,"yoffset",void 0),o([Us(BP)],WP.prototype,"source",void 0),WP=HP=o([Nr("esri.symbols.PictureFillSymbol")],WP);const ZP=WP;var JP;let KP=JP=class extends RP{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t&&null==t.imageData)return t;const n={};return t&&(n.url=t),null!=e&&(n.width=FT(e)),null!=i&&(n.height=FT(i)),n}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new JP({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",ht(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};o([Us({json:{write:!1}})],KP.prototype,"color",void 0),o([ST({esriPMS:"picture-marker"},{readOnly:!0})],KP.prototype,"type",void 0),o([Us(GP)],KP.prototype,"url",void 0),o([Us(BP)],KP.prototype,"source",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],KP.prototype,"height",void 0),o([al("height",["height","size"])],KP.prototype,"readHeight",null),o([Us({type:Number,cast:FT,json:{write:!0}})],KP.prototype,"width",void 0),o([Us({json:{write:!1}})],KP.prototype,"size",void 0),KP=JP=o([Nr("esri.symbols.PictureMarkerSymbol")],KP);const YP=KP;var QP;const XP=ty.ofType({base:null,key:"type",typeMap:{icon:AR,object:UR,text:YR}});let tF=QP=class extends cP{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new XP,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return bP(this)}hasVisibleVerticalOffset(){return wP(this)}clone(){return new QP({verticalOffset:ht(this.verticalOffset),callout:ht(this.callout),styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new QP({symbolLayers:new ty([AR.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new QP({symbolLayers:new ty([AR.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){const e=t.data?.symbol?.type;if("CIMPointSymbol"!==e)return null;const i=t.data.symbol;return new QP(i?.callout?{symbolLayers:new ty([AR.fromCIMSymbol(t)]),callout:new vP({size:.5,color:new wT([0,0,0])}),verticalOffset:new MP({screenLength:40})}:{symbolLayers:new ty([AR.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new QP({symbolLayers:new ty([YR.fromTextSymbol(t)])})}};o([Us({type:MP,json:{write:!0}})],tF.prototype,"verticalOffset",void 0),o([Us(SP)],tF.prototype,"callout",void 0),o([Us({type:XP,json:{origins:{"web-scene":{write:!0}}}})],tF.prototype,"symbolLayers",void 0),o([ST({PointSymbol3D:"point-3d"},{readOnly:!0})],tF.prototype,"type",void 0),tF=QP=o([Nr("esri.symbols.PointSymbol3D")],tF);const eF=tF;var iF;const nF=ty.ofType({base:null,key:"type",typeMap:{extrude:UL,fill:XN,icon:AR,line:OR,object:UR,text:YR,water:eP}});let sF=iF=class extends cP{constructor(t){super(t),this.symbolLayers=new nF,this.type="polygon-3d"}initialize(){const t=t=>{"line"===t.type&&m(Ft.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),"text"===t.type&&m(Ft.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(yy((()=>this.symbolLayers),"after-add",(({item:e})=>t(e)),xy))}clone(){return new iF({styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail)})}static fromJSON(t){const e=new iF;if(e.read(t),2===e.symbolLayers.length&&"fill"===e.symbolLayers.at(0).type&&"line"===e.symbolLayers.at(1).type){const i=e.symbolLayers.at(0),n=e.symbolLayers.at(1);!n.enabled||t.symbolLayers?.[1]&&!1===t.symbolLayers[1].enable||(i.outline={size:n.size,color:null!=n.material?n.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new iF({symbolLayers:new ty([XN.fromSimpleFillSymbol(t)])})}};o([Us({type:nF,json:{write:!0}})],sF.prototype,"symbolLayers",void 0),o([ST({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],sF.prototype,"type",void 0),sF=iF=o([Nr("esri.symbols.PolygonSymbol3D")],sF);const rF=sF;var oF;const aF=new ul({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let lF=oF=class extends tN{constructor(...t){super(...t),this.color=new wT([0,0,0,.25]),this.outline=new QL,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const n={};return t&&(n.style=t),e&&(n.outline=e),i&&(n.color=i),n}clone(){return new oF({color:ht(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};o([Us()],lF.prototype,"color",void 0),o([Us()],lF.prototype,"outline",void 0),o([ST({esriSFS:"simple-fill"},{readOnly:!0})],lF.prototype,"type",void 0),o([Us({type:aF.apiValues,json:{read:aF.read,write:aF.write}})],lF.prototype,"style",void 0),lF=oF=o([Nr("esri.symbols.SimpleFillSymbol")],lF);const uF=lF;var cF;const hF=new ul({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let dF=cF=class extends RP{constructor(...t){super(...t),this.color=new wT([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new QL}normalizeCtorArgs(t,e,i,n){if(t&&"string"!=typeof t)return t;const s={};return t&&(s.style=t),null!=e&&(s.size=FT(e)),i&&(s.outline=i),n&&(s.color=n),s}writeColor(t,e){t&&"x"!==this.style&&"cross"!==this.style&&(e.color=t.toJSON()),null===t&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new cF({angle:this.angle,color:ht(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};o([Us()],dF.prototype,"color",void 0),o([ll("color")],dF.prototype,"writeColor",null),o([ST({esriSMS:"simple-marker"},{readOnly:!0})],dF.prototype,"type",void 0),o([Us()],dF.prototype,"size",void 0),o([Us({type:hF.apiValues,json:{read:hF.read,write:hF.write}})],dF.prototype,"style",void 0),o([Us({type:String,json:{write:!0}})],dF.prototype,"path",null),o([Us({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":QL}},json:{default:null,write:!0}})],dF.prototype,"outline",void 0),dF=cF=o([Nr("esri.symbols.SimpleMarkerSymbol")],dF);const fF=dF;var pF;let mF=pF=class extends vL{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new hR,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const n={};return t&&(n.text=t),e&&(n.font=e),i&&(n.color=i),n}writeLineWidth(t,e,i,n){n&&"string"!=typeof n?n.origin:e[i]=t}castLineWidth(t){return FT(t)}writeLineHeight(t,e,i,n){n&&"string"!=typeof n?n.origin:e[i]=t}clone(){return new pF({angle:this.angle,backgroundColor:ht(this.backgroundColor),borderLineColor:ht(this.borderLineColor),borderLineSize:this.borderLineSize,color:ht(this.color),font:this.font&&this.font.clone(),haloColor:ht(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};o([Us({type:wT,json:{write:!0}})],mF.prototype,"backgroundColor",void 0),o([Us({type:wT,json:{write:!0}})],mF.prototype,"borderLineColor",void 0),o([Us({type:Number,json:{write:!0},cast:FT})],mF.prototype,"borderLineSize",void 0),o([Us({type:hR,json:{write:!0}})],mF.prototype,"font",void 0),o([Us({...oR,json:{write:!0}})],mF.prototype,"horizontalAlignment",void 0),o([Us({type:Boolean,json:{write:!0}})],mF.prototype,"kerning",void 0),o([Us({type:wT,json:{write:!0}})],mF.prototype,"haloColor",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],mF.prototype,"haloSize",void 0),o([Us({type:Boolean,json:{write:!0}})],mF.prototype,"rightToLeft",void 0),o([Us({type:Boolean,json:{write:!0}})],mF.prototype,"rotated",void 0),o([Us({type:String,json:{write:!0}})],mF.prototype,"text",void 0),o([ST({esriTS:"text"},{readOnly:!0})],mF.prototype,"type",void 0),o([Us({...aR,json:{write:!0}})],mF.prototype,"verticalAlignment",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],mF.prototype,"xoffset",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],mF.prototype,"yoffset",void 0),o([Us({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],mF.prototype,"angle",void 0),o([Us({type:Number,json:{write:!0}})],mF.prototype,"width",void 0),o([Us({type:Number})],mF.prototype,"lineWidth",void 0),o([ll("lineWidth")],mF.prototype,"writeLineWidth",null),o([ol("lineWidth")],mF.prototype,"castLineWidth",null),o([Us(nR)],mF.prototype,"lineHeight",void 0),o([ll("lineHeight")],mF.prototype,"writeLineHeight",null),mF=pF=o([Nr("esri.symbols.TextSymbol")],mF);const yF=mF;var gF;let vF=gF=class extends vL{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=null!=this.portal?this.portal:YM.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new gF({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=null!=e?e.cache:null,n=i?this._fetchCacheKey:null;if(null!=i){const t=n&&i.get(n);if(t)return t.clone()}const{resolveWebStyleSymbol:s}=await Promise.resolve().then((function(){return Cft}));Ii(e);const r=s(this,{portal:this.portal},t,e);r.catch((t=>{Ft.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",t)}));const o=await r;return"webRef"===t&&"point-3d"===o.type||"cimRef"===t&&"cim"===o.type?(null!=i&&i.set(n,o.clone()),o):null}};o([Us({json:{write:!1}})],vF.prototype,"color",void 0),o([Us({type:String,json:{write:!0}})],vF.prototype,"styleName",void 0),o([Us({type:YM,json:{write:!1}})],vF.prototype,"portal",void 0),o([Us({type:String,json:{read:ok,write:ak}})],vF.prototype,"styleUrl",void 0),o([Us({type:oP,json:{read:!1}})],vF.prototype,"thumbnail",void 0),o([Us({type:String,json:{write:!0}})],vF.prototype,"name",void 0),o([ST({styleSymbolReference:"web-style"},{readOnly:!0})],vF.prototype,"type",void 0),o([Us()],vF.prototype,"_fetchCacheKey",null),vF=gF=o([Nr("esri.symbols.WebStyleSymbol")],vF);const wF=vF;function bF(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function SF(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const xF={base:vL,key:"type",typeMap:{"simple-fill":uF,"picture-fill":ZP,"picture-marker":YP,"simple-line":QL,"simple-marker":fF,text:yF,"label-3d":IP,"line-3d":LP,"mesh-3d":$P,"point-3d":eF,"polygon-3d":rF,"web-style":wF,cim:SL},errorContext:"symbol"},_F={base:vL,key:"type",typeMap:{"picture-marker":YP,"simple-marker":fF,text:yF,"web-style":wF,cim:SL},errorContext:"symbol"},MF=Ks({types:xF}),kF={base:vL,key:"type",typeMap:{"simple-fill":uF,"picture-fill":ZP,"picture-marker":YP,"simple-line":QL,"simple-marker":fF,text:yF,"line-3d":LP,"mesh-3d":$P,"point-3d":eF,"polygon-3d":rF,"web-style":wF,cim:SL},errorContext:"symbol"},TF={base:vL,key:"type",typeMap:{text:yF,"label-3d":IP},errorContext:"symbol"},AF={base:vL,key:"type",typeMap:{"line-3d":LP,"mesh-3d":$P,"point-3d":eF,"polygon-3d":rF,"web-style":wF,cim:SL},errorContext:"symbol"},IF={base:vL,key:"type",typeMap:{"label-3d":IP},errorContext:"symbol"},jF=Ls(xF);var CF;function EF(t){if(!t)return null;const e={};for(const i in t){const n=Tm(t[i]);n&&(e[i]=n)}return 0!==Object.keys(e).length?e:null}function OF(t){if(null==t)return null;const e={};for(const i in t){const n=t[i];n&&(e[i]=n.toJSON())}return 0!==Object.keys(e).length?e:null}let LF=CF=class extends(Gr(el)){constructor(...t){super(...t),this.isAggregate=!1,this.layer=null,this.origin=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:jn(),configurable:!0})}normalizeCtorArgs(t,e,i,n){return t&&!t.declaredClass?t:{geometry:t,symbol:e,attributes:i,popupTemplate:n}}set aggregateGeometries(t){const e=this._get("aggregateGeometries");JSON.stringify(e)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}cloneShallow(){return new CF({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;const e=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[e,this.sourceLayer,this.layer])if(i){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(t&&"defaultPopupTemplate"in i&&null!=i.defaultPopupTemplate)return i.defaultPopupTemplate}return null}getAttribute(t){return this.attributes?.[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{aggregateGeometries:OF(this.aggregateGeometries),geometry:null!=this.geometry?this.geometry.toJSON():null,symbol:null!=this.symbol?this.symbol.toJSON():null,attributes:tl(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}notifyMeshTransformChanged(t={}){const{geometry:e}=this;if("mesh"===e?.type){const i={origin:e.origin,transform:e.transform};this._notifyLayer("origin-transform",i,i,t.action)}}_notifyLayer(t,e,i,n){if(!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:t,oldValue:e,newValue:i};"origin-transform"===t&&(s.action=n),"attributes"===t&&(s.attributeName=n),this.layer.graphicChanged(s)}};o([Us({value:null,json:{read:EF}})],LF.prototype,"aggregateGeometries",null),o([Us({value:null})],LF.prototype,"attributes",null),o([Us({value:null,types:Cm,json:{read:Tm}})],LF.prototype,"geometry",null),o([Us({type:Boolean})],LF.prototype,"isAggregate",void 0),o([Us({clonable:"reference"})],LF.prototype,"layer",void 0),o([Us({clonable:"reference"})],LF.prototype,"origin",void 0),o([Us({type:pL})],LF.prototype,"popupTemplate",void 0),o([Us({clonable:"reference"})],LF.prototype,"sourceLayer",void 0),o([Us({value:null,types:xF})],LF.prototype,"symbol",null),o([Us({type:Boolean,value:!0})],LF.prototype,"visible",null),LF=CF=o([Nr("esri.Graphic")],LF),function(t){t.generateUID=jn}(LF||(LF={}));const NF=LF;let RF=class extends rj{_own(t){t.layer&&"remove"in t.layer&&t.layer!==this.owner&&t.layer.remove(t),t.layer=this.owner}_release(t){t.layer===this.owner&&(t.layer=null)}};o([Dm({Type:NF,ensureType:ks(NF)})],RF.prototype,"itemType",void 0),RF=o([Nr("esri.support.GraphicsCollection")],RF);let PF=class extends Vr{constructor(t){super(t),this.view=null,this.baseLayerViews=new ty,this.referenceLayerViews=new ty,this._loadingHandle=fy((()=>this.view?.map?.basemap),(t=>{t&&t.load().catch((()=>{}))}),_y)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const t of this.baseLayerViews)t.destroy();this.baseLayerViews.length=0;for(const t of this.referenceLayerViews)t.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){if(this.view&&this.view.suspended)return!1;const t=this.view?.map?.basemap;return!!t&&(!!t.loaded&&(this.baseLayerViews.some((t=>t.updating))||this.referenceLayerViews.some((t=>t.updating))))}};o([Us({constructOnly:!0})],PF.prototype,"view",void 0),o([Us({readOnly:!0})],PF.prototype,"baseLayerViews",void 0),o([Us({readOnly:!0})],PF.prototype,"referenceLayerViews",void 0),o([Us({readOnly:!0})],PF.prototype,"suspended",null),o([Us({type:Boolean,readOnly:!0})],PF.prototype,"updating",null),PF=o([Nr("esri.views.BasemapView")],PF);function FF(t){return"tryRecycleWith"in t}class DF{constructor(t,e,i){this.layer=t,this.view=e,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=Hi(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,Li(this._controller.signal,(()=>{const e=new Qe("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(e)}))}tryRecycle(t){if(!this.done||!this.layerView||!FF(this.layerView))return null;const e=this.layer.type,i=this._controller.signal;for(let n=0;n<t.length;n++){const s=t[n];if(s.type!==e)continue;const r=this.layerView.tryRecycleWith(s,{signal:i});if(r){t.splice(n,1),this.layer=s;const e=this.layerView,i=e.view;return this.promise=Promise.race([r.then((()=>(Ii(this._controller.signal),s.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{view:i,layerView:e}),s.emit("layerview-create",{view:i,layerView:e}),i.emit("layerview-create",{view:i,layerView:e}),e))),new Promise(((t,e)=>Li(this._controller.signal,(()=>e(Ai())))))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:t}=this;if(t){const{layer:e,view:i}=this;e.emit("layerview-destroy",{view:i,layerView:t}),i.emit("layerview-destroy",{layer:e,layerView:t})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:t},layer:e,view:i}=this;this._map=i.map;try{let n,s;if(await e.load({signal:t}),e.prefetchResources&&await e.prefetchResources({signal:t}),UF(e))n=await e.createLayerView(i,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(e))throw new Qe("layer:view-not-supported","No layerview implementation was found");const s=await this.layerViewImporter.importLayerView(e);Ii(t),n="default"in s?new s.default({layer:e,view:i}):new s({layer:e,view:i})}const r=()=>{s=Ut(s),n.destroyed||n.destroy(),n.layer=null,n.parent=null,n.view=null,this.done=!0};s=Li(t,r),Ii(t);try{await n.when()}catch(t){throw r(),t}const o=this._map?.allLayers?.includes(e);if(!o)return r(),void this._deferred.reject(new Qe("view:no-layerview-for-layer","The layer has been removed from the map",{layer:e}));this.layerView=n,e.emit("layerview-create",{view:i,layerView:n}),i.emit("layerview-create",{layer:e,layerView:n}),this.done=!0,this._deferred.resolve(n)}catch(t){e.emit("layerview-create-error",{view:i,error:t}),i.emit("layerview-create-error",{layer:e,error:t}),this.done=!0,this._deferred.reject(new Qe("layerview:create-error","layerview creation failed",{layer:e,error:t}))}}}let $F=class extends Vr{constructor(t){super(t),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new cS,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const t=this.view.map?.allLayers;if(t)for(const e of t)this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e)},this._reschedule=()=>this.destroyed?Promise.reject():(null==this._workPromise&&(this._workPromise=Hi(),this._workPromise.promise.catch((()=>{}))),this.removeHandles("reschedule"),this.addHandles(ln(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),null==this._workPromise)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const e=new Set,i=[],n=this.view.ready,s=t=>{if(null!=t)for(const r of t)if(r){e.add(r);const t=this._layerLayerViewInfoMap.get(r);t&&n?t.start():t||this._recyclingInfoMap.has(r)||i.push(r),"layers"in r&&r.layers&&s(r.layers)}};for(const t of this._rootCollectionNames)s(le(this,t));for(const[t,n]of this._layerLayerViewInfoMap)if(!e.has(t)){this._layerLayerViewInfoMap.delete(n.layer);const t=n.tryRecycle(i);t?(this.notifyChange("updating"),this._recyclingInfoMap.set(n.layer,n),t.then((()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(n.layer),this._layerLayerViewInfoMap.set(n.layer,n),this._reschedule()})).catch((()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(n.layer),n.destroy(),this._reschedule()}))):n.destroy()}for(const[t,i]of this._recyclingInfoMap)e.has(t)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(i.layer),i.destroy());for(const t of i)this._createLayerView(t);this._refreshCollections();const r=[t?.ground?.layers,t?.basemap?.baseLayers,t?.basemap?.referenceLayers,t?.layers].filter((t=>!!t));e.forEach((t=>"layers"in t&&r.push(t.layers))),this.addHandles(r.map((t=>this._watchUpdatingTracking.addOnCollectionChange((()=>t),this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([yy((()=>this.view?.map?.allLayers),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),fy((()=>{const t=this.view,e=t?.map;return[e?.basemap,e?.ground,e?.layers,t?.ready]}),(()=>this._reschedule()),My)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),OI(this._recyclingInfoMap),OI(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,null!=this._workPromise&&(this._workPromise.reject(Ai()),this._workPromise=null)}get _layersToLayerViews(){const t=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&t.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(t)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return null!=this._workPromise||this._watchUpdatingTracking.updating||os(this._layerLayerViewInfoMap,(t=>!t.done))||this._recyclingInfoMap.size>0}get updatingRemaining(){let t=0;for(const e of this._layerLayerViewInfoMap.values())e.done||++t;return t}clear(){this.destroyed||(OI(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(t){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(t)){if(this._recyclingInfoMap.has(t))return this._recyclingInfoMap.get(t).promise;throw new Qe("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t})}return this._layerLayerViewInfoMap.get(t).promise}_refreshCollections(){for(const[t,e]of this._layersToLayerViews)this._populateLayerViewsOwners(le(this,t),le(this,e),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(t,e,i){if(!t||!e)return void(e&&e.removeAll());let n=0;for(const s of t){const t=this._layerLayerViewInfoMap.get(s);if(!t?.layerView)continue;const r=t.layerView;r.layer=s,r.parent=i,e.at(n)!==r&&e.splice(n,0,r),s.layers&&this._populateLayerViewsOwners(s.layers,r.layerViews,r),n+=1}n<e.length&&e.splice(n,e.length)}_createLayerView(t){t.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t);const e=new DF(t,this.view,this.layerViewImporter);e.promise.then((()=>this._refreshCollections()),(e=>{e&&(Pi(e)||"cancelled:layerview-create"===e.name)||Ft.getLogger(this).error(`Failed to create layerview for layer title:'${t.title??"no title"}', id:'${t.id??"no id"}' of type '${t.type}'.`,{layer:t,error:e}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(t,e),this.view.ready&&e.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};o([Us()],$F.prototype,"_workPromise",void 0),o([Us({readOnly:!0})],$F.prototype,"_watchUpdatingTracking",void 0),o([Us({readOnly:!0})],$F.prototype,"_layersToLayerViews",null),o([Us({readOnly:!0})],$F.prototype,"_rootCollectionNames",null),o([Us()],$F.prototype,"layerViewImporter",void 0),o([Us()],$F.prototype,"supportsGround",void 0),o([Us({readOnly:!0})],$F.prototype,"updating",null),o([Us({readOnly:!0})],$F.prototype,"updatingRemaining",null),o([Us({constructOnly:!0})],$F.prototype,"view",void 0),$F=o([Nr("esri.views.LayerViewManager")],$F);const zF=$F;function UF(t){return"createLayerView"in t&&null!=t.createLayerView}let VF=class extends Vr{constructor(t){super(t),this.factor=1.5,this.offset=DT(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};o([Us({type:Number})],VF.prototype,"factor",void 0),o([Us({nonNullable:!0})],VF.prototype,"offset",void 0),o([Us()],VF.prototype,"position",void 0),o([Us({type:Number,range:{min:0}})],VF.prototype,"size",void 0),o([Us()],VF.prototype,"maskUrl",void 0),o([Us()],VF.prototype,"maskEnabled",void 0),o([Us()],VF.prototype,"overlayUrl",void 0),o([Us()],VF.prototype,"overlayEnabled",void 0),o([Us({readOnly:!0})],VF.prototype,"version",null),o([Us({type:Boolean})],VF.prototype,"visible",void 0),VF=o([Nr("esri.views.Magnifier")],VF);const GF=VF;class BF{constructor(t){this._observable=new $m,this._map=new Map(t)}get size(){return Ee(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(t){const e=this._map.delete(t);return e&&this._observable.notify(),e}entries(){return Ee(this._observable),this._map.entries()}forEach(t,e){Ee(this._observable),this._map.forEach(((i,n)=>t.call(e,i,n,this)),e)}get(t){return Ee(this._observable),this._map.get(t)}has(t){return Ee(this._observable),this._map.has(t)}keys(){return Ee(this._observable),this._map.keys()}set(t,e){return this._map.set(t,e),this._observable.notify(),this}values(){return Ee(this._observable),this._map.values()}[Symbol.iterator](){return Ee(this._observable),this._map[Symbol.iterator]()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}}var qF;let HF=qF=class extends el{constructor(t){super(t),this.name=null,this.code=null}clone(){return new qF({name:this.name,code:this.code})}};o([Us({type:String,json:{write:!0}})],HF.prototype,"name",void 0),o([Us({type:[String,Number],json:{write:!0}})],HF.prototype,"code",void 0),HF=qF=o([Nr("esri.layers.support.CodedValue")],HF);const WF=new ul({inherited:"inherited",codedValue:"coded-value",range:"range"});let ZF=class extends el{constructor(t){super(t),this.name=null,this.type=null}};o([Us({type:String,json:{write:!0}})],ZF.prototype,"name",void 0),o([ST(WF)],ZF.prototype,"type",void 0),ZF=o([Nr("esri.layers.support.Domain")],ZF);const JF=ZF;var KF;let YF=KF=class extends JF{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=String(t);this.codedValues.some((t=>(String(t.code)===i&&(e=t.name),!!e)))}return e}clone(){return new KF({codedValues:ht(this.codedValues),name:this.name})}};o([Us({type:[HF],json:{write:!0}})],YF.prototype,"codedValues",void 0),o([ST({codedValue:"coded-value"})],YF.prototype,"type",void 0),YF=KF=o([Nr("esri.layers.support.CodedValueDomain")],YF);const QF=YF;var XF;let tD=XF=class extends JF{constructor(t){super(t),this.type="inherited"}clone(){return new XF}};o([ST({inherited:"inherited"})],tD.prototype,"type",void 0),tD=XF=o([Nr("esri.layers.support.InheritedDomain")],tD);const eD=tD;var iD;let nD=iD=class extends JF{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new iD({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};o([Us({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],nD.prototype,"maxValue",void 0),o([Us({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],nD.prototype,"minValue",void 0),o([ST({range:"range"})],nD.prototype,"type",void 0),nD=iD=o([Nr("esri.layers.support.RangeDomain")],nD);const sD=nD;const rD={key:"type",base:JF,typeMap:{range:sD,"coded-value":QF,inherited:eD}};function oD(t){if(!t?.type)return null;switch(t.type){case"range":return sD.fromJSON(t);case"codedValue":return QF.fromJSON(t);case"inherited":return eD.fromJSON(t)}return null}const aD=new ul({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var lD;const uD=new ul({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let cD=lD=class extends el{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch(t){}return i?.value??null}readValueType(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch(t){}return i?uD.fromJSON(i.fieldValueType):null}clone(){return new lD({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};o([Us({type:String,json:{write:!0}})],cD.prototype,"alias",void 0),o([Us({type:[String,Number],json:{write:{allowNull:!0}}})],cD.prototype,"defaultValue",void 0),o([Us()],cD.prototype,"description",void 0),o([al("description")],cD.prototype,"readDescription",null),o([Us({types:rD,json:{read:{reader:oD},write:!0}})],cD.prototype,"domain",void 0),o([Us({type:Boolean,json:{write:!0}})],cD.prototype,"editable",void 0),o([Us({type:Ns,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],cD.prototype,"length",void 0),o([Us({type:String,json:{write:!0}})],cD.prototype,"name",void 0),o([Us({type:Boolean,json:{write:!0}})],cD.prototype,"nullable",void 0),o([ST(aD)],cD.prototype,"type",void 0),o([Us()],cD.prototype,"valueType",void 0),o([al("valueType",["description"])],cD.prototype,"readValueType",null),o([Us({type:Boolean,json:{read:!1}})],cD.prototype,"visible",void 0),cD=lD=o([Nr("esri.layers.support.Field")],cD);const hD=cD;var dD;let fD=dD=class extends el{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new dD({mapLayerId:t,gdbVersion:e})}};o([ST({mapLayer:"map-layer"})],fD.prototype,"type",void 0),o([Us({type:Ns,json:{write:!0}})],fD.prototype,"mapLayerId",void 0),o([Us({type:String,json:{write:!0}})],fD.prototype,"gdbVersion",void 0),fD=dD=o([Nr("esri.layers.support.source.MapLayerSource")],fD);var pD;let mD=pD=class extends el{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:i,spatialReference:n,geometryType:s}=this,r={workspaceId:t,query:e,oidFields:i,spatialReference:n?.clone()??void 0,geometryType:s};return new pD(r)}};o([ST({queryTable:"query-table"})],mD.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],mD.prototype,"workspaceId",void 0),o([Us({type:String,json:{write:!0}})],mD.prototype,"query",void 0),o([Us({type:String,json:{write:!0}})],mD.prototype,"oidFields",void 0),o([Us({type:jd,json:{write:!0}})],mD.prototype,"spatialReference",void 0),o([ST(wm)],mD.prototype,"geometryType",void 0),mD=pD=o([Nr("esri.layers.support.source.QueryTableDataSource")],mD);var yD;let gD=yD=class extends el{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new yD({workspaceId:t,dataSourceName:e})}};o([ST({raster:"raster"})],gD.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],gD.prototype,"dataSourceName",void 0),o([Us({type:String,json:{write:!0}})],gD.prototype,"workspaceId",void 0),gD=yD=o([Nr("esri.layers.support.source.RasterDataSource")],gD);var vD;let wD=vD=class extends el{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new vD({workspaceId:t,gdbVersion:e,dataSourceName:i})}};o([ST({table:"table"})],wD.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],wD.prototype,"workspaceId",void 0),o([Us({type:String,json:{write:!0}})],wD.prototype,"gdbVersion",void 0),o([Us({type:String,json:{write:!0}})],wD.prototype,"dataSourceName",void 0),wD=vD=o([Nr("esri.layers.support.source.TableDataSource")],wD);var bD,SD;const xD=cl()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let _D=bD=class extends el{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return kD()(t,e,i)}castLeftTableSource(t){return Ls(AD(),t)}readRightTableSource(t,e,i){return kD()(t,e,i)}castRightTableSource(t){return Ls(AD(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:i,rightTableSource:n,joinType:s}=this,r={leftTableKey:t,rightTableKey:e,leftTableSource:i?.clone()??void 0,rightTableSource:n?.clone()??void 0,joinType:s};return new bD(r)}};o([ST({joinTable:"join-table"})],_D.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],_D.prototype,"leftTableKey",void 0),o([Us({type:String,json:{write:!0}})],_D.prototype,"rightTableKey",void 0),o([Us({json:{write:!0}})],_D.prototype,"leftTableSource",void 0),o([al("leftTableSource")],_D.prototype,"readLeftTableSource",null),o([ol("leftTableSource")],_D.prototype,"castLeftTableSource",null),o([Us({json:{write:!0}})],_D.prototype,"rightTableSource",void 0),o([al("rightTableSource")],_D.prototype,"readRightTableSource",null),o([ol("rightTableSource")],_D.prototype,"castRightTableSource",null),o([ST(xD)],_D.prototype,"joinType",void 0),_D=bD=o([Nr("esri.layers.support.source.JoinTableDataSource")],_D);let MD=null;function kD(){return MD||(MD=Ks({types:AD()})),MD}let TD=null;function AD(){return TD||(TD={key:"type",base:null,typeMap:{"data-layer":jD,"map-layer":fD}}),TD}const ID={key:"type",base:null,typeMap:{"join-table":_D,"query-table":mD,raster:gD,table:wD}};let jD=SD=class extends el{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new SD({fields:t,dataSource:e})}};o([ST({dataLayer:"data-layer"})],jD.prototype,"type",void 0),o([Us({type:[hD],json:{write:!0}})],jD.prototype,"fields",void 0),o([Us({types:ID,json:{write:!0}})],jD.prototype,"dataSource",void 0),jD=SD=o([Nr("esri.layers.support.source.DataLayerSource")],jD),jD.from=ks(jD);let CD=class extends(Gr(el)){constructor(t){super(t),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};o([Us({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.onFields&&this.onFields.length>0}}}}})],CD.prototype,"onFields",void 0),o([Us({type:String,json:{write:!0}})],CD.prototype,"operator",void 0),o([Us({type:String,json:{write:!0}})],CD.prototype,"searchTerm",void 0),o([Us({type:String,json:{write:!0}})],CD.prototype,"searchType",void 0),CD=o([Nr("esri.rest.support.FullTextSearch")],CD);const ED=CD;var OD;const LD=new ul({upperLeft:"upper-left",lowerLeft:"lower-left"});let ND=OD=class extends el{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new OD(ht({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};o([Us({type:Rf,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],ND.prototype,"extent",void 0),o([Us({type:["view","edit"],json:{write:!0}})],ND.prototype,"mode",void 0),o([Us({type:String,json:{read:LD.read,write:LD.write}})],ND.prototype,"originPosition",void 0),o([Us({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],ND.prototype,"tolerance",void 0),ND=OD=o([Nr("esri.rest.support.QuantizationParameters")],ND);const RD=ND;const PD=new ul({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var FD;const DD=new ul({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let $D=FD=class extends el{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(e.statisticParameters=ht(t))}clone(){return new FD({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:ht(this.statisticParameters)})}};o([Us({type:Number,json:{write:!0}})],$D.prototype,"maxPointCount",void 0),o([Us({type:Number,json:{write:!0}})],$D.prototype,"maxRecordCount",void 0),o([Us({type:Number,json:{write:!0}})],$D.prototype,"maxVertexCount",void 0),o([Us({type:String,json:{write:!0}})],$D.prototype,"onStatisticField",void 0),o([Us({type:String,json:{write:!0}})],$D.prototype,"outStatisticFieldName",void 0),o([Us({type:String,json:{read:{source:"statisticType",reader:DD.read},write:{target:"statisticType",writer:DD.write}}})],$D.prototype,"statisticType",void 0),o([Us({type:Object})],$D.prototype,"statisticParameters",void 0),o([ll("statisticParameters")],$D.prototype,"writeStatisticParameters",null),$D=FD=o([Nr("esri.rest.support.StatisticDefinition")],$D);const zD=$D;var UD;const VD=new ul({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let GD=UD=class extends el{static from(t){return Ss(UD,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return"number"==typeof t||"object"==typeof t?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const e in t){const n=t[e];Array.isArray(n)?i[e]=n.map((t=>t instanceof Date?t.getTime():t)):n instanceof Date?i[e]=n.getTime():i[e]=n}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new UD(ht({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:null!=this.historicMoment?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};GD.MAX_MAX_RECORD_COUNT_FACTOR=5,o([Us({json:{write:!0}})],GD.prototype,"aggregateIds",void 0),o([Us({type:Boolean,json:{write:!0}})],GD.prototype,"cacheHint",void 0),o([Us({type:Boolean,json:{default:!1,write:!0}})],GD.prototype,"compactGeometryEnabled",void 0),o([Us({json:{write:!0}})],GD.prototype,"datumTransformation",void 0),o([ol("datumTransformation")],GD.prototype,"castDatumTransformation",null),o([Us({type:Boolean,json:{default:!1,write:!0}})],GD.prototype,"defaultSpatialReferenceEnabled",void 0),o([Us({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],GD.prototype,"distance",void 0),o([Us({type:jD,json:{write:!0}})],GD.prototype,"dynamicDataSource",void 0),o([Us({type:String,json:{write:!0}})],GD.prototype,"formatOf3DObjects",void 0),o([Us({type:[ED],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.fullText&&this.fullText.length>0}}}}})],GD.prototype,"fullText",void 0),o([Us({type:String,json:{write:!0}})],GD.prototype,"gdbVersion",void 0),o([Us({types:Cm,json:{read:Tm,write:!0}})],GD.prototype,"geometry",void 0),o([Us({type:Number,json:{write:!0}})],GD.prototype,"geometryPrecision",void 0),o([Us({type:[String],json:{write:!0}})],GD.prototype,"groupByFieldsForStatistics",void 0),o([Us({type:String,json:{write:!0}})],GD.prototype,"having",void 0),o([Us({type:Date})],GD.prototype,"historicMoment",void 0),o([ll("historicMoment")],GD.prototype,"writeHistoricMoment",null),o([Us({type:Number,json:{write:!0}})],GD.prototype,"maxAllowableOffset",void 0),o([Us({type:Number,cast:t=>t<1?1:t>GD.MAX_MAX_RECORD_COUNT_FACTOR?GD.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],GD.prototype,"maxRecordCountFactor",void 0),o([Us({type:["xyFootprint"],json:{write:!0}})],GD.prototype,"multipatchOption",void 0),o([Us({type:Number,json:{read:{source:"resultRecordCount"}}})],GD.prototype,"num",void 0),o([Us({json:{write:!0}})],GD.prototype,"objectIds",void 0),o([Us({type:[String],json:{write:!0}})],GD.prototype,"orderByFields",void 0),o([Us({type:[String],json:{write:!0}})],GD.prototype,"outFields",void 0),o([Us({type:jd,json:{name:"outSR",write:!0}})],GD.prototype,"outSpatialReference",void 0),o([Us({type:[zD],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&this.outStatistics.length>0}}}}})],GD.prototype,"outStatistics",void 0),o([Us({json:{write:!0}})],GD.prototype,"parameterValues",void 0),o([ll("parameterValues")],GD.prototype,"writeParameterValues",null),o([Us({type:Qd,json:{write:!0}})],GD.prototype,"pixelSize",void 0),o([Us({type:RD,json:{write:!0}})],GD.prototype,"quantizationParameters",void 0),o([Us({type:[Object],json:{write:!0}})],GD.prototype,"rangeValues",void 0),o([Us({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],GD.prototype,"relationParameter",void 0),o([Us({type:String,json:{write:!0}})],GD.prototype,"resultType",void 0),o([Us({type:Boolean,json:{default:!1,write:!0}})],GD.prototype,"returnCentroid",void 0),o([Us({type:Boolean,json:{default:!1,write:!0}})],GD.prototype,"returnDistinctValues",void 0),o([Us({type:Boolean,json:{default:!0,write:!0}})],GD.prototype,"returnExceededLimitFeatures",void 0),o([Us({type:Boolean,json:{write:!0}})],GD.prototype,"returnGeometry",void 0),o([Us({type:Boolean,json:{default:!1,write:!0}})],GD.prototype,"returnQueryGeometry",void 0),o([Us({type:Boolean,json:{default:!1,write:!0}})],GD.prototype,"returnM",void 0),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],GD.prototype,"returnZ",void 0),o([Us({type:jd,json:{write:!0}})],GD.prototype,"sourceSpatialReference",void 0),o([ST(PD,{ignoreUnknown:!1,name:"spatialRel"})],GD.prototype,"spatialRelationship",void 0),o([Us({type:Number,json:{read:{source:"resultOffset"}}})],GD.prototype,"start",void 0),o([ll("start"),ll("num")],GD.prototype,"writeStart",null),o([Us({type:String,json:{write:!0}})],GD.prototype,"sqlFormat",void 0),o([Us({type:String,json:{write:!0}})],GD.prototype,"text",void 0),o([Us({type:sj,json:{write:!0}})],GD.prototype,"timeExtent",void 0),o([Us({type:Boolean,json:{default:!1,write:!0}})],GD.prototype,"timeReferenceUnknownClient",void 0),o([ST(VD,{ignoreUnknown:!1}),Us({json:{write:{overridePolicy(t){return{enabled:!!t&&null!=this.distance&&this.distance>0}}}}})],GD.prototype,"units",void 0),o([Us({type:String,json:{write:{overridePolicy(t){return{enabled:null!=t||null!=this.start&&this.start>0}}}}})],GD.prototype,"where",void 0),o([ll("where")],GD.prototype,"writeWhere",null),GD=UD=o([Nr("esri.rest.support.Query")],GD);const BD=GD;let qD=class extends Pm.EventedAccessor{constructor(t){super(t),this._selectionMap=new BF,this._trashCan=[],this._layerEditHandles=new ty,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([fy((()=>[this.view,this.showHighlight]),(()=>this._refreshVisualization())),yy((()=>this.sources),"change",(t=>{const e=this._selectionMap;for(const i of t.removed)e.delete(i);this._refreshListeners(),this._refreshVisualization()}),{onListenerAdd:()=>this._refreshListeners()})]);const t=new ty;this.view.when().then((()=>{this.view.map.allLayers.flatten((t=>"sublayers"in t&&t.sublayers?t.sublayers:null)).forEach((e=>{(HD(e)&&!Ok(e)||Lk(e))&&t.add(e)})),this._set("sources",t)}))}destroy(){this._layerEditHandles.drain(Ut)}get selections(){return Array.from(this._selectionMap.entries()).map((t=>{const[e,i]=t;return{layer:e,selection:[...i.selection]}}))}get count(){let t=0;for(const e of this._selectionMap.values())t+=e.selection.length;return t}get hasSelection(){return this.count>0}get sources(){return this._get("sources")}set sources(t){this._set("sources",t)}async getSelectedFeatures(t,e={},i="layerView"){const{view:n,selections:s}=this,r=(void 0!==t?s.filter((e=>t.includes(e.layer))):s).filter((t=>t.selection.length>0)).map((async t=>{const{layer:s,selection:r}=t,o=Lk(s)?s.parent:s;if(null==o||!ZD(o))return null;if("layer"===i)return KD(o,r,e);const a=await n.whenLayerView(o);return KD(a,r,e)}));return(await Promise.all(r)).filter((t=>null!==t))}updateSelection(t){const e=new Map;for(const[t,i]of this._selectionMap)e.set(t,[...i.selection]);let i=!1;const n=t.current.concat(t.added);for(const t of n){const n=t.sourceLayer,s=t.getObjectId();if(this.sources.includes(n)&&(HD(n)||Lk(n))&&null!==s){const t=as(e,n,(()=>[]));t.includes(s)||(t.push(s),i=!0)}}for(const n of t.removed){const t=n.sourceLayer,s=n.getObjectId();if(this.sources.includes(t)&&(HD(t)||Lk(t))&&null!==s){const n=e.get(t),r=n?.indexOf(s);void 0!==r&&r>=0&&(n?.splice(r,1),i=!0)}}if(i){const{_selectionMap:t,_trashCan:i}=this,n=[];for(const[s,r]of e){const e=t.get(s);void 0!==e&&i.push(e),t.set(s,{selection:r}),n.push({layer:s,selection:r,...k(void 0!==e?e.selection:[],r)})}this._onSelectionChange(n)}}setSelection(t,e){this._setSelection(t,e)}getSelection(t){const e=this._selectionMap.get(t);return e?.selection}appendToSelection(t,e){const i=this._selectionMap.get(t),n=void 0!==i?[...i.selection]:[];for(const t of e)n.includes(t)||n.push(t);this._setSelection(t,n)}removeFromSelection(t,e){const i=this._selectionMap.get(t);if(!i)return;const n=[];for(const t of i.selection)e.includes(t)||n.push(t);this._setSelection(t,n)}toggleInSelection(t,e){const i=this._selectionMap.get(t);if(!i||0===i.selection.length)return void this._setSelection(t,e);const n=new Set(i.selection),s=new Set(e),r=An(n,s);this._setSelection(t,Array.from(r))}clear(){const t=this._selectionMap.values();this._trashCan.push(...t);const e=[];for(const[t,i]of this._selectionMap.entries())e.push({layer:t,added:[],removed:[...i.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(e)}_onSelectionChange(t){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:t})}_refreshVisualization(){if(null==this.view||null==this.sources)return;for(this._vizTaskId++;this._trashCan.length>0;){const t=this._trashCan.pop();t?.highlightHandle?.remove()}const{sources:t,view:e,_selectionMap:i,showHighlight:n}=this,s=this._vizTaskId;for(const r of t){const t=i.get(r),o=Lk(r)?r.parent:r;null!=o&&ZD(o)&&e.whenLayerView(o).then((e=>{t?.highlightHandle?.remove(),void 0!==t&&n&&s===this._vizTaskId&&"highlight"in e&&"function"==typeof e.highlight&&t.selection.length>0&&(t.highlightHandle=e.highlight(t.selection,"selection"))}))}}_refreshListeners(){this._layerEditHandles.drain(Ut);for(const t of this.sources){const e=Lk(t)?t.parent:t;if(null!=e&&HD(e)){const i=e.on("edits",(e=>{this._handleEditChanges(e,t)}));this._layerEditHandles.push(i)}}}_handleEditChanges(t,e){if(void 0!==t.deletedFeatures&&t.deletedFeatures.length>0&&this._selectionMap.has(e)){const i=t.deletedFeatures.filter((t=>null==t.error)).map((t=>t.objectId)).filter(F);this.removeFromSelection(e,i)}}_setSelection(t,e){if(!this.sources.includes(t))throw new Error(`Cannot set selection on layer ${t.title} because it is not in 'sources'`);const i=this._selectionMap.get(t);if(void 0===i||!JD(i,{selection:e})){void 0!==i&&this._trashCan.push(i),this._selectionMap.set(t,{selection:[...e]});const n={layer:t,selection:[...e],...k(void 0!==i?i.selection:[],e)};this._onSelectionChange([n])}}};o([Us({readOnly:!0,nonNullable:!0})],qD.prototype,"selections",null),o([Us({readOnly:!0,nonNullable:!0})],qD.prototype,"count",null),o([Us({constructOnly:!0,nonNullable:!0})],qD.prototype,"view",void 0),o([Us({readOnly:!0,nonNullable:!0})],qD.prototype,"hasSelection",null),o([Us()],qD.prototype,"showHighlight",void 0),o([Us()],qD.prototype,"sources",null),qD=o([Nr("esri.views.SelectionManager")],qD);const HD=t=>void 0!==t.createQuery&&void 0!==t.on,WD=t=>void 0!==t.layer,ZD=t=>void 0!==t?.when,JD=(t,e)=>{if(null==t&&null==e)return!0;if(null!=t&&null==e||null==t&&null!=e)return!1;if(null!=t&&null!=e&&null!=t.selection&&null!=e.selection){const i=[...t.selection],n=[...e.selection];if(i.length!==n.length)return!1;i.sort(),n.sort();for(let t=0;t<i.length;t++)if(i[t]!==n[t])return!1}return!0},KD=async(t,e,i={})=>{let n;if(WD(t)){const s=t;n=void 0===s?null:await s.queryFeatures(new BD({...i,objectIds:e})).then((e=>({data:e,layer:t.layer})))}else{const s=t;n=void 0===s?null:await s.queryFeatures(new BD({...i,objectIds:e})).then((t=>({data:t,layer:s})))}return n},YD=qD;let QD=class extends(Gr(Vr)){constructor(t){super(t),this.accentColor=new wT([255,127,0]),this.textColor=new wT([255,255,255])}};o([Us({type:wT,nonNullable:!0})],QD.prototype,"accentColor",void 0),o([Us({type:wT,nonNullable:!0})],QD.prototype,"textColor",void 0),QD=o([Nr("esri.views.Theme")],QD);const XD=QD;var t$;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(t$||(t$={}));const e$=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],i$={};function n$(t){return!!i$[t]}function s$(t){for(const e of t)if(!n$(e))return!1;return!0}e$.forEach((t=>{i$[t]=!0}));class r${constructor(t){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this._handlers.forEach((({handler:t,priority:e},i)=>this.inputManager?.installHandlers(i,[t],e)))}disconnect(){this.inputManager&&this._handlers.forEach(((t,e)=>this.inputManager?.uninstallHandlers(e))),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(t,e,i,n){const s=Array.isArray(t)?t:t.split(",");if(!s$(s))return s.some(n$)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let r,o;Array.isArray(e)?o=e:(r=e,o=[]),"function"==typeof i?r=i:n=i,n=null!=n?n:oM.DEFAULT;const a=this._createUniqueGroupName(),l=new o$(this.view,s,o,r);this._handlers.set(a,{handler:l,priority:n});for(const t of s){const e=this._handlerCounts.get(t)||0;this._handlerCounts.set(t,e+1)}return this.inputManager&&this.inputManager.installHandlers(a,[l],n),Zt((()=>this._removeHandler(a,s)))}hasHandler(t){return!!this._handlerCounts.get(t)}_removeHandler(t,e){if(this._handlers.has(t)){this._handlers.delete(t);for(const t of e){const e=this._handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this._handlerCounts.delete(t):this._handlerCounts.set(t,e-1)}}this.inputManager&&this.inputManager.uninstallHandlers(t)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}}class o$ extends K_{constructor(t,e,i,n){super(!0),this._latestDragStart=void 0,this.view=t;for(const t of e)switch(t){case"click":this.registerIncoming("click",i,(t=>n(this._wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",i,(t=>n(this._wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",i,(t=>n(this._wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,(t=>n(this._wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",i,(t=>n(this._wrapHold(t))));break;case"drag":this.registerIncoming("drag",i,(t=>{const e=this._wrapDrag(t);e&&n(e)}));break;case"key-down":this.registerIncoming("key-down",i,(t=>n(this._wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",i,(t=>n(this._wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",i,(t=>n(this._wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",i,(t=>n(this._wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",i,(t=>n(this._wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,(t=>n(this._wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,(t=>n(this._wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,(t=>n(this._wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,(t=>n(this._wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",i,(t=>{n(this._wrapGamepad(t))}));break;case"focus":this.registerIncoming("focus",i,(t=>{n(this._wrapFocus(t))}));break;case"blur":this.registerIncoming("blur",i,(t=>{n(this._wrapBlur(t))}))}}_wrapFocus(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapBlur(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapClick(t){const{pointerType:e,button:i,buttons:n,x:s,y:r,native:o,eventId:a}=t.data,{cancelable:l,timestamp:u}=t;return{type:"click",pointerType:e,button:i,buttons:n,x:s,y:r,native:o,timestamp:u,screenPoint:DT(s,r),mapPoint:this._getMapPoint(s,r),eventId:a,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapDoubleClick(t){const{pointerType:e,button:i,buttons:n,x:s,y:r,native:o,eventId:a}=t.data,{cancelable:l,timestamp:u}=t;return{type:"double-click",pointerType:e,button:i,buttons:n,x:s,y:r,native:o,timestamp:u,mapPoint:this._getMapPoint(s,r),eventId:a,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapImmediateClick(t){const{pointerType:e,button:i,buttons:n,x:s,y:r,native:o,eventId:a}=t.data,l=o.pointerId,{cancelable:u,timestamp:c}=t;return{type:"immediate-click",pointerId:l,pointerType:e,button:i,buttons:n,x:s,y:r,native:o,timestamp:c,mapPoint:this._getMapPoint(s,r),eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapImmediateDoubleClick(t){const{pointerType:e,button:i,buttons:n,x:s,y:r,native:o,eventId:a}=t.data,l=o.pointerId,{cancelable:u,timestamp:c}=t;return{type:"immediate-double-click",pointerId:l,pointerType:e,button:i,buttons:n,x:s,y:r,native:o,timestamp:c,mapPoint:this._getMapPoint(s,r),eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapHold(t){const{pointerType:e,button:i,buttons:n,x:s,y:r,native:o}=t.data,{cancelable:a,timestamp:l}=t;return{type:"hold",pointerType:e,button:i,buttons:n,x:s,y:r,native:o,timestamp:l,mapPoint:this._getMapPoint(s,r),cancelable:a,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_getMapPoint(t,e){return this.view.toMap(DT(t,e),{exclude:[]})}_wrapDrag(t){const e=t.data,{x:i,y:n}=e.center,{action:s,pointerType:r,button:o}=e;if("start"===s&&(this._latestDragStart=e),!this._latestDragStart)return;const a=e.pointer.native,l=e.buttons,{cancelable:u,timestamp:c}=t,h={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return"end"===s&&(this._latestDragStart=void 0),{type:"drag",action:s,x:i,y:n,origin:h,pointerType:r,button:o,buttons:l,radius:e.radius,angle:wa(e.angle),native:a,timestamp:c,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapKeyDown(t){const{key:e,repeat:i,native:n}=t.data,{cancelable:s,timestamp:r}=t;return{type:"key-down",key:e,repeat:i,native:n,timestamp:r,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapKeyUp(t){const{key:e,native:i}=t.data,{cancelable:n,timestamp:s}=t;return{type:"key-up",key:e,native:i,timestamp:s,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapPointer(t,e){const{x:i,y:n,button:s,buttons:r,native:o,eventId:a}=t.data,l=o.pointerId,u=o.pointerType,{cancelable:c,timestamp:h}=t;return{type:e,x:i,y:n,pointerId:l,pointerType:u,button:s,buttons:r,native:o,timestamp:h,eventId:a,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapPointerDrag(t){const{x:e,y:i,buttons:n,native:s,eventId:r}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,u=t.data.action,c={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:d}=t;return{type:"pointer-drag",x:e,y:i,pointerId:a,pointerType:l,button:o,buttons:n,action:u,origin:c,native:s,timestamp:d,eventId:r,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapMouseWheel(t){const{cancelable:e,data:i,timestamp:n}=t,{x:s,y:r,deltaY:o,native:a}=i;return{type:"mouse-wheel",x:s,y:r,deltaY:o,native:a,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}_wrapGamepad(t){const{action:e,state:i,device:n}=t.data,{cancelable:s,timestamp:r}=t,{buttons:o,axes:a}=i;return{type:"gamepad",device:n,timestamp:r,action:e,buttons:o,axes:a,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}var a$,l$,u$;!function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"}(a$||(a$={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(l$||(l$={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(u$||(u$={}));function c$(t){return[t.on("before-add",(e=>{const i=e.item;if(null==i||t.includes(i))return Ft.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()})),t.on("after-remove",(t=>{const e=t.item;e.active&&(e.view.activeTool=null),e.destroy()}))]}function h$(t){return t.visible&&null!=t.getEditableFlag&&t.getEditableFlag(a$.USER)&&t.getEditableFlag(a$.MANAGER)}function d$(t){return DT(t.x,t.y)}function f$(t,e){const i=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return i?DT(e.clientX-i.left,e.clientY-i.top):DT(0,0)}function p$(t,e){return e instanceof Event?f$(t,e):d$(e)}function m$(t){if(t instanceof Event)return!0;if("object"==typeof t&&"type"in t){switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}}return!1}class y${constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(t,e){const i=()=>t.stopPropagation();switch(t.type){case"pointer-move":g$(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(i(),"end"===t.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!v$(t))break;const n=d$(t),s=this._intersect(n,t.pointerType,e.forEachTool);if(null==s)break;const r=s.manipulator,o=s.tool;null==r||null==o||!r.interactive||r.grabbable&&r.grabbableForEvent(t)||!r.grabbing||r.dragging||this._releaseManipulatorBeforeDragging(r,t,e),null!=r&&null!=o&&r.interactive&&r.grabbable&&r.grabbableForEvent(t)&&!r.grabbing&&(this._grabbedManipulators.set(t.pointerId,{manipulator:r,tool:o,start:n,pointerType:t.pointerType}),1===this._grabbedManipulators.size&&null==e.activeTool&&(this._revertToNullActiveTool=!0,e.setActiveTool(s.tool)),r.grabbing=!0,r.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:n}),i());break}case"pointer-up":this._draggedManipulators.has(t.pointerId)||this._handlePointerEnd(t,e);break;case"pointer-drag":{if(!v$(t))break;const n=this._grabbedManipulators.get(t.pointerId),s=n?.manipulator,r=n?.tool;if(null==s||null==r)break;const o=d$(t);o.x=pa(o.x,0,e.view.width),o.y=pa(o.y,0,e.view.height);const a=n.start,l=this._draggedManipulators.get(t.pointerId);switch(t.action){case"start":case"update":"update"!==t.action&&1!==this._grabbedManipulators.size||(s.dragging=!0,l?s.events.emit("drag",{action:"update",start:a,screenPoint:o}):s.events.emit("drag",{action:"start",start:a,screenPoint:o,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{tool:r,manipulator:s,start:a}));break;case"end":s.dragging=!1,l&&s.events.emit("drag",{action:"end",start:a,screenPoint:o}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,e)}i();break}case"immediate-click":{const n=d$(t),s=this._intersect(n,t.pointerType,e.forEachTool);if(w$(t)||e.forEachTool((t=>{if((null==s||s.tool!==t||t.automaticManipulatorSelection)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0)})),e&&t.onManipulatorSelectionChanged&&t.onManipulatorSelectionChanged()}})),null==s)break;const{manipulator:r,tool:o}=s;if(!r.interactive)break;r.selectable&&o.automaticManipulatorSelection&&(r.selected=!r.selected,o.onManipulatorSelectionChanged&&o.onManipulatorSelectionChanged());const a=t.native.shiftKey;r.events.emit("immediate-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:a,stopPropagation:i}),b$(r,i);break}case"click":{const n=d$(t),s=this._intersect(n,t.pointerType,e.forEachTool),r=s?.manipulator;if(null==r||!r.interactive)break;const o=t.native.shiftKey;r.events.emit(t.type,{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:o}),i();break}case"double-click":{const n=d$(t),s=this._intersect(n,t.pointerType,e.forEachTool),r=null!=s?s.manipulator:null;if(null==r||!r.interactive)break;const o=t.native.shiftKey;r.events.emit("double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:o,stopPropagation:i}),b$(r,i);break}case"immediate-double-click":{const n=d$(t),s=this._intersect(n,t.pointerType,e.forEachTool),r=null!=s?s.manipulator:null;if(null==r||!r.interactive)break;const o=t.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:o,stopPropagation:i}),b$(r,i);break}}this._onFocusChange(e.forEachTool)}_releaseManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:d$(e)}),this._grabbedManipulators.forEach((({manipulator:e},i)=>{e===t&&this._grabbedManipulators.delete(i)})),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(t,e){const i=this._grabbedManipulators.get(t.pointerId)?.manipulator;null!=i&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:d$(t)}),this._grabbedManipulators.delete(t.pointerId),this._afterManipulatorRelease(e.setActiveTool))}_cursorFromMap(t){let e=null;return os(t,(({manipulator:t})=>!(null==t||!t.interactive)&&(t.grabbing&&t.grabCursor?(e=t.grabCursor,!0):!!t.cursor&&(e=t.cursor,!0)))),e}_onFocusChange(t){this._updateCursor(),this._updateFocusedManipulatorTools(t)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(t){const e=new Set,i=new Set;this._grabbedManipulators.forEach((({tool:t})=>{e.add(t)})),this._hoveredManipulators.forEach((({tool:t})=>{i.add(t)})),t((t=>{t.hasGrabbedManipulators=e.has(t),t.hasHoveredManipulators=i.has(t);const n=this._grabbedManipulators.values(),s=g(n,(({tool:e})=>e===t));t.firstGrabbedManipulator=null!=s?s.manipulator:null}))}clearPointers(t,{forEachTool:e,setActiveTool:i},n=!0,s){const r=(e,i)=>e===t&&(null==s||s===i);this._grabbedManipulators.forEach((({tool:t,manipulator:e,pointerType:i},n)=>{r(t,e)&&(this._grabbedManipulators.delete(n),e.grabbing=!1,e.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:i}))})),this._draggedManipulators.forEach((({tool:t,manipulator:e},i)=>{r(t,e)&&(this._draggedManipulators.delete(i),e.dragging=!1,e.events.emit("drag",{action:"cancel"}))})),n&&this._hoveredManipulators.forEach((({tool:t,manipulator:e},i)=>{r(t,e)&&(this._hoveredManipulators.delete(i),e.hovering=!1)})),this._afterManipulatorRelease(i),this._onFocusChange(e)}_intersect(t,e,i){let n=null;return i((i=>{if(null==i.manipulators||!h$(i))return!1;const s=i.manipulators.intersect(t,e);return null!=s&&(n={tool:i,manipulator:s},!0)})),n}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(DT(e.x,e.y),i,e.pointerType,t)}))}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!g$(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(d$(t),t.pointerId,t.pointerType,e)}_updateHoveredStateForPointerAtScreenPosition(t,e,i,n){let s=this._intersect(t,i,n);const r=this._hoveredManipulators.get(e)?.manipulator;null==s||s.manipulator.interactive||(s=null),null!=s&&r===s.manipulator||(null!=r&&(r.hovering=!1),null!=s?(s.manipulator.hovering=!0,this._hoveredManipulators.set(e,s)):this._hoveredManipulators.delete(e),this._onFocusChange(n))}_afterManipulatorRelease(t){0===this._grabbedManipulators.size&&this._revertToNullActiveTool&&(t(null),this._revertToNullActiveTool=!1)}}function g$(t){return"mouse"===t}function v$(t){return"mouse"!==t.pointerType||0===t.button}function w$(t){return!!t.native.shiftKey}function b$(t,e){t?.consumesClicks&&e()}const S$="attached",x$="tools",_$=1e3;let M$=class extends Vr{constructor(t){super(t),this._updatingHandles=new cS,this._clock=bi,this._manipulatorState=new y$,this.tools=new ty,this.cursor=null,this._interacting=!1,this._interactingTimeout=_$,this._interactingTimeoutHandle=null,this._forEachTool=t=>{for(const e of this.tools.items)if(t(e))return}}initialize(){this.addHandles([this.view.on(e$,(t=>{this._handleInputEvent(t)}),oM.TOOL),...c$(this.tools),this.tools.on("before-add",(({item:t})=>{this._updateToolEditableFlag(t)})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this.activeTool=null,this.tools.drain((t=>t.destroy())),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t},view:this.view}}set activeTool(t){if(null!=t&&!this.view.ready)return void Ft.getLogger(this).error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return;const e=this.activeTool;this._set("activeTool",t),null!=e&&e.deactivate(),null!=t&&t.activate(),this._removeIncompleteTools(t);for(const t of this.tools){this._updateToolEditableFlag(t);const e=h$(t);null!=this.activeTool&&e||this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs,!e)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some((t=>t.updating))}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Ut(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout((()=>this._interacting=!1),this._interactingTimeout)}attach(){"3d"===this.view.type?this.addHandles([fy((()=>{const{state:t}=this.view;return"camera"in t&&t.camera}),(()=>this._forEachManipulator((t=>t.onViewChange())))),this.view.elevationProvider?.on("elevation-change",(t=>this._forEachManipulator((e=>e.onElevationChange(t)))))],S$):this.addHandles(fy((()=>this.view.extent),(()=>this._forEachManipulator((t=>t.onViewChange())))))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(S$),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(t){this._forEachTool((e=>{e.manipulators&&e.manipulators.forEach((({manipulator:i})=>t(i,e)))}))}_handleInputEvent(t){let e=!1;const i={...t,stopPropagation:()=>{e=!0,t.stopPropagation()}};null!=this.activeTool?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((t=>{!e&&t.visible&&t.handleInputEvent(i)})),!e&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),e||null==this.activeTool||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),"pointer-move"===t.type&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(x$),this._forEachTool((t=>{if(t instanceof Vr){const e=fy((()=>[t.cursor,t.visible,t.editable]),(()=>{h$(t)||this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()}));this.addHandles(e,x$)}t.manipulators&&this.addHandles([t.manipulators.on("after-remove",(e=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs,!0,e.item.manipulator)})),t.manipulators.on("change",(()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}))],x$)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(t){t.setEditableFlag?.(a$.MANAGER,null==this.activeTool||t===this.activeTool)}_updateCursor(){let t=this._manipulatorState.cursor;null==t&&this._forEachTool((e=>!(null==e.cursor||!e.visible)&&(t=e.cursor,!0))),this._get("cursor")!==t&&this._set("cursor",t)}_removeIncompleteTools(t){this.tools.filter((e=>(null==t||e!==t)&&!e.created&&e.removeIncompleteOnCancel)).forEach((t=>{this.tools.remove(t)}))}get test(){const t=this;return{setClock:t=>this._clock=t,set interactingTimeoutEnabled(e){t._interactingTimeout=e?_$:0},get interactingTimeoutEnabled(){return 0!==t._interactingTimeout}}}};o([Us({constructOnly:!0,nonNullable:!0})],M$.prototype,"view",void 0),o([Us({value:null})],M$.prototype,"activeTool",null),o([Us({readOnly:!0,type:ty})],M$.prototype,"tools",void 0),o([Us({readOnly:!0})],M$.prototype,"cursor",void 0),o([Us({readOnly:!0})],M$.prototype,"updating",null),o([Us()],M$.prototype,"_interacting",void 0),o([Us({readOnly:!0})],M$.prototype,"interacting",null),M$=o([Nr("esri.views.ToolViewManager")],M$);let k$=class extends Vr{constructor(t){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===t.mapping?this._detectedDeviceType="standard":T$.test(t.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=t.index}get native(){const t=navigator.getGamepads?navigator.getGamepads():[];return null!=this.nativeIndex&&this.nativeIndex<t.length?t[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return A$[this.deviceType]}};o([Us({nonNullable:!0,readOnly:!0})],k$.prototype,"nativeIndex",void 0),o([Us({type:String,readOnly:!0})],k$.prototype,"deviceType",null),o([Us({type:Number,readOnly:!0})],k$.prototype,"axisThreshold",null),k$=o([Nr("esri.views.input.gamepad.GamepadInputDevice")],k$);const T$=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),A$={standard:.15,spacemouse:.025,unknown:0},I$=k$;let j$=class extends Vr{constructor(...t){super(...t),this.devices=new ty,this.enabledFocusMode="document"}};o([Us({type:ty.ofType(I$),readOnly:!0})],j$.prototype,"devices",void 0),o([Us({type:["document","view","none"]})],j$.prototype,"enabledFocusMode",void 0),j$=o([Nr("esri.views.input.gamepad.GamepadSettings")],j$);const C$=j$;let E$=class extends Vr{constructor(){super(...arguments),this.gamepad=new C$}};o([Us({readOnly:!0})],E$.prototype,"gamepad",void 0),E$=o([Nr("esri.views.input.Input")],E$);const O$=E$;let L$=class extends Vr{constructor(t){super(t),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};o([Us({type:Boolean,nonNullable:!0})],L$.prototype,"enabled",void 0),o([Us({type:I$})],L$.prototype,"device",void 0),o([Us({type:["pan","zoom"],nonNullable:!0})],L$.prototype,"mode",void 0),o([Us({type:["forward-down","forward-up"],nonNullable:!0})],L$.prototype,"tiltDirection",void 0),o([Us({type:Number,nonNullable:!0})],L$.prototype,"velocityFactor",void 0),L$=o([Nr("esri.views.navigation.gamepad.GamepadSettings")],L$);const N$=L$;let R$=class extends Vr{constructor(t){super(t),this.browserTouchPanEnabled=!0,this.gamepad=new N$,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};o([Us({type:Boolean})],R$.prototype,"browserTouchPanEnabled",void 0),o([Us({type:N$,nonNullable:!0})],R$.prototype,"gamepad",void 0),o([Us({type:Boolean})],R$.prototype,"momentumEnabled",void 0),o([Us({type:Boolean})],R$.prototype,"mouseWheelZoomEnabled",void 0),R$=o([Nr("esri.views.navigation.Navigation")],R$);const P$=R$;const F$={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer"},D$=Object.values(F$),$$=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${D$.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),z$=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${D$.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),U$=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function V$(t){return!!$$.test(t)}function G$(t){if(null==t)return null;const e=Ul(t),i=e?.path.match($$)||e?.path.match(z$);if(!i)return null;const[,n,s,r,o]=i,a=s.indexOf("/");return{title:q$(-1!==a?s.slice(a+1):s),serverType:F$[r.toLowerCase()],sublayer:null!=o&&""!==o?parseInt(o,10):null,url:{path:n}}}function B$(t){const e=Ul(t).path.match(U$);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function q$(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function H$(t,e){const i=[];if(t){const e=G$(t);null!=e&&e.title&&i.push(e.title)}if(e){const t=q$(e);i.push(t)}if(2===i.length){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function W$(t){if(!t)return!1;const e=".arcgis.com/",i="//services",n="//tiles",s="//features",r=(t=t.toLowerCase()).includes(e),o=t.includes(i)||t.includes(n)||t.includes(s);return r&&o}function Z$(t,e){return t?Nu(Uu(t,e)):t}function J$(t){let{url:e}=t;if(!e)return{url:e};e=Uu(e,t.logger);const i=Ul(e),n=G$(i.path);let s;if(null!=n)null!=n.sublayer&&null==t.layer.layerId&&(s=n.sublayer),e=n.url.path;else if(t.nonStandardUrlAllowed){const t=B$(i.path);null!=t&&(e=t.serviceUrl,s=t.sublayerId)}return{url:Nu(e),layerId:s}}function K$(t,e,i,n,s){ak(e,n,"url",s),n.url&&null!=t.layerId&&(n.url=au(n.url,i,t.layerId.toString()))}function Y$(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),n=e.includes("/mapserver/wmsserver"),s=e.includes("/imageserver/wmsserver"),r=e.includes("/wmsserver");return i&&(n||s||r)}function Q$(t){if(!t)return!1;const e=new Ol(su(t)),i=e.authority?.toLowerCase();return"server.arcgisonline.com"===i||"services.arcgisonline.com"===i}var X$;function tz(t){if("integrated-mesh-3dtiles"===t.type)return null;const e=t.url?G$(t.url):void 0,i=t.spatialReference?.vcsWkid;return!(null==i&&null!=e&&"ImageServer"===e.serverType)&&ez(t)&&t.heightModelInfo?t.heightModelInfo:nz(t)?pj.deriveUnitFromSR(oz,t.spatialReference):null}function ez(t){return"heightModelInfo"in t}function iz(t){if("unknown"===t.type||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function nz(t){return iz(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):rz(t)}function sz(t){return null!=t.layers||rz(t)||iz(t)||ez(t)}function rz(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}!function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"}(X$||(X$={}));const oz=new pj({heightModel:"gravity-related-height"});var az;function lz(t){return t===az.Global?"global":"local"}!function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"}(az||(az={}));let uz,cz=null;async function hz(t){cz||(cz=import("./p-5c6e7588.js").then((t=>uz=t))),await cz,Ii(t)}async function dz(t,e,i,n){if(!t)return null;const s=t.spatialReference;return pb()||Cb(s,e)?wb(t,e):uz?uz.projectGeometry(t,e,i,n):(await Promise.race([hz(n),vb(n)]),dz(t,e,i,n))}let fz=class extends Vr{constructor(t){super(t),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Vt(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return null!=this.userSpatialReference?this.userSpatialReference:this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return null==this.userSpatialReference||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const t=this.map?.(),e=[];return null!=this.priorityCollection&&e.push(this.priorityCollection),e.push({parent:t?.basemap,layers:t?.basemap?.baseLayers},{layers:t?.layers},{parent:t?.ground,layers:t?.ground?.layers},{parent:t?.basemap,layers:t?.basemap?.referenceLayers}),e}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:t,updating:e}=this._allLayers;let i=null;for(const e of t){const t=this._getSupportedSpatialReferences(e);if(t.length>0){const e=this._narrowDownSpatialReferenceCandidates(i,t);null!=e&&(i=e)}if(null!=i&&1===i.length)break}if(e&&(null==i||1!==i.length))return{updating:!0};const n=this._pickSpatialReferenceCandidate(i);return{spatialReference:null!=n?n.spatialReference:null,viewingMode:null!=n?n.viewingMode:null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:t,updating:e}=this._collectLayers([{parent:this.map?.()?.basemap,layers:this.map?.()?.basemap?.baseLayers},{layers:this.map?.()?.layers}]);if(t&&t.length>0&&"tileInfo"in t[0]){const e=t[0].tileInfo;return{tileInfo:e&&e.spatialReference.equals(this.spatialReference)?e:null,updating:!1}}return{updating:e}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};const{layers:t,updating:e}=this._allLayers;for(const e of t)if(sz(e)){const t=tz(e);if(t)return{heightModelInfo:t,vcsWkid:e.spatialReference?.vcsWkid,latestVcsWkid:e.spatialReference?.latestVcsWkid,updating:!1}}return{updating:e}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const t=this._allLayers,e=t.updating,i=[];for(const e of t.layers){const t="fullExtents"in e&&e.fullExtents||(null!=e.fullExtent?[e.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:t[0],s=t.find((t=>t.spatialReference.equals(this.spatialReference)))??n;if(s)return{candidates:[{extent:s,layer:e}],updating:!1};if(this._getSupportedSpatialReferences(e).length>0)for(const n of t)i.push({extent:n,layer:e})}return{candidates:i,updating:e}}get _extentTask(){const{candidates:t,updating:e}=this._extentCandidatesTask;if(e)return{updating:e};if(null==t||0===t.length)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(t),n=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:null!=this._projectExtentTask.task&&!this._projectExtentTask.task.finished}:(null!=this._projectExtentTask.task&&(this._projectExtentTask.task=Vt(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:n.clone(),task:uy((async t=>{try{const e=await dz(i.extent,n,"portalItem"in i.layer?i.layer.portalItem:void 0,t);this._projectExtentTask={...this._projectExtentTask,task:null,output:e}}catch(e){if(Ci(t))return;this._projectExtentTask={...this._projectExtentTask,task:null}}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(t,e){if(null==t)return e;const i=[],n=(t,e)=>null!=t?null!=e?t===e&&t:t:e;for(const s of t)for(const t of e){if(!s.spatialReference.equals(t.spatialReference))continue;const e=n(s.viewingMode,t.viewingMode);if(!1!==e){i.push({spatialReference:s.spatialReference,viewingMode:e});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(t){const e=this.defaultSpatialReference;return null==t||t.length<1?null!=e?{spatialReference:e,viewingMode:null}:null:(null!=e&&t.length>1&&t.some((({spatialReference:t})=>t.equals(e)))&&(t=t.filter((({spatialReference:t})=>t.equals(e)))),t.length>1&&t.some((({viewingMode:t})=>t!==az.Local))&&(t=t.filter((({viewingMode:t})=>t!==az.Local))),t[0])}_getSupportedSpatialReferences(t){const e="supportedSpatialReferences"in t&&t.supportedSpatialReferences||(t.spatialReference?[t.spatialReference]:[]);if(0===e.length)return[];const i=[];for(const n of e){const e=this.getSpatialReferenceSupport({spatialReference:n,layer:t});if(null!=e){const t=null!=e.constraints?e.constraints:[{spatialReference:n,viewingMode:null}];for(const{spatialReference:e,viewingMode:n}of t)this.requiresExtentInSpatialReference&&null!=this.userSpatialReference&&!e.equals(this.userSpatialReference)||i.push({spatialReference:e,viewingMode:n})}}return i}_pickExtentCandidate(t){const e=this.spatialReference;return t.find((({extent:t})=>e.equals(t.spatialReference)))||t[0]}_collectLayers(t){if("loaded"!==this._loadMaybe(this.map?.()))return{layers:[],updating:!0};const e=new pz;for(const i of t)if(this._collectCollection(i,e),e.preloading===this.sourcePreloadCount)break;return{layers:e.layers,updating:e.updating}}_collectCollection(t,e){if(t.layers){switch(this._loadMaybe(t.parent)){case"loading":return e.updating=!0,void++e.preloading;case"failed":return}for(const i of t.layers){switch(this._loadMaybe(i)){case"failed":continue;case"loading":e.updating=!0,++e.preloading;break;case"loaded":e.updating||e.layers.push(i),"layers"in i&&this._collectCollection({layers:i.layers},e)}if(e.preloading===this.sourcePreloadCount)break}}}_loadMaybe(t){return t&&"loadStatus"in t&&null!=t.loadStatus?"not-loaded"===t.loadStatus?(t.load().catch((t=>{Pi(t)||console.log(t)})),"loading"):t.loadStatus:"loaded"}};o([Us()],fz.prototype,"required",void 0),o([Us({constructOnly:!0})],fz.prototype,"map",void 0),o([Us({constructOnly:!0})],fz.prototype,"getSpatialReferenceSupport",void 0),o([Us()],fz.prototype,"defaultSpatialReference",void 0),o([Us()],fz.prototype,"userSpatialReference",void 0),o([Us()],fz.prototype,"sourcePreloadCount",void 0),o([Us()],fz.prototype,"priorityCollection",void 0),o([Us()],fz.prototype,"requiresExtentInSpatialReference",void 0),o([Us()],fz.prototype,"suspended",void 0),o([Us({readOnly:!0})],fz.prototype,"ready",null),o([Us({readOnly:!0})],fz.prototype,"heightModelInfoReady",null),o([Us({readOnly:!0})],fz.prototype,"spatialReference",null),o([Us({readOnly:!0})],fz.prototype,"extent",null),o([Us({readOnly:!0})],fz.prototype,"heightModelInfo",null),o([Us({readOnly:!0})],fz.prototype,"vcsWkid",null),o([Us({readOnly:!0})],fz.prototype,"latestVcsWkid",null),o([Us({readOnly:!0})],fz.prototype,"viewingMode",null),o([Us({readOnly:!0})],fz.prototype,"tileInfo",null),o([Us({readOnly:!0})],fz.prototype,"mapCollections",null),o([Us({readOnly:!0})],fz.prototype,"_allLayers",null),o([Us({readOnly:!0})],fz.prototype,"_spatialReferenceTask",null),o([Us({readOnly:!0})],fz.prototype,"_tileInfoTask",null),o([Us({readOnly:!0})],fz.prototype,"_heightModelInfoTask",null),o([Us({readOnly:!0})],fz.prototype,"_extentCandidatesTask",null),o([Us()],fz.prototype,"_extentTask",null),o([Us()],fz.prototype,"_projectExtentTask",void 0),fz=o([Nr("esri.views.support.DefaultsFromMap")],fz);class pz{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}}var mz;let yz=mz=class extends(Pm.EventedMixin(wM(Vr))){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new w,this.updatingHandles=new cS,this.allLayerViews=new dy({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:vz}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new RF,this.analyses=new mj,this.typeSpecificPreconditionsReady=!0,this.layerViews=new ty,this.magnifier=new GF,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new O$,this.navigation=new P$,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new r$(this),this.persistableViewModels=new ty,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this.theme=null,this.handles.add(fy((()=>this.preconditionsReady),(t=>{const e=this.ready;if(t?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,mz.views.add(this)):(this._lockedSpatialReference=null,mz.views.remove(this)),this.notifyChange("spatialReference"),!t&&e)this.toolViewManager?.detach(),null!=this.analysisViewManager&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(t&&!e){try{this._startup()}catch(t){return void queueMicrotask((()=>{console.error("View._startup failed",t),this.fatalError=new Qe("startup-error",null,t)}))}null!=this.analysisViewManager&&this.analysisViewManager.attach(),this.toolViewManager.attach()}}),xy))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then((()=>(this._isValid=!0,gy((()=>this.ready)))))),this.basemapView=new PF({view:this}),this.layerViewManager=new zF({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new M$({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new YD({view:this}),this.addHandles([fy((()=>this.initialExtentRequired),(t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t}),My),fy((()=>this.ready),(t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)}),xy),fy((()=>this._userSpatialReference),(t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)}),My)])}_setupSpatialReferenceLogger(){let t=null;this.addHandles([fy((()=>this.defaultsFromMap?.ready),(e=>{const i=this.map?.allLayers.length>0;if(e&&!this.spatialReference&&i){if(null!=t)return;const e=Zt((()=>t=Vt(t)));t=uy((async e=>{try{await Ui(this.spatialReferenceWarningDelay,null,e)}catch{return}finally{t=null}Ft.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})),this.addHandles(e,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")}),{sync:!0})])}destroy(){this.destroyed||(mz.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=$t(this.graphics),this.analyses=$t(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),$t(this.analysisViewManager),this.toolViewManager=$t(this.toolViewManager),this.layerViewManager=$t(this.layerViewManager),this.selectionManager=$t(this.selectionManager),this.basemapView=$t(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach((t=>t.destroy())),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=$t(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return Ft.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new fz({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:t=>this.getSpatialReferenceSupport(t),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||AM.isLoadable(this.map)&&!this.map.loaded||0===this.width||0===this.height||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t?.destroyed&&(Ft.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),AM.isLoadable(t)&&t.load().catch((()=>{})),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get spatialReference(){const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&this.defaultsFromMap?.required?.heightModelInfo){const e=t.clone();return e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,e}return t}set spatialReference(t){const e=!mh(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??pg}set timeZone(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map((t=>t.toLowerCase())));this._userTimeZone=t,t===pg||t===mg||e.has(t.toLowerCase())||i.has(t.toLowerCase())||Ft.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new XD}whenLayerView(t){return this.layerViewManager?.whenLayerView(t)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}importLayerView(t){throw new Qe("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return null!=this.getSpatialReferenceSupport({spatialReference:t})}when(t,e){return this.isResolved()&&!this.ready&&Ft.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(py((()=>this.destroyed||!1===this.preconditionsReady),(()=>this._readyCycleForced=!1),{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};yz.views=new ty,o([Us()],yz.prototype,"_userSpatialReference",void 0),o([Us()],yz.prototype,"activeTool",null),o([Us({readOnly:!0})],yz.prototype,"allLayerViews",void 0),o([Us()],yz.prototype,"groundView",void 0),o([Us()],yz.prototype,"animation",null),o([Us()],yz.prototype,"basemapView",void 0),o([Us()],yz.prototype,"center",null),o([Us({readOnly:!0})],yz.prototype,"_defaultsFromMapSettings",null),o([Us()],yz.prototype,"defaultsFromMap",null),o([Us()],yz.prototype,"fatalError",void 0),o([Us({type:Rf})],yz.prototype,"extent",null),o([Us(oj(RF,"graphics"))],yz.prototype,"graphics",void 0),o([Us(oj(mj,"analyses"))],yz.prototype,"analyses",void 0),o([Us({readOnly:!0,type:pj})],yz.prototype,"heightModelInfo",null),o([Us({readOnly:!0})],yz.prototype,"interacting",null),o([Us({readOnly:!0})],yz.prototype,"navigating",null),o([Us({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],yz.prototype,"preconditionsReady",null),o([Us({readOnly:!0})],yz.prototype,"typeSpecificPreconditionsReady",void 0),o([Us({type:ty,readOnly:!0})],yz.prototype,"layerViews",void 0),o([Us()],yz.prototype,"resolution",null),o([Us({type:GF})],yz.prototype,"magnifier",void 0),o([Us({value:null,type:ZI})],yz.prototype,"map",null),o([Us()],yz.prototype,"padding",void 0),o([Us({readOnly:!0})],yz.prototype,"ready",void 0),o([Us({type:jd})],yz.prototype,"spatialReference",null),o([Us()],yz.prototype,"spatialReferenceWarningDelay",void 0),o([Us()],yz.prototype,"stationary",null),o([Us({readOnly:!0})],yz.prototype,"supportsGround",void 0),o([Us({type:sj})],yz.prototype,"timeExtent",void 0),o([Us({type:String,nonNullable:!0})],yz.prototype,"timeZone",null),o([Us()],yz.prototype,"tools",null),o([Us()],yz.prototype,"toolViewManager",void 0),o([Us({readOnly:!0})],yz.prototype,"type",void 0),o([Us({type:Number})],yz.prototype,"scale",void 0),o([Us({readOnly:!0})],yz.prototype,"updating",void 0),o([Us({readOnly:!0})],yz.prototype,"initialExtentRequired",void 0),o([Us({readOnly:!0})],yz.prototype,"initialExtent",null),o([Us()],yz.prototype,"cursor",null),o([Us({readOnly:!0})],yz.prototype,"input",void 0),o([Us({type:P$,nonNullable:!0})],yz.prototype,"navigation",void 0),o([Us()],yz.prototype,"layerViewManager",void 0),o([Us()],yz.prototype,"analysisViewManager",void 0),o([Us()],yz.prototype,"selectionManager",void 0),o([Us()],yz.prototype,"width",void 0),o([Us()],yz.prototype,"height",void 0),o([Us({readOnly:!0})],yz.prototype,"resizing",void 0),o([Us({value:null,readOnly:!0})],yz.prototype,"size",null),o([Us({readOnly:!0})],yz.prototype,"suspended",void 0),o([Us({readOnly:!0})],yz.prototype,"viewEvents",void 0),o([Us({readOnly:!0})],yz.prototype,"persistableViewModels",void 0),o([Us()],yz.prototype,"_isValid",void 0),o([Us()],yz.prototype,"_readyCycleForced",void 0),o([Us()],yz.prototype,"_lockedSpatialReference",void 0),o([Us()],yz.prototype,"_userTimeZone",void 0),o([Us()],yz.prototype,"_lockedTimeZone",void 0),o([Us({type:XD})],yz.prototype,"theme",void 0),o([Us({readOnly:!0,type:XD})],yz.prototype,"effectiveTheme",null),yz=mz=o([Nr("esri.views.View")],yz);const gz=yz;function vz(t){return t.layerViews}let wz=class extends bM{constructor(t){super(t),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=Hi(),this.addResolvingPromise(this._resolver.promise)}get done(){return"finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._resolver?.reject(new Qe("ViewAnimation stopped")))}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._resolver?.resolve())}update(t,e){e||(e=Gi(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",e)}};o([Us({readOnly:!0})],wz.prototype,"done",null),o([Us({readOnly:!0,type:String})],wz.prototype,"state",void 0),o([Us()],wz.prototype,"target",void 0),wz=o([Nr("esri.views.ViewAnimation")],wz),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(wz||(wz={}));const bz=wz;function Sz(t,e,i,n){const s=3*t,r=3*(i-t)-s,o=1-s-r,a=3*e,l=3*(n-e)-a,u=1-a-l;function c(t){return((o*t+r)*t+s)*t}function h(t){return((u*t+l)*t+a)*t}function d(t){return(3*o*t+2*r)*t+s}function f(t,e){let i,n,s,r,o,a;for(s=t,a=0;a<8;a++){if(r=c(s)-t,Math.abs(r)<e)return s;if(o=d(s),Math.abs(o)<1e-6)break;s-=r/o}if(i=0,n=1,s=t,s<i)return i;if(s>n)return n;for(;i<n;){if(r=c(s),Math.abs(r-t)<e)return s;t>r?i=s:n=s,s=.5*(n-i)+i}return s}return function(t,e=1e-6){return h(f(t,e))}}const xz=/^cubic-bezier\((.*)\)/,_z={};function Mz(t){let e=_z[t]||null;if(!e){const i=xz.exec(t);if(i){const t=i[1].split(",").map((t=>parseFloat(t.trim())));4!==t.length||t.some((t=>isNaN(t)))||(e=Sz.apply(Sz,t))}}return e}_z.ease=Sz(.25,.1,.25,1),_z.linear=Sz(0,0,1,1),_z.easeIn=_z["ease-in"]=Sz(.42,0,1,1),_z.easeOut=_z["ease-out"]=Sz(0,0,.58,1),_z.easeInOut=_z["ease-in-out"]=Sz(.42,0,.58,1);function kz(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Tz(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Az(t,e,i,n,s,r,o){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=r,t[5]=o,t}function Iz(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5];let l=i*r-n*s;return l?(l=1/l,t[0]=r*l,t[1]=-n*l,t[2]=-s*l,t[3]=i*l,t[4]=(s*a-r*o)*l,t[5]=(n*o-i*a)*l,t):null}function jz(t){return t[0]*t[3]-t[1]*t[2]}function Cz(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1],h=i[2],d=i[3],f=i[4],p=i[5];return t[0]=n*u+r*c,t[1]=s*u+o*c,t[2]=n*h+r*d,t[3]=s*h+o*d,t[4]=n*f+r*p+a,t[5]=s*f+o*p+l,t}function Ez(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(i),c=Math.cos(i);return t[0]=n*c+r*u,t[1]=s*c+o*u,t[2]=n*-u+r*c,t[3]=s*-u+o*c,t[4]=a,t[5]=l,t}function Oz(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1];return t[0]=n*u,t[1]=s*u,t[2]=r*c,t[3]=o*c,t[4]=a,t[5]=l,t}function Lz(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1];return t[0]=n,t[1]=s,t[2]=r,t[3]=o,t[4]=n*u+r*c+a,t[5]=s*u+o*c+l,t}function Nz(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t[4]=0,t[5]=0,t}function Rz(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function Pz(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function Fz(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function Dz(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function $z(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t}function zz(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}function Uz(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t}function Vz(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t}function Gz(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Bz(t,e){const i=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],f=e[5],p=uo();return Math.abs(i-l)<=p*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-u)<=p*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(s-c)<=p*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(r-h)<=p*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=p*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-f)<=p*Math.max(1,Math.abs(a),Math.abs(f))}const qz=Cz,Hz=zz;Object.freeze(Object.defineProperty({__proto__:null,add:$z,copy:kz,determinant:jz,equals:Bz,exactEquals:Gz,frob:Dz,fromRotation:Nz,fromScaling:Rz,fromTranslation:Pz,identity:Tz,invert:Iz,mul:qz,multiply:Cz,multiplyScalar:Uz,multiplyScalarAndAdd:Vz,rotate:Ez,scale:Oz,set:Az,str:Fz,sub:Hz,subtract:zz,translate:Lz},Symbol.toStringTag,{value:"Module"}));function Wz(){return[1,0,0,1,0,0]}function Zz(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function Jz(t,e,i,n,s,r){return[t,e,i,n,s,r]}function Kz(t,e){return new Float64Array(t,e,6)}const Yz=Wz();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Yz,clone:Zz,create:Wz,createView:Kz,fromValues:Jz},Symbol.toStringTag,{value:"Module"}));function Qz(t,e){return t[0]=e[0],t[1]=e[1],t}function Xz(t,e,i){return t[0]=e,t[1]=i,t}function tU(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function eU(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function iU(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function nU(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function sU(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function rU(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function oU(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function aU(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function lU(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function uU(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function cU(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t}function hU(t,e){const i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)}function dU(t,e){const i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n}function fU(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function pU(t){const e=t[0],i=t[1];return e*e+i*i}function mU(t,e){return t[0]=-e[0],t[1]=-e[1],t}function yU(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function gU(t,e){const i=e[0],n=e[1];let s=i*i+n*n;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s),t}function vU(t,e){return t[0]*e[0]+t[1]*e[1]}function wU(t,e,i){const n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t}function bU(t,e,i,n){const s=e[0],r=e[1];return t[0]=s+n*(i[0]-s),t[1]=r+n*(i[1]-r),t}function SU(t,e){e=e||1;const i=2*ho()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function xU(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[2]*s,t[1]=i[1]*n+i[3]*s,t}function _U(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[2]*s+i[4],t[1]=i[1]*n+i[3]*s+i[5],t}function MU(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[3]*s+i[6],t[1]=i[1]*n+i[4]*s+i[7],t}function kU(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[4]*s+i[12],t[1]=i[1]*n+i[5]*s+i[13],t}function TU(t,e,i,n){const s=e[0]-i[0],r=e[1]-i[1],o=Math.sin(n),a=Math.cos(n);return t[0]=s*a-r*o+i[0],t[1]=s*o+r*a+i[1],t}function AU(t,e){const i=t[0],n=t[1],s=e[0],r=e[1];let o=i*i+n*n;o>0&&(o=1/Math.sqrt(o));let a=s*s+r*r;a>0&&(a=1/Math.sqrt(a));const l=(i*s+n*r)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function IU(t){return"vec2("+t[0]+", "+t[1]+")"}function jU(t,e){return t[0]===e[0]&&t[1]===e[1]}function CU(t,e){const i=t[0],n=t[1],s=e[0],r=e[1],o=uo();return Math.abs(i-s)<=o*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-r)<=o*Math.max(1,Math.abs(n),Math.abs(r))}function EU(t,e,i,n,s){let r=e[0]-i[0],o=e[1]-i[1];const a=(n[0]*r+n[1]*o)*(s-1);return r=n[0]*a,o=n[1]*a,t[0]=e[0]+r,t[1]=e[1]+o,t}const OU=fU,LU=eU,NU=iU,RU=nU,PU=hU,FU=dU,DU=pU;Object.freeze(Object.defineProperty({__proto__:null,add:tU,angle:AU,ceil:sU,copy:Qz,cross:wU,dist:PU,distance:hU,div:RU,divide:nU,dot:vU,equals:CU,exactEquals:jU,floor:rU,inverse:yU,len:OU,length:fU,lerp:bU,max:aU,min:oU,mul:NU,multiply:iU,negate:mU,normalize:gU,projectAndScale:EU,random:SU,rotate:TU,round:lU,scale:uU,scaleAndAdd:cU,set:Xz,sqrDist:FU,sqrLen:DU,squaredDistance:dU,squaredLength:pU,str:IU,sub:LU,subtract:eU,transformMat2:xU,transformMat2d:_U,transformMat3:MU,transformMat4:kU},Symbol.toStringTag,{value:"Module"}));function $U(){return[0,0]}function zU(t){return[t[0],t[1]]}function UU(t,e){return[t,e]}function VU(t,e=$U()){const i=Math.min(2,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function GU(t,e){return new Float64Array(t,e,2)}function BU(){return $U()}function qU(){return UU(1,1)}function HU(){return UU(1,0)}function WU(){return UU(0,1)}const ZU=BU(),JU=qU(),KU=HU(),YU=WU();Object.freeze(Object.defineProperty({__proto__:null,ONES:JU,UNIT_X:KU,UNIT_Y:YU,ZEROS:ZU,clone:zU,create:$U,createView:GU,fromArray:VU,fromValues:UU,ones:qU,unitX:HU,unitY:WU,zeros:BU},Symbol.toStringTag,{value:"Module"}));const QU={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new vm({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:jd.WebMercator}),minus180Line:new vm({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:jd.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new vm({paths:[[[180,-180],[180,180]]],spatialReference:jd.WGS84}),minus180Line:new vm({paths:[[[-180,-180],[-180,180]]],spatialReference:jd.WGS84})}};function XU(t,e){return Math.ceil((t-e)/(2*e))}function tV(t,e){const i=eV(t);for(const t of i)for(const i of t)i[0]+=e;return t}function eV(t){return km(t)?t.rings:t.paths}function iV(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function nV(t){return"string"==typeof t?Ul(t):ht(t)}function sV(t,e,i){const n={};for(const s in t){if("declaredClass"===s)continue;const r=t[s];if(null!=r&&"function"!=typeof r)if(Array.isArray(r))n[s]=r.map((t=>sV({item:t},e,i).item));else if("object"==typeof r)if(r.toJSON){const t=r.toJSON(i?.[s]);n[s]=e?t:JSON.stringify(t)}else n[s]=e?r:JSON.stringify(r);else n[s]=r}return n}async function rV(t,e,i,n){const s=nV(t),r=e[0].spatialReference,o={...n,responseType:"json",query:{...s.query,f:"json",sr:gh(r),target:JSON.stringify({geometryType:Am(e[0]),geometries:e}),cutter:JSON.stringify(i)}},a=await hc(s.path+"/cut",o),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map((t=>{const e=Tm(t);return e.spatialReference=r,e}))}}function oV(t){return{geometryType:Am(t[0]),geometries:t.map((t=>t.toJSON()))}}function aV(t,e,i){const n=jm(e);return t.map((t=>{const e=n.fromJSON(t);return e.spatialReference=i,e}))}async function lV(t,e,i){const n="string"==typeof t?Ul(t):t,s=e[0].spatialReference,r=Am(e[0]),o={...i,query:{...n.query,f:"json",sr:gh(s),geometries:JSON.stringify(oV(e))}},{data:a}=await hc(n.path+"/simplify",o);return aV(a.geometries,r,s)}const uV=()=>Ft.getLogger("esri.geometry.support.normalizeUtils");function cV(t){return"polygon"===t.type}function hV(t){return"polygon"===t[0].type}function dV(t){return"polyline"===t[0].type}function fV(t){const e=[];let i=0,n=0;for(let s=0;s<t.length;s++){const r=t[s];let o=null;for(let t=0;t<r.length;t++)o=r[t],e.push(o),0===t?(i=o[0],n=i):(i=Math.min(i,o[0]),n=Math.max(n,o[0]));o&&e.push([(i+n)/2,0])}return e}function pV(t,e){if(!(t instanceof vm||t instanceof pm)){const t="straightLineDensify: the input geometry is neither polyline nor polygon";throw uV().error(t),new Qe(t)}const i=eV(t),n=[];for(const t of i){const i=[];n.push(i),i.push([t[0][0],t[0][1]]);for(let n=0;n<t.length-1;n++){const s=t[n][0],r=t[n][1],o=t[n+1][0],a=t[n+1][1],l=Math.sqrt((o-s)*(o-s)+(a-r)*(a-r)),u=(a-r)/l,c=(o-s)/l,h=l/e;if(h>1){for(let t=1;t<=h-1;t++){const n=t*e,o=c*n+s,a=u*n+r;i.push([o,a])}const t=(l+Math.floor(h-1)*e)/2,n=c*t+s,o=u*t+r;i.push([n,o])}i.push([o,a])}}return cV(t)?new pm({rings:n,spatialReference:t.spatialReference}):new vm({paths:n,spatialReference:t.spatialReference})}function mV(t,e,i){if(e){const e=pV(t,1e6);t=Wd(e,!0)}return i&&(t=tV(t,i)),t}function yV(t,e,i){if(Array.isArray(t)){const n=t[0];if(n>e){const i=XU(n,e);t[0]=n+i*(-2*e)}else if(n<i){const e=XU(n,i);t[0]=n+e*(-2*i)}}else{const n=t.x;if(n>e){const i=XU(n,e);t=t.clone().offset(i*(-2*e),0)}else if(n<i){const e=XU(n,i);t=t.clone().offset(e*(-2*i),0)}}return t}function gV(t,e){let i=-1;for(let n=0;n<e.cutIndexes.length;n++){const s=e.cutIndexes[n],r=e.geometries[n],o=eV(r);for(let t=0;t<o.length;t++){const e=o[t];e.some((i=>{if(i[0]<180)return!0;{let i=0;for(let t=0;t<e.length;t++){const n=e[t][0];i=n>i?n:i}i=Number(i.toFixed(9));const n=-360*XU(i,180);for(let i=0;i<e.length;i++){const e=r.getPoint(t,i);r.setPoint(t,i,e.clone().offset(n,0))}return!0}}))}if(s===i){if(hV(t))for(const e of eV(r))t[s]=t[s].addRing(e);else if(dV(t))for(const e of eV(r))t[s]=t[s].addPath(e)}else i=s,t[s]=r}return t}async function vV(t,e,i){if(!Array.isArray(t))return vV([t],e);e&&"string"!=typeof e&&uV().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const n="string"==typeof e?e:e?.url??It.geometryServiceUrl;let s,r,o,a,l,u,c,h,d=0;const f=[],p=[];for(const e of t)if(null!=e)if(s||(s=e.spatialReference,r=yh(s),o=s.isWebMercator,u=o?102100:4326,a=QU[u].maxX,l=QU[u].minX,c=QU[u].plus180Line,h=QU[u].minus180Line),r)if("mesh"===e.type)p.push(e);else if("point"===e.type)p.push(yV(e.clone(),a,l));else if("multipoint"===e.type){const t=e.clone();t.points=t.points.map((t=>yV(t,a,l))),p.push(t)}else if("extent"===e.type){const t=e.clone()._normalize(!1,!1,r);p.push(t.rings?new pm(t):t)}else if(e.extent){const t=e.extent,i=XU(t.xmin,l)*(2*a);let n=0===i?e.clone():tV(e.clone(),i);t.offset(i,0),t.intersects(c)&&t.xmax!==a?(d=t.xmax>d?t.xmax:d,n=mV(n,o),f.push(n),p.push("cut")):t.intersects(h)&&t.xmin!==l?(d=t.xmax*(2*a)>d?t.xmax*(2*a):d,n=mV(n,o,360),f.push(n),p.push("cut")):p.push(n)}else p.push(e.clone());else p.push(e);else p.push(e);let m=XU(d,a),y=-90;const g=m,v=new vm;for(;m>0;){const t=360*m-180;v.addPath([[t,y],[t,-1*y]]),y*=-1,m--}if(f.length>0&&g>0){const e=gV(f,await rV(n,f,v,i)),s=[],r=[];for(let i=0;i<p.length;i++){const n=p[i];if("cut"!==n)r.push(n);else{const n=e.shift(),a=t[i];null!=a&&"polygon"===a.type&&a.rings&&a.rings.length>1&&n.rings.length>=a.rings.length?(s.push(n),r.push("simplify")):r.push(o?Hd(n):n)}}if(!s.length)return r;const a=await lV(n,s,i),l=[];for(let t=0;t<r.length;t++){const e=r[t];"simplify"!==e?l.push(e):l.push(o?Hd(a.shift()):a.shift())}return l}const w=[];for(let t=0;t<p.length;t++){const e=p[t];if("cut"!==e)w.push(e);else{const t=f.shift();w.push(!0===o?Hd(t):t)}}return w}function wV(t){if(!t)return null;const e=t.extent;if(!e)return null;const i=t.spatialReference&&yh(t.spatialReference);if(!i)return e;const[n,s]=i.valid,r=2*s,{width:o}=e;let a,{xmin:l,xmax:u}=e;if([l,u]=[u,l],"extent"===t.type||0===o||o<=s||o>r||l<n||u>s)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=fV(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=fV(t.paths);break;case"multipoint":a=t.points}const c=e.clone();for(let t=0;t<a.length;t++){let e=a[t][0];e<0?(e+=s,u=Math.max(e,u)):(e-=s,l=Math.min(e,l))}return c.xmin=l,c.xmax=u,c.width<o?(c.xmin-=s,c.xmax-=s,c):e}function bV(t,e,i){const n=yh(i);if(null==n)return t;const[s,r]=n.valid,o=2*r;let a=0,l=0;e>r?a=Math.ceil(Math.abs(e-r)/o):e<s&&(a=-Math.ceil(Math.abs(e-s)/o)),t>r?l=Math.ceil(Math.abs(t-r)/o):t<s&&(l=-Math.ceil(Math.abs(t-s)/o));let u=t+(a-l)*o;const c=u-e;return c>r?u-=o:c<s&&(u+=o),u}function SV(t,e){const i=yh(e);if(i){const[e,n]=i.valid,s=n-e;if(t<e)for(;t<e;)t+=s;if(t>n)for(;t>n;)t-=s}return t}const xV=96,_V=39.37,MV=180/Math.PI;function kV(t){return t.wkid?t:t.spatialReference||jd.WGS84}function TV(t,e){return e.type?Xz(t,e.x,e.y):Qz(t,e)}function AV(t){return hd(t)}function IV(t,e,i=0){let n=t.width,s=t.height;if(0!==i){const e=va(i),r=Math.abs(Math.cos(e)),o=Math.abs(Math.sin(e));n=t.width*r+t.height*o,s=t.width*o+t.height*r}const r=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(n/r,s/o)*GV(t.spatialReference)}async function jV(t,e,i,n){let s,r;if(!t)return null;if(Array.isArray(t)&&!t.length)return null;if(ty.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&"object"==typeof t[0]){const s=t.every((t=>"attributes"in t)),r=t.some((t=>!t.geometry));let o=t;if(s&&r&&e&&e.allLayerViews){const i=new Map;for(const e of t){const t=e.layer,n=i.get(t)||[],s=e.attributes[t.objectIdField];null!=s&&n.push(s),i.set(t,n)}const n=[];i.forEach(((t,i)=>{const s=e.allLayerViews.find((t=>t.layer.id===i.id));if(s&&"queryFeatures"in s){const e=i.createQuery();e.objectIds=t,e.returnGeometry=!0,n.push(s.queryFeatures(e))}}));const s=await Promise.all(n),r=[];for(const t of s)if(t&&t.features&&t.features.length)for(const e of t.features)null!=e.geometry&&r.push(e.geometry);o=r}for(const t of o)n=await jV(t,e,i,n);return n}if(Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])s=new Qd(t);else if(t instanceof Ed)s=t;else if("geometry"in t)if(t.geometry)s=t.geometry;else if(t.layer){const i=t.layer,n=e.allLayerViews.find((t=>t.layer.id===i.id));if(n&&"queryFeatures"in n){const e=i.createQuery();e.objectIds=[t.attributes[i.objectIdField]],e.returnGeometry=!0;const r=await n.queryFeatures(e);s=r?.features?.[0]?.geometry}}if(null==s)return null;switch(s.type){case"point":r=new Rf({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":r=wV(s);break;default:r=s.extent}if(!r)return null;pb()||Cb(r.spatialReference,i)||await vb();const o=wb(r,i);return o?n=n?n.union(o):o:null}function CV(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&null!=t.layer?.minScale&&null!=t.layer.maxScale){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,i=0;for(const n of t){const t=n.layer;t?.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,i=t.maxScale>i?t.maxScale:i)}return e&&i?{min:e,max:i}:null}}}function EV(t,e){return mh(kV(t),e)?t:wb(t,e)}async function OV(t,e){if(!t||!e)return new Nm({targetGeometry:new Qd,scale:0,rotation:0});let i=e.spatialReference;const{constraints:n,padding:s,viewpoint:r,size:o}=e,a=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let l=null;t instanceof Nm?l=t:t.viewpoint?l=t.viewpoint:t.target&&"esri.Viewpoint"===t.target.declaredClass&&(l=t.target);let u=null;l?.targetGeometry?u=l.targetGeometry:t instanceof Rf?u=t:(t||t&&("center"in t||"extent"in t||"target"in t))&&(u=await jV(t.center,e,i)||await jV(t.extent,e,i)||await jV(t.target,e,i)||await jV(t,e,i)),!u&&r?.targetGeometry?u=r.targetGeometry:!u&&e.extent&&(u=e.extent),i||(i=kV(e.spatialReference||e.extent||u)),pb()||mh(u.spatialReference,i)||Cb(u.spatialReference,i)||await vb();const c=EV(u,i),h="center"in c?c.center:c;!1!==e.pickClosestTarget&&"point"===h.type&&"point"===r.targetGeometry?.type&&(h.x=bV(h.x,r.targetGeometry.x,h.spatialReference));let d=0;l?d=l.rotation:t.hasOwnProperty("rotation")?d=t.rotation:r&&(d=r.rotation);let f=0;if(null!=l?.targetGeometry&&"point"===l.targetGeometry.type)f=l.scale;else if("scale"in t&&t.scale)f=t.scale;else if("zoom"in t&&-1!==t.zoom&&n&&n.effectiveLODs)f=n.zoomToScale(t.zoom);else if(Array.isArray(u)||"point"===u.type||"extent"===u.type&&0===u.width&&0===u.height){const t=EV(e.extent,i);f=null!=t?IV(t,a,d):e.extent?IV(e.extent,a,d):r.scale}else f=IV(EV(u.extent,i),a,d);const p=CV(t.target??t);p&&(p.min&&p.min<f?f=p.min:p.max&&p.max>f&&(f=p.max));let m=new Nm({targetGeometry:h,scale:f,rotation:d});return n&&(m=n.fit(m),n.constrainByGeometry(m),n.rotationEnabled||(m.rotation=r.rotation)),m}function LV(t,e){const i=t.targetGeometry,n=e.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function NV(t,e,i){return i?Xz(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):uU(t,e,.5)}const RV=function(){const t=$U();return function(e,i,n){const s=i.targetGeometry;TV(t,s);const r=.5*zV(i);return e.xmin=t[0]-r*n[0],e.ymin=t[1]-r*n[1],e.xmax=t[0]+r*n[0],e.ymax=t[1]+r*n[1],e.spatialReference=s.spatialReference,e}}();function PV(t,e,i,n,s){return QV(t,e,i.center),t.scale=IV(i,n),s?.constraints?.constrain(t),t}function FV(t,e,i,n){return HV(t,e,i,n),Iz(t,t)}const DV=function(){const t=$U();return function(e,i,n){return LU(e,BV(e,i),NV(t,i,n))}}(),$V=function(){const t=Wz(),e=$U();return function(i,n,s,r){const o=zV(n),a=VV(n);return Xz(e,o,o),Rz(t,e),Ez(t,t,a),Lz(t,t,DV(e,s,r)),Lz(t,t,[0,r.top-r.bottom]),Xz(i,t[4],t[5])}}();function zV(t){return t.scale*UV(t.targetGeometry)}function UV(t){return null!=t&&Ch(t.spatialReference)?1/(AV(t.spatialReference)*_V*xV):1}function VV(t){return mo(t.rotation)||0}function GV(t){return Ch(t)?AV(t)*_V*xV:1}function BV(t,e){return uU(t,e,.5)}const qV=function(){const t=$U(),e=$U(),i=$U();return function(n,s,r,o,a,l){return mU(t,s),uU(e,r,.5*l),Xz(i,1/o*l,-1/o*l),Pz(n,e),a&&Ez(n,n,a),Oz(n,n,i),Lz(n,n,t),n}}(),HV=function(){const t=$U();return function(e,i,n,s){const r=zV(i),o=VV(i);return TV(t,i.targetGeometry),qV(e,t,n,r,o,s)}}(),WV=function(){const t=$U();return function(e,i,n,s){const r=zV(i);return TV(t,i.targetGeometry),qV(e,t,n,r,0,s)}}();function ZV(t){const e=yh(t);return e?e.valid[1]-e.valid[0]:0}function JV(t,e){return Math.round(ZV(t)/e)}const KV=function(){const t=$U(),e=$U(),i=[0,0,0];return function(n,s,r){eU(t,n,s),gU(t,t),eU(e,n,r),gU(e,e),wU(i,t,e);let o=Math.acos(vU(t,e)/(fU(t)*fU(e)))*MV;return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),YV=function(){const t=$U();return function(e,i,n,s){const r=e.targetGeometry;return LV(e,i),$V(t,i,n,s),r.x+=t[0],r.y+=t[1],e}}(),QV=function(t,e,i){LV(t,e);const n=t.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,t},XV=function(){const t=$U();return function(e,i,n,s,r){r||(r="center"),LU(t,n,s),uU(t,t,.5);const o=t[0],a=t[1];switch(r){case"center":Xz(t,0,0);break;case"left":Xz(t,-o,0);break;case"top":Xz(t,0,a);break;case"right":Xz(t,o,0);break;case"bottom":Xz(t,0,-a);break;case"top-left":Xz(t,-o,a);break;case"bottom-left":Xz(t,-o,-a);break;case"top-right":Xz(t,o,a);break;case"bottom-right":Xz(t,o,-a)}return lG(e,i,t),e}}();function tG(t,e,i){return LV(t,e),t.rotation+=i,t}function eG(t,e,i){return LV(t,e),t.rotation=i,t}const iG=function(){const t=$U();return function(e,i,n,s,r){return LV(e,i),isNaN(n)||0===n||(oG(t,s,i,r),e.scale=i.scale*n,aG(t,t,e,r),lG(e,e,Xz(t,t[0]-s[0],s[1]-t[1]))),e}}();function nG(t,e,i){return LV(t,e),t.scale=i,t}const sG=function(){const t=$U();return function(e,i,n,s,r,o){return LV(e,i),isNaN(n)||0===n||(oG(t,r,i,o),e.scale=i.scale*n,e.rotation+=s,aG(t,t,e,o),lG(e,e,Xz(t,t[0]-r[0],r[1]-t[1]))),e}}(),rG=function(){const t=$U(),e=$U();return function(i,n,s,r,o,a,l){return DV(e,a,l),tU(t,o,e),r?sG(i,n,s,r,t,a):iG(i,n,s,t,a)}}(),oG=function(){const t=Wz();return function(e,i,n,s){return _U(e,i,FV(t,n,s,1))}}(),aG=function(){const t=Wz();return function(e,i,n,s){return _U(e,i,HV(t,n,s,1))}}(),lG=function(){const t=$U(),e=Wz();return function(i,n,s){LV(i,n);const r=zV(n),o=i.targetGeometry;return Nz(e,VV(n)),Oz(e,e,UU(r,r)),_U(t,s,e),o.x+=t[0],o.y+=t[1],i}}();class uG{constructor(t,e,i,n){const s=t.targetGeometry,r=e.targetGeometry;n?"string"==typeof n&&(n=Mz(n)||_z.ease):n=_z.ease,this.easing=n,this.duration=i,this.sCenterX=s.x,this.sCenterY=s.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=r.x,this.tCenterY=r.y,this.tScale=e.scale,this.tRotation=e.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(t,e){const i=this.easing(e);let n,s,r,o;e>=1?(n=this.tCenterX,s=this.tCenterY,r=this.tRotation,o=this.tScale):(n=this.sCenterX+i*this.dCenterX,s=this.sCenterY+i*this.dCenterY,r=this.sRotation+i*this.dRotation,o=this.sScale+i*this.dScale),t.targetGeometry.x=n,t.targetGeometry.y=s,t.scale=o,t.rotation=r}}let cG=class extends Vr{constructor(t){super(t),this._animation=null,this.updateFunction=null,this.duration=200,this.transition=null,this.easing=_z.ease,this.view=null,this.viewpoint=new Nm({targetGeometry:new Qd,scale:0,rotation:0}),this._updateTask=un({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask=Ut(this._updateTask)}get animation(){return this._animation}set animation(t){this._animation=t,this.view&&(this.view.animation=t)}animate(t,e,i){this.stop();const n=this.viewpoint;LV(n,e),this.transition=new uG(this.viewpoint,t.target,i?.duration||this.duration,i?.easing||this.easing);const s=()=>{this.animation===t&&this._updateTask&&("finished"===t.state&&(this.transition?.applyRatio(this.viewpoint,1),this.view?.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return t.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinous(t,e){this.stop(),this.updateFunction=e,this.viewpoint=t;const i=new bz({target:t.clone()}),n=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(t){const e=this.animation;if(e&&e.state!==bz.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime);else{const t=this.transition,e=(performance.now()-this._startTime)/t.duration,i=e>=1;t.applyRatio(this.viewpoint,e),i&&this.animation?.finish()}this.view?.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};o([Us()],cG.prototype,"duration",void 0),o([Us()],cG.prototype,"transition",void 0),o([Us()],cG.prototype,"easing",void 0),o([Us()],cG.prototype,"view",void 0),o([Us()],cG.prototype,"viewpoint",void 0),cG=o([Nr("esri.views.2d.AnimationManager")],cG);const hG=cG;class dG{constructor(t){this.view=t,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions)},this.update=()=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:t,graphicsView:e,labelManager:i,state:{id:n}}=this.view;t.forEach(this._updateLayerView,this),null!=i&&(i.lastUpdateId!==n&&(i.viewChange(),i.lastUpdateId=n),i.updateRequested&&i.processUpdate(this._updateParameters)),null!=e&&(e.lastUpdateId!==n&&(e.viewChange(),e.lastUpdateId=n),e.updateRequested&&e.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle?.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=fy((()=>t.stationary),(t=>{this.stationary=t,this.requestFrame()})),this._frameTaskHandle=un(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){if(!t.attached)return void this.requestUpdate();const e=this.view.state,i=t.lastUpdateId;null!=i&&(this.stationary||t.moving)||(t.moving=!0,t.moveStart()),i!==e.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=e.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&t.layerViews?.forEach(this._updateLayerView,this)}}let fG=class extends Vr{constructor(t){super(t),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(t,e){if(!t)return void Ft.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new bz;this.view.animation=i,await gy((()=>this.view.ready),e);const n={animate:!0,...e},{extent:s,spatialReference:r,size:o,viewpoint:a,constraints:l,padding:u,allLayerViews:c}=this.view,h=OV(t,{extent:s,spatialReference:r,size:o,viewpoint:a,constraints:l,padding:u,allLayerViews:c,pickClosestTarget:e?.pickClosestTarget??!0});return i?.update(h),this._gotoTask={},n.animate?this._gotoAnimated(h,n):this._gotoImmediate(h,n)}_gotoImmediate(t,e){const i=this._gotoTask,n=this.view.animation,s=t.then((t=>{if(Ii(e),i!==this._gotoTask)throw new Qe("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=n.target=t,n.finish()}));return this._cancellableGoTo(i,n,s,e)}_gotoAnimated(t,e){const i=this._gotoTask,n=this.view.animation;if(!n)return Promise.resolve();const s=t.then((t=>{if(Ii(e),i!==this._gotoTask)throw new Qe("view:goto-interrupted","Goto was interrupted");return n.update(t),this.view.animationManager.animate(n,this.view.viewpoint,e),n.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,n,s,e)}_cancellableGoTo(t,e,i,n){const s=()=>t===this._gotoTask;return Ri(i,n).finally((()=>{s()&&(e.done||e.stop())}))}};o([Us({constructOnly:!0})],fG.prototype,"view",void 0),fG=o([Nr("esri.views.2d.GoToManager")],fG);function pG(){return Promise.all([import("./p-fbd1822d.js"),import("./p-b5b3e033.js")])}const mG=()=>pG().then((()=>import("./p-534547fd.js"))),yG=()=>pG().then((()=>import("./p-cbdfd1da.js").then((function(t){return t.F})))),gG={"base-dynamic":()=>pG().then((()=>import("./p-fbd17ac9.js"))),"base-tile":mG,"bing-maps":mG,catalog:()=>pG().then((()=>import("./p-faa9894c.js"))),"catalog-dynamic-group":()=>pG().then((()=>import("./p-d0ccc087.js"))),"catalog-footprint":()=>pG().then((()=>import("./p-701104d2.js"))),csv:yG,"geo-rss":()=>pG().then((()=>import("./p-c3e537a0.js"))),feature:yG,geojson:yG,graphics:()=>pG().then((()=>import("./p-b6af8b0f.js"))),group:()=>pG().then((()=>import("./p-6d2b5254.js"))),imagery:()=>pG().then((()=>import("./p-dac42c02.js"))),"imagery-tile":()=>pG().then((()=>import("./p-d7e40fb9.js"))),kml:()=>pG().then((()=>import("./p-41ab6596.js"))),"knowledge-graph":()=>pG().then((()=>import("./p-1cfebbad.js"))),"link-chart":()=>pG().then((()=>import("./p-1cfebbad.js"))),"knowledge-graph-sublayer":yG,"map-image":()=>pG().then((()=>import("./p-e336c9c9.js"))),"map-notes":()=>pG().then((()=>import("./p-0afb476a.js"))),media:()=>pG().then((()=>import("./p-33934408.js"))),"ogc-feature":()=>pG().then((()=>import("./p-668a1d64.js"))),"open-street-map":mG,"oriented-imagery":yG,route:()=>pG().then((()=>import("./p-f711a8af.js"))),stream:()=>pG().then((()=>import("./p-465e4650.js"))),"subtype-group":()=>pG().then((()=>import("./p-5a76e0fd.js"))),tile:mG,"vector-tile":()=>pG().then((()=>import("./p-229103ed.js"))),video:()=>pG().then((()=>import("./p-c12ee8e2.js"))),wcs:()=>pG().then((()=>import("./p-d7e40fb9.js"))),"web-tile":mG,wfs:yG,wms:()=>pG().then((()=>import("./p-797c85fb.js"))),wmts:()=>pG().then((()=>import("./p-a8c8ec4a.js"))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function vG(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Qe(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const wG={hasLayerViewModule:t=>null!=gG[t.type],importLayerView:t=>{const e=gG[t.type];if(null==e)throw vG(t);return e(t)}};function bG(t,e){const{spatialReference:i}=e,n=[e.x,e.y];let s=Number.POSITIVE_INFINITY,r=0,o=0;const a=[0,0],l="extent"===t.type?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const t of l)for(let e=0;e<t.length-1;e++){Wf(a,n,t,e);const i=hU(n,a);i<s&&(s=i,r=a[0],o=a[1])}return{coordinate:new Qd({x:r,y:o,spatialReference:i}),distance:s}}var SG;let xG=SG=class extends(FI(Vr)){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(null==this.geometry||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return wb(this.geometry,this.spatialReference)}catch(t){return Ft.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(null==this.normalizedGeometry)return t;const i=t.targetGeometry;if("extent"===this.normalizedGeometry.type?nf(this.normalizedGeometry,i):uf(this.normalizedGeometry,i))return t;const{coordinate:n}=bG(this.normalizedGeometry,i);return n?(t.targetGeometry=n,t):t}clone(){return new SG({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};o([Us({constructOnly:!0})],xG.prototype,"geometry",void 0),o([Us({readOnly:!0})],xG.prototype,"normalizedGeometry",null),o([Us({constructOnly:!0})],xG.prototype,"spatialReference",void 0),xG=SG=o([Nr("esri.views.2d.constraints.GeometryConstraint")],xG);var _G;let MG=_G=class extends(FI(Vr)){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e?(this.rotationEnabled||(t.rotation=e.rotation),t):t}clone(){return new _G({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};o([Us()],MG.prototype,"enabled",void 0),o([Us()],MG.prototype,"rotationEnabled",void 0),MG=_G=o([Nr("esri.views.2d.constraints.RotationConstraint")],MG);const kG=MG;var TG;let AG=TG=class extends(FI(Vr)){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:n,minZoom:s,maxZoom:r}=this,o=-1,a=-1,l=!1,u=!1;if(0!==i&&0!==n&&i<n&&([i,n]=[n,i]),!e?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",n);e=e.map((t=>t.clone())),e.sort(((t,e)=>e.scale-t.scale)),e.forEach(((t,e)=>t.level=e));for(const s of e)!l&&i>0&&i>=s.scale&&(o=s.level,l=!0),!u&&n>0&&n>=s.scale&&(a=t?t.level:-1,u=!0),t=s;-1===s&&(s=0===i?0:o),-1===r&&(r=0===n?e.length-1:a),s=Math.max(s,0),s=Math.min(s,e.length-1),r=Math.max(r,0),r=Math.min(r,e.length-1),s>r&&([s,r]=[r,s]),i=e[s].scale,n=e[r].scale,e.splice(0,s),e.splice(r-s+1,e.length),e.forEach(((t,e)=>{this._lodByScale[t.scale]=t,this._scales[e]=t.scale})),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",r),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",n)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,n=this.effectiveMaxScale,s=t.targetGeometry,r=e&&e.targetGeometry,o=0!==n&&t.scale<n,a=0!==i&&t.scale>i;if(o||a){const o=a?i:n;if(e&&r){const i=(o-e.scale)/(t.scale-e.scale);s.x=r.x+(s.x-r.x)*i,s.y=r.y+(s.y-r.y)*i}t.scale=o}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.round(t-.5),n=Math.round(t);return e[n]+(n-t)*(e[i]-e[n])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,n;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(i=e[s],n=e[s+1],n===t){return s+this.effectiveMinZoom+1}if(i>t&&n<t){return s+this.effectiveMinZoom+1-(t-n)/(i-n)}}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new TG({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce(((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e),this._scales[0])),this._lodByScale[t].scale}};o([Us({readOnly:!0})],AG.prototype,"effectiveLODs",void 0),o([Us({readOnly:!0})],AG.prototype,"effectiveMinZoom",void 0),o([Us({readOnly:!0})],AG.prototype,"effectiveMaxZoom",void 0),o([Us({readOnly:!0})],AG.prototype,"effectiveMinScale",void 0),o([Us({readOnly:!0})],AG.prototype,"effectiveMaxScale",void 0),o([Us()],AG.prototype,"lods",void 0),o([Us()],AG.prototype,"minZoom",void 0),o([Us()],AG.prototype,"maxZoom",void 0),o([Us()],AG.prototype,"minScale",void 0),o([Us()],AG.prototype,"maxScale",void 0),o([Us()],AG.prototype,"snapToZoom",void 0),AG=TG=o([Nr("esri.views.2d.constraints.ZoomConstraint")],AG);const IG=AG;const jG={base:null,key:"type",typeMap:{extent:Rf,polygon:pm}};let CG=class extends Vr{constructor(t){super(t),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new ty}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(t){t?this._set("geometry",t):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const t=this._get("_geometry");return t&&this.geometry===t.geometry&&this.view?.constraintsInfo.spatialReference===t.spatialReference?t:new xG({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new kG({rotationEnabled:this.rotationEnabled})}get _zoom(){const t=this._get("_zoom"),e=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,n=this.maxZoom,s=this.minScale,r=this.maxScale,o=this.snapToZoom;return t&&t.lods===e&&t.minZoom===i&&t.maxZoom===n&&t.minScale===s&&t.maxScale===r&&t.snapToZoom===o?t:new IG({lods:e,minZoom:i,maxZoom:n,minScale:s,maxScale:r,snapToZoom:o})}canZoomInTo(t){const e=this.effectiveMaxScale;return 0===e||t>=e}canZoomOutTo(t){const e=this.effectiveMinScale;return 0===e||t<=e}constrain(t,e){return this._zoom.constrain(t,e),this._rotation.constrain(t,e),this._geometry.constrain(t,e),this.customConstraints.forEach((i=>i.constrain(t,e))),t}constrainByGeometry(t){return this._geometry.constrain(t),this.customConstraints.forEach((e=>e.applyPanConstraint?.(t))),t}fit(t){return this._zoom.fit(t)}zoomToScale(t){return this._zoom.zoomToScale(t)}scaleToZoom(t){return this._zoom.scaleToZoom(t)}snapScale(t){return this._zoom.snapToClosestScale(t)}snapToNextScale(t){return this._zoom.snapToNextScale(t)}snapToPreviousScale(t){return this._zoom.snapToPreviousScale(t)}};o([Us({readOnly:!0})],CG.prototype,"effectiveLODs",null),o([Us({readOnly:!0})],CG.prototype,"effectiveMinScale",null),o([Us({readOnly:!0})],CG.prototype,"effectiveMaxScale",null),o([Us({readOnly:!0})],CG.prototype,"effectiveMinZoom",null),o([Us({readOnly:!0})],CG.prototype,"effectiveMaxZoom",null),o([Us({types:jG,value:null})],CG.prototype,"geometry",null),o([Us({type:[Jb]})],CG.prototype,"lods",void 0),o([Us()],CG.prototype,"minScale",void 0),o([Us()],CG.prototype,"maxScale",void 0),o([Us()],CG.prototype,"minZoom",void 0),o([Us()],CG.prototype,"maxZoom",void 0),o([Us()],CG.prototype,"rotationEnabled",void 0),o([Us()],CG.prototype,"snapToZoom",void 0),o([Us({type:ty})],CG.prototype,"customConstraints",void 0),o([Us()],CG.prototype,"view",void 0),o([Us({readOnly:!0})],CG.prototype,"version",null),o([Us({type:xG,readOnly:!0})],CG.prototype,"_geometry",null),o([Us({type:kG})],CG.prototype,"_rotation",null),o([Us({readOnly:!0,type:IG})],CG.prototype,"_zoom",null),CG=o([Nr("esri.views.2d.MapViewConstraints")],CG);const EG=CG;class OG{static getId(t,e,i,n){return"object"==typeof t?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${e}/${i}/${n}`}constructor(t,e,i,n){this.set(t,e,i,n)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(t){this.set(t)}get hash(){const t=4095&this.row,e=4095&this.col,i=63&this.level;return(3&this.world)<<30|e<<22|t<<8|i}acquire(t,e,i,n){this.set(t,e,i,n)}contains(t){const e=t.level-this.level;return e>=0&&this.row===t.row>>e&&this.col===t.col>>e&&this.world===t.world}containsChild(t){const e=t.level-this.level;return e>0&&this.row===t.row>>e&&this.col===t.col>>e&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new OG(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(t,e,i,n){if(null==t)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof t)this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if("string"==typeof t){const[e,i,n,s]=t.split("/");this.level=parseFloat(e),this.row=parseFloat(i),this.col=parseFloat(n),this.world=parseFloat(s)}else this.level=+t,this.row=+e,this.col=+i,this.world=+n||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new OG(this.level-1,this.row>>1,this.col>>1,this.world)}getNeighborId(t,e){return`${this.level}/${this.row+e}/${this.col+t}/${this.world}`}getChildKeys(){const t=this.level+1,e=this.row<<1,i=this.col<<1,n=this.world;return[new OG(t,e,i,n),new OG(t,e,i+1,n),new OG(t,e+1,i,n),new OG(t,e+1,i+1,n)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}}OG.pool=new ve(OG,null,null,25,50);function LG(t,e){return[t,e]}function NG(t,e,i){return t[0]=e,t[1]=i,t}function RG(t,e,i,n,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t}const PG=new OG("0/0/0/0");class FG{static create(t,e,i=null){const n=yh(t.spatialReference),s=e.origin||LG(t.origin.x,t.origin.y),r=LG(t.size[0]*e.resolution,t.size[1]*e.resolution),o=LG(-1/0,-1/0),a=LG(1/0,1/0),l=LG(1/0,1/0);null!=i&&(NG(o,Math.max(0,Math.floor((i.xmin-s[0])/r[0])),Math.max(0,Math.floor((s[1]-i.ymax)/r[1]))),NG(a,Math.max(0,Math.floor((i.xmax-s[0])/r[0])),Math.max(0,Math.floor((s[1]-i.ymin)/r[1]))),NG(l,a[0]-o[0]+1,a[1]-o[1]+1));const{cols:u,rows:c}=e;let h,d,f,p;return!i&&u&&c&&(NG(o,u[0],c[0]),NG(a,u[1],c[1]),NG(l,u[1]-u[0]+1,c[1]-c[0]+1)),t.isWrappable?(h=LG(Math.ceil(Math.round((n.valid[1]-n.valid[0])/e.resolution)/t.size[0]),l[1]),d=LG(Math.floor((n.origin[0]-s[0])/r[0]),o[1]),f=LG(h[0]+d[0]-1,a[1]),p=!0):(d=o,f=a,h=l,p=!1),new FG(e.level,e.resolution,e.scale,s,o,a,l,r,d,f,h,p)}constructor(t,e,i,n,s,r,o,a,l,u,c,h){this.level=t,this.resolution=e,this.scale=i,this.origin=n,this.first=s,this.last=r,this.size=o,this.norm=a,this.worldStart=l,this.worldEnd=u,this.worldSize=c,this.wrap=h}normalizeCol(t){if(!this.wrap)return t;const e=this.worldSize[0];return t<0?e-1-Math.abs((t+1)%e):t%e}denormalizeCol(t,e){return this.wrap?this.worldSize[0]*e+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return(t-this.origin[0])/this.norm[0]}getXForColumn(t){return this.origin[0]+t*this.norm[0]}getRowForY(t){return(this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,e,i=!1){PG.set(e);const n=i?PG.col:this.denormalizeCol(PG.col,PG.world),s=PG.row;return RG(t,this.getXForColumn(n),this.getYForRow(s+1),this.getXForColumn(n+1),this.getYForRow(s)),t}getTileCoords(t,e,i=!1){PG.set(e);const n=i?PG.col:this.denormalizeCol(PG.col,PG.world);return Array.isArray(t)?NG(t,this.getXForColumn(n),this.getYForRow(PG.row)):(t.x=this.getXForColumn(n),t.y=this.getYForRow(PG.row)),t}}class DG{constructor(){this.spans=[]}acquire(t){this.lodInfo=t}release(){this.lodInfo=null,this.spans.length=0}*keys(){const t=this.lodInfo;for(const{row:e,colFrom:i,colTo:n}of this.spans)for(let s=i;s<=n;s++){const i=t.getWorldForColumn(s);yield new OG(t.level,e,t.normalizeCol(s),i)}}forEach(t,e){const{spans:i,lodInfo:n}=this,{level:s}=n;if(0!==i.length)for(const{row:r,colFrom:o,colTo:a}of i)for(let i=o;i<=a;i++)t.call(e,s,r,n.normalizeCol(i),n.getWorldForColumn(i))}}DG.pool=new ve(DG);class $G{constructor(t,e,i){this.row=t,this.colFrom=e,this.colTo=i}}const zG=new OG("0/0/0/0");class UG{static create(t,e){t[1]>e[1]&&([t,e]=[e,t]);const[i,n]=t,[s,r]=e,o=s-i,a=r-n,l=0!==a?o/a:0,u=(Math.ceil(n)-n)*l,c=(Math.floor(n)-n)*l;return new UG(i,Math.floor(n),Math.ceil(r),l,o<0?u:c,o<0?c:u,o<0?s:i,o<0?i:s)}constructor(t,e,i,n,s,r,o,a){this.x=t,this.ymin=e,this.ymax=i,this.invM=n,this.leftAdjust=s,this.rightAdjust=r,this.leftBound=o,this.rightBound=a}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}}const VG=[[0,0],[0,0],[0,0],[0,0]],GG=1e-6;class BG{constructor(t,e=null,i=t.lods[0].level,n=t.lods[t.lods.length-1].level){this.tileInfo=t,this.fullExtent=e,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=t.lods.filter((t=>t.level>=i&&t.level<=n));this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const r=this._lodInfos=s.map((i=>FG.create(t,i,e)));s.forEach(((t,e)=>{this._infoByLevel[t.level]=r[e],this._infoByScale[t.scale]=r[e],this.scales[e]=t.scale}),this),this._wrap=t.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(t){return this._infoByLevel["number"==typeof t?t:t.level]}getTileBounds(t,e,i=!1){zG.set(e);const n=this._infoByLevel[zG.level];return n?n.getTileBounds(t,zG,i):t}getTileCoords(t,e,i=!1){zG.set(e);const n=this._infoByLevel[zG.level];return n?n.getTileCoords(t,zG,i):t}getTileCoverage(t,e=192,i=!0,n="closest"){if(!i&&(t.scale>this.minScale||t.scale<this.maxScale))return null;const s="closest"===n?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),r=DG.pool.acquire(s),o=this._wrap;let a,l,u,c=1/0,h=-1/0;const d=r.spans;VG[0][0]=VG[0][1]=VG[1][1]=VG[3][0]=-e,VG[1][0]=VG[2][0]=t.size[0]+e,VG[2][1]=VG[3][1]=t.size[1]+e;for(const e of VG)t.toMap(e,e),e[0]=s.getColumnForX(e[0]),e[1]=s.getRowForY(e[1]);const f=[];let p=3;for(let t=0;t<4;t++){if(VG[t][1]===VG[p][1]){p=t;continue}const e=UG.create(VG[t],VG[p]);c=Math.min(e.ymin,c),h=Math.max(e.ymax,h),void 0===f[e.ymin]&&(f[e.ymin]=[]),f[e.ymin].push(e),p=t}if(null==c||null==h||h-c>100)return null;let m=[];for(a=c;a<h;){null!=f[a]&&(m=m.concat(f[a])),l=1/0,u=-1/0;for(let t=m.length-1;t>=0;t--){const e=m[t];l=Math.min(l,e.getLeftCol()),u=Math.max(u,e.getRightCol())}if(l=Math.floor(l),u=Math.floor(u),a>=s.first[1]&&a<=s.last[1])if(o)if(s.size[0]<s.worldSize[0]){const t=Math.floor(u/s.worldSize[0]);for(let e=Math.floor(l/s.worldSize[0]);e<=t;e++)d.push(new $G(a,Math.max(s.getFirstColumnForWorld(e),l),Math.min(s.getLastColumnForWorld(e),u)))}else d.push(new $G(a,l,u));else l>s.last[0]||u<s.first[0]||(l=Math.max(l,s.first[0]),u=Math.min(u,s.last[0]),d.push(new $G(a,l,u)));a+=1;for(let t=m.length-1;t>=0;t--){const e=m[t];e.ymax>=a?e.incrRow():m.splice(t,1)}}return r}getTileParentId(t){zG.set(t);const e=this._infoByLevel[zG.level],i=this._lodInfos.indexOf(e)-1;return i<0?null:(this._getTileIdAtLOD(zG,this._lodInfos[i],zG),zG.id)}getTileResolution(t){const e=this._infoByLevel["object"==typeof t?t.level:t];return e?e.resolution:-1}getTileScale(t){const e=this._infoByLevel[t.level];return e?e.scale:-1}intersects(t,e){zG.set(e);const i=this._infoByLevel[zG.level],n=t.lodInfo;if(n.resolution>i.resolution){this._getTileIdAtLOD(zG,n,zG);const e=n.denormalizeCol(zG.col,zG.world);for(const i of t.spans)if(i.row===zG.row&&i.colFrom<=e&&i.colTo>=e)return!0}if(n.resolution<i.resolution){const[e,s,r,o]=t.spans.reduce(((t,e)=>(t[0]=Math.min(t[0],e.row),t[1]=Math.max(t[1],e.row),t[2]=Math.min(t[2],e.colFrom),t[3]=Math.max(t[3],e.colTo),t)),[1/0,-1/0,1/0,-1/0]),a=i.denormalizeCol(zG.col,zG.world),l=n.getColumnForX(i.getXForColumn(a)),u=n.getRowForY(i.getYForRow(zG.row)),c=n.getColumnForX(i.getXForColumn(a+1))-1,h=n.getRowForY(i.getYForRow(zG.row+1))-1;return!(l>o||c<r||u>s||h<e)}const s=n.denormalizeCol(zG.col,zG.world);return t.spans.some((t=>t.row===zG.row&&t.colFrom<=s&&t.colTo>=s))}normalizeBounds(t,e,i){if(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this._wrap){const e=yh(this.tileInfo.spatialReference),n=-i*(e.valid[1]-e.valid[0]);t[0]+=n,t[2]+=n}return t}getSmallestInfoForScale(t){const e=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>e[0])return this._infoByScale[e[0]];for(let i=1;i<e.length-1;i++)if(t>e[i]+GG)return this._infoByScale[e[i-1]];return this._infoByScale[e[e.length-1]]}getClosestInfoForScale(t){const e=this.scales;return this._infoByScale[t]||(t=e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e),e[0])),this._infoByScale[t]}scaleToLevel(t){const e=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(let i=e.length-1;i>=0;i--)if(t<e[i]){if(i===e.length-1)return this._infoByScale[e[e.length-1]].level;return this._infoByScale[e[i]].level+(e[i]-t)/(e[i]-e[i+1])}return this._infoByScale[e[0]].level}scaleToZoom(t){return this.tileInfo.scaleToZoom(t)}_getTileIdAtLOD(t,e,i){const n=this._infoByLevel[i.level];return t.set(i),e.resolution<n.resolution?null:(e.resolution===n.resolution||(t.level=e.level,t.col=Math.floor(i.col*n.resolution/e.resolution+.01),t.row=Math.floor(i.row*n.resolution/e.resolution+.01)),t)}}class qG{constructor(t,e){this.item=t,this.controller=e,this.promise=null}}class HG{constructor(t){this._schedule=null,this._task=null,this._deferreds=new BF,this._controllers=new BF,this._processingItems=new BF,this._pausedSignal=eM(!1),this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new ky(t.peeker),this.process=t.process;const e=t.scheduler;t.priority&&e&&(this._task=e.registerTask(t.priority,this))}destroy(){this.clear(),this._schedule=Ut(this._schedule),this._task=Ut(this._task)}get updating(){return!!this._task?.updating||this.running}get length(){return this._processingItems.size+this._queue.length}abort(t){const e=this._controllers.get(t);e&&e.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach((e=>t.push(e))),this._controllers.clear(),t.forEach((t=>t.abort())),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach(((e,i)=>t(i)))}get(t){const e=this._deferreds.get(t);return e?e.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(t,e){const i=this.get(t);if(i)return i;const n=new AbortController;let s=null;e&&(s=Li(e,(()=>n.abort())));const r=()=>{const e=this._processingItems.get(t);e&&e.controller.abort(),o(),l.reject(Ai())},o=()=>{a.remove(),null!=s&&s.remove(),this._removeItem(t),this._queue.remove(t),this._scheduleNext()},a=Ni(n.signal,r),l=Hi();return this._deferreds.set(t,l),this._controllers.set(t,n),l.promise.then(o,o),this._queue.push(t),this._scheduleNext(),l.promise}last(){return this._queue.last()}lastPromise(){const t=this.last();return t?this.get(t):null}peek(){return this._queue.peek()}popLast(){const t=this._queue.popLast();return t&&(this._deferreds.get(t)?.reject(Ai("Removed from queue")),this._removeItem(t)),t}reset(){const t=[];this._processingItems.forEach((e=>t.push(e))),this._processingItems.clear();for(const e of t)this._queue.push(e.item),e.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(t){for(;!t.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),t.madeProgress()}_removeItem(t){this._deferreds.delete(t),this._controllers.delete(t),this._processingItems.delete(t)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=ln((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(e))}_processError(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(e))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(null==t)return;let e;const i=new AbortController,n=new qG(t,i);this._processingItems.set(t,n);try{e=this.process(t,i.signal)}catch(t){this._processError(n,t)}Gi(e)?(n.promise=e,e.then((t=>this._processResult(n,t)),(t=>this._processError(n,t)))):this._processResult(n,e)}get test(){return{update:t=>this.runTask(t)}}}function WG(t,e){return t.length=0,e.forEach((e=>t.push(e))),t}const ZG=new Set,JG=[],KG=new Map,YG=[0,0];let QG=class extends Vr{constructor(t){super(t),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:t,process:e,strategy:i}=this;this._queue=new HG({concurrency:t,process:(t,i)=>{const n=this._keyToItem.get(t);return e(n,{signal:i})},peeker:"scale-first"===i?t=>this._peekByScaleFirst(t):t=>this._peekByCenterFirst(t)})}destroy(){this.clear(),this._queue=$t(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}abort(t){const e="string"==typeof t?t:t.id;this._queue.abort(e)}clear(){this._queue.clear(),this._keyToItem.clear()}has(t){return"string"==typeof t?this._keyToItem.has(t):this._keyToItem.has(t.id)}isOngoing(t){const e="string"==typeof t?t:t.id;return this.has(e)&&this._queue.isOngoing(e)}pause(){this._queue.pause()}push(t){const e=t.key.id;if(this._queue.has(e))return this._queue.get(e);const i=this._queue.push(e),n=()=>{this._keyToItem.delete(e)};return this._keyToItem.set(e,t),i.then(n,n),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView;let i=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;t.forEach((t=>{const e=this._keyToItem.get(t),s=this.tileInfoView.getTileScale(e.key);KG.has(s)||(KG.set(s,[]),i=Math.max(s,i),n=Math.min(s,n)),KG.get(s).push(e.key),ZG.add(s)}));let s=this.state.scale;KG.has(s)||(WG(JG,ZG),JG.sort(((t,e)=>t-e)),s=JG.reduce(((t,e)=>Math.abs(e-s)<Math.abs(t-s)?e:t),JG[0])),s=Math.min(s,i),s=Math.max(s,n);const r=KG.get(s),o=e.getClosestInfoForScale(s),a=o.getColumnForX(this.state.center[0]),l=o.getRowForY(this.state.center[1]);return r.sort(((t,e)=>{const i=o.denormalizeCol(t.col,t.world),n=o.denormalizeCol(e.col,e.world);return Math.sqrt((a-i)*(a-i)+(l-t.row)*(l-t.row))-Math.sqrt((a-n)*(a-n)+(l-e.row)*(l-e.row))})),ZG.clear(),KG.clear(),r[0].id}_peekByCenterFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView,i=this.state.center;let n,s=Number.POSITIVE_INFINITY;return t.forEach((t=>{const r=this._keyToItem.get(t);e.getTileCoords(YG,r.key);const o=hU(YG,i);o<s&&(s=o,n=r.key)})),n.id}};o([Us({constructOnly:!0})],QG.prototype,"concurrency",void 0),o([Us({constructOnly:!0})],QG.prototype,"process",void 0),o([Us()],QG.prototype,"state",void 0),o([Us({constructOnly:!0})],QG.prototype,"strategy",void 0),o([Us({constructOnly:!0})],QG.prototype,"tileInfoView",void 0),QG=o([Nr("esri.views.2d.tiling.TileQueue")],QG);const XG=QG;class tB{constructor(t,e,i){this.maxSize=t,this._tileInfoView=e,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(t){return this._tilePerId.has(t)}get(t){return this._tilePerId.get(t)}pop(t){const e=this._tilePerId.get(t);if(!e)return;const i=e.key.level,n=this._tileKeysPerLevel[i];eB(this._tilePerId,t);for(let e=0;e<n.length;e++)if(n[e].id===t){n.splice(e,1);break}return e.visible=!0,e}add(t){t.visible=!1;const e=t.key,i=e.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,t);const n=e.level;this._tileKeysPerLevel[n]||(this._tileKeysPerLevel[n]=[]),this._tileKeysPerLevel[n].push(e)}prune(t,e,i){let n=this._tilePerId.size;if(n<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;n>this.maxSize&&s>=0;)s!==t&&(n=this._pruneAroundCenterTile(n,e,i,s)),s--;n>this.maxSize&&(n=this._pruneAroundCenterTile(n,e,i,t))}_pruneAroundCenterTile(t,e,i,n){const s=this._tileKeysPerLevel[n];if(!s||0===s.length)return t;const{size:r,origin:o}=this._tileInfoView.tileInfo,a=i*r[0],l=i*r[1],u=[0,0],c=[0,0];for(s.sort(((t,i)=>(u[0]=o.x+a*(t.col+.5),u[1]=o.y-l*(t.row+.5),c[0]=o.x+a*(i.col+.5),c[1]=o.y-l*(i.row+.5),dU(u,e)-dU(c,e))));s.length>0;){const e=s.pop();if(this._removeTile(e.id),--t===this.maxSize)break}return t}_removeTile(t){const e=this._tilePerId.get(t);this._removedFunc&&e&&this._removedFunc(e),eB(this._tilePerId,t)}}function eB(t,e){t.delete(e)}const iB=new OG(0,0,0,0),nB=new Map,sB=[],rB=[];class oB{constructor(t){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,null!=t.resampling&&(this.resampling=t.resampling),t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),null!=t.buffer&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new tB(t.cacheSize,this.tileInfoView,(t=>{this.releaseTile(t)})))}destroy(){this.tileIndex.clear()}update(t){const{resampling:e,tileIndex:i}=this,{scale:n,center:s,resolution:r}=t.state,{minScale:o,maxScale:a}=this.tileInfoView,l=!t.stationary&&n>this._previousScale;if(this._previousScale=n,!e&&(n>o||n<a))return this.tiles.length=0,void this.clear();const u=this.tileInfoView.getTileCoverage(t.state,this.buffer,this.resampling,this.coveragePolicy);if(!u)return this.tiles.length=0,void this.clear();const{spans:c,lodInfo:h}=u,{level:d}=h;this.tiles.length=0,i.forEach((t=>t.visible=!0));let f=0,p=0;if(c.length>0)for(const{row:t,colFrom:e,colTo:n}of c)for(let s=e;s<=n;s++){f++;const e=iB.set(d,t,h.normalizeCol(s),h.getWorldForColumn(s)).id;let n=i.get(e);if(n)n.isReady?(nB.set(e,n),p++):l||this._addParentTile(e,nB);else{if(this._tileCache?.has(e)){if(n=this._tileCache.pop(e),this.tileIndex.set(e,n),n.isReady){nB.set(e,n),p++;continue}}else n=this.acquireTile(iB),this.tileIndex.set(e,n);l||this._addParentTile(e,nB)}}const m=p===f;for(const[t,e]of i){if(nB.has(t))continue;iB.set(t);const i=this.tileInfoView.intersects(u,iB),n="purge"===this.cachePolicy?iB.level!==d:iB.level>d;!i||!l&&m?!n&&i||sB.push(e):e.isReady?n&&"purge"===this.cachePolicy&&this._hasReadyAncestor(iB,d)?sB.push(e):rB.push(e):n&&sB.push(e)}for(const t of rB)t.isReady&&nB.set(t.key.id,t);for(const t of sB)this._tileCache?this._tileCache.add(t):this.releaseTile(t),i.delete(t.key.id);for(const t of nB.values())this.tiles.push(t);for(const t of i.values())nB.has(t.key.id)||(t.visible=!1);this._tileCache?.prune(d,s,r),DG.pool.release(u),rB.length=0,sB.length=0,nB.clear()}clear(){const{tileIndex:t}=this;for(const e of t.values())this.releaseTile(e);t.clear()}refresh(t){for(const e of this.tileIndex.values())this.tiles.includes(e)?t(e):sB.push(e);for(const t of sB)this.releaseTile(t),this.tileIndex.delete(t.key.id);this._tileCache?.clear()}updateCacheSize(t){this._tileCache&&(this._tileCache.maxSize=t)}_addParentTile(t,e){let i=t,n=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(n=this.tileIndex.get(i),n?.isReady){e.has(n.key.id)||e.set(n.key.id,n);break}}else if(this._tileCache?.has(i)&&(n=this._tileCache.pop(i),this.tileIndex.set(i,n),n?.isReady)){e.has(n.key.id)||e.set(n.key.id,n);break}}_hasReadyAncestor(t,e){const i=pp();this.tileInfoView.getTileBounds(i,t,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=e&&n.key.level<t.level){const t=pp();if(this.tileInfoView.getTileBounds(t,n.key,!0),Ip(t,i))return!0}return!1}}function aB(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function lB(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function uB(t,e,i,n,s,r){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=i,o[3]=n,o[4]=s,o[5]=r,o}function cB(t,e){return new Float32Array(t,e,6)}function hB(t,e,i,n){const s=e[n],r=e[n+1];t[n]=i[0]*s+i[2]*r+i[4],t[n+1]=i[1]*s+i[3]*r+i[5]}function dB(t,e,i,n=0,s=0,r=2){const o=s||e.length/r;for(let s=n;s<o;s++){hB(t,e,i,s*r)}}Object.freeze(Object.defineProperty({__proto__:null,clone:lB,create:aB,createView:cB,fromValues:uB,transform:hB,transformMany:dB},Symbol.toStringTag,{value:"Module"}));function fB(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function pB(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function mB(t,e,i,n,s,r,o,a,l,u){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t}function yB(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function gB(t,e){if(t===e){const i=e[1],n=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function vB(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=-c*r+a*l,f=u*r-o*l;let p=i*h+n*d+s*f;return p?(p=1/p,t[0]=h*p,t[1]=(-c*n+s*u)*p,t[2]=(a*n-s*o)*p,t[3]=d*p,t[4]=(c*i-s*l)*p,t[5]=(-a*i+s*r)*p,t[6]=f*p,t[7]=(-u*i+n*l)*p,t[8]=(o*i-n*r)*p,t):null}function wB(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=o*c-a*u,t[1]=s*u-n*c,t[2]=n*a-s*o,t[3]=a*l-r*c,t[4]=i*c-s*l,t[5]=s*r-i*a,t[6]=r*u-o*l,t[7]=n*l-i*u,t[8]=i*o-n*r,t}function bB(t){const e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8];return e*(u*r-o*l)+i*(-u*s+o*a)+n*(l*s-r*a)}function SB(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],f=i[1],p=i[2],m=i[3],y=i[4],g=i[5],v=i[6],w=i[7],b=i[8];return t[0]=d*n+f*o+p*u,t[1]=d*s+f*a+p*c,t[2]=d*r+f*l+p*h,t[3]=m*n+y*o+g*u,t[4]=m*s+y*a+g*c,t[5]=m*r+y*l+g*h,t[6]=v*n+w*o+b*u,t[7]=v*s+w*a+b*c,t[8]=v*r+w*l+b*h,t}function xB(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],f=i[1];return t[0]=n,t[1]=s,t[2]=r,t[3]=o,t[4]=a,t[5]=l,t[6]=d*n+f*o+u,t[7]=d*s+f*a+c,t[8]=d*r+f*l+h,t}function _B(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(i),f=Math.cos(i);return t[0]=f*n+d*o,t[1]=f*s+d*a,t[2]=f*r+d*l,t[3]=f*o-d*n,t[4]=f*a-d*s,t[5]=f*l-d*r,t[6]=u,t[7]=c,t[8]=h,t}function MB(t,e,i){const n=i[0],s=i[1],r=i[2];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=r*e[6],t[7]=r*e[7],t[8]=r*e[8],t}function kB(t,e,i){const n=i[0],s=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t}function TB(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function AB(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function IB(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function jB(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function CB(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=i+i,a=n+n,l=s+s,u=i*o,c=n*o,h=n*a,d=s*o,f=s*a,p=s*l,m=r*o,y=r*a,g=r*l;return t[0]=1-h-p,t[3]=c-g,t[6]=d+y,t[1]=c+g,t[4]=1-u-p,t[7]=f-m,t[2]=d-y,t[5]=f+m,t[8]=1-u-h,t}function EB(t,e){const i=e[0],n=e[1],s=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10],h=c*o-a*u,d=-c*r+a*l,f=u*r-o*l,p=i*h+n*d+s*f;if(!p)return null;const m=1/p;return t[0]=h*m,t[1]=(-c*n+s*u)*m,t[2]=(a*n-s*o)*m,t[3]=d*m,t[4]=(c*i-s*l)*m,t[5]=(-a*i+s*r)*m,t[6]=f*m,t[7]=(-u*i+n*l)*m,t[8]=(o*i-n*r)*m,t}function OB(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],y=e[14],g=e[15],v=i*a-n*o,w=i*l-s*o,b=i*u-r*o,S=n*l-s*a,x=n*u-r*a,_=s*u-r*l,M=c*m-h*p,k=c*y-d*p,T=c*g-f*p,A=h*y-d*m,I=h*g-f*m,j=d*g-f*y;let C=v*j-w*I+b*A+S*T-x*k+_*M;return C?(C=1/C,t[0]=(a*j-l*I+u*A)*C,t[1]=(l*T-o*j-u*k)*C,t[2]=(o*I-a*T+u*M)*C,t[3]=(s*I-n*j-r*A)*C,t[4]=(i*j-s*T+r*k)*C,t[5]=(n*T-i*I-r*M)*C,t[6]=(m*_-y*x+g*S)*C,t[7]=(y*b-p*_-g*w)*C,t[8]=(p*x-m*b+g*v)*C,t):null}function LB(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function NB(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function RB(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function PB(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function FB(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function DB(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function $B(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t}function zB(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function UB(t,e){const i=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],f=e[2],p=e[3],m=e[4],y=e[5],g=e[6],v=e[7],w=e[8],b=uo();return Math.abs(i-h)<=b*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-d)<=b*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(s-f)<=b*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(r-p)<=b*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(o-m)<=b*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-y)<=b*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(l-g)<=b*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=b*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-w)<=b*Math.max(1,Math.abs(c),Math.abs(w))}function VB(t){const e=uo(),i=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(n*n+o*o+u*u))<=e&&Math.abs(1-(s*s+a*a+c*c))<=e}const GB=SB,BB=FB;Object.freeze(Object.defineProperty({__proto__:null,add:PB,adjoint:wB,copy:pB,determinant:bB,equals:UB,exactEquals:zB,frob:RB,fromMat2d:jB,fromMat4:fB,fromQuat:CB,fromRotation:AB,fromScaling:IB,fromTranslation:TB,identity:yB,invert:vB,isOrthoNormal:VB,mul:GB,multiply:SB,multiplyScalar:DB,multiplyScalarAndAdd:$B,normalFromMat4:OB,normalFromMat4Legacy:EB,projection:LB,rotate:_B,scale:MB,scaleByVec2:kB,set:mB,str:NB,sub:BB,subtract:FB,translate:xB,transpose:gB},Symbol.toStringTag,{value:"Module"}));function qB(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function HB(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function WB(t,e,i,n,s,r,o,a,l){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=n,u[4]=s,u[5]=r,u[6]=o,u[7]=a,u[8]=l,u}function ZB(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:HB,create:qB,createView:ZB,fromValues:WB},Symbol.toStringTag,{value:"Module"}));function JB(){return new Float32Array(2)}function KB(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function YB(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function QB(t,e){return new Float32Array(t,e,2)}function XB(){return JB()}function tq(){return YB(1,1)}function eq(){return YB(1,0)}function iq(){return YB(0,1)}const nq=XB(),sq=tq(),rq=eq(),oq=iq();Object.freeze(Object.defineProperty({__proto__:null,ONES:sq,UNIT_X:rq,UNIT_Y:oq,ZEROS:nq,clone:KB,create:JB,createView:QB,fromValues:YB,ones:tq,unitX:eq,unitY:iq,zeros:XB},Symbol.toStringTag,{value:"Module"}));function aq(t){return t instanceof Float32Array&&t.length>=2}function lq(t){return Array.isArray(t)&&t.length>=2}function uq(t){return aq(t)||lq(t)}var cq;const hq=[0,0];let dq=cq=class extends el{constructor(t){super(t),this._viewpoint2D={center:$U(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Rf,this.id=0,this.inverseTransform=Wz(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Wz(),this.transformNoRotation=Wz(),this.displayMat3=qB(),this.displayViewMat3=qB(),this.viewMat3=qB(),this.viewMat2d=aB(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=LV(i,t.viewpoint),this._set("size",Qz(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new cq({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return uq(e)?_U(t,e,this.inverseTransform):(hq[0]=e,hq[1]=i,_U(t,hq,this.inverseTransform))}toScreen(t,e,i){return uq(e)?_U(t,e,this.transform):(hq[0]=e,hq[1]=i,_U(t,hq,this.transform))}toScreenNoRotation(t,e,i){return uq(e)?_U(t,e,this.transformNoRotation):(hq[0]=e,hq[1]=i,_U(t,hq,this.transformNoRotation))}toScreenClosest(t,e,i){uq(e)?(hq[0]=e[0],hq[1]=e[1]):(hq[0]=e,hq[1]=i);const[n]=hq,{center:s,extent:r,spatialReference:o,transform:a}=this;return(n<r.xmin||n>r.xmax)&&(hq[0]=bV(n,s[0],o)),_U(t,hq,a)}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size");return qV(t,i,s,e,0,n),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:n}=this._viewpoint2D,s=this._get("pixelRatio")||1,r=this._get("size"),o=new Nm({targetGeometry:new Qd(t[0],t[1],e),scale:i,rotation:n});if(this._set("viewpoint",o),!r||!e||!i)return;this.resolution=zV(o),this.rotation=n,this.scale=i,this.spatialReference=e,Qz(this.center,t);const a=0!==r[0]?2/r[0]:0,l=0!==r[1]?-2/r[1]:0;mB(this.displayMat3,a,0,0,0,l,0,-1,1,1);const u=yB(this.viewMat3),c=YB(r[0]/2,r[1]/2),h=YB(-r[0]/2,-r[1]/2),d=mo(n);xB(u,u,c),_B(u,u,d),xB(u,u,h),SB(this.displayViewMat3,this.displayMat3,u);const f=Pz(this.viewMat2d,c);return Ez(f,f,d),Lz(f,f,h),RV(this.extent,o,r),HV(this.transform,o,r,s),Iz(this.inverseTransform,this.transform),WV(this.transformNoRotation,o,r,s),this.worldScreenWidth=JV(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};o([Us({readOnly:!0})],dq.prototype,"id",void 0),o([Us({value:1,json:{write:!0}})],dq.prototype,"pixelRatio",null),o([Us({json:{write:!0}})],dq.prototype,"size",null),o([Us()],dq.prototype,"spatialReference",void 0),o([Us({type:Nm,json:{write:!0}})],dq.prototype,"viewpoint",null),dq=cq=o([Nr("esri.views.2d.ViewState")],dq);const fq=dq;var pq,mq;let yq=pq=class extends Vr{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new pq({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};o([Us()],yq.prototype,"left",void 0),o([Us()],yq.prototype,"top",void 0),o([Us()],yq.prototype,"right",void 0),o([Us()],yq.prototype,"bottom",void 0),yq=pq=o([Nr("esri.views.2d.PaddedViewState.Padding")],yq);let gq=mq=class extends fq{constructor(...t){super(...t),this.paddedViewState=new fq,this._updateContent=(()=>{const t=$U();return()=>{const e=this._get("size"),i=this._get("padding");if(!e||!i)return;const n=this.paddedViewState;Xz(t,i.left+i.right,i.top+i.bottom),eU(t,e,t),Qz(n.size,t);const s=n.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(fy((()=>[this.size,this.padding]),(()=>this._updateContent()),xy)),this.padding=new yq,this.size=[0,0]}set padding(t){this._set("padding",t||new yq)}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,YV(e,t,this._get("size"),this._get("padding"));const i=this._viewpoint2D,n=e.targetGeometry;i.center[0]=n.x,i.center[1]=n.y,i.rotation=e.rotation,i.scale=e.scale,i.spatialReference=n.spatialReference,this._update()}}clone(){return new mq({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};o([Us()],gq.prototype,"paddedViewState",void 0),o([Us({type:yq})],gq.prototype,"padding",null),o([Us()],gq.prototype,"viewpoint",null),gq=mq=o([Nr("esri.views.2d.PaddedViewState")],gq);const vq=gq;let wq=class extends Vr{constructor(t){super(t),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([fy((()=>this.constraints?.version),(t=>{this.constraints&&t&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))}),xy)])}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:e}=this.state.paddedViewState;return this.state.commitProperty("id"),new Qd({x:t[0],y:t[1],spatialReference:e})}set center(t){if(null==t)return;if(!this.ready)return void this._set("center",t);let e;try{e=this._project(t,this.state.spatialReference)}catch(e){return void Ft.getLogger(this).error(new Qe("mapview:invalid-center","could not project the value in the view's spatial reference",{input:t,error:e}))}const i=this.viewpoint;QV(i,i,e),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(t){if(null==t)return;if(!t.width||!t.height)return void Ft.getLogger(this).error(new Qe("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",t),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let e;try{e=this._project(t,this.state.spatialReference)}catch(t){return void Ft.getLogger(this).error(new Qe("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:t}))}const i=this.viewpoint;PV(i,i,e,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const e=this.viewpoint;eG(e,e,t),this.viewpoint=e}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",void 0);const e=this._get("extent");return void(e&&(this._set("extent",void 0),this._set("center",e.center)))}const e=this.viewpoint;nG(e,e,t),this.viewpoint=e}get viewpoint(){if(!this.ready)return this._get("viewpoint");return this.state.paddedViewState.viewpoint.clone()}set viewpoint(t){if(null==t)return;if(!this.ready)return this._set("viewpoint",t),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let e,i;try{e=this._project(t,this.state.spatialReference),!t.scale||isNaN(t.scale)?i=new Qe("mapview:invalid-viewpoint",`invalid scale value of ${t.scale}`):null==t.targetGeometry&&(i=new Qe("mapview:invalid-viewpoint","geometry not defined"))}catch(t){i=new Qe("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:t})}if(i)return void Ft.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const n=new Nm({targetGeometry:new Qd,scale:0,rotation:0});LV(n,e),this.constraints?.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(t){if(!(t>=0))return;if(!this.ready){this._set("zoom",t),this._set("scale",void 0);const e=this._get("extent");return void(e&&(this._set("extent",void 0),this._set("center",e.center)))}const e=this.constraints?.zoomToScale(t)??0;if(!e)return void this._set("zoom",-1);const i=this.viewpoint;nG(i,i,e),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(t){if(!t[0]&&!t[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:e,constraints:i}=this,n=this._get("center"),s=this._get("extent"),r=this._get("scale"),o=this._get("rotation"),a=this._get("viewpoint"),l=this._get("zoom"),u=null!=l&&null!=i&&i.zoomToScale(l)||void 0;let c,h,d;const f=a?.rotation,p=a?.targetGeometry;"extent"===p?.type?c=p:"point"===p?.type&&(h=p,d=a?.scale);const m=s??c;return{center:n??h??m?.center,rotation:o??f,scale:(r??u??d??(m&&IV(m,[t[0]-e.left-e.right,t[1]-e.top-e.bottom])))||void 0}}startup(t,e,i,n){const s=t.targetGeometry;try{this._project(t,i)}catch(e){Ft.getLogger(this).warn(new Hs("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:i,error:e})),t.targetGeometry=n||new Qd({x:0,y:0,spatialReference:i})}this.constraints?.fit(t),this._set("state",new vq({padding:this.padding,size:e,viewpoint:t})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[t,e],spatialReference:i,rotation:n,scale:s}=this.state.paddedViewState,r=new Qd({x:t,y:e,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",r),this._set("zoom",-1),this._set("rotation",n),this._set("scale",s),this._set("state",null)}changeSpatialReference(t){const e=this.state.paddedViewState.clone();if(null==this._scaleBeforeChangingSpatialReference)this._scaleBeforeChangingSpatialReference=e.scale;else{const t=e.viewpoint.clone();t.scale=this._scaleBeforeChangingSpatialReference,e.viewpoint=t}const i=e.clone(),[n,s]=e.center;let r=null;try{r=this._project(new Qd({x:n,y:s,spatialReference:e.spatialReference}),t)}catch(e){Fc()||Ft.getLogger(this).warn(new Hs("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:r?.toJSON(),spatialReference:t,error:e}))}r||(r=new Qd({x:0,y:0,spatialReference:t}));const o=QV(new Nm({targetGeometry:new Qd,scale:0,rotation:0}),e.viewpoint,r);i.viewpoint=o;try{const n=20,s=[e.size[0]/2,e.size[1]/2],r=[s[0]+n,s[1]],a=e.toMap([0,0],r),{x:l,y:u}=this._project(new Qd({x:a[0],y:a[1],spatialReference:e.spatialReference}),t);a[0]=l,a[1]=u,i.toScreen(a,a);const h=KV(s,a,r),d=Math.hypot(a[0]-s[0],a[1]-s[1])/n;!Number.isFinite(d)||Math.abs(d)>4?(o.rotation=0,o.targetGeometry=new Qd({x:0,y:0,spatialReference:t})):(o.scale*=d,o.scale>c("mapview-srswitch-adjust-rotation-scale-threshold")?o.rotation=0:o.rotation+=Number.isFinite(h)?h:0)}catch{}this._get("constraints")?.constrain(o,void 0),this._get("state").viewpoint=o}resize(t,e){if(!this.ready)return;const i=this.state;let n=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();i.size=[t,e],XV(n,n,s,this.state.paddedViewState.size,this.resizeAlign),n=this.constraints?.constrain(n,void 0)??n,this.state.viewpoint=n}toMap(t){if(!this.ready)return null;const e=[0,0],[i,n]=this.state.toMap(e,[t.x,t.y]),s=this.state.spatialReference;return new Qd({x:i,y:n,spatialReference:s})}toScreen(t,e){if(!this.ready)return null;const i=this._project(t,this.state.spatialReference),n=[i.x,i.y];return!1===e?.pickClosestTarget?this.state.toScreen(n,n):this.state.toScreenClosest(n,n),DT(n[0],n[1])}_project(t,e){const i=t?.targetGeometry||t;if(!e)return t;if(!i)return null;if(e.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem)return t;if(mh(e,i.spatialReference))return t;const n=wb(i,e);if(!n)throw new Qe("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:e});return bq(t)?(t.targetGeometry=n,t):n}};function bq(t){return"esri.Viewpoint"===t?.declaredClass}o([Us({type:Qd})],wq.prototype,"center",null),o([Us()],wq.prototype,"constraints",void 0),o([Us({type:Rf})],wq.prototype,"extent",null),o([Us({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],wq.prototype,"padding",null),o([Us()],wq.prototype,"ready",void 0),o([Us()],wq.prototype,"resizeAlign",void 0),o([Us({readOnly:!0})],wq.prototype,"resolution",null),o([Us({type:Number})],wq.prototype,"rotation",null),o([Us({type:Number})],wq.prototype,"scale",null),o([Us({readOnly:!0})],wq.prototype,"state",void 0),o([Us({type:Nm})],wq.prototype,"viewpoint",null),o([Us()],wq.prototype,"zoom",null),wq=o([Nr("esri.views.2d.ViewStateManager")],wq);function Sq(t,e){switch(e){case"primary":return"touch"===t.pointerType||0===t.button;case"secondary":return"touch"!==t.pointerType&&2===t.button;case"tertiary":return"touch"!==t.pointerType&&1===t.button}}class xq extends K_{constructor(t,e){super(!0),this._view=t,this.registerIncoming("double-click",e,(t=>this._handleDoubleClick(t,e)))}_handleDoubleClick(t,e){Sq(t.data,"primary")&&(t.stopPropagation(),e?this._view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this._view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}}class _q extends K_{constructor(t,e,i){super(!0),this.view=t,this.pointerType=e,this.registerIncoming("double-tap-drag",i,(t=>this._handleDoubleTapDrag(t)))}_handleDoubleTapDrag(t){const{data:e}=t,{pointerType:i}=e;if(i!==this.pointerType)return;t.stopPropagation();const{action:n,delta:s}=e,{view:r}=this,{mapViewNavigation:o}=r;switch(n){case"begin":{const{scale:t}=r;this._startScale=t,this._currentScale=t,this._previousDelta=s,o.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const t=1.015**s.y,e=this._startScale*t,i=e/this._currentScale;o.setViewpointImmediate(i),this._currentScale=e;break}case"end":{const{constraints:t}=r,{effectiveLODs:e,snapToZoom:i}=t;if(!i||!e)return void o.end();const n=t.snapScale(this._currentScale),a=(s.y>0?Math.max(n,t.snapToPreviousScale(this._startScale)):Math.min(n,t.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(a);break}}}}class Mq{constructor(t){this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(t){const e=t.data,i=e.pointers.size;switch(e.action){case"start":this._currentCount=i,this._emitStart(t);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(t);break;case"end":this._emitEnd(t),this._currentCount=0}this._previousEvent=t}_emitStart(t){this._startEvent=t,this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.start(this._currentCount,t,this._startEvent)}_emitUpdate(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.update(this._currentCount,t,this._startEvent)}_emitEnd(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.end(this._currentCount,t,this._startEvent),this._startEvent=null}}class kq extends K_{constructor(t,e,i){super(!0),this.view=t,this.pointerAction=e,this.registerIncoming("drag",i,(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()))}onInstall(t){super.onInstall(t),this._dragEventSeparator=new Mq({start:(t,e)=>{this.view.mapViewNavigation.pan.begin(this.view,e.data),e.stopPropagation()},update:(t,e)=>{this.view.mapViewNavigation.pan.update(this.view,e.data),e.stopPropagation()},end:(t,e)=>{this.view.mapViewNavigation.pan.end(this.view,e.data),e.stopPropagation()},condition:(t,e)=>1===t&&Sq(e.data,this.pointerAction)})}_handleDrag(t){const e=this.view.mapViewNavigation;e.pinch.zoomMomentum||e.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}class Tq extends K_{constructor(t,e,i){super(!0),this._view=t,this.pointerAction=e;const n=this._view.mapViewNavigation;this._dragEventSeparator=new Mq({start:(t,e)=>{n.rotate.begin(this._view,e.data),e.stopPropagation()},update:(t,e)=>{n.rotate.update(this._view,e.data),e.stopPropagation()},end:(t,e)=>{n.rotate.end(),e.stopPropagation()},condition:(t,e)=>1===t&&Sq(e.data,this.pointerAction)}),this.registerIncoming("drag",i,(t=>this._dragEventSeparator.handle(t)))}}function Aq(t){let e=t*t;return t<0&&(e*=-1),e}function Iq(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function jq(t,e,i){const n=i,s=t.state,r=t.device,o="forward-down"===e.tiltDirection?1:-1,a=1;return"standard"===r.deviceType?(n.translation[0]=Aq(s.axes[0]),n.translation[1]=Aq(s.axes[1]),n.translation[2]=Aq(s.buttons[7])-Aq(s.buttons[6]),n.heading=Aq(s.axes[2]),n.tilt=Aq(s.axes[3])):"spacemouse"===r.deviceType&&(n.translation[0]=1.2*Aq(s.axes[0]),n.translation[1]=1.2*Aq(s.axes[1]),n.translation[2]=2*-Aq(s.axes[2]),n.heading=1.2*Aq(s.axes[5]),n.tilt=1.2*Aq(s.axes[3])),n.tilt*=o,Oo(n.translation,n.translation,a),n}function Cq(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}class Eq extends K_{constructor(t){super(!0),this._view=t,this._frameTask=null,this._watchHandles=new w,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",(t=>this._handleGamePadEvent(t))),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([fy((()=>this._view.navigation.gamepad?.enabled),(t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=un({update:t=>this._frameUpdate(t.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),_y)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const e=this._view.navigation.gamepad.device;e&&t.data.device!==e||this._currentDevice&&this._currentDevice!==t.data.device||("end"===t.data.action?(this._currentDevice=null,Iq(this._transformation)):(this._currentDevice=t.data.device,jq(t.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(t){const e=this._transformation;if(Cq(e))return;const i=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,s=Lq*n*t;lG(i,i,[e.translation[0]*s,-e.translation[1]*s]);const r=1+e.translation[2]*Nq*t,o=this._view.constraints.rotationEnabled?-e.heading*Oq*t:0,a=this._view.size,l=[a[0]/2,a[1]];sG(i,i,r,o,l,a);const u=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=u}}const Oq=.06,Lq=.7,Nq=6e-4;function Rq(t){const e=()=>t("visible"===document.visibilityState);return document.addEventListener("visibilitychange",e),{remove:()=>document.addEventListener("visibilitychange",e)}}class Pq extends K_{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=t=>{const e=this._keyMap[t.data.key];if(t.modifiers.has("Meta")||t.modifiers.has("Ctrl"))return void this._stopMovement();if(null==e)return;t.stopPropagation(),t.preventDefault();const i="key-down"===t.type;if(this._pressedKeys[i?"add":"delete"](e),i){if(this._direction===e)return;this._direction=e,this._isSticky=!1,this._setTimeout((()=>{this._isSticky&&this._handlePopKey()}))}else{const t=void 0===this._timeout,e=this._pressedKeys.size>0;t||e?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),null==this._direction&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[e.left]:"left",[e.right]:"right",[e.up]:"up",[e.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=Rq((t=>t?null:this._stopMovement()))}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(t){const e=null!=this._currentDirection;if(null!=t){if(e||this.view.mapViewNavigation.begin(),this._currentDirection!==t)switch(t){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}}else e&&this.view.mapViewNavigation.stop();this._currentDirection=t}_setTimeout(t){clearTimeout(this._timeout),this._timeout=void 0===t?void 0:setTimeout((()=>{this._timeout=void 0,t()}),this._stickyKeyDuration)}}class Fq extends K_{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._pressed=!1,this._keyToDirection={[e.clockwiseOption1]:"clockwise",[e.clockwiseOption2]:"clockwise",[e.counterClockwiseOption1]:"counterClockwise",[e.counterClockwiseOption2]:"counterClockwise",[e.resetOption1]:"reset",[e.resetOption2]:"reset"},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),this.registerIncoming("key-up",i,(t=>this._handleKeyUp(t))),this.registerIncoming("blur",i,(()=>this._handleStop())),this._visibilityHandle=Rq((t=>t?null:this._handleStop()))}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,e){const i=t.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[t.data.key];if(this._pressed=null!=n,this._pressed){if(t.preventDefault(),e)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}}var Dq;!function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"}(Dq||(Dq={}));class $q extends K_{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._keysToZoomAction={},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),e.zoomIn.forEach((t=>this._keysToZoomAction[t]=Dq.IN)),e.zoomOut.forEach((t=>this._keysToZoomAction[t]=Dq.OUT))}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const e=t.modifiers;if(e.size>0&&!e.has("Shift"))return;const{key:i}=t.data;if(!(i in this._keysToZoomAction))return;const n=this._keysToZoomAction[i],{mapViewNavigation:s}=this.view;let r=null;switch(n){case Dq.IN:r=s.zoomIn();break;case Dq.OUT:r=s.zoomOut();break;default:return}s.begin(),r.then((()=>s.end())),t.stopPropagation()}}const zq=.6;class Uq extends K_{constructor(t,e){super(!0),this._view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",e,(t=>this._handleMouseWheel(t)))}_handleMouseWheel(t){if(!this._view.navigation.mouseWheelZoomEnabled)return;if(t.preventDefault(),t.stopPropagation(),!this._canZoom)return;const e=this._view.mapViewNavigation,{x:i,y:n,deltaY:s}=t.data,r=1/zq**(1/60*s),o=e.zoom(r,[i,n]);o&&(this._canZoom=!1,o.catch((()=>{})).then((()=>{this._canZoom=!0,e.end()})))}}class Vq extends K_{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this._stopMomentumNavigation()));const e=this.view.mapViewNavigation;this._dragEventSeparator=new Mq({start:(t,i)=>{e.pinch.begin(this.view,i.data),i.stopPropagation()},update:(t,i)=>{e.pinch.update(this.view,i.data),i.stopPropagation()},end:(t,i)=>{e.pinch.end(this.view),i.stopPropagation()},condition:t=>t>=2})}_handleDrag(t){this._dragEventSeparator.handle(t)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}function Gq(t){const e=t.native;return e?{buttons:e.buttons.map((t=>t.pressed?t.value||1:0)),axes:e.axes.map((e=>Hq(e,t.axisThreshold)))}:{buttons:[],axes:[]}}function Bq(t,e){if(t.axes.length!==e.axes.length)return!1;if(t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function qq(t){for(let e=0;e<t.axes.length;e++)if(0!==t.axes[e])return!1;for(let e=0;e<t.buttons.length;e++)if(0!==t.buttons[e])return!1;return!0}function Hq(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}class Wq{constructor(t,e){this._element=t,this._input=e,this._hasEventListeners=!1,this._onConnectGamepad=t=>{this._connectGamepad(t.gamepad)},this._onDisconnectGamepad=t=>{const e=t.gamepad,i=e.index,n=this._inputDevices[i];n&&(this._emitGamepadEvent(e,Gq(n),!1),this._inputDevices.splice(i,1),this._latestUpdate.splice(i,1),this._input.gamepad.devices.remove(n),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(this._forEachGamepad((t=>this._connectGamepad(t))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this._callback=t}_connectGamepad(t){const e=new I$(t);"unknown"!==e.deviceType&&(this._inputDevices[t.index]=e,this._input.gamepad.devices.add(e)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){null==this._frameTask&&(this._frameTask=un({update:()=>this._readGamepadState()}))}_stopPolling(){null!=this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const t=document.hasFocus(),e=this._element.contains(document.activeElement),i="document"===this._input.gamepad.enabledFocusMode&&!t||"view"===this._input.gamepad.enabledFocusMode&&!e;this._forEachGamepad((t=>{const e=this._inputDevices[t.index];if(!e)return;const n=this._latestUpdate[t.index],s=Gq(e),r=i||qq(s);if(n){if(n.timestamp===t.timestamp)return;if(!n.active&&r)return;if(Bq(n.state,s))return}this._emitGamepadEvent(t,s,!r)}))}_forEachGamepad(t){const e=window.navigator.getGamepads();for(let i=0;i<e.length;i++){const n=e[i];this._validate(n)&&t(n)}}_emitGamepadEvent(t,e,i){const n=this._latestUpdate[t.index],s=n&&n.active;if(!s&&!i)return;const r=!s&&i?"start":s&&i?"update":"end";this._latestUpdate[t.index]={timestamp:t.timestamp,state:e,active:i},this._callback&&this._callback({device:this._inputDevices[t.index],state:e,action:r})}_validate(t){if(!t)return!1;if(!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}}const Zq=c("edge"),Jq=c("chrome"),Kq=c("ff"),Yq=c("safari"),Qq="esri-view-surface",Xq={touchNone:`${Qq}--touch-none`,touchPan:`${Qq}--touch-pan`};class tH{constructor(t,e){this._input=e,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Wq(t,this._input),this._gamepadSource.onEvent=t=>this._callback("gamepad",t)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach((t=>{this._releasePointerCaptureSafe(t)})),this._gamepadSource=$t(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(t){this._browserTouchPanningEnabled=t,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(t){this._callback=t}set activeEvents(t){for(const e in this._active)if(!t||!t.has(e)){const t=this._active[e];this._element.removeEventListener(eH[e],t),delete this._active[e]}t&&t.forEach((t=>{if(!this._active[t]&&eH[t]){const e=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(eH[t],e),this._active[t]=e}})),this._gamepadSource.hasEventListeners=t?.has("gamepad")??!1}setPointerCapture(t,e){e?this._setPointerCatpureSafe(t.pointerId):(this._releasePointerCaptureSafe(t.pointerId),this._activePointerCaptures.delete(t.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?Xq.touchNone:Xq.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?Xq.touchPan:Xq.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(Xq.touchNone),this._element.classList.remove(Xq.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(t){try{this._element.setPointerCapture(t),this._activePointerCaptures.add(t)}catch{}}_releasePointerCaptureSafe(t){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(t))return;this._element.releasePointerCapture(t)}catch(t){}}_updateNormalizedPointerLikeEvent(t,e){const i=f$(this._element,t);return tH.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),e.x=i.x,e.y=i.y,e}_handleKey(t,e){const{key:i}=e;i&&"key-up"===t&&this._keyDownState.delete(i);const n={native:e,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&"key-down"===t&&this._keyDownState.add(n.key),this._callback(t,n)}_handlePointer(t,e){const i=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,pointerType:e.pointerType,button:e.button,buttons:e.buttons,eventId:this._eventId++});this._callback(t,i)}_handlePointerPreventDefault(t,e){const i=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,pointerType:e.pointerType,button:e.button,buttons:e.buttons,eventId:this._eventId++});e.preventDefault(),this._callback(t,i)}_handleMouseWheel(t,e){let i=e.deltaY;switch(e.deltaMode){case 0:Zq&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}Zq?i*=.7:Jq||Yq?i*=.6:Kq&&(i*=1.375);const n=100,s=Math.abs(i);if(s>n){const t=.02;i=i/s*200/(1+Math.exp(-t*(s-n)))}const r=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,deltaY:i});this._callback(t,r)}_handlePointerCaptureLost(t,e){this._activePointerCaptures.delete(e.pointerId),this._handleDefault(t,e)}_handleDefault(t,e){const i={native:e};e.preventDefault(),this._callback(t,i)}_preventAltKeyDefault(t){"Alt"===t.key&&t.preventDefault()}_preventMultiTouchPanning(t){t.touches.length>1&&t.preventDefault()}}tH.test={disableSubpixelCoordinates:!1};const eH={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};class iH extends K_{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault()}))}}const nH={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function sH(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function rH(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}function oH(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:DT()},0===t.length)return e;if(1===t.length)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(2===t.length){const[i,n]=t,[s,r]=[n.x-i.x,n.y-i.y];return e.radius=Math.sqrt(s*s+r*r)/2,e.center.x=(i.x+n.x)/2,e.center.y=(i.y+n.y)/2,e}let i=0,n=0;for(let e=0;e<t.length;e++)i+=t[e].x,n+=t[e].y;i/=t.length,n/=t.length;const s=t.map((t=>t.x-i)),r=t.map((t=>t.y-n));let o=0,a=0,l=0,u=0,c=0,h=0,d=0;for(let t=0;t<s.length;t++){const e=s[t],i=r[t],n=e*e,f=i*i;o+=n,a+=f,l+=e*i,u+=n*e,c+=f*i,h+=e*f,d+=i*n}const f=.5*(u+h),p=.5*(c+d),m=o*a-l*l,y=(f*a-p*l)/m,g=(o*p-l*f)/m,v=DT(y+i,g+n);return{radius:Math.sqrt(y*y+g*g+(o+a)/t.length),center:v}}function aH(t){const{native:e}=t,{pointerId:i,button:n,pointerType:s}=e;return"mouse"===s?`${i}:${n}`:`${s}`}class lH extends K_{constructor(t=nH.maximumDoubleClickDelay,e=nH.maximumDoubleClickDistance,i=nH.maximumDoubleTouchDelay,n=nH.maximumDoubleTouchDistance,s=bi){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=e,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=DT(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Mq({start:(t,e)=>this._dragStart(t,e),update:(t,e)=>this._dragUpdate(e),end:(t,e)=>this._dragEnd(e)}),this.registerIncoming("drag",(t=>this._dragEventSeparator.handle(t))),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((t=>{t.doubleTapTimeout=Ut(t.doubleTapTimeout)}))}get hasPendingInputs(){return os(this._pointerState,(t=>null!=t.doubleTapTimeout))}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout=Ut(e.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_createDoubleTapDragData(t,e,i){const{button:n,buttons:s,pointer:r,pointers:o,pointerType:a,timestamp:l}=i;return{action:t,delta:e,button:n,buttons:s,pointer:r,pointers:o,pointerType:a,timestamp:l}}_dragStart(t,e){if(!this._doubleTapDragReady||1!==t)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:n}=e,{center:s}=i;this._dragStartCenter=s;const r=this._createDoubleTapDragData("begin",DT(0,0),i);this._doubleTapDrag.emit(r,void 0,n),e.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:n}=e,s=DT(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("update",s,e);this._doubleTapDrag.emit(r,void 0,i),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:n}=e,s=DT(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("end",s,e);this._doubleTapDrag.emit(r,void 0,i),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:e}=t,i=aH(e),n=this._pointerState.get(i),{pointerType:s}=e.native;if(n){const r="touch"===s?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(i),sH(n.event.data,e)>r?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){const{data:e}=t,{pointerType:i}=e.native,n=aH(e),s="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout((()=>this._clearPointerDown(n)),s);this._pointerState.set(n,{event:t,doubleTapTimeout:r}),this.refreshHasPendingInputs()}}class uH extends K_{constructor(t){super(!1),this._navigationTouch=t,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(t,e,i,n){return{action:t,pointerType:this._pointerType,button:this._mouseButton,buttons:e.buttons,timestamp:n,pointers:dH(this._activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(t){const e=t.native.pointerId,i=hH(this._activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this._activePointerMap.set(e,n);const s=fH(n,cH(this._activePointerMap));n.initialAngle=s,n.lastAngle=s,this._updatePointerAngles(i)}_updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this._activePointerMap.get(e);i?i.event=t:this._addPointer(t)}_removePointer(t){const e=hH(this._activePointerMap).angle;this._activePointerMap.delete(t),this._updatePointerAngles(e)}_updatePointerAngles(t){const e=hH(this._activePointerMap);this._activePointerMap.forEach((i=>{i.initialAngle=fH(i,e)-t,i.lastAngle=fH(i,e)-t}))}_emitEvent(t,e,i){const n=hH(this._activePointerMap);this._drag.emit(this._createPayload(t,e,n,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(t){const e=t.data.native.pointerId,i=Zi(t.timestamp);this._activePointerMap.get(e)&&(1===this._activePointerMap.size?(this._updatePointer(t.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",t.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(e)):(this._removePointer(e),this._emitEvent("removed",t.data,Zi(t.timestamp))))}_handlePointerDrag(t){const e=t.data,i=e.currentEvent,n=Zi(t.timestamp);switch(e.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,n)):(this._addPointer(i),this._emitEvent("added",i,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=t.data.startEvent.pointerType,this._mouseButton=t.data.startEvent.button,this._startStateModifiers=t.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&"touch"===this._pointerType&&1===this._activePointerMap.size}}function cH(t){const e=[];return t.forEach((t=>{e.push(DT(t.event.x,t.event.y))})),oH(e)}function hH(t){const e=cH(t);let i=0;return t.forEach((t=>{let n=fH(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function dH(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function fH(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var pH;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"}(pH||(pH={}));class mH extends K_{constructor(t=nH.maximumDoubleClickDelay,e=nH.maximumDoubleClickDistance,i=nH.maximumDoubleTouchDelay,n=nH.maximumDoubleTouchDistance,s=bi){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=e,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=aH(e);if(!this._pointerState.has(i)){const t={downButton:e.native.button,x:e.x,y:e.y,immediateDoubleClick:null};this._pointerState.set(i,t),this.startCapturingPointer(e.native)}}_handlePointerUp(t){const e=t.data,i=aH(e),n=this._pointerState.get(i);if(n&&n.downButton===e.native.button){const i=n.immediateDoubleClick,s="touch"===t.data.native.pointerType?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;i?(i.timeoutHandle.remove(),sH(i,t.data)>s?this._startImmediateDoubleClick(t,n):(this._immediateDoubleClick.emit(t.data,void 0,i.modifiers),this._removeState(e))):sH(n,t.data)>s?this._removeState(e):this._startImmediateDoubleClick(t,n)}}_startImmediateDoubleClick(t,e){const i="touch"===t.data.native.pointerType?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),i)}}_removeState(t){const e=aH(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}}class yH extends K_{constructor(t=nH.maximumClickDelay,e=nH.movementUntilMouseDrag,i=nH.movementUntilPenDrag,n=nH.movementUntilTouchDrag,s=nH.holdDelay,r=bi){super(!1),this._maximumClickDelay=t,this._movementUntilMouseDrag=e,this._movementUntilPenDrag=i,this._movementUntilTouchDrag=n,this._holdDelay=s,this._clock=r,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up")})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost")})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel")})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((t=>{t.holdTimeout=Ut(t.holdTimeout)})),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);if(e){if(!e.isDragging){const i=e.previousEvent;this._pointerHold.emit(i,void 0,t.modifiers),e.holdEmitted=!0}e.holdTimeout=null}}),this._holdDelay));const s={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,s),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t)}_createPointerDragData(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,i=e.native.pointerId,n=this._pointerState.get(i);if(n){if(n.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",n,e),void 0,n.modifiers);else{rH(e,n.startEvent)>this._getDragThreshold(e.native.pointerType)&&this._startDragging(t)}n.previousEvent=e}}_getDragThreshold(t){switch(t){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,e)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp))}))}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,s=this._pointerState.get(n);if(s){if(null!=s.holdTimeout&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging)this._pointerDrag.emit(this._createPointerDragData("end",s,"pointer-up"===e?i:s.previousEvent),void 0,s.modifiers);else if("pointer-up"===e&&s.downButton===i.native.button){t.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(i)}this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause()}}}class gH extends K_{constructor(t=nH.maximumDoubleClickDelay,e=nH.maximumDoubleClickDistance,i=nH.maximumDoubleTouchDelay,n=nH.maximumDoubleTouchDistance,s=bi){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=e,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach((t=>t.doubleClickTimer=Ut(t.doubleClickTimer)))}get hasPendingInputs(){return os(this._pointerState,(t=>null!=t.doubleClickTimer))}_clearDoubleClickTimer(t,e){const i=this._pointerState.get(t);i&&(i.doubleClickTimer=Ut(i.doubleClickTimer),e&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const e=this._pointerState.get(t);1===e.pointerDownCount&&this._click.emit(e.event.data,void 0,e.event.modifiers),e.doubleClickTimer=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}_getPointerId(t){const{pointerId:e,pointerType:i,button:n}=t.native;return"mouse"===i?`${e}:${n}`:`${i}`}_handleImmediateClick(t){const e=t.data,{pointerType:i}=e.native,n=this._getPointerId(e);if(!this._pointerState.has(n))return void this._startClick(t);const s=this._pointerState.get(n),{data:r,modifiers:o}=s.event,a="touch"===i?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;sH(r,e)>a?(this._clearDoubleClickTimer(n,!0),this._startClick(t)):(this._clearDoubleClickTimer(n,!1),2===s.pointerDownCount&&this._doubleClick.emit(r,void 0,o))}_handlePointerDown(t){const e=aH(t.data),i=this._pointerState.get(e);i&&(i.pointerDownCount+=1)}_startClick(t){const{data:e}=t,{native:{pointerType:i}}=e,n=aH(e),s="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(n)),s),o=1;this._pointerState.set(n,{event:t,doubleClickTimer:r,pointerDownCount:o}),this.refreshHasPendingInputs()}}const vH={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let wH=class extends Vr{initialize(){const t=()=>this.view?.ready;this.addHandles([py((()=>!t()),(()=>this._disconnect())),py(t,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(t){return this._inputManager?.isModifierKeyDown(t)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=$t(this._inputManager)}_connect(){const t=this.view.surface,e=new tH(t,this.view.input),i=[new mH,new yH,new gH,new uH(this.view.navigation),new lH],n=new nM({eventSource:e,recognizers:i});n.installHandlers("prevent-context-menu",[new iH],oM.INTERNAL),n.installHandlers("navigation",[new Vq(this.view),new Eq(this.view),new Uq(this.view),new xq(this.view),new xq(this.view,[vH.counter]),new kq(this.view,"primary"),new Pq(this.view,vH.pan),new $q(this.view,vH.zoom),new Fq(this.view,vH.rotate),new Tq(this.view,"secondary"),new _q(this.view,"touch")],oM.INTERNAL),this.view.viewEvents.connect(n),this._source=e,this._inputManager=n,fy((()=>this.view?.navigation?.browserTouchPanEnabled),(t=>{this._source&&(this._source.browserTouchPanningEnabled=!t)}),_y)}get test(){return{inputManager:this._inputManager}}};o([Us()],wH.prototype,"view",void 0),o([Us()],wH.prototype,"latestPointerType",null),o([Us()],wH.prototype,"latestPointerLocation",null),o([Us()],wH.prototype,"multiTouchActive",null),wH=o([Nr("esri.views.2d.input.MapViewInputManager")],wH);const bH=wH;var SH="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function xH(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _H,MH,kH,TH={exports:{}};_H=TH,MH=function(){function t(t,i,s,r,o){e(t,i,s||0,r||t.length-1,o||n)}function e(t,n,s,r,o){for(;r>s;){if(r-s>600){var a=r-s+1,l=n-s+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);e(t,n,Math.max(s,Math.floor(n-l*c/a+h)),Math.min(r,Math.floor(n+(a-l)*c/a+h)),o)}var d=t[n],f=s,p=r;for(i(t,s,n),o(t[r],d)>0&&i(t,s,r);f<p;){for(i(t,f,p),f++,p--;o(t[f],d)<0;)f++;for(;o(t[p],d)>0;)p--}0===o(t[s],d)?i(t,s,p):i(t,++p,r),p<=n&&(s=p+1),n<=p&&(r=p-1)}}function i(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function n(t,e){return t<e?-1:t>e?1:0}return t},void 0!==(kH=MH())&&(_H.exports=kH);const AH=xH(TH.exports);function IH(t,e){if(!(this instanceof IH))return new IH(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this.toBBox=e:this._initFormat(e)),this.clear()}function jH(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function CH(t,e){EH(t,0,t.children.length,e,t)}function EH(t,e,i,n,s){s||(s=UH(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var r,o=e;o<i;o++)r=t.children[o],OH(s,t.leaf?n(r):r);return s}function OH(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function LH(t,e){return t.minX-e.minX}function NH(t,e){return t.minY-e.minY}function RH(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function PH(t){return t.maxX-t.minX+(t.maxY-t.minY)}function FH(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function DH(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,s-i)*Math.max(0,r-n)}function $H(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function zH(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function UH(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function VH(t,e,i,n,s){for(var r,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=n||(r=e+Math.ceil((i-e)/n/2)*n,AH(t,r,e,i,s),o.push(e,r,r,i))}IH.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!zH(t,e))return i;for(var s,r,o,a,l=[];e;){for(s=0,r=e.children.length;s<r;s++)o=e.children[s],zH(t,a=e.leaf?n(o):o)&&(e.leaf?i.push(o):$H(t,a)?this._all(o,i):l.push(o));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!zH(t,e))return!1;for(var n,s,r,o,a=[];e;){for(n=0,s=e.children.length;n<s;n++)if(r=e.children[n],zH(t,o=e.leaf?i(r):r)){if(e.leaf||$H(t,o))return!0;a.push(r)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return null!=t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=UH([]),this},remove:function(t,e){if(null==t)return this;for(var i,n,s,r,o=this.data,a=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],i=u.pop(),r=!0),o.leaf&&-1!==(s=jH(t,o.children,e)))return o.children.splice(s,1),l.push(o),this._condense(l),this;r||o.leaf||!$H(o,a)?n?(i++,o=n.children[i],r=!1):o=null:(l.push(o),u.push(i),i=0,n=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:LH,compareMinY:NH,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var s,r=i-e+1,o=this._maxEntries;if(r<=o)return CH(s=UH(t.slice(e,i+1)),this.toBBox),s;n||(n=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,n-1))),(s=UH([])).leaf=!1,s.height=n;var a,l,u,c,h=Math.ceil(r/o),d=h*Math.ceil(Math.sqrt(o));for(VH(t,e,i,d,this.compareMinX),a=e;a<=i;a+=d)for(VH(t,a,u=Math.min(a+d-1,i),h,this.compareMinY),l=a;l<=u;l+=h)c=Math.min(l+h-1,u),s.children.push(this._build(t,l,c,n-1));return CH(s,this.toBBox),s},_chooseSubtree:function(t,e,i,n){for(var s,r,o,a,l,u,c,h;n.push(e),!e.leaf&&n.length-1!==i;){for(c=h=1/0,s=0,r=e.children.length;s<r;s++)l=RH(o=e.children[s]),(u=FH(t,o)-l)<h?(h=u,c=l<c?l:c,a=o):u===h&&l<c&&(c=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,s=i?t:n(t),r=[],o=this._chooseSubtree(s,this.data,e,r);for(o.children.push(t),OH(o,s);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(s,r,e)},_split:function(t,e){var i=t[e],n=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,n);var r=this._chooseSplitIndex(i,s,n),o=UH(i.children.splice(r,i.children.length-r));o.height=i.height,o.leaf=i.leaf,CH(i,this.toBBox),CH(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=UH([t,e]),this.data.height=t.height+1,this.data.leaf=!1,CH(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,s,r,o,a,l,u,c;for(l=u=1/0,n=e;n<=i-e;n++)o=DH(s=EH(t,0,n,this.toBBox),r=EH(t,n,i,this.toBBox)),a=RH(s)+RH(r),o<l?(l=o,c=n,u=a<u?a:u):o===l&&a<u&&(u=a,c=n);return c},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:LH,s=t.leaf?this.compareMinY:NH;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,s)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var s,r,o=this.toBBox,a=EH(t,0,e,o),l=EH(t,i-e,i,o),u=PH(a)+PH(l);for(s=e;s<i-e;s++)r=t.children[s],OH(a,t.leaf?o(r):r),u+=PH(a);for(s=i-e-1;s>=e;s--)r=t.children[s],OH(l,t.leaf?o(r):r),u+=PH(l);return u},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)OH(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():CH(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};class GH{constructor(t,e){this.key=new OG(0,0,0,0),this.bounds=pp(),this.objectIds=new Set,this.key.set(e);const i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return Rf.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(t){return{$view:{scale:this.scale,timeZone:t}}}createChildTiles(){const t=this.key.getChildKeys(),e=ai.acquire();for(let i=0;i<t.length;i++)e[i]=new GH(this.tileInfoView,t[i]);return e}getQuantizationParameters(){return RD.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}}const BH={added:[],removed:[]},qH=new Set,HH=new OG(0,0,0,0);function WH(t,e){const i=yh(e);if(!i)return null;const[n,s]=i.valid;return t[2]>s?[pp([t[0],t[1],s,t[3]]),pp([n,t[1],n+t[2]-s,t[3]])]:t[0]<n?[pp([n,t[1],t[2],t[3]]),pp([s-(n-t[0]),t[1],s,t[3]])]:null}class ZH extends Pm{constructor(t){super(),this._tiles=new Map,this._index=IH(9,c("esri-csp-restrictions")?t=>({minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}getIntersectingTiles(t){if(!t||0===Sp(t)||0===xp(t))return[];const e=WH(t,this.tileScheme.spatialReference);return null!=e?[...new Set([...this.boundsIntersections(e[0]),...this.boundsIntersections(e[1])])]:this.boundsIntersections(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const e={added:[],removed:[]};for(const i of t.added)if(!this.has(i)){const t=new GH(this.tileScheme,i);this._tiles.set(i,t),this._index.insert(t),e.added.push(t)}for(const i of t.removed)if(this.has(i)){const t=this.get(i);this._tiles.delete(i),this._index.remove(t),e.removed.push(t)}this.tiles.length=0,this._tiles.forEach((t=>this.tiles.push(t))),(e.added.length||e.removed.length)&&this.emit("update",e)}setViewState(t){const e=this.tileScheme.getTileCoverage(t,0);if(!e)return;const{spans:i,lodInfo:n}=e,{level:s}=n;if(i.length>0)for(const{row:t,colFrom:e,colTo:r}of i)for(let i=e;i<=r;i++){const e=HH.set(s,t,n.normalizeCol(i),n.getWorldForColumn(i)).id;if(qH.add(e),!this.has(e)){const t=new GH(this.tileScheme,e);this._tiles.set(e,t),this._index.insert(t),this.tiles.push(t),BH.added.push(t)}}for(let t=this.tiles.length-1;t>=0;t--){const e=this.tiles[t];qH.has(e.id)||(this._tiles.delete(e.id),this.tiles.splice(t,1),this._index.remove(e),BH.removed.push(e))}(BH.added.length||BH.removed.length)&&this.emit("update",BH),DG.pool.release(e),qH.clear(),BH.added.length=0,BH.removed.length=0}}let JH=class extends Vr{constructor(){super(...arguments),this.color=new wT([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25,this.multiHighlightEnabled=!1}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.multiHighlightEnabled===t.multiHighlightEnabled}};o([Us({type:wT})],JH.prototype,"color",void 0),o([Us({type:wT})],JH.prototype,"haloColor",void 0),o([Us()],JH.prototype,"haloOpacity",void 0),o([Us()],JH.prototype,"fillOpacity",void 0),o([Us()],JH.prototype,"multiHighlightEnabled",void 0),JH=o([Nr("esri.views.2d.support.HighlightOptions")],JH);const KH=JH;async function YH(t,e,i){const n=m$(e)?p$(t,e):e;if(!t.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let s=new Set;const r=new Set;let o=!1,a=null,l=null;i?.include?XH(i.include,QH(t,(t=>{s.add(t),eW(t,(t=>r.add(t)))}),((t,e)=>{r.add(t),s.add(e)}),(t=>{a||(a=new Set),a.add(t)}),(t=>s.add(t)),(()=>o=!0))):(o=!0,s=new Set(t.allLayerViews),s.forEach((t=>{eW(t,(t=>r.add(t)))}))),i?.exclude&&XH(i.exclude,QH(t,(t=>{s.delete(t),eW(t,(t=>r.delete(t)))}),(t=>r.delete(t)),(t=>{l||(l=new Set),l.add(t)})));const u=t.allLayerViews.filter((t=>!t.suspended&&s.has(t))).reverse(),c=t.toMap(n);let h=[...o?t.graphicsView.hitTest(c).map((t=>({type:"graphic",graphic:t,layer:null,mapPoint:c}))):[],...await Promise.all(u.map((t=>t.hitTest(c,n))).toArray())].filter(F).flat().filter(F);return h=h.filter((t=>"graphic"!==t.type||"subtype-group"!==t.layer?.type||r.has(t.graphic.layer))),a&&(h=h.filter((t=>!("graphic"in t)||!t.graphic||a?.has(tW(t.graphic))))),l&&(h=h.filter((t=>!("graphic"in t)||!t.graphic||!l?.has(tW(t.graphic))))),{screenPoint:n,results:h}}function QH(t,e,i,n,s,r){return o=>{if(o instanceof NF){if(o.layer===t)r?.();else{const e=t.allLayerViews.find((t=>t.layer===o.layer));e&&s?.(e)}n(tW(o))}else if("subtype-sublayer"===o.type){const e=t.allLayerViews.find((t=>t.layer===o.parent));e&&i(o,e)}else{const i=t.allLayerViews.find((t=>t.layer===o));i&&e(i)}}}function XH(t,e){if(t)if(v(t))for(const i of t)if(v(i))for(const t of i)e(t);else e(i);else e(t)}function tW(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function eW({layer:t},e){"subtype-group"===t.type&&t.sublayers.forEach((t=>{e(t)}))}function iW(t,e,i){const{ctx:n,canvas:s}=sW(t,i),r=n.getImageData(0,0,t.width,t.height),o=lW(s,e);return rW(s),{dataUrl:o,data:r}}function nW(t,e){const{ctx:i,canvas:n}=sW(t,e),s=i.getImageData(0,0,t.width,t.height);return rW(n),s}function sW(t,e){const i=oW();e.premultipliedAlpha&&pW(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(t,0,0),e.flipY&&fW(n),{ctx:n,canvas:i}}function rW(t){t.width=0,t.height=0}function oW(){return null==aW&&(aW=document.createElement("canvas")),aW}let aW=null;function lW(t,e){const i=mW[e.format],n=e.quality/100;return t.toDataURL(i,n)}function uW(t,e){const i=dW(t),n=vW[i];return{format:i,quality:pa(null!=e?e:n,0,100)}}function cW(t,e){return e/Math.max(t[0],t[1])}function hW(t,e,i,n=0,s=0,r=t.width-n,o=t.height-s,a=!1){const{data:l}=t,{width:u,height:c,data:h}=e,d=r/u,f=o/c,p=Math.ceil(d/2),m=Math.ceil(f/2),y=t.width;for(let t=0;t<c;t++)for(let e=0;e<u;e++){const r=4*(e+(a?c-t-1:t)*u);let o=0,g=0,v=0,w=0,b=0,S=0;const x=(t+.5)*f;for(let r=Math.floor(t*f);r<(t+1)*f;r++){const t=Math.abs(x-(r+.5))/m,a=(e+.5)*d,u=t*t;for(let t=Math.floor(e*d);t<(e+1)*d;t++){const e=Math.abs(a-(t+.5))/p,c=Math.sqrt(u+e*e);if(c>=1)continue;let h=2*c*c*c-3*c*c+1;const d=4*(n+t+(s+r)*y);S+=h*l[d+3],g+=h,!i&&l[d+3]<255&&(h=h*l[d+3]/255),v+=h*l[d],w+=h*l[d+1],b+=h*l[d+2],o+=h}}h[r]=v/o,h[r+1]=w/o,h[r+2]=b/o,h[r+3]=S/g}return e}function dW(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return gW}}function fW(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function pW(t){const e=t.data,i=e.length;for(let t=0;t<i;t+=4){const i=e[t+3];if(255!==i&&i>0){const n=255/i;e[t]=e[t]*n,e[t+1]=e[t+1]*n,e[t+2]=e[t+2]*n}}}const mW={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},yW=98,gW="png",vW={png:100,jpg:yW,jpeg:yW};const wW={flipY:!0,premultipliedAlpha:!0};async function bW(t,e){const i=await xW(t,e),{format:n,quality:s}=uW(e?.format,e?.quality);return iW(i,{format:n,quality:s,rotation:0,disableDecorations:!1},wW)}async function SW(t,e){const i=await xW(t,e);return nW(i,wW)}function xW(t,e){const i=kW(e||{},MW(t.stage,t.size),t.size,t.padding),n=_W(e,t.allLayerViews);return t.stage.takeScreenshot(i,n,t.backgroundColor,e?.rotation)}function _W(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach((t=>{const n=e.find((e=>e.layer.id===t.id));n?.container&&i.push(n.container)})),i}function MW(t,e){return Math.min(4,cW(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function kW(t,e,i,n){t.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let s=null;null!=t.width&&null!=t.height?s=[t.width,t.height]:null==t.width&&null!=t.height?s=[t.height,t.height]:null!=t.width&&null==t.height?s=[t.width,t.width]:null==t.width&&null==t.height&&(s=null);const r=i[0]-(n.left+n.right),o=i[1]-(n.top+n.bottom);let a,l,u=t.area||{x:0,y:0,width:r,height:o};if(s){const t=r/o,e=s[0]/s[1];if(e>t){const t=u.width/e;u={x:u.x,y:Math.round(u.y+(u.height-t)/2),width:u.width,height:Math.round(t)}}else{const t=u.height*e;u={x:Math.round(u.x+(u.width-t)/2),y:u.y,width:Math.round(t),height:u.height}}}else s=[u.width,u.height];return s[0]>u.width?(a=Math.min(s[0]/u.width,e),l=s[0]/u.width/a):(a=1,l=s[0]/u.width),{cropArea:{x:Math.round((u.x+n.left)*a),y:Math.round((u.y+n.top)*a),width:Math.round(u.width*a),height:Math.round(u.height*a)},outputScale:l,resolutionScale:a}}const TW=160;let AW=class extends Vr{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),null==this._timer&&(this._timer=setInterval((()=>{performance.now()-this._timestamp>=TW&&this.clear()}),TW))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};o([Us()],AW.prototype,"_timer",void 0),o([Us()],AW.prototype,"stationary",null),AW=o([Nr("esri.views.2d.support.StationaryManager")],AW);const IW=t=>t.includes("Brush");class jW{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),IW(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark(`Esri.${t}`))}}function CW(t,e={}){const i=t.getContext("webgl2",e);return i||null}let EW;function OW(){return EW||(EW=RW()),EW}class LW{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}}function NW(t){if("undefined"==typeof WebGL2RenderingContext)return null;const e=document.createElement("canvas");if(!e)return null;let i=CW(e,{failIfMajorPerformanceCaveat:!0});if(null==i&&(i=CW(e),null!=i&&(t.majorPerformanceCaveat=!0)),null==i)return i;t.available=!0,t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const n=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return n&&(t.supportsHighPrecisionFragment=n.precision>0),i}function RW(){const t=new LW,e=NW(t);return null==e||(t.supportsColorBufferFloat=null!==e.getExtension("EXT_color_buffer_float"),t.supportsColorBufferFloatBlend=null!==e.getExtension("EXT_float_blend"),t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||null!==e.getExtension("EXT_color_buffer_half_float")),t}function PW(t){const e=OW();return e.available?"3d"===t&&e.majorPerformanceCaveat?new Qe("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new Qe("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new Qe("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new Qe("webgl:required","WebGL2 is required but not supported.",(new Error).stack)}function FW(t){return t&&"nodeType"in t}function DW(t){return t&&"function"==typeof t.render}const $W={component:"esri-component"};let zW=class extends Vr{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(t){this._set("id",t)}set node(t){const e=this._get("node");t!==e&&(t&&t.classList.add($W.component),e&&e.classList.remove($W.component),this._set("node",t))}castNode(t){return this.widget?.destroy(),t?"string"==typeof t||FW(t)?(this._set("widget",null),oS(t)):(DW(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};o([Us()],zW.prototype,"id",null),o([Us()],zW.prototype,"node",null),o([ol("node")],zW.prototype,"castNode",null),o([Us({readOnly:!0})],zW.prototype,"widget",void 0),zW=o([Nr("esri.views.ui.Component")],zW);const UW=zW;const VW="calcite-mode-";function GW(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function BW(){return GW().startsWith("dark")}function qW(){return`${VW}${BW()?"dark":"light"}`}function HW(t){WW(t),t.classList.add(qW())}function WW(t){Array.from(t.classList).forEach((e=>{e.startsWith(VW)&&t.classList.remove(e)}))}const ZW={left:0,top:0,bottom:0,right:0},JW={bottom:30,top:15,right:15,left:15},KW="esri-ui",YW={ui:KW,corner:`${KW}-corner`,innerContainer:`${KW}-inner-container`,manualContainer:`${KW}-manual-container`,cornerContainer:`${KW}-corner-container`,topLeft:`${KW}-top-left`,topRight:`${KW}-top-right`,bottomLeft:`${KW}-bottom-left`,bottomRight:`${KW}-bottom-right`};function QW(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function XW(t){return 0===t?"0":`${t}px`}function tZ(t){const e="object"==typeof t&&null!==t&&Object.getPrototypeOf(t);return(null===e||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function eZ(t,{top:e,bottom:i,left:n,right:s}){t.style.top=e,t.style.bottom=i,t.style.left=n,t.style.right=s}let iZ=class extends Pm.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._locale=ng(),this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&eZ(t,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&eZ(t,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([fy((()=>[this.view?.padding,this.container]),this._applyViewPadding,_y),fy((()=>this.padding),this._applyUIPadding,_y),fy((()=>[this.container,this._locale]),(([t,e])=>{t&&t.setAttribute("lang",e)}),_y),og((t=>{this._locale=t}))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._componentMap.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add(YW.ui),HW(t),this._attachContainers(t)),e&&(e.classList.remove(YW.ui),eZ(e,{top:"",bottom:"",left:"",right:""}),aS(e)),this._set("container",t))}get height(){const t=this.view?.height??0;if(0===t)return t;const e=this._getViewPadding(),{top:i,bottom:n}=e;return Math.max(t-i-n,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...JW,...t}}get width(){const t=this.view?.width??0;if(0===t)return t;const e=this._getViewPadding(),{left:i,right:n}=e;return Math.max(t-i-n,0)}add(t,e){let i,n,s;if(Array.isArray(t))return void t.forEach((t=>this.add(t,e)));const r=tZ(t);r&&({index:i,position:e,component:t,key:n}=r),e&&"object"==typeof e&&({index:i,key:n,position:e,internal:s}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i,n,s)}remove(t,e){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,e)));const i=this._find(t);if(i){if(this._componentMap.has(i)&&this._componentMap.get(i)?.key!==e)return;const t=this._components.indexOf(i),n=i.node.parentNode;return n?.removeChild(i.node),this._componentMap.delete(i),this._components.splice(t,1)[0]}}empty(t,e={removeInternal:!1}){if(Array.isArray(t)){for(const i of t)this.empty(i,e);return}const i=this._positionNameToContainerLookup[t??"manual"],n=Array.prototype.slice.call(i.children).map((t=>this._findByNode(t))).filter((t=>{if(null==t)return!1;return!(this._componentMap.get(t)?.internal??!1)||e.removeInternal}));for(const t of n)this.remove(t)}move(t,e){if(Array.isArray(t)&&t.forEach((t=>this.move(t,e))),!t)return;let i;const n=tZ(t)||tZ(e);if(n&&(i=n.index,e=n.position,t=n.component||t),e&&!this._isValidPosition(e))return;const s=this.remove(t);s&&this.add(s,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getComponents(t,e={includeInternal:!1}){return t?Array.isArray(t)?t.flatMap((t=>this._getComponentsAtPosition(t,e))):this._getComponentsAtPosition(t,e):this._components.filter((t=>e.includeInternal||!this._componentMap.get(t)?.internal)).map((({widget:t,node:e})=>t??e))}getPosition(t){for(const e in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[e].contains(t))return e}return null}_add(t,e,i,n,s){t instanceof UW||(t=new UW({node:t})),this._place({component:t,position:e,index:i}),this._components.push(t),this._componentMap.set(t,{key:n,internal:s})}_find(t){return t?t instanceof UW?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.view?.padding??ZW}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(YW.innerContainer,YW.cornerContainer);const e=document.createElement("div");e.classList.add(YW.innerContainer,YW.manualContainer);const i=document.createElement("div");i.classList.add(YW.topLeft,YW.corner),t.appendChild(i);const n=document.createElement("div");n.classList.add(YW.topRight,YW.corner),t.appendChild(n);const s=document.createElement("div");s.classList.add(YW.bottomLeft,YW.corner),t.appendChild(s);const r=document.createElement("div");r.classList.add(YW.bottomRight,YW.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=e;const o=Bx();this._cornerNameToContainerLookup={"top-left":i,"top-right":n,"bottom-left":s,"bottom-right":r,"top-leading":o?n:i,"top-trailing":o?i:n,"bottom-leading":o?r:s,"bottom-trailing":o?s:r},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const e=t.position??"manual",{component:i,index:n}=t,s=this._positionNameToContainerLookup[e],r=null!=n&&n>-1;if(QW(i.widget)&&i.widget.startup(),!r)return void s.appendChild(i.node);const o=Array.from(s.children);if(0===n)return void(s.firstChild?lS(i.node,s.firstChild):s.appendChild(i.node));n>=o.length?s.appendChild(i.node):lS(i.node,o[n])}_toPixelPosition(t){return{top:XW(t.top),left:XW(t.left),right:XW(t.right),bottom:XW(t.bottom)}}_findByComponent(t){return this._components.find((e=>e===t))??null}_findById(t){return this._components.find((({id:e})=>e===t))??null}_findByNode(t){return this._components.find((({node:e})=>e===t))??null}_getComponentsAtPosition(t,e){const i=this._positionNameToContainerLookup[t];return Array.prototype.slice.call(i.children).map((t=>this._findByNode(t))).filter(F).filter((t=>e.includeInternal||!this._componentMap.get(t)?.internal)).map((({widget:t,node:e})=>t??e))}};o([Us()],iZ.prototype,"_locale",void 0),o([Us()],iZ.prototype,"container",null),o([Us()],iZ.prototype,"height",null),o([Us({value:JW})],iZ.prototype,"padding",null),o([ol("padding")],iZ.prototype,"castPadding",null),o([Us()],iZ.prototype,"view",void 0),o([Us()],iZ.prototype,"width",null),iZ=o([Nr("esri.views.ui.UI")],iZ);const nZ=iZ;const sZ="randomUUID"in crypto;function rZ(){if(sZ)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=e=>t[e].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function oZ(){return`{${rZ().toUpperCase()}}`}function aZ(){return`{${rZ()}}`}const lZ={handleInterceptedEvent:(t,e,i,n)=>(t.scheduleRender(),e.properties[`on${n.type}`].apply(e.properties.bind||i,[n]))};const uZ={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}},cZ=t=>({...uZ,...t});const hZ=(t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i},dZ=(t,e)=>t.find(e),fZ=(t,e,i=!1)=>{let n=t;return e.forEach(((t,s)=>{const r=n?.children?dZ(n.children,(e=>e.domNode===t)):void 0;i&&!r&&s!==e.length-1||(n=r)})),n},pZ=t=>{let e;const i={...lZ,...t},n=cZ(i),s=n.performanceLogger;let r,o=!0,a=!1;const l=[],u=[],c=(t,r,o)=>{let a;n.eventHandlerInterceptor=(t,n,r,o)=>function(t){let n;s("domEvent",t);const r=hZ(t.currentTarget,a.domNode),o=r.some((t=>customElements.get(t?.tagName?.toLowerCase())));if(t.eventPhase===Event.CAPTURING_PHASE||!o)r.reverse(),n=fZ(a.getLastRender(),r);else{const e=t.composedPath(),i=e.slice(e.indexOf(t.currentTarget),e.indexOf(a.domNode)).reverse();n=fZ(a.getLastRender(),i,!0)}let l;return n&&(l=i.handleInterceptedEvent(e,n,this,t)),s("domEventProcessed",t),l},i.postProcessProjectionOptions?.(n);const c=o();a=t(r,c,n),n.eventHandlerInterceptor=void 0,l.push(a),u.push(o),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(a,c)};let h=()=>{if(r=void 0,o){o=!1,s("renderStart",void 0);for(let t=0;t<l.length;t++){const e=u[t]();s("rendered",void 0),l[t].update(e),s("patched",void 0)}s("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,l,u)),e={renderNow:h,scheduleRender:()=>{r||a||(r=requestAnimationFrame(h))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(t,e)=>{c(A_.append,t,e)},insertBefore:(t,e)=>{c(A_.insertBefore,t,e)},merge:(t,e)=>{c(A_.merge,t,e)},replace:(t,e)=>{c(A_.replace,t,e)},detach:t=>{for(let e=0;e<u.length;e++)if(u[e]===t)return u.splice(e,1),l.splice(e,1)[0];throw new Error("renderFunction was not found")}},e
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.7.0
 */};const mZ="calcite-mode-auto";const yZ="calcite-mode-dark";const gZ="calcite-mode-light";const vZ={autoMode:mZ,darkMode:yZ,lightMode:gZ,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"};let wZ;let bZ;let SZ=false;let xZ=false;let _Z=false;let MZ=false;let kZ=false;const TZ=t=>{const e=new URL(t,HJ.A);return e.origin!==GJ.location.origin?e.href:e.pathname};const AZ=t=>HJ.A=t;const IZ=(t,e="")=>{{return()=>{}}};const jZ=(t,e)=>{{return()=>{}}};const CZ="slot-fb{display:contents}slot-fb[hidden]{display:none}";const EZ={};const OZ=t=>{t=typeof t;return t==="object"||t==="function"};function LZ(t){var e,i,n;return(n=(i=(e=t.head)===null||e===void 0?void 0:e.querySelector('meta[name="csp-nonce"]'))===null||i===void 0?void 0:i.getAttribute("content"))!==null&&n!==void 0?n:undefined}const NZ=(t,e,...i)=>{let n=null;let s=null;let r=false;let o=false;const a=[];const l=e=>{for(let i=0;i<e.length;i++){n=e[i];if(Array.isArray(n)){l(n)}else if(n!=null&&typeof n!=="boolean"){if(r=typeof t!=="function"&&!OZ(n)){n=String(n)}if(r&&o){a[a.length-1].I+=n}else{a.push(r?RZ(null,n):n)}o=r}}};l(i);if(e){if(e.name){s=e.name}{const t=e.className||e.class;if(t){e.class=typeof t!=="object"?t:Object.keys(t).filter((e=>t[e])).join(" ")}}}const u=RZ(t,null);u.C=e;if(a.length>0){u.O=a}{u.L=s}return u};const RZ=(t,e)=>{const i={N:0,R:t,I:e,U:null,O:null};{i.C=null}{i.L=null}return i};const PZ={};const FZ=t=>t&&t.R===PZ;const DZ=(t,e)=>{if(t!=null&&!OZ(t)){if(e&4){return t==="false"?false:t===""||!!t}if(e&2){return parseFloat(t)}if(e&1){return String(t)}return t}return t};const $Z=t=>PJ(t).V;const zZ=(t,e,i)=>{const n=$Z(t);return{emit:t=>UZ(n,e,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:t})}};const UZ=(t,e,i)=>{const n=HJ.ce(e,i);t.dispatchEvent(n);return n};const VZ=new WeakMap;const GZ=(t,e,i)=>{let n=VJ.get(t);if(ZJ&&i){n=n||new CSSStyleSheet;if(typeof n==="string"){n=e}else{n.replaceSync(e)}}else{n=e}VJ.set(t,n)};const BZ=(t,e,i)=>{var n;const s=HZ(e);const r=VJ.get(s);t=t.nodeType===11?t:BJ;if(r){if(typeof r==="string"){t=t.head||t;let i=VZ.get(t);let o;if(!i){VZ.set(t,i=new Set)}if(!i.has(s)){{o=BJ.createElement("style");o.innerHTML=r;const e=(n=HJ.B)!==null&&n!==void 0?n:LZ(BJ);if(e!=null){o.setAttribute("nonce",e)}t.insertBefore(o,t.querySelector("link"))}if(e.N&4){o.innerHTML+=CZ}if(i){i.add(s)}}}else if(!t.adoptedStyleSheets.includes(r)){t.adoptedStyleSheets=[...t.adoptedStyleSheets,r]}}return s};const qZ=t=>{const e=t.H;const i=t.V;const n=IZ("attachStyles",e.J);BZ(i.getRootNode(),e);n()};const HZ=(t,e)=>"sc-"+t.J;const WZ=(t,e,i,n,s,r)=>{if(i!==n){let o=DJ(t,e);e.toLowerCase();if(e==="class"){const e=t.classList;const s=JZ(i);const r=JZ(n);e.remove(...s.filter((t=>t&&!r.includes(t))));e.add(...r.filter((t=>t&&!s.includes(t))))}else if(e==="ref"){if(n){n(t)}}else{const a=OZ(n);if((o||a&&n!==null)&&!s){try{if(!t.tagName.includes("-")){const s=n==null?"":n;if(e==="list"){o=false}else if(i==null||t[e]!=s){t[e]=s}}else{t[e]=n}}catch(t){}}if(n==null||n===false){if(n!==false||t.getAttribute(e)===""){{t.removeAttribute(e)}}}else if((!o||r&4||s)&&!a){n=n===true?"":n;{t.setAttribute(e,n)}}}}};const ZZ=/\s/;const JZ=t=>!t?[]:t.split(ZZ);const KZ=(t,e,i,n)=>{const s=e.U.nodeType===11&&e.U.host?e.U.host:e.U;const r=t&&t.C||EZ;const o=e.C||EZ;{for(n in r){if(!(n in o)){WZ(s,n,r[n],undefined,i,e.N)}}}for(n in o){WZ(s,n,r[n],o[n],i,e.N)}};const YZ=(t,e,i,n)=>{var s;const r=e.O[i];let o=0;let a;let l;let u;if(!SZ){_Z=true;if(r.R==="slot"){r.N|=r.O?2:1}}if(r.I!==null){a=r.U=BJ.createTextNode(r.I)}else if(r.N&1){a=r.U=BJ.createTextNode("")}else{a=r.U=BJ.createElement(r.N&2?"slot-fb":r.R);{KZ(null,r,MZ)}if(r.O){for(o=0;o<r.O.length;++o){l=YZ(t,r,o);if(l){a.appendChild(l)}}}}a["s-hn"]=bZ;{if(r.N&(2|1)){a["s-sr"]=true;a["s-fs"]=(s=r.C)===null||s===void 0?void 0:s.slot;a["s-cr"]=wZ;a["s-sn"]=r.L||"";u=t&&t.O&&t.O[i];if(u&&u.R===r.R&&t.U){{QZ(t.U,false)}}}}return a};const QZ=(t,e)=>{var i;HJ.N|=1;const n=t.childNodes;for(let t=n.length-1;t>=0;t--){const s=n[t];if(s["s-hn"]!==bZ&&s["s-ol"]){sJ(s).insertBefore(s,nJ(s));s["s-ol"].remove();s["s-ol"]=undefined;s["s-sh"]=undefined;if(s.nodeType===1){s.setAttribute("slot",(i=s["s-sn"])!==null&&i!==void 0?i:"")}_Z=true}if(e){QZ(s,e)}}HJ.N&=~1};const XZ=(t,e,i,n,s,r)=>{let o=t["s-cr"]&&t["s-cr"].parentNode||t;let a;for(;s<=r;++s){if(n[s]){a=YZ(null,i,s);if(a){n[s].U=a;o.insertBefore(a,nJ(e))}}}};const tJ=(t,e,i)=>{for(let n=e;n<=i;++n){const e=t[n];if(e){const t=e.U;cJ(e);if(t){{xZ=true;if(t["s-ol"]){t["s-ol"].remove()}else{QZ(t,true)}}t.remove()}}}};const eJ=(t,e,i,n,s=false)=>{let r=0;let o=0;let a=e.length-1;let l=e[0];let u=e[a];let c=n.length-1;let h=n[0];let d=n[c];let f;while(r<=a&&o<=c){if(l==null){l=e[++r]}else if(u==null){u=e[--a]}else if(h==null){h=n[++o]}else if(d==null){d=n[--c]}else if(iJ(l,h,s)){rJ(l,h,s);l=e[++r];h=n[++o]}else if(iJ(u,d,s)){rJ(u,d,s);u=e[--a];d=n[--c]}else if(iJ(l,d,s)){if(l.R==="slot"||d.R==="slot"){QZ(l.U.parentNode,false)}rJ(l,d,s);t.insertBefore(l.U,u.U.nextSibling);l=e[++r];d=n[--c]}else if(iJ(u,h,s)){if(l.R==="slot"||d.R==="slot"){QZ(u.U.parentNode,false)}rJ(u,h,s);t.insertBefore(u.U,l.U);u=e[--a];h=n[++o]}else{{f=YZ(e&&e[o],i,o);h=n[++o]}if(f){{sJ(l.U).insertBefore(f,nJ(l.U))}}}}if(r>a){XZ(t,n[c+1]==null?null:n[c+1].U,i,n,o,c)}else if(o>c){tJ(e,r,a)}};const iJ=(t,e,i=false)=>{if(t.R===e.R){if(t.R==="slot"){return t.L===e.L}return true}return false};const nJ=t=>t&&t["s-ol"]||t;const sJ=t=>(t["s-ol"]?t["s-ol"]:t).parentNode;const rJ=(t,e,i=false)=>{const n=e.U=t.U;const s=t.O;const r=e.O;const o=e.R;const a=e.I;let l;if(a===null){{if(o==="slot");else{KZ(t,e,MZ)}}if(s!==null&&r!==null){eJ(n,s,e,r,i)}else if(r!==null){if(t.I!==null){n.textContent=""}XZ(n,null,e,r,0,r.length-1)}else if(s!==null){tJ(s,0,s.length-1)}}else if(l=n["s-cr"]){l.parentNode.textContent=a}else if(t.I!==a){n.data=a}};const oJ=t=>{const e=t.childNodes;for(const t of e){if(t.nodeType===1){if(t["s-sr"]){const i=t["s-sn"];t.hidden=false;for(const n of e){if(n!==t){if(n["s-hn"]!==t["s-hn"]||i!==""){if(n.nodeType===1&&(i===n.getAttribute("slot")||i===n["s-sn"])){t.hidden=true;break}}else{if(n.nodeType===1||n.nodeType===3&&n.textContent.trim()!==""){t.hidden=true;break}}}}}oJ(t)}}};const aJ=[];const lJ=t=>{let i;let n;let s;for(const r of t.childNodes){if(r["s-sr"]&&(i=r["s-cr"])&&i.parentNode){n=i.parentNode.childNodes;const t=r["s-sn"];for(s=n.length-1;s>=0;s--){i=n[s];if(!i["s-cn"]&&!i["s-nr"]&&i["s-hn"]!==r["s-hn"]&&!e.experimentalSlotFixes){if(uJ(i,t)){let e=aJ.find((t=>t.K===i));xZ=true;i["s-sn"]=i["s-sn"]||t;if(e){e.K["s-sh"]=r["s-hn"];e.nt=r}else{i["s-sh"]=r["s-hn"];aJ.push({nt:r,K:i})}if(i["s-sr"]){aJ.map((t=>{if(uJ(t.K,i["s-sn"])){e=aJ.find((t=>t.K===i));if(e&&!t.nt){t.nt=e.nt}}}))}}else if(!aJ.some((t=>t.K===i))){aJ.push({K:i})}}}}if(r.nodeType===1){lJ(r)}}};const uJ=(t,e)=>{if(t.nodeType===1){if(t.getAttribute("slot")===null&&e===""){return true}if(t.getAttribute("slot")===e){return true}return false}if(t["s-sn"]===e){return true}return e===""};const cJ=t=>{{t.C&&t.C.ref&&t.C.ref(null);t.O&&t.O.map(cJ)}};const hJ=(t,e,i=false)=>{var n,s,r,o;const a=t.V;const l=t.H;const u=t.st||RZ(null,null);const c=FZ(e)?e:NZ(null,null,e);bZ=a.tagName;if(l.rt){c.C=c.C||{};l.rt.map((([t,e])=>c.C[e]=a[t]))}if(i&&c.C){for(const t of Object.keys(c.C)){if(a.hasAttribute(t)&&!["key","ref","style","class"].includes(t)){c.C[t]=a[t]}}}c.R=null;c.N|=4;t.st=c;c.U=u.U=a;{wZ=a["s-cr"];SZ=(l.N&1)!==0;xZ=false}rJ(u,c,i);{HJ.N|=1;if(_Z){lJ(c.U);for(const t of aJ){const e=t.K;if(!e["s-ol"]){const t=BJ.createTextNode("");t["s-nr"]=e;e.parentNode.insertBefore(e["s-ol"]=t,e)}}for(const t of aJ){const e=t.K;const a=t.nt;if(a){const t=a.parentNode;let i=a.nextSibling;{let r=(n=e["s-ol"])===null||n===void 0?void 0:n.previousSibling;while(r){let n=(s=r["s-nr"])!==null&&s!==void 0?s:null;if(n&&n["s-sn"]===e["s-sn"]&&t===n.parentNode){n=n.nextSibling;if(!n||!n["s-nr"]){i=n;break}}r=r.previousSibling}}if(!i&&t!==e.parentNode||e.nextSibling!==i){if(e!==i){if(!e["s-hn"]&&e["s-ol"]){e["s-hn"]=e["s-ol"].parentNode.nodeName}t.insertBefore(e,i);if(e.nodeType===1){e.hidden=(r=e["s-ih"])!==null&&r!==void 0?r:false}}}}else{if(e.nodeType===1){if(i){e["s-ih"]=(o=e.hidden)!==null&&o!==void 0?o:false}e.hidden=true}}}}if(xZ){oJ(c.U)}HJ.N&=~1;aJ.length=0}};const dJ=(t,e)=>{if(e&&!t.ot&&e["s-p"]){e["s-p"].push(new Promise((e=>t.ot=e)))}};const fJ=(t,e)=>{{t.N|=16}if(t.N&4){t.N|=512;return}dJ(t,t.ut);const i=()=>pJ(t,e);return iK(i)};const pJ=(t,e)=>{const i=IZ("scheduleUpdate",t.H.J);const n=t.ct;let s;if(e){{s=xJ(n,"componentWillLoad")}}i();return mJ(s,(()=>gJ(t,n,e)))};const mJ=(t,e)=>yJ(t)?t.then(e):e();const yJ=t=>t instanceof Promise||t&&t.then&&typeof t.then==="function";const gJ=async(t,e,i)=>{var n;const s=t.V;const r=IZ("update",t.H.J);const o=s["s-rc"];if(i){qZ(t)}const a=IZ("render",t.H.J);{vJ(t,e,s,i)}if(o){o.map((t=>t()));s["s-rc"]=undefined}a();r();{const e=(n=s["s-p"])!==null&&n!==void 0?n:[];const i=()=>wJ(t);if(e.length===0){i()}else{Promise.all(e).then(i);t.N|=4;e.length=0}}};const vJ=(t,e,i,n)=>{try{e=e.render();{t.N&=~16}{t.N|=2}{{{hJ(t,e,n)}}}}catch(e){$J(e,t.V)}return null};const wJ=t=>{const e=t.H.J;const i=t.V;const n=IZ("postUpdate",e);const s=t.ct;const r=t.ut;{xJ(s,"componentDidRender")}if(!(t.N&64)){t.N|=64;{_J(i)}{xJ(s,"componentDidLoad")}n();{t.ht(i);if(!r){SJ()}}}else{n()}{t.ft(i)}{if(t.ot){t.ot();t.ot=undefined}if(t.N&512){tK((()=>fJ(t,false)))}t.N&=~(4|512)}};const bJ=t=>{{const e=PJ(t);const i=e.V.isConnected;if(i&&(e.N&(2|16))===2){fJ(e,false)}return i}};const SJ=e=>{{_J(BJ.documentElement)}tK((()=>UZ(GJ,"appload",{detail:{namespace:t}})))};const xJ=(t,e,i)=>{if(t&&t[e]){try{return t[e](i)}catch(t){$J(t)}}return undefined};const _J=t=>t.classList.add("hydrated");const MJ=(t,e)=>PJ(t).yt.get(e);const kJ=(t,e,i,n)=>{const s=PJ(t);const r=s.V;const o=s.yt.get(e);const a=s.N;const l=s.ct;i=DZ(i,n.gt[e][0]);const u=Number.isNaN(o)&&Number.isNaN(i);const c=i!==o&&!u;if((!(a&8)||o===undefined)&&c){s.yt.set(e,i);if(l){if(n.vt&&a&128){const t=n.vt[e];if(t){t.map((t=>{try{l[t](i,o,e)}catch(t){$J(t,r)}}))}}if((a&(2|16))===2){fJ(s,false)}}}};const TJ=(t,e,i)=>{var n;const s=t.prototype;if(e.gt){if(t.watchers){e.vt=t.watchers}const r=Object.entries(e.gt);r.map((([t,[n]])=>{if(n&31||i&2&&n&32){Object.defineProperty(s,t,{get(){return MJ(this,t)},set(i){kJ(this,t,i,e)},configurable:true,enumerable:true})}else if(i&1&&n&64){Object.defineProperty(s,t,{value(...e){var i;const n=PJ(this);return(i=n===null||n===void 0?void 0:n.wt)===null||i===void 0?void 0:i.then((()=>{var i;return(i=n.ct)===null||i===void 0?void 0:i[t](...e)}))}})}}));if(i&1){const i=new Map;s.attributeChangedCallback=function(t,n,r){HJ.jmp((()=>{var o;const a=i.get(t);if(this.hasOwnProperty(a)){r=this[a];delete this[a]}else if(s.hasOwnProperty(a)&&typeof this[a]==="number"&&this[a]==r){return}else if(a==null){const i=PJ(this);const s=i===null||i===void 0?void 0:i.N;if(s&&!(s&8)&&s&128&&r!==n){const s=i.ct;const a=(o=e.vt)===null||o===void 0?void 0:o[t];a===null||a===void 0?void 0:a.forEach((e=>{if(s[e]!=null){s[e].call(s,r,n,t)}}))}return}this[a]=r===null&&typeof this[a]==="boolean"?false:r}))};t.observedAttributes=Array.from(new Set([...Object.keys((n=e.vt)!==null&&n!==void 0?n:{}),...r.filter((([t,e])=>e[0]&15)).map((([t,n])=>{var s;const r=n[1]||t;i.set(r,t);if(n[0]&512){(s=e.rt)===null||s===void 0?void 0:s.push([t,r])}return r}))]))}}return t};const AJ=async(t,e,i,n)=>{let s;if((e.N&32)===0){e.N|=32;{s=UJ(i);if(s.then){const t=jZ();s=await s;t()}if(!s.isProxied){{i.vt=s.watchers}TJ(s,i,2);s.isProxied=true}const t=IZ("createInstance",i.J);{e.N|=8}try{new s(e)}catch(t){$J(t)}{e.N&=~8}{e.N|=128}t()}if(s.style){let t=s.style;const e=HZ(i);if(!VJ.has(e)){const n=IZ("registerStyles",i.J);GZ(e,t,!!(i.N&1));n()}}}const r=e.ut;const o=()=>fJ(e,true);if(r&&r["s-rc"]){r["s-rc"].push(o)}else{o()}};const IJ=t=>{};const jJ=t=>{if((HJ.N&1)===0){const e=PJ(t);const i=e.H;const n=IZ("connectedCallback",i.J);if(!(e.N&1)){e.N|=1;{if(i.N&(4|8)){CJ(t)}}{let i=t;while(i=i.parentNode||i.host){if(i["s-p"]){dJ(e,e.ut=i);break}}}if(i.gt){Object.entries(i.gt).map((([e,[i]])=>{if(i&31&&t.hasOwnProperty(e)){const i=t[e];delete t[e];t[e]=i}}))}{AJ(t,e,i)}}else{if(e===null||e===void 0?void 0:e.ct);else if(e===null||e===void 0?void 0:e.bt){e.bt.then((()=>IJ()))}}n()}};const CJ=t=>{const e=t["s-cr"]=BJ.createComment("");e["s-cn"]=true;t.insertBefore(e,t.firstChild)};const EJ=t=>{};const OJ=async t=>{if((HJ.N&1)===0){const e=PJ(t);if(e===null||e===void 0?void 0:e.ct);else if(e===null||e===void 0?void 0:e.bt){e.bt.then((()=>EJ()))}}};const LJ=(t,e)=>{const i={N:e[0],J:e[1]};{i.gt=e[2]}{i.vt=t.vt}{i.rt=[]}Object.assign(t.prototype,{__registerHost(){FJ(this,i)},connectedCallback(){jJ(this)},disconnectedCallback(){OJ(this)},__attachShadow(){{{this.attachShadow({mode:"open"})}}}});t.is=i.J;return TJ(t,i,1|2)};const NJ=(t,e)=>e;const RJ=new WeakMap;const PJ=t=>RJ.get(t);const FJ=(t,e)=>{const i={N:0,V:t,H:e,yt:new Map};{i.wt=new Promise((t=>i.ft=t))}{i.bt=new Promise((t=>i.ht=t));t["s-p"]=[];t["s-rc"]=[]}return RJ.set(t,i)};const DJ=(t,e)=>e in t;const $J=(t,e)=>(0,console.error)(t,e);const zJ=new Map;const UJ=(t,e,i)=>{const n=t.J.replace(/-/g,"_");const s=t.St;const r=zJ.get(s);if(r){return r[n]}
/*!__STENCIL_STATIC_IMPORT_SWITCH__*/return import(`./${s}.entry.js${""}`).then((t=>{{zJ.set(s,t)}return t[n]}),$J)};const VJ=new Map;const GJ=typeof window!=="undefined"?window:{};const BJ=GJ.document||{head:{}};const qJ=GJ.HTMLElement||class{};const HJ={N:0,A:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,n)=>t.addEventListener(e,i,n),rel:(t,e,i,n)=>t.removeEventListener(e,i,n),ce:(t,e)=>new CustomEvent(t,e)};const WJ=t=>Promise.resolve(t);const ZJ=(()=>{try{new CSSStyleSheet;return typeof(new CSSStyleSheet).replaceSync==="function"}catch(t){}return false})();const JJ=[];const KJ=[];const YJ=(t,e)=>i=>{t.push(i);if(!kZ){kZ=true;if(e&&HJ.N&4){tK(XJ)}else{HJ.raf(XJ)}}};const QJ=t=>{for(let e=0;e<t.length;e++){try{t[e](performance.now())}catch(t){$J(t)}}t.length=0};const XJ=()=>{QJ(JJ);{QJ(KJ);if(kZ=JJ.length>0){HJ.raf(XJ)}}};const tK=t=>WJ().then(t);const eK=YJ(JJ,false);const iK=YJ(KJ,true);
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.7.0
 */function nK(){const{classList:t}=document.body;const e=window.matchMedia("(prefers-color-scheme: dark)").matches;const i=()=>t.contains(yZ)||t.contains(mZ)&&e?"dark":"light";const n=t=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:true,detail:{mode:t}}));const s=t=>{r!==t&&n(t);r=t};let r=i();n(r);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(t=>s(t.matches?"dark":"light")));new MutationObserver((()=>s(i()))).observe(document.body,{attributes:true,attributeFilter:["class"]})}function sK(){const t=typeof window!=="undefined"&&typeof location!=="undefined"&&typeof document!=="undefined"&&window.location===location&&window.document===document;if(t){if(document.readyState==="interactive"){nK()}else{document.addEventListener("DOMContentLoaded",(()=>nK()),{once:true})}}}const rK=sK;rK();let oK;function aK(){try{TZ(".")}catch{AZ(su(Nc(oK)))}}function lK(t){const e=[];for(const i of Object.keys(t))customElements.get(`calcite-${i}`)||e.push(t[i]?.());return e.length>0?Promise.all(e):null}oK="components/assets";const uK=Symbol("widget"),cK=Symbol("widget-test-data");const hK=[],dK={},fK=new WeakMap;function pK(t,e){let i=e.children;if(i?.length)for(let e=0;e<i.length;++e)i[e]=pK(t,i[e]);else i=hK;const n=e.vnodeSelector;if(vK(n)){const s=e.properties||dK,r=s.key||n;return{vnodeSelector:"div",properties:{key:r,afterCreate:mK,afterUpdate:yK,afterRemoved:gK,parentWidget:t,widgetConstructor:n,widgetProperties:{...s,key:r,children:i}},children:void 0,text:void 0,domNode:null}}return e}function mK(t,e,i,{parentWidget:n,widgetConstructor:s,widgetProperties:r}){const o=new s(r);o.container=t,fK.set(t,o),o.afterCreate?.(o,t),n.addHandles(Zt((()=>gK(t)))),queueMicrotask((()=>{o[cK].projector.renderNow()}))}function yK(t,e,i,{widgetProperties:n}){const s=fK.get(t);s&&(s.set(n),s.afterUpdate?.(s,t))}function gK(t){const e=fK.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),fK.delete(t))}function vK(t){return"function"==typeof t&&t[uK]}const wK={arrowDown:"esri-icon-arrow-down",arrowUp:"esri-icon-arrow-up",basemap:"esri-icon-basemap",bookmark:"esri-icon-bookmark",calendar:"esri-icon-calendar",checkMark:"esri-icon-check-mark",checkboxUnchecked:"esri-icon-checkbox-unchecked",close:"esri-icon-close",collapse:"esri-icon-collapse",defaultAction:"esri-icon-default-action",description:"esri-icon-description",directions:"esri-icon-directions",dockBottom:"esri-icon-dock-bottom",dockLeft:"esri-icon-dock-left",dockRight:"esri-icon-dock-right",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",download:"esri-icon-download",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",edit:"esri-icon-edit",elevationProfile:"esri-icon-elevation-profile",environmentSettings:"esri-icon-environment-settings",erase:"esri-icon-erase",error:"esri-icon-error",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",gear:"esri-icon-gear",handleHorizontal:"esri-icon-handle-horizontal",handleVertical:"esri-icon-handle-vertical",home:"esri-icon-home",icon:"esri-icon",launchLinkExternal:"esri-icon-launch-link-external",layerList:"esri-icon-layer-list",layers:"esri-icon-layers",left:"esri-icon-left",leftArrows:"esri-icon-left-arrow",leftTriangleArrow:"esri-icon-left-triangle-arrow",lineOfSight:"esri-icon-line-of-sight",link:"esri-icon-link",linkExternal:"esri-icon-link-external",linkHorizontal:"esri-icon-link-horizontal",loadingIndicator:"esri-icon-loading-indicator",locate:"esri-icon-locate",locateCircled:"esri-icon-locate-circled",locked:"esri-icon-locked",mapPin:"esri-icon-map-pin",maximize:"esri-icon-maximize",measure:"esri-icon-measure",measureArea:"esri-icon-measure-area",measureBuildingHeightShadow:"esri-icon-measure-building-height-shadow",measureLine:"esri-icon-measure-line",menu:"esri-icon-menu",minimize:"esri-icon-minimize",minus:"esri-icon-minus",nonVisible:"esri-icon-non-visible",northNavigation:"esri-icon-north-navigation",noticeTriangle:"esri-icon-notice-triangle",organization:"esri-icon-organization",pan:"esri-icon-pan",pan2:"esri-icon-pan2",partlyCloudy:"esri-icon-partly-cloudy",pause:"esri-icon-pause",play:"esri-icon-play",playCircled:"esri-icon-play-circled",plus:"esri-icon-plus",polyline:"esri-icon-polyline",printer:"esri-icon-printer",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",rightArrow:"esri-icon-right-arrow",rightTriangleArrow:"esri-icon-right-triangle-arrow",rotate:"esri-icon-rotate",save:"esri-icon-save",search:"esri-icon-search",settings2:"esri-icon-settings2",slice:"esri-icon-slice",swap:"esri-icon-swap",table:"esri-icon-table",timeClock:"esri-icon-time-clock",tracking:"esri-icon-tracking",trash:"esri-icon-trash",unlockedLinkHorizontal:"esri-icon-unlocked-link-horizontal",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",vertexGps:"esri-icon-vertex-gps",visible:"esri-icon-visible",zoomInFixed:"esri-icon-zoom-in-fixed",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomOutFixed:"esri-icon-zoom-out-fixed",zoomToObject:"esri-icon-zoom-to-object"};const bK=new Set;function SK(t){bK.add(t),t.finally((()=>bK.delete(t)))}var xK;const _K="esri.widgets.Widget";let MK=0;const kK={widgetIcon:wK.checkboxUnchecked};function TK(t,e){for(const i in e)null!=t[i]&&("object"==typeof t[i]&&"object"==typeof e[i]?TK(t[i],e?.[i]):t[i]=e[i]);return t}const AK=pZ({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(t,n,s,r)=>{const o=e?.(t,n,s,r),a=i.test(t);if(!((t=t.replace(i,"")).toLowerCase()in s)||a){const e=t[2].toLowerCase()+t.slice(3),i=t=>o?.call(s,t);s.addEventListener(e,i,a);const n=()=>s.removeEventListener(e,i,a),l=r.afterRemoved;r.afterRemoved=t=>{l?.(t),n()}}return o}},handleInterceptedEvent(t,e,i,n){const{eventPhase:s,type:r}=n,o=s===Event.CAPTURING_PHASE;let a=`on${r}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${r[0].toUpperCase()}${r.slice(1)}${o?"Capture":""}`,l&&a in l))&&(Fx(),t.scheduleRender(),l[a].call(l.bind||i,n))}});let IK=!1,jK=class extends(wM(Pm.EventedAccessor)){constructor(t,e){super(t,e),this._attached=!1,this._projector=AK,this._readyForTrueRender=!1,this.iconClass=kK.widgetIcon,this.icon=null,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=qi((async()=>{if(this._messageBundleProps?.length){const t=await Promise.allSettled(this._messageBundleProps.map((async({bundlePath:t,propertyName:e})=>{if(this.destroyed)return;let i=await yv(t);this.uiStrings&&Object.keys(this.uiStrings)&&(i=TK(ht(i),this.uiStrings)),this[e]=i})));if(this.destroyed)return;for(const e of t)"rejected"===e.status&&Ft.getLogger(this).error("widget-intl:locale-error",this.declaredClass,e.reason)}await this.loadLocale()})),aK();const i="esri-widget-uid-"+rZ(),n=this.render.bind(this);this._trackingTarget=new Cn((()=>{this.autoRenderingEnabled&&this.scheduleRender()}));const s=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const t=n();let e=t.properties;e||(t.properties=e={});const{key:s}=e;if(s||(e.key=i),vK(t.vnodeSelector)){if(!this.visible)return{vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}}else this.visible?e.styles||(e.styles={}):(e.class="",e.styles={display:"none"}),e.styles.display||(e.styles.display="");let r=0;return t.children?.forEach((t=>{if(vK(t.vnodeSelector))return;let{properties:e}=t;e||(t.properties=e={}),e.key||(e.key=`${this.id}--${r++}`)})),pK(this,t)};this.render=()=>{if(IK)return s();let t=Dx(this)??null;if(t)return t;this._trackingTarget.clear(),IK=!0;try{t=Ne(this._trackingTarget,s)}catch(t){throw console.error(t),t}finally{IK=!1}return t&&$x(this,t),t};const r=this.beforeFirstRender();r?this._resourcesFetch=r.then((()=>{this._readyForTrueRender=!0,this._postInitialize()})):(this._resourcesFetch=Promise.resolve().then((()=>{this._postInitialize()})),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),SK(this._resourcesFetch)}normalizeCtorArgs(t,e){const i={...t};return e&&(i.container=e),i}postInitialize(){}beforeFirstRender(){const t=this.loadDependencies();return this._messageBundleProps?.length||t?Promise.all([t,this._loadLocale()]).then((()=>{})).catch(Oi):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||($t(this._trackingTarget),$t(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,zx(this))}set container(t){this._get("container")||this._set("container",t)}castContainer(t){return oS(t)}get domNode(){return this.container}set domNode(t){this.container=t}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+MK++}set id(t){t&&this._set("id",t)}get label(){return this.declaredClass.split(".").pop()}set label(t){this._overrideIfSome("label",t)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(t){this._set("visible",t)}get[(xK=uK,cK)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(zx(this),this._projector.scheduleRender())}own(t){f(Ft.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(t)}classes(...t){return Vx.apply(this,t)}renderNow(){zx(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(fy((()=>this.viewModel),((t,e)=>{e&&this.removeHandles("delegated-events"),t&&Si(t)&&this.addHandles(this._delegatedEventNames.map((e=>Mi(t,e,(t=>{this.emit(e,t)})))),"delegated-events")}),My)),this.postInitialize();const t=async()=>{await this._loadLocale().catch(Oi),this.scheduleRender()};this.addHandles([og(t),fy((()=>this.uiStrings),t),py((()=>this.container),(t=>{this.destroyed||this._attach(t)}),{initial:!0,once:!0})])}_attach(t){t&&(this._projector.merge(t,this.render),this._attached=!0)}_detach(t){this._attached&&(this._projector.detach(this.render),this._attached=!1),t?.parentNode?.removeChild(t)}};jK[xK]=!0,o([Us()],jK.prototype,"_readyForTrueRender",void 0),o([Us({value:null})],jK.prototype,"container",null),o([ol("container")],jK.prototype,"castContainer",null),o([Us()],jK.prototype,"iconClass",void 0),o([Us()],jK.prototype,"icon",void 0),o([Us()],jK.prototype,"id",null),o([Us()],jK.prototype,"label",null),o([Us()],jK.prototype,"renderable",null),o([Us()],jK.prototype,"uiStrings",void 0),o([Us()],jK.prototype,"viewModel",void 0),o([Us({value:!0})],jK.prototype,"visible",null),o([Us()],jK.prototype,"key",void 0),o([Us()],jK.prototype,"children",void 0),o([Us()],jK.prototype,"afterCreate",void 0),o([Us()],jK.prototype,"afterUpdate",void 0),o([Us()],jK.prototype,"afterRemoved",void 0),jK=o([Nr(_K)],jK);const CK=jK;const EK=new Map;function OK(t){return EK.get(t)}function LK(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function NK(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}function RK(t,e,i){if(!i||!e)return;t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e})}function PK(t){return"bing-maps"===t.type}const FK=[];let DK=class extends Vr{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new ty,this.view=null,this._allLayerViewsChange=t=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const e=this.view?.allLayerViews;e&&(this.addHandles(e.map((t=>fy((()=>[t.suspended,t.layer?.attributionVisible]),(()=>this._updateAttributionItems())))).toArray(),"suspension"),e.forEach((t=>{"esri.views.3d.layers.Tiles3DLayerView3D"===t.declaredClass&&this.addHandles(t.on("visible-geometry-changed",(()=>this._updateAttributionItems())),"visible-geometry-changed")}))),t?.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t)})),this._updateAttributionItems()},this.addHandles([yy((()=>this.view?.allLayerViews),"change",(t=>this._allLayerViewsChange(t)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),py((()=>!0===this.view?.stationary),(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t?.allLayerViews;if(FK.length=0,!t||!e)return void this._clear();e.forEach((e=>{if(e.suspended||!e.layer?.attributionVisible)return;const i=e.layer;if(LK(i,"user"))return void RK(FK,e,i.copyright);if(i.hasAttributionData){if(this._fetchedAttributionData.has(e)){const n=this._fetchedAttributionData.get(e);return void(n?RK(FK,e,this._getDynamicAttribution(n,t,i)):LK(i)&&RK(FK,e,i.copyright))}return void this._fetchAttributionData(e)}const n="portalItem"in i?i.portalItem?.accessInformation:void 0;RK(FK,e,n||i.copyright)}));const i=e.find((t=>"integrated-mesh-3dtiles"===t.layer?.type));if(this.view&&i){const t=OK(this.view);if(t){const e=t.getAttributionText();for(let t=0;t<e.length;++t)RK(FK,i,e[t])}}NK(this.items,FK)&&(this.items.removeAll(),this.items.addMany(FK)),FK.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await ay(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,PK(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,e){const i=t.contributors,n={};if(!i)return n;for(let t=0;t<i.length;t++){const s=i[t],r=s.coverageAreas;if(!r)return;for(const i of r){const r=i.bbox,o=i.zoomMin-(e&&i.zoomMin?1:0),a=i.zoomMax-(e&&i.zoomMax?1:0),l=new Rf({xmin:r[1],ymin:r[0],xmax:r[3],ymax:r[2],spatialReference:jd.WGS84}),u={extent:Hd(l),attribution:s.attribution||"",score:null!=i.score?i.score:100,id:t};for(let t=o;t<=a;t++)n[t]??=[],n[t].push(u)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(t,e,i){const{extent:n,scale:s}=e;let r=i.tileInfo?.scaleToZoom(s)??0;if(r=Math.min(t.maxKey??0,Math.round(r)),!n||null==r||r<=-1)return"";const o=t[r],a=Gd(n.center.clone().normalize(),e.spatialReference),l=new Set;return o?o.filter((t=>{const e=t.id,i=!l.has(e)&&a&&t.extent&&nf(t.extent,a);return i&&l.add(e),i})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};o([Us({readOnly:!0,type:ty})],DK.prototype,"items",void 0),o([Us({readOnly:!0})],DK.prototype,"state",null),o([Us()],DK.prototype,"view",void 0),DK=o([Nr("esri.widgets.Attribution.AttributionViewModel")],DK);const $K=DK;const zK={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};function UK(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:GK(t[e])}}}function VK(t){const e=t?.type;return t instanceof KeyboardEvent||"keyup"===e||"keydown"===e||"keypress"===e}function GK(t){return function(e,...i){VK(e)?Qx(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}function BK(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]);e._messageBundleProps.push({bundlePath:t,propertyName:i})}}var qK=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},HK=function(t,e){for(var i=0,n=t.length;i<n;i++){var s=t[i];Array.isArray(s)?HK(s,e):null!=s&&!1!==s&&(s.hasOwnProperty("vnodeSelector")||(s=qK(s)),e.push(s))}},WK=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(1===i.length&&"string"==typeof i[0])return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var s=[];return HK(i,s),{vnodeSelector:t,properties:e||void 0,children:s,text:void 0,domNode:null}};function ZK(t,e,...i){return"function"!=typeof t||vK(t)?WK(t,e,...i):t(e,...i)}function JK(...t){return t}const KK="esri-attribution",YK={base:KK,poweredBy:`${KK}__powered-by`,sources:`${KK}__sources`,open:`${KK}--open`,sourcesOpen:`${KK}__sources--open`,link:`${KK}__link`,widgetIcon:wK.description};let QK=class extends CK{constructor(t,e){super(t,e),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((t=>t.forEach((({target:t})=>this._checkSourceTextOverflow(t))))),this.iconClass=YK.widgetIcon,this.icon=null,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new $K}initialize(){this.addHandles(yy((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((t,e)=>(t.includes(e.text)||t.push(e.text),t)),[]).join(this.itemDelimiter)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t={[YK.open]:this._isOpen};return ZK("div",{bind:this,class:this.classes(YK.base,zK.widget,t),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return ZK("div",{class:YK.poweredBy},"Powered by"," ",ZK("a",{class:YK.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const t=this._isOpen,e=this._isInteractive,i=e?0:void 0,{attributionText:n}=this,s={[YK.sourcesOpen]:t,[zK.interactive]:e};return ZK("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(YK.sources,s),innerHTML:n,tabIndex:i})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth,this._resizeObserver.observe(t)}_checkSourceTextOverflow(t){let e=!1;const{clientHeight:i,clientWidth:n,scrollWidth:s}=t,r=s>n,o=this._attributionTextOverflowed!==r;if(this._attributionTextOverflowed=r,o&&(e=!0),this._isOpen){const t=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,t&&(this._isOpen=!1,e=!0)}e&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};o([Us()],QK.prototype,"_isOpen",void 0),o([Us()],QK.prototype,"_isInteractive",null),o([Us()],QK.prototype,"_attributionTextOverflowed",void 0),o([Us()],QK.prototype,"_prevSourceNodeHeight",void 0),o([Us({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],QK.prototype,"attributionText",null),o([Us()],QK.prototype,"iconClass",void 0),o([Us()],QK.prototype,"icon",void 0),o([Us()],QK.prototype,"itemDelimiter",void 0),o([Us()],QK.prototype,"label",null),o([Us(),BK("esri/widgets/Attribution/t9n/Attribution")],QK.prototype,"messages",void 0),o([Us()],QK.prototype,"view",null),o([Us({type:$K})],QK.prototype,"viewModel",void 0),o([UK()],QK.prototype,"_toggleState",null),QK=o([Nr("esri.widgets.Attribution")],QK);const XK=QK;function tY(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}const eY=t=>{let e=class extends t{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:e}=this;return Dt(e),this.goToOverride?this.goToOverride(e,t):e.goTo(t.target,t.options)}};return o([Us()],e.prototype,"goToOverride",void 0),o([Us()],e.prototype,"view",void 0),e=o([Nr("esri.widgets.support.GoTo")],e),e};const iY="esri.widgets.CompassViewModel";let nY=class extends(eY(Vr)){constructor(t){super(t),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles(fy((()=>this.view),this._updateRotationWatcher,_y))}destroy(){this.view=null}get canShowNorth(){return tY(this.view)}get state(){return!this.view?.ready||"2d"===this.view.type&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){if(!this.view?.ready)return;const t={};"2d"===this.view?.type?t.rotation=0:t.heading=0,this.callGoTo({target:t})}_updateForRotation(t){null!=t&&(this.orientation={z:t})}_updateForCamera(t){if(!t)return;const e=-t.heading;this.orientation={x:0,y:0,z:e}}_updateRotationWatcher(t){this.removeAllHandles(),t&&this.addHandles("2d"===t.type?fy((()=>t?.rotation),this._updateForRotation,_y):fy((()=>t?.camera),this._updateForCamera,_y))}};o([Us({readOnly:!0})],nY.prototype,"canShowNorth",null),o([Us()],nY.prototype,"orientation",void 0),o([Us({readOnly:!0})],nY.prototype,"state",null),o([Us()],nY.prototype,"view",void 0),nY=o([Nr(iY)],nY);const sY=nY;const rY="esri-compass",oY={base:rY,widgetIcon:wK.locateCircled,iconContainer:`${rY}__icon-container`};let aY=class extends CK{constructor(t,e){super(t,e),this.iconClass=oY.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new sY,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=t=>({transform:`rotateZ(${t.z}deg)`})}loadDependencies(){return lK({button:()=>import("./p-9ffe80e7.js"),icon:()=>import("./p-9ea19e2a.js")})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}reset(){return this.viewModel.reset()}render(){const{orientation:t,state:e}=this.viewModel,i="rotation"===e?"arrow-up":"compass-needle",n=this.icon??i,{messages:s}=this;return ZK("div",{class:this.classes(oY.base,zK.widget)},ZK("calcite-button",{class:zK.widgetButton,disabled:"disabled"===e,kind:"neutral",label:s.reset,onclick:this._reset,round:!0,scale:"s",title:s.reset},ZK("div",{"aria-hidden":"true",class:oY.iconContainer,title:s.reset},ZK("calcite-icon",{icon:n,scale:"m",styles:this._toRotationTransform(t)}))))}};o([Us()],aY.prototype,"goToOverride",null),o([Us()],aY.prototype,"iconClass",void 0),o([Us()],aY.prototype,"icon",void 0),o([Us()],aY.prototype,"label",null),o([Us(),BK("esri/widgets/Compass/t9n/Compass")],aY.prototype,"messages",void 0),o([Us()],aY.prototype,"view",null),o([Us({type:sY})],aY.prototype,"viewModel",void 0),aY=o([Nr("esri.widgets.Compass")],aY);const lY=aY;const uY="esri-navigation-toggle",cY={base:uY,widgetIcon:wK.pan2,isLayoutHorizontal:`${uY}--horizontal`};let hY=class extends Vr{constructor(t){super(t),this.navigationMode="pan",this.view=null}initialize(){this.addHandles(py((()=>this.view?.inputManager),(()=>this._setNavigationMode())))}destroy(){this.view=null}get state(){return this.view?.ready&&"3d"===this.view?.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){const t=this.view?.inputManager;t&&(t.primaryDragAction="pan"===this.navigationMode?"pan":"rotate")}};o([Us({readOnly:!0})],hY.prototype,"state",null),o([Us()],hY.prototype,"navigationMode",void 0),o([Us()],hY.prototype,"view",void 0),hY=o([Nr("esri.widgets.NavigationToggleViewModel")],hY);const dY=hY;let fY=class extends CK{constructor(t,e){super(t,e),this.iconClass=cY.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new dY,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const t="pan"===this.viewModel?.navigationMode?this._rotateButton:this._panButton;t?.setFocus(),this.toggle()}}loadDependencies(){return lK({button:()=>import("./p-9ffe80e7.js")})}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t="disabled"===this.viewModel?.state,e="pan"===this.viewModel?.navigationMode,i=this.messages.toggle;return ZK("div",{class:this.classes(cY.base,zK.widget,{[cY.isLayoutHorizontal]:"horizontal"===this.layout})},ZK("calcite-button",{afterCreate:t=>{this._panButton=t},appearance:e?"outline-fill":"solid",class:zK.widgetButton,disabled:t,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:e?void 0:-1,title:i}),ZK("calcite-button",{afterCreate:t=>{this._rotateButton=t},appearance:e?"solid":"outline-fill",class:zK.widgetButton,disabled:t,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:e?-1:void 0,title:i}))}};o([Us()],fY.prototype,"iconClass",void 0),o([Us()],fY.prototype,"icon",void 0),o([Us()],fY.prototype,"label",null),o([Us({value:"vertical"})],fY.prototype,"layout",null),o([Us(),BK("esri/widgets/NavigationToggle/t9n/NavigationToggle")],fY.prototype,"messages",void 0),o([Us()],fY.prototype,"view",null),o([Us({type:dY})],fY.prototype,"viewModel",void 0),fY=o([Nr("esri.widgets.NavigationToggle")],fY);const pY=fY;let mY=class extends Vr{get canZoomIn(){const t=this.view?.ready;if(!t)return!1;const e=this.view?.constraints?.effectiveMaxScale;return 0===e||this._scale>e}get canZoomOut(){const{view:t}=this,e=t?.ready;if(!e)return!1;const i=t.constraints?.effectiveMinScale;return 0===i||this._scale<i}get _scale(){const t=this.view?.animation?.target;return(t&&"then"in t?void 0:t?.scale)??this.view?.scale??0}};o([Us({readOnly:!0})],mY.prototype,"canZoomIn",null),o([Us({readOnly:!0})],mY.prototype,"canZoomOut",null),o([Us()],mY.prototype,"view",void 0),o([Us()],mY.prototype,"_scale",null),mY=o([Nr("esri.widgets.Zoom.ZoomConditions2D")],mY);const yY=mY;let gY=class extends Vr{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};o([Us({readOnly:!0})],gY.prototype,"canZoomIn",null),o([Us({readOnly:!0})],gY.prototype,"canZoomOut",null),o([Us()],gY.prototype,"view",void 0),gY=o([Nr("esri.widgets.Zoom.ZoomConditions3D")],gY);const vY=gY;let wY=class extends Vr{constructor(t){super(t)}destroy(){this.view=null}get canZoomIn(){return null!=this._zoomConditions&&this._zoomConditions.canZoomIn}get canZoomOut(){return null!=this._zoomConditions&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(t){t?"2d"===t.type?this._zoomConditions=new yY({view:t}):"3d"===t.type&&(this._zoomConditions=new vY({view:t})):this._zoomConditions=null,this._set("view",t)}zoomIn(){if(!this.canZoomIn)return;const t=this.view;"2d"===t.type?t.mapViewNavigation.zoomIn():Fi(t.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const t=this.view;"2d"===t.type?t.mapViewNavigation.zoomOut():Fi(t.goTo({zoomFactor:.5}))}};o([Us()],wY.prototype,"_zoomConditions",void 0),o([Us()],wY.prototype,"canZoomIn",null),o([Us()],wY.prototype,"canZoomOut",null),o([Us({readOnly:!0})],wY.prototype,"state",null),o([Us()],wY.prototype,"view",null),wY=o([Nr("esri.widgets.Zoom.ZoomViewModel")],wY);const bY=wY;const SY={base:"esri-zoom",widgetIcon:wK.zoomInMagnifyingGlass,horizontalLayout:"esri-zoom--horizontal"};let xY=class extends CK{constructor(t,e){super(t,e),this.iconClass=SY.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new bY,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return lK({button:()=>import("./p-9ffe80e7.js")})}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t)}set view(t){this.viewModel.view=t}get view(){return this.viewModel.view}render(){const t={[SY.horizontalLayout]:"horizontal"===this.layout},{canZoomIn:e,canZoomOut:i}=this.viewModel,{zoomIn:n,zoomOut:s}=this.messages;return ZK("div",{class:this.classes(SY.base,zK.widget,t)},ZK("calcite-button",{class:zK.widgetButton,disabled:!e,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),ZK("calcite-button",{class:zK.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:s,onclick:this.zoomOut,title:s}))}};o([Us()],xY.prototype,"iconClass",void 0),o([Us()],xY.prototype,"icon",void 0),o([Us()],xY.prototype,"label",null),o([Us({value:"vertical"})],xY.prototype,"layout",null),o([Us(),BK("esri/widgets/Zoom/t9n/Zoom")],xY.prototype,"messages",void 0),o([Us()],xY.prototype,"view",null),o([Us({type:bY})],xY.prototype,"viewModel",void 0),xY=o([Nr("esri.widgets.Zoom")],xY);const _Y=xY;function MY(t){return void 0!==t?.view}let kY=class extends nZ{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=t=>{this.components.forEach((e=>{const i=this._find(e),n=i?.widget;MY(n)&&(n.view=t)}))},this._componentsWatcher=(t,e)=>{this._removeComponents(e),this._addComponents(t),this._adjustPadding(t)}}initialize(){this.addHandles([fy((()=>this.components),this._componentsWatcher,_y),fy((()=>this.view),this._updateViewAwareWidgets,_y)])}_add(t,e,i,n,s){let r=t;if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;r=this._createComponent(t)}super._add(r,e,i,n,s)}_removeComponents(t){t.forEach((t=>{const e=this._find(t);e&&(this.remove(e),e.destroy())}))}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(t){this.constructed&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])))}_createComponent(t){const e=this._createWidget(t);return new UW({id:t,node:e})}_createWidget(t){const{view:e}=this;switch(t){case"attribution":return new XK({view:e});case"compass":return new lY({view:e});case"navigation-toggle":return new pY({view:e});case"zoom":return new _Y({view:e})}}};o([Us()],kY.prototype,"components",void 0),kY=o([Nr("esri.views.ui.DefaultUI")],kY);const TY=kY;let AY=class extends TY{constructor(t){super(t),this.components=["attribution","zoom"]}};o([Us()],AY.prototype,"components",void 0),AY=o([Nr("esri.views.ui.2d.DefaultUI2D")],AY);const IY=AY;function jY(t){return null!=t&&"object"==typeof t&&"declaredClass"in t&&"esri.WebMap"===t.declaredClass}var CY;let EY=CY=class extends el{constructor(t){super(t),this.color=new wT([0,0,0,1])}clone(){return new CY(ht({color:this.color}))}};o([Us({type:wT,json:{write:!0}})],EY.prototype,"color",void 0),EY=CY=o([Nr("esri.webmap.background.ColorBackground")],EY);const OY=EY;let LY,NY,RY,PY,FY,DY;async function $Y(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:n,MagnifierView2D:s,Stage:r}]=await Promise.all([import("./p-fbd1822d.js"),import("./p-b5b3e033.js")]);NY=t,RY=e,PY=i,FY=n,DY=s,LY=r}let zY=class extends(rS(hM(G_(gz)))){constructor(t){super(t),this._magnifierView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new dy({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new fG({view:this}),this.graphicsView=null,this.stateManager=new wq({constraints:new EG({view:this})}),this.stationaryManager=new AW,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new dG(this),this.floors=new ty,this.highlightOptions=new KH,this.inputManager=new bH({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new jW,this.type="2d",this.ui=new IY,this.test={takeScreenshot:async t=>SW(this._getScreenshotView(t),t)},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([fy((()=>this.viewpoint),(()=>this.stationaryManager.flip()),xy),this.on("resize",(t=>this.stateManager.resize(t.width,t.height)))]),Kv()}destroy(){this._set("preconditionsReady",!1),this.frameTask=$t(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new ZH(this.featuresTilingScheme)}get constraintsInfo(){const t=this.defaultsFromMap?.tileInfo,e=this.spatialReference;return{lods:t?.spatialReference?.equals(e)?t.lods:null,spatialReference:e}}get state(){return this.stateManager.state}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:t,constraints:e,center:i,viewpoint:n,extent:s}=this;let r=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&(!s&&(e?.effectiveLODs||(r=-1),(!i||0===t&&-1===r)&&(null==n?.targetGeometry||"extent"!==n.targetGeometry.type&&!n.scale)))}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get typeSpecificPreconditionsReady(){const t=this._getDefaultViewpoint();if(!t)return!1;const e=t.targetGeometry,i=this.spatialReference;return yb(e.spatialReference,i)}set animation(t){const e=this._get("animation");if(t===e)return;if(e&&e.stop(),t!==this.animationManager.animation&&this.animationManager.stop(),!t||t.isFulfilled())return this._set("animation",null),void(this.frameTask.animationInProgress=!1);this._set("animation",t),this.frameTask.animationInProgress=!0;const i=()=>{this.destroyed||(t===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame()),this.frameTask.animationInProgress=!1)};t.when(i,i)}get background(){return jY(this.map)?this.map.initialViewProperties.background:null}set background(t){this._override("background",t)}get center(){return this.stateManager?.center??null}set center(t){this.stateManager.center=t}get constraints(){return this.stateManager?.constraints}set constraints(t){t.view=this;const e=this.stateManager.constraints;this.stateManager.constraints=t,e?.destroy()}get extent(){return this.stateManager?.extent??null}set extent(t){this.stateManager.extent=t}get padding(){return this.stateManager?.padding}set padding(t){this.stateManager&&(this.stateManager.padding=t)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(t){this.stateManager.resizeAlign=t}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(t){const{rotationEnabled:e}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=t,this.constraints.rotationEnabled=e}get scale(){return this.stateManager?.scale??0}set scale(t){this.stateManager&&(this.stateManager.scale=t)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get updating(){const t=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||!0===this.layerViewManager.updating||!0===this.labelManager.updating||!0===this.graphicsView.updating||this.allLayerViews.some((t=>!t.destroyed&&!("layerViews"in t)&&!0===t.updating)));if(c("esri-2d-log-updating")){const e=this.allLayerViews.reduce(((t,e)=>({...t,[`${e.layer.id}(${e.layer.type})`]:!e.destroyed&&!("layerViews"in e)&&e.updating})),{});console.log(`Updating MapView: ${t}\n-> Null LayerViewManager: ${!this.layerViewManager}\n-> Null LabelManager: ${!this.labelManager}\n-> Null GraphicsView: ${!this.graphicsView}\n-> layerViewManager.updating: ${this.layerViewManager?.updating}\n-> labelManager.updating: ${this.labelManager?.updating}\n-> graphicsView.updating: ${this.graphicsView?.updating}\n-> allLayerViews: ${JSON.stringify(e)}\n`)}return t}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(t){this.stateManager.viewpoint=t,this.frameTask.requestFrame()}get zoom(){return this.stateManager.zoom??-1}set zoom(t){this.stateManager.zoom=t}get navigating(){return this.mapViewNavigation?.interacting??!1}goTo(t,e){return this.goToManager.goTo(t,e)}async hitTest(t,e){return YH(this,t,e)}async takeScreenshot(t){return bW(this._getScreenshotView(t),t)}toMap(t){if(!this.ready)return null;const e=m$(t)?p$(this,t):t;return this.stateManager.toMap(e)}toScreen(t,e){return this.stateManager.toScreen(t,e)}on(t,e,i,n){const s=this.inputManager&&this.viewEvents.on(t,e,i,n);return s||super.on(t,e)}hasEventListener(t){return super.hasEventListener(t)||this.viewEvents.hasHandler(t)}whenLayerView(t){return super.whenLayerView(t)}graphicChanged(t){if(this.graphicsView){this.graphicsView.graphicUpdateHandler(t)}}whenReady(){return new Promise((t=>{this.ready?t(this):this._resolveWhenReady.push(t)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map?.initialViewProperties?.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return jY(this.map)?this.map.initialViewProperties.timeZone:null}hasLayerViewModule(t){return wG.hasLayerViewModule(t)}importLayerView(t){return wG.importLayerView(t)}pixelSizeAt(){return this.ready?this.resolution:(Ft.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(t){const e=this.toMap(t),i=await this.hitTest(t),n=this.allLayerViews.toArray().reverse(),s=new globalThis.Map(n.map((t=>[t.layer.uid,t]))),r=[];let o=0,a=0;for(;o<i.results.length||a<n.length;){const t=i.results.at(o);if(t&&"graphic"!==t.type){++o;continue}const l=s.get((t?.layer??t?.graphic.layer)?.uid);if((!t||l)&&a<n.length&&n.at(a)!==l){const t=n.at(a);"fetchPopupFeaturesAtLocation"in t&&r.push({mapPoint:e,layerView:t}),++a}else t&&(r.push({graphic:t.graphic,layerView:l}),++o)}return{hits:r,location:e}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let t=PW(this.type);if(c("safari")&&c("safari")<9&&(t=new Qe("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:c("safari")})),null!=t)throw Ft.getLogger(this).warn("#validate()",t.message),t}loadAsyncDependencies(){return $Y()}_getDefaultViewpoint(){const{constraints:t,initialExtent:e,map:i,padding:n,size:s}=this;if(!t)return null;const r=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,o=this.stateManager.getUserStartupOptions(this.size),a=r?.viewpoint,l=a?.targetGeometry?.extent??e,u=l?.center,c=a?.rotation??0,h=a?.scale||l&&IV(l,[s[0]-n.left-n.right,s[1]-n.top-n.bottom]),d=o.center??u,f=o.rotation??c,p=o.scale??h;return d&&p?new Nm({targetGeometry:d,scale:p,rotation:f}):null}_startup(){this.timeline.begin("MapView Startup");const t=this._getDefaultViewpoint();this.stateManager.startup(t,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const e=new LY(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=e,this._magnifierView=new DY,this._magnifierView.magnifier=this.magnifier;const i=new PY({view:this});this._set("labelManager",i);const n=new hG({view:this});this._set("animationManager",n);const s=new FY({view:this,animationManager:n});this._set("mapViewNavigation",s),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),e.on("webgl-error",(t=>this.fatalError=t.error)),fy((()=>this.stationary),(t=>e.stationary=t),My),fy((()=>this.background),(t=>{e.backgroundColor=t?.color,this._magnifierView.backgroundColor=t?.color}),My),fy((()=>this.magnifier),(t=>this._magnifierView.magnifier=t),My),fy((()=>this.renderingOptions),(t=>e.renderingOptions=t),My),fy((()=>this.highlightOptions),(t=>e.highlightOptions=t),My),fy((()=>this.state.id),(()=>e.state=this.state),My)],"map-view"),this._updateStageChildren();const r=this._resolveWhenReady;this._resolveWhenReady=[],r.forEach((t=>t(this))),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach((t=>{this.stage.addChild(t.container)}));const t=this.graphicsView;this.stage.addChild(t.container),this.stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const t=new BG(tS.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",t);const e=new NY({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new RY(t)});this._set("graphicsView",e)}_destroySpatialReferenceDependentProperties(){const t=this.graphicsView;this._set("graphicsView",null),t.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(t){const{allLayerViews:e,padding:i,size:n,stage:s}=this;return{allLayerViews:e,backgroundColor:t?.ignoreBackground?null:this.background?.color,padding:i,size:n,stage:s}}_spatialReferenceChanged(t){if(this.ready){this.frameTask.stop();for(const t of this.allLayerViews)t.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(t),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const t of this.allLayerViews)t.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};zY.type="2d",o([Us({readOnly:!0})],zY.prototype,"animationManager",void 0),o([Us({constructOnly:!0})],zY.prototype,"deactivatedWebGLExtensions",void 0),o([Us({constructOnly:!0})],zY.prototype,"debugWebGLExtensions",void 0),o([Us({readOnly:!0})],zY.prototype,"featuresTilingScheme",void 0),o([Us({readOnly:!0})],zY.prototype,"fullOpacity",void 0),o([Us()],zY.prototype,"goToManager",void 0),o([Us({readOnly:!0})],zY.prototype,"graphicsTileStore",null),o([Us()],zY.prototype,"graphicsView",void 0),o([Us()],zY.prototype,"stateManager",void 0),o([Us()],zY.prototype,"constraintsInfo",null),o([Us({readOnly:!0})],zY.prototype,"state",null),o([Us()],zY.prototype,"initialExtentRequired",null),o([Us()],zY.prototype,"labelManager",void 0),o([Us({readOnly:!0})],zY.prototype,"mapViewNavigation",void 0),o([Us({constructOnly:!0})],zY.prototype,"renderCanvas",void 0),o([Us()],zY.prototype,"renderingOptions",void 0),o([Us({constructOnly:!0})],zY.prototype,"supersampleScreenshotsEnabled",void 0),o([Us({readOnly:!0})],zY.prototype,"supportsGround",void 0),o([Us()],zY.prototype,"_defaultsFromMapSettings",null),o([Us({readOnly:!0})],zY.prototype,"typeSpecificPreconditionsReady",null),o([Us()],zY.prototype,"animation",null),o([Us({type:OY})],zY.prototype,"background",null),o([Us()],zY.prototype,"center",null),o([Us({type:EG})],zY.prototype,"constraints",null),o([Us()],zY.prototype,"extent",null),o([Us()],zY.prototype,"floors",void 0),o([Us({type:KH})],zY.prototype,"highlightOptions",void 0),o([Us({readOnly:!0})],zY.prototype,"inputManager",void 0),o([Us()],zY.prototype,"map",void 0),o([Us()],zY.prototype,"padding",null),o([Us({readOnly:!0})],zY.prototype,"rendering",null),o([Us()],zY.prototype,"resizeAlign",null),o([Us({readOnly:!0})],zY.prototype,"resolution",null),o([Us()],zY.prototype,"rotation",null),o([Us()],zY.prototype,"scale",null),o([Us({constructOnly:!0})],zY.prototype,"spatialReferenceLocked",void 0),o([Us()],zY.prototype,"stationary",null),o([Us({type:jW,readOnly:!0})],zY.prototype,"timeline",void 0),o([Us({readOnly:!0})],zY.prototype,"type",void 0),o([Us({readOnly:!0})],zY.prototype,"updating",null),o([Us()],zY.prototype,"viewpoint",null),o([Us()],zY.prototype,"zoom",null),o([Us({readOnly:!0})],zY.prototype,"navigating",null),o([Us(),ol((t=>t instanceof TY?t:Ss(IY,t)))],zY.prototype,"ui",void 0),zY=o([Nr("esri.views.MapView")],zY);const UY=zY;class VY{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(_e),this._values=new Map,this.multipleOriginsSupported=!0}clone(t){const e=new VY,i=this._originStores[xe.DEFAULTS];i&&i.forEach(((t,i)=>{e.set(i,ht(t),xe.DEFAULTS)}));for(let i=xe.SERVICE;i<_e;i++){const n=this._originStores[i];n&&n.forEach(((n,s)=>{t&&t.has(s)||e.set(s,ht(n),i)}))}return e}get(t,e){const i=void 0===e?this._values:this._originStores[e];return i?i.get(t):void 0}keys(t){const e=null==t?this._values:this._originStores[t];return e?[...e.keys()]:[]}set(t,e,i=xe.USER){let n=this._originStores[i];if(n||(n=new Map,this._originStores[i]=n),n.set(t,e),!this._values.has(t)||this._propertyOriginMap.get(t)<=i){const n=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,i),n!==e}return!1}delete(t,e=xe.USER){const i=this._originStores[e];if(!i)return;const n=i.get(t);if(i.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===e){this._values.delete(t);for(let i=e-1;i>=0;i--){const e=this._originStores[i];if(e&&e.has(t)){this._values.set(t,e.get(t)),this._propertyOriginMap.set(t,i);break}}}return n}has(t,e){const i=void 0===e?this._values:this._originStores[e];return!!i&&i.has(t)}revert(t,e){for(;e>0&&!this.has(t,e);)--e;const i=this._originStores[e],n=i?.get(t),s=this._values.get(t);return this._values.set(t,n),this._propertyOriginMap.set(t,e),s!==n}originOf(t){return this._propertyOriginMap.get(t)||xe.DEFAULTS}forEach(t){this._values.forEach(t)}}const GY=t=>{let e=class extends t{constructor(...t){super(...t);const e=Yt(this),i=e.store,n=new VY;e.store=n,$a(e,i,n)}read(t,e){qa(this,t,e)}getAtOrigin(t,e){const i=BY(this),n=Me(e);if("string"==typeof t)return i.get(t,n);const s={};return t.forEach((t=>{s[t]=i.get(t,n)})),s}originOf(t){return ke(this.originIdOf(t))}originIdOf(t){return BY(this).originOf(t)}revert(t,e){const i=BY(this),n=Me(e),s=Yt(this);let r;r="string"==typeof t?"*"===t?i.keys(n):[t]:t,r.forEach((t=>{s.invalidate(t),i.revert(t,n),s.commit(t)}))}};return e=o([Nr("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function BY(t){return Yt(t).store}let qY=class extends(GY(Vr)){};qY=o([Nr("esri.core.ReadOnlyMultiOriginJSONSupport")],qY);const HY=t=>{let e=class extends t{constructor(...t){super(...t)}clear(t,e="user"){return WY(this).delete(t,Me(e))}write(t,e){return Ya(this,t=t||{},e),t}setAtOrigin(t,e,i){Yt(this).setAtOrigin(t,e,Me(i))}removeOrigin(t){const e=WY(this),i=Me(t),n=e.keys(i);for(const t of n)e.originOf(t)===i&&e.set(t,e.get(t,i),xe.USER)}updateOrigin(t,e){const i=WY(this),n=Me(e),s=le(this,t);for(let e=n+1;e<_e;++e)i.delete(t,e);i.set(t,s,n)}toJSON(t){return this.write({},t)}};return e=o([Nr("esri.core.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function WY(t){return Yt(t).store}const ZY=t=>{let e=class extends(HY(GY(t))){constructor(...t){super(...t)}};return e=o([Nr("esri.core.MultiOriginJSONSupport")],e),e};let JY=class extends(ZY(Vr)){};JY=o([Nr("esri.core.MultiOriginJSONSupport")],JY);var KY;let YY=KY=class extends el{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new KY({minValue:this.minValue,maxValue:this.maxValue})}};o([Us({type:Number,json:{write:!0}})],YY.prototype,"minValue",void 0),o([Us({type:Number,json:{write:!0}})],YY.prototype,"maxValue",void 0),YY=KY=o([Nr("esri.renderer.support.AuthoringInfoClassBreakInfo")],YY);var QY;let XY=QY=class extends el{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new QY({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:ht(this.classBreakInfos)})}};o([Us({type:String,json:{write:!0}})],XY.prototype,"field",void 0),o([Us({type:String,json:{write:!0}})],XY.prototype,"normalizationField",void 0),o([Us({type:String,json:{write:!0}})],XY.prototype,"label",void 0),o([Us({type:[YY],json:{write:!0}})],XY.prototype,"classBreakInfos",void 0),XY=QY=o([Nr("esri.renderers.support.AuthoringInfoFieldInfo")],XY);var tQ;const eQ=new ul({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),iQ=new ul({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),nQ={key:t=>"number"==typeof t?"number":"string",typeMap:{number:Number,string:String},base:null},sQ=["high-to-low","above-and-below","centered-on","extremes"],rQ=[...new Set([...["high-to-low","above-and-below","centered-on","extremes","90-10","above","below"],...["high-to-low","above-and-below","90-10","above","below"]])],oQ=["seconds","minutes","hours","days","months","years"];let aQ=tQ=class extends el{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return"string"==typeof t||"number"==typeof t?t:null}castStartTime(t){return"string"==typeof t||"number"==typeof t?t:null}get style(){return"color"===this.type?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new tQ({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};o([Us({types:nQ,json:{write:!0}})],aQ.prototype,"endTime",void 0),o([ol("endTime")],aQ.prototype,"castEndTime",null),o([Us({type:String,json:{write:!0}})],aQ.prototype,"field",void 0),o([Us({type:Number,json:{write:!0}})],aQ.prototype,"maxSliderValue",void 0),o([Us({type:Number,json:{write:!0}})],aQ.prototype,"minSliderValue",void 0),o([Us({types:nQ,json:{write:!0}})],aQ.prototype,"startTime",void 0),o([ol("startTime")],aQ.prototype,"castStartTime",null),o([Us({type:eQ.apiValues,value:null,json:{type:eQ.jsonValues,read:eQ.read,write:eQ.write}})],aQ.prototype,"style",null),o([Us({type:rQ,value:null,json:{type:rQ,origins:{"web-scene":{type:sQ,write:{writer:(t,e)=>{sQ.includes(t)&&(e.theme=t)}}}},write:!0}})],aQ.prototype,"theme",null),o([Us({type:iQ.apiValues,json:{type:iQ.jsonValues,read:iQ.read,write:iQ.write}})],aQ.prototype,"type",void 0),o([Us({type:oQ,json:{type:oQ,write:!0}})],aQ.prototype,"units",void 0),aQ=tQ=o([Nr("esri.renderers.support.AuthoringInfoVisualVariable")],aQ);const lQ=aQ;let uQ=class extends el{constructor(t){super(t),this.type=null}};o([Us({readOnly:!0,json:{read:!1,write:!0}})],uQ.prototype,"type",void 0),uQ=o([Nr("esri.rest.support.ColorRamp")],uQ);const cQ=uQ;var hQ;let dQ=hQ=class extends cQ{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new hQ({fromColor:ht(this.fromColor),toColor:ht(this.toColor),algorithm:this.algorithm})}};o([ST({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],dQ.prototype,"algorithm",void 0),o([Us({type:wT,json:{type:[Ns],write:!0}})],dQ.prototype,"fromColor",void 0),o([Us({type:wT,json:{type:[Ns],write:!0}})],dQ.prototype,"toColor",void 0),o([Us({type:["algorithmic"]})],dQ.prototype,"type",void 0),dQ=hQ=o([Nr("esri.rest.support.AlgorithmicColorRamp")],dQ);const fQ=dQ;var pQ;let mQ=pQ=class extends cQ{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new pQ({colorRamps:ht(this.colorRamps)})}};o([Us({type:[fQ],json:{write:!0}})],mQ.prototype,"colorRamps",void 0),o([Us({type:["multipart"]})],mQ.prototype,"type",void 0),mQ=pQ=o([Nr("esri.rest.support.MultipartColorRamp")],mQ);const yQ=mQ;const gQ={key:"type",base:cQ,typeMap:{algorithmic:fQ,multipart:yQ}};function vQ(t){return t?.type?"algorithmic"===t.type?fQ.fromJSON(t):"multipart"===t.type?yQ.fromJSON(t):null:null}var wQ;const bQ=new ul({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),SQ=new ul({pieChart:"pie-chart",classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),xQ=new ul({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),_Q=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"],MQ=["high-to-low","above-and-below","above","below","90-10"],kQ=["flow-line","wave-front"],TQ=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let AQ=wQ=class extends el{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&"relationship"!==e?"class-breaks-size"===e||"class-breaks-color"===e?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?vQ(t):void 0}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return"flow"===this.type?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&"relationship"!==t&&"class-breaks-size"!==t&&"class-breaks-color"!==t||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;"classed-size"===t?e="class-breaks-size":"classed-color"===t&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new wQ({classificationMethod:this.classificationMethod,colorRamp:ht(this.colorRamp),fadeRatio:ht(this.fadeRatio),fields:this.fields?.slice(0),field1:ht(this.field1),field2:ht(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((t=>t.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};o([Us({type:bQ.apiValues,value:null,json:{type:bQ.jsonValues,read:bQ.read,write:bQ.write,origins:{"web-document":{default:"manual",type:bQ.jsonValues,read:bQ.read,write:bQ.write}}}})],AQ.prototype,"classificationMethod",null),o([Us({types:gQ,json:{write:!0}})],AQ.prototype,"colorRamp",void 0),o([al("colorRamp")],AQ.prototype,"readColorRamp",null),o([Us({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],AQ.prototype,"fadeRatio",void 0),o([Us({type:[String],value:null,json:{write:!0}})],AQ.prototype,"fields",null),o([Us({type:XY,value:null,json:{write:!0}})],AQ.prototype,"field1",null),o([Us({type:XY,value:null,json:{write:!0}})],AQ.prototype,"field2",null),o([Us({type:kQ,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],AQ.prototype,"flowTheme",null),o([Us({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],AQ.prototype,"focus",null),o([Us({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],AQ.prototype,"isAutoGenerated",void 0),o([Us({type:Number,value:null,json:{type:Ns,write:!0}})],AQ.prototype,"numClasses",null),o([Us({type:_Q,json:{type:_Q,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],AQ.prototype,"lengthUnit",void 0),o([Us({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],AQ.prototype,"maxSliderValue",void 0),o([Us({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],AQ.prototype,"minSliderValue",void 0),o([Us({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],AQ.prototype,"statistics",null),o([Us({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],AQ.prototype,"standardDeviationInterval",null),o([Us({type:SQ.apiValues,value:null,json:{type:SQ.jsonValues,read:SQ.read,write:SQ.write,origins:{"web-scene":{type:xQ.jsonValues,write:{writer:xQ.write,overridePolicy:t=>({enabled:"flow"!==t})}}}}})],AQ.prototype,"type",null),o([Us({type:[lQ],json:{write:!0}})],AQ.prototype,"visualVariables",void 0),o([Us({type:TQ,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],AQ.prototype,"univariateSymbolStyle",null),o([Us({type:MQ,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],AQ.prototype,"univariateTheme",null),AQ=wQ=o([Nr("esri.renderers.support.AuthoringInfo")],AQ);const IQ=AQ;const jQ=new ul({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let CQ=class extends el{constructor(t){super(t),this.authoringInfo=null,this.type=null}async getRequiredFields(t){if(!this.collectRequiredFields)return[];const e=new Set;return await this.collectRequiredFields(e,t),Array.from(e).sort()}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};o([Us({type:IQ,json:{write:!0}})],CQ.prototype,"authoringInfo",void 0),o([Us({type:jQ.apiValues,readOnly:!0,json:{type:jQ.jsonValues,read:!1,write:{writer:jQ.write,ignoreOrigin:!0}}})],CQ.prototype,"type",void 0),CQ=o([Nr("esri.renderers.Renderer")],CQ);const EQ=CQ;function OQ(t){return t.match(LQ)?.[1]?.replace(/\\'/g,"'")??null}const LQ=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var NQ;let RQ=NQ=class extends el{constructor(){super(...arguments),this.title=null}clone(){return new NQ({title:this.title})}};o([Us({type:String,json:{write:!0}})],RQ.prototype,"title",void 0),RQ=NQ=o([Nr("esri.renderers.support.LegendOptions")],RQ);var PQ;let FQ=PQ=class extends RQ{constructor(){super(...arguments),this.showLegend=null}clone(){return new PQ({title:this.title,showLegend:this.showLegend})}};o([Us({type:Boolean,json:{write:!0}})],FQ.prototype,"showLegend",void 0),FQ=PQ=o([Nr("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],FQ);const DQ=FQ;const $Q=new ul({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let zQ=class extends el{constructor(t){super(t),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(t){return null==t?t:"function"==typeof t?(Ft.getLogger(this).error(".field: field must be a string value"),null):ds(t)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};o([Us()],zQ.prototype,"index",void 0),o([Us({type:$Q.apiValues,readOnly:!0,json:{read:$Q.read,write:$Q.write}})],zQ.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],zQ.prototype,"field",void 0),o([ol("field")],zQ.prototype,"castField",null),o([Us({type:String,json:{write:!0}})],zQ.prototype,"valueExpression",void 0),o([Us({type:String,json:{write:!0}})],zQ.prototype,"valueExpressionTitle",void 0),o([Us({readOnly:!0})],zQ.prototype,"arcadeRequired",null),o([Us({type:DQ,json:{write:!0}})],zQ.prototype,"legendOptions",void 0),zQ=o([Nr("esri.renderers.visualVariables.VisualVariable")],zQ);const UQ=zQ;var VQ;let GQ=VQ=class extends el{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=t??0}clone(){return new VQ({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};o([Us({type:wT,json:{type:[Ns],write:!0}})],GQ.prototype,"color",void 0),o([Us({type:String,json:{write:!0}})],GQ.prototype,"label",void 0),o([Us({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],GQ.prototype,"value",void 0),o([ll("value")],GQ.prototype,"writeValue",null),GQ=VQ=o([Nr("esri.renderers.visualVariables.support.ColorStop")],GQ);const BQ=GQ;var qQ;let HQ=qQ=class extends UQ{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new qQ({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};o([Us({readOnly:!0})],HQ.prototype,"cache",null),o([Us({type:["color"],json:{type:["colorInfo"]}})],HQ.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],HQ.prototype,"normalizationField",void 0),o([Us({type:[BQ],json:{write:!0}})],HQ.prototype,"stops",null),HQ=qQ=o([Nr("esri.renderers.visualVariables.ColorVariable")],HQ);const WQ=HQ;var ZQ;let JQ=ZQ=class extends el{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return kT(e.transparency)}writeOpacity(t,e,i){e[i]=MT(t)}clone(){return new ZQ({label:this.label,opacity:this.opacity,value:this.value})}};o([Us({type:String,json:{write:!0}})],JQ.prototype,"label",void 0),o([Us({type:Number,json:{type:Ns,write:{target:"transparency"}}})],JQ.prototype,"opacity",void 0),o([al("opacity",["transparency"])],JQ.prototype,"readOpacity",null),o([ll("opacity")],JQ.prototype,"writeOpacity",null),o([Us({type:Number,json:{write:!0}})],JQ.prototype,"value",void 0),JQ=ZQ=o([Nr("esri.renderers.visualVariables.support.OpacityStop")],JQ);const KQ=JQ;var YQ;let QQ=YQ=class extends UQ{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new YQ({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};o([Us({readOnly:!0})],QQ.prototype,"cache",null),o([Us({type:["opacity"],json:{type:["transparencyInfo"]}})],QQ.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],QQ.prototype,"normalizationField",void 0),o([Us({type:[KQ],json:{write:!0}})],QQ.prototype,"stops",null),QQ=YQ=o([Nr("esri.renderers.visualVariables.OpacityVariable")],QQ);const XQ=QQ;var tX;let eX=tX=class extends UQ{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(t,e,i,n){if(n?.messages){const t=`visualVariables[${this.index}]`;n.messages.push(new Qe("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:t+".valueExpressionTitle",context:n}))}}clone(){return new tX({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};o([Us({readOnly:!0})],eX.prototype,"cache",null),o([Us({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],eX.prototype,"axis",void 0),o([Us({type:["rotation"],json:{type:["rotationInfo"]}})],eX.prototype,"type",void 0),o([Us({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],eX.prototype,"rotationType",void 0),o([Us({type:String,json:{write:!0}})],eX.prototype,"valueExpressionTitle",void 0),o([ll("web-scene","valueExpressionTitle")],eX.prototype,"writeValueExpressionTitleWebScene",null),eX=tX=o([Nr("esri.renderers.visualVariables.RotationVariable")],eX);const iX=eX;var nX;let sX=nX=class extends el{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new nX({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};o([Us({type:String,json:{write:!0}})],sX.prototype,"label",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],sX.prototype,"size",void 0),o([Us({type:Number,json:{write:!0}})],sX.prototype,"value",void 0),o([Us({type:Boolean,json:{write:!1}})],sX.prototype,"useMinValue",void 0),o([Us({type:Boolean,json:{write:!1}})],sX.prototype,"useMaxValue",void 0),sX=nX=o([Nr("esri.renderers.visualVariables.support.SizeStop")],sX);const rX=sX;var oX;let aX=oX=class extends DQ{constructor(){super(...arguments),this.customValues=null}clone(){return new oX({title:this.title,showLegend:this.showLegend,customValues:this.customValues?.slice(0)})}};o([Us({type:[Number],json:{write:!0}})],aX.prototype,"customValues",void 0),aX=oX=o([Nr("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],aX);const lX=aX;var uX,cX;function hX(t){return t&&"esri.renderers.visualVariables.SizeVariable"===t.declaredClass}function dX(t){return null!=t&&!isNaN(t)&&isFinite(t)}function fX(t){return t.valueExpression?uX.Expression:t.field&&"string"==typeof t.field?uX.Field:uX.Unknown}function pX(t,e){const i=e||fX(t),n=t.valueUnit||"unknown";return i===uX.Unknown?cX.Constant:t.stops?cX.Stops:null!=t.minSize&&null!=t.maxSize&&null!=t.minDataValue&&null!=t.maxDataValue?cX.ClampedLinear:"unknown"===n?null!=t.minSize&&null!=t.minDataValue?t.minSize&&t.minDataValue?cX.Proportional:cX.Additive:cX.Identity:cX.RealWorldSize}!function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"}(uX||(uX={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(cX||(cX={}));const mX={unknown:1,inches:od(1,"meters","inches"),feet:od(1,"meters","feet"),"us-feet":od(1,"meters","us-feet"),yards:od(1,"meters","yards"),miles:od(1,"meters","miles"),"nautical-miles":od(1,"meters","nautical-miles"),millimeters:od(1,"meters","millimeters"),centimeters:od(1,"meters","centimeters"),decimeters:od(1,"meters","decimeters"),meters:od(1,"meters","meters"),kilometers:od(1,"meters","kilometers"),"decimal-degrees":1/ad(1,"meters",dl.radius)};const yX=()=>Ft.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),gX=new NF,vX=Math.PI,wX=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function bX(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find((t=>"color"===t.type)):t;if(!n)return;if("esri.renderers.visualVariables.ColorVariable"!==n.declaredClass)return void yX().warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const s="number"==typeof e,r=s?null:e,o=r?.attributes;let a=s?e:null;const l=n.field,{ipData:u,hasExpression:c}=n.cache;let h=n.cache.compiledFunc;if(!l&&!c){const t=n.stops;return t&&t[0]&&t[0].color}if("number"!=typeof a)if(c){if(null==i?.arcade)return void yX().error("Use of arcade expressions requires an arcade context");const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},e=i.arcade.arcadeUtils,s=e.getViewInfo(t),o=e.createExecContext(r,s,i.timeZone);if(!h){const t=e.createSyntaxTree(n.valueExpression);h=e.createFunction(t),n.cache.compiledFunc=h}a=e.executeFunction(h,o)}else o&&(a=o[l]);const d=n.normalizationField,f=null!=o&&null!=d?parseFloat(o[d]):void 0;if(null!=a&&(!d||s||!isNaN(f)&&0!==f)){isNaN(f)||s||(a/=f);const t=DX(a,u);if(t){const e=t[0],s=t[1],r=e===s?n.stops[e].color:wT.blendColors(n.stops[e].color,n.stops[s].color,t[2],null!=i?i.color:void 0);return new wT(r)}}}function SX(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find((t=>"opacity"===t.type)):t;if(!n)return;if("esri.renderers.visualVariables.OpacityVariable"!==n.declaredClass)return void yX().warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const s="number"==typeof e,r=s?null:e,o=r?.attributes;let a=s?e:null;const l=n.field,{ipData:u,hasExpression:c}=n.cache;let h=n.cache.compiledFunc;if(!l&&!c){const t=n.stops;return t&&t[0]&&t[0].opacity}if("number"!=typeof a)if(c){if(null==i?.arcade)return void yX().error("Use of arcade expressions requires an arcade context");const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},e=i.arcade.arcadeUtils,s=e.getViewInfo(t),o=e.createExecContext(r,s,i.timeZone);if(!h){const t=e.createSyntaxTree(n.valueExpression);h=e.createFunction(t),n.cache.compiledFunc=h}a=e.executeFunction(h,o)}else o&&(a=o[l]);const d=n.normalizationField,f=null!=o&&null!=d?parseFloat(o[d]):void 0;if(null!=a&&(!d||s||!isNaN(f)&&0!==f)){isNaN(f)||s||(a/=f);const t=DX(a,u);if(t){const e=t[0],i=t[1];if(e===i)return n.stops[e].opacity;{const s=n.stops[e].opacity;return s+(n.stops[i].opacity-s)*t[2]}}}}function xX(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find((t=>"rotation"===t.type)):t;if(!n)return;if("esri.renderers.visualVariables.RotationVariable"!==n.declaredClass)return void yX().warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const s=n.axis||"heading",r="heading"===s&&"arithmetic"===n.rotationType?90:0,o="heading"===s&&"arithmetic"===n.rotationType?-1:1,a="number"==typeof e?null:e,l=a?.attributes,u=n.field,{hasExpression:c}=n.cache;let h=n.cache.compiledFunc,d=0;if(!u&&!c)return d;if(c){if(null==i?.arcade)return void yX().error("Use of arcade expressions requires an arcade context");const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},e=i.arcade.arcadeUtils,s=e.getViewInfo(t),r=e.createExecContext(a,s,i.timeZone);if(!h){const t=e.createSyntaxTree(n.valueExpression);h=e.createFunction(t),n.cache.compiledFunc=h}d=e.executeFunction(h,r)}else l&&(d=l[u]||0);return d="number"!=typeof d||isNaN(d)?null:r+o*d,d}function _X(t,e,i){const n="number"==typeof e,s=n?null:e,r=s?.attributes;let o=n?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const e=null!=i?i.scale:void 0,n=null!=i?i.view:void 0;o=null==e||"3d"===n?MX(t):e}else if(!n)switch(t.inputValueType){case uX.Expression:{if(null==i?.arcade)return void yX().error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},n=i.arcade.arcadeUtils,r=n.getViewInfo(e),a=n.createExecContext(s,r,i.timeZone);if(!l){const e=n.createSyntaxTree(t.valueExpression);l=n.createFunction(e),t.cache.compiledFunc=l}o=n.executeFunction(l,a);break}case uX.Field:r&&(o=r[t.field]);break;case uX.Unknown:o=null}if(!dX(o))return null;if(n||!t.normalizationField)return o;const u=r?parseFloat(r[t.normalizationField]):null;return dX(u)&&0!==u?o/u:null}function MX(t){let e=null,i=null;const n=t.stops;return n?(e=n[0].value,i=n[n.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}function kX(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find((t=>"size"===t.type)):t;if(!n)return;if("esri.renderers.visualVariables.SizeVariable"!==n.declaredClass)return void yX().warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const s=RX(_X(n,e,i),n,e,i,n.cache.ipData);return null==s||isNaN(s)?0:s}function TX(t,e,i){return null==t?null:hX(t)?kX(t,e,i):dX(t)?t:null}function AX(t,e,i){return dX(i)&&t>i?i:dX(e)&&t<e?e:t}function IX(t,e,i,n){return t+((TX(e.minSize,i,n)||e.minDataValue)??0)}function jX(t,e,i){const n=t.stops;let s=n?.length&&n[0].size;return null==s&&(s=t.minSize),TX(s,e,i)}function CX(t,e,i,n){const s=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),r=TX(e.minSize,i,n),o=TX(e.maxSize,i,n),a=null!=n?n.shape:void 0;if(t<=e.minDataValue)return r;if(t>=e.maxDataValue)return o;if(null==r||null==o)return null;if("area"===e.scaleBy&&a){const t="circle"===a,e=t?vX*(r/2)**2:r*r,i=e+s*((t?vX*(o/2)**2:o*o)-e);return t?2*Math.sqrt(i/vX):Math.sqrt(i)}return r+s*(o-r)}function EX(t,e,i,n){const s=null!=n?n.shape:void 0,r=t/e.minDataValue,o=TX(e.minSize,i,n),a=TX(e.maxSize,i,n);let l=null;return l="circle"===s?2*Math.sqrt(r*(o/2)**2):"square"===s||"diamond"===s||"image"===s?Math.sqrt(r*o**2):r*o,AX(l,o,a)}function OX(t,e,i,n,s){const[r,o,a]=DX(t,s);if(r===o)return TX(e.stops?.[r].size,i,n);{const t=TX(e.stops?.[r].size,i,n);return t+(TX(e.stops?.[o].size,i,n)-t)*a}}function LX(t,e,i,n){const s=(n?.resolution??1)*mX[e.valueUnit],r=TX(e.minSize,i,n),o=TX(e.maxSize,i,n),{valueRepresentation:a}=e;let l=null;return l="area"===a?2*Math.sqrt(t/vX)/s:"radius"===a||"distance"===a?2*t/s:t/s,AX(l,r,o)}function NX(t){return t}function RX(t,e,i,n,s){switch(e.transformationType){case cX.Additive:return IX(t,e,i,n);case cX.Constant:return jX(e,i,n);case cX.ClampedLinear:return CX(t,e,i,n);case cX.Proportional:return EX(t,e,i,n);case cX.Stops:return OX(t,e,i,n,s);case cX.RealWorldSize:return LX(t,e,i,n);case cX.Identity:return NX(t);case cX.Unknown:return null}}function PX(t,e,i){const{isScaleDriven:n}=t.cache;if(!(n&&"3d"===i||e))return null;const s={scale:e,view:i};let r=TX(t.minSize,gX,s),o=TX(t.maxSize,gX,s);if(null!=r||null!=o){if(r>o){const t=o;o=r,r=t}return{minSize:r,maxSize:o}}}function FX(t,e,i){if(!t.visualVariables)return;const n=[],s=[],r=[],o=[],a=[];for(const e of t.visualVariables)switch(e.type){case"color":s.push(e);break;case"opacity":r.push(e);break;case"rotation":a.push(e);break;case"size":o.push(e)}return s.forEach((t=>{const s=bX(t,e,i);n.push({variable:t,value:s})})),r.forEach((t=>{const s=SX(t,e,i);n.push({variable:t,value:s})})),a.forEach((t=>{const s=xX(t,e,i);n.push({variable:t,value:s})})),o.forEach((t=>{const s=kX(t,e,i);n.push({variable:t,value:s})})),n.filter((t=>null!=t.value))}function DX(t,e){if(!e)return;let i=0,n=e.length-1;return e.some(((e,s)=>t<e?(n=s,!0):(i=s,!1))),[i,n,(t-e[i])/(e[n]-e[i])]}function $X(t,e,i){const n=["proportional","proportional","proportional"];for(const s of t){const t=s.useSymbolValue?"symbol-value":kX(s,e,i);switch(s.axis){case"width":n[0]=t;break;case"depth":n[1]=t;break;case"height":n[2]=t;break;case"width-and-depth":n[0]=t,n[1]=t;break;case"all":case void 0:case null:n[0]=t,n[1]=t,n[2]=t;break}}return n}const zX=Object.freeze({__proto__:null,getAllSizes:$X,getColor:bX,getOpacity:SX,getRotationAngle:xX,getSize:kX,getSizeForValue:RX,getSizeFromNumberOrVariable:TX,getSizeRangeAtScale:PX,getVisualVariableValues:FX,viewScaleRE:wX});var UX;const VX=new ul({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),GX=new ul({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function BX(t){if(null!=t)return"string"==typeof t||"number"==typeof t?FT(t):"size"===t.type?hX(t)?t:(delete(t={...t}).type,new HX(t)):void 0}function qX(t,e,i){if("object"!=typeof t)return t;const n=new HX;return n.read(t,i),n}let HX=UX=class extends UQ{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:null!=this.valueExpression&&wX.test(this.valueExpression)}}set expression(t){Ft.getLogger(this).warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===t?(this.valueExpression="$view.scale",this._set("expression",t)):this._set("expression",null)}set index(t){hX(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),hX(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return fX(this)}set maxDataValue(t){t&&this.stops&&(Ft.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(Ft.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return BX(t)}readMaxSize(t,e,i){return qX(t,e,i)}set minDataValue(t){t&&this.stops&&(Ft.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(Ft.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return BX(t)}readMinSize(t,e,i){return qX(t,e,i)}get arcadeRequired(){return!!this.valueExpression||(null!=this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||null!=this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired)}set stops(t){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)):t&&(Ft.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return pX(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,n){if("$view.scale"===t){if(n?.messages){const t=this.index,e="string"==typeof t?t:`visualVariables[${t}]`;n.messages.push(new Qe("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:e+".valueExpression",context:n}))}}else e[i]=t}readValueUnit(t){return t?GX.read(t):null}clone(){return new UX({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:hX(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:hX(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((t=>t.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType===cX.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===cX.Stops){const t=this.stops;if(!t)return this;const e=t.map((t=>t.size)).reverse(),i=t.length;for(let n=0;n<i;n++)t[n].size=e[n];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map((t=>t.value||0))}};o([Us({readOnly:!0})],HX.prototype,"cache",null),o([Us({type:VX.apiValues,json:{type:VX.jsonValues,origins:{"web-map":{read:!1}},read:VX.read,write:VX.write}})],HX.prototype,"axis",void 0),o([Us({type:String,value:null,json:{read:!1}})],HX.prototype,"expression",null),o([Us()],HX.prototype,"index",null),o([Us({type:String,readOnly:!0})],HX.prototype,"inputValueType",null),o([Us({type:lX,json:{write:!0}})],HX.prototype,"legendOptions",void 0),o([Us({type:Number,value:null,json:{write:!0}})],HX.prototype,"maxDataValue",null),o([Us({type:Number,value:null,json:{write:!0}})],HX.prototype,"maxSize",null),o([ol("maxSize")],HX.prototype,"castMaxSize",null),o([al("maxSize")],HX.prototype,"readMaxSize",null),o([Us({type:Number,value:null,json:{write:!0}})],HX.prototype,"minDataValue",null),o([Us({type:Number,value:null,json:{write:!0}})],HX.prototype,"minSize",null),o([ol("minSize")],HX.prototype,"castMinSize",null),o([al("minSize")],HX.prototype,"readMinSize",null),o([Us({type:String,json:{write:!0}})],HX.prototype,"normalizationField",void 0),o([Us({readOnly:!0})],HX.prototype,"arcadeRequired",null),o([Us({type:String})],HX.prototype,"scaleBy",void 0),o([Us({type:[rX],value:null,json:{write:!0}})],HX.prototype,"stops",null),o([Us({type:["outline"],json:{write:!0}})],HX.prototype,"target",void 0),o([Us({type:String,readOnly:!0})],HX.prototype,"transformationType",null),o([Us({type:["size"],json:{type:["sizeInfo"]}})],HX.prototype,"type",void 0),o([Us({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],HX.prototype,"useSymbolValue",void 0),o([Us({type:String,json:{write:!0}})],HX.prototype,"valueExpression",void 0),o([al("valueExpression",["valueExpression","expression"])],HX.prototype,"readValueExpression",null),o([ll("web-scene","valueExpression")],HX.prototype,"writeValueExpressionWebScene",null),o([Us({type:["radius","diameter","area","width","distance"],json:{write:!0}})],HX.prototype,"valueRepresentation",void 0),o([Us({type:GX.apiValues,json:{write:GX.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],HX.prototype,"valueUnit",void 0),o([al("valueUnit")],HX.prototype,"readValueUnit",null),HX=UX=o([Nr("esri.renderers.visualVariables.SizeVariable")],HX);const WX=HX;const ZX={color:WQ,size:WX,opacity:XQ,rotation:iX},JX=new ul({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),KX=/^\[([^\]]+)\]$/i;let YX=class extends Vr{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(t){if(this._resetVariables(),t=t&&t.filter((t=>!!t)),t?.length){for(const e of t)switch(e.type){case"color":this.colorVariables.push(e);break;case"opacity":this.opacityVariables.push(e);break;case"rotation":this.rotationVariables.push(e);break;case"size":this.sizeVariables.push(e)}if(this.sizeVariables.length){this.sizeVariables.some((t=>!!t.target))&&t.sort(((t,e)=>{let i=null;return i=t.target===e.target?0:t.target?1:-1,i}))}for(let e=0;e<t.length;e++){t[e].index=e}this._set("visualVariables",t)}else this._set("visualVariables",t)}readVariables(t,e,i){const{rotationExpression:n,rotationType:s}=e,r=n?.match(KX),o=r?.[1];if(o&&(t||(t=[]),t.push({type:"rotationInfo",rotationType:s,field:o})),t)return t.map((t=>{const e=JX.read(t.type),n=ZX[e];n||(Ft.getLogger(this).warn(`Unknown variable type: ${e}`),i?.messages&&i.messages.push(new Hs("visual-variable:unsupported",`visualVariable of type '${e}' is not supported`,{definition:t,context:i})));const s=new n;return s.read(t,i),s}))}writeVariables(t,e){const i=[];for(const n of t){const t=n.toJSON(e);t&&i.push(t)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};o([Us()],YX.prototype,"visualVariables",null),YX=o([Nr("esri.renderers.visualVariables.VisualVariableFactory")],YX);const QX=YX;const XX={base:UQ,key:"type",typeMap:{opacity:XQ,color:WQ,rotation:iX,size:WX}},t0=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new QX}set visualVariables(t){this._vvFactory.visualVariables=t,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(t,e,i){return this._vvFactory.readVariables(t,e,i)}writeVisualVariables(t,e,i,n){e[i]=this._vvFactory.writeVariables(t,n)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const t of this.visualVariables)if(t.arcadeRequired)return!0;return!1}hasVisualVariables(t,e){return t?this.getVisualVariablesForType(t,e).length>0:this.getVisualVariablesForType("size",e).length>0||this.getVisualVariablesForType("color",e).length>0||this.getVisualVariablesForType("opacity",e).length>0||this.getVisualVariablesForType("rotation",e).length>0}getVisualVariablesForType(t,e){const i=this.visualVariables;return i?i.filter((i=>i.type===t&&("string"==typeof e?i.target===e:!1!==e||!i.target))):[]}async collectVVRequiredFields(t,e){let i=[];this.visualVariables&&(i=i.concat(this.visualVariables));for(const n of i)n&&(n.field&&bC(t,e,n.field),n.normalizationField&&bC(t,e,n.normalizationField),n.valueExpression&&(e0(n.valueExpression,t,e)||await _C(t,e,n.valueExpression)))}};return o([Us({types:[XX],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),o([al("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),o([ll("visualVariables")],e.prototype,"writeVisualVariables",null),e=o([Nr("esri.renderers.mixins.VisualVariablesMixin")],e),e};function e0(t,e,i){const n=OQ(t);return null!=n&&(bC(e,i,n),!0)}const i0={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function n0(t,e=i0){if(!t)return{symbol:null};const{retainId:i=i0.retainId,ignoreDrivers:n=i0.ignoreDrivers,hasLabelingContext:s=i0.hasLabelingContext,retainCIM:r=i0.retainCIM}=e;let o=null;if(SF(t)||t instanceof wF)o=t.clone();else if("cim"===t.type){const e=t.data?.symbol?.type;if("CIMPointSymbol"!==e)return{error:new Qe("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${e||"unknown"}' is unsupported in 3D`,{symbol:t})};o=r?t.clone():eF.fromCIMSymbol(t)}else if(t instanceof QL)o=LP.fromSimpleLineSymbol(t);else if(t instanceof fF)o=eF.fromSimpleMarkerSymbol(t);else if(t instanceof YP)o=eF.fromPictureMarkerSymbol(t);else if(t instanceof uF)o=e.geometryType&&"mesh"===e.geometryType?$P.fromSimpleFillSymbol(t):rF.fromSimpleFillSymbol(t);else{if(!(t instanceof yF))return{error:new Qe("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};o=s?IP.fromTextSymbol(t):eF.fromTextSymbol(t)}return i&&o&&"cim"!==o.type&&(o.id=t.id),n&&SF(o)&&o.symbolLayers.forEach((t=>t.ignoreDrivers=!0)),{symbol:o}}function s0(t,e,i,n){const s=a0(t,{},{context:n,isLabelSymbol:!1});null!=s&&(e[i]=s)}function r0(t,e,i,n){const s=a0(t,{},{context:n,isLabelSymbol:!0});null!=s&&(e[i]=s)}function o0(t){return t instanceof cP||t instanceof wF}function a0(t,e,i){if(null==t)return null;const{context:n,isLabelSymbol:s}=i,r=n?.origin,o=n?.messages;if("web-scene"===r&&!o0(t)){const i=n0(t,{retainCIM:!0,hasLabelingContext:s});return null!=i.symbol?i.symbol.write(e,n):(o?.push(new Qe("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:n,error:i.error})),null)}return("web-map"===r||"portal-item"===r&&!Fk(n?.layer))&&o0(t)?(o?.push(new Qe("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:n})),null):t.write(e,n)}function l0(t,e){return MF(t,null,e)}const u0={types:kF,json:{write:{writer:s0},origins:{"web-scene":{types:AF,write:{writer:s0},read:{reader:Ks({types:AF})}}}}},c0=_t({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},u0),h0={types:{base:vL,key:"type",typeMap:{"simple-fill":xF.typeMap["simple-fill"],"picture-fill":xF.typeMap["picture-fill"],"polygon-3d":xF.typeMap["polygon-3d"]}},json:{write:{writer:s0},origins:{"web-scene":{type:rF,write:{writer:s0}}}}},d0={cast:t=>null==t||"string"==typeof t||"number"==typeof t?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t?.toString()}}}};var f0;let p0=f0=class extends el{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new f0({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};o([Us({type:String,json:{write:!0}})],p0.prototype,"description",void 0),o([Us({type:String,json:{write:!0}})],p0.prototype,"label",void 0),o([Us({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],p0.prototype,"minValue",void 0),o([Us({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],p0.prototype,"maxValue",void 0),o([Us(c0)],p0.prototype,"symbol",void 0),p0=f0=o([Nr("esri.renderers.support.ClassBreakInfo")],p0);const m0=p0;var y0;const g0="log",v0="percent-of-total",w0="field",b0=new ul({esriNormalizeByLog:g0,esriNormalizeByPercentOfTotal:v0,esriNormalizeByField:w0}),S0=ks(m0);let x0=y0=class extends(t0(EQ)){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let n=e.minValue;return t.map((t=>{const e=new m0;return e.read(t,i),null==e.minValue&&(e.minValue=n),null==e.maxValue&&(e.maxValue=e.minValue),n=e.maxValue,e}))}writeClassBreakInfos(t,e,i,n){const s=t.map((t=>t.write({},n)));this._areClassBreaksConsecutive()&&s.forEach((t=>delete t.classMinValue)),e[i]=s}castField(t){return null==t?t:"function"==typeof t?(Ft.getLogger(this).error(".field: field must be a string value"),null):ds(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=null!=this.normalizationTotal;return e||i?(t=e&&w0||i&&v0||null,e&&i&&Ft.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==w0&&t!==v0||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let n=null;n="number"==typeof t?new m0({minValue:t,maxValue:e,symbol:jF(i)}):S0(ht(t)),this.classBreakInfos.push(n),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let n=0;n<i;n++){const i=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue];if(i[0]===t&&i[1]===e){this.classBreakInfos.splice(n,1);break}}}getBreakIndex(t,e){return this.valueExpression&&null==e?.arcade&&Ft.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;this.valueExpression&&null==e?.arcade&&(i={...i,arcade:await rC()});const n=this.getBreakIndex(t,i);return-1!==n?this.classBreakInfos[n]:null}getSymbol(t,e){if(this.valueExpression&&null==e?.arcade)return void Ft.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&null==e?.arcade){const t=await rC(),{arcadeUtils:e}=t;e.hasGeometryOperations(this.valueExpression)&&await e.enableGeometryOperations(),i={...i,arcade:t}}const n=this.getBreakIndex(t,i);return n>-1?this.classBreakInfos[n].symbol:this.defaultSymbol}getSymbols(){const t=[];return this.classBreakInfos.forEach((e=>{e.symbol&&t.push(e.symbol)})),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce(((t,e)=>t+e.getMeshHash()),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new y0({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:ht(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:ht(this.visualVariables),legendOptions:ht(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(t,e))),_C(t,e,this.valueExpression)];bC(t,e,this.field),bC(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:n,spatialReference:s,arcade:r,timeZone:o}=e??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=r.arcadeUtils;if(!l){const t=u.createSyntaxTree(a);l=u.createFunction(t),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(t,u.getViewInfo({viewingMode:i,scale:n,spatialReference:s}),o));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(t){const e=this.field,i=t.attributes,n=this.normalizationType;let s=parseFloat(i[e]);if(n){const t=this.normalizationTotal,e=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(n===g0)s=Math.log(s)*Math.LOG10E;else if(n!==v0||null==t||isNaN(t)){if(n===w0&&!isNaN(e)){if(isNaN(s)||isNaN(e))return-1;s/=e}}else s=s/t*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(null!=t&&"number"==typeof t&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const n=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(n[0]<=t&&(e?t<=n[1]:t<n[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};o([Us(h0)],x0.prototype,"backgroundFillSymbol",void 0),o([Us({type:[m0]})],x0.prototype,"classBreakInfos",void 0),o([al("classBreakInfos")],x0.prototype,"readClassBreakInfos",null),o([ll("classBreakInfos")],x0.prototype,"writeClassBreakInfos",null),o([Us({type:String,json:{write:!0}})],x0.prototype,"defaultLabel",void 0),o([Us(u0)],x0.prototype,"defaultSymbol",void 0),o([Us({type:String,json:{write:!0}})],x0.prototype,"field",void 0),o([ol("field")],x0.prototype,"castField",null),o([Us({type:Boolean})],x0.prototype,"isMaxInclusive",void 0),o([Us({type:RQ,json:{write:!0}})],x0.prototype,"legendOptions",void 0),o([Us({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],x0.prototype,"minValue",null),o([Us({type:String,json:{write:!0}})],x0.prototype,"normalizationField",void 0),o([Us({type:Number,cast:t=>fs(t),json:{write:!0}})],x0.prototype,"normalizationTotal",void 0),o([Us({type:b0.apiValues,value:null,json:{type:b0.jsonValues,read:b0.read,write:b0.write}})],x0.prototype,"normalizationType",null),o([ST({classBreaks:"class-breaks"})],x0.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],x0.prototype,"valueExpression",void 0),o([Us({type:String,json:{write:!0}})],x0.prototype,"valueExpressionTitle",void 0),x0=y0=o([Nr("esri.renderers.ClassBreaksRenderer")],x0);const _0=x0;const M0=-3,k0=M0-1;var T0;!function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"}(T0||(T0={}));class A0{constructor(t,e,i){this.name=t,this._storage=e,this.id=j0+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),i&&(this._storage.registerRemoveFunc(this.id,i),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(t){return this._storage.getSize(this,t)}resetHitRate(){this._hit=this._miss=0}put(t,e,i,n=0){this._storage.put(this,t,e,i,n)}pop(t){const e=this._storage.pop(this,t);return void 0===e?++this._miss:++this._hit,e}get(t){const e=this._storage.get(this,t);return void 0===e?++this._miss:++this._hit,e}peek(t){return this._storage.peek(this,t)}updateSize(t,e,i){this._storage.updateSize(this,t,e,i)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class I0{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new gi,this._users=new gi}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,e){const i=this._db.get(t.id+e);return i?.size??0}put(t,e,i,n,s){e=t.id+e;const r=this._db.get(e);if(r&&(this._size-=r.size,t.size-=r.size,this._db.delete(e),r.entry!==i&&this._notifyRemove(e,r.entry,r.size,T0.ALL)),n>this._maxSize)return void this._notifyRemove(e,i,n,T0.ALL);if(void 0===i)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${e}`),void this._notifyRemove(e,i,0,T0.ALL);const o=1+Math.max(s,k0)-M0;this._db.set(e,new C0(i,n,o)),this._size+=n,t.size+=n,this._checkSize()}updateSize(t,e,i,n){e=t.id+e;const s=this._db.get(e);if(s&&s.entry===i){for(this._size-=s.size,t.size-=s.size;n>this._maxSize;){const t=this._notifyRemove(e,i,n,T0.SOME);if(!(null!=t&&t>0))return void this._db.delete(e);n=t}s.size=n,this._size+=n,t.size+=n,this._checkSize()}}pop(t,e){e=t.id+e;const i=this._db.get(e);if(i)return this._size-=i.size,t.size-=i.size,this._db.delete(e),++this._hit,i.entry;++this._miss}get(t,e){e=t.id+e;const i=this._db.get(e);if(void 0!==i)return this._db.delete(e),i.lives=i.lifetime,this._db.set(e,i),++this._hit,i.entry;++this._miss}peek(t,e){const i=this._db.get(t.id+e);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},i=new Array;this._db.forEach(((t,n)=>{const s=t.lifetime;i[s]=(i[s]||0)+t.size,this._users.forAll((i=>{const{id:s,name:r}=i;if(n.startsWith(s)){const i=e[r]||0;e[r]=i+t.size}}))}));const n={};this._users.forAll((t=>{const i=t.name;if("hitRate"in t&&"number"==typeof t.hitRate&&!isNaN(t.hitRate)&&t.hitRate>0){const s=e[i]||0;e[i]=s,n[i]=Math.round(100*t.hitRate)+"%"}else n[i]="0%"}));const s=Object.keys(e);s.sort(((t,i)=>e[i]-e[t])),s.forEach((i=>t[i]=Math.round(e[i]/2**20)+"MB / "+n[i]));for(let e=i.length-1;e>=0;--e){const n=i[e];n&&(t["Priority "+(e+M0-1)]=Math.round(n/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){const e=t.id;this._db.forEach(((t,i)=>{i.startsWith(e)&&(this._size-=t.size,this._db.delete(i),this._notifyRemove(i,t.entry,t.size,T0.ALL))})),t.size=0}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,t.size,T0.ALL))),this._users.forAll((t=>t.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,i,n){let s;return this._removeFuncs.some((r=>{if(t.startsWith(r[0])){const t=r[1](e,n,i);return"number"==typeof t&&(s=t),!0}return!1})),s}_checkSize(){this._users.forAll((t=>this._checkSizeLimits(t))),this._checkSizeLimits()}_checkSizeLimits(t){const e=t??this;if(e.maxSize<0||e.size<=e.maxSize)return;const i=t?.id;let n=!0;for(;n;){n=!1;for(const[s,r]of this._db)if(0===r.lifetime&&(!i||s.startsWith(i))){if(this._purgeItem(s,r,t),e.size<=.9*e.maxSize)return;n||=this._db.has(s)}}for(const[n,s]of this._db)if((!i||n.startsWith(i))&&(this._purgeItem(n,s,t),e.size<=.9*e.maxSize))return}_purgeItem(t,e,i=this._users.find((e=>t.startsWith(e.id)))){if(this._db.delete(t),e.lives<=1){this._size-=e.size,i&&(i.size-=e.size);const n=this._notifyRemove(t,e.entry,e.size,T0.SOME);null!=n&&n>0&&(this._size+=n,i&&(i.size+=n),e.lives=e.lifetime,e.size=n,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}let j0=0;class C0{constructor(t,e,i){this.entry=t,this.size=e,this.lifetime=i,this.lives=i}}class E0{constructor(t,e){this._storage=new I0,this.id="",this.name="",this.size=0,this._storage.maxSize=t,this._storage.register(this),e&&this._storage.registerRemoveFunc("",e)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,e,i=1){this._storage.put(this,t,e,i,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}let O0=class t{constructor(t,e,i=""){this.major=t,this.minor=e,this._context=i}lessThan(t,e){return this.major<t||t===this.major&&this.minor<e}since(t,e){return!this.lessThan(t,e)}validate(t){if(this.major!==t.major){const e=this._context&&this._context+":",i=this._context&&this._context+" ";throw new Qe(e+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:t})}}clone(){return new t(this.major,this.minor,this._context)}static parse(e,i=""){const[n,s]=e.split("."),r=/^\s*\d+\s*$/;if(!n?.match||!r.test(n)){throw new Qe((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e})}if(!s?.match||!r.test(s)){throw new Qe((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e})}const o=parseInt(n,10),a=parseInt(s,10);return new t(o,a,i)}};class L0{}function N0(t){return t instanceof fg.Zone?t===L0.instance:"unknown"===t?.toString().toLowerCase()}function R0(t){return N0(t)?L0.instance:t}L0.instance=new fg.IANAZone("Etc/UTC");function P0(t){return"timeZone"in t}function F0(t){return"timeZone"in t}function D0(t){return"dateFieldsTimeZone"in t}const $0=new Map;class z0{static fromJSON(t){return new z0(t.fields,t.timeZoneByFieldName)}static fromLayer(t){return new z0(t.fields??[],B0(t))}static fromLayerJSON(t){return new z0(t.fields??[],B0(t))}constructor(t=[],e){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=t||[],this._timeZoneByFieldName=e?new Map(e):null;const i=[];for(const t of this.fields){const e=t?.name,n=V0(e);if(e&&n){const s=U0(e);this._fieldsMap.set(e,t),this._fieldsMap.set(s,t),this._normalizedFieldsMap.set(n,t),i.push(`${s}:${t.type}:${this._timeZoneByFieldName?.get(e)}`),hE(t)?(this.dateFields.push(t),this._dateFieldsSet.add(t)):uE(t)&&(this._numericFieldsSet.add(t),this.numericFields.push(t)),mE(t)||yE(t)||(t.editable=null==t.editable||!!t.editable,t.nullable=null==t.nullable||!!t.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)mE(t)||yE(t)||t.nullable||void 0!==WC(t)||this._requiredFields.push(t)}return this._requiredFields}equals(t){return this.uid===t?.uid}has(t){return null!=this.get(t)}get(t){if(!t)return;let e=this._fieldsMap.get(t);return e||(e=this._fieldsMap.get(U0(t))??this._normalizedFieldsMap.get(V0(t)),e&&this._fieldsMap.set(t,e),e)}getTimeZone(t){const e=this.get(t&&"string"!=typeof t?t.name:t);return e?this._timeZoneByFieldName?this._timeZoneByFieldName.get(e.name):"date"===e.type||"esriFieldTypeDate"===e.type?(Ft.getLogger("esri.layers.support.FieldsIndex").error(new Qe("getTimeZone:no-timezone-information",`no time zone information for field '${e.name}'`)),yg):G0.has(e.type)?mg:null:null}getLuxonTimeZone(t){const e=this.getTimeZone(t);return e?e===mg?L0.instance:e===yg?fg.FixedOffsetZone.utcInstance:as($0,e,(()=>fg.IANAZone.create(e))):null}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isTimeOnlyField(t){return pE(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){return this.get(t)?.name??void 0}toJSON(){return{fields:this.fields.map((t=>tl(t)?t.toJSON():t)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function U0(t){return t.trim().toLowerCase()}function V0(t){return hC(t)?.toLowerCase()??""}const G0=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function B0(t){const e=new Map;if(!t.fields)return e;const i=!0===t.datesInUnknownTimezone,{timeInfo:n,editFieldsInfo:s}=t,r=(n?"startField"in n?n.startField:n.startTimeField:"")??"",o=(n?"endField"in n?n.endField:n.endTimeField:"")??"",a=D0(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?xg(t.dateFieldsTimeReference):null,l=s?P0(s)?s.timeZone??a:s.dateFieldsTimeReference?xg(s.dateFieldsTimeReference):a??yg:null,u=n?F0(n)?n.timeZone??a:n.timeReference?xg(n.timeReference):a:null,c=new Map([[U0(s?.creationDateField??""),l],[U0(s?.editDateField??""),l],[U0(r),u],[U0(o),u]]);for(const{name:n,type:s}of t.fields)if(G0.has(s))e.set(n,mg);else if("date"!==s&&"esriFieldTypeDate"!==s)e.set(n,null);else if(i)e.set(n,mg);else{const t=c.get(U0(n??""))??a;e.set(n,t)}return e}function q0(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function H0(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function W0(t,e,i,n,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t}function Z0(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function J0(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function K0(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function Y0(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function Q0(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function X0(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function t1(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}function e1(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}function i1(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function n1(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function s1(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t}function r1(t,e){const i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2],r=e[3]-t[3];return Math.sqrt(i*i+n*n+s*s+r*r)}function o1(t,e){const i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2],r=e[3]-t[3];return i*i+n*n+s*s+r*r}function a1(t){const e=t[0],i=t[1],n=t[2],s=t[3];return Math.sqrt(e*e+i*i+n*n+s*s)}function l1(t){const e=t[0],i=t[1],n=t[2],s=t[3];return e*e+i*i+n*n+s*s}function u1(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function c1(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function h1(t,e){const i=e[0],n=e[1],s=e[2],r=e[3];let o=i*i+n*n+s*s+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=n*o,t[2]=s*o,t[3]=r*o),t}function d1(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function f1(t,e,i,n){const s=e[0],r=e[1],o=e[2],a=e[3];return t[0]=s+n*(i[0]-s),t[1]=r+n*(i[1]-r),t[2]=o+n*(i[2]-o),t[3]=a+n*(i[3]-a),t}function p1(t,e){const i=ho;let n,s,r,o,a,l;e=e||1;do{n=2*i()-1,s=2*i()-1,a=n*n+s*s}while(a>=1);do{r=2*i()-1,o=2*i()-1,l=r*r+o*o}while(l>=1);const u=Math.sqrt((1-a)/l);return t[0]=e*n,t[1]=e*s,t[2]=e*r*u,t[3]=e*o*u,t}function m1(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3];return t[0]=i[0]*n+i[4]*s+i[8]*r+i[12]*o,t[1]=i[1]*n+i[5]*s+i[9]*r+i[13]*o,t[2]=i[2]*n+i[6]*s+i[10]*r+i[14]*o,t[3]=i[3]*n+i[7]*s+i[11]*r+i[15]*o,t}function y1(t,e,i){const n=e[0],s=e[1],r=e[2],o=i[0],a=i[1],l=i[2],u=i[3],c=u*n+a*r-l*s,h=u*s+l*n-o*r,d=u*r+o*s-a*n,f=-o*n-a*s-l*r;return t[0]=c*u+f*-o+h*-l-d*-a,t[1]=h*u+f*-a+d*-o-c*-l,t[2]=d*u+f*-l+c*-a-h*-o,t[3]=e[3],t}function g1(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function v1(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function w1(t,e){const i=t[0],n=t[1],s=t[2],r=t[3],o=e[0],a=e[1],l=e[2],u=e[3],c=uo();return Math.abs(i-o)<=c*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-a)<=c*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(s-l)<=c*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(r-u)<=c*Math.max(1,Math.abs(r),Math.abs(u))}const b1=J0,S1=K0,x1=Y0,_1=r1,M1=o1,k1=a1,T1=l1;Object.freeze(Object.defineProperty({__proto__:null,add:Z0,ceil:Q0,copy:q0,copyVec3:H0,dist:_1,distance:r1,div:x1,divide:Y0,dot:d1,equals:w1,exactEquals:v1,floor:X0,inverse:c1,len:k1,length:a1,lerp:f1,max:e1,min:t1,mul:S1,multiply:K0,negate:u1,normalize:h1,random:p1,round:i1,scale:n1,scaleAndAdd:s1,set:W0,sqrDist:M1,sqrLen:T1,squaredDistance:o1,squaredLength:l1,str:g1,sub:b1,subtract:J0,transformMat4:m1,transformQuat:y1},Symbol.toStringTag,{value:"Module"}));function A1(){return[0,0,0,0]}function I1(t){return[t[0],t[1],t[2],t[3]]}function j1(t,e,i,n){return[t,e,i,n]}function C1(t,e=A1()){const i=Math.min(4,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function E1(t,e){return new Float64Array(t,e,4)}function O1(){return A1()}function L1(){return j1(1,1,1,1)}function N1(){return j1(1,0,0,0)}function R1(){return j1(0,1,0,0)}function P1(){return j1(0,0,1,0)}function F1(){return j1(0,0,0,1)}const D1=O1(),$1=L1(),z1=N1(),U1=R1(),V1=P1(),G1=F1();Object.freeze(Object.defineProperty({__proto__:null,ONES:$1,UNIT_W:G1,UNIT_X:z1,UNIT_Y:U1,UNIT_Z:V1,ZEROS:D1,clone:I1,create:A1,createView:E1,fromArray:C1,fromValues:j1,ones:L1,unitW:F1,unitX:N1,unitY:R1,unitZ:P1,zeros:O1},Symbol.toStringTag,{value:"Module"}));function B1(t){return"r"in t&&"g"in t&&"b"in t}function q1(t){return"h"in t&&"s"in t&&"v"in t}function H1(t){return"l"in t&&"a"in t&&"b"in t}function W1(t){return"l"in t&&"c"in t&&"h"in t}function Z1(t){return"x"in t&&"y"in t&&"z"in t}const J1=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],K1=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function Y1(t,e){const i=[];let n,s;if(t[0].length!==e.length)throw new Error("dimensions do not match");const r=t.length,o=t[0].length;let a=0;for(n=0;n<r;n++){for(a=0,s=0;s<o;s++)a+=t[n][s]*e[s];i.push(a)}return i}function Q1(t){const e=[t.r/255,t.g/255,t.b/255].map((t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4)),i=Y1(J1,e);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function X1(t){const e=Y1(K1,[t.x/100,t.y/100,t.z/100]).map((t=>{const e=t<=.0031308?12.92*t:1.055*t**(1/2.4)-.055;return Math.min(1,Math.max(e,0))}));return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function t2(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map((t=>t>(6/29)**3?t**(1/3):1/3*(29/6)**2*t+4/29));return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function e2(t){const e=t.l,i=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map((t=>t>6/29?t**3:3*(6/29)**2*(t-4/29)));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function i2(t){const e=t.l,i=t.a,n=t.b,s=Math.sqrt(i*i+n*n);let r=Math.atan2(n,i);return r=r>0?r:r+2*Math.PI,{l:e,c:s,h:r}}function n2(t){const e=t.l,i=t.c,n=t.h;return{l:e,a:i*Math.cos(n),b:i*Math.sin(n)}}function s2(t){return t2(Q1(t))}function r2(t){return X1(e2(t))}function o2(t){return i2(t2(Q1(t)))}function a2(t){return X1(e2(n2(t)))}function l2(t){const e=t.r,i=t.g,n=t.b,s=Math.max(e,i,n),r=s-Math.min(e,i,n);let o=s,a=0===r?0:s===e?(i-n)/r%6:s===i?(n-e)/r+2:(e-i)/r+4,l=0===r?0:r/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}function u2(t){const e=(t.h+360)%360/60,i=t.s/100,n=t.v/100*255,s=n*i,r=s*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r:s,g:r,b:0};break;case 1:o={r,g:s,b:0};break;case 2:o={r:0,g:s,b:r};break;case 3:o={r:0,g:r,b:s};break;case 4:o={r,g:0,b:s};break;case 5:case 6:o={r:s,g:0,b:r};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+n-s),o.g=Math.round(o.g+n-s),o.b=Math.round(o.b+n-s),o}function c2(t){return B1(t)?t:W1(t)?a2(t):H1(t)?r2(t):Z1(t)?X1(t):q1(t)?u2(t):t}function h2(t){if(q1(t))return t;return l2(c2(t))}function d2(t){return H1(t)?t:s2(c2(t))}function f2(t){return W1(t)?t:o2(c2(t))}function p2(t){let{r:e,g:i,b:n,a:s}=t;return s<1&&(e=Math.round(s*e+255*(1-s)),i=Math.round(s*i+255*(1-s)),n=Math.round(s*n+255*(1-s))),new wT({r:e,g:i,b:n})}function m2(t,e){const{r:i,g:n,b:s}=e?.ignoreAlpha?t:p2(t);return.2126*i+.7152*n+.0722*s}var y2;!function(t){t[t.Low=160]="Low",t[t.High=225]="High"}(y2||(y2={}));const g2={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderLineColor:[0,0,0,1]},v2={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetX:0,offsetY:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:"Loop",repeatdelay:0}};function w2(t){return[t.r,t.g,t.b,t.a]}const b2=" /-,\n";function S2(t){let e=t.length;for(;e--;)if(!b2.includes(t.charAt(e)))return!1;return!0}function x2(t,e){const i=[];let n=0,s=-1;do{if(s=t.indexOf("[",n),s>=n){if(s>n){const e=t.substr(n,s-n);i.push([e,null,S2(e)])}if(n=s+1,s=t.indexOf("]",n),s>=n){if(s>n){const r=e[t.substr(n,s-n)];r&&i.push([null,r,!1])}n=s+1}}}while(-1!==s);if(n<t.length-1){const e=t.substr(n);i.push([e,null,S2(e)])}return i}function _2(t,e,i,n){let s="",r=null;for(const n of e){const[e,o,a]=n;if(e)a?r=e:(r&&(s+=r,r=null),s+=e);else{let e=o;null!=i&&(e=i3(o,i));const n=t.attributes[e];n&&(r&&(s+=r,r=null),s+=n)}}return M2(s,n)}function M2(t,e){switch("string"!=typeof t&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function k2(t,e,i,n,s,r,o=!0){const a=e/s,l=i/r,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let i=0;i<r;i++)for(let h=0;h<s;h++){const d=4*(h+(o?r-i-1:i)*s);let f=0,p=0,m=0,y=0,g=0,v=0,w=0;const b=(i+.5)*l;for(let n=Math.floor(i*l);n<(i+1)*l;n++){const i=Math.abs(b-(n+.5))/c,s=(h+.5)*a,r=i*i;for(let i=Math.floor(h*a);i<(h+1)*a;i++){let o=Math.abs(s-(i+.5))/u;const a=Math.sqrt(r+o*o);a>=-1&&a<=1&&(f=2*a*a*a-3*a*a+1,f>0&&(o=4*(i+n*e),w+=f*t[o+3],m+=f,t[o+3]<255&&(f=f*t[o+3]/250),y+=f*t[o],g+=f*t[o+1],v+=f*t[o+2],p+=f))}}n[d]=y/p,n[d+1]=g/p,n[d+2]=v/p,n[d+3]=w/m}}function T2(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function A2(t){return t.data?.symbol??null}function I2(t){return"CIMVectorMarker"===t.type||"CIMPictureMarker"===t.type||"CIMBarChartMarker"===t.type||"CIMCharacterMarker"===t.type||"CIMPieChartMarker"===t.type||"CIMStackedBarChartMarker"===t.type}function j2(t){return"CIMGradientStroke"===t.type||"CIMPictureStroke"===t.type||"CIMSolidStroke"===t.type}function C2(t){return null!=t&&("CIMGradientFill"===t.type||"CIMHatchFill"===t.type||"CIMPictureFill"===t.type||"CIMSolidFill"===t.type||"CIMWaterFill"===t.type)}function E2(t){return null!=t&&("CIMMarkerPlacementAlongLineRandomSize"===t.type||"CIMMarkerPlacementAlongLineSameSize"===t.type||"CIMMarkerPlacementAlongLineVariableSize"===t.type||"CIMMarkerPlacementAtExtremities"===t.type||"CIMMarkerPlacementAtMeasuredUnits"===t.type||"CIMMarkerPlacementAtRatioPositions"===t.type||"CIMMarkerPlacementOnLine"===t.type||"CIMMarkerPlacementOnVertices"===t.type)}const O2=(t,e=0)=>null==t||isNaN(t)?e:t,L2=(t,e)=>t??e,N2=t=>t.tintColor?T2(t.tintColor):[255,255,255,1],R2=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function P2(){return import("./p-6d4e518a.js")}function F2(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function D2(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function $2(t){let e="normal",i="normal";if(t){const n=t.toLowerCase();n.includes("italic")?e="italic":n.includes("oblique")&&(e="oblique"),n.includes("bold")?i="bold":n.includes("light")&&(i="lighter")}return{style:e,weight:i}}function z2(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function U2(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=U2(e);if(null!=t)return t}break;case"CIMTextSymbol":return U2(t.symbol);case"CIMSolidFill":return t.color}return null}function V2(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const t of e){const e=V2(t);if(null!=e)return e}break}case"CIMTextSymbol":return V2(t.symbol);case"CIMSolidStroke":return t.color}}function G2(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=G2(e);if(void 0!==t)return t}break;case"CIMTextSymbol":return G2(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function B2(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function q2(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function H2(t){return(t?Object.keys(t):[]).map((e=>({name:e,alias:e,type:"string"==typeof t[e]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const W2=t=>t.includes("data:image/svg+xml");function Z2(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function J2(t){return t?t.charAt(0).toLowerCase()+t.substring(1):t}function K2(t,e,i,n,s,r){const{infos:o}=r;let a=1,l=0,u=0,c=0;for(const{offsetX:t,offsetY:e,rotation:i,size:n,frameHeight:s,rotateClockWise:r}of o){u=s3(t,e,l,a,u),c=n3(t,e,l,a,c),s&&(a*=n/s),l=r3(i,r,l)}const h=s3(n,s,l,a,u),d=n3(n,s,l,a,c);return{size:t*a,rotation:r3(e,i,l),offsetX:h,offsetY:d}}function Y2(t){if(null==t)return!1;if(Array.isArray(t))return t.every((t=>Y2(t)));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function Q2(t,e){if("color"===e||"outlinecolor"===e||"backgroundcolor"===e||"borderLineColor"===e)return[...g2[e]];const i=v2[t];if(!i||"boolean"==typeof i[e])throw new Error(`InternalError: default value for type ${t}.`);return i[e]}function X2(t){return t?.dashTemplate&&"string"==typeof t.dashTemplate&&(t.dashTemplate=t.dashTemplate.split(" ").map(Number)),t}function t3(t){if(null==t)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const t of e)if("CIMVectorMarker"===t.type)return t3(t)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const t of e)if(t.symbol)return t3(t.symbol)}}return"Normal"}function e3(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers)for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const t=i.size??v2.CIMVectorMarker.size;t>e&&(e=t);break}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers)for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const t=i.width;null!=t&&t>e&&(e=t);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(i.markerPlacement&&E2(i.markerPlacement)){const t=i.size??v2.CIMVectorMarker.size;t>e&&(e=t)}break;case"CIMPictureFill":{const t=i.height;null!=t&&t>e&&(e=t)}}return e}}}function i3(t,e){if(null!==e){const i=e.get(t);return i?i.name:t}return t}function n3(t,e,i,n,s){const r=i*Math.PI/180;if(r){const i=Math.cos(r);return(Math.sin(r)*t+i*e)*n+s}return e*n+s}function s3(t,e,i,n,s){const r=i*Math.PI/180;if(r){return(Math.cos(r)*t-Math.sin(r)*e)*n+s}return t*n+s}function r3(t,e,i){return e?i-t:i+t}const o3=(t,e,i)=>[e,i],a3=(t,e,i)=>[e,i,t[2]],l3=(t,e,i)=>[e,i,t[2],t[3]];function u3(t){if(!t)return null;return{originPosition:"upper-left"===t.originPosition?"upperLeft":"lower-left"===t.originPosition?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance]:[1,1],translate:null!=t.extent?[t.extent.xmin,t.extent.ymax]:[0,0]}}function c3({scale:t,translate:e},i){return Math.round((i-e[0])/t[0])}function h3({scale:t,translate:e},i){return Math.round((e[1]-i)/t[1])}function d3({scale:t,translate:e},i){return i*t[0]+e[0]}function f3({scale:t,translate:e},i){return e[1]-i*t[1]}function p3(t,e,i){const n=new Array(i.length);if(!i.length)return n;const[s,r]=t.scale;let o=d3(t,i[0][0]),a=f3(t,i[0][1]);n[0]=e(i[0],o,a);for(let t=1;t<i.length;t++){const l=i[t];o+=l[0]*s,a-=l[1]*r,n[t]=e(l,o,a)}return n}function m3(t,e,i){const n=new Array(i.length);for(let s=0;s<i.length;s++)n[s]=p3(t,e,i[s]);return n}function y3(t,e,i,n){return p3(t,i?n?l3:a3:n?a3:o3,e)}function g3(t,e,i,n){return m3(t,i?n?l3:a3:n?a3:o3,e)}function v3(t,e,i,n){return m3(t,i?n?l3:a3:n?a3:o3,e)}function w3(t,e,i,n,s){return e.x=c3(t,i.x),e.y=h3(t,i.y),e!==i&&(n&&(e.z=i.z),s&&(e.m=i.m)),e}function b3(t,e,i,n,s){return null!=i&&(e.points=y3(t,i.points,n,s)),e}function S3(t,e,i,n,s){return null==i||(e.x=d3(t,i.x),e.y=f3(t,i.y),e!==i&&(n&&(e.z=i.z),s&&(e.m=i.m))),e}function x3(t,e,i,n,s){return null!=i&&(e.rings=v3(t,i.rings,n,s)),e}function _3(t,e,i,n,s){return null!=i&&(e.paths=g3(t,i.paths,n,s)),e}function M3(t,e,i,n,s){if(null==t)return null;const r=t.referencesGeometry()&&s?T3(e,n,s):e,o=t.repurposeFeature(r);try{return t.evaluate({...i,$feature:o},t.services)}catch(t){return Ft.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",t),null}}const k3=new Map;function T3(t,e,i){const{transform:n,hasZ:s,hasM:r}=i;k3.has(e)||k3.set(e,A3(e));const o=k3.get(e)(t.geometry,n,s,r);return{...t,geometry:o}}function A3(t){const e={};switch(t){case"esriGeometryPoint":return(t,i,n,s)=>S3(i,e,t,n,s);case"esriGeometryPolygon":return(t,i,n,s)=>x3(i,e,t,n,s);case"esriGeometryPolyline":return(t,i,n,s)=>_3(i,e,t,n,s);case"esriGeometryMultipoint":return(t,i,n,s)=>b3(i,e,t,n,s);default:return Ft.getLogger("esri.views.2d.support.arcadeOnDemand").error(new Qe("mapview-arcade",`Unable to handle geometryType: ${t}`)),t=>t}}const I3=t=>{if(!t)return[0,0,0,0];const{r:e,g:i,b:n,a:s}=t;return[e,i,n,255*s]};class j3{static findApplicableOverrides(t,e,i){if(t&&e){if(t.primitiveName){let n=!1;for(const e of i)if(e.primitiveName===t.primitiveName){n=!0;break}if(!n)for(const n of e)n.primitiveName===t.primitiveName&&i.push(n)}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const n of t.effects)j3.findApplicableOverrides(n,e,i);if(t.symbolLayers)for(const n of t.symbolLayers)j3.findApplicableOverrides(n,e,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(t.effects)for(const n of t.effects)j3.findApplicableOverrides(n,e,i);if(t.markerPlacement&&j3.findApplicableOverrides(t.markerPlacement,e,i),"CIMVectorMarker"===t.type){if(t.markerGraphics)for(const n of t.markerGraphics)j3.findApplicableOverrides(n,e,i),j3.findApplicableOverrides(n.symbol,e,i)}else"CIMCharacterMarker"===t.type?j3.findApplicableOverrides(t.symbol,e,i):"CIMHatchFill"===t.type?j3.findApplicableOverrides(t.lineSymbol,e,i):"CIMPictureMarker"===t.type&&j3.findApplicableOverrides(t.animatedSymbolProperties,e,i)}}}static findEffectOverrides(t,e){if(!t)return null;if("CIMGeometricEffectDashes"===t.type&&X2(t),!e||!t.primitiveName)return{type:"cim-effect-info",effect:t,overrides:[]};const i=t.primitiveName,n=[];for(const t of e)t.primitiveName===i&&n.push({...t,propertyName:J2(t.propertyName)});return{type:"cim-effect-info",effect:t,overrides:n}}static async resolveSymbolOverrides(t,e,i,n,s,r,o){if(!t?.symbol)return null;let{symbol:a,primitiveOverrides:l}=t;const u=!!l;if(!u&&!n)return a;a=ht(a),l=ht(l);let c=!0;if(e||(e={attributes:{}},c=!1),u){if(c||(l=l.filter((t=>!t.valueExpressionInfo?.expression.includes("$feature")))),o||(l=l.filter((t=>!t.valueExpressionInfo?.expression.includes("$view")))),l.length>0){const t={spatialReference:i,fields:H2(e.attributes),geometryType:s};await j3.createRenderExpressions(l,t),j3.evaluateOverrides(l,e,s??"esriGeometryPoint",r,o)}j3.applyOverrides(a,l)}return n&&j3.applyDictionaryTextOverrides(a,e,n,null),a}static async createRenderExpressions(t,e){const i=[];for(const n of t){const t=n.valueExpressionInfo;if(!t||j3._expressionToRenderExpression.has(t.expression))continue;const s=oC(t.expression,e.spatialReference,e.fields);i.push(s),s.then((e=>j3._expressionToRenderExpression.set(t.expression,e)))}i.length>0&&await Promise.all(i)}static evaluateOverrides(t,e,i,n,s){const r={$view:{scale:s?.scale}};for(const s of t){s.value&&"object"==typeof s.value&&B1(s.value)&&("Color"===s.propertyName||"StrokeColor"===s.propertyName)&&(s.value=I3(s.value));const t=s.valueExpressionInfo;if(!t)continue;const o=j3._expressionToRenderExpression.get(t.expression);o&&(s.value=M3(o,e,r,i,n))}}static applyDictionaryTextOverrides(t,e,i,n,s="Normal"){if(t?.type)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const r=t.symbolLayers;if(!r)return;for(const o of r)o&&"CIMVectorMarker"===o.type&&j3.applyDictionaryTextOverrides(o,e,i,n,"CIMTextSymbol"===t.type?t.textCase:s)}break;case"CIMVectorMarker":{const s=t.markerGraphics;if(!s)return;for(const t of s)t&&j3.applyDictionaryTextOverrides(t,e,i,n)}break;case"CIMMarkerGraphic":{const r=t.textString;if(r&&r.includes("[")){const o=x2(r,i);t.textString=_2(e,o,n,s)}}}}static applyOverrides(t,e,i,n){if(t.primitiveName)for(const s of e)if(s.primitiveName===t.primitiveName){const e=J2(s.propertyName);if(n&&n.push({cim:t,nocapPropertyName:e,value:t[e]}),i){let e=!1;for(const n of i)n.primitiveName===t.primitiveName&&(e=!0);e||i.push(s)}null!=s.value&&(t[e]=s.value)}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const s of t.effects)j3.applyOverrides(s,e,i,n);if(t.symbolLayers)for(const s of t.symbolLayers)j3.applyOverrides(s,e,i,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(t.effects)for(const s of t.effects)j3.applyOverrides(s,e,i,n);if("CIMVectorMarker"===t.type&&t.markerGraphics)for(const s of t.markerGraphics)j3.applyOverrides(s,e,i,n),j3.applyOverrides(s.symbol,e,i,n)}}static restoreOverrides(t){for(const e of t)e.cim[e.nocapPropertyName]=e.value}static buildOverrideKey(t){let e="";for(const i of t)void 0!==i.value&&(e+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return e}static toValue(t,e){if("DashTemplate"===t)return e.split(" ").map((t=>Number(t)));if("Color"===t){const t=new wT(e).toRgba();return t[3]*=255,t}return e}}j3._expressionToRenderExpression=new Map;const C3="esri.renderers.support.DictionaryLoader",E3={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};class O3{constructor(t,e,i){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new E0(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=t,this.config=e,this.fieldMap=i}getSymbolFields(){return this._symbolFields}async getSymbolAsync(t,e){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(e));try{i=await this._dictionaryPromise}catch(t){if(Pi(t))return this._dictionaryPromise=null,null}const n=this._dictionaryVersion&&this._dictionaryVersion.since(4,0),s={};if(this.fieldMap)for(const e of this._symbolFields){const i=i3(this.fieldMap[e],this._fieldIndex);if(i){const r=t.attributes[i];s[e]=n?r:null!=r?""+t.attributes[i]:""}else s[e]=""}let r=null;try{r=i?.(s,e)}catch(t){return null}if(!r||"string"!=typeof r||"invalid"===r)return null;const o=r.split(";"),a=[],l=[];for(const t of o)if(t)if(t.includes("po:")){const e=t.substr(3).split("|");if(3===e.length){const t=e[0],i=e[1];let n=e[2];if("DashTemplate"===i)n=n.split(" ").map((t=>Number(t)));else if("Color"===i){const t=new wT(n).toRgba();n=[t[0],t[1],t[2],255*t[3]]}else n=Number(n);l.push({primitiveName:t,propertyName:i,value:n,defaultValue:null})}}else if(t.includes("|")){for(const e of t.split("|"))if(this._itemNames.has(e)){a.push(e);break}}else this._itemNames.has(t)&&a.push(t);const u=null==t.geometry||!t.geometry.hasZ&&"point"===t.geometry.type;return this._cimPartsToCIMSymbol(t,a,l,u,e)}async fetchResources(t){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void Ft.getLogger(C3).error("no valid URL!");const e=hc(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:null!=t?t.signal:null}),[{data:i}]=await Promise.all([e,rC()]);if(!i)throw this._dictionaryPromise=null,new Qe("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:s,expression:r,itemsNames:o}=i,a=r;let l=!1;s&&(this._dictionaryVersion=O0.parse(s),l=this._dictionaryVersion.since(4,0)),this._refSymbolUrlTemplate=this.url+"/"+i.cimRefTemplateUrl,this._itemNames=new Set(o),this._symbolFields=n.symbol;const u={};if(this.config){const t=this.config;for(const e in t)u[e]=t[e]}if(n.configuration)for(const t of n.configuration)u.hasOwnProperty(t.name)||(u[t.name]=t.value);const c=[];if(t?.fields&&this.fieldMap)for(const e in this.fieldMap){const i=this.fieldMap[e],n=t.fields.filter((t=>t.name.toLowerCase()===i?.toLowerCase()));n.length>0&&c.push({...n[0],type:l?n[0].type:"esriFieldTypeString"})}c.length>0&&(this._fieldIndex=new z0(c));const h=aC(a,null!=t?t.spatialReference:null,c,u).then((t=>{const e={scale:0};return(i,n)=>{if(null==t)return null;const s=t.repurposeFeature({geometry:null,attributes:i});return e.scale=null!=n?n.scale??void 0:void 0,t.evaluate({$feature:s,$view:e},t.services)}})).catch((t=>(Ft.getLogger(C3).error("Creating dictinoary expression failed:",t),null)));return this._dictionaryPromise=h,h}async _cimPartsToCIMSymbol(t,e,i,n,s){const r=new Array(e.length);for(let t=0;t<e.length;t++)r[t]=this._getSymbolPart(e[t],s);let o=await Promise.all(r);const a=this.fieldMap;if(a){o=ht(o);for(const e of o)j3.applyDictionaryTextOverrides(e,t,a,this._fieldIndex,t3(e))}return new SL({data:this._combineSymbolParts(o,i,n)})}async _getSymbolPart(t,e){const i=this._symbolCache.get(t);if(i)return i;if(this._ongoingRequests.has(t))return this._ongoingRequests.get(t).then((t=>t.data));const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,t),s=hc(n,{responseType:"json",query:{f:"json"},...e});this._ongoingRequests.set(t,s),s.finally((()=>this._ongoingRequests.delete(t)));try{const e=await s;return this._symbolCache.put(t,e.data),e.data}catch(t){throw t}}_combineSymbolParts(t,e,i){if(!t||0===t.length)return null;const n={...t[0]};if(t.length>1){n.symbolLayers=[];for(const e of t){const t=e;n.symbolLayers.unshift(...t.symbolLayers)}}return i&&(n.callout=E3),{type:"CIMSymbolReference",symbol:n,primitiveOverrides:e}}}var L3;let N3=L3=class extends(t0(EQ)){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new O3(this.url,this.config,this.fieldMap)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,n){n?.origin||super.writeVisualVariables(t,e,i,n)}clone(){return new L3({config:ht(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:ht(this.fieldMap),url:ht(this.url),visualVariables:ht(this.visualVariables)})}async getSymbolAsync(t,e){return this._loader.getSymbolAsync(t,e)}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await _C(t,e,this.scaleExpression);for(const i in this.fieldMap){const n=this.fieldMap[i];e.has(n)&&t.add(n)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};o([Us({type:O3})],N3.prototype,"_loader",null),o([Us({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],N3.prototype,"config",void 0),o([Us({type:Object,json:{write:!0}})],N3.prototype,"fieldMap",void 0),o([Us({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],N3.prototype,"scaleExpression",void 0),o([ll("scaleExpression")],N3.prototype,"writeData",null),o([Us({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],N3.prototype,"scaleExpressionTitle",void 0),o([Us({type:String,json:{write:!0}})],N3.prototype,"url",void 0),o([ll("visualVariables")],N3.prototype,"writeVisualVariables",null),N3=L3=o([Nr("esri.renderers.DictionaryRenderer")],N3);const R3=N3;var P3;let F3=P3=class extends el{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return null==t?t:"function"==typeof t?(Ft.getLogger(this).error(".field: field must be a string value"),null):ds(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new P3({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};o([Us({type:wT,json:{type:[Number],write:!0}})],F3.prototype,"color",void 0),o([Us({type:String,json:{write:!0}})],F3.prototype,"field",void 0),o([ol("field")],F3.prototype,"castField",null),o([Us({type:String,json:{write:!0}})],F3.prototype,"label",void 0),o([Us({type:String,json:{write:!0}})],F3.prototype,"valueExpression",void 0),o([Us({type:String,json:{write:!0}})],F3.prototype,"valueExpressionTitle",void 0),F3=P3=o([Nr("esri.renderers.support.AttributeColorInfo")],F3);const D3=F3;var $3;let z3=$3=class extends el{constructor(){super(...arguments),this.unit=null}clone(){return new $3({unit:this.unit})}};o([Us({type:String,json:{write:!0}})],z3.prototype,"unit",void 0),z3=$3=o([Nr("esri.renderers.support.DotDensityLegendOptions")],z3);const U3=z3;var V3;let G3=V3=class extends(t0(EQ)){constructor(t){super(t),this.attributes=null,this.backgroundColor=new wT([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new QL,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(null==this.referenceScale)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new uF({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new V3({attributes:ht(this.attributes),backgroundColor:ht(this.backgroundColor),dotBlendingEnabled:ht(this.dotBlendingEnabled),dotShape:ht(this.dotShape),dotSize:ht(this.dotSize),dotValue:ht(this.dotValue),legendOptions:ht(this.legendOptions),outline:ht(this.outline),referenceScale:ht(this.referenceScale),seed:ht(this.seed),visualVariables:ht(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){const t=this.attributes?.map((t=>t.field||t.valueExpression||""));return`${t}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes??[])i.valueExpression&&await _C(t,e,i.valueExpression),i.field&&t.add(i.field)}};o([Us({type:[D3],json:{write:!0}})],G3.prototype,"attributes",void 0),o([Us({type:wT,json:{write:!0}})],G3.prototype,"backgroundColor",void 0),o([Us({type:Boolean,json:{write:!0}})],G3.prototype,"dotBlendingEnabled",void 0),o([Us({type:String,json:{write:!1}})],G3.prototype,"dotShape",void 0),o([Us({type:Number,json:{write:!0}})],G3.prototype,"dotSize",void 0),o([Us({type:U3,json:{write:!0}})],G3.prototype,"legendOptions",void 0),o([Us({type:QL,json:{default:null,write:!0}})],G3.prototype,"outline",void 0),o([Us({type:Number,json:{write:!0}})],G3.prototype,"dotValue",void 0),o([Us({type:Number,json:{write:!0}})],G3.prototype,"referenceScale",void 0),o([Us({type:Number,json:{write:!0}})],G3.prototype,"seed",void 0),o([ST({dotDensity:"dot-density"})],G3.prototype,"type",void 0),G3=V3=o([Nr("esri.renderers.DotDensityRenderer")],G3);const B3=G3;var q3;let H3=q3=class extends el{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new q3({color:this.color&&this.color.clone(),ratio:this.ratio})}};o([Us({type:wT,json:{type:[Ns],default:null,write:!0}})],H3.prototype,"color",void 0),o([Us({type:Number,json:{write:!0}})],H3.prototype,"ratio",void 0),H3=q3=o([Nr("esri.renderers.support.HeatmapColorStop")],H3);const W3=H3;let Z3=class extends(Gr(el)){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};o([Us({type:String,json:{write:!0}})],Z3.prototype,"minLabel",void 0),o([Us({type:String,json:{write:!0}})],Z3.prototype,"maxLabel",void 0),o([Us({type:String,json:{write:!0}})],Z3.prototype,"title",void 0),Z3=o([Nr("esri.renderers.support.HeatmapLegendOptions")],Z3);const J3=2.4;function K3(t){return PT(t*J3)}function Y3(t){return RT(t)/J3}function Q3(t,e,i,n){let{color:s,ratio:r}=e,{color:o,ratio:a}=i;if(a===r){const t=1e-6;1===a?r-=t:a+=t}const l=pa((n-r)/(a-r),0,1);f1(t,s.toArray(),o.toArray(),l)}function X3(t){const e=512,i=new Uint8ClampedArray(4*e);if(t=t.filter((({ratio:t})=>t>=0&&t<=1)).sort(((t,e)=>t.ratio-e.ratio)).map((({color:t,ratio:e})=>({color:t,ratio:Math.max(e,.001)}))),t.length<1)return i;let n=t[0],s=t[0],r=1;const o=A1();for(let a=0;a<e;a++){const l=(a+.5)/e;for(;l>s.ratio&&r<t.length;)n=s,s=t[r++];Q3(o,n,s,l),i.set(o,4*a)}return i}function t5(t,e,i){const n=Math.sqrt(t**2+e**2)/i;return n>1?0:3/(Math.PI*i**2)*(1-n**2)**2}function e5(t){return"function"==typeof t?t:t?e=>+e[t]:()=>1}var i5;function n5(t){if(null!=t){const{maxDensity:e,minDensity:i,radius:n}=t;if(null!=e||null!=i||null!=n){const{blurRadius:e,maxPixelIntensity:i,minPixelIntensity:n,...s}=t;return s}}return t}let s5=i5=class extends EQ{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new W3({ratio:0,color:new wT("rgba(255, 140, 0, 0)")}),new W3({ratio:.75,color:new wT("rgba(255, 140, 0, 1)")}),new W3({ratio:.9,color:new wT("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(t){return n5(t)}get blurRadius(){return Y3(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",K3(t)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(J3**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(t,e){if(this._warnedProps[t])return;"user"===Yt(this).getDefaultOrigin()&&(this._warnedProps[t]=!0,ln((()=>{p(Ft.getLogger(this),t,{replacement:`${String(e)} (suggested value: ${this._get(e)})`,version:"4.24"})})))}read(t,e){t=n5(t),super.read(t,e)}getSymbol(){return new fF}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const i=this.field,n=this.valueExpression;i&&"string"==typeof i&&bC(t,e,i),n&&"string"==typeof n&&await _C(t,e,n)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new i5({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:ht(this.colorStops),field:this.field,legendOptions:ht(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};o([Us({type:IQ,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],s5.prototype,"authoringInfo",void 0),o([Us({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],s5.prototype,"blurRadius",null),o([Us({type:[W3],json:{write:!0}})],s5.prototype,"colorStops",void 0),o([Us({type:String,json:{write:!0}})],s5.prototype,"field",void 0),o([Us({type:Z3,json:{write:!0}})],s5.prototype,"legendOptions",void 0),o([Us({type:Number,json:{write:!0}})],s5.prototype,"maxDensity",void 0),o([Us({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],s5.prototype,"maxPixelIntensity",null),o([Us({type:Number,json:{write:!0}})],s5.prototype,"minDensity",void 0),o([Us({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],s5.prototype,"minPixelIntensity",null),o([Us({type:Number,cast:FT,json:{write:!0}})],s5.prototype,"radius",void 0),o([Us({type:Number,range:{min:0},json:{default:0,write:!0}})],s5.prototype,"referenceScale",void 0),o([ST({heatmap:"heatmap"})],s5.prototype,"type",void 0),o([Us({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],s5.prototype,"valueExpression",void 0),o([Us({type:String})],s5.prototype,"valueExpressionTitle",void 0),o([Us({readOnly:!0})],s5.prototype,"_pixelIntensityToDensity",null),s5=i5=o([Nr("esri.renderers.HeatmapRenderer")],s5);const r5=s5;let o5=class extends(Gr(el)){constructor(){super(...arguments),this.color=new wT([0,0,0,0]),this.label=null,this.threshold=0}};o([Us({type:wT,json:{write:!0}})],o5.prototype,"color",void 0),o([Us({type:String,json:{write:!0}})],o5.prototype,"label",void 0),o([Us({type:Number,range:{min:0,max:1},json:{write:!0}})],o5.prototype,"threshold",void 0),o5=o([Nr("esri.renderers.support.OthersCategory")],o5);let a5=class extends(Gr(el)){constructor(){super(...arguments),this.title=null}};o([Us({type:String,json:{write:!0}})],a5.prototype,"title",void 0),a5=o([Nr("esri.renderers.support.PieChartLegendOptions")],a5);let l5=class extends(t0(Gr(EQ))){constructor(t){super(t),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new wT([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new o5,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){return new fF({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(F)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((t,e)=>t+JSON.stringify(e)),"")}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes)i.valueExpression&&await _C(t,e,i.valueExpression),i.field&&t.add(i.field)}};o([Us({type:[D3],json:{write:!0}})],l5.prototype,"attributes",void 0),o([Us({type:uF,json:{default:null,write:!0}})],l5.prototype,"backgroundFillSymbol",void 0),o([Us({type:wT,json:{write:!0}})],l5.prototype,"defaultColor",void 0),o([Us({type:String,json:{write:!0}})],l5.prototype,"defaultLabel",void 0),o([Us({type:Number,range:{min:0,max:1},json:{write:!0}})],l5.prototype,"holePercentage",void 0),o([Us({type:o5,json:{write:!0}})],l5.prototype,"othersCategory",void 0),o([Us({type:a5,json:{write:!0}})],l5.prototype,"legendOptions",void 0),o([Us({type:QL,json:{default:null,write:!0}})],l5.prototype,"outline",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],l5.prototype,"size",void 0),o([ST({pieChart:"pie-chart"})],l5.prototype,"type",void 0),l5=o([Nr("esri.renderers.PieChartRenderer")],l5);const u5=l5;var c5;let h5=c5=class extends(t0(EQ)){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.getSymbols().map((i=>i.collectRequiredFields(t,e))))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((t,e)=>t+JSON.stringify(e)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new c5({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:ht(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};o([Us({type:String,json:{write:!0}})],h5.prototype,"description",void 0),o([Us({type:String,json:{write:!0}})],h5.prototype,"label",void 0),o([Us(c0)],h5.prototype,"symbol",void 0),o([ST({simple:"simple"})],h5.prototype,"type",void 0),h5=c5=o([Nr("esri.renderers.SimpleRenderer")],h5);const d5=h5;const f5=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function p5(t){return t instanceof Vr}function m5(t){return t instanceof ty?Object.keys(t.items):p5(t)?Yt(t).keys():t?Object.keys(t):[]}function y5(t,e){return t instanceof ty?t.items[e]:t[e]}function g5(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function v5(t){return t?t.declaredClass:null}function w5(t,e){const i=t.diff;if(i&&"function"==typeof i)return i(t,e);const n=m5(t),s=m5(e);if(0===n.length&&0===s.length)return;if(!n.length||!s.length||g5(t,e))return{type:"complete",oldValue:t,newValue:e};const r=s.filter((t=>!n.includes(t))),o=n.filter((t=>!s.includes(t))),a=n.filter((i=>s.includes(i)&&y5(t,i)!==y5(e,i))).concat(r,o).sort(),l=v5(t);if(l&&f5.has(l)&&a.length)return{type:"complete",oldValue:t,newValue:e};let u;const c=p5(t)&&p5(e);for(const n of a){const s=y5(t,n),r=y5(e,n);let o;if((c||"function"!=typeof s&&"function"!=typeof r)&&(s!==r&&(null!=s||null!=r))){if(i&&i[n]&&"function"==typeof i[n])o=i[n]?.(s,r);else if(s instanceof Date&&r instanceof Date){if(s.getTime()===r.getTime())continue;o={type:"complete",oldValue:s,newValue:r}}else o="object"==typeof s&&"object"==typeof r&&v5(s)===v5(r)?w5(s,r):{type:"complete",oldValue:s,newValue:r};null!=o&&(null!=u?u.diff[n]=o:u={type:"partial",diff:{[n]:o}})}}return u}function b5(t,e){return S5(t,e)}function S5(t,e){if(null==t)return!1;const i=e.split(".");let n=t;for(const t of i){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;{const e=n.diff[t];if(!e)return!1;n=e}}return!0}function x5(t,e){if(!t)return!1;if("partial"===t.type){const i=Object.keys(t.diff);return 1===i.length&&i[0]===e}return!1}function _5(t,e){if("function"!=typeof t&&"function"!=typeof e&&(null!=t||null!=e))return null==t||null==e||"object"==typeof t&&"object"==typeof e&&v5(t)!==v5(e)?{type:"complete",oldValue:t,newValue:e}:w5(t,e)}let M5=class extends(Gr(el)){constructor(t){super(t),this.value=null,this.value2=null,this.value3=null}};o([Us(d0)],M5.prototype,"value",void 0),o([Us(d0)],M5.prototype,"value2",void 0),o([Us(d0)],M5.prototype,"value3",void 0),M5=o([Nr("esri.renderers.support.UniqueValue")],M5);const k5=M5;let T5=class extends(Gr(el)){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(t){if(null==t)return null;const e=typeof(t=Array.isArray(t)?t:[t])[0];return"string"===e||"number"===e?t.map((t=>new k5({value:t}))):"object"===e?t[0]instanceof k5?t:t.map((t=>new k5(t))):null}};o([Us({type:String,json:{write:!0}})],T5.prototype,"description",void 0),o([Us({type:String,json:{write:!0}})],T5.prototype,"label",void 0),o([Us(u0)],T5.prototype,"symbol",void 0),o([Us({type:[k5],json:{type:[[String]],read:{reader:t=>t?t.map((t=>new k5({value:t[0],value2:t[1],value3:t[2]}))):null},write:{writer:(t,e)=>{const i=[];for(const e of t){const t=[e.value,e.value2,e.value3].filter(F).map((t=>t.toString()));i.push(t)}e.values=i}}}})],T5.prototype,"values",void 0),o([ol("values")],T5.prototype,"castValues",null),T5=o([Nr("esri.renderers.support.UniqueValueClass")],T5);const A5=T5;let I5=class extends(Gr(el)){constructor(t){super(t),this.heading=null,this.classes=null}};o([Us({type:String,json:{write:!0}})],I5.prototype,"heading",void 0),o([Us({type:[A5],json:{write:!0}})],I5.prototype,"classes",void 0),I5=o([Nr("esri.renderers.support.UniqueValueGroup")],I5);const j5=I5;var C5;let E5=C5=class extends el{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new C5({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${t}`}};o([Us({type:String,json:{write:!0}})],E5.prototype,"description",void 0),o([Us({type:String,json:{write:!0}})],E5.prototype,"label",void 0),o([Us(c0)],E5.prototype,"symbol",void 0),o([Us(d0)],E5.prototype,"value",void 0),E5=C5=o([Nr("esri.renderers.support.UniqueValueInfo")],E5);const O5=E5;const L5=()=>!!c("enable-feature:force-wosr"),N5=()=>c.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0),R5=()=>c.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),P5=()=>c.add("enable-i3s-patching",!0,!0,!0),F5=()=>c.add("enable-i3s-patching",!1,!0,!0),D5=()=>!!c("enable-feature:SceneLayer-editing"),$5=(t="i3s-patching")=>{switch(F5(),R5(),c.add("enable-feature:SceneLayer-editing",!0,!0,!0),t){case"feature-layer-view":N5();break;case"i3s-patching":P5()}};$5("i3s-patching");let z5={};async function U5(t,e){try{return{data:(await W5(t,e)).data,baseUrl:Eu(t),styleUrl:t}}catch(t){return Ei(t),null}}function V5(t,e,i){const n=null!=e.portal?e.portal:YM.getDefault();let s;const r=`${n.url} - ${n.user&&n.user.username} - ${t}`;return z5[r]||(z5[r]=G5(t,n,i).then((t=>(s=t,t.fetchData()))).then((e=>({data:e,baseUrl:s.itemUrl??"",styleName:t})))),z5[r]}function G5(t,e,i){return e.load(i).then((()=>{const n=new PM({disableExtraQuery:!0,query:`owner:${Z5} AND type:${J5} AND typekeywords:"${t}"`});return e.queryItems(n,i)})).then((({results:e})=>{let n=null;const s=t.toLowerCase();if(e&&Array.isArray(e))for(const t of e){const e=t.typeKeywords?.some((t=>t.toLowerCase()===s));if(e&&t.type===J5&&t.owner===Z5){n=t;break}}if(!n)throw new Qe("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return n.load(i)}))}function B5(t,e,i){return null!=t?.styleUrl?U5(t.styleUrl,i):null!=t?.styleName?V5(t.styleName,e,i):Promise.reject(new Qe("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function q5(t){return null===t||"CIMSymbolReference"===t.type?t:{type:"CIMSymbolReference",symbol:t}}function H5(t,e,i=["gltf"]){if("cimRef"===e)return t.cimRef;if(t.formatInfos&&!L5())for(const e of i){const i=t.formatInfos.find((t=>t.type===e));if(i)return i.href}return t.webRef}function W5(t,e){const i={responseType:"json",query:{f:"json"},...e};return hc(ou(t),i)}const Z5="esri_en",J5="Style",K5="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Y5;const Q5="esri.renderers.UniqueValueRenderer",X5=()=>Ft.getLogger(Q5),t4="uvInfos-watcher",e4="uvGroups-watcher",i4=",",n4=ks(O5);function s4(t){const{field1:e,field2:i,field3:n,fieldDelimiter:s,uniqueValueInfos:r,valueExpression:o}=t,a=!(!e||!i);return[{classes:(r??[]).map((t=>{const{symbol:r,label:l,value:u,description:c}=t,[h,d,f]=a?u?.toString()?.split(s||"")||[]:[u],p=[];return(e||o)&&p.push(h),i&&p.push(d),n&&p.push(f),{symbol:r,label:l,values:[p],description:c}}))}]}let r4=Y5=class extends(t0(EQ)){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(t,e){if(!t&&!e)return;if(!t||!e)return{type:"complete",oldValue:t,newValue:e};let i=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let s=0;s<e.length;s++){const r=t.find((t=>t.value===e[s].value));r?_5(r,e[s])?(n.changed.push({type:"complete",oldValue:r,newValue:e[s]}),i=!0):n.unchanged.push({oldValue:r,newValue:e[s]}):(n.added.push(e[s]),i=!0)}for(let s=0;s<t.length;s++){e.find((e=>e.value===t[s].value))||(n.removed.push(t[s]),i=!0)}return i?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return null==t||"function"==typeof t?t:ds(t)}writeField(t,e,i,n){"string"==typeof t?e[i]=t:n?.messages?n.messages.push(new Qe("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):X5().error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,i){return i.portal||YM.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const t=sk(e.styleUrl,i);return Object.freeze({styleUrl:t})}}writeStyleOrigin(t,e,i,n){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=rk(t.styleUrl,n))}set uniqueValueGroups(t){this.styleOrigin?X5().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?X5().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){if(this.styleOrigin)return void X5().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i="object"==typeof t?n4(t):new O5({value:t,symbol:jF(e)}),this.uniqueValueInfos?.push(i),this._valueInfoMap[i.value]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void X5().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let i=0;i<e.length;i++){const n=e[i];if(String(n.value)===String(t)){delete this._valueInfoMap[t],e.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let i=e;return this.valueExpression&&null==e?.arcade&&(i={...i,arcade:await rC()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&null==e?.arcade)return void X5().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return i?.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&null==i?.arcade){const t=await rC(),{arcadeUtils:e}=t;e.hasGeometryOperations(this.valueExpression)&&await e.enableGeometryOperations(),i={...i,arcade:t}}const n=this._getUniqueValueInfo(t,i);return n?.symbol||this.defaultSymbol}getSymbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=this.uniqueValueInfos?.reduce(((t,e)=>t+e.getMeshHash()),"");return`${t}.${e}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new Y5({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:ht(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:ht(this.visualVariables),legendOptions:ht(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:ht(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=ht(this.uniqueValueInfos),i=ht(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(ht(this.styleOrigin))),Object.freeze(e),Object.freeze(i)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",i),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(t,e))),_C(t,e,this.valueExpression)];bC(t,e,this.field),bC(t,e,this.field2),bC(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return B5(this.styleOrigin,{portal:this.portal}).then((t=>{const e=[];return this._valueInfoMap={},t&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach((i=>{const n=new wF({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==t.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const s=new O5({value:i.name,symbol:n});e.push(s),this._valueInfoMap[i.name]=s})),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",i4)}_updateUniqueValues(){null!=this._isInfosSource&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[e.value+""]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(t4);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const i of t)e.push(fy((()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description})),((t,e)=>{t!==e&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)}),{sync:!0}));this.addHandles(e,t4)}}_watchUniqueValueGroups(){this.removeHandles(e4);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const i of t){e.push(fy((()=>({classes:i.classes})),((t,e)=>{t!==e&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}));for(const t of i.classes??[])e.push(fy((()=>({symbol:t.symbol,values:t.values,label:t.label,description:t.description})),((t,e)=>{t!==e&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}))}this.addHandles(e,e4)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:i,field3:n,fieldDelimiter:s,uniqueValueGroups:r,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!i);for(const e of r)for(const r of e.classes??[]){const{symbol:e,label:o,values:l,description:u}=r;for(const r of l??[]){const{value:l,value2:c,value3:h}=r,d=[l];i&&d.push(c),n&&d.push(h);const f=a?d.join(s||""):d[0];t.push(new O5({symbol:e,label:o,value:f,description:u}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:i,valueExpression:n,fieldDelimiter:s,uniqueValueInfos:r}=this;if(!e&&!n||!r.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!i),a=r.map((t=>{const{symbol:e,label:i,value:n,description:r}=t,[a,l,u]=o?n?.toString()?.split(s||"")||[]:[n];return new A5({symbol:e,label:i,description:r,values:[new k5({value:a,value2:l,value3:u})]})})),l=[new j5({classes:a})];t&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:n,spatialReference:s,arcade:r,timeZone:o}=e??{};let a=this._cache.compiledFunc;const l=r.arcadeUtils;if(!a){const t=l.createSyntaxTree(this.valueExpression);a=l.createFunction(t),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(t,l.getViewInfo({viewingMode:i,scale:n,spatialReference:s}),o));return this._valueInfoMap[u+""]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let n;if("function"!=typeof e&&this.field2){const t=this.field2,s=this.field3,r=[];e&&r.push(i[e]),t&&r.push(i[t]),s&&r.push(i[s]),n=r.join(this.fieldDelimiter||"")}else"function"==typeof e?n=e(t):e&&(n=i[e]);return this._valueInfoMap[n+""]}static fromPortalStyle(t,e){const i=new Y5(e?.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",e?.portal||YM.getDefault());const n=i.populateFromStyle();return n.catch((e=>{X5().error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",e)})),n}static fromStyleUrl(t,e){const i=new Y5(e?.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const n=i.populateFromStyle();return n.catch((e=>{X5().error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",e)})),n}};o([Us({readOnly:!0})],r4.prototype,"_cache",null),o([ST({uniqueValue:"unique-value"})],r4.prototype,"type",void 0),o([Us(h0)],r4.prototype,"backgroundFillSymbol",void 0),o([Us({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],r4.prototype,"field",null),o([ol("field")],r4.prototype,"castField",null),o([ll("field")],r4.prototype,"writeField",null),o([Us({type:String,value:null,json:{write:!0}})],r4.prototype,"field2",null),o([Us({type:String,value:null,json:{write:!0}})],r4.prototype,"field3",null),o([Us({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],r4.prototype,"orderByClassesEnabled",void 0),o([Us({type:String,value:null,json:{write:!0}})],r4.prototype,"valueExpression",null),o([Us({type:String,json:{write:!0}})],r4.prototype,"valueExpressionTitle",void 0),o([Us({type:RQ,json:{write:!0}})],r4.prototype,"legendOptions",void 0),o([Us({type:String,json:{write:!0}})],r4.prototype,"defaultLabel",void 0),o([Us(_t({...u0},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],r4.prototype,"defaultSymbol",null),o([Us({type:String,value:null,json:{write:!0}})],r4.prototype,"fieldDelimiter",null),o([Us({type:YM,readOnly:!0})],r4.prototype,"portal",void 0),o([al("portal",["styleName"])],r4.prototype,"readPortal",null),o([Us({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],r4.prototype,"styleOrigin",void 0),o([al("styleOrigin",["styleName","styleUrl"])],r4.prototype,"readStyleOrigin",null),o([ll("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],r4.prototype,"writeStyleOrigin",null),o([Us({type:[j5],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,i)=>(e.uniqueValueGroups||s4(e)).map((t=>j5.fromJSON(t,i)))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],r4.prototype,"uniqueValueGroups",null),o([Us({type:[O5],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],r4.prototype,"uniqueValueInfos",null),r4=Y5=o([Nr(Q5)],r4);const o4=r4;const a4={key:"type",base:EQ,typeMap:{heatmap:r5,simple:d5,"unique-value":o4,"class-breaks":_0,"dot-density":B3,dictionary:R3,"pie-chart":u5},errorContext:"renderer"},l4={key:"type",base:EQ,typeMap:{simple:d5,"unique-value":o4,"class-breaks":_0,heatmap:r5},errorContext:"renderer",validate:u4};function u4(t){switch(t.type){case"simple":return c4(t);case"unique-value":return h4(t);case"class-breaks":return d4(t);case"heatmap":return t}}function c4(t){if(t.symbol)return t;Ft.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function h4(t){const e=t.uniqueValueInfos,i=e?.filter((({symbol:t,label:e},i)=>(t||Ft.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${i}] ${e}) without a symbol from web scene.`),!!t)));return i?.length!==e?.length&&(t.uniqueValueInfos=i),t}function d4(t){const e=t.classBreakInfos,i=e?.filter((({symbol:t,label:e},i)=>(t||Ft.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${i}] ${e}) without a symbol from web scene.`),!!t)));return i?.length!==e?.length&&(t.classBreakInfos=i),t}function f4(t,e){return m4(t,null,e)}const p4=Ks({types:a4});function m4(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&"uniqueValue"!==t.type?(i?.messages&&i.messages.push(new Hs("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):p4(t,e,i):null}const y4=(t=>t)(["operational-layers","basemap","ground"]);var g4;let v4=g4=class extends el{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new g4({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};o([Us({type:String,json:{write:!0}})],v4.prototype,"expression",void 0),o([Us({type:String,json:{write:!0}})],v4.prototype,"name",void 0),o([Us({type:["boolean","date","number","string"],json:{write:!0}})],v4.prototype,"returnType",void 0),o([Us({type:String,json:{write:!0}})],v4.prototype,"title",void 0),v4=g4=o([Nr("esri.form.ExpressionInfo")],v4);const w4=v4;let b4=class extends el{constructor(t){super(t),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};o([Us({type:String,json:{write:!0}})],b4.prototype,"description",void 0),o([Us({type:String,json:{write:!0}})],b4.prototype,"label",void 0),o([Us()],b4.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],b4.prototype,"visibilityExpression",void 0),b4=o([Nr("esri.form.elements.Element")],b4);const S4=b4;var x4;let _4=x4=class extends el{constructor(t){super(t),this.type=null}clone(){return new x4({type:this.type})}};o([Us({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],_4.prototype,"type",void 0),_4=x4=o([Nr("esri.form.elements.inputs.AttachmentInput")],_4);const M4=_4;var k4;let T4=k4=class extends S4{constructor(t){super(t),this.attachmentKeyword=null,this.editableExpression=null,this.input=null,this.type="attachment"}clone(){return new k4({attachmentKeyword:this.attachmentKeyword,description:this.description,editableExpression:this.editableExpression,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}};o([Us({type:String,json:{write:!0}})],T4.prototype,"attachmentKeyword",void 0),o([Us({type:String,json:{write:!0}})],T4.prototype,"editableExpression",void 0),o([Us({type:M4,json:{read:{source:"inputType"},write:{target:"inputType"}}})],T4.prototype,"input",void 0),o([Us({type:["attachment"],json:{read:!1,write:!0}})],T4.prototype,"type",void 0),T4=k4=o([Nr("esri.form.elements.AttachmentElement")],T4);const A4=T4;let I4=class extends el{constructor(t){super(t),this.type=null}};o([Us()],I4.prototype,"type",void 0),I4=o([Nr("esri.form.elements.inputs.Input")],I4);const j4=I4;let C4=class extends j4{constructor(t){super(t),this.maxLength=null,this.minLength=0}};o([Us({type:Number,json:{write:!0}})],C4.prototype,"maxLength",void 0),o([Us({type:Number,json:{write:!0}})],C4.prototype,"minLength",void 0),C4=o([Nr("esri.form.elements.inputs.TextInput")],C4);const E4=C4;var O4;let L4=O4=class extends E4{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new O4({maxLength:this.maxLength,minLength:this.minLength})}};o([Us({type:["barcode-scanner"],json:{read:!1,write:!0}})],L4.prototype,"type",void 0),L4=O4=o([Nr("esri.form.elements.inputs.BarcodeScannerInput")],L4);const N4=L4;var R4;let P4=R4=class extends j4{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new R4({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};o([Us({type:String,json:{write:!0}})],P4.prototype,"noValueOptionLabel",void 0),o([Us({type:Boolean,json:{write:!0}})],P4.prototype,"showNoValueOption",void 0),o([Us({type:["combo-box"],json:{read:!1,write:!0}})],P4.prototype,"type",void 0),P4=R4=o([Nr("esri.form.elements.inputs.ComboBoxInput")],P4);const F4=P4;var D4;function $4(t){return null!=t?t:null}function z4(t){return null!=t?t:null}let U4=D4=class extends j4{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return $4(e.max)}writeMax(t,e){e.max=z4(t)}readMin(t,e){return $4(e.min)}writeMin(t,e){e.min=z4(t)}clone(){return new D4({max:this.max,min:this.min})}};o([Us({type:String,json:{type:String,write:!0}})],U4.prototype,"max",void 0),o([al("max")],U4.prototype,"readMax",null),o([ll("max")],U4.prototype,"writeMax",null),o([Us({type:String,json:{type:String,write:!0}})],U4.prototype,"min",void 0),o([al("min")],U4.prototype,"readMin",null),o([ll("min")],U4.prototype,"writeMin",null),o([Us({type:["date-picker"],json:{read:!1,write:!0}})],U4.prototype,"type",void 0),U4=D4=o([Nr("esri.form.elements.inputs.DatePickerInput")],U4);const V4=U4;var G4;function B4(t){return null!=t?t:null}function q4(t){return null!=t?t:null}let H4=G4=class extends j4{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return B4(e.max)}writeMax(t,e){e.max=q4(t)}readMin(t,e){return B4(e.min)}writeMin(t,e){e.min=q4(t)}readTimeResolution(t,e){return B4(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=q4(t)}clone(){return new G4({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};o([Us({type:Boolean,json:{write:!0}})],H4.prototype,"includeTimeOffset",void 0),o([Us({type:String,json:{type:String,write:!0}})],H4.prototype,"max",void 0),o([al("max")],H4.prototype,"readMax",null),o([ll("max")],H4.prototype,"writeMax",null),o([Us({type:String,json:{type:String,write:!0}})],H4.prototype,"min",void 0),o([al("min")],H4.prototype,"readMin",null),o([ll("min")],H4.prototype,"writeMin",null),o([Us({type:String,json:{type:String,write:!0}})],H4.prototype,"timeResolution",void 0),o([al("timeResolution")],H4.prototype,"readTimeResolution",null),o([ll("timeResolution")],H4.prototype,"writeTimeResolution",null),o([Us({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],H4.prototype,"type",void 0),H4=G4=o([Nr("esri.form.elements.inputs.DateTimeOffsetPickerInput")],H4);const W4=H4;var Z4;function J4(t){return null!=t?new Date(t):null}function K4(t){return t?t.getTime():null}let Y4=Z4=class extends j4{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return J4(e.max)}writeMax(t,e){e.max=K4(t)}readMin(t,e){return J4(e.min)}writeMin(t,e){e.min=K4(t)}clone(){return new Z4({includeTime:this.includeTime,max:this.max,min:this.min})}};o([Us({type:Boolean,json:{write:!0}})],Y4.prototype,"includeTime",void 0),o([Us({type:Date,json:{type:Number,write:!0}})],Y4.prototype,"max",void 0),o([al("max")],Y4.prototype,"readMax",null),o([ll("max")],Y4.prototype,"writeMax",null),o([Us({type:Date,json:{type:Number,write:!0}})],Y4.prototype,"min",void 0),o([al("min")],Y4.prototype,"readMin",null),o([ll("min")],Y4.prototype,"writeMin",null),o([Us({type:["datetime-picker"],json:{read:!1,write:!0}})],Y4.prototype,"type",void 0),Y4=Z4=o([Nr("esri.form.elements.inputs.DateTimePickerInput")],Y4);const Q4=Y4;var X4;let t6=X4=class extends j4{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new X4({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};o([Us({type:String,json:{write:!0}})],t6.prototype,"noValueOptionLabel",void 0),o([Us({type:Boolean,json:{write:!0}})],t6.prototype,"showNoValueOption",void 0),o([Us({type:["radio-buttons"],json:{read:!1,write:!0}})],t6.prototype,"type",void 0),t6=X4=o([Nr("esri.form.elements.inputs.RadioButtonsInput")],t6);const e6=t6;var i6;let n6=i6=class extends j4{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new i6({offValue:this.offValue,onValue:this.onValue})}};o([Us({type:[String,Number],json:{write:!0}})],n6.prototype,"offValue",void 0),o([Us({type:[String,Number],json:{write:!0}})],n6.prototype,"onValue",void 0),o([Us({type:["switch"],json:{read:!1,write:!0}})],n6.prototype,"type",void 0),n6=i6=o([Nr("esri.form.elements.inputs.SwitchInput")],n6);const s6=n6;var r6;let o6=r6=class extends E4{constructor(t){super(t),this.type="text-area"}clone(){return new r6({maxLength:this.maxLength,minLength:this.minLength})}};o([Us({type:["text-area"],json:{read:!1,write:!0}})],o6.prototype,"type",void 0),o6=r6=o([Nr("esri.form.elements.inputs.TextAreaInput")],o6);const a6=o6;var l6;let u6=l6=class extends E4{constructor(t){super(t),this.type="text-box"}clone(){return new l6({maxLength:this.maxLength,minLength:this.minLength})}};o([Us({type:["text-box"],json:{read:!1,write:!0}})],u6.prototype,"type",void 0),u6=l6=o([Nr("esri.form.elements.inputs.TextBoxInput")],u6);const c6=u6;var h6;function d6(t){return null!=t?t:null}function f6(t){return null!=t?t:null}let p6=h6=class extends j4{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return d6(e.max)}writeMax(t,e){e.max=f6(t)}readMin(t,e){return d6(e.min)}writeMin(t,e){e.min=f6(t)}readTimeResolution(t,e){return d6(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=f6(t)}clone(){return new h6({max:this.max,min:this.min,timeResolution:this.timeResolution})}};o([Us({type:String,json:{type:String,write:!0}})],p6.prototype,"max",void 0),o([al("max")],p6.prototype,"readMax",null),o([ll("max")],p6.prototype,"writeMax",null),o([Us({type:String,json:{type:String,write:!0}})],p6.prototype,"min",void 0),o([al("min")],p6.prototype,"readMin",null),o([ll("min")],p6.prototype,"writeMin",null),o([Us({type:String,json:{type:String,write:!0}})],p6.prototype,"timeResolution",void 0),o([al("timeResolution")],p6.prototype,"readTimeResolution",null),o([ll("timeResolution")],p6.prototype,"writeTimeResolution",null),o([Us({type:["time-picker"],json:{read:!1,write:!0}})],p6.prototype,"type",void 0),p6=h6=o([Nr("esri.form.elements.inputs.TimePickerInput")],p6);const m6=p6;const y6={base:j4,key:"type",typeMap:{"barcode-scanner":N4,"combo-box":F4,"date-picker":V4,"datetime-picker":Q4,"datetimeoffset-picker":W4,"radio-buttons":e6,switch:s6,"text-area":a6,"text-box":c6,"time-picker":m6}};var g6;let v6=g6=class extends S4{constructor(t){super(t),this.domain=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}get editable(){return this._get("editable")??!0}set editable(t){this._set("editable",t)}clone(){return new g6({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};o([Us({types:rD,json:{read:{reader:oD},write:!0}})],v6.prototype,"domain",void 0),o([Us({type:Boolean,json:{write:!0}})],v6.prototype,"editable",null),o([Us({type:String,json:{write:!0}})],v6.prototype,"editableExpression",void 0),o([Us({type:String,json:{write:!0}})],v6.prototype,"fieldName",void 0),o([Us({type:String,json:{write:!0}})],v6.prototype,"hint",void 0),o([Us({types:y6,json:{read:{source:"inputType"},write:{target:"inputType"}}})],v6.prototype,"input",void 0),o([Us({type:String,json:{write:!0}})],v6.prototype,"requiredExpression",void 0),o([Us({type:String,json:{read:!1,write:!0}})],v6.prototype,"type",void 0),o([Us({type:String,json:{write:!0}})],v6.prototype,"valueExpression",void 0),v6=g6=o([Nr("esri.form.elements.FieldElement")],v6);const w6=v6;var b6;let S6=b6=class extends S4{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new b6({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:ht(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};o([Us({type:Number,json:{write:!0}})],S6.prototype,"displayCount",void 0),o([Us({type:["list"],json:{write:!0}})],S6.prototype,"displayType",void 0),o([Us({type:String,json:{write:!0}})],S6.prototype,"editableExpression",void 0),o([Us({type:[FO],json:{write:!0}})],S6.prototype,"orderByFields",void 0),o([Us({type:Number,json:{write:!0}})],S6.prototype,"relationshipId",void 0),o([Us({type:["relationship"],json:{read:!1,write:!0}})],S6.prototype,"type",void 0),S6=b6=o([Nr("esri.form.elements.RelationshipElement")],S6);const x6=S6;var _6;let M6=_6=class extends S4{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new _6({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};o([Us({type:String,json:{write:!0}})],M6.prototype,"text",void 0),o([Us({type:String,json:{write:!0}})],M6.prototype,"textFormat",void 0),o([Us({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],M6.prototype,"type",void 0),M6=_6=o([Nr("esri.form.elements.TextElement")],M6);const k6=M6;function T6(t){return{typesWithGroup:{base:S4,key:"type",typeMap:{attachment:A4,field:w6,group:t,relationship:x6,text:k6}},typesWithoutGroup:{base:S4,key:"type",typeMap:{attachment:A4,field:w6,relationship:x6,text:k6}}}}function A6(t,e,i=!0){if(!t)return null;const n=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>n[t.type])).map((t=>n[t.type].fromJSON(t)))}function I6(t,e,i=!0){if(!t)return null;const n=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>n[t.type])).map((t=>t.toJSON()))}function j6(t,e,i=!0){return t?t.map((t=>Ls(i?e.typesWithGroup:e.typesWithoutGroup,t))):null}var C6;let E6=C6=class extends S4{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return j6(t,O6,!1)}readElements(t,e){return A6(e.formElements,O6,!1)}writeElements(t,e){e.formElements=I6(t,O6,!1)}clone(){return new C6({description:this.description,elements:ht(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};o([Us({json:{write:!0}})],E6.prototype,"elements",void 0),o([ol("elements")],E6.prototype,"castElements",null),o([al("elements",["formElements"])],E6.prototype,"readElements",null),o([ll("elements")],E6.prototype,"writeElements",null),o([Us({type:["collapsed","expanded"],json:{write:!0}})],E6.prototype,"initialState",void 0),o([Us({type:String,json:{read:!1,write:!0}})],E6.prototype,"type",void 0),E6=C6=o([Nr("esri.form.elements.GroupElement")],E6);const O6=T6(E6),L6=E6;var N6;const R6=T6(L6);let P6=N6=class extends el{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return j6(t,R6)}readElements(t,e){return A6(e.formElements,R6)}writeElements(t,e){e.formElements=I6(t,R6)}clone(){return new N6({description:this.description,expressionInfos:ht(this.expressionInfos),elements:ht(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}};o([Us({type:String,json:{write:!0}})],P6.prototype,"description",void 0),o([Us({json:{write:!0}})],P6.prototype,"elements",void 0),o([ol("elements")],P6.prototype,"castElements",null),o([al("elements",["formElements"])],P6.prototype,"readElements",null),o([ll("elements")],P6.prototype,"writeElements",null),o([Us({type:[w4],json:{write:!0}})],P6.prototype,"expressionInfos",void 0),o([Us({type:Boolean,json:{default:!1,write:!0}})],P6.prototype,"preserveFieldValuesWhenHidden",void 0),o([Us({type:String,json:{write:!0}})],P6.prototype,"title",void 0),P6=N6=o([Nr("esri.form.FormTemplate")],P6);const F6=P6;function D6(t,e,i){if(null==t.hasM||t.hasZ)for(const t of e)for(const e of t)e.length>2&&(e[2]*=i)}function $6(t,e,i){if(!t&&!e||!i)return;const n=ud(i);z6(t,i,n),z6(e,i,n)}function z6(t,e,i){if(t)for(const n of t)U6(n.geometry,e,i)}function U6(t,e,i){if(!t?.spatialReference||mh(t.spatialReference,e))return;const n=ud(t.spatialReference)/i;if(1!==n)if("x"in t)null!=t.z&&(t.z*=n);else if("rings"in t)D6(t,t.rings,n);else if("paths"in t)D6(t,t.paths,n);else if("points"in t&&(null==t.hasM||t.hasZ))for(const e of t.points)e.length>2&&(e[2]*=n)}function V6(t,e,i){if(!i?.features||!i.hasZ)return;const n=nb(i.geometryType,e,t.outSpatialReference);if(null!=n)for(const t of i.features)n(t.geometry)}var G6;const B6=new ul({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let q6=G6=class extends el{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){const i=jd.fromJSON(e.spatialReference),n=[];for(let e=0;e<t.length;e++){const s=t[e],r=NF.fromJSON(s),o=s.geometry?.spatialReference;null==r.geometry||o||(r.geometry.spatialReference=i);const a=s.aggregateGeometries,l=r.aggregateGeometries;if(a&&null!=l)for(const t in l){const e=l[t],n=a[t],s=n?.spatialReference;null==e||s||(e.spatialReference=i)}n.push(r)}return n}writeGeometryType(t,e,i,n){if(t)return void B6.write(t,e,i,n);const{features:s}=this;if(s)for(const t of s)if(null!=t?.geometry)return void B6.write(t.geometry.type,e,i,n)}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,n=Tm(t);return n&&!i&&e.spatialReference&&(n.spatialReference=jd.fromJSON(e.spatialReference)),n}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i)for(const t of i)if(t&&null!=t.geometry&&t.geometry.spatialReference)return void(e.spatialReference=t.geometry.spatialReference.toJSON())}clone(){return new G6(this.cloneProperties())}cloneProperties(){return ht({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const n=e.features[i];if(n.geometry){const e=t?.[i];n.geometry=e?.toJSON()||n.geometry}}return e}quantize(t){const{scale:[e,i],translate:[n,s]}=t,r=t=>Math.round((t-n)/e),o=t=>Math.round((s-t)/i),a=this.features,l=this._getQuantizationFunction(this.geometryType,r,o);for(let t=0,e=a.length;t<e;t++)l?.(a[t].geometry)||(a.splice(t,1),t--,e--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[n,s],scale:[r,o]}=i,a=t=>t*r+n,l=t=>s-t*o;let u=null,c=null;if(this.hasZ&&null!=i?.scale?.[2]){const{translate:[,,t],scale:[,,e]}=i;u=i=>i*e+t}if(this.hasM&&null!=i?.scale?.[3]){const{translate:[,,,t],scale:[,,,e]}=i;c=i=>null==i?i:i*e+t}const h=this._getHydrationFunction(t,a,l,u,c);for(const{geometry:t}of e)null!=t&&h&&h(t);return this.transform=null,this}_quantizePoints(t,e,i){let n,s;const r=[];for(let o=0,a=t.length;o<a;o++){const a=t[o];if(o>0){const t=e(a[0]),o=i(a[1]);t===n&&o===s||(r.push([t-n,o-s]),n=t,s=o)}else n=e(a[0]),s=i(a[1]),r.push([n,s])}return r.length>0?r:null}_getQuantizationFunction(t,e,i){return"point"===t?t=>(t.x=e(t.x),t.y=i(t.y),t):"polyline"===t||"polygon"===t?t=>{const n=km(t)?t.rings:t.paths,s=[];for(let t=0,r=n.length;t<r;t++){const r=n[t],o=this._quantizePoints(r,e,i);o&&s.push(o)}return s.length>0?(km(t)?t.rings=s:t.paths=s,t):null}:"multipoint"===t?t=>{const n=this._quantizePoints(t.points,e,i);return n&&n.length>0?(t.points=n,t):null}:"extent"===t?t=>t:null}_getHydrationFunction(t,e,i,n,s){return"point"===t?t=>{t.x=e(t.x),t.y=i(t.y),n&&(t.z=n(t.z))}:"polyline"===t||"polygon"===t?t=>{const r=km(t)?t.rings:t.paths;let o,a;for(let t=0,n=r.length;t<n;t++){const n=r[t];for(let t=0,s=n.length;t<s;t++){const s=n[t];t>0?(o+=s[0],a+=s[1]):(o=s[0],a=s[1]),s[0]=e(o),s[1]=i(a)}}if(n&&s)for(let t=0,e=r.length;t<e;t++){const e=r[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=n(i[2]),i[3]=s(i[3])}}else if(n)for(let t=0,e=r.length;t<e;t++){const e=r[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=n(i[2])}}else if(s)for(let t=0,e=r.length;t<e;t++){const e=r[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=s(i[2])}}}:"extent"===t?t=>{t.xmin=e(t.xmin),t.ymin=i(t.ymin),t.xmax=e(t.xmax),t.ymax=i(t.ymax),n&&null!=t.zmax&&null!=t.zmin&&(t.zmax=n(t.zmax),t.zmin=n(t.zmin)),s&&null!=t.mmax&&null!=t.mmin&&(t.mmax=s(t.mmax),t.mmin=s(t.mmin))}:"multipoint"===t?t=>{const r=t.points;let o,a;for(let t=0,n=r.length;t<n;t++){const n=r[t];t>0?(o+=n[0],a+=n[1]):(o=n[0],a=n[1]),n[0]=e(o),n[1]=i(a)}if(n&&s)for(let t=0,e=r.length;t<e;t++){const e=r[t];e[2]=n(e[2]),e[3]=s(e[3])}else if(n)for(let t=0,e=r.length;t<e;t++){const e=r[t];e[2]=n(e[2])}else if(s)for(let t=0,e=r.length;t<e;t++){const e=r[t];e[2]=s(e[2])}}:null}};o([Us({type:String,json:{write:!0}})],q6.prototype,"displayFieldName",void 0),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],q6.prototype,"exceededTransferLimit",void 0),o([Us({type:[NF],json:{write:!0}})],q6.prototype,"features",void 0),o([al("features")],q6.prototype,"readFeatures",null),o([Us({type:[hD],json:{write:!0}})],q6.prototype,"fields",void 0),o([Us({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:B6.read}}})],q6.prototype,"geometryType",void 0),o([ll("geometryType")],q6.prototype,"writeGeometryType",null),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],q6.prototype,"hasM",void 0),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],q6.prototype,"hasZ",void 0),o([Us({types:Cm,json:{write:!0}})],q6.prototype,"queryGeometry",void 0),o([al("queryGeometry")],q6.prototype,"readQueryGeometry",null),o([Us({type:jd,json:{write:!0}})],q6.prototype,"spatialReference",void 0),o([ll("spatialReference")],q6.prototype,"writeSpatialReference",null),o([Us({json:{write:!0}})],q6.prototype,"transform",void 0),q6=G6=o([Nr("esri.rest.support.FeatureSet")],q6),q6.prototype.toJSON.isDefaultToJSON=!0;const H6=q6;let W6=0,Z6=class extends(AM.LoadableMixin(wM(ty))){constructor(t){super(t),this._idToClientGraphic=null,this.type="memory"}load(t){const e=null!=t?t.signal:null;return this.addResolvingPromise(this._startWorker(e)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}get _workerGeometryType(){const t=this.layer?.geometryType;return t?this._geometryTypeRequiresClientGraphicMapping(t)?"polygon":t:null}applyEdits(t){return this.load().then((()=>this._applyEdits(t)))}openPorts(){return this.load().then((()=>this._connection.openPorts()))}async queryFeatures(t,e={}){await this.load(e);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,e);V6(t,this.layer.spatialReference,i);const n=H6.fromJSON(i);if(!this._requiresClientGraphicMapping())return n;const s=this.layer.objectIdField;for(const t of n.features){const e=t.attributes[s],i=this._idToClientGraphic.get(e);i&&(t.geometry=i.geometry)}return n.geometryType=this.layer.geometryType,n}async queryFeaturesJSON(t,e={}){if(this._requiresClientGraphicMapping())throw new Qe("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(e);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,e);return V6(t,this.layer.spatialReference,i),i}queryFeatureCount(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryFeatureCount",t?t.toJSON():null,e)))}queryObjectIds(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryObjectIds",t?t.toJSON():null,e)))}queryExtent(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryExtent",t?t.toJSON():null,e))).then((t=>({count:t.count,extent:Rf.fromJSON(t.extent)})))}querySnapping(t,e={}){return this.load(e).then((()=>this._connection.invoke("querySnapping",t,e)))}async _applyEdits(t){if(!this._connection)throw new Qe("feature-layer-source:edit-failure","Memory source not loaded");const e=this.layer.objectIdField;let i=null;const n=[],s=[];await Promise.all([this._prepareClientMapping(t.addFeatures,null),this._prepareClientMapping(t.updateFeatures,null)]);const r=t=>"objectId"in t&&null!=t.objectId?t.objectId:"attributes"in t&&null!=t.attributes[e]?t.attributes[e]:null;if(t.addFeatures&&(i=this._prepareAddFeatures(t.addFeatures)),t.deleteFeatures)for(const e of t.deleteFeatures){const t=r(e);null!=t&&n.push(t)}const o=t.updateFeatures&&this._idToClientGraphic?new Map:null;if(t.updateFeatures)for(const e of t.updateFeatures)if(s.push(this._serializeFeature(e)),o){const t=r(e);null!=t&&o.set(t,e)}$6(i?i.features:null,s,this.layer.spatialReference);const{fullExtent:a,featureEditResults:l}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:s,deletes:n});return this.fullExtent=a,i&&i.finish(l.uidToObjectId),this._updateClientGraphicIds(o,l),this._createEditsResult(l)}async _prepareClientMapping(t,e){if("mesh"!==this._layerOrSourceGeometryType||null==t)return;const i=[];for(const{geometry:n}of t)null==n||"mesh"!==n.type||n.hasExtent||n.loaded||i.push(n.load({signal:e}));i.length&&await Promise.all(i)}_updateClientGraphicIds(t,e){if(this._idToClientGraphic){if(t)for(const i of e.updateResults){if(!i.success)continue;const e=t.get(i.objectId);null!=e&&this._addIdToClientGraphic(e)}for(const t of e.deleteResults)t.success&&this._idToClientGraphic.delete(t.objectId)}}_createEditsResult(t){return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(t){const e=!0===t.success?null:t.error||{code:void 0,description:void 0};return{objectId:t.objectId,globalId:t.globalId,error:e?new Qe("feature-layer-source:edit-failure",e.description,{code:e.code}):null}}_prepareAddFeatures(t){const e=new Map,i=new Array(t.length);let n=null;for(let s=0;s<t.length;s++){const r=t[s],o=this._serializeFeature(r);n||null==r.geometry||(n=r.geometry.type),i[s]=o,e.set(`${o.uid}`,r)}const s=this;return{features:i,inferredGeometryType:n,finish(t){const i=s.sourceJSON.objectIdField;for(const n in t){const r=t[n],o=e.get(n);o&&(o.attributes||(o.attributes={}),-1===r?delete o.attributes[i]:o.attributes[i]=r,s._addIdToClientGraphic(o))}}}}_addIdToClientGraphic(t){if(!this._idToClientGraphic)return;const e=this.sourceJSON.objectIdField,i=t.attributes?.[e];null!=i&&this._idToClientGraphic.set(i,t)}get _layerOrSourceGeometryType(){return this.layer?.geometryType??this.sourceJSON?.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(t){return this._geometryTypeRequiresClientGraphicMapping(t.type)}_geometryTypeRequiresClientGraphicMapping(t){return"mesh"===t||"multipatch"===t||"extent"===t}_serializeFeature(t){const{attributes:e}=t,i=this._geometryForSerialization(t),n=(W6++).toString();return i?{uid:n,geometry:i.toJSON(),attributes:e}:{uid:n,attributes:e}}_geometryForSerialization(t){const{geometry:e}=t;if(null==e)return null;if(this._geometryRequiresClientGraphicMapping(e)){return e.extent?pm.fromExtent(e.extent):null}return e}async _startWorker(t){this._connection=await Qv("MemorySourceWorker",{strategy:c("feature-layers-workers")?"dedicated":"local",signal:t,registryTarget:this});const{fields:e,spatialReference:i,objectIdField:n,hasM:s,hasZ:r,timeInfo:o,dateFieldsTimeZone:a}=this.layer,l="defaults"===this.layer.originOf("spatialReference");await this._prepareClientMapping(this.items,t);const u=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",(t=>{Ft.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),t.preventDefault()})));const h={features:u.features,fields:e?.map((t=>t.toJSON())),geometryType:bm.toJSON(this._workerGeometryType),hasM:"mesh"!==this._layerOrSourceGeometryType&&s,hasZ:"mesh"===this._layerOrSourceGeometryType||r,objectIdField:n,spatialReference:l?null:i&&i.toJSON(),timeInfo:o?.toJSON()??null,dateFieldsTimeZone:a},d=await this._connection.invoke("load",h,{signal:t});for(const t of d.warnings)Ft.getLogger(this.layer).warn("#load()",`${t.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:t});d.featureErrors.length&&Ft.getLogger(this.layer).warn("#load()",`Encountered ${d.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:d.featureErrors});const f=d.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(u.inferredGeometryType)&&(f.geometryType=bm.toJSON(u.inferredGeometryType)),this.sourceJSON=f,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),u.finish(d.assignedObjectIds)}};o([Dm({Type:NF,ensureType:ks(NF)})],Z6.prototype,"itemType",void 0),o([Us()],Z6.prototype,"type",void 0),o([Us({constructOnly:!0})],Z6.prototype,"layer",void 0),o([Us({readOnly:!0})],Z6.prototype,"_workerGeometryType",null),o([Us()],Z6.prototype,"sourceJSON",void 0),Z6=o([Nr("esri.layers.graphics.sources.MemorySource")],Z6);function J6(t){return"portalItem"in t}const K6=t=>{let e=class extends t{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):J6(this)?this.portalItem?.apiKey:null}set apiKey(t){null!=t?this._override("apiKey",t):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return o([Us({type:String})],e.prototype,"apiKey",null),e=o([Nr("esri.layers.mixins.APIKeyMixin")],e),e};const Y6=t=>{let e=class extends t{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const t=G$(this.url);if(null!=t&&t.title)return t.title}return this._get("title")||""}set title(t){this._set("title",t)}set url(t){this._set("url",Z$(t,Ft.getLogger(this)))}};return o([Us()],e.prototype,"title",null),o([Us({type:String})],e.prototype,"url",null),e=o([Nr("esri.layers.mixins.ArcGISService")],e),e};var Q6,X6,t8={exports:{}};X6=function(){function t(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i}function e(t,i,n,s){var r=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(r,e.prototype),r.expected=i,r.found=n,r.location=s,r.name="SyntaxError",r}function i(t,e,i){return i=i||" ",t.length>e?t:(e-=t.length,t+(i+=i.repeat(e)).slice(0,e))}function n(t,i){var n,s={},r=(i=void 0!==i?i:{}).grammarSource,o={start:Wt},a=Wt,l="none",u=")",c=",",h="(",d="%",f="px",p="cm",m="mm",y="in",g="pt",v="pc",w="deg",b="rad",S="grad",x="turn",_="#",M=".",k="e",T=/^[ \t\n\r]/,A=/^[a-z\-]/,I=/^[0-9a-fA-F]/,j=/^[+\-]/,C=/^[0-9]/,E=Vt("none"),O=$t("none",!1),L=$t(")",!1),N=$t(",",!1),R=Vt("whitespace"),P=zt([" ","\t","\n","\r"],!1,!1),F=Vt("function"),D=$t("(",!1),$=Vt("identifier"),z=zt([["a","z"],"-"],!1,!1),U=Vt("percentage"),V=$t("%",!1),G=Vt("length"),B=$t("px",!1),q=$t("cm",!1),H=$t("mm",!1),W=$t("in",!1),Z=$t("pt",!1),J=$t("pc",!1),K=Vt("angle"),Y=$t("deg",!1),Q=$t("rad",!1),X=$t("grad",!1),tt=$t("turn",!1),et=Vt("number"),it=Vt("color"),nt=$t("#",!1),st=zt([["0","9"],["a","f"],["A","F"]],!1,!1),rt=zt(["+","-"],!1,!1),ot=zt([["0","9"]],!1,!1),at=$t(".",!1),lt=$t("e",!1),ut=function(){return[]},ct=function(t,e){return{type:"function",name:t,parameters:e||[]}},ht=function(t,e){return e.length>0?ue(t,e,3):[t]},dt=function(t){return{type:"quantity",value:t.value,unit:t.unit}},ft=function(t){return{type:"color",colorType:t.type,value:t.value}},pt=function(t){return t},mt=function(){return Dt()},yt=function(t){return{value:t,unit:"%"}},gt=function(t){return{value:t,unit:"px"}},vt=function(t){return{value:t,unit:"cm"}},wt=function(t){return{value:t,unit:"mm"}},bt=function(t){return{value:t,unit:"in"}},St=function(t){return{value:t,unit:"pt"}},xt=function(t){return{value:t,unit:"pc"}},_t=function(t){return{value:t,unit:"deg"}},Mt=function(t){return{value:t,unit:"rad"}},kt=function(t){return{value:t,unit:"grad"}},Tt=function(t){return{value:t,unit:"turn"}},At=function(t){return{value:t,unit:null}},It=function(){return{type:"hex",value:Dt()}},jt=function(t){return{type:"function",value:t}},Ct=function(){return{type:"named",value:Dt()}},Et=function(){return parseFloat(Dt())},Ot=0,Lt=0,Nt=[{line:1,column:1}],Rt=0,Pt=[],Ft=0;if("startRule"in i){if(!(i.startRule in o))throw new Error("Can't start parsing from rule \""+i.startRule+'".');a=o[i.startRule]}function Dt(){return t.substring(Lt,Ot)}function $t(t,e){return{type:"literal",text:t,ignoreCase:e}}function zt(t,e,i){return{type:"class",parts:t,inverted:e,ignoreCase:i}}function Ut(){return{type:"end"}}function Vt(t){return{type:"other",description:t}}function Gt(e){var i,n=Nt[e];if(n)return n;for(i=e-1;!Nt[i];)i--;for(n={line:(n=Nt[i]).line,column:n.column};i<e;)10===t.charCodeAt(i)?(n.line++,n.column=1):n.column++,i++;return Nt[e]=n,n}function Bt(t,e,i){var n=Gt(t),s=Gt(e),o={source:r,start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:s.line,column:s.column}};return i&&r&&"function"==typeof r.offset&&(o.start=r.offset(o.start),o.end=r.offset(o.end)),o}function qt(t){Ot<Rt||(Ot>Rt&&(Rt=Ot,Pt=[]),Pt.push(t))}function Ht(t,i,n){return new e(e.buildMessage(t,i),t,i,n)}function Wt(){var t;return(t=Zt())===s&&(t=Jt()),t}function Zt(){var e,i;return Ft++,e=Ot,Xt(),t.substr(Ot,4)===l?(i=l,Ot+=4):(i=s,0===Ft&&qt(O)),i!==s?(Xt(),Lt=e,e=ut()):(Ot=e,e=s),Ft--,e===s&&0===Ft&&qt(E),e}function Jt(){var t,e;if(t=[],(e=Kt())!==s)for(;e!==s;)t.push(e),e=Kt();else t=s;return t}function Kt(){var e,i,n,r;return e=Ot,Xt(),(i=te())!==s?(Xt(),(n=Yt())===s&&(n=null),Xt(),41===t.charCodeAt(Ot)?(r=u,Ot++):(r=s,0===Ft&&qt(L)),r!==s?(Xt(),Lt=e,e=ct(i,n)):(Ot=e,e=s)):(Ot=e,e=s),e}function Yt(){var e,i,n,r,o,a,l,u;if(e=Ot,(i=Qt())!==s){for(n=[],r=Ot,o=Xt(),44===t.charCodeAt(Ot)?(a=c,Ot++):(a=s,0===Ft&&qt(N)),a===s&&(a=null),l=Xt(),(u=Qt())!==s?r=o=[o,a,l,u]:(Ot=r,r=s);r!==s;)n.push(r),r=Ot,o=Xt(),44===t.charCodeAt(Ot)?(a=c,Ot++):(a=s,0===Ft&&qt(N)),a===s&&(a=null),l=Xt(),(u=Qt())!==s?r=o=[o,a,l,u]:(Ot=r,r=s);Lt=e,e=ht(i,n)}else Ot=e,e=s;return e}function Qt(){var t,e;return t=Ot,(e=ie())===s&&(e=ne())===s&&(e=se())===s&&(e=re()),e!==s&&(Lt=t,e=dt(e)),(t=e)===s&&(t=Ot,(e=oe())!==s&&(Lt=t,e=ft(e)),t=e),t}function Xt(){var e,i;for(Ft++,e=[],T.test(t.charAt(Ot))?(i=t.charAt(Ot),Ot++):(i=s,0===Ft&&qt(P));i!==s;)e.push(i),T.test(t.charAt(Ot))?(i=t.charAt(Ot),Ot++):(i=s,0===Ft&&qt(P));return Ft--,i=s,0===Ft&&qt(R),e}function te(){var e,i,n;return Ft++,e=Ot,(i=ee())!==s?(40===t.charCodeAt(Ot)?(n=h,Ot++):(n=s,0===Ft&&qt(D)),n!==s?(Lt=e,e=pt(i)):(Ot=e,e=s)):(Ot=e,e=s),Ft--,e===s&&(i=s,0===Ft&&qt(F)),e}function ee(){var e,i,n;if(Ft++,e=Ot,i=[],A.test(t.charAt(Ot))?(n=t.charAt(Ot),Ot++):(n=s,0===Ft&&qt(z)),n!==s)for(;n!==s;)i.push(n),A.test(t.charAt(Ot))?(n=t.charAt(Ot),Ot++):(n=s,0===Ft&&qt(z));else i=s;return i!==s&&(Lt=e,i=mt()),Ft--,(e=i)===s&&(i=s,0===Ft&&qt($)),e}function ie(){var e,i,n;return Ft++,e=Ot,Xt(),(i=ae())!==s?(37===t.charCodeAt(Ot)?(n=d,Ot++):(n=s,0===Ft&&qt(V)),n!==s?(Lt=e,e=yt(i)):(Ot=e,e=s)):(Ot=e,e=s),Ft--,e===s&&0===Ft&&qt(U),e}function ne(){var e,i,n;return Ft++,e=Ot,Xt(),(i=ae())!==s?(t.substr(Ot,2)===f?(n=f,Ot+=2):(n=s,0===Ft&&qt(B)),n!==s?(Lt=e,e=gt(i)):(Ot=e,e=s)):(Ot=e,e=s),e===s&&(e=Ot,Xt(),(i=ae())!==s?(t.substr(Ot,2)===p?(n=p,Ot+=2):(n=s,0===Ft&&qt(q)),n!==s?(Lt=e,e=vt(i)):(Ot=e,e=s)):(Ot=e,e=s),e===s&&(e=Ot,Xt(),(i=ae())!==s?(t.substr(Ot,2)===m?(n=m,Ot+=2):(n=s,0===Ft&&qt(H)),n!==s?(Lt=e,e=wt(i)):(Ot=e,e=s)):(Ot=e,e=s),e===s&&(e=Ot,Xt(),(i=ae())!==s?(t.substr(Ot,2)===y?(n=y,Ot+=2):(n=s,0===Ft&&qt(W)),n!==s?(Lt=e,e=bt(i)):(Ot=e,e=s)):(Ot=e,e=s),e===s&&(e=Ot,Xt(),(i=ae())!==s?(t.substr(Ot,2)===g?(n=g,Ot+=2):(n=s,0===Ft&&qt(Z)),n!==s?(Lt=e,e=St(i)):(Ot=e,e=s)):(Ot=e,e=s),e===s&&(e=Ot,Xt(),(i=ae())!==s?(t.substr(Ot,2)===v?(n=v,Ot+=2):(n=s,0===Ft&&qt(J)),n!==s?(Lt=e,e=xt(i)):(Ot=e,e=s)):(Ot=e,e=s)))))),Ft--,e===s&&0===Ft&&qt(G),e}function se(){var e,i,n;return Ft++,e=Ot,(i=ae())!==s?(t.substr(Ot,3)===w?(n=w,Ot+=3):(n=s,0===Ft&&qt(Y)),n!==s?(Lt=e,e=_t(i)):(Ot=e,e=s)):(Ot=e,e=s),e===s&&(e=Ot,(i=ae())!==s?(t.substr(Ot,3)===b?(n=b,Ot+=3):(n=s,0===Ft&&qt(Q)),n!==s?(Lt=e,e=Mt(i)):(Ot=e,e=s)):(Ot=e,e=s),e===s&&(e=Ot,(i=ae())!==s?(t.substr(Ot,4)===S?(n=S,Ot+=4):(n=s,0===Ft&&qt(X)),n!==s?(Lt=e,e=kt(i)):(Ot=e,e=s)):(Ot=e,e=s),e===s&&(e=Ot,(i=ae())!==s?(t.substr(Ot,4)===x?(n=x,Ot+=4):(n=s,0===Ft&&qt(tt)),n!==s?(Lt=e,e=Tt(i)):(Ot=e,e=s)):(Ot=e,e=s)))),Ft--,e===s&&(i=s,0===Ft&&qt(K)),e}function re(){var t,e;return Ft++,t=Ot,Xt(),(e=ae())!==s?(Lt=t,t=At(e)):(Ot=t,t=s),Ft--,t===s&&0===Ft&&qt(et),t}function oe(){var e,i,n,r;if(Ft++,e=Ot,35===t.charCodeAt(Ot)?(i=_,Ot++):(i=s,0===Ft&&qt(nt)),i!==s){if(n=[],I.test(t.charAt(Ot))?(r=t.charAt(Ot),Ot++):(r=s,0===Ft&&qt(st)),r!==s)for(;r!==s;)n.push(r),I.test(t.charAt(Ot))?(r=t.charAt(Ot),Ot++):(r=s,0===Ft&&qt(st));else n=s;n!==s?(Lt=e,e=It()):(Ot=e,e=s)}else Ot=e,e=s;return e===s&&(e=Ot,(i=Kt())!==s&&(Lt=e,i=jt(i)),(e=i)===s&&(e=Ot,(i=ee())!==s&&(Lt=e,i=Ct()),e=i)),Ft--,e===s&&(i=s,0===Ft&&qt(it)),e}function ae(){var e,i,n,r,o,a,l;for(e=Ot,j.test(t.charAt(Ot))?(t.charAt(Ot),Ot++):0===Ft&&qt(rt),i=Ot,n=[],C.test(t.charAt(Ot))?(r=t.charAt(Ot),Ot++):(r=s,0===Ft&&qt(ot));r!==s;)n.push(r),C.test(t.charAt(Ot))?(r=t.charAt(Ot),Ot++):(r=s,0===Ft&&qt(ot));if(46===t.charCodeAt(Ot)?(r=M,Ot++):(r=s,0===Ft&&qt(at)),r!==s){if(o=[],C.test(t.charAt(Ot))?(a=t.charAt(Ot),Ot++):(a=s,0===Ft&&qt(ot)),a!==s)for(;a!==s;)o.push(a),C.test(t.charAt(Ot))?(a=t.charAt(Ot),Ot++):(a=s,0===Ft&&qt(ot));else o=s;o!==s?i=n=[n,r,o]:(Ot=i,i=s)}else Ot=i,i=s;if(i===s)if(i=[],C.test(t.charAt(Ot))?(n=t.charAt(Ot),Ot++):(n=s,0===Ft&&qt(ot)),n!==s)for(;n!==s;)i.push(n),C.test(t.charAt(Ot))?(n=t.charAt(Ot),Ot++):(n=s,0===Ft&&qt(ot));else i=s;if(i!==s){if(n=Ot,101===t.charCodeAt(Ot)?(r=k,Ot++):(r=s,0===Ft&&qt(lt)),r!==s){if(j.test(t.charAt(Ot))?(o=t.charAt(Ot),Ot++):(o=s,0===Ft&&qt(rt)),o===s&&(o=null),a=[],C.test(t.charAt(Ot))?(l=t.charAt(Ot),Ot++):(l=s,0===Ft&&qt(ot)),l!==s)for(;l!==s;)a.push(l),C.test(t.charAt(Ot))?(l=t.charAt(Ot),Ot++):(l=s,0===Ft&&qt(ot));else a=s;a!==s?n=r=[r,o,a]:(Ot=n,n=s)}else Ot=n,n=s;n===s&&(n=null),Lt=e,e=Et()}else Ot=e,e=s;return e}function le(t,e){return t.map((function(t){return t[e]}))}function ue(t,e,i){return[t].concat(le(e,i))}if((n=a())!==s&&Ot===t.length)return n;throw n!==s&&Ot<t.length&&qt(Ut()),Ht(Pt,Rt<t.length?t.charAt(Rt):null,Rt<t.length?Bt(Rt,Rt+1):Bt(Rt,Rt))}return t(e,Error),e.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var n,s=null;for(n=0;n<t.length;n++)if(t[n].source===this.location.source){s=t[n].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,o=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(r):r,a=this.location.source+":"+o.line+":"+o.column;if(s){var l=this.location.end,u=i("",o.line.toString().length," "),c=s[r.line-1],h=(r.line===l.line?l.column:c.length+1)-r.column||1;e+="\n --\x3e "+a+"\n"+u+" |\n"+o.line+" | "+c+"\n"+u+" | "+i("",r.column-1," ")+i("",h,"^")}else e+="\n at "+a}return e},e.buildMessage=function(t,e){var i={literal:function(t){return'"'+s(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?r(t[0])+"-"+r(t[1]):r(t)}));return"["+(t.inverted?"^":"")+e.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function s(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function r(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function o(t){return i[t.type](t)}function a(t){var e,i,n=t.map(o);if(n.sort(),n.length>0){for(e=1,i=1;e<n.length;e++)n[e-1]!==n[e]&&(n[i]=n[e],i++);n.length=i}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}function l(t){return t?'"'+s(t)+'"':"end of input"}return"Expected "+a(t)+" but "+l(e)+" found."},{SyntaxError:e,parse:n}},(Q6=t8).exports&&(Q6.exports=X6());var e8=t8.exports;function i8(t){if(!t||0===t.length)return null;if("string"==typeof t){const e=n8(t);return e&&0!==e.length?e:null}const e=t.map((t=>{if(!Number.isFinite(t.scale)||t.scale<=0)throw new Qe("effect:invalid-scale","scale must be finite and greater than 0",{stop:t});return{scale:t.scale,effects:n8(t.value)}}));e.sort(((t,e)=>e.effects.length-t.effects.length));for(let t=0;t<e.length-1;t++){if(!eI(e[t].effects,e[t+1].effects))throw new Qe("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[t].effects,b:e[t+1].effects});iI(e[t].effects,e[t+1].effects)}return e.sort(((t,e)=>e.scale-t.scale)),e}function n8(t){let e;if(!t)return[];try{e=e8.parse(t)}catch(e){throw new Qe("effect:invalid-syntax","Invalid effect syntax",{value:t,error:e})}return e.map((t=>s8(t)))}function s8(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return r8(t);case"opacity":return o8(t);case"hue-rotate":return a8(t);case"blur":return l8(t);case"drop-shadow":return u8(t);case"bloom":return c8(t)}}catch(e){throw e.details.filter=t,e}throw new Qe("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function r8(t){let e=1;return h8(t.parameters,1),1===t.parameters.length&&(e=b8(t.parameters[0])),new ZA(t.name,e)}function o8(t){let e=1;return h8(t.parameters,1),1===t.parameters.length&&(e=b8(t.parameters[0])),new YA(e)}function a8(t){let e=0;return h8(t.parameters,1),1===t.parameters.length&&(e=x8(t.parameters[0])),new KA(e)}function l8(t){let e=0;return h8(t.parameters,1),1===t.parameters.length&&(e=_8(t.parameters[0]),f8(e,t.parameters[0])),new WA(e)}function u8(t){const e=[];let i=null;for(const n of t.parameters)if("color"===n.type){if(e.length&&Object.freeze(e),i)throw new Qe("effect:type-error","Accepts only one color",{});i=M8(n)}else{const t=_8(n);if(Object.isFrozen(e))throw new Qe("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(t),3===e.length&&f8(t,n)}if(e.length<2||e.length>3)throw new Qe("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new JA(e[0],e[1],e[2]||0,i||k8("black"))}function c8(t){let e=1,i=0,n=0;return h8(t.parameters,3),t.parameters[0]&&(e=b8(t.parameters[0])),t.parameters[1]&&(i=_8(t.parameters[1]),f8(i,t.parameters[1])),t.parameters[2]&&(n=b8(t.parameters[2])),new HA(e,i,n)}function h8(t,e){if(t.length>e)throw new Qe("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function d8(t){if("color"===t.type)return"<color>";if(t.unit){if(t.unit in v8)return"<length>";if(t.unit in y8)return"<angle>";if("%"===t.unit)return"<percentage>"}return"<double>"}function f8(t,e){if(t<0)throw new Qe("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function p8(t){if("quantity"!==t.type||null!==t.unit)throw new Qe("effect:type-error",`Expected <double>, Actual: ${d8(t)}`,{term:t})}function m8(t){if("quantity"!==t.type||null!==t.unit&&"%"!==t.unit)throw new Qe("effect:type-error",`Expected <double> or <percentage>, Actual: ${d8(t)}`,{term:t})}const y8={deg:1,grad:.9,rad:180/Math.PI,turn:360};function g8(t){if("quantity"!==t.type||!(0===t.value&&null===t.unit||t.unit&&null!=y8[t.unit]))throw new Qe("effect:type-error",`Expected <angle>, Actual: ${d8(t)}`,{term:t})}const v8={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function w8(t){if("quantity"!==t.type||!(0===t.value&&null===t.unit||t.unit&&null!=v8[t.unit]))throw new Qe("effect:type-error",`Expected <length>, Actual: ${d8(t)}`,{term:t})}function b8(t){m8(t);const e=t.value;return f8(e,t),"%"===t.unit?.01*e:e}function S8(t){return p8(t),f8(t.value,t),t.value}function x8(t){return g8(t),t.value*y8[t.unit]||0}function _8(t){return w8(t),t.value*v8[t.unit]||0}function M8(t){switch(t.colorType){case"hex":return pT(t.value);case"named":return k8(t.value);case"function":return I8(t.value)}}function k8(t){if(!uT(t))throw new Qe("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return hT(t)}const T8=/^rgba?/i,A8=/^hsla?/i;function I8(t){if(h8(t.parameters,4),T8.test(t.name))return[b8(t.parameters[0]),b8(t.parameters[1]),b8(t.parameters[2]),t.parameters[3]?b8(t.parameters[3]):1];if(A8.test(t.name))return fT(S8(t.parameters[0]),b8(t.parameters[1]),b8(t.parameters[2]),t.parameters[3]?b8(t.parameters[3]):1);throw new Qe("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function j8(t,e,i){try{return O8(t)}catch(t){i?.messages?.push(t)}return null}function C8(t,e,i,n){try{const n=E8(t);kt(i,n,e)}catch(t){n.messages&&n.messages.push(t)}}function E8(t){const e=i8(t);return e?nI(e)?e.map((t=>t.toJSON())):e.map((({scale:t,effects:e})=>({scale:t,value:e.map((t=>t.toJSON()))}))):null}function O8(t){if(!t||0===t.length)return null;if(L8(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:N8(i.value)});return e}return N8(t)}function L8(t){const e=t[0];return!!e&&"scale"in e}function N8(t){if(!t?.length)return"";const e=[];for(const i of t){let t=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":t=[R8(i,"amount")];break;case"blur":t=[R8(i,"radius","pt")];break;case"hue-rotate":t=[R8(i,"angle","deg")];break;case"drop-shadow":t=[R8(i,"xoffset","pt"),R8(i,"yoffset","pt"),R8(i,"blurRadius","pt"),P8(i,"color")];break;case"bloom":t=[R8(i,"strength"),R8(i,"radius","pt"),R8(i,"threshold")]}const n=`${i.type}(${t.filter(Boolean).join(" ")})`;i8(n),e.push(n)}return e.join(" ")}function R8(t,e,i){if(null==t[e])throw new Qe("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function P8(t,e){if(null==t[e])throw new Qe("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const F8={read:{reader:j8},write:{allowNull:!0,writer:C8}},D8=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return o([Us({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],e.prototype,"blendMode",void 0),o([Us({json:{read:!1,write:!1,origins:{"web-map":F8,"portal-item":F8}}})],e.prototype,"effect",void 0),e=o([Nr("esri.layers.mixins.BlendLayer")],e),e};const $8=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return o([Us({type:Object,json:{write:{overridePolicy:t=>({enabled:!!(t&&Object.keys(t).length>0)})}}})],e.prototype,"customParameters",void 0),e=o([Nr("esri.layers.mixins.CustomParametersMixin")],e),e};const z8=aZ(),U8=new Map,V8=new Map;async function G8(t,e,i){if(!t||!i)return!1;if(!e)return!0;const n=new URL(t).host;let s=U8.get(n);if(!s){const e=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");s=(await hc(e,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return s===e}async function B8(t,e,i=!1){if(!t||!e)return!0;const n=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),s=V8.get(n)?.entries();if(s)for(const[t,r]of s)if(r.name===e){const e=!r.stack?.hasForwardEdits();if(!e&&i){const[{deleteForwardEdits:e},{default:i}]=await Promise.all([import("./p-62fefdbb.js"),import("./p-168afe09.js")]);return e(n,t,new i({sessionId:z8,moment:r.moment}))}return e}return!0}function q8(t,e){if(!t)return!1;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),n=V8.get(i)?.entries();if(n)for(const[t,i]of n)if(i.name===e){return"edit"===i.lockType}return!1}const H8=new Pm.EventEmitter;function W8(t){return H8.on("apply-edits",new WeakRef(t))}function Z8(t){return H8.on("update-moment",new WeakRef(t))}function J8(t,e,i=null,n=!1){const s=Hi();return n=null==e||n,H8.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:i,mayReceiveServiceEdits:n,result:s.promise}),s}const K8="esri.layers.mixins.EditBusLayer",Y8=Symbol(K8);function Q8(t){return null!=t&&"object"==typeof t&&Y8 in t}function X8(t){return null!=t&&"object"==typeof t&&"gdbVersion"in t}function t9(t,e,i){const n=new URL(t).host,s=U8.get(n),r=t=>!t||t===s;return r(e)&&r(i)||e===i}const e9=t=>{var e;let i=class extends t{constructor(...t){super(...t),this[e]=!0,this._applyEditsHandler=t=>{const{serviceUrl:e,layerId:i,gdbVersion:n,mayReceiveServiceEdits:s,result:r}=t,o=e===this.url,a=null!=i&&null!=this.layerId&&i===this.layerId,l=X8(this),u=X8(this)&&t9(e,n,this.gdbVersion);if(!o||l&&!u||!a&&!s)return;const c=r.then((t=>{if(a&&(t.addedFeatures.length||t.updatedFeatures.length||t.deletedFeatures.length||t.addedAttachments.length||t.updatedAttachments.length||t.deletedAttachments.length))return this.emit("edits",ht(t)),t;const e=t.editedFeatures?.find((({layerId:t})=>t===this.layerId));if(e){const{adds:i,updates:n,deletes:s}=e.editedFeatures,r={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:i?i.map((({attributes:t})=>({objectId:this.objectIdField&&t[this.objectIdField],globalId:this.globalIdField&&t[this.globalIdField]}))):[],deletedFeatures:s?s.map((({attributes:t})=>({objectId:this.objectIdField&&t[this.objectIdField],globalId:this.globalIdField&&t[this.globalIdField]}))):[],updatedFeatures:n?n.map((({current:{attributes:t}})=>({objectId:this.objectIdField&&t[this.objectIdField],globalId:this.globalIdField&&t[this.globalIdField]}))):[],editedFeatures:ht(t.editedFeatures),exceededTransferLimit:!1,historicMoment:ht(t.historicMoment)};return this.emit("edits",r),r}return{edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:ht(t.editedFeatures),exceededTransferLimit:!1,historicMoment:ht(t.historicMoment)}})).then((t=>("historicMoment"in this&&this.historicMoment!==t.historicMoment&&q8(e,n)&&(this.historicMoment=t.historicMoment),t)));this.emit("apply-edits",{result:c})},this._updateMomentHandler=t=>{const{serviceUrl:e,gdbVersion:i,moment:n}=t,s=e===this.url,r=X8(this),o=X8(this)&&t9(e,i,this.gdbVersion),a=X8(this)&&!t9(e,this.gdbVersion,null);s&&r&&o&&a&&"historicMoment"in this&&this.historicMoment!==n&&(this.historicMoment=n)},this.when().then((()=>{this.addHandles(W8(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(Z8(this._updateMomentHandler))}),(()=>{}))}};return e=Y8,i=o([Nr(K8)],i),i};var i9;const n9=new ul({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),s9=new ul({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let r9=i9=class extends el{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:n,timeExtent:s,objectIds:r,units:o,distance:a}=this;return new BD({geometry:ht(i),objectIds:ht(r),spatialRelationship:n,timeExtent:ht(s),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:n,objectIds:s,units:r,distance:o}=this;return new i9({geometry:ht(e),objectIds:ht(s),spatialRelationship:i,timeExtent:ht(n),where:t,units:r,distance:o})}};o([Us({type:String,json:{write:!0}})],r9.prototype,"where",void 0),o([Us({types:Cm,json:{write:!0}})],r9.prototype,"geometry",void 0),o([Us({type:n9.apiValues,json:{name:"spatialRel",read:{reader:n9.read},write:{allowNull:!1,writer:n9.write,overridePolicy(){return{enabled:null!=this.geometry}}}}})],r9.prototype,"spatialRelationship",void 0),o([Us({type:Number,json:{write:{overridePolicy(t){return{enabled:null!=t&&null!=this.geometry}}}}})],r9.prototype,"distance",void 0),o([Us({type:[Number],json:{write:!0}})],r9.prototype,"objectIds",void 0),o([Us({type:s9.apiValues,json:{read:s9.read,write:{writer:s9.write,overridePolicy(t){return{enabled:null!=t&&null!=this.geometry}}}}})],r9.prototype,"units",void 0),o([Us({type:sj,json:{write:!0}})],r9.prototype,"timeExtent",void 0),r9=i9=o([Nr("esri.layers.support.FeatureFilter")],r9);const o9=r9;var a9;const l9={read:{reader:j8},write:{writer:C8,overridePolicy(){return{allowNull:null!=this.excludedEffect,isRequired:null==this.excludedEffect}}}},u9={read:{reader:j8},write:{writer:C8,overridePolicy(){return{allowNull:null!=this.includedEffect,isRequired:null==this.includedEffect}}}},c9={name:"showExcludedLabels",default:!0};let h9=a9=class extends el{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){const i=super.write(t,e);if(e?.origin){if(i.filter){const t=Object.keys(i.filter);if(t.length>1||"where"!==t[0])return e.messages?.push(new Qe("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in i)return e.messages?.push(new Qe("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return i}clone(){return new a9({filter:null!=this.filter?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};o([Us({type:o9,json:{write:{allowNull:!0,writer(t,e,i,n){const s=t?.write({},n);s&&0!==Object.keys(s).length?kt(i,s,e):kt(i,null,e)}}}})],h9.prototype,"filter",void 0),o([Us({json:{write:!0,origins:{"web-map":l9,"portal-item":l9}}})],h9.prototype,"includedEffect",void 0),o([Us({json:{write:!0,origins:{"web-map":u9,"portal-item":u9}}})],h9.prototype,"excludedEffect",void 0),o([Us({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":c9,"portal-item":c9}}})],h9.prototype,"excludedLabelsVisible",void 0),h9=a9=o([Nr("esri.layers.support.FeatureEffect")],h9);const d9=h9;const f9={write:{allowNull:!0}},p9=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return o([Us({type:d9,json:{origins:{"web-map":f9,"portal-item":f9}}})],e.prototype,"featureEffect",void 0),e=o([Nr("esri.layers.mixins.FeatureEffectLayer")],e),e};function m9(t){if(!t)return t;const{start:e,end:i}=t;return new sj({start:null!=e?KI(e,-e.getTimezoneOffset(),"minutes"):e,end:null!=i?KI(i,-i.getTimezoneOffset(),"minutes"):i})}function y9(t){if(!t)return t;const{start:e,end:i}=t;return new sj({start:null!=e?KI(e,e.getTimezoneOffset(),"minutes"):e,end:null!=i?KI(i,i.getTimezoneOffset(),"minutes"):i})}var g9;let v9=g9=class extends el{constructor(t){super(t)}async collectRequiredFields(t,e){return _C(t,e,this.expression)}clone(){return new g9({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};o([Us({type:String,json:{write:!0}})],v9.prototype,"expression",void 0),o([Us({type:String,json:{write:!0}})],v9.prototype,"title",void 0),v9=g9=o([Nr("esri.layers.support.FeatureExpressionInfo")],v9);const w9=v9;function b9(t){return 1/(mX[t]||1)}function S9(){const t=Object.keys(mX);return t.sort(),t}const x9=S9();var _9;const M9=cl()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),k9=new ul({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let T9=_9=class extends el{constructor(t){super(t),this.offset=null}readFeatureExpressionInfo(t,e){return null!=t?t:e.featureExpression&&0===e.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(t,e,i,n){e[i]=t.write({},n),"0"===t.expression&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):null!=t||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new _9({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&Bt(this.featureExpressionInfo,t.featureExpressionInfo)}};o([Us({type:w9,json:{write:!0}})],T9.prototype,"featureExpressionInfo",void 0),o([al("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],T9.prototype,"readFeatureExpressionInfo",null),o([ll("featureExpressionInfo",{featureExpressionInfo:{type:w9},"featureExpression.value":{type:[0]}})],T9.prototype,"writeFeatureExpressionInfo",null),o([Us({type:M9.apiValues,nonNullable:!0,json:{type:M9.jsonValues,read:M9.read,write:{writer:M9.write,isRequired:!0}}})],T9.prototype,"mode",null),o([Us({type:Number,json:{write:!0}})],T9.prototype,"offset",void 0),o([Us({type:x9,json:{type:String,read:k9.read,write:k9.write}})],T9.prototype,"unit",null),T9=_9=o([Nr("esri.layers.support.ElevationInfo")],T9);const A9=T9;const I9={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:y4}}},j9={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},C9={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:y4}}},E9={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:ak}}},O9={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:y4}}},L9={value:null,type:A9,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:y4}}};function N9(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const R9={write:{enabled:!0,layerContainerTypes:y4},read:!0},P9={type:Number,json:{origins:{"web-document":R9,"portal-item":{write:!0}}}},F9={...P9,json:{...P9.json,origins:{"web-document":{...R9,write:{enabled:!0,layerContainerTypes:y4,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>i&&"service"!==i.origin||!e.drawingInfo||void 0===e.drawingInfo.transparency?e.layerDefinition?.drawingInfo&&void 0!==e.layerDefinition.drawingInfo.transparency?kT(e.layerDefinition.drawingInfo.transparency):void 0:kT(e.drawingInfo.transparency)}}},D9={type:sj,readOnly:!0,get(){const t=null!=this.layer?.timeInfo?this.layer:null!=this.i3slayer?.timeInfo?this.i3slayer:null;if(null==t)return null;const{datesInUnknownTimezone:e,timeOffset:i,useViewTime:n}=t,s=this.view?.timeExtent;let r=t.timeExtent;e&&(r=y9(r));let o=n?s&&r?s.intersection(r):s||r:r;if(!o||o.isEmpty||o.isAllTime)return o;i&&(o=o.offset(-i.value,i.unit)),e&&(o=m9(o));const a=this._get("timeExtent");return o.equals(a)?a:o}},$9={type:Rf,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=Rf.fromJSON(t);return null!=e.spatialReference&&"object"==typeof e.spatialReference&&(i.spatialReference=jd.fromJSON(e.spatialReference)),i}}}},read:!1}},z9={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},U9={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:y4}}},name:"layerDefinition.minScale",write:!0}},V9={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:y4}}},name:"layerDefinition.maxScale",write:!0}},G9={json:{write:{ignoreOrigin:!0,layerContainerTypes:y4},origins:{"web-map":{read:!1,write:!1}}}};let B9=class extends(Gr(el)){constructor(t){super(t),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};o([Us()],B9.prototype,"creatorField",void 0),o([Us()],B9.prototype,"creationDateField",void 0),o([Us()],B9.prototype,"editorField",void 0),o([Us()],B9.prototype,"editDateField",void 0),o([Us()],B9.prototype,"realm",void 0),o([Us(Sg("dateFieldsTimeReference",!0))],B9.prototype,"timeZone",void 0),B9=o([Nr("esri.layers.support.EditFieldsInfo")],B9);const q9=B9;let H9=class extends(Gr(el)){constructor(t){super(t)}};o([Us({constructOnly:!0,json:{write:!0}})],H9.prototype,"name",void 0),o([Us({constructOnly:!0,json:{write:!0}})],H9.prototype,"fields",void 0),o([Us({constructOnly:!0,json:{write:!0}})],H9.prototype,"isAscending",void 0),o([Us({constructOnly:!0,json:{write:!0}})],H9.prototype,"indexType",void 0),o([Us({constructOnly:!0,json:{write:!0}})],H9.prototype,"isUnique",void 0),o([Us({constructOnly:!0,json:{write:!0}})],H9.prototype,"description",void 0),H9=o([Nr("esri.layers.support.FeatureIndex")],H9);async function W9(t,e,i){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=K9(t));const n=Z9(t),s=t.capabilities.query.supportsPagination;e.start=0,e.num=n;let r=null;for(;;){const o=await t.source.queryFeaturesJSON(e,i);if(null==r?r=o:r.features=r.features.concat(o.features),r.exceededTransferLimit=o.exceededTransferLimit,!s||!o.exceededTransferLimit)break;e.start+=n}return r}function Z9(t){return K9(t)*J9(t)}function J9(t){return t.capabilities.query.maxRecordCount||2e3}function K9(t){return t.capabilities.query.supportsMaxRecordCountFactor?BD.MAX_MAX_RECORD_COUNT_FACTOR:1}var Y9;let Q9=Y9=class extends el{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new Y9(ht({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};o([Us({type:[String],json:{write:!0}})],Q9.prototype,"attachmentTypes",void 0),o([Us({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],Q9.prototype,"attachmentsWhere",void 0),o([Us({type:Boolean,json:{write:!0}})],Q9.prototype,"cacheHint",void 0),o([Us({type:[String],json:{write:!0}})],Q9.prototype,"keywords",void 0),o([Us({type:[Number],json:{write:!0}})],Q9.prototype,"globalIds",void 0),o([Us({json:{write:!0}})],Q9.prototype,"name",void 0),o([Us({type:Number,json:{read:{source:"resultRecordCount"}}})],Q9.prototype,"num",void 0),o([Us({type:[Number],json:{write:!0}})],Q9.prototype,"objectIds",void 0),o([Us({type:Boolean,json:{default:!1,write:!0}})],Q9.prototype,"returnMetadata",void 0),o([Us({type:[Number],json:{write:!0}})],Q9.prototype,"size",void 0),o([Us({type:Number,json:{read:{source:"resultOffset"}}})],Q9.prototype,"start",void 0),o([ll("start"),ll("num")],Q9.prototype,"writeStart",null),o([Us({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Q9.prototype,"where",void 0),Q9=Y9=o([Nr("esri.rest.support.AttachmentQuery")],Q9),Q9.from=ks(Q9);const X9=Q9;var t7;let e7=t7=class extends el{constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(e.definitionExpression="1=1")}clone(){return new t7(ht({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};o([Us({type:Boolean,json:{write:!0}})],e7.prototype,"cacheHint",void 0),o([Us({type:jD,json:{write:!0}})],e7.prototype,"dynamicDataSource",void 0),o([Us({type:String,json:{write:!0}})],e7.prototype,"gdbVersion",void 0),o([Us({type:Number,json:{write:!0}})],e7.prototype,"geometryPrecision",void 0),o([Us({type:Date})],e7.prototype,"historicMoment",void 0),o([ll("historicMoment")],e7.prototype,"_writeHistoricMoment",null),o([Us({type:Number,json:{write:!0}})],e7.prototype,"maxAllowableOffset",void 0),o([Us({type:[Number],json:{write:!0}})],e7.prototype,"objectIds",void 0),o([Us({type:[String],json:{write:!0}})],e7.prototype,"orderByFields",void 0),o([Us({type:[String],json:{write:!0}})],e7.prototype,"outFields",void 0),o([Us({type:jd,json:{read:{source:"outSR"},write:{target:"outSR"}}})],e7.prototype,"outSpatialReference",void 0),o([Us({json:{write:!0}})],e7.prototype,"relationshipId",void 0),o([Us({type:Number,json:{read:{source:"resultOffset"}}})],e7.prototype,"start",void 0),o([ll("start"),ll("num")],e7.prototype,"writeStart",null),o([Us({type:Number,json:{read:{source:"resultRecordCount"}}})],e7.prototype,"num",void 0),o([Us({json:{write:!0}})],e7.prototype,"returnGeometry",void 0),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],e7.prototype,"returnM",void 0),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],e7.prototype,"returnZ",void 0),o([Us({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],e7.prototype,"where",void 0),e7=t7=o([Nr("esri.rest.support.RelationshipQuery")],e7),e7.from=ks(e7);const i7=e7;const n7=Object.freeze({__proto__:null,default:i7});const s7=new ul({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function r7(t,e,i,n){const s=await _7(t);if(await o7(t,e,n),!s.addAttachment)throw new Qe(n,"Layer source does not support addAttachment capability");return s.addAttachment(e,i)}function o7(t,e,i){const{attributes:n}=e,{objectIdField:s}=t;return t.capabilities?.data?.supportsAttachment?e?n?s&&n[s]?Promise.resolve():Promise.reject(new Qe(i,`feature is missing the identifying attribute ${s}`)):Promise.reject(new Qe(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new Qe(i,"A feature is required to add/delete/update attachments")):Promise.reject(new Qe(i,"this layer doesn't support attachments"))}async function a7(t,e,i,n,s){const r=await _7(t);if(await o7(t,e,s),!r.updateAttachment)throw new Qe(s,"Layer source does not support updateAttachment capability");return r.updateAttachment(e,i,n)}async function l7(t,e,i){const{applyEdits:n}=await import("./p-2a4de840.js"),s=await t.load(),{source:r,globalIdField:o}=s;let a=i;return("feature"===s.type?s.infoFor3D:null)&&null!=e.deleteFeatures&&null!=o&&(a={...a,globalIdToObjectId:await C7(t,e.deleteFeatures,o)}),n(s,r,e,i)}async function u7(t,e,i){const{uploadAssets:n}=await import("./p-2a4de840.js"),s=await t.load();return n(s,s.source,e,i)}async function c7(t,e,i,n){const s=await _7(t);if(await o7(t,e,n),!s.deleteAttachments)throw new Qe(n,"Layer source does not support deleteAttachments capability");return s.deleteAttachments(e,i)}async function h7(t,e,i){const n=(await t.load({signal:e?.signal})).source;if(!n.fetchRecomputedExtents)throw new Qe(i,"Layer source does not support fetchUpdates capability");return n.fetchRecomputedExtents(e)}async function d7(t,e,i,n){e=X9.from(e),await t.load();const s=t.source,r=t.capabilities;if(!r?.data?.supportsAttachment)throw new Qe(n,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:l,num:u,size:c,start:h,where:d}=e;if(!r?.operations?.supportsQueryAttachments){if(o?.length>0||l?.length>0||c?.length>0||u||h||d)throw new Qe(n,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e)}if(!(a?.length||l?.length||d))throw new Qe(n,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!s.queryAttachments)throw new Qe(n,"Layer source does not support queryAttachments capability",e);return s.queryAttachments(e)}async function f7(t,e,i,n){const s=await _7(t);if(!s.queryObjectIds)throw new Qe(n,"Layer source does not support queryObjectIds capability");return s.queryObjectIds(BD.from(e)??t.createQuery(),i)}async function p7(t,e,i,n){const s=await _7(t);if(!s.queryFeatureCount)throw new Qe(n,"Layer source does not support queryFeatureCount capability");return s.queryFeatureCount(BD.from(e)??t.createQuery(),i)}async function m7(t,e,i,n){const s=await _7(t);if(!s.queryExtent)throw new Qe(n,"Layer source does not support queryExtent capability");return s.queryExtent(BD.from(e)??t.createQuery(),i)}async function y7(t,e,i,n){const s=await _7(t);if(!s.queryRelatedFeatures)throw new Qe(n,"Layer source does not support queryRelatedFeatures capability");return s.queryRelatedFeatures(i7.from(e),i)}async function g7(t,e,i,n){const s=await _7(t);if(!s.queryRelatedFeaturesCount)throw new Qe(n,"Layer source does not support queryRelatedFeaturesCount capability");return s.queryRelatedFeaturesCount(i7.from(e),i)}async function v7(t){const e=t.source;if(e?.refresh)try{const{dataChanged:i,updates:n}=await e.refresh();if(null!=n&&(t.sourceJSON={...t.sourceJSON,...n},t.read(n,{origin:"service",url:t.parsedUrl})),i)return!0}catch{}if(t.definitionExpression)try{return(await yj(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function w7(t){const e=new BD,i=t.capabilities?.data,n=t.capabilities?.query;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,n&&(e.compactGeometryEnabled=n.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=n.supportsDefaultSpatialReference),i&&(i.supportsZ&&null!=t.returnZ&&(e.returnZ=t.returnZ),i.supportsM&&null!=t.returnM&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:s,timeExtent:r}=t;return e.timeExtent=null!=s&&null!=r?r.offset(-s.value,s.unit):r||null,e.multipatchOption="multipatch"===t.geometryType?"xyFootprint":null,e}function b7(t){const{globalIdField:e,fields:i}=t;if(e)return e;if(i)for(const t of i)if("esriFieldTypeGlobalID"===t.type)return t.name}function S7(t){const{objectIdField:e,fields:i}=t;if(e)return e;if(i)for(const t of i)if("esriFieldTypeOID"===t.type)return t.name}function x7(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}async function _7(t){return(await t.load()).source}async function M7(t,e){if(!Qu)return;if(Qu.findCredential(t))return;let i;try{const n=await Uk(t,e);n&&(i=await Qu.checkSignInStatus(`${n}/sharing`))}catch(t){}if(i)try{const i=null!=e?e.signal:null;await Qu.getCredential(t,{signal:i})}catch(t){}}async function k7(t,e,i){const n=t.parsedUrl?.path;n&&t.authenticationTriggerEvent===e&&await M7(n,i)}function T7(t){return!t.sourceJSON?.isMultiServicesView&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const A7=Ks({types:kF});function I7(t,e){if(t.defaultSymbol)return t.types?.length?new o4({defaultSymbol:A7(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map((t=>({id:t.id,symbol:A7(t.symbol,t,e)})))}):new d5({symbol:A7(t.defaultSymbol,t,e)})}function j7(t){let e=t.sourceJSON?.cacheMaxAge;if(!e)return!1;const i=t.editingInfo?.lastEditDate?.getTime();return null==i||(e*=1e3,Date.now()-i<e)}async function C7(t,e,i){if(null==e)return null;const n=[],{objectIdField:s}=t;if(e.forEach((t=>{let e=null;if("attributes"in t){const{attributes:n}=t;e={globalId:n[i],objectId:null!=n[s]&&-1!==n[s]?n[s]:null}}else e={globalId:t.globalId,objectId:null!=t.objectId&&-1!==t.objectId?t.objectId:null};null!=e.globalId&&(null!=e.objectId&&-1!==e.objectId||n.push(e.globalId))})),0===n.length)return null;const r=t.createQuery();r.where=n.map((t=>`${i}='${t}'`)).join(" OR "),r.returnGeometry=!1,r.outFields=[s,i],r.cacheHint=!1;const o=await ly(W9(t,r));if(!o.ok)return null;const a=new Map,l=o.value.features;for(const t of l){const e=t.attributes[i],n=t.attributes[s];null!=e&&null!=n&&-1!==n&&a.set(e,n)}return a}let E7=class extends(Gr(el)){constructor(t){super(t),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};o([Us({type:String,json:{read:{source:"shapeAreaFieldName"}}})],E7.prototype,"shapeAreaField",void 0),o([Us({type:String,json:{read:{source:"shapeLengthFieldName"}}})],E7.prototype,"shapeLengthField",void 0),o([Us({type:String,json:{read:t=>Md.read(t)||kd.read(t)}})],E7.prototype,"units",void 0),E7=o([Nr("esri.layers.support.GeometryFieldsInfo")],E7);const O7=E7;var L7;let N7=L7=class extends el{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new ty}clone(){return new L7({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};o([Us({type:String,json:{write:!0}})],N7.prototype,"floorField",void 0),o([Us({json:{read:!1,write:!1}})],N7.prototype,"viewAllMode",void 0),o([Us({json:{read:!1,write:!1}})],N7.prototype,"viewAllLevelIds",void 0),N7=L7=o([Nr("esri.layers.support.LayerFloorInfo")],N7);const R7=N7;const P7=new ul({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),F7=new ul({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let D7=class extends(Gr(el)){constructor(t){super(t),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};o([Us({json:{read:P7.read,write:P7.write}})],D7.prototype,"cardinality",void 0),o([Us({json:{read:!0,write:!0}})],D7.prototype,"composite",void 0),o([Us({json:{read:!0,write:!0}})],D7.prototype,"id",void 0),o([Us({json:{read:!0,write:!0}})],D7.prototype,"keyField",void 0),o([Us({json:{read:!0,write:!0}})],D7.prototype,"keyFieldInRelationshipTable",void 0),o([Us({json:{read:!0,write:!0}})],D7.prototype,"name",void 0),o([Us({json:{read:!0,write:!0}})],D7.prototype,"relatedTableId",void 0),o([Us({json:{read:!0,write:!0}})],D7.prototype,"relationshipTableId",void 0),o([Us({json:{read:F7.read,write:F7.write}})],D7.prototype,"role",void 0),D7=o([Nr("esri.layers.support.Relationship")],D7);const $7=D7;function z7(t,e,i){return!!V7(t,e,i)}function U7(t,e,i){return V7(t,e,i)}function V7(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}const G7={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function B7(t){const e=t?.supportedSpatialAggregationStatistics?.map((t=>t.toLowerCase()));return{envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function q7(t,e){const i=t?.supportedOperationsWithCacheHint?.map((t=>t.toLowerCase()));return!!i?.includes(e.toLowerCase())}function H7(t,e){return{analytics:W7(t),attachment:Z7(t),data:J7(t),metadata:K7(t),operations:Y7(t.capabilities,t,e),query:Q7(t,e),queryRelated:X7(t),queryTopFeatures:ttt(t),editing:ett(t)}}function W7(t){return{supportsCacheHint:q7(t.advancedQueryCapabilities,"queryAnalytics")}}function Z7(t){const e=t.attachmentProperties,i={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:q7(t.advancedQueryCapabilities,"queryAttachments"),supportsResize:z7(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach((t=>{const e=G7[t.name];e&&(i[e]=!!t.isEnabled)})),i}function J7(t){return{isVersioned:z7(t,"isDataVersioned",!1),supportsAttachment:z7(t,"hasAttachments",!1),supportsM:z7(t,"hasM",!1),supportsZ:z7(t,"hasZ",!1)}}function K7(t){return{supportsAdvancedFieldProperties:z7(t,"supportsFieldDescriptionProperty",!1)}}function Y7(t,e,i){const n=t?t.toLowerCase().split(",").map((t=>t.trim())):[],s=i?G$(i):null,r=n.includes(null!=s&&"MapServer"===s.serverType?"data":"query"),o=n.includes("editing")&&!e.datesInUnknownTimezone;let a=o&&n.includes("create"),l=o&&n.includes("delete"),u=o&&n.includes("update");const c=n.includes("changetracking"),h=e.advancedQueryCapabilities;return o&&!(a||l||u)&&(a=l=u=!0),{supportsCalculate:z7(e,"supportsCalculate",!1),supportsTruncate:z7(e,"supportsTruncate",!1),supportsValidateSql:z7(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:l,supportsEditing:o,supportsChangeTracking:c,supportsQuery:r,supportsQueryAnalytics:z7(h,"supportsQueryAnalytic",!1),supportsQueryAttachments:z7(h,"supportsQueryAttachments",!1),supportsQueryTopFeatures:z7(h,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:z7(e,"supportsAttachmentsResizing",!1),supportsSync:n.includes("sync"),supportsUpdate:u,supportsExceedsLimitStatistics:z7(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:z7(e,"supportsAsyncConvert3D",!1)}}function Q7(t,e){const i=t.advancedQueryCapabilities,n=t.ownershipBasedAccessControlForFeatures,s=t.archivingInfo,r=t.currentVersion,o=e?.includes("MapServer"),a=!o||r>=c("mapserver-pbf-version-support"),l=W$(e),u=new Set((t.supportedQueryFormats??"").split(",").map((t=>t.toLowerCase().trim())));return{supportsStatistics:z7(i,"supportsStatistics",t.supportsStatistics),supportsPercentileStatistics:z7(i,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:z7(i,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:B7(i),supportsCentroid:z7(i,"supportsReturningGeometryCentroid",!1),supportsDistance:z7(i,"supportsQueryWithDistance",!1),supportsDistinct:z7(i,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:z7(i,"supportsReturningQueryExtent",!1),supportsGeometryProperties:z7(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:z7(i,"supportsHavingClause",!1),supportsOrderBy:z7(i,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:z7(i,"supportsPagination",!1),supportsQuantization:z7(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:z7(t,"supportsQuantizationEditMode",!1),supportsQueryGeometry:z7(t,"supportsReturningQueryGeometry",!1),supportsResultType:z7(i,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:z7(i,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:z7(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:z7(t,"useStandardizedQueries",!1),supportsTopFeaturesQuery:z7(i,"supportsTopFeaturesQuery",!1),supportsQueryByAnonymous:z7(n,"allowAnonymousToQuery",!0),supportsQueryByOthers:z7(n,"allowOthersToQuery",!0),supportsHistoricMoment:z7(s,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:a&&u.has("pbf"),supportsDisjointSpatialRelationship:z7(i,"supportsDisjointSpatialRel",!1),supportsCacheHint:z7(i,"supportsQueryWithCacheHint",!1)||q7(i,"query"),supportsDefaultSpatialReference:z7(i,"supportsDefaultSR",!1),supportsCompactGeometry:l,supportsFullTextSearch:z7(i,"supportsFullTextSearch",!1),maxRecordCountFactor:U7(t,"maxRecordCountFactor",void 0),maxRecordCount:U7(t,"maxRecordCount",void 0),standardMaxRecordCount:U7(t,"standardMaxRecordCount",void 0),tileMaxRecordCount:U7(t,"tileMaxRecordCount",void 0)}}function X7(t){const e=t.advancedQueryCapabilities,i=z7(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:z7(e,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i,supportsCacheHint:q7(e,"queryRelated")}}function ttt(t){return{supportsCacheHint:q7(t.advancedQueryCapabilities,"queryTopFilter")}}function ett(t){const e=t.ownershipBasedAccessControlForFeatures,i=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:z7(t,"allowGeometryUpdates",!0),supportsGlobalId:z7(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:z7(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:z7(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:z7(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:z7(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:z7(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:z7(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:z7(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:z7(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:z7(i,"supportsAsyncApplyEdits",!1),zDefault:U7(t,"zDefault",void 0)}}let itt=class extends(Gr(el)){constructor(t){super(t),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(t){if(!t)return null;const e={};for(const i of Object.keys(t))e[i]=oD(t[i]);return e}writeDomains(t,e){if(!t)return;const i={};for(const e of Object.keys(t))t[e]&&(i[e]=t[e]?.toJSON());e.domains=i}};o([Us({type:Number,json:{write:!0}})],itt.prototype,"code",void 0),o([Us({type:Object,json:{write:!0}})],itt.prototype,"defaultValues",void 0),o([Us({json:{write:!0}})],itt.prototype,"domains",void 0),o([al("domains")],itt.prototype,"readDomains",null),o([ll("domains")],itt.prototype,"writeDomains",null),o([Us({type:String,json:{write:!0}})],itt.prototype,"name",void 0),itt=o([Nr("esri.layers.support.Subtype")],itt);const ntt=itt;const stt=t=>{let e=class extends t{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(ty.ofType(H9)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=jd.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.version=void 0}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:t}=this;if(t){const{query:e,operations:i,editing:n}=t;if(!e.supportsQueryByOthers||!e.supportsQueryByAnonymous)return"load";if(i.supportsEditing&&!(n.supportsUpdateByOthers&&n.supportsUpdateByAnonymous&&n.supportsDeleteByOthers&&n.supportsDeleteByAnonymous))return"load"}if(this.userHasUpdateItemPrivileges){if(j7(this))return"load";if(this.hasUpdateItemRestrictions)return t.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const e=this.editFieldsInfo;return(e?.creatorField||e?.editorField)&&t?.operations.supportsEditing?"editing":null}readCapabilitiesFromService(t,e){return H7(e,this.url)}readEditingInfo(t,e){const{editingInfo:i}=e;return i?{lastEditDate:null!=i.lastEditDate?new Date(i.lastEditDate):null}:null}get effectiveCapabilities(){const t=this.capabilities;if(!t)return null;const e=ht(t),{operations:i,editing:n}=e;return this.sourceJSON?.isMultiServicesView?(this.userHasUpdateItemPrivileges&&(i.supportsQuery=!0),e):this.userHasUpdateItemPrivileges?(i.supportsAdd=i.supportsDelete=i.supportsEditing=i.supportsQuery=i.supportsUpdate=n.supportsDeleteByOthers=n.supportsGeometryUpdate=n.supportsUpdateByOthers=!0,e):(this.userHasFullEditingPrivileges&&i.supportsEditing&&(i.supportsAdd=i.supportsDelete=i.supportsUpdate=n.supportsGeometryUpdate=!0),e)}readGlobalIdFieldFromService(t,e){return b7(e)}get hasFullEditingRestrictions(){const t=this.capabilities;if(!t||this.sourceJSON?.isMultiServicesView)return!1;const{operations:e,editing:i}=t;return e.supportsEditing&&!(e.supportsAdd&&e.supportsDelete&&e.supportsUpdate&&i.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const t=this.capabilities;if(!t)return!1;const{operations:e,editing:i}=t;return this.sourceJSON?.isMultiServicesView?!e.supportsQuery:!(e.supportsAdd&&e.supportsDelete&&e.supportsEditing&&e.supportsQuery&&e.supportsUpdate&&i.supportsDeleteByOthers&&i.supportsGeometryUpdate&&i.supportsUpdateByOthers)}readIsTableFromService(t,e){return"Table"===e.type}readMaxScale(t,e){return e.effectiveMaxScale||t||0}readMinScale(t,e){return e.effectiveMinScale||t||0}readObjectIdFieldFromService(t,e){return S7(e)}readServiceDefinitionExpression(t,e){return e.definitionQuery||e.definitionExpression}set url(t){const e=J$({layer:this,url:t,nonStandardUrlAllowed:!0,logger:Ft.getLogger(this)});this._set("url",e.url),null!=e.layerId&&this._set("layerId",e.layerId)}writeUrl(t,e,i,n){K$(this,t,null,e,n)}readVersion(t,e){return x7(e)}};return o([Us({readOnly:!0})],e.prototype,"authenticationTriggerEvent",null),o([Us({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),o([Us({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],e.prototype,"capabilities",void 0),o([al("service","capabilities")],e.prototype,"readCapabilitiesFromService",null),o([Us(Sg("dateFieldsTimeReference"))],e.prototype,"dateFieldsTimeZone",void 0),o([Us({type:Boolean})],e.prototype,"datesInUnknownTimezone",void 0),o([Us({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],e.prototype,"definitionExpression",void 0),o([Us({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],e.prototype,"displayField",void 0),o([Us({readOnly:!0,type:q9})],e.prototype,"editFieldsInfo",void 0),o([Us({readOnly:!0})],e.prototype,"editingInfo",void 0),o([al("editingInfo")],e.prototype,"readEditingInfo",null),o([Us({readOnly:!0})],e.prototype,"effectiveCapabilities",null),o([Us((()=>{const t=ht(L9),e=t.json.origins;return e["web-map"]={read:!1,write:!1},e["portal-item"]={read:!1,write:!1},t})())],e.prototype,"elevationInfo",void 0),o([Us({type:R7,json:{name:"layerDefinition.floorInfo",write:!0,origins:{"web-scene":{name:"layerDefinition.floorInfo",write:{enabled:!0,layerContainerTypes:y4}}}}})],e.prototype,"floorInfo",void 0),o([Us({type:Rf,json:{origins:{service:{read:{source:"extent"}}}}})],e.prototype,"fullExtent",void 0),o([Us()],e.prototype,"gdbVersion",void 0),o([Us({readOnly:!0,type:O7,json:{read:{source:"geometryProperties"}}})],e.prototype,"geometryFieldsInfo",void 0),o([Us({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:s7.read}}}})],e.prototype,"geometryType",void 0),o([Us({type:String})],e.prototype,"globalIdField",void 0),o([al("service","globalIdField",["globalIdField","fields"])],e.prototype,"readGlobalIdFieldFromService",null),o([Us({readOnly:!0})],e.prototype,"hasFullEditingRestrictions",null),o([Us({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasM",void 0),o([Us({readOnly:!0})],e.prototype,"hasUpdateItemRestrictions",null),o([Us({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasZ",void 0),o([Us({readOnly:!0,type:pj})],e.prototype,"heightModelInfo",void 0),o([Us({type:Date})],e.prototype,"historicMoment",void 0),o([Us({type:ty.ofType(H9),readOnly:!0})],e.prototype,"indexes",void 0),o([Us({readOnly:!0})],e.prototype,"isTable",void 0),o([al("service","isTable",["type"])],e.prototype,"readIsTableFromService",null),o([Us({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],e.prototype,"layerId",void 0),o([Us(V9)],e.prototype,"maxScale",void 0),o([al("service","maxScale",["maxScale","effectiveMaxScale"])],e.prototype,"readMaxScale",null),o([Us(U9)],e.prototype,"minScale",void 0),o([al("service","minScale",["minScale","effectiveMinScale"])],e.prototype,"readMinScale",null),o([Us({type:String})],e.prototype,"objectIdField",void 0),o([al("service","objectIdField",["objectIdField","fields"])],e.prototype,"readObjectIdFieldFromService",null),o([Us(Sg("preferredTimeReference"))],e.prototype,"preferredTimeZone",void 0),o([Us({type:[$7],readOnly:!0})],e.prototype,"relationships",void 0),o([Us({type:Boolean})],e.prototype,"returnM",void 0),o([Us({type:Boolean})],e.prototype,"returnZ",void 0),o([Us({readOnly:!0,json:{write:!1}})],e.prototype,"serverGens",void 0),o([Us({readOnly:!0})],e.prototype,"serviceDefinitionExpression",void 0),o([al("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],e.prototype,"readServiceDefinitionExpression",null),o([Us({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"serviceItemId",void 0),o([Us()],e.prototype,"sourceJSON",void 0),o([Us({type:jd,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],e.prototype,"spatialReference",void 0),o([Us({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],e.prototype,"subtypeField",void 0),o([Us({type:[ntt],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"subtypes",void 0),o([Us({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],e.prototype,"trackIdField",void 0),o([Us(E9)],e.prototype,"url",null),o([ll("url")],e.prototype,"writeUrl",null),o([Us({json:{origins:{service:{read:!0}},read:!1}})],e.prototype,"version",void 0),o([al("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],e.prototype,"readVersion",null),e=o([Nr("esri.layers.mixins.FeatureLayerBase")],e),e};let rtt=class extends(Gr(el)){constructor(t){super(t),this.expression=null,this.title=null,this.returnType=null}};o([Us({type:String,json:{write:!0}})],rtt.prototype,"expression",void 0),o([Us({type:String,json:{write:!0}})],rtt.prototype,"title",void 0),o([Us({type:String,json:{write:!0}})],rtt.prototype,"returnType",void 0),rtt=o([Nr("esri.layers.support.ExpressionInfo")],rtt);const ott=rtt;var att;let ltt=att=class extends el{constructor(t){super(t),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new att({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:ht(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};o([Us({type:Boolean,json:{write:!0}})],ltt.prototype,"isAutoGenerated",void 0),o([Us({type:String,json:{write:!0}})],ltt.prototype,"name",void 0),o([Us({type:String,json:{write:!0}})],ltt.prototype,"alias",void 0),o([Us({type:String,json:{write:!0}})],ltt.prototype,"onStatisticField",void 0),o([Us({type:ott,json:{write:!0}})],ltt.prototype,"onStatisticExpression",void 0),o([Us({type:String,json:{write:!0}})],ltt.prototype,"statisticType",void 0),ltt=att=o([Nr("esri.layers.support.AggregateField")],ltt);const utt=ltt;let ctt=class extends el{constructor(){super(...arguments),this.type=null}};o([Us({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],ctt.prototype,"type",void 0),ctt=o([Nr("esri.layers.support.FeatureReduction")],ctt);const htt="__begin__",dtt="__end__",ftt=new RegExp(htt,"ig"),ptt=new RegExp(dtt,"ig"),mtt=new RegExp("^"+htt,"i"),ytt=new RegExp(dtt+"$","i"),gtt='"',vtt=gtt+" + ",wtt=" + "+gtt;function btt(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function Stt(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function xtt(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):null!=t.labelExpression&&(e.expression=btt(t.labelExpression),e.type="conventional"),e}function _tt(t){const e=xtt(t);if(!e)return null;switch(e.type){case"conventional":return ktt(e.expression);case"arcade":return e.expression}return null}function Mtt(t){const e=xtt(t);if(!e)return null;switch(e.type){case"conventional":return Att(e.expression);case"arcade":return Ett(e.expression)}return null}function ktt(t){let e;return t?(e=Et(t,(t=>htt+'$feature["'+t+'"]'+dtt)),e=mtt.test(e)?e.replace(mtt,""):gtt+e,e=ytt.test(e)?e.replace(ytt,""):e+gtt,e=e.replaceAll(ftt,vtt).replaceAll(ptt,wtt)):e='""',e}const Ttt=/^\s*\{([^}]+)\}\s*$/i;function Att(t){const e=t?.match(Ttt);return e?.[1].trim()||null}const Itt=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,jtt=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,Ctt=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function Ett(t){if(!t)return null;let e=Itt.exec(t)||jtt.exec(t);return e?e[1]||e[3]:(e=Ctt.exec(t),e?e[2]:null)}var Ott;let Ltt=Ott=class extends el{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?ktt(e.value):t}writeExpression(t,e,i){null!=this.value&&(t=ktt(this.value)),null!=t&&(e[i]=t)}clone(){return new Ott({expression:this.expression,title:this.title,value:this.value})}};o([Us({type:String,json:{write:{writerEnsuresNonNull:!0}}})],Ltt.prototype,"expression",void 0),o([al("expression",["expression","value"])],Ltt.prototype,"readExpression",null),o([ll("expression")],Ltt.prototype,"writeExpression",null),o([Us({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Ltt.prototype,"title",void 0),o([Us({json:{read:!1,write:!1}})],Ltt.prototype,"value",void 0),Ltt=Ott=o([Nr("esri.layers.support.LabelExpressionInfo")],Ltt);const Ntt=Ltt;const Rtt=[252,146,31,255],Ptt={type:"esriSMS",style:"esriSMSCircle",size:6,color:Rtt,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},Ftt={type:"esriSLS",style:"esriSLSSolid",width:.75,color:Rtt},Dtt={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},$tt={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},ztt={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},Utt={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},Vtt={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};const Gtt=fF.fromJSON(Ptt),Btt=QL.fromJSON(Ftt),qtt=uF.fromJSON(Dtt),Htt=yF.fromJSON($tt);const Wtt=fF.fromJSON(ztt),Ztt=QL.fromJSON(Utt),Jtt=uF.fromJSON(Vtt);var Ktt;const Ytt=new ul({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function Qtt(t,e,i){return{enabled:!Fk(i?.layer)}}function Xtt(t){return!t||"service"!==t.origin&&!("map-image"===t.layer?.type)}function tet(t){return"map-image"===t?.type}function eet(t){return!!tet(t)&&!!t.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}function iet(t){return Xtt(t)||eet(t?.layer)}let net=Ktt=class extends el{static evaluateWhere(t,e){const i=(t,e,i)=>{switch(e){case"=":return t==i;case"<>":return t!=i;case">":return t>i;case">=":return t>=i;case"<":return t<i;case"<=":return t<=i}return!1};try{if(null==t)return!0;const n=t.split(" ");if(3===n.length)return i(e[n[0]],n[1],n[2]);if(7===n.length){const t=i(e[n[0]],n[1],n[2]),s=n[3],r=i(e[n[4]],n[5],n[6]);switch(s){case"AND":return t&&r;case"OR":return t||r}}return!1}catch(e){console.log("Error.: can't parse = "+t)}}constructor(t){super(t),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=Htt,this.useCodedValues=void 0,this.where=null}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)t=Stt(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const e=Ett(this.labelExpressionInfo.expression);e&&(t="["+e+"]")}null!=t&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,n){if(null==t&&null!=this.labelExpression&&Xtt(n))t=new Ntt({expression:this.getLabelExpressionArcade()});else if(!t)return;const s=t.toJSON(n);s.expression&&(e[i]=s)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return xtt(this)}getLabelExpressionArcade(){return _tt(this)}getLabelExpressionSingleField(){return Mtt(this)}hash(){return JSON.stringify(this)}clone(){return new Ktt({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:ht(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:ht(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};o([Us({type:String,json:{write:!0}})],net.prototype,"name",void 0),o([Us({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:Qtt}}}}})],net.prototype,"allowOverrun",void 0),o([Us({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:Qtt}}}}})],net.prototype,"deconflictionStrategy",void 0),o([Us({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&"service"===i?.origin&&eet(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],net.prototype,"labelExpression",void 0),o([al("labelExpression")],net.prototype,"readLabelExpression",null),o([ll("labelExpression")],net.prototype,"writeLabelExpression",null),o([Us({type:Ntt,json:{write:{overridePolicy:(t,e,i)=>iet(i)?{allowNull:!0}:{enabled:!1}}}})],net.prototype,"labelExpressionInfo",void 0),o([ll("labelExpressionInfo")],net.prototype,"writeLabelExpressionInfo",null),o([Us({type:Ytt.apiValues,json:{type:Ytt.jsonValues,read:Ytt.read,write:Ytt.write}})],net.prototype,"labelPlacement",void 0),o([Us({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],net.prototype,"labelPosition",void 0),o([Us({type:Number})],net.prototype,"maxScale",void 0),o([ll("maxScale")],net.prototype,"writeMaxScale",null),o([Us({type:Number})],net.prototype,"minScale",void 0),o([ll("minScale")],net.prototype,"writeMinScale",null),o([Us({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:Qtt}}}}})],net.prototype,"repeatLabel",void 0),o([Us({type:Number,cast:FT,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:Qtt}}}}})],net.prototype,"repeatLabelDistance",void 0),o([Us({types:TF,json:{origins:{"web-scene":{types:IF,write:r0,default:null}},write:r0,default:null}})],net.prototype,"symbol",void 0),o([Us({type:Boolean,json:{write:!0}})],net.prototype,"useCodedValues",void 0),o([Us({type:String,json:{write:!0}})],net.prototype,"where",void 0),net=Ktt=o([Nr("esri.layers.support.LabelClass")],net);const set=net;var ret;const oet="esri.layers.support.FeatureReductionBinning";let aet=ret=class extends ctt{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(t,e,i){const n=t.filter((t=>"avg_angle"!==t.statisticType)).map((t=>t.toJSON()));kt(i,n,e)}readRenderer(t,e,i){const n=e.drawingInfo?.renderer;return n?m4(n,e,i)??void 0:I7(e,i)}clone(){return new ret({fields:ht(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:ht(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:ht(this.popupTemplate),renderer:ht(this.renderer)})}};o([ST({binning:"binning"})],aet.prototype,"type",void 0),o([ST({geohash:"geohash"})],aet.prototype,"binType",void 0),o([Us({type:Number,range:{min:1,max:9},json:{write:!0}})],aet.prototype,"fixedBinLevel",void 0),o([Us({type:[set],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],aet.prototype,"labelingInfo",void 0),o([Us(C9)],aet.prototype,"labelsVisible",void 0),o([Us({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],aet.prototype,"maxScale",void 0),o([Us(j9)],aet.prototype,"popupEnabled",void 0),o([Us({type:pL,json:{name:"popupInfo",write:!0}})],aet.prototype,"popupTemplate",void 0),o([Us({type:[utt],json:{write:!0}})],aet.prototype,"fields",void 0),o([ll("fields")],aet.prototype,"writeFields",null),o([Us({types:a4,json:{write:{target:"drawingInfo.renderer"}}})],aet.prototype,"renderer",void 0),o([al("renderer",["drawingInfo.renderer"])],aet.prototype,"readRenderer",null),aet=ret=o([Nr(oet)],aet);const uet=aet;var cet;const het="esri.layers.support.FeatureReductionCluster";function det(t){return"simple"===t.type&&!t.visualVariables?.length}let fet=cet=class extends el{constructor(t){super(t),this.type="cluster",this.clusterRadius=FT("80px"),this.clusterMinSize=FT("12px"),this.clusterMaxSize=FT("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,i){const n=e.drawingInfo?.renderer;return n?.authoringInfo?.isAutoGenerated?null:n?det(n)?null:m4(n,e,i)??void 0:I7(e,i)}readSymbol(t,e,i){const n=e.drawingInfo?.renderer;if(n?.authoringInfo?.isAutoGenerated)return null;if(n&&det(n)){const t=m4(n,e,i);return t?.symbol}return null}writeSymbol(t,e,i,n){const s=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||s){const i=new d5({symbol:t});e.drawingInfo={renderer:i.write({},n)}}}writeFields(t,e,i){const n=t.filter((t=>"avg_angle"!==t.statisticType)).map((t=>t.toJSON()));kt(i,n,e)}readFields(t,e,i){return t.filter((t=>!t.isAutoGenerated)).map((t=>utt.fromJSON(t)))}clone(){return new cet({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:ht(this.labelingInfo),labelsVisible:this.labelsVisible,fields:ht(this.fields),maxScale:this.maxScale,renderer:ht(this.renderer),symbol:ht(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:ht(this.popupTemplate)})}};o([Us({type:["cluster"],readOnly:!0,json:{write:!0}})],fet.prototype,"type",void 0),o([Us({type:Number,cast:t=>"auto"===t?t:FT(t),json:{write:!0}})],fet.prototype,"clusterRadius",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],fet.prototype,"clusterMinSize",void 0),o([Us({type:Number,cast:FT,json:{write:!0}})],fet.prototype,"clusterMaxSize",void 0),o([Us({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],fet.prototype,"maxScale",void 0),o([Us(j9)],fet.prototype,"popupEnabled",void 0),o([Us({type:pL,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],fet.prototype,"popupTemplate",void 0),o([Us({types:a4,json:{write:{target:"drawingInfo.renderer"}}})],fet.prototype,"renderer",void 0),o([al("renderer",["drawingInfo.renderer"])],fet.prototype,"readRenderer",null),o([Us({types:_F})],fet.prototype,"symbol",void 0),o([al("symbol",["drawingInfo.renderer"])],fet.prototype,"readSymbol",null),o([ll("symbol")],fet.prototype,"writeSymbol",null),o([Us({type:[set],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],fet.prototype,"labelingInfo",void 0),o([Us(C9)],fet.prototype,"labelsVisible",void 0),o([Us({type:[utt],json:{write:!0}})],fet.prototype,"fields",void 0),o([ll("fields")],fet.prototype,"writeFields",null),o([al("fields")],fet.prototype,"readFields",null),fet=cet=o([Nr(het)],fet);const pet=fet;var met;let yet=met=class extends ctt{constructor(t){super(t),this.type="selection"}clone(){return new met}};o([Us({type:["selection"]})],yet.prototype,"type",void 0),yet=met=o([Nr("esri.layers.support.FeatureReductionSelection")],yet);const get=yet;const vet={key:"type",base:ctt,typeMap:{cluster:pet,binning:uet}},wet={types:{key:"type",base:ctt,typeMap:{selection:get,cluster:pet,binning:uet}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:vet},"portal-item":{types:vet},"web-scene":{types:{key:"type",base:ctt,typeMap:{selection:get}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:y4}}}}};const bet={Base64:0,Hex:1,String:2,Raw:3},xet=8,_et=(1<<xet)-1;function Met(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function ket(t){const e=[];for(let i=0,n=t.length*xet;i<n;i+=xet)e[i>>5]|=(t.charCodeAt(i/xet)&_et)<<i%32;return e}function Tet(t){const e=[];for(let i=0,n=32*t.length;i<n;i+=xet)e.push(String.fromCharCode(t[i>>5]>>>i%32&_et));return e.join("")}function Aet(t){const e="0123456789abcdef",i=[];for(let n=0,s=4*t.length;n<s;n++)i.push(e.charAt(t[n>>2]>>n%4*8+4&15)+e.charAt(t[n>>2]>>n%4*8&15));return i.join("")}function Iet(t){const e="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[];for(let s=0,r=4*t.length;s<r;s+=3){const r=(t[s>>2]>>s%4*8&255)<<16|(t[s+1>>2]>>(s+1)%4*8&255)<<8|t[s+2>>2]>>(s+2)%4*8&255;for(let o=0;o<4;o++)8*s+6*o>32*t.length?n.push(e):n.push(i.charAt(r>>6*(3-o)&63))}return n.join("")}function jet(t,e){return t<<e|t>>>32-e}function Cet(t,e,i,n,s,r){return Met(jet(Met(Met(e,t),Met(n,r)),s),i)}function Eet(t,e,i,n,s,r,o){return Cet(e&i|~e&n,t,e,s,r,o)}function Oet(t,e,i,n,s,r,o){return Cet(e&n|i&~n,t,e,s,r,o)}function Let(t,e,i,n,s,r,o){return Cet(e^i^n,t,e,s,r,o)}function Net(t,e,i,n,s,r,o){return Cet(i^(e|~n),t,e,s,r,o)}function Ret(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let i=1732584193,n=-271733879,s=-1732584194,r=271733878;for(let e=0;e<t.length;e+=16){const o=i,a=n,l=s,u=r;i=Eet(i,n,s,r,t[e],7,-680876936),r=Eet(r,i,n,s,t[e+1],12,-389564586),s=Eet(s,r,i,n,t[e+2],17,606105819),n=Eet(n,s,r,i,t[e+3],22,-1044525330),i=Eet(i,n,s,r,t[e+4],7,-176418897),r=Eet(r,i,n,s,t[e+5],12,1200080426),s=Eet(s,r,i,n,t[e+6],17,-1473231341),n=Eet(n,s,r,i,t[e+7],22,-45705983),i=Eet(i,n,s,r,t[e+8],7,1770035416),r=Eet(r,i,n,s,t[e+9],12,-1958414417),s=Eet(s,r,i,n,t[e+10],17,-42063),n=Eet(n,s,r,i,t[e+11],22,-1990404162),i=Eet(i,n,s,r,t[e+12],7,1804603682),r=Eet(r,i,n,s,t[e+13],12,-40341101),s=Eet(s,r,i,n,t[e+14],17,-1502002290),n=Eet(n,s,r,i,t[e+15],22,1236535329),i=Oet(i,n,s,r,t[e+1],5,-165796510),r=Oet(r,i,n,s,t[e+6],9,-1069501632),s=Oet(s,r,i,n,t[e+11],14,643717713),n=Oet(n,s,r,i,t[e],20,-373897302),i=Oet(i,n,s,r,t[e+5],5,-701558691),r=Oet(r,i,n,s,t[e+10],9,38016083),s=Oet(s,r,i,n,t[e+15],14,-660478335),n=Oet(n,s,r,i,t[e+4],20,-405537848),i=Oet(i,n,s,r,t[e+9],5,568446438),r=Oet(r,i,n,s,t[e+14],9,-1019803690),s=Oet(s,r,i,n,t[e+3],14,-187363961),n=Oet(n,s,r,i,t[e+8],20,1163531501),i=Oet(i,n,s,r,t[e+13],5,-1444681467),r=Oet(r,i,n,s,t[e+2],9,-51403784),s=Oet(s,r,i,n,t[e+7],14,1735328473),n=Oet(n,s,r,i,t[e+12],20,-1926607734),i=Let(i,n,s,r,t[e+5],4,-378558),r=Let(r,i,n,s,t[e+8],11,-2022574463),s=Let(s,r,i,n,t[e+11],16,1839030562),n=Let(n,s,r,i,t[e+14],23,-35309556),i=Let(i,n,s,r,t[e+1],4,-1530992060),r=Let(r,i,n,s,t[e+4],11,1272893353),s=Let(s,r,i,n,t[e+7],16,-155497632),n=Let(n,s,r,i,t[e+10],23,-1094730640),i=Let(i,n,s,r,t[e+13],4,681279174),r=Let(r,i,n,s,t[e],11,-358537222),s=Let(s,r,i,n,t[e+3],16,-722521979),n=Let(n,s,r,i,t[e+6],23,76029189),i=Let(i,n,s,r,t[e+9],4,-640364487),r=Let(r,i,n,s,t[e+12],11,-421815835),s=Let(s,r,i,n,t[e+15],16,530742520),n=Let(n,s,r,i,t[e+2],23,-995338651),i=Net(i,n,s,r,t[e],6,-198630844),r=Net(r,i,n,s,t[e+7],10,1126891415),s=Net(s,r,i,n,t[e+14],15,-1416354905),n=Net(n,s,r,i,t[e+5],21,-57434055),i=Net(i,n,s,r,t[e+12],6,1700485571),r=Net(r,i,n,s,t[e+3],10,-1894986606),s=Net(s,r,i,n,t[e+10],15,-1051523),n=Net(n,s,r,i,t[e+1],21,-2054922799),i=Net(i,n,s,r,t[e+8],6,1873313359),r=Net(r,i,n,s,t[e+15],10,-30611744),s=Net(s,r,i,n,t[e+6],15,-1560198380),n=Net(n,s,r,i,t[e+13],21,1309151649),i=Net(i,n,s,r,t[e+4],6,-145523070),r=Net(r,i,n,s,t[e+11],10,-1120210379),s=Net(s,r,i,n,t[e+2],15,718787259),n=Net(n,s,r,i,t[e+9],21,-343485551),i=Met(i,o),n=Met(n,a),s=Met(s,l),r=Met(r,u)}return[i,n,s,r]}function Pet(t,e=bet.Hex){const i=e||bet.Base64,n=Ret(ket(t),t.length*xet);switch(i){case bet.Raw:return n;case bet.Hex:return Aet(n);case bet.String:return Tet(n);case bet.Base64:return Iet(n)}}const Fet=()=>Ft.getLogger("esri.views.2d.layers.support.clusterUtils");c.add("esri-cluster-arcade-enabled",!0);const Det=c("esri-cluster-arcade-enabled"),$et=new Set(["simple-line","simple-fill","picture-fill"]);function zet(t,e){let i=e.clone();if(!Uet(i))return i;if(e.getSymbols().some((t=>$et.has(t.type)))&&(i=new d5({symbol:new fF})),i.authoringInfo||(i.authoringInfo=new IQ),i.authoringInfo.isAutoGenerated=!0,"visualVariables"in i){const e=(i.visualVariables||[]).filter((t=>"$view.scale"!==t.valueExpression));e.forEach((e=>{"rotation"===e.type?e.field?e.field=Bet(t,e.field,"avg_angle","number"):e.valueExpression&&(e.field=Get(t,e.valueExpression,"avg_angle","number"),e.valueExpression=null):e.normalizationField?(e.field=Bet(t,e.field,"avg_norm","number",e.normalizationField),e.normalizationField=null):e.field?e.field=Bet(t,e.field,"avg","number"):e.valueExpression&&(e.field=Get(t,e.valueExpression,"avg","number"),e.valueExpression=null)})),i.visualVariables=e}switch(i.type){case"simple":break;case"pie-chart":for(const e of i.attributes)e.field?e.field=Bet(t,e.field,"sum","number"):e.valueExpression&&(e.field=Get(t,e.valueExpression,"sum","number"),e.valueExpression=null);break;case"unique-value":i.field?i.field=Bet(t,i.field,"mode","string"):i.valueExpression&&(i.field=Get(t,i.valueExpression,"mode","string"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=Bet(t,i.field,"avg_norm","number",i.normalizationField),i.normalizationField=null):i.field?i.field=Bet(t,i.field,"avg","number"):i.valueExpression&&(i.field=Get(t,i.valueExpression,"avg","number"),i.valueExpression=null)}return i}const Uet=t=>{const e=e=>Fet().error(new Qe("Unsupported-renderer",e,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const i=t.normalizationType;if("field"!==i)return e(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!Det){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some((t=>!(!("valueExpression"in t)||!t.valueExpression))))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function Vet(t,e,i){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const t=i,n="field",s=e.toLowerCase()+",norm:"+n+","+t.toLowerCase();return"cluster_avg_"+Pet(s)}}}function Get(t,e,i,n){const s=Pet(e),r="mode"===i?`cluster_type_${s}`:"sum"===i?`cluster_sum_${s}`:`cluster_avg_${s}`;return t.some((t=>t.name===r))||t.push(new utt({name:r,isAutoGenerated:!0,onStatisticExpression:new ott({expression:e,returnType:n}),statisticType:i})),r}function Bet(t,e,i,n,s){if("cluster_count"===e||t.some((t=>t.name===e)))return e;const r=Vet(i,e,s);return t.some((t=>t.name===r))||("avg_norm"===i?t.push(new utt({name:r,isAutoGenerated:!0,onStatisticExpression:new ott({expression:`$feature.${e} / $feature.${s}`,returnType:n}),statisticType:"avg"})):t.push(new utt({name:r,isAutoGenerated:!0,onStatisticField:e,statisticType:i}))),r}const qet=t=>{let e=class extends t{constructor(...t){super(...t),this.addHandles(fy((()=>this.renderer),(()=>{if(this.featureReduction){const t=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",t)}}),xy))}set featureReduction(t){const e=this._normalizeFeatureReduction(t);this._set("featureReduction",e)}set renderer(t){}_withClusterVariable(t,e,i){const n=t.clone();if("visualVariables"in n){n.visualVariables||(n.visualVariables=[]);n.visualVariables.some((t=>"size"===t.type))||n.visualVariables.push(new WX({field:"cluster_count",stops:[new rX({value:1}),new rX({useMinValue:!0,size:e}),new rX({useMaxValue:!0,size:i})]}))}return n}_normalizeFeatureReduction(t){if("cluster"!==t?.type)return t;const e=t.clone(),i=[new utt({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],n=(e.fields??[]).filter((t=>!t.isAutoGenerated)),s=t.renderer&&!t.renderer.authoringInfo?.isAutoGenerated,{clusterMinSize:r,clusterMaxSize:o}=e;if(s){e.fields=[...i,...n];const t=this._withClusterVariable(e.renderer,r,o);return e.effectiveFeatureRenderer=t,e.effectiveClusterRenderer=t,e}if(t.symbol){if(e.fields=[...i,...n],e.renderer=null,!this.renderer)return e.effectiveFeatureRenderer=null,e.effectiveClusterRenderer=null,e;const s=zet(i,this.renderer),a=this._withClusterVariable(s,r,o),l="visualVariables"in a&&a.visualVariables?a.visualVariables:[],u=new d5({symbol:t.symbol,visualVariables:l});return e.fields=[...i,...n],e.effectiveFeatureRenderer=a,e.effectiveClusterRenderer=u,e}if(!this.renderer)return t;const a=zet(i,this.renderer);e.fields=[...i,...n],e.renderer=a;const l=this._withClusterVariable(a,r,o);return e.effectiveFeatureRenderer=l,e.effectiveClusterRenderer=l,e}};return o([Us(wet)],e.prototype,"featureReduction",null),e=o([Nr("esri.layers.mixins.FeatureReductionLayer")],e),e};const Het={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},Wet={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},Zet={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},Jet={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0,IntegratedMesh3DTilesLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":Het,"web-map/basemap":Wet,"web-map/tables":Zet,"link-chart/operational-layers":{...Het,LinkChartLayer:!0},"link-chart/basemap":Wet,"link-chart/tables":Zet,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISImageServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,IntegratedMesh3DTilesLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0}};const Ket=t=>{let e=class extends t{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(t,e,i){return"Group Layer"===i?.portalItem?.type?void 0:t}writeListMode(t,e,i,n){(n&&"ground"===n.layerContainerType||t&&Ka(this,i,{},n))&&(e[i]=t)}writeOperationalLayerType(t,e,i,n){t&&"tables"!==n?.layerContainerType&&(e.layerType=t)}writeTitle(t,e){e.title=t??"Layer"}read(t,e){e&&(e.layer=this),Ha(this,t,(e=>super.read(t,e)),e)}write(t,e){if(!this.persistenceEnabled)return null;if(e?.origin){const t=`${e.origin}/${e.layerContainerType||"operational-layers"}`,i=Jet[t];let n=!!i?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===t&&(n=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===t&&(n=!1),!n)return e.messages?.push(new Qe("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${t}'`,{layer:this})),null}const i=super.write(t,{...e,layer:this}),n=!!e&&!!e.messages&&!!e.messages.filter((t=>t instanceof Qe&&"web-document-write:property-required"===t.name)).length;return cu(i?.url)?(e?.messages?.push(new Qe("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:i}beforeSave(){}};return o([Us({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),o([al("id",["id"])],e.prototype,"readId",null),o([Us(G9)],e.prototype,"listMode",void 0),o([ll("listMode")],e.prototype,"writeListMode",null),o([Us({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:y4}}}}})],e.prototype,"operationalLayerType",void 0),o([ll("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),o([Us(P9)],e.prototype,"opacity",void 0),o([Us({type:Boolean,readOnly:!1})],e.prototype,"persistenceEnabled",void 0),o([Us({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),o([ll("title"),ll(["web-scene"],"title")],e.prototype,"writeTitle",null),o([Us({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:y4}}},name:"visibility",write:!0}})],e.prototype,"visible",void 0),e=o([Nr("esri.layers.mixins.OperationalLayer")],e),e};var Yet;const Qet=new ul({asc:"ascending",desc:"descending"});let Xet=Yet=class extends el{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new Yet({field:this.field,valueExpression:this.valueExpression,order:this.order})}};o([Us({type:String,json:{write:!0}})],Xet.prototype,"field",void 0),o([Us({type:String,json:{write:!0}})],Xet.prototype,"valueExpression",void 0),o([Us({type:Qet.apiValues,json:{read:Qet.read,write:Qet.write}})],Xet.prototype,"order",void 0),Xet=Yet=o([Nr("esri.layers.support.OrderByInfo")],Xet);const tit=Xet;function eit(t,e,i){if(!t)return null;const n=t.find((t=>!!t.field));if(!n)return null;const s=new tit;return s.read(n,i),[s]}function iit(t,e,i,n){const s=t.find((t=>!!t.field));s&&kt(i,[s.toJSON()],e)}const nit=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return o([Us({type:[tit],json:{origins:{"web-scene":{write:!1,read:!1}},read:{source:"layerDefinition.orderBy",reader:eit},write:{target:"layerDefinition.orderBy",writer:iit}}})],e.prototype,"orderBy",void 0),e=o([Nr("esri.layers.mixins.OrderedLayer")],e),e};async function sit(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return Wd(t);const i=jd.WGS84;return await Eb(e,i),wb(t,i)}function rit(t,e){if(!oit(t,e)){const i=t.typeKeywords;i?i.push(e):t.typeKeywords=[e]}}function oit(t,e){return!!t.typeKeywords?.includes(e)}function ait(t){return oit(t,hit.HOSTED_SERVICE)}function lit(t,e){const i=t.typeKeywords;if(i){const t=i.indexOf(e);t>-1&&i.splice(t,1)}}function uit(t,e,i){i?rit(t,e):lit(t,e)}async function cit(t){const e=t.clone().normalize();let i;if(e.length>1)for(const t of e)i?t.width>i.width&&(i=t):i=t;else i=e[0];return sit(i)}const hit={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function dit(t){const{portal:e,isOrgItem:i,itemControl:n}=t,s=e.user?.privileges;let r=!s||s.includes("features:user:edit"),o=!!i&&!!s?.includes("features:user:fullEdit");const a="update"===n||"admin"===n;return a?o=r=!0:o&&(r=!0),{features:{edit:r,fullEdit:o},content:{updateItem:a}}}const fit=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=$t(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t))}readPortalItem(t,e,i){if(e.itemId)return new xk({id:e.itemId,portal:i?.portal})}writePortalItem(t,e){t?.id&&(e.itemId=t.id)}async loadFromPortal(t,e){if(this.portalItem?.id)try{const{load:i}=await import("./p-5fcbe838.js");return Ii(e),await i({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData,layerModuleTypeMap:t.layerModuleTypeMap},e)}catch(t){throw Pi(t)||Ft.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${t}`),t}}async finishLoadEditablePortalLayer(t){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(t).catch((t=>(Ei(t),!0))))}async setUserPrivileges(t,e){if(!It.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(e);if(this.url)try{const{features:{edit:i,fullEdit:n},content:{updateItem:s}}=await this._fetchUserPrivileges(t,e);this._set("userHasEditingPrivileges",i),this._set("userHasFullEditingPrivileges",n),this._set("userHasUpdateItemPrivileges",s)}catch(t){Ei(t)}}async _fetchUserPrivileges(t,e){let i=this.portalItem;if(!t||!i||!i.loaded||i.sourceUrl)return this._fetchFallbackUserPrivileges(e);const n=t===i.id;if(n&&i.portal.user)return dit(i);let s,r;if(n)s=i.portal.url;else try{s=await Uk(this.url,e)}catch(t){Ei(t)}if(!s||!Yl(s,i.portal.url))return this._fetchFallbackUserPrivileges(e);try{const t=null!=e?e.signal:null;r=await(Qu?.getCredential(`${s}/sharing`,{prompt:!1,signal:t}))}catch(t){Ei(t)}const o=!0,a=!1,l=!1;if(!r)return{features:{edit:o,fullEdit:a},content:{updateItem:l}};try{if(n?await i.reload():(i=new xk({id:t,portal:{url:s}}),await i.load(e)),i.portal.user)return dit(i)}catch(t){Ei(t)}return{features:{edit:o,fullEdit:a},content:{updateItem:l}}}async _fetchFallbackUserPrivileges(t){let e=!0;try{e=await this._fetchUserHasEditingPrivileges(t)}catch(t){Ei(t)}return{features:{edit:e,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(t){const e=this.url?Qu?.findCredential(this.url):null;if(!e)return!0;const i=pit.credential===e?pit.user:await this._fetchEditingUser(t);return pit.credential=e,pit.user=i,null==i?.privileges||i.privileges.includes("features:user:edit")}async _fetchEditingUser(t){const e=this.portalItem?.portal?.user;if(e)return e;const i=Qu.findServerInfo(this.url??"");if(!i?.owningSystemUrl)return null;const n=`${i.owningSystemUrl}/sharing/rest`,s=YM.getDefault();if(s&&s.loaded&&ou(s.restUrl)===ou(n))return s.user;const r=`${n}/community/self`,o=null!=t?t.signal:null,a=await ay(hc(r,{authMode:"no-prompt",query:{f:"json"},signal:o}));return a.ok?HM.fromJSON(a.value.data):null}read(t,e){e&&(e.layer=this),super.read(t,e)}write(t,e){const i=e?.portal,n=this.portalItem?.id&&(this.portalItem.portal||YM.getDefault());return i&&n&&!Ql(n.restUrl,i.restUrl)?(e.messages&&e.messages.push(new Qe("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(t,{...e,layer:this})}};return o([Us({type:xk})],e.prototype,"portalItem",null),o([al("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),o([ll("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),o([Us({clonable:!1})],e.prototype,"resourceReferences",void 0),o([Us({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),o([Us({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),o([Us({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=o([Nr("esri.layers.mixins.PortalLayer")],e),e},pit={credential:null,user:null};let mit=class extends Vr{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};o([Us()],mit.prototype,"updating",void 0),o([Us()],mit.prototype,"status",void 0),mit=o([Nr("esri.layers.support.PublishingInfo")],mit);const yit=mit;const git="esri.layers.mixins.PublishableLayer",vit=Symbol(git);const wit=t=>{var e;let i=class extends t{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const t=this._get("publishingInfo");if(t)return t;const e=new yit;return this._checkPublishingStatus(e),e}_checkPublishingStatus(t){const e=250,i=125;let n=0;const s=async e=>{let o;t.updating=!0;try{o=await this.fetchPublishingStatus()}catch(t){o="unavailable"}"published"!==o&&"unavailable"!==o||("publishing"===t.status&&this.refresh(),r.remove()),t.status=o,t.updating=!1,r.removed||(n=setTimeout(s,e,e+i))},r={removed:!1,remove(){this.removed=!0,clearTimeout(n)}};this.when().catch((()=>r.remove())),s(e),this.addHandles(r)}};return e=vit,o([Us({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=o([Nr(git)],i),i};const bit=new ty,Sit=new WeakMap;function xit(t){Mit(t)&&bit.push(new WeakRef(t))}function _it(t){const e=bit.find((e=>e.deref()===t));e&&bit.remove(e)}function Mit(t){return null!=t&&"object"==typeof t&&"refreshInterval"in t&&"refresh"in t}function kit(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:kit(e,t%e):0}let Tit=0,Ait=0;function Iit(){const t=Date.now();let e=!1;for(const i of bit){const n=i.deref();if(n){if(n.refreshInterval){t-(Sit.get(n)??0)+5>=6e4*n.refreshInterval&&(Sit.set(n,t),n.refresh(t))}}else e=!0}if(e)for(let t=bit.length-1;t>=0;t--){bit.at(t).deref()||bit.removeAt(t)}}Dn((()=>{const t=Date.now();let e=0;for(const i of bit){const n=i.deref();n&&(e=kit(Math.round(6e4*n.refreshInterval),e),n.refreshInterval?Sit.get(n)||Sit.set(n,t):Sit.delete(n))}if(e!==Ait){if(Ait=e,clearInterval(Tit),0===Ait)return void(Tit=0);Tit=setInterval(Iit,Ait)}}));const jit=.1,Cit=t=>{let e=class extends t{constructor(...t){super(...t),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=qi((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||xit(this)}),(()=>{}))}destroy(){_it(this)}castRefreshInterval(t){return t>=jit?t:t<=0?0:jit}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(t=Date.now()){Fi(this._debounceHasDataChanged()).then((e=>{e&&this._set("refreshTimestamp",t),this.emit("refresh",{dataChanged:e})}),(t=>{Ft.getLogger(this).error(t),this.emit("refresh",{dataChanged:!1,error:t})}))}async hasDataChanged(){return!0}get test(){const t=this;return{set refreshInterval(e){t._set("refreshInterval",e)}}}};return o([Us({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:y4}}}}})],e.prototype,"refreshInterval",void 0),o([ol("refreshInterval")],e.prototype,"castRefreshInterval",null),o([Us({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),o([Us({readOnly:!0})],e.prototype,"refreshParameters",null),e=o([Nr("esri.layers.mixins.RefreshableLayer")],e),e};const Eit=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const t={minScale:this.minScale,maxScale:this.maxScale},e=this.parent;e&&"effectiveScaleRange"in e&&Oit(t,e.effectiveScaleRange);const i=this._get("effectiveScaleRange");return i&&i.minScale===t.minScale&&i.maxScale===t.maxScale?i:t}};return o([Us({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),o([Us({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),o([Us({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=o([Nr("esri.layers.mixins.ScaleRangeLayer")],e),e};function Oit(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const Lit=cl()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let Nit=class extends(Gr(el)){constructor(t){super(t),this.unit="milliseconds",this.value=0}toMilliseconds(){return QI(this.value,this.unit,"milliseconds")}};o([ST(Lit,{nonNullable:!0})],Nit.prototype,"unit",void 0),o([Us({type:Number,json:{write:!0},nonNullable:!0})],Nit.prototype,"value",void 0),Nit=o([Nr("esri.TimeInterval")],Nit);const Rit=Nit;function Pit(t,e){return Rit.fromJSON({value:t,unit:e})}let Fit=class extends(Gr(el)){constructor(t){super(t),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(t,e){if(!e.timeExtent||!Array.isArray(e.timeExtent)||2!==e.timeExtent.length)return null;const i=new Date(e.timeExtent[0]),n=new Date(e.timeExtent[1]);return new sj({start:i,end:n})}writeFullTimeExtent(t,e){null!=t?.start&&null!=t.end?e.timeExtent=[t.start.getTime(),t.end.getTime()]:e.timeExtent=null}readInterval(t,e){return e.timeInterval&&e.timeIntervalUnits?Pit(e.timeInterval,e.timeIntervalUnits):e.defaultTimeInterval&&e.defaultTimeIntervalUnits?Pit(e.defaultTimeInterval,e.defaultTimeIntervalUnits):null}writeInterval(t,e){e.timeInterval=t?.toJSON().value??null,e.timeIntervalUnits=t?.toJSON().unit??null}};o([Us({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],Fit.prototype,"cumulative",void 0),o([Us({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],Fit.prototype,"endField",void 0),o([Us({type:sj,json:{write:{enabled:!0,allowNull:!0}}})],Fit.prototype,"fullTimeExtent",void 0),o([al("fullTimeExtent",["timeExtent"])],Fit.prototype,"readFullTimeExtent",null),o([ll("fullTimeExtent")],Fit.prototype,"writeFullTimeExtent",null),o([Us({type:Boolean,json:{write:!0}})],Fit.prototype,"hasLiveData",void 0),o([Us({type:Rit,json:{write:{enabled:!0,allowNull:!0}}})],Fit.prototype,"interval",void 0),o([al("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],Fit.prototype,"readInterval",null),o([ll("interval")],Fit.prototype,"writeInterval",null),o([Us({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],Fit.prototype,"startField",void 0),o([Us(Sg("timeReference",!0))],Fit.prototype,"timeZone",void 0),o([Us({type:String,json:{write:{enabled:!0,allowNull:!0}}})],Fit.prototype,"trackIdField",void 0),o([Us({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],Fit.prototype,"useTime",void 0),Fit=o([Nr("esri.layers.support.TimeInfo")],Fit);const Dit=Fit;const $it=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(t,e){const i=e.timeInfo.exportOptions;if(!i)return null;const n=i.timeOffset,s=Lit.fromJSON(i.timeOffsetUnits);return n&&s?new Rit({value:n,unit:s}):null}set timeInfo(t){yC(t,this.fieldsIndex),this._set("timeInfo",t)}};return o([Us({type:sj,json:{write:!1}})],e.prototype,"timeExtent",void 0),o([Us({type:Rit})],e.prototype,"timeOffset",void 0),o([al("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),o([Us({value:null,type:Dit,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),o([Us({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],e.prototype,"useViewTime",void 0),e=o([Nr("esri.layers.mixins.TemporalLayer")],e),e};const zit=new ul({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let Uit=class extends(Gr(el)){constructor(t){super(t),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};o([Us({json:{write:!0}})],Uit.prototype,"name",void 0),o([Us({json:{write:!0}})],Uit.prototype,"description",void 0),o([Us({json:{read:zit.read,write:zit.write}})],Uit.prototype,"drawingTool",void 0),o([Us({json:{write:!0}})],Uit.prototype,"prototype",void 0),o([Us({json:{write:!0}})],Uit.prototype,"thumbnail",void 0),Uit=o([Nr("esri.layers.support.FeatureTemplate")],Uit);const Vit=Uit;let Git=class extends(Gr(el)){constructor(t){super(t),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(t){const e={};for(const i of Object.keys(t))e[i]=oD(t[i]);return e}writeDomains(t,e){const i={};for(const e of Object.keys(t))t[e]&&(i[e]=t[e]?.toJSON());e.domains=i}};o([Us({json:{write:!0}})],Git.prototype,"id",void 0),o([Us({json:{write:!0}})],Git.prototype,"name",void 0),o([Us({json:{write:!0}})],Git.prototype,"domains",void 0),o([al("domains")],Git.prototype,"readDomains",null),o([ll("domains")],Git.prototype,"writeDomains",null),o([Us({type:[Vit],json:{write:!0}})],Git.prototype,"templates",void 0),Git=o([Nr("esri.layers.support.FeatureType")],Git);const Bit=Git;function qit(){return{fields:{type:[hD],value:null,set:function(t){if(t&&c("big-integer-warning-enabled")){const e=t.filter((t=>"big-integer"===t.type||"oid"===t.type&&(t.length||0)>=8));if(e.length){const t=e.map((t=>`'${t.name}'`)).join(", ");Ft.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${t}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return z0.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){const t=this._userOutFields;if(!t?.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const e of t){const i=this.fieldsIndex?.has(e);i||Ft.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${e} found in outFields`,{layer:this,outFields:t})}return vC(this.fieldsIndex,t)}}}}const Hit=()=>Ft.getLogger("esri.layers.support.labelingInfo"),Wit=/\[([^\[\]]+)\]/gi;function Zit(t,e,i){return t?t.map((t=>{const n=new set;if(n.read(t,i),n.labelExpression){const t=e.fields||e.layerDefinition?.fields||this.fields;n.labelExpression=n.labelExpression.replaceAll(Wit,((e,i)=>`[${Jit(i,t)}]`))}return n})):null}function Jit(t,e){if(!e)return t;const i=t.toLowerCase();for(let t=0;t<e.length;t++){const n=e[t].name;if(n.toLowerCase()===i)return n}return t}const Kit={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function Yit(t,e){const i=ht(t);return i.some((t=>Qit(t,e)))?[]:i}function Qit(t,e){const i=t.labelPlacement,n=Kit[e];if(!t.symbol)return Hit().warn("No ILabelClass symbol specified."),!0;if(!n)return Hit().error(new Qe("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),!0;if(!n.includes(i)){const s=n[0];i&&Hit().warn(`Found invalid label placement type ${i} for ${e}. Defaulting to ${s}`),t.labelPlacement=s}return!1}const Xit=[];function tnt(t,e){if(W$(t.url??""))return!0;const{wkid:i}=e;for(const e of Xit){if((t.version??0)>=e[0])return!0;if("function"==typeof e[1]&&(e[1]=e[1]()),e[1].has(i))return!1}return!0}Xit.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),Xit.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),Xit.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),Xit.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),Xit.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]),Xit.push([10.7,()=>{const t=new Set([8387,8391,8427,8545,8682,8685,8818,31370,104022,104024,104975]);for(let e=8065;e<=8068;e++)t.add(e);for(let e=8082;e<=8083;e++)t.add(e);for(let e=8379;e<=8385;e++)t.add(e);for(let e=8836;e<=8840;e++)t.add(e);for(let e=8857;e<=8860;e++)t.add(e);for(let e=53035;e<=53037;e++)t.add(e);for(let e=54090;e<=54091;e++)t.add(e);for(let e=102498;e<=102499;e++)t.add(e);return t}]),Xit.push([10.61,()=>new Set([102497])]),Xit.push([10.6,()=>{const t=new Set([7803,7805,7887,8086,8232,8237,8240,8246,8249,8252,8255,9019,9391]);for(let e=7755;e<=7787;e++)t.add(e);for(let e=7791;e<=7795;e++)t.add(e);for(let e=7799;e<=7801;e++)t.add(e);for(let e=7825;e<=7831;e++)t.add(e);for(let e=7877;e<=7878;e++)t.add(e);for(let e=7882;e<=7883;e++)t.add(e);for(let e=7991;e<=7992;e++)t.add(e);for(let e=8042;e<=8043;e++)t.add(e);for(let e=8058;e<=8059;e++)t.add(e);for(let e=8311;e<=8348;e++)t.add(e);for(let e=9060;e<=9067;e++)t.add(e);for(let e=102562;e<=102568;e++)t.add(e);for(let e=102799;e<=102900;e++)t.add(e);return t}]);async function ent(t,e,i){const n=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(n&&"unique-value"===n.type&&n.styleOrigin){const s=await ay(n.populateFromStyle());if(Ii(i),!1===s.ok){const i=s.error;e?.messages&&e.messages.push(new Hs("renderer:style-reference",`Failed to create unique value renderer from style reference: ${i.message}`,{error:i,context:e})),t.clear("renderer",e?.origin)}}}var int;let nnt=int=class extends el{constructor(t){super(t),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new int({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};o([Us({type:[String],json:{write:!0}})],nnt.prototype,"groupByFields",void 0),o([Us({type:Number,json:{write:!0}})],nnt.prototype,"topCount",void 0),o([Us({type:[String],json:{write:!0}})],nnt.prototype,"orderByFields",void 0),nnt=int=o([Nr("esri.rest.support.TopFilter")],nnt);const snt=nnt;var rnt;const ont=new ul({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),ant=new ul({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let lnt=rnt=class extends el{constructor(t){super(t),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new rnt(ht({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};o([Us({type:Boolean,json:{write:!0}})],lnt.prototype,"cacheHint",void 0),o([Us({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],lnt.prototype,"distance",void 0),o([Us({types:Cm,json:{read:Tm,write:!0}})],lnt.prototype,"geometry",void 0),o([Us({type:Number,json:{write:!0}})],lnt.prototype,"geometryPrecision",void 0),o([Us({type:Number,json:{write:!0}})],lnt.prototype,"maxAllowableOffset",void 0),o([Us({type:Number,json:{read:{source:"resultRecordCount"}}})],lnt.prototype,"num",void 0),o([Us({json:{write:!0}})],lnt.prototype,"objectIds",void 0),o([Us({type:[String],json:{write:!0}})],lnt.prototype,"orderByFields",void 0),o([Us({type:[String],json:{write:!0}})],lnt.prototype,"outFields",void 0),o([Us({type:jd,json:{read:{source:"outSR"},write:{target:"outSR"}}})],lnt.prototype,"outSpatialReference",void 0),o([Us({type:String,json:{write:!0}})],lnt.prototype,"resultType",void 0),o([Us({json:{write:!0}})],lnt.prototype,"returnGeometry",void 0),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],lnt.prototype,"returnM",void 0),o([Us({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],lnt.prototype,"returnZ",void 0),o([Us({type:Number,json:{read:{source:"resultOffset"}}})],lnt.prototype,"start",void 0),o([ll("start"),ll("num")],lnt.prototype,"writeStart",null),o([Us({type:String,json:{read:{source:"spatialRel",reader:ont.read},write:{target:"spatialRel",writer:ont.write}}})],lnt.prototype,"spatialRelationship",void 0),o([Us({type:sj,json:{write:!0}})],lnt.prototype,"timeExtent",void 0),o([Us({type:snt,json:{write:!0}})],lnt.prototype,"topFilter",void 0),o([Us({type:String,json:{read:ant.read,write:{writer:ant.write,overridePolicy(t){return{enabled:null!=t&&null!=this.distance&&this.distance>0}}}}})],lnt.prototype,"units",void 0),o([Us({type:String,json:{write:!0}})],lnt.prototype,"where",void 0),lnt=rnt=o([Nr("esri.rest.support.TopFeaturesQuery")],lnt),lnt.from=ks(lnt);const unt=lnt;function cnt({displayField:t,editFieldsInfo:e,fields:i,objectIdField:n,title:s},r){if(!i)return null;const o=pnt({editFieldsInfo:e,fields:i,objectIdField:n},r);if(!o.length)return null;const a=gnt({titleBase:s,fields:i,displayField:t}),l=ynt();return new pL({title:a,content:l,fieldInfos:o})}const hnt=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):BC(t,e);function dnt(t,e){const i=t;return e&&(t=t.filter((t=>!e.includes(t.type)))),t===i&&(t=t.slice()),t.sort(fnt),t}function fnt(t,e){return"oid"===t.type?-1:"oid"===e.type?1:vnt(t)?-1:vnt(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function pnt(t,e){const i=e?.visibleFieldNames;return dnt(t.fields??[],e?.ignoreFieldTypes||wnt).map((e=>new QE({fieldName:e.name,isEditable:GC(e,t),label:e.alias,format:mnt(e),visible:hnt(e,{...t,visibleFieldNames:i})})))}function mnt(t){switch(t.type){case"small-integer":case"integer":case"single":return new JE({digitSeparator:!0,places:0});case"double":return new JE({digitSeparator:!0,places:2});case"string":return LE(t.name)?new JE({digitSeparator:!0,places:0}):null;default:return null}}function ynt(){return[new eO,new DE]}function gnt(t){const e=kC(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i??""}function vnt(t){if("name"===(t.name&&t.name.toLowerCase()))return!0;return"name"===(t.alias&&t.alias.toLowerCase())}const wnt=["geometry","blob","raster","guid","xml"];var bnt;!function(t){t[t.SAVE=0]="SAVE",t[t.SAVE_AS=1]="SAVE_AS"}(bnt||(bnt={}));const Snt="FeatureLayer";function xnt(t,e){return new Qe("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function _nt(t){return t&&t instanceof ty}const Mnt=qit();function knt(t,e,i){const n=!!i?.writeLayerSchema;return{enabled:n,ignoreOrigin:n}}let Tnt=class extends(stt(qet(p9(wit(e9(D8(nit($it(Eit(Cit(Y6(Ket(fit(ZY($8(K6(Gr(VI)))))))))))))))))){constructor(...t){super(...t),this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=jd.WGS84,this.subtypeCode=null,this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=qi((async(t,e,i)=>{const{save:n,saveAs:s}=await import("./p-5083152f.js");switch(t){case bnt.SAVE:return n(this,e);case bnt.SAVE_AS:return s(this,i,e)}}))}destroy(){this.source?.destroy()}normalizeCtorArgs(t,e){return"string"==typeof t?{url:t,...e}:t}load(t){const e=null!=t?t.signal:null;if(this.portalItem?.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(e).then((t=>this.initLayerProperties(t)))),Promise.resolve(this);const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},t).catch(Ei).then((async()=>{if(this.url&&null==this.layerId&&/FeatureServer|MapServer\/*$/i.test(this.url)){const t=await this._fetchFirstValidLayerId(e);null!=t&&(this.layerId=t)}if(!this.url&&!this._hasMemorySource())throw new Qe("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(e))})).then((()=>k7(this,"load",t)));return this.addResolvingPromise(i),Promise.resolve(this)}readCapabilities(t,e){return e=e.layerDefinition||e,H7(e,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return!(this.loaded&&!this.capabilities?.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){this._overrideIfSome("editingEnabled",t)}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,i){return this._readEditingEnabled(e,!0,i)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,i,n){this._writeEditingEnabled(t,e,!0,n)}get effectiveEditingEnabled(){return T7(this)}readIsTable(t,e){return"Table"===(e=e?.layerDefinition??e).type||!e.geometryType}writeIsTable(t,e,i,n){n?.writeLayerSchema&&kt(i,t?"Table":"Feature Layer",e)}readGlobalIdField(t,e){return b7(e.layerDefinition||e)}readObjectIdField(t,e){return S7(e.layerDefinition||e)}get parsedUrl(){const t=Ul(this.url);return null!=t&&(null!=this.dynamicDataSource?t.path=au(t.path,"dynamicLayer"):null!=this.layerId&&(t.path=au(t.path,this.layerId.toString()))),t}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){pC(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,i){e=e.layerDefinition||e;const n=e.drawingInfo?.renderer;if(n){const t=m4(n,e,i)??void 0;return t||Ft.getLogger(this).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:i}),t}return I7(e,i)}set source(t){const e=this._get("source");e!==t&&(_nt(e)&&this._resetMemorySource(e),_nt(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof ty?new Z6({layer:this,items:t}):t:null}readSource(t,e){const i=H6.fromJSON(e.featureSet);return new Z6({layer:this,items:i?.features??[]})}readTemplates(t,e){const i=e.editFieldsInfo,n=i?.creatorField,s=i?.editorField;return t=t?.map((t=>Vit.fromJSON(t))),this._fixTemplates(t,n),this._fixTemplates(t,s),t}readTitle(t,e){const i=e.layerDefinition?.name??e.name,n=e.title||e.layerDefinition?.title;if(i){const t=this.portalItem?.title;if("item-title"===this.sublayerTitleMode)return this.url?H$(this.url,i):i;let e=i;if(!e&&this.url){const t=G$(this.url);null!=t&&(e=t.title)}if(!e)return;return"item-title-and-service-name"===this.sublayerTitleMode&&t&&t!==e&&(e=t+" - "+e),q$(e)}if("item-title"===this.sublayerTitleMode&&n)return n}readTitleFromWebMap(t,e){return e.title||e.layerDefinition?.name}readTypeIdField(t,e){let i=(e=e.layerDefinition||e).typeIdField;if(i&&e.fields){i=i.toLowerCase();const t=e.fields.find((t=>t.name.toLowerCase()===i));t&&(i=t.name)}return i}readTypes(t,e){t=(e=e.layerDefinition||e).types;const i=e.editFieldsInfo,n=i?.creatorField,s=i?.editorField;return t?.map((t=>(t=Bit.fromJSON(t),this._fixTemplates(t.templates,n),this._fixTemplates(t.templates,s),t)))}readVisible(t,e){return null!=e.layerDefinition?.defaultVisibility?!!e.layerDefinition.defaultVisibility:null!=e.visibility?!!e.visibility:void 0}async addAttachment(t,e){return r7(this,t,e,Snt)}async updateAttachment(t,e,i){return a7(this,t,e,i,Snt)}async applyEdits(t,e){return l7(this,t,e)}async uploadAssets(t,e){return u7(this,t,e)}on(t,e){return super.on(t,e)}createPopupTemplate(t){return cnt(this,t)}async createGraphicsSource(t){if(this._hasMemorySource()&&this.source)return this.source.load({signal:t});const{default:e}=await Ri(import("./p-11282fe7.js"),t);return new e({layer:this}).load({signal:t})}createQuery(){const t=w7(this);t.dynamicDataSource=this.dynamicDataSource;const e=null!=this.subtypeCode?`${this.subtypeField} = ${this.subtypeCode}`:null,i=gj(this.definitionExpression,e);return t.where=i||"1=1",t}async deleteAttachments(t,e){return c7(this,t,e,Snt)}async fetchRecomputedExtents(t){return h7(this,t,Snt)}getFeatureType(t){const{typeIdField:e,types:i}=this;if(!e||!t)return null;const n=t.attributes?t.attributes[e]:void 0;if(null==n)return null;let s=null;return i?.some((t=>{const{id:e}=t;return null!=e&&(e.toString()===n.toString()&&(s=t),!!s)})),s}getFieldDomain(t,e){const i=e?.feature,n=this.getFeatureType(i);if(n){const e=n.domains&&n.domains[t];if(e&&"inherited"!==e.type)return e}return this._getLayerDomain(t)}getField(t){return this.fieldsIndex.get(t)}async queryAttachments(t,e){return d7(this,t,e,Snt)}async queryFeatures(t,e){const i=await this.load(),n=await i.source.queryFeatures(BD.from(t)??i.createQuery(),e);if(n?.features)for(const t of n.features)t.layer=t.sourceLayer=i;return n}async queryObjectIds(t,e){return f7(this,t,e,Snt)}async queryFeatureCount(t,e){return p7(this,t,e,Snt)}async queryExtent(t,e){return m7(this,t,e,Snt)}async queryRelatedFeatures(t,e){return y7(this,t,e,Snt)}async queryRelatedFeaturesCount(t,e){return g7(this,t,e,Snt)}async queryTopFeatures(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryTopFeatures||!n?.query?.supportsTopFeaturesQuery)throw new Qe(Snt,"Layer source does not support queryTopFeatures capability");const s=await i.queryTopFeatures(unt.from(t),e);if(s?.features)for(const t of s.features)t.layer=t.sourceLayer=this;return s}async queryTopObjectIds(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryTopObjectIds||!n?.query.supportsTopFeaturesQuery)throw new Qe(Snt,"Layer source does not support queryTopObjectIds capability");return i.queryTopObjectIds(unt.from(t),e)}async queryTopFeaturesExtent(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryTopExtents||!n?.query?.supportsTopFeaturesQuery)throw new Qe(Snt,"Layer source does not support queryTopExtents capability");return i.queryTopExtents(unt.from(t),e)}async queryTopFeatureCount(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryTopCount||!n?.query?.supportsTopFeaturesQuery)throw new Qe(Snt,"Layer source does not support queryFeatureCount capability");return i.queryTopCount(unt.from(t),e)}read(t,e){const i=t.featureCollection;if((i||"Feature Collection"===t.type)&&(this.resourceInfo=t),i){const t=i.layers;t&&1===t.length&&(super.read(t[0],e),null!=i.showLegend&&super.read({showLegend:i.showLegend},e))}super.read(t,e),e&&"service"===e.origin&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(t,e){e={...e,origin:e?.origin??void 0,writeLayerSchema:e?.writeLayerSchema??this._hasMemorySource()};const{origin:i,layerContainerType:n,messages:s}=e;if(this.dynamicDataSource)return s?.push(xnt(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if(("web-map"===i||"web-scene"===i)&&"tables"!==n)return s?.push(xnt(this,`a table source can only be written to tables, not ${n}`)),null;if(this._hasMemorySource())return s?.push(xnt(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&("web-map"===i||"web-scene"===i)&&"tables"===n)return s?.push(xnt(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(t,e)}clone(){if(this._hasMemorySource())throw new Qe(Snt,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(t){return!!this.loaded&&("memory"===this.source?.type||tnt(this,t))}async save(t){return this._debouncedSaveOperations(bnt.SAVE,t)}async saveAs(t,e){return this._debouncedSaveOperations(bnt.SAVE_AS,e,t)}_readEditingEnabled(t,e,i){let n=t.layerDefinition?.capabilities;return n?this._hasEditingCapability(n):(n=t.capabilities,e&&"web-map"===i?.origin&&!this._hasMemorySource()&&n?this._hasEditingCapability(n):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map((t=>t.trim())).includes("editing")}_writeEditingEnabled(t,e,i,n){if(!t){const t=this.capabilities?.operations?.supportsSync?"Query,Sync":"Query";kt("layerDefinition.capabilities",t,e),i&&!n?.writeLayerSchema&&(e.capabilities=t)}}_getLayerDomain(t){const e=this.fieldsIndex.get(t);return e?e.domain:null}_fetchFirstValidLayerId(t){return hc(this.url,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then((t=>{const e=t.data;if(e)return this.findFirstValidLayerId(e)}))}async initLayerProperties(t){return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:this.portalItem?.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),pC(this.renderer,this.fieldsIndex),yC(this.timeInfo,this.fieldsIndex),ent(this,{origin:"service"})}async hasDataChanged(){return v7(this)}async fetchPublishingStatus(){const t=this.source;return t?.fetchPublishingStatus?t.fetchPublishingStatus():"unavailable"}_verifyFields(){const t=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||-1!==t.search(/\/FeatureServer\//i)||this.fields?.some((t=>"geometry"===t.type))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach((t=>{const i=t.prototype?.attributes;i&&e&&delete i[e]}))}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new Qe("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new Qe("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach((t=>{t.layer=this,t.sourceLayer=this})),this.addHandles([t.on("after-add",(t=>{t.item.layer=this,t.item.sourceLayer=this})),t.on("after-remove",(t=>{t.item.layer=null,t.item.sourceLayer=null}))],"fl-source")}_resetMemorySource(t){t.forEach((t=>{t.layer=null,t.sourceLayer=null})),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(t){return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}};o([al("service","capabilities")],Tnt.prototype,"readCapabilities",null),o([Us({json:{origins:{"web-scene":{write:!1}},write:!0}})],Tnt.prototype,"charts",void 0),o([Us({readOnly:!0})],Tnt.prototype,"createQueryVersion",null),o([Us({json:{read:{source:"layerDefinition.copyrightText"}}})],Tnt.prototype,"copyright",void 0),o([Us({json:{read:{source:"layerDefinition.displayField"}}})],Tnt.prototype,"displayField",void 0),o([Us({types:xF,readOnly:!0})],Tnt.prototype,"defaultSymbol",void 0),o([Us({type:jD})],Tnt.prototype,"dynamicDataSource",void 0),o([Us({type:Boolean})],Tnt.prototype,"editingEnabled",null),o([al(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Tnt.prototype,"readEditingEnabled",null),o([al("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Tnt.prototype,"readEditingEnabledFromWebMap",null),o([ll(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Tnt.prototype,"writeEditingEnabled",null),o([ll("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Tnt.prototype,"writeEditingEnabledToWebMap",null),o([Us({readOnly:!0})],Tnt.prototype,"effectiveEditingEnabled",null),o([Us({...Mnt.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:knt}}}}})],Tnt.prototype,"fields",void 0),o([Us(Mnt.fieldsIndex)],Tnt.prototype,"fieldsIndex",void 0),o([Us({type:F6,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Tnt.prototype,"formTemplate",void 0),o([Us({json:{read:{source:"layerDefinition.extent"}}})],Tnt.prototype,"fullExtent",void 0),o([Us({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:knt,writer(t,e,i){const n=t?s7.toJSON(t):null;n&&kt(i,n,e)}}}},read:{source:"layerDefinition.geometryType",reader:s7.read}}})],Tnt.prototype,"geometryType",void 0),o([Us({json:{read:{source:"layerDefinition.hasM"}}})],Tnt.prototype,"hasM",void 0),o([Us({json:{read:{source:"layerDefinition.hasZ"}}})],Tnt.prototype,"hasZ",void 0),o([Us(z9)],Tnt.prototype,"id",void 0),o([Us({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],Tnt.prototype,"infoFor3D",void 0),o([Us({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Tnt.prototype,"isTable",void 0),o([al("service","isTable",["type","geometryType"]),al("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Tnt.prototype,"readIsTable",null),o([ll("web-map","isTable")],Tnt.prototype,"writeIsTable",null),o([Us(C9)],Tnt.prototype,"labelsVisible",void 0),o([Us({type:[set],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:Zit,write:!1},"web-scene":{name:"layerDefinition.drawingInfo.labelingInfo",read:Zit,write:{enabled:!0,layerContainerTypes:y4}}},name:"layerDefinition.drawingInfo.labelingInfo",read:Zit,write:!0}})],Tnt.prototype,"labelingInfo",void 0),o([Us((()=>{const t=ht(F9);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(t,e,i){kt(i,MT(t),e)}}},t})())],Tnt.prototype,"opacity",void 0),o([Us(O9)],Tnt.prototype,"legendEnabled",void 0),o([Us({type:["show","hide"],json:(()=>{const t=ht(G9.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],Tnt.prototype,"listMode",void 0),o([al("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],Tnt.prototype,"readGlobalIdField",null),o([Us({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:knt}}}}})],Tnt.prototype,"objectIdField",void 0),o([al("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],Tnt.prototype,"readObjectIdField",null),o([Us({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],Tnt.prototype,"operationalLayerType",void 0),o([Us(Mnt.outFields)],Tnt.prototype,"outFields",void 0),o([Us({readOnly:!0})],Tnt.prototype,"parsedUrl",null),o([Us({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Tnt.prototype,"path",void 0),o([Us(j9)],Tnt.prototype,"popupEnabled",void 0),o([Us({type:pL,json:{name:"popupInfo",write:!0}})],Tnt.prototype,"popupTemplate",void 0),o([Us({readOnly:!0})],Tnt.prototype,"defaultPopupTemplate",null),o([Us({types:a4,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:l4,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:y4,overridePolicy:(t,e,i)=>({ignoreOrigin:i?.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,i)=>({ignoreOrigin:i?.writeLayerSchema})}}})],Tnt.prototype,"renderer",null),o([al("service","renderer",["drawingInfo.renderer","defaultSymbol"]),al("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Tnt.prototype,"readRenderer",null),o([Us()],Tnt.prototype,"resourceInfo",void 0),o([Us((()=>{const t=ht(I9);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],Tnt.prototype,"screenSizePerspectiveEnabled",void 0),o([Us({clonable:!1})],Tnt.prototype,"source",null),o([ol("source")],Tnt.prototype,"castSource",null),o([al("portal-item","source",["featureSet"]),al("web-map","source",["featureSet"])],Tnt.prototype,"readSource",null),o([Us({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],Tnt.prototype,"spatialReference",void 0),o([Us({type:Number})],Tnt.prototype,"subtypeCode",void 0),o([Us({type:[Vit]})],Tnt.prototype,"templates",void 0),o([al("templates",["editFieldsInfo","creatorField","editorField","templates"])],Tnt.prototype,"readTemplates",null),o([Us({type:Dit})],Tnt.prototype,"timeInfo",void 0),o([Us()],Tnt.prototype,"title",void 0),o([al("service","title",["name"]),al("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Tnt.prototype,"readTitle",null),o([al("web-map","title",["layerDefinition.name","title"])],Tnt.prototype,"readTitleFromWebMap",null),o([Us({type:String})],Tnt.prototype,"sublayerTitleMode",void 0),o([Us({json:{read:!1}})],Tnt.prototype,"type",void 0),o([Us({type:String})],Tnt.prototype,"typeIdField",void 0),o([al("service","typeIdField"),al("typeIdField",["layerDefinition.typeIdField"])],Tnt.prototype,"readTypeIdField",null),o([Us({type:[Bit]})],Tnt.prototype,"types",void 0),o([al("service","types",["types"]),al("types",["layerDefinition.types"])],Tnt.prototype,"readTypes",null),o([Us({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Tnt.prototype,"visible",void 0),o([al("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Tnt.prototype,"readVisible",null),Tnt=o([Nr("esri.layers.FeatureLayer")],Tnt);const Ant=Tnt;const Int=Object.freeze({__proto__:null,default:Ant});let jnt=class extends el{constructor(t){super(t),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.dirtyAreaCount=null,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};o([Us({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.moment=t?t.getTime():null}}}})],jnt.prototype,"moment",void 0),o([Us({type:Boolean,json:{write:!0}})],jnt.prototype,"fullUpdate",void 0),o([Us({type:Boolean,json:{write:!0}})],jnt.prototype,"validateErrorsCreated",void 0),o([Us({type:Number,json:{write:!0}})],jnt.prototype,"dirtyAreaCount",void 0),o([Us({type:Boolean,json:{write:!0}})],jnt.prototype,"exceededTransferLimit",void 0),o([Us({type:[Object],json:{write:!0}})],jnt.prototype,"serviceEdits",void 0),o([Us({type:[Object],json:{write:!0}})],jnt.prototype,"discoveredSubnetworks",void 0),jnt=o([Nr("esri.rest.networks.support.ValidateNetworkTopologyResult")],jnt);const Cnt=jnt;const Ent=cl()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let Ont=class extends Cnt{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const e={...t,query:{f:"json"}},{data:i}=await hc(this.statusUrl,e);return this.read(i),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(t={}){const{interval:e=1e3,statusCallback:i}=t;return new Promise(((t,n)=>{this._clearTimer();const s=setInterval((()=>{this._timer||n(Ai()),this.checkJobStatus().then((e=>{const{status:n}=e;switch(this.status=n,n){case"job-succeeded":this._clearTimer(),t(this);break;case"job-waiting":case"job-executing":i&&i(this)}}),(t=>{this._clearTimer(),n(t)}))}),e);this._timer=s}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};o([Us()],Ont.prototype,"editsResolver",void 0),o([Us({type:String,json:{write:!0}})],Ont.prototype,"statusUrl",void 0),o([ST(Ent)],Ont.prototype,"status",void 0),o([Us({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],Ont.prototype,"submissionTime",void 0),o([Us({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],Ont.prototype,"lastUpdatedTime",void 0),Ont=o([Nr("esri.networks.support.TopologyValidationJobInfo")],Ont);const Lnt=Ont;async function Nnt(t,e){if("Utility Network Layer"===t){const{default:t}=await Promise.resolve().then((function(){return gst}));return new t({layerUrl:e})}return null}async function Rnt(t){let e="portalItem"in t?t:{portalItem:t};!e.portalItem||e.portalItem instanceof xk||(e={...e,portalItem:new xk(e.portalItem)});const i=e.portalItem;if(await i.load(),"Feature Service"!==i.type)throw new Qe("portal:unknown-item-type","Unknown item type '${type}'",{type:i.type});const n=i.url,s=await hc(n,{responseType:"json",query:{f:"json"}}),r="Network Layer";if(s.data.type?.includes(r))return Nnt(s.data.type,n);if(s.data.layers){const t=s.data.layers.find((t=>t.type.includes(r)));if(t){const e=`${n}/${t.id}`;return Nnt(t.type,e)}}return null}let Pnt=class extends(ZY(AM)){static fromPortalItem(t){return Rnt(t)}constructor(t){super(t),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._applyEditsHandler=t=>{const{serviceUrl:e,gdbVersion:i,result:n}=t,s=e===this.featureServiceUrl,r=t9(e,i,this.gdbVersion);s&&r&&n.then((t=>{q8(e,i)&&(this.historicMoment=t.historicMoment)}))},this._updateMomentHandler=t=>{const{serviceUrl:e,gdbVersion:i,moment:n}=t,s=e===this.featureServiceUrl,r=t9(e,i,this.gdbVersion);s&&r&&(this.historicMoment=n)},this.when().then((()=>{this.addHandles([W8(this._applyEditsHandler),Z8(this._updateMomentHandler)])}),(()=>{}))}initialize(){this.when().catch((t=>{Pi(t)||Ft.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})}))}get datasetName(){return this.dataElement?.name??null}get owner(){return this.dataElement?.userIdentity??null}get schemaGeneration(){return this.dataElement?.schemaGeneration??null}get parsedUrl(){return Ul(this.layerUrl)}get featureServiceUrl(){return G$(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return G$(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(t){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),t)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,t)),this}getLayerIdBySourceId(t){if(this.dataElement){const e=this.dataElement.domainNetworks;for(const i of e){for(const e of i.edgeSources??[])if(e.sourceId===t)return e.layerId;for(const e of i.junctionSources??[])if(e.sourceId===t)return e.layerId}return null}return null}async queryNamedTraceConfigurations(t,e){const[{queryNamedTraceConfigurations:i},{default:n}]=await Promise.all([import("./p-3c3a5c4e.js"),import("./p-ea93319e.js")]),s=this.networkServiceUrl,r=n.from(t);return(await i(s,r,{...e}))?.namedTraceConfigurations}async validateTopology(t,e){if(!t.validateArea)throw new Qe("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:i},{default:n}]=await Promise.all([import("./p-255e6705.js"),import("./p-b02600c7.js")]),s=n.from(t);q8(this.featureServiceUrl,this.gdbVersion||null)?s.sessionID=z8:s.sessionID=null,s.gdbVersion=this.gdbVersion;const r=this.networkServiceUrl,o=this.featureServiceUrl,a=J8(o,null,this.gdbVersion,!0),l=await i(r,s,{...e});if(l?.serviceEdits){const t=[];for(const e of l.serviceEdits){const{editedFeatures:i}=e,n=i?.spatialReference?new jd(i.spatialReference):null;t.push({layerId:e.layerId,editedFeatures:{adds:i?.adds?.map((t=>this._createEditedFeature(t,n)))||[],updates:i?.updates?.map((t=>({original:this._createEditedFeature(t[0],n),current:this._createEditedFeature(t[1],n)})))||[],deletes:i?.deletes?.map((t=>this._createEditedFeature(t,n)))||[],spatialReference:n}})}a.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:t,exceededTransferLimit:!1,historicMoment:l.moment})}return l}async submitTopologyValidationJob(t,e){let i=null;if(!t.validateArea)throw new Qe("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const t=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");i=(await hc(t,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:n},{default:s}]=await Promise.all([import("./p-255e6705.js"),import("./p-b02600c7.js")]),r=s.from(t);q8(this.featureServiceUrl,this.gdbVersion||null)?r.sessionID=z8:r.sessionID=null,r.gdbVersion=this.gdbVersion||i;const o=this.networkServiceUrl,a=this.featureServiceUrl?J8(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,l=await n(o,r,{...e});return new Lnt({statusUrl:l,editsResolver:a})}_createEditedFeature(t,e){return new NF({attributes:t.attributes,geometry:Tm({...t.geometry,spatialReference:e})})}async _fetchLayerMetaData(t,e){const i=await hc(t,{responseType:"json",query:{f:"json"},...e});this.sourceJSON=i.data,this.read(i.data,{origin:"service"})}async _fetchDataElement(t,e,i){if(this.dataElement)return;const n=await hc(`${t}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then((t=>t.data.layerDataElements?.[0]));n&&this.read(n,{origin:"service"})}};o([Us({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],Pnt.prototype,"id",void 0),o([Us({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],Pnt.prototype,"title",void 0),o([Us({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],Pnt.prototype,"layerUrl",void 0),o([Us({type:Object,json:{origins:{service:{read:!0}},read:!1}})],Pnt.prototype,"dataElement",void 0),o([Us({type:Rf,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],Pnt.prototype,"fullExtent",void 0),o([Us({type:jd,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],Pnt.prototype,"spatialReference",void 0),o([Us({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],Pnt.prototype,"type",void 0),o([Us({readOnly:!0})],Pnt.prototype,"datasetName",null),o([Us({readOnly:!0})],Pnt.prototype,"owner",null),o([Us({readOnly:!0})],Pnt.prototype,"schemaGeneration",null),o([Us({readOnly:!0})],Pnt.prototype,"parsedUrl",null),o([Us({readOnly:!0})],Pnt.prototype,"featureServiceUrl",null),o([Us({readOnly:!0})],Pnt.prototype,"networkServiceUrl",null),o([Us({readOnly:!0})],Pnt.prototype,"layerId",null),o([Us()],Pnt.prototype,"sourceJSON",void 0),o([Us({readOnly:!0})],Pnt.prototype,"networkSystemLayers",null),o([Us()],Pnt.prototype,"gdbVersion",void 0),o([Us({type:Date})],Pnt.prototype,"historicMoment",void 0),Pnt=o([Nr("esri.networks.Network")],Pnt);const Fnt=Pnt;var Dnt;!function(t){t[t.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",t[t.RTAttachment=2]="RTAttachment",t[t.RTContainment=3]="RTContainment",t[t.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",t[t.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"}(Dnt||(Dnt={}));const $nt=new ul({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"}),znt=new ul({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),Unt={connectivity:1,"junction-junction-connectivity":1,attachment:2,containment:3,"junction-edge-from-connectivity":4,"junction-midspan-connectivity":5,"junction-edge-to-connectivity":6},Vnt=new ul({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});let Gnt=class extends(Qa(AM)){constructor(t){super(t),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=hc}initialize(){}async load(t){const e=this.layer.load(t).then((()=>this._initializeRulesTable()));return this.addResolvingPromise(e),this}getFeatureSQL(t,e){const i=t.layerId.toString(),n=t.fieldsIndex?.normalizeFieldName("assetGroup"),s=t.fieldsIndex?.normalizeFieldName("assetType"),r=n?e.attributes[n]:null,o=s?e.attributes[s]:null,a=this.rulesHash[i];if(a){const t=a.assetGroupHash[r];if(t){return t.assetTypeHash[o]||null}}return null}async _initializeRulesTable(){const t={};let e;!function(t){t[t.from=0]="from",t[t.to=1]="to",t[t.via=2]="via"}(e||(e={}));const i=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const n of this.rules){if(n.ruleType===Dnt.RTAttachment){this.rulesCategorized.attachment.push(n);continue}if(n.ruleType===Dnt.RTContainment){this.rulesCategorized.containment.push(n);continue}if(n.ruleType===Dnt.RTJunctionJunctionConnectivity){this.rulesCategorized.connectivity.push(n);continue}this.rulesCategorized.connectivity.push(n);let s=[[e.from,e.to],[e.to,e.from]];n.ruleType===Dnt.RTEdgeJunctionEdgeConnectivity&&(s=[[e.from,e.via],[e.via,e.from],[e.to,e.via],[e.via,e.to]]);for(const r of s){const s=r.shift(),o=r.shift();let a=!1;switch(n.ruleType){case Dnt.RTEdgeJunctionEdgeConnectivity:a=s===e.from||s===e.to;break;case Dnt.RTJunctionEdgeConnectivity:a=s===e.to}const l=i[s],u=n[l.networkSourceId]?.layerId.toString()??"",c=n[l.assetGroupId]?.assetGroupCode?.toString(),h=n[l.assetTypeId],d=h?.assetTypeCode?.toString(),f=i[o],p=n[f.networkSourceId]?.layerId.toString()??"",m=n[f.assetGroupId]?.assetGroupCode?.toString(),y=n[f.assetTypeId],g=y?.assetTypeCode?.toString(),v=t[u]??{assetGroupHash:{}};if(!(c&&d&&m&&g))continue;const w=v.assetGroupHash[c]??{assetTypeHash:{}},b=w.assetTypeHash[d]??{};if(b[p]=b[p]??{},a){b[u]=b[u]??{};const t=`(assetgroup = ${c} AND assettype = ${d})`;b[u].anyVertex=b[u].anyVertex?`${b[u].anyVertex}`:`${t}`,"esriNECPEndVertex"===y?.connectivityPolicy&&(b[u].endVertex=b[u]?.endVertex?`${b[u].endVertex}`:`${t}`)}const S=`(assetgroup = ${m} AND assettype = ${g})`;b[p].anyVertex=b[p]?.anyVertex?`${b[p].anyVertex} OR ${S}`:`${S}`,"esriNECPEndVertex"===y?.connectivityPolicy&&(b[p].endVertex=b[p]?.endVertex?`${b[p].endVertex} OR ${S}`:`${S}`),w.assetTypeHash[d]=b,v.assetGroupHash[c]=w,t[u]=v}}this.rulesHash=t}};o([Us({constructOnly:!0})],Gnt.prototype,"layer",void 0),o([Us({constructOnly:!0})],Gnt.prototype,"rules",void 0),o([Us()],Gnt.prototype,"rulesHash",void 0),o([Us()],Gnt.prototype,"rulesCategorized",void 0),o([Us({constructOnly:!0})],Gnt.prototype,"request",void 0),Gnt=o([Nr("esri.networks.RulesTable")],Gnt);const Bnt=Gnt;let qnt=class extends el{constructor(t){super(t),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};o([Us({type:[Object],json:{write:!0}})],qnt.prototype,"conditionBarriers",void 0),o([Us({type:[Object],json:{write:!0}})],qnt.prototype,"outputConditions",void 0),o([Us({type:[Object],json:{write:!0}})],qnt.prototype,"functions",void 0),o([Us({type:[Object],json:{write:!0}})],qnt.prototype,"functionBarriers",void 0),o([Us({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],qnt.prototype,"traversabilityScope",void 0),o([Us({type:String,json:{write:!0}})],qnt.prototype,"shortestPathNetworkAttributeName",void 0),o([Us({type:Boolean,json:{write:!0}})],qnt.prototype,"includeBarriers",void 0),o([Us({type:Boolean,json:{write:!0}})],qnt.prototype,"validateConsistency",void 0),o([Us({type:Boolean,json:{write:!0}})],qnt.prototype,"ignoreBarriersAtStartingPoints",void 0),qnt=o([Nr("esri.networks.support.TraceConfiguration")],qnt);const Hnt=qnt;let Wnt=class extends Hnt{constructor(t){super(t),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};o([Us({type:[Object],json:{write:!0}})],Wnt.prototype,"filterBarriers",void 0),o([Us({type:String,json:{write:!0}})],Wnt.prototype,"arcadeExpressionBarrier",void 0),o([Us({type:String,json:{write:!0}})],Wnt.prototype,"domainNetworkName",void 0),o([Us({type:String,json:{write:!0}})],Wnt.prototype,"filterBitsetNetworkAttributeName",void 0),o([Us({type:[Object],json:{write:!0}})],Wnt.prototype,"filterFunctionBarriers",void 0),o([Us({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],Wnt.prototype,"filterScope",void 0),o([Us({type:Boolean,json:{write:!0}})],Wnt.prototype,"includeContainers",void 0),o([Us({type:Boolean,json:{write:!0}})],Wnt.prototype,"includeContent",void 0),o([Us({type:Boolean,json:{write:!0}})],Wnt.prototype,"includeIsolated",void 0),o([Us({type:Boolean,json:{write:!0}})],Wnt.prototype,"includeStructures",void 0),o([Us({type:Boolean,json:{write:!0}})],Wnt.prototype,"allowIndeterminateFlow",void 0),o([Us({type:Boolean,json:{write:!0}})],Wnt.prototype,"includeUpToFirstSpatialContainer",void 0),o([Us({type:Object,json:{write:!0}})],Wnt.prototype,"nearestNeighbor",void 0),o([Us({type:[Object],json:{write:!0}})],Wnt.prototype,"outputFilterCategories",void 0),o([Us({type:[Object],json:{write:!0}})],Wnt.prototype,"outputFilters",void 0),o([Us({type:[Object],json:{write:!0}})],Wnt.prototype,"propagators",void 0),o([Us({type:String,json:{write:!0}})],Wnt.prototype,"subnetworkName",void 0),o([Us({type:String,json:{write:!0}})],Wnt.prototype,"targetTierName",void 0),o([Us({type:String,json:{write:!0}})],Wnt.prototype,"diagramTemplateName",void 0),o([Us({type:String,json:{write:!0}})],Wnt.prototype,"tierName",void 0),o([Us({type:Boolean,json:{write:!0}})],Wnt.prototype,"validateLocatability",void 0),Wnt=o([Nr("esri.networks.support.UNTraceConfiguration")],Wnt);const Znt=Wnt;let Jnt=class extends JY{constructor(t){super(t),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(t,e){return void 0!==t.tierName?Znt.fromJSON(t):Hnt.fromJSON(t)}};o([Us({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],Jnt.prototype,"globalId",void 0),o([Us({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],Jnt.prototype,"title",void 0),o([Us({type:Hnt,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jnt.prototype,"traceConfiguration",void 0),o([al("service","traceConfiguration")],Jnt.prototype,"readTraceConfiguration",null),o([Us({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jnt.prototype,"creationDate",void 0),o([Us({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jnt.prototype,"creator",void 0),o([Us({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jnt.prototype,"description",void 0),o([Us({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],Jnt.prototype,"minStartingPoints",void 0),o([Us({json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jnt.prototype,"resultTypes",void 0),o([Us({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jnt.prototype,"tags",void 0),o([Us({type:$nt.apiValues,json:{type:$nt.jsonValues,origins:{service:{read:$nt.read,write:$nt.write}},read:!1}})],Jnt.prototype,"traceType",void 0),Jnt=o([Nr("esri.networks.support.NamedTraceConfiguration")],Jnt);const Knt=Jnt;let Ynt=class extends Vr{constructor(t){super(t),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTableId=null,this.associationsTableUrl=null}};o([Us({constructOnly:!0})],Ynt.prototype,"rulesTableId",void 0),o([Us({constructOnly:!0})],Ynt.prototype,"rulesTableUrl",void 0),o([Us({constructOnly:!0})],Ynt.prototype,"subnetworksTableId",void 0),o([Us({constructOnly:!0})],Ynt.prototype,"subnetworksTableUrl",void 0),o([Us({constructOnly:!0})],Ynt.prototype,"dirtyAreasLayerId",void 0),o([Us({constructOnly:!0})],Ynt.prototype,"dirtyAreasLayerUrl",void 0),o([Us({constructOnly:!0})],Ynt.prototype,"associationsTableId",void 0),o([Us({constructOnly:!0})],Ynt.prototype,"associationsTableUrl",void 0),Ynt=o([Nr("esri.networks.support.NetworkSystemLayers")],Ynt);const Qnt=Ynt;let Xnt=class extends el{constructor(t){super(t),this.id=null,this.name=null}};o([Us({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],Xnt.prototype,"id",void 0),o([Us({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],Xnt.prototype,"name",void 0),o([Us({type:Boolean,json:{write:!0}})],Xnt.prototype,"isUpstreamTerminal",void 0),Xnt=o([Nr("esri.networks.support.Terminal")],Xnt);const tst=Xnt;const est=new ul({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let ist=class extends el{constructor(t){super(t),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};o([Us({type:String,json:{write:!0}})],ist.prototype,"defaultConfiguration",void 0),o([Us({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],ist.prototype,"id",void 0),o([Us({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],ist.prototype,"name",void 0),o([Us({type:[tst],json:{write:!0}})],ist.prototype,"terminals",void 0),o([Us({type:est.apiValues,json:{type:est.jsonValues,read:est.read,write:est.write}})],ist.prototype,"traversabilityModel",void 0),ist=o([Nr("esri.networks.support.TerminalConfiguration")],ist);const nst=ist;let sst=class extends el{constructor(t){super(t),this.line=null,this.multipoint=null,this.polygon=null}};o([Us({type:vm,json:{write:!0},readOnly:!0})],sst.prototype,"line",void 0),o([Us({type:Uf,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],sst.prototype,"multipoint",void 0),o([Us({type:pm,json:{write:!0},readOnly:!0})],sst.prototype,"polygon",void 0),sst=o([Nr("esri.rest.networks.support.AggregatedGeometry")],sst);const rst=sst;let ost=class extends el{constructor(t){super(t),this.functionType=null,this.networkAttributeName=null,this.result=null}};o([Us({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],ost.prototype,"functionType",void 0),o([Us({type:String,json:{write:!0},readOnly:!0})],ost.prototype,"networkAttributeName",void 0),o([Us({type:Number,json:{write:!0},readOnly:!0})],ost.prototype,"result",void 0),ost=o([Nr("esri.rest.networks.support.FunctionResult")],ost);const ast=ost;let lst=class extends el{constructor(t){super(t),this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}};o([Us({type:Number,json:{write:!0}})],lst.prototype,"assetGroupCode",void 0),o([Us({type:Number,json:{write:!0}})],lst.prototype,"assetTypeCode",void 0),o([Us({type:String,json:{write:!0}})],lst.prototype,"globalId",void 0),o([Us({type:Number,json:{write:!0}})],lst.prototype,"networkSourceId",void 0),o([Us({type:Number,json:{write:!0}})],lst.prototype,"objectId",void 0),o([Us({type:Number,json:{write:!0}})],lst.prototype,"positionFrom",void 0),o([Us({type:Number,json:{write:!0}})],lst.prototype,"positionTo",void 0),o([Us({type:Number,json:{write:!0}})],lst.prototype,"terminalId",void 0),lst=o([Nr("esri.rest.networks.support.NetworkElement")],lst);const ust=lst;let cst=class extends el{constructor(t){super(t),this.aggregatedGeometry=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.startingPointsIgnored=!1,this.warnings=null}};o([Us({type:rst,json:{write:!0},readOnly:!0})],cst.prototype,"aggregatedGeometry",void 0),o([Us({type:[ust],json:{write:!0},readOnly:!0})],cst.prototype,"elements",void 0),o([Us({type:[ast],json:{write:!0},readOnly:!0})],cst.prototype,"globalFunctionResults",void 0),o([Us({type:Boolean,json:{write:!0},readOnly:!0})],cst.prototype,"kFeaturesForKNNFound",void 0),o([Us({type:Boolean,json:{write:!0},readOnly:!0})],cst.prototype,"startingPointsIgnored",void 0),o([Us({type:[String],json:{write:!0},readOnly:!0})],cst.prototype,"warnings",void 0),cst=o([Nr("esri.rest.networks.support.TraceResult")],cst);const hst=cst;const dst=cl()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let fst=class extends hst{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const e={...t,query:{f:"json"}},{data:i}=await hc(this.statusUrl,e),n=i.traceResults?{...i.traceResults,...i}:i;return this.read(n),this}async waitForJobCompletion(t={}){const{interval:e=1e3,statusCallback:i}=t;return new Promise(((t,n)=>{this._clearTimer();const s=setInterval((()=>{this._timer||n(Ai()),this.checkJobStatus().then((e=>{const{status:n}=e;switch(this.status=n,n){case"job-succeeded":this._clearTimer(),t(this);break;case"job-waiting":case"job-executing":i&&i(this)}}),(t=>{this._clearTimer(),n(t)}))}),e);this._timer=s}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};o([Us({type:String,json:{write:!0}})],fst.prototype,"statusUrl",void 0),o([ST(dst)],fst.prototype,"status",void 0),o([Us({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],fst.prototype,"submissionTime",void 0),o([Us({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],fst.prototype,"lastUpdatedTime",void 0),fst=o([Nr("esri.networks.support.TraceJobInfo")],fst);const pst=fst;let mst=class extends Fnt{constructor(t){super(t),this.sharedNamedTraceConfigurations=[],this.type="utility"}get serviceTerritoryFeatureLayerId(){return this.dataElement?.serviceTerritoryFeatureLayerId??null}get networkSystemLayers(){return new Qnt({rulesTableId:this.sourceJSON?.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.rulesTableId}`:null,subnetworksTableId:this.sourceJSON?.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:this.sourceJSON?.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:this.sourceJSON?.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){return this.dataElement?.terminalConfigurations.map((t=>nst.fromJSON(t)))||[]}get domainNetworkNames(){return this.dataElement?.domainNetworks.map((t=>t.domainNetworkName))||[]}get _utilityLayerList(){const t=new Set;return this.dataElement?.domainNetworks?.map((e=>{e.edgeSources.map((e=>{t.add(e.layerId)})),e.junctionSources.map((e=>{t.add(e.layerId)}))})),t}async load(t){return this.addResolvingPromise(super.load(t)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(t)),this}getTerminalConfiguration(t){let e=null,i=null;const n=t.layer;let s=null;if("feature"===n?.type){if(s=n.layerId,null===s)return null}else{if("subtype-sublayer"!==n?.type)return null;if(s=n?.parent?.layerId??null,null===s)return null}const r=t.attributes;if(null==r)return null;for(const n of Object.keys(r))"ASSETGROUP"===n.toUpperCase()&&(e=t.getAttribute(n)),"ASSETTYPE"===n.toUpperCase()&&(i=t.getAttribute(n));if(!this.dataElement)return null;let o=null;const a=this.dataElement.domainNetworks;for(const t of a){const n=t.junctionSources?.find((t=>t.layerId===s));if(n){const t=n.assetGroups?.find((t=>t.assetGroupCode===e));if(t){const e=t.assetTypes?.find((t=>t.assetTypeCode===i));if(e){o=e.terminalConfigurationId;break}}}}if(null!=o){const t=this.dataElement.terminalConfigurations,e=t?.find((t=>t.terminalConfigurationId===o));return e?nst.fromJSON(e):null}return null}getTierNames(t){const e=this.dataElement?.domainNetworks.find((e=>e.domainNetworkName===t));return e?.tiers.map((t=>t.name))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}isUtilityLayer(t){return this._utilityLayerList.has(t.layerId)&&(t.url?.startsWith(this.featureServiceUrl)??!1)}async queryAssociations(t){const[{queryAssociations:e},{default:i}]=await Promise.all([import("./p-15382cc5.js"),import("./p-241871a7.js")]),n=i.from(t);n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment;return(await e(this.networkServiceUrl,n)).associations}async synthesizeAssociationGeometries(t){const[{synthesizeAssociationGeometries:e},{default:i}]=await Promise.all([import("./p-6203fb0c.js"),import("./p-4a28eed9.js")]),n=i.from(t);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,e(this.networkServiceUrl,n)}async trace(t){const[{trace:e},{default:i}]=await Promise.all([import("./p-e2c1c9c0.js"),import("./p-0de56c3b.js")]),n=i.from(t);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,e(this.networkServiceUrl,n)}async submitTraceJob(t){const[{submitTraceJob:e},{default:i}]=await Promise.all([import("./p-e2c1c9c0.js"),import("./p-0de56c3b.js")]),n=i.from(t);n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment;const s=await e(this.networkServiceUrl,n);return new pst({statusUrl:s})}async canAddAssociation(t){const e=await this.getRulesTable();if(!e)return!1;await e.load();const i=(t,e)=>t?1===t.terminalId?!e?.terminalId||e?.terminalId===t.terminalId:t.terminalId===e?.terminalId:!e?.terminalId,n=(t,e)=>t.fromNetworkSource?.sourceId===e.fromNetworkElement?.networkSourceId&&t.toNetworkSource?.sourceId===e.toNetworkElement?.networkSourceId&&t.fromAssetGroup?.assetGroupCode===e.fromNetworkElement?.assetGroupCode&&t.fromAssetType?.assetTypeCode===e.fromNetworkElement?.assetTypeCode&&t.toAssetGroup?.assetGroupCode===e.toNetworkElement?.assetGroupCode&&t.toAssetType?.assetTypeCode===e.toNetworkElement?.assetTypeCode&&i(t.fromTerminal,e.fromNetworkElement)&&i(t.toTerminal,e.toNetworkElement);if("containment"===t.associationType){return e.rulesCategorized.containment.some((e=>n(e,t)))}if("attachment"===t.associationType){return e.rulesCategorized.attachment.some((e=>n(e,t)))}return e.rulesCategorized.connectivity.some((e=>e.viaNetworkSource?e.fromNetworkSource?.sourceId===t.fromNetworkElement?.networkSourceId&&e.viaNetworkSource?.sourceId===t.toNetworkElement?.networkSourceId&&e.fromAssetGroup?.assetGroupCode===t.fromNetworkElement?.assetGroupCode&&e.fromAssetType?.assetTypeCode===t.fromNetworkElement?.assetTypeCode&&e.viaAssetGroup?.assetGroupCode===t.toNetworkElement?.assetGroupCode&&e.viaAssetType?.assetTypeCode===t.toNetworkElement?.assetTypeCode&&i(e.fromTerminal,t.fromNetworkElement)&&i(e.viaTerminal,t.toNetworkElement)||e.viaNetworkSource?.sourceId===t.fromNetworkElement?.networkSourceId&&e.toNetworkSource?.sourceId===t.toNetworkElement?.networkSourceId&&e.viaAssetGroup?.assetGroupCode===t.fromNetworkElement?.assetGroupCode&&e.viaAssetType?.assetTypeCode===t.fromNetworkElement?.assetTypeCode&&e.toAssetGroup?.assetGroupCode===t.toNetworkElement?.assetGroupCode&&e.toAssetType?.assetTypeCode===t.toNetworkElement?.assetTypeCode&&i(e.viaTerminal,t.fromNetworkElement)&&i(e.toTerminal,t.toNetworkElement):n(e,t)))}generateAddAssociations(t){return{addFeatures:t.map((t=>new NF({attributes:{fromnetworksourceid:t.fromNetworkElement?.networkSourceId,fromglobalid:t.fromNetworkElement?.globalId,fromterminalid:t.fromNetworkElement?.terminalId,tonetworksourceid:t.toNetworkElement?.networkSourceId,toglobalid:t.toNetworkElement?.globalId,toterminalid:t.toNetworkElement?.terminalId,associationtype:Unt[t.associationType],iscontentvisible:t.isContentVisible?1:0,percentalong:t.percentAlong,globalid:t.globalId}}))),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}generateDeleteAssociations(t){return{deleteFeatures:t.map((t=>({globalId:t.globalId}))),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}async _loadNamedTraceConfigurationsFromNetwork(t){if(0===this.sharedNamedTraceConfigurations?.length)return;const e=this.sharedNamedTraceConfigurations.map((t=>t.globalId)),i=await this.queryNamedTraceConfigurations({globalIds:e},t);for(const t of this.sharedNamedTraceConfigurations){const e=i?.find((e=>e.globalId===t.globalId));if(e){const i=e.write({},{origin:"service"});t.read(i,{origin:"service"})}}}async _createRulesTable(){const t=this.networkSystemLayers.rulesTableUrl,e=new Ant({url:t});await e.load();const i=this.dataElement?.domainNetworks;if(!i)return null;const n=i.flatMap((t=>[...t.edgeSources||[],...t.junctionSources||[]])),s=(await this._queryRulesTable(e)).map((t=>this._hydrateRuleInfo(e,n,t)));return new Bnt({layer:e,rules:s})}async _queryRulesTable(t){const e=new BD({where:"1=1",outFields:["*"]});return(await W9(t,e)).features}_hydrateRuleInfo(t,e,i){const n=t.fieldsIndex,s=n.get("RULETYPE"),r=n.get("CREATIONDATE"),o=n.get("FROMNETWORKSOURCEID"),a=n.get("FROMASSETGROUP"),l=n.get("FROMASSETTYPE"),u=n.get("FROMTERMINALID"),c=n.get("TONETWORKSOURCEID"),h=n.get("TOASSETGROUP"),d=n.get("TOASSETTYPE"),f=n.get("TOTERMINALID"),p=n.get("VIANETWORKSOURCEID"),m=n.get("VIAASSETGROUP"),y=n.get("VIAASSETTYPE"),g=n.get("VIATERMINALID"),v=i.attributes[s.name],w=new Date(i.attributes[r.name]),b=[{networkSourceId:i.attributes[o.name],assetGroupId:i.attributes[a.name],assetTypeId:i.attributes[l.name],terminalId:i.attributes[u.name]},{networkSourceId:i.attributes[c.name],assetGroupId:i.attributes[h.name],assetTypeId:i.attributes[d.name],terminalId:i.attributes[f.name]},{networkSourceId:i.attributes[p.name],assetGroupId:i.attributes[m.name],assetTypeId:i.attributes[y.name],terminalId:i.attributes[g.name]}];let S;!function(t){t[t.from=0]="from",t[t.to=1]="to",t[t.via=2]="via"}(S||(S={}));const x={ruleType:v,creationDate:w};for(const t of[S.from,S.to,S.via]){if(v!==Dnt.RTEdgeJunctionEdgeConnectivity&&t===S.via)continue;const i=b[t],n=e.find((t=>t.sourceId===i.networkSourceId)),s=n?.assetGroups.find((t=>t.assetGroupCode===i.assetGroupId)),r=s?.assetTypes.find((t=>t.assetTypeCode===i.assetTypeId)),o=this._getTerminal(r,i);let a="";switch(t){case S.from:a="from";break;case S.to:a="to";break;case S.via:a="via"}x[`${a}NetworkSource`]=n,x[`${a}AssetGroup`]=s,x[`${a}AssetType`]=r,x[`${a}Terminal`]=o?.toJSON()}return x}_getTerminal(t,e){const i=t?.terminalConfigurationId,n=this.terminalConfigurations?.find((t=>t.id===i));return n?.terminals?.find((t=>t.id===e.terminalId))??null}};o([Us({type:[Knt],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],mst.prototype,"sharedNamedTraceConfigurations",void 0),o([Us({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],mst.prototype,"type",void 0),o([Us({readOnly:!0})],mst.prototype,"serviceTerritoryFeatureLayerId",null),o([Us({readOnly:!0})],mst.prototype,"networkSystemLayers",null),o([Us({readOnly:!0})],mst.prototype,"terminalConfigurations",null),o([Us({readOnly:!0})],mst.prototype,"domainNetworkNames",null),mst=o([Nr("esri.networks.UtilityNetwork")],mst);const yst=mst;const gst=Object.freeze({__proto__:null,default:yst});let vst=class extends el{constructor(t){super(t),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};o([Us({type:String,json:{write:!0}})],vst.prototype,"facilityIdField",void 0),o([Us({type:String,json:{write:!0}})],vst.prototype,"layerId",void 0),o([Us({type:String,json:{write:!0}})],vst.prototype,"nameField",void 0),o([Us({type:String,json:{write:!0}})],vst.prototype,"siteIdField",void 0),o([Us({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],vst.prototype,"sublayerId",void 0),vst=o([Nr("esri.layers.support.FacilityLayerInfo")],vst);const wst=vst;let bst=class extends el{constructor(t){super(t),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};o([Us({type:String,json:{write:!0}})],bst.prototype,"facilityIdField",void 0),o([Us({type:String,json:{write:!0}})],bst.prototype,"layerId",void 0),o([Us({type:String,json:{write:!0}})],bst.prototype,"levelIdField",void 0),o([Us({type:String,json:{write:!0}})],bst.prototype,"levelNumberField",void 0),o([Us({type:String,json:{write:!0}})],bst.prototype,"longNameField",void 0),o([Us({type:String,json:{write:!0}})],bst.prototype,"shortNameField",void 0),o([Us({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],bst.prototype,"sublayerId",void 0),o([Us({type:String,json:{write:!0}})],bst.prototype,"verticalOrderField",void 0),bst=o([Nr("esri.layers.support.LevelLayerInfo")],bst);const Sst=bst;let xst=class extends el{constructor(t){super(t),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};o([Us({type:String,json:{write:!0}})],xst.prototype,"layerId",void 0),o([Us({type:String,json:{write:!0}})],xst.prototype,"nameField",void 0),o([Us({type:String,json:{write:!0}})],xst.prototype,"siteIdField",void 0),o([Us({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],xst.prototype,"sublayerId",void 0),xst=o([Nr("esri.layers.support.SiteLayerInfo")],xst);const _st=xst;let Mst=class extends el{constructor(t){super(t),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};o([Us({type:Sst,json:{write:!0}})],Mst.prototype,"levelLayer",void 0),o([Us({type:wst,json:{write:!0}})],Mst.prototype,"facilityLayer",void 0),o([Us({type:_st,json:{write:!0}})],Mst.prototype,"siteLayer",void 0),Mst=o([Nr("esri.support.MapFloorInfo")],Mst);const kst=Mst;let Tst=class extends(Gr(el)){constructor(t){super(t),this.expression=null,this.returnType="string",this.title=null}};o([Us({type:String,json:{write:{isRequired:!0}}})],Tst.prototype,"expression",void 0),o([Us({type:["number","string"],json:{write:!0}})],Tst.prototype,"returnType",void 0),o([Us({type:String,json:{write:!0}})],Tst.prototype,"title",void 0),Tst=o([Nr("esri.webdoc.geotriggersInfo.ExpressionInfo")],Tst);const Ast=Tst;const Ist=new ul({deviceLocation:"device-location"});let jst=class extends(Gr(el)){constructor(t){super(t),this.filterExpression=null,this.type="device-location"}};o([Us({type:Ast,json:{write:!0}})],jst.prototype,"filterExpression",void 0),o([Us({type:Ist.apiValues,readOnly:!0,json:{type:Ist.jsonValues,read:Ist.read,write:Ist.write}})],jst.prototype,"type",void 0),jst=o([Nr("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],jst);const Cst=jst;let Est=class extends(Gr(el)){constructor(t){super(t),this.geometry=null,this.where=null}};o([Us({types:Cm,json:{read:Tm,write:!0}})],Est.prototype,"geometry",void 0),o([Us({type:String,json:{write:!0}})],Est.prototype,"where",void 0),Est=o([Nr("esri.webdoc.geotriggersInfo.FeatureFilter")],Est);const Ost=Est;let Lst=class extends(Gr(el)){constructor(t){super(t),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};o([Us({type:String,json:{write:{overridePolicy(){return{isRequired:null===this.layerUrl}}}}})],Lst.prototype,"layerId",void 0),o([Us({type:String,json:{write:{overridePolicy(){return{isRequired:null===this.layerId}}}}})],Lst.prototype,"layerUrl",void 0),o([ST({featureLayer:"feature-layer"},{readOnly:!0})],Lst.prototype,"type",void 0),Lst=o([Nr("esri.webdoc.geotriggersInfo.FeatureLayerSource")],Lst);const Nst=Lst;let Rst=class extends(Gr(el)){constructor(t){super(t),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};o([Us({type:Nst,json:{write:{isRequired:!0}}})],Rst.prototype,"fenceSource",void 0),o([Us({type:Ost,json:{write:!0}})],Rst.prototype,"filter",void 0),o([Us({type:Number,json:{write:!0}})],Rst.prototype,"bufferDistance",void 0),o([ST({features:"features"},{readOnly:!0})],Rst.prototype,"type",void 0),Rst=o([Nr("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],Rst);const Pst=Rst;let Fst=class extends(Gr(el)){constructor(t){super(t),this.type="fence"}};o([ST({fence:"fence"},{readOnly:!0})],Fst.prototype,"type",void 0),Fst=o([Nr("esri.webdoc.geotriggersInfo.Geotrigger")],Fst);const Dst=Fst;let $st=class extends(Gr(el)){constructor(t){super(t),this.expressionInfo=null,this.requestedActions=null}};o([Us({type:Ast,json:{write:!0}})],$st.prototype,"expressionInfo",void 0),o([Us({type:[String],json:{write:!0}})],$st.prototype,"requestedActions",void 0),$st=o([Nr("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],$st);const zst=$st;const Ust=new ul({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),Vst=new ul({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),Gst=new ul({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});let Bst=class extends Dst{constructor(t){super(t),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};o([ST(Ust)],Bst.prototype,"enterExitRule",void 0),o([Us({type:Cst,json:{write:{isRequired:!0}}})],Bst.prototype,"feed",void 0),o([ST(Vst)],Bst.prototype,"feedAccuracyMode",void 0),o([Us({type:Gst.apiValues,json:{type:Gst.jsonValues,read:Gst.read,write:{writer:Gst.write,isRequired:!0}}})],Bst.prototype,"fenceNotificationRule",void 0),o([Us({type:Pst,json:{write:{isRequired:!0}}})],Bst.prototype,"fenceParameters",void 0),o([Us({type:String,json:{write:!0}})],Bst.prototype,"name",void 0),o([Us({type:zst,json:{write:!0}})],Bst.prototype,"notificationOptions",void 0),o([ST({fence:"fence"},{readOnly:!0})],Bst.prototype,"type",void 0),Bst=o([Nr("esri.webdoc.geotriggersInfo.FenceGeotrigger")],Bst);const qst=Bst;const Hst={base:Dst,key:"type",typeMap:{fence:qst}};let Wst=class extends(Gr(el)){constructor(t){super(t),this.geotriggers=null}};o([Us({types:[Hst],json:{write:{isRequired:!0}}})],Wst.prototype,"geotriggers",void 0),Wst=o([Nr("esri.webdoc.GeotriggersInfo")],Wst);const Zst=Wst;var Jst;let Kst=Jst=class extends el{constructor(t){super(t),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new Jst(ht({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};o([Us({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],Kst.prototype,"activeRange",void 0),o([Us({type:[Number],json:{write:!0}})],Kst.prototype,"currentRangeExtent",void 0),o([Us({type:[Number],json:{write:!0}})],Kst.prototype,"fullRangeExtent",void 0),Kst=Jst=o([Nr("esri.webdoc.RangeInfo")],Kst);const Yst=Kst;var Qst;let Xst=Qst=class extends el{constructor(t){super(t),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new Qst(ht({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};o([Us({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],Xst.prototype,"enabled",void 0),o([Us({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],Xst.prototype,"longNames",void 0),o([Us({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],Xst.prototype,"minimized",void 0),o([Us({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],Xst.prototype,"pinnedLevels",void 0),o([Us({type:String,json:{read:{source:"site"},write:{target:"site"}}})],Xst.prototype,"site",void 0),o([Us({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],Xst.prototype,"facility",void 0),o([Us({type:String,json:{read:{source:"level"},write:{target:"level"}}})],Xst.prototype,"level",void 0),Xst=Qst=o([Nr("esri.webdoc.widgets.FloorFilter")],Xst);const trt=Xst;var ert;const irt=new ul({slider:"slider",picker:"picker"});let nrt=ert=class extends el{constructor(t){super(t),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new ert({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};o([Us({type:irt.apiValues,nonNullable:!0,json:{type:irt.jsonValues,default:null,read:{reader:irt.read},write:{isRequired:!0,writer:irt.write}}})],nrt.prototype,"interactionMode",void 0),o([Us({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const t=null!=this.stopInterval;return{enabled:!t,isRequired:!t}}}}})],nrt.prototype,"numStops",void 0),o([Us({type:Number,json:{write:{overridePolicy(){return{isRequired:null==this.numStops}}}}})],nrt.prototype,"stopInterval",void 0),nrt=ert=o([Nr("esri.webdoc.widgets.Range")],nrt);const srt=nrt;var rrt;let ort=rrt=class extends el{constructor(t){super(t),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(t){if(!t)return;const e=null!=t[0]?new Date(t[0]):null,i=null!=t[1]?new Date(t[1]):null;return new sj({start:e,end:i})}writeCurrentTimeExtent(t,e,i){t&&kt(i,[null!=t.start?t.start.getTime():null,null!=t.end?t.end.getTime():null],e)}readFullTimeExtent(t,e){const i=e.properties;if(!i)return;const n=null!=i.endTime?new Date(i.endTime):null,s=null!=i.startTime?new Date(i.startTime):null;return new sj({start:s,end:n})}writeFullTimeExtent(t,e){if(!t)return;const i=e.properties=e.properties||{},n=t.end,s=t.start;n&&(i.endTime=null!=n?n.getTime():null),s&&(i.startTime=null!=s?s.getTime():null)}readStopInterval(t,e,i){return t?Rit.fromJSON({value:t.interval,unit:t.units},i):null}writeStopInterval(t,e,i,n){if(!t)return;const s=t.toJSON(n);kt(i,{interval:s.value,units:s.unit},e)}readStops(t){return t?.length?t.map((t=>new Date(t))):null}writeStops(t,e,i){t?.length&&kt(i,t.map((t=>t.getTime())),e)}clone(){return new rrt(ht({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};o([Us({type:sj,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],ort.prototype,"currentTimeExtent",void 0),o([al("currentTimeExtent")],ort.prototype,"readCurrentTimeExtent",null),o([ll("currentTimeExtent")],ort.prototype,"writeCurrentTimeExtent",null),o([Us({type:sj,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],ort.prototype,"fullTimeExtent",void 0),o([al("fullTimeExtent")],ort.prototype,"readFullTimeExtent",null),o([ll("fullTimeExtent")],ort.prototype,"writeFullTimeExtent",null),o([Us({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],ort.prototype,"loop",void 0),o([Us({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){const t=!!this.stopInterval,e=!!this.stops?.length,i=!(t||e);return{enabled:i,isRequired:i}}}}})],ort.prototype,"numStops",void 0),o([Us({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],ort.prototype,"numThumbs",void 0),o([Us({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],ort.prototype,"stopDelay",void 0),o([Us({type:Rit,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy(){const t=null!=this.numStops,e=!!this.stops?.length;return{enabled:!e,isRequired:!(t||e)}}}}})],ort.prototype,"stopInterval",void 0),o([al("stopInterval")],ort.prototype,"readStopInterval",null),o([ll("stopInterval")],ort.prototype,"writeStopInterval",null),o([Us({type:[Date],json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],ort.prototype,"stops",void 0),o([al("stops")],ort.prototype,"readStops",null),o([ll("stops")],ort.prototype,"writeStops",null),ort=rrt=o([Nr("esri.webdoc.widgets.TimeSlider")],ort);const art=ort;var lrt;let urt=lrt=class extends el{constructor(t){super(t),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new lrt(ht({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};o([Us({type:srt,json:{write:!0}})],urt.prototype,"range",void 0),o([Us({type:art,json:{write:!0}})],urt.prototype,"timeSlider",void 0),o([Us({type:trt,json:{write:!0}})],urt.prototype,"floorFilter",void 0),urt=lrt=o([Nr("esri.webdoc.Widgets")],urt);const crt=urt;const hrt={width:600,height:400},drt=1.5;function frt(t,e){e=e||hrt;let{width:i,height:n}=e;const s=i/n;return s<drt?n=i/drt:s>drt&&(i=n*drt),i>t.width&&(n*=t.width/i,i=t.width),n>t.height&&(i*=t.height/n,n=t.height),{width:Math.round(i),height:Math.round(n)}}function prt(t,e){return{...yrt(t,e),readResourcePaths:[]}}function mrt(t,e,i){const n=Ul(t.itemUrl);return{...yrt(t,e),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:n?{rootPath:n.path,writtenUrls:[]}:null,resources:i?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function yrt(t,e){return{origin:e,url:Ul(t.itemUrl),portal:t.portal||YM.getDefault(),portalItem:t}}let grt=class extends el{constructor(t){super(t),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const t=this.geometries.map((t=>t.toJSON())),e=this.geometries[0],i={};return i.outSR=gh(this.outSpatialReference),i.inSR=gh(e.spatialReference),i.geometries=JSON.stringify({geometryType:Am(e),geometries:t}),this.transformation&&(i.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(i.transformForward=this.transformForward),i}};o([Us()],grt.prototype,"geometries",void 0),o([Us({json:{read:{source:"outSR"}}})],grt.prototype,"outSpatialReference",void 0),o([Us()],grt.prototype,"transformation",void 0),o([Us()],grt.prototype,"transformForward",void 0),grt=o([Nr("esri.rest.support.ProjectParameters")],grt);const vrt=grt;const wrt=ks(vrt);async function brt(t,e,i){e=wrt(e);const n=nV(t),s={...n.query,f:"json",...e.toJSON()},r=e.outSpatialReference,o=Am(e.geometries[0]),a=iV(s,i);return hc(n.path+"/project",a).then((({data:{geometries:t}})=>aV(t,o,r)))}function Srt(t,e){return e.resourceInfo?xrt(e,e.resourceInfo,{origin:t.origin}):e.portalItem?.id?_rt(t,e,e.portalItem):Promise.resolve()}function xrt(t,e,i){const n={context:{...i,layerContainerType:"operational-layers"}};return t.portalItem&&(n.context.portal=t.portalItem.portal||YM.getDefault()),import("./p-6684cc8f.js").then((({populateOperationalLayers:i})=>{const s=[],r=e.operationalLayers;r?.length&&s.push(i(t.layers,r,n));const o={...n,context:{...n.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},a=e.tables;return a?.length&&s.push(i(t.tables,a,o)),Promise.allSettled(s).then((()=>{}))}))}async function _rt(t,e,i){if(await i.load().catch((e=>{throw new Qe(`${t.name}:load-portal-item`,"Failed to load portal item",{error:e})})),i.type!==t.itemType)throw new Qe(`${t.name}:invalid-portal-item`,`Invalid portal item type '${i.type}', expected '${t.itemType}'`,{type:i.type});const n=await i.fetchData();e.resourceInfo=n;const s=prt(i,t.origin);await Mrt(t,e,n,s),e.resourceReferences={portalItem:i,paths:s.readResourcePaths};const r=await Trt(e.initialViewProperties,i,Ft.getLogger(e));if(r){const i=e.initialViewProperties?.clone()??t.createInitialViewProperties();i.viewpoint=r,e.initialViewProperties=i}}function Mrt(t,e,i,n){const s=krt(t,i);return e.read(s,n),xrt(e,s,n)}function krt(t,e){const i=t.parseVersion(e.version||"",t.name);return t.currentVersion.validate(i),e.version=`${i.major}.${i.minor}`,e}async function Trt(t,e,i){const n=t?.viewpoint?.targetGeometry;if(n)return null;const s=await Art(t,e,i);if(!s)return null;return new Nm({targetGeometry:s})}async function Art(t,e,i){const n=t?.spatialReference,s=e?.extent;if(!n||!s)return null;if(n.isWGS84)return s.clone();if(n.isWebMercator)return Hd(s);const{getGeometryServiceURL:r}=await import("./p-5c6e7588.js");try{const t=await r(e),i=new vrt;i.geometries=[s],i.outSpatialReference=n;return(await brt(t,i))[0]}catch(t){i.error("Error projecting item's extent:",t)}return null}function Irt(t){return{enabled:!!t?.length}}var jrt;let Crt=jrt=class extends el{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new jrt({exactMatch:this.exactMatch,type:this.type,name:this.name})}};o([Us({type:Boolean,json:{write:!0}})],Crt.prototype,"exactMatch",void 0),o([Us({type:String,json:{write:!0}})],Crt.prototype,"name",void 0),o([ST(aD)],Crt.prototype,"type",void 0),Crt=jrt=o([Nr("esri.webdoc.applicationProperties.SearchLayerField")],Crt);const Ert=Crt;var Ort;let Lrt=Ort=class extends el{constructor(t){super(t),this.field=null,this.id=null,this.subLayer=null}clone(){return new Ort(ht({field:this.field,id:this.id,subLayer:this.subLayer}))}};o([Us({type:Ert,json:{write:{isRequired:!0}}})],Lrt.prototype,"field",void 0),o([Us({type:String,json:{write:{isRequired:!0}}})],Lrt.prototype,"id",void 0),o([Us({type:Ns,json:{write:!0}})],Lrt.prototype,"subLayer",void 0),Lrt=Ort=o([Nr("esri.webdoc.applicationProperties.SearchLayer")],Lrt);const Nrt=Lrt;var Rrt;let Prt=Rrt=class extends el{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new Rrt({exactMatch:this.exactMatch,type:this.type,name:this.name})}};o([Us({type:Boolean,json:{write:!0}})],Prt.prototype,"exactMatch",void 0),o([Us({type:String,json:{write:!0}})],Prt.prototype,"name",void 0),o([ST(aD)],Prt.prototype,"type",void 0),Prt=Rrt=o([Nr("esri.webdoc.applicationProperties.SearchTableField")],Prt);const Frt=Prt;var Drt;let $rt=Drt=class extends el{constructor(t){super(t),this.field=null,this.id=null}clone(){return new Drt(ht({field:this.field,id:this.id}))}};o([Us({type:Frt,json:{write:{isRequired:!0}}})],$rt.prototype,"field",void 0),o([Us({type:String,json:{write:{isRequired:!0}}})],$rt.prototype,"id",void 0),$rt=Drt=o([Nr("esri.webdoc.applicationProperties.SearchTable")],$rt);const zrt=$rt;var Urt;const Vrt=ty.ofType(Nrt),Grt=ty.ofType(zrt);let Brt=Urt=class extends el{constructor(t){super(t),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new Vrt,this.tables=new Grt}readAddressSearchEnabled(t){return!t}writeAddressSearchEnabled(t,e,i){e[i]=!t}clone(){return new Urt(ht({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};o([Us({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],Brt.prototype,"addressSearchEnabled",void 0),o([al("addressSearchEnabled")],Brt.prototype,"readAddressSearchEnabled",null),o([ll("addressSearchEnabled")],Brt.prototype,"writeAddressSearchEnabled",null),o([Us({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],Brt.prototype,"enabled",void 0),o([Us({type:String,json:{write:!0}})],Brt.prototype,"hintText",void 0),o([Us({type:Vrt,json:{write:{overridePolicy:Irt},origins:{"web-scene":{write:{isRequired:!0}}}}})],Brt.prototype,"layers",void 0),o([Us({type:Grt,json:{read:!0,write:{overridePolicy:Irt}}})],Brt.prototype,"tables",void 0),Brt=Urt=o([Nr("esri.webdoc.applicationProperties.Search")],Brt);const qrt=Brt;var Hrt;let Wrt=Hrt=class extends el{constructor(t){super(t),this.search=null}clone(){return new Hrt(ht({search:this.search}))}};o([Us({type:qrt,json:{write:!0}})],Wrt.prototype,"search",void 0),Wrt=Hrt=o([Nr("esri.webdoc.applicationProperties.Viewing")],Wrt);const Zrt=Wrt;var Jrt;let Krt=Jrt=class extends el{constructor(t){super(t),this.editing=null,this.offline=null,this.viewing=null}clone(){return new Jrt(ht({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};o([Us({json:{write:!0}})],Krt.prototype,"editing",void 0),o([Us({json:{write:!0}})],Krt.prototype,"offline",void 0),o([Us({type:Zrt,json:{write:!0}})],Krt.prototype,"viewing",void 0),Krt=Jrt=o([Nr("esri.webmap.ApplicationProperties")],Krt);const Yrt=Krt;function Qrt(t){return!!t&&/^https:\/\/.*/i.test(t)}function Xrt(t){return!!t&&/data:([-\w]+\/[-+\w.]+)?(;?\w+=[-\w]+)*(;base64)?,.*/gu.test(t)}var tot;let eot=tot=class extends el{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}get isSecureUrl(){return Qrt(this.url)}get isDataURI(){return Xrt(this.url)}clone(){return new tot({url:this.url})}};o([Us({type:String,json:{write:{isRequired:!0}}})],eot.prototype,"url",void 0),o([Us()],eot.prototype,"isSecureUrl",null),o([Us()],eot.prototype,"isDataURI",null),eot=tot=o([Nr("esri.webdoc.support.SlideThumbnail")],eot);var iot;let not=iot=class extends(PI(el)){constructor(t){super(t),this.name=null,this.thumbnail=new eot,this.timeExtent=null}castThumbnail(t){return"string"==typeof t?new eot({url:t}):ks(eot,t)}set viewpoint(t){const{targetGeometry:e,scale:i}=t;null!=e&&"point"===e.type&&null==i&&Ft.getLogger(this).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",t),this._set("viewpoint",t)}readViewpoint(t,e){const{extent:i,viewpoint:n}=e;return Nm.fromJSON(n||{targetGeometry:i})}writeViewpoint(t,e,i,n){if(!t)return;const{targetGeometry:s}=t;if(null==s||"extent"===s.type)null!=s&&(e.extent=s.toJSON()),e[i]=t.toJSON();else{const t="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";n?.messages?n.messages.push(new Qe("property:unsupported",t)):Ft.getLogger(this).error(t)}}clone(){return new iot(ht({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};o([Us({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],not.prototype,"name",void 0),o([Us({type:eot,json:{write:{overridePolicy:t=>({enabled:!(!t||!t.url)})}}})],not.prototype,"thumbnail",void 0),o([ol("thumbnail")],not.prototype,"castThumbnail",null),o([Us({type:sj,json:{write:!0}})],not.prototype,"timeExtent",void 0),o([Us({type:Nm,nonNullable:!0,json:{write:!0}})],not.prototype,"viewpoint",null),o([al("viewpoint",["extent","viewpoint"])],not.prototype,"readViewpoint",null),o([ll("viewpoint")],not.prototype,"writeViewpoint",null),not=iot=o([Nr("esri.webmap.Bookmark")],not);const sot=not;let rot=class extends(Gr(Vr)){constructor(t){super(t),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.timeZone=pg,this.viewpoint=null}};o([Us({type:OY})],rot.prototype,"background",void 0),o([Us({type:Yst})],rot.prototype,"rangeInfo",void 0),o([Us({type:jd})],rot.prototype,"spatialReference",void 0),o([Us({nonNullable:!0})],rot.prototype,"timeZone",void 0),o([Us({type:Nm})],rot.prototype,"viewpoint",void 0),rot=o([Nr("esri.webmap.InitialViewProperties")],rot);const oot=rot;class aot extends O0{constructor(t,e){super(t,e,"webmap")}}const lot=new aot(2,30),uot="Web Map",cot="webmap",hot="web-map",dot=ty.ofType(sot),fot=ty.ofType(yst),pot=new Map([["image/jpeg","jpeg"],["image/jpg","jpg"],["image/png","png"],["image/gif","gif"]]),mot="ArcGIS Pro",yot=hit.JSAPI,got={currentVersion:lot,createInitialViewProperties:()=>new oot,parseVersion:aot.parse,itemType:uot,name:cot,origin:hot};let vot=class extends(ZY(AM.LoadableMixin(wM(ZI)))){constructor(t){super(t),this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1,this._thumbnailFilename=null,this._updateFromPromise=null,this.resourceReferences={portalItem:null,paths:[]},this.applicationProperties=null,this.bookmarks=new dot,this.floorInfo=null,this.geotriggersInfo=null,this.initialViewProperties=new oot,this.ipsInfo=null,this.portalItem=null,this.presentation=null,this.sourceVersion=null,this.widgets=null,this.utilityNetworks=null,this._debouncedSaveOperations=qi((async(t,e,i)=>{const{save:n,saveAs:s}=await import("./p-55330b33.js");switch(t){case bnt.SAVE:return n(got,this,e);case bnt.SAVE_AS:return s(got,this,i,e)}})),this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){if(this.portalItem=$t(this.portalItem),this.utilityNetworks){const t=this.utilityNetworks.removeAll();for(const e of t)e.destroy();this.utilityNetworks.destroy()}}initialize(){if(this.when().catch((t=>{Ft.getLogger(this).error("#load()","Failed to load web map",t)})),this.resourceInfo){let t;try{t=this._validateJSON(this.resourceInfo)}catch(t){return void this.addResolvingPromise(Promise.reject(t))}this.read(t)}}set authoringApp(t){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",t)}writeAuthoringApp(t,e){t&&this._isAuthoringAppSetByUser?e.authoringApp=t:e.authoringApp=yot}set authoringAppVersion(t){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",t)}writeAuthoringAppVersion(t,e){t&&this._isAuthoringAppVersionSetByUser?e.authoringAppVersion=t:e.authoringAppVersion=Yu}readInitialViewProperties(t,e){const i=new oot;e.background&&(i.background=OY.fromJSON(e.background));const n=e.initialState?.viewpoint;if(n){if(n.rotation){aot.parse(e.version||"","webmap").lessThan(2,20)&&e.authoringApp===mot&&(n.rotation*=-1)}i.viewpoint=Nm.fromJSON(n)}return e.mapRangeInfo&&(i.rangeInfo=Yst.fromJSON(e.mapRangeInfo)),e.spatialReference&&(i.spatialReference=jd.fromJSON(e.spatialReference)),e.timeZone&&(i.timeZone=e.timeZone),i}writeInitialViewProperties(t,e,i,n){t&&(t.background?.color&&(e.background=t.background.write({},n)),t.viewpoint&&(e.initialState={viewpoint:t.viewpoint.write({},n)}),t.rangeInfo&&(e.mapRangeInfo=t.rangeInfo.toJSON(n)),t.spatialReference&&(e.spatialReference=t.spatialReference.write({},n)),e.timeZone=t.timeZone)}writeLayers(t,e,i,n){e[i]=this._writeLayers(t,n,"operational-layers")}readSourceVersion(t,e){const[i,n]=e.version.split(".");return new aot(parseInt(i,10),parseInt(n,10))}writeSourceVersion(t,e,i){e[i]=`${lot.major}.${lot.minor}`}writeTables(t,e,i,n){const s=this._writeLayers(t,n,"tables");s.length&&(e[i]=s)}get thumbnailUrl(){return this.portalItem?.thumbnailUrl||null}set thumbnailUrl(t){t?(this._override("thumbnailUrl",t),this._thumbnailFilename=this._generateCustomThumbnailFilename(t)):this._clearThumbnailOverride()}get updatingFromView(){return!!this._updateFromPromise}load(t){return this.addResolvingPromise(Srt(got,this)),Promise.resolve(this)}loadAll(){return IM(this,(t=>{t(this.ground,this.basemap,this.layers,this.tables)}))}read(t,e){e={...e,origin:hot};const i=this._getAuthoringPropsState();Ha(this,t,(e=>super.read(t,e)),e),this._restoreAuthoringPropsFromState(i)}write(t,e){if("loaded"!==this.loadStatus){const t=new Qe("webmap:not-loaded","Web map must be loaded before it can be serialized");throw Ft.getLogger(this).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),t}return this._removeDanglingLayerRefs(),e={...e,origin:hot,restrictedWebMapWriting:!0,webmap:this},super.write(t,e)}async save(t){return this._debouncedSaveOperations(bnt.SAVE,t)}async saveAs(t,e){return this._debouncedSaveOperations(bnt.SAVE_AS,e,t)}async updateFrom(t,e){const i=this._updateFromInternal(t,e);this._updateFromPromise=i,await i;i===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(t){const e=this.resourceInfo;return this._collectAllLayersJSON([...e?.baseMap?.baseMapLayers||[],...e?.operationalLayers||[],...this.basemap?.resourceInfo?.data?.baseMapLayers||[]]).find((e=>e.id===t.id))}async updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await(this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename})),this._clearThumbnailOverride())}getThumbnailState(){let t=this.thumbnailUrl;return t&&(t=this._isOverridden("thumbnailUrl")?t:Vu(t,"w","8192")),{thumbnailUrl:t,filename:this._thumbnailFilename}}restoreThumbnailFromState(t){this.thumbnailUrl=t.thumbnailUrl,this._thumbnailFilename=t.filename}_collectAllLayersJSON(t){return t.reduce(((t,e)=>(t.push(e),"GroupLayer"===e.layerType&&(t=t.concat(this._collectAllLayersJSON(e.layers||[]))),t)),[])}_writeLayers(t,e,i){e={...e,layerContainerType:i};return t.map((t=>Xk(t,"tables"===i?null:this.getLayerJSONFromResourceInfo(t),e))).filter(F).toArray()}_validateJSON(t){const e=aot.parse(t.version||"","webmap");return lot.validate(e),t.version=`${e.major}.${e.minor}`,t}_removeDanglingLayerRefs(){const t=this.applicationProperties,e=t?.viewing?.search,i=t=>this.allLayers.some((e=>e.id===t));if(e&&e.layers&&(e.layers=e.layers.filter((t=>i(t.id)))),e&&e.tables&&(e.tables=e.tables.filter((t=>this.tables.some((e=>e.id===t.id))))),t){const e=t.editing?.locationTracking;e?.info&&!i(e.info.layerId)&&(t.editing=null)}const n=this.presentation?.slides;n&&n.forEach((t=>{t.visibleLayers&&(t.visibleLayers=t.visibleLayers.filter((t=>i(t.id))))}))}async _updateFromInternal(t,e){if(e??={},await gy((()=>t.ready)),this._updateInitialViewProperties(t,e),t.map===this)for(const e of t.allLayerViews)"visible"in e&&"visible"in e.layer&&e._isOverridden("visible")&&(e.layer.visible=e.visible),"featureEffect"in e&&"featureEffect"in e.layer&&e._isOverridden("featureEffect")&&(e.layer.featureEffect=e.featureEffect);await this._updateThumbnailUrl(t,e)}_updateInitialViewProperties(t,e){if(e.backgroundExcluded||(this.initialViewProperties.background=t.background?.clone()),this.initialViewProperties.spatialReference=t.spatialReference?.clone(),this.initialViewProperties.timeZone=t.timeZone,e.viewpointExcluded||(this.initialViewProperties.viewpoint=new Nm({rotation:t.rotation,scale:e.scalePreserved?t.scale:null,targetGeometry:this._getViewExtent(t)})),!e.widgetsExcluded)for(const e of t.persistableViewModels)e.updateWebDocument(this)}_getViewExtent(t){const e=t.center.clone().normalize(),i=t.extent.clone(),n=i.width/2;return i.xmin=e.x-n,i.xmax=e.x+n,i}async _updateThumbnailUrl(t,e){if(e.thumbnailExcluded)return;const i=frt(t,e.thumbnailSize),n=await t.takeScreenshot({format:"png",width:i.width,height:i.height});this._setAutoGeneratedThumbnail(n.dataUrl)}_setAutoGeneratedThumbnail(t){this.thumbnailUrl=t,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(t){if(hu(t)){const e=mu(t),i=e?.mediaType,n=i&&pot.get(i.toLowerCase())||null,s=`thumbnail${Date.now()}`;return n?`${s}.${n}`:s}return null}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(t){t.isAuthoringAppSetByUser?this.authoringApp=t.authoringApp:this._isAuthoringAppSetByUser=!1,t.isAuthoringAppVersionSetByUser?this.authoringAppVersion=t.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}static fromJSON(t){const e=t;if(!e)throw new Qe("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:e})}};vot.VERSION=lot,o([Us()],vot.prototype,"_updateFromPromise",void 0),o([Us({type:Yrt,json:{write:!0}})],vot.prototype,"applicationProperties",void 0),o([Us({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],vot.prototype,"authoringApp",null),o([ll("authoringApp")],vot.prototype,"writeAuthoringApp",null),o([Us({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],vot.prototype,"authoringAppVersion",null),o([ll("authoringAppVersion")],vot.prototype,"writeAuthoringAppVersion",null),o([Us({type:dot,json:{write:{overridePolicy:t=>({enabled:!!(t&&t.length>0),ignoreOrigin:!0})}}})],vot.prototype,"bookmarks",void 0),o([Us({type:kst,json:{name:"mapFloorInfo",write:!0}})],vot.prototype,"floorInfo",void 0),o([Us({type:Zst,json:{write:!0}})],vot.prototype,"geotriggersInfo",void 0),o([Us({type:oot,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference","timeZone"]},write:{ignoreOrigin:!0,target:{background:{type:OY},"initialState.viewpoint":{type:Nm},mapRangeInfo:{type:Yst},spatialReference:{type:jd},"timeZone:":{type:String}}}}})],vot.prototype,"initialViewProperties",void 0),o([al("initialViewProperties")],vot.prototype,"readInitialViewProperties",null),o([ll("initialViewProperties")],vot.prototype,"writeInitialViewProperties",null),o([Us({json:{write:!0,name:"mapIPSInfo"}})],vot.prototype,"ipsInfo",void 0),o([Us({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],vot.prototype,"layers",void 0),o([ll("layers")],vot.prototype,"writeLayers",null),o([Us({type:xk})],vot.prototype,"portalItem",void 0),o([Us({json:{write:!0}})],vot.prototype,"presentation",void 0),o([Us()],vot.prototype,"resourceInfo",void 0),o([Us({readOnly:!0,type:aot,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],vot.prototype,"sourceVersion",void 0),o([al("sourceVersion")],vot.prototype,"readSourceVersion",null),o([ll("sourceVersion")],vot.prototype,"writeSourceVersion",null),o([Us({json:{read:!1,write:{ignoreOrigin:!0}}})],vot.prototype,"tables",void 0),o([ll("tables")],vot.prototype,"writeTables",null),o([Us()],vot.prototype,"thumbnailUrl",null),o([Us()],vot.prototype,"updatingFromView",null),o([Us({type:crt,json:{write:!0}})],vot.prototype,"widgets",void 0),o([Us({type:fot,json:{read:!0,write:!0}})],vot.prototype,"utilityNetworks",void 0),vot=o([Nr("esri.WebMap")],vot);const wot=vot;const bot={type:String,json:{read:{source:"token"},write:{target:"token"}}};const Sot=cl()({esriCentimeters:"centimeters",esriDecimalDegrees:"decimal-degrees",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriPoints:"points",esriUnknownUnits:"unknown",esriYards:"yards"}),xot=cl()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards"});cl()({esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds"});const _ot=cl()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards",esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds",esriNAUKilometersPerHour:"kilometers-per-hour",esriNAUMilesPerHour:"miles-per-hour",esriNAUUnknown:"unknown"}),Mot=cl()({esriDOTComplete:"complete",esriDOTCompleteNoEvents:"complete-no-events",esriDOTFeatureSets:"featuresets",esriDOTInstructionsOnly:"instructions-only",esriDOTStandard:"standard",esriDOTSummaryOnly:"summary-only"}),kot=cl()({esriNAOutputLineNone:"none",esriNAOutputLineStraight:"straight",esriNAOutputLineTrueShape:"true-shape",esriNAOutputLineTrueShapeWithMeasure:"true-shape-with-measure"}),Tot=cl()({esriNAOutputPolygonNone:"none",esriNAOutputPolygonSimplified:"simplified",esriNAOutputPolygonDetailed:"detailed"}),Aot=cl()({esriNFSBAllowBacktrack:"allow-backtrack",esriNFSBAtDeadEndsOnly:"at-dead-ends-only",esriNFSBNoBacktrack:"no-backtrack",esriNFSBAtDeadEndsAndIntersections:"at-dead-ends-and-intersections"}),Iot=cl()({esriNATravelDirectionFromFacility:"from-facility",esriNATravelDirectionToFacility:"to-facility"});cl()({esriNATimeOfDayNotUsed:"not-used",esriNATimeOfDayUseAsStartTime:"start",esriNATimeOfDayUseAsEndTime:"end"});const jot=cl()({AUTOMOBILE:"automobile",TRUCK:"truck",WALK:"walk",OTHER:"other"}),Cot=cl()({0:"either-side-of-vehicle",1:"right-side-of-vehicle",2:"left-side-of-vehicle",3:"no-u-turn"},{useNumericKeys:!0}),Eot=cl()({0:"stop",1:"waypoint",2:"break"},{useNumericKeys:!0}),Oot=cl()({0:"ok",1:"not-located",2:"network-element-not-located",3:"element-not-traversable",4:"invalid-field-values",5:"not-reached",6:"time-window-violation",7:"not-located-on-closest"},{useNumericKeys:!0}),Lot=cl()({1:"right",2:"left"},{useNumericKeys:!0}),Not=cl()({0:"restriction",1:"scaled-cost",2:"added-cost"},{useNumericKeys:!0}),Rot=cl()({0:"permit",1:"restrict"},{useNumericKeys:!0}),Pot=cl()({1:"header",50:"arrive",51:"depart",52:"straight",100:"on-ferry",101:"off-ferry",102:"central-fork",103:"roundabout",104:"u-turn",150:"door",151:"stairs",152:"elevator",153:"escalator",154:"pedestrian-ramp",200:"left-fork",201:"left-ramp",202:"clockwise-roundabout",203:"left-handed-u-turn",204:"bear-left",205:"left-turn",206:"sharp-left",207:"left-turn-and-immediate-left-turn",208:"left-turn-and-immediate-right-turn",300:"right-fork",301:"right-ramp",302:"counter-clockwise-roundabout",303:"right-handed-u-turn",304:"bear-right",305:"right-turn",306:"sharp-right",307:"right-turn-and-immediate-left-turn",308:"right-turn-and-immediate-right-turn",400:"up-elevator",401:"up-escalator",402:"up-stairs",500:"down-elevator",501:"down-escalator",502:"down-stairs",1e3:"general-event",1001:"landmark",1002:"time-zone-change",1003:"traffic-event",1004:"scaled-cost-barrier-event",1005:"boundary-crossing",1006:"restriction-violation",1007:"lane"},{useNumericKeys:!0}),Fot=cl()({0:"unknown",1:"segment",2:"maneuver-segment",3:"restriction-violation",4:"scaled-cost-barrier",5:"heavy-traffic",6:"slow-traffic",7:"moderate-traffic"},{useNumericKeys:!0}),Dot=cl()({"NA Campus":"campus","NA Desktop":"desktop","NA Navigation":"navigation"}),$ot=cl()({Kilometers:"kilometers",Miles:"miles",Meters:"meters"},{ignoreUnknown:!1}),zot=cl()({Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),Uot=cl()({Kilometers:"kilometers",Miles:"miles",Meters:"meters",Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),Vot=cl()({"Any Hazmat Prohibited":"any-hazmat-prohibited","Avoid Carpool Roads":"avoid-carpool-roads","Avoid Express Lanes":"avoid-express-lanes","Avoid Ferries":"avoid-ferries","Avoid Gates":"avoid-gates","Avoid Limited Access Roads":"avoid-limited-access-roads","Avoid Private Roads":"avoid-private-roads","Avoid Roads Unsuitable for Pedestrians":"avoid-roads-unsuitable-for-pedestrians","Avoid Stairways":"avoid-stairways","Avoid Toll Roads":"avoid-toll-roads","Avoid Toll Roads for Trucks":"avoid-toll-roads-for-trucks","Avoid Truck Restricted Roads":"avoid-truck-restricted-roads","Avoid Unpaved Roads":"avoid-unpaved-roads","Axle Count Restriction":"axle-count-restriction","Driving a Bus":"driving-a-bus","Driving a Taxi":"driving-a-taxi","Driving a Truck":"driving-a-truck","Driving an Automobile":"driving-an-automobile","Driving an Emergency Vehicle":"driving-an-emergency-vehicle","Height Restriction":"height-restriction","Kingpin to Rear Axle Length Restriction":"kingpin-to-rear-axle-length-restriction","Length Restriction":"length-restriction","Preferred for Pedestrians":"preferred-for-pedestrians","Riding a Motorcycle":"riding-a-motorcycle","Roads Under Construction Prohibited":"roads-under-construction-prohibited","Semi or Tractor with One or More Trailers Prohibited":"semi-or-tractor-with-one-or-more-trailers-prohibited","Single Axle Vehicles Prohibited":"single-axle-vehicles-prohibited","Tandem Axle Vehicles Prohibited":"tandem-axle-vehicles-prohibited","Through Traffic Prohibited":"through-traffic-prohibited","Truck with Trailers Restriction":"truck-with-trailers-restriction","Use Preferred Hazmat Routes":"use-preferred-hazmat-routes","Use Preferred Truck Routes":"use-preferred-truck-routes",Walking:"walking","Weight Restriction":"weight-restriction"},{ignoreUnknown:!1}),Got=cl()({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),Bot=cl()({esriGeometryPoint:"point",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"envelope",esriGeometryMultipoint:"multipoint"}),qot=cl()({esriNAUTCost:"cost",esriNAUTDescriptor:"descriptor",esriNAUTRestriction:"restriction",esriNAUTHierarchy:"hierarchy"}),Hot=cl()({esriDSTAltName:"alt-name",esriDSTArrive:"arrive",esriDSTBranch:"branch",esriDSTCrossStreet:"cross-street",esriDSTCumulativeLength:"cumulative-length",esriDSTDepart:"depart",esriDSTEstimatedArrivalTime:"estimated-arrival-time",esriDSTExit:"exit",esriDSTGeneral:"general",esriDSTLength:"length",esriDSTServiceTime:"service-time",esriDSTStreetName:"street-name",esriDSTSummary:"summary",esriDSTTime:"time",esriDSTTimeWindow:"time-window",esriDSTToward:"toward",esriDSTViolationTime:"violation-time",esriDSTWaitTime:"wait-time"});let Wot=class extends(Gr(el)){constructor(t){super(t),this.attributeParameterValues=null,this.description=null,this.distanceAttributeName=null,this.id=null,this.impedanceAttributeName=null,this.name=null,this.restrictionAttributeNames=null,this.simplificationTolerance=null,this.simplificationToleranceUnits=null,this.timeAttributeName=null,this.type=null,this.useHierarchy=null,this.uturnAtJunctions=null}readId(t,e){return e.id??e.itemId??null}readRestrictionAttributes(t,e){const{restrictionAttributeNames:i}=e;return null==i?null:i.map((t=>Vot.fromJSON(t)))}writeRestrictionAttributes(t,e,i){null!=t&&(e[i]=t.map((t=>Vot.toJSON(t))))}};o([Us({type:[Object],json:{write:!0}})],Wot.prototype,"attributeParameterValues",void 0),o([Us({type:String,json:{write:!0}})],Wot.prototype,"description",void 0),o([ST($ot,{ignoreUnknown:!1})],Wot.prototype,"distanceAttributeName",void 0),o([Us({type:String,json:{write:!0}})],Wot.prototype,"id",void 0),o([al("id",["id","itemId"])],Wot.prototype,"readId",null),o([ST(Uot,{ignoreUnknown:!1})],Wot.prototype,"impedanceAttributeName",void 0),o([Us({type:String,json:{write:!0}})],Wot.prototype,"name",void 0),o([Us({type:[String],json:{write:!0}})],Wot.prototype,"restrictionAttributeNames",void 0),o([al("restrictionAttributeNames")],Wot.prototype,"readRestrictionAttributes",null),o([ll("restrictionAttributeNames")],Wot.prototype,"writeRestrictionAttributes",null),o([Us({type:Number,json:{write:{allowNull:!0}}})],Wot.prototype,"simplificationTolerance",void 0),o([ST(Sot)],Wot.prototype,"simplificationToleranceUnits",void 0),o([ST(zot,{ignoreUnknown:!1})],Wot.prototype,"timeAttributeName",void 0),o([ST(jot)],Wot.prototype,"type",void 0),o([Us({type:Boolean,json:{write:!0}})],Wot.prototype,"useHierarchy",void 0),o([ST(Aot)],Wot.prototype,"uturnAtJunctions",void 0),Wot=o([Nr("esri.rest.support.TravelMode")],Wot);const Zot=Wot;var Jot;let Kot=Jot=class extends(Gr(el)){constructor(t){super(t),this.accumulateAttributes=null,this.apiKey=null,this.attributeParameterValues=null,this.defaultBreaks=null,this.excludeSourcesFromPolygons=null,this.facilities=null,this.geometryPrecision=null,this.geometryPrecisionM=null,this.geometryPrecisionZ=null,this.ignoreInvalidLocations=null,this.impedanceAttribute=null,this.mergeSimilarPolygonRanges=!1,this.outputGeometryPrecision=null,this.outputGeometryPrecisionUnits=null,this.outputLines=null,this.outputPolygons=null,this.outSpatialReference=null,this.overlapLines=!1,this.overlapPolygons=!1,this.overrides=null,this.pointBarriers=null,this.polygonBarriers=null,this.polylineBarriers=null,this.preserveObjectID=null,this.restrictionAttributes=null,this.restrictUTurns=null,this.returnFacilities=!1,this.returnPointBarriers=!1,this.returnPolygonBarriers=!1,this.returnPolylineBarriers=!1,this.splitLinesAtBreaks=!1,this.splitPolygonsAtBreaks=!1,this.timeOfDay=null,this.timeOfDayIsUTC=null,this.travelDirection=null,this.travelMode=null,this.trimOuterPolygon=!1,this.trimPolygonDistance=null,this.trimPolygonDistanceUnits=null,this.useHierarchy=null}static from(t){return Ss(Jot,t)}readAccumulateAttributes(t){return null==t?null:t.map((t=>Uot.fromJSON(t)))}writeAccumulateAttributes(t,e,i){t?.length&&(e[i]=t.map((t=>Uot.toJSON(t))))}writeFacilities(t,e,i){Qot(t,e,i)}writePointBarriers(t,e,i){Qot(t,e,i)}writePolygonBarrier(t,e,i){Qot(t,e,i)}writePolylineBarrier(t,e,i){Qot(t,e,i)}readRestrictionAttributes(t){return null==t?null:t.map((t=>Vot.fromJSON(t)))}writeRestrictionAttributes(t,e,i){t?.length&&(e[i]=t.map((t=>Vot.toJSON(t))))}readTimeOfDay(t,e){const{timeOfDay:i}=e;return null==i?null:"now"===i?"now":new Date(i)}writeTimeOfDay(t,e){null!=t&&(e.timeOfDay="now"===t?"now":t.getTime())}};o([Us({type:[String],json:{name:"accumulateAttributeNames",write:!0}})],Kot.prototype,"accumulateAttributes",void 0),o([al("accumulateAttributes")],Kot.prototype,"readAccumulateAttributes",null),o([ll("accumulateAttributes")],Kot.prototype,"writeAccumulateAttributes",null),o([Us(bot)],Kot.prototype,"apiKey",void 0),o([Us({json:{write:!0}})],Kot.prototype,"attributeParameterValues",void 0),o([Us({type:[Number],json:{write:!0}})],Kot.prototype,"defaultBreaks",void 0),o([Us({type:[String],json:{write:!0}})],Kot.prototype,"excludeSourcesFromPolygons",void 0),o([Us({json:{write:!0}})],Kot.prototype,"facilities",void 0),o([ll("facilities")],Kot.prototype,"writeFacilities",null),o([Us({type:Number,json:{write:!0}})],Kot.prototype,"geometryPrecision",void 0),o([Us({type:Number,json:{write:!0}})],Kot.prototype,"geometryPrecisionM",void 0),o([Us({type:Number,json:{write:!0}})],Kot.prototype,"geometryPrecisionZ",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"ignoreInvalidLocations",void 0),o([ST(Uot,{name:"impedanceAttributeName",ignoreUnknown:!1})],Kot.prototype,"impedanceAttribute",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"mergeSimilarPolygonRanges",void 0),o([Us({type:Number,json:{write:!0}})],Kot.prototype,"outputGeometryPrecision",void 0),o([ST(Sot)],Kot.prototype,"outputGeometryPrecisionUnits",void 0),o([ST(kot)],Kot.prototype,"outputLines",void 0),o([ST(Tot)],Kot.prototype,"outputPolygons",void 0),o([Us({type:jd,json:{name:"outSR",write:!0}})],Kot.prototype,"outSpatialReference",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"overlapLines",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"overlapPolygons",void 0),o([Us({json:{write:!0}})],Kot.prototype,"overrides",void 0),o([Us({json:{name:"barriers",write:!0}})],Kot.prototype,"pointBarriers",void 0),o([ll("pointBarriers")],Kot.prototype,"writePointBarriers",null),o([Us({json:{write:!0}})],Kot.prototype,"polygonBarriers",void 0),o([ll("polygonBarriers")],Kot.prototype,"writePolygonBarrier",null),o([Us({json:{write:!0}})],Kot.prototype,"polylineBarriers",void 0),o([ll("polylineBarriers")],Kot.prototype,"writePolylineBarrier",null),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"preserveObjectID",void 0),o([Us({type:[String],json:{name:"restrictionAttributeNames",write:!0}})],Kot.prototype,"restrictionAttributes",void 0),o([al("restrictionAttributes")],Kot.prototype,"readRestrictionAttributes",null),o([ll("restrictionAttributes")],Kot.prototype,"writeRestrictionAttributes",null),o([ST(Aot)],Kot.prototype,"restrictUTurns",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"returnFacilities",void 0),o([Us({type:Boolean,json:{name:"returnBarriers",write:!0}})],Kot.prototype,"returnPointBarriers",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"returnPolygonBarriers",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"returnPolylineBarriers",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"splitLinesAtBreaks",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"splitPolygonsAtBreaks",void 0),o([Us({json:{write:!0}})],Kot.prototype,"timeOfDay",void 0),o([al("timeOfDay")],Kot.prototype,"readTimeOfDay",null),o([ll("timeOfDay")],Kot.prototype,"writeTimeOfDay",null),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"timeOfDayIsUTC",void 0),o([ST(Iot)],Kot.prototype,"travelDirection",void 0),o([Us({type:Zot,json:{write:!0}})],Kot.prototype,"travelMode",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"trimOuterPolygon",void 0),o([Us({type:Number,json:{write:!0}})],Kot.prototype,"trimPolygonDistance",void 0),o([ST(Sot)],Kot.prototype,"trimPolygonDistanceUnits",void 0),o([Us({type:Boolean,json:{write:!0}})],Kot.prototype,"useHierarchy",void 0),Kot=Jot=o([Nr("esri.rest.support.ServiceAreaParameters")],Kot);const Yot=Kot;function Qot(t,e,i){null!=t&&(e[i]=ty.isCollection(t)?{features:t.toArray().map((t=>t.toJSON()))}:t.toJSON())}let Xot=class extends el{constructor(t){super(t),this.dataType=null,this.name=null,this.parameterNames=null,this.restrictionUsageParameterName=null,this.timeNeutralAttributeName=null,this.trafficSupport=null,this.units=null,this.usageType=null}};o([Us({type:String})],Xot.prototype,"dataType",void 0),o([ST(Uot,{ignoreUnknown:!1})],Xot.prototype,"name",void 0),o([Us({type:[String]})],Xot.prototype,"parameterNames",void 0),o([Us({type:String})],Xot.prototype,"restrictionUsageParameterName",void 0),o([ST(zot,{ignoreUnknown:!1})],Xot.prototype,"timeNeutralAttributeName",void 0),o([Us({type:String})],Xot.prototype,"trafficSupport",void 0),o([ST(_ot)],Xot.prototype,"units",void 0),o([ST(qot)],Xot.prototype,"usageType",void 0),Xot=o([Nr("esri.rest.support.NetworkAttribute")],Xot);const tat=Xot;let eat=class extends el{constructor(t){super(t),this.buildTime=null,this.name=null,this.networkAttributes=null,this.networkSources=null,this.state=null}};o([Us({type:Number})],eat.prototype,"buildTime",void 0),o([Us({type:String})],eat.prototype,"name",void 0),o([Us({type:[tat]})],eat.prototype,"networkAttributes",void 0),o([Us()],eat.prototype,"networkSources",void 0),o([Us({type:String})],eat.prototype,"state",void 0),eat=o([Nr("esri.rest.support.NetworkDataset")],eat);const iat=eat;let nat=class extends el{constructor(t){super(t),this.accumulateAttributeNames=null,this.attributeParameterValues=null,this.currentVersion=null,this.defaultTravelMode=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsSupportedLanguages=null,this.directionsTimeAttribute=null,this.hasZ=null,this.impedance=null,this.networkDataset=null,this.supportedTravelModes=null}readAccumulateAttributes(t){return null==t?null:t.map((t=>Uot.fromJSON(t)))}writeAccumulateAttributes(t,e,i){t?.length&&(e[i]=t.map((t=>Uot.toJSON(t))))}get capabilities(){return{supportsNow:(this.currentVersion??10)>=10.81}}readDefaultTravelMode(t,e){const i=e.supportedTravelModes?.find((({id:t})=>t===e.defaultTravelMode))??e.supportedTravelModes?.find((({itemId:t})=>t===e.defaultTravelMode));return i?Zot.fromJSON(i):null}};o([Us()],nat.prototype,"accumulateAttributeNames",void 0),o([al("accumulateAttributeNames")],nat.prototype,"readAccumulateAttributes",null),o([ll("accumulateAttributeNames")],nat.prototype,"writeAccumulateAttributes",null),o([Us()],nat.prototype,"attributeParameterValues",void 0),o([Us()],nat.prototype,"capabilities",null),o([Us()],nat.prototype,"currentVersion",void 0),o([Us()],nat.prototype,"defaultTravelMode",void 0),o([al("defaultTravelMode",["defaultTravelMode","supportedTravelModes"])],nat.prototype,"readDefaultTravelMode",null),o([Us()],nat.prototype,"directionsLanguage",void 0),o([ST(xot)],nat.prototype,"directionsLengthUnits",void 0),o([Us()],nat.prototype,"directionsSupportedLanguages",void 0),o([ST(zot,{ignoreUnknown:!1})],nat.prototype,"directionsTimeAttribute",void 0),o([Us()],nat.prototype,"hasZ",void 0),o([ST(Uot,{ignoreUnknown:!1})],nat.prototype,"impedance",void 0),o([Us({type:iat})],nat.prototype,"networkDataset",void 0),o([Us({type:[Zot]})],nat.prototype,"supportedTravelModes",void 0),nat=o([Nr("esri.rest.support.NetworkServiceDescription")],nat);const sat=nat;const rat=()=>Ft.getLogger("esri.rest.networkService");function oat(t,e,i,n){n[i]=[e.length,e.length+t.length],t.forEach((t=>{e.push(t.geometry)}))}function aat(t,e){for(let i=0;i<e.length;i++){const n=t[e[i]];if(n&&n.length)for(const t of n)t.z=void 0}rat().warnOnce("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")}function lat(t,e){for(let i=0;i<e.length;i++){const n=t[e[i]];if(n&&n.length)for(const t of n)if(null!=t&&t.hasZ)return!0}return!1}async function uat(t,e,i){if(!t)throw new Qe("network-service:missing-url","Url to Network service is missing");const n=iV({f:"json",token:e},i),{data:s}=await hc(t,n),r=s.currentVersion>=10.4?hat(t,e,i):cat(t,i),{defaultTravelMode:o,supportedTravelModes:a}=await r;return s.defaultTravelMode=o,s.supportedTravelModes=a,sat.fromJSON(s)}async function cat(t,e){const i=iV({f:"json"},e),{data:n}=await hc(t.replace(/\/rest\/.*$/i,"/info"),i);if(!n?.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};const{owningSystemUrl:s}=n,r=Nu(s)+"/sharing/rest/portals/self",{data:o}=await hc(r,i),a=Mt("helperServices.routingUtilities.url",o);if(!a)return{supportedTravelModes:[],defaultTravelMode:null};const l=nV(s),u=/\/solve$/i.test(l.path)?"Route":/\/solveclosestfacility$/i.test(l.path)?"ClosestFacility":"ServiceAreas",c=iV({f:"json",serviceName:u},e),h=Nu(a)+"/GetTravelModes/execute",d=await hc(h,c),f=[];let p=null;if(d?.data?.results?.length){const t=d.data.results;for(const e of t)if("supportedTravelModes"===e.paramName){if(e.value?.features)for(const{attributes:t}of e.value.features)if(t){const e=JSON.parse(t.TravelMode);f.push(e)}}else"defaultTravelMode"===e.paramName&&(p=e.value)}return{supportedTravelModes:f,defaultTravelMode:p}}async function hat(t,e,i){try{const n=iV({f:"json",token:e},i),s=Nu(t)+"/retrieveTravelModes",{data:{supportedTravelModes:r,defaultTravelMode:o}}=await hc(s,n);return{supportedTravelModes:r,defaultTravelMode:o}}catch(t){throw new Qe("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:t})}}function dat(t,e){if(null==t)return null;const i={},n=new RegExp(`^${e}`,"i");for(const s of Object.keys(t))if(n.test(s)){const n=s.substring(e.length);i[Uot.fromJSON(n)]=t[s]}return i}function fat(t,e,i){if(null!=t){e.attributes||(e.attributes={});for(const n in t){const s=Uot.toJSON(n);e.attributes[`${i}${s}`]=t[n]}}}function pat(t){const e={};for(const i of Object.keys(t)){const n=i;e[Uot.fromJSON(n)]=t[i]}return e}function mat(t){const e={};for(const i of Object.keys(t)){const n=i;e[Uot.toJSON(n)]=t[i]}return e}function yat(t,e){return null==t||null==e?null:Math.round((t-e)/6e4)}function gat(t){const e=t.toJSON(),i=e;return i.accumulateAttributeNames&&=e.accumulateAttributeNames?.join(),i.attributeParameterValues&&=JSON.stringify(e.attributeParameterValues),i.barriers&&=JSON.stringify(e.barriers),i.outSR&&=e.outSR?.wkid,i.overrides&&=JSON.stringify(e.overrides),i.polygonBarriers&&=JSON.stringify(e.polygonBarriers),i.polylineBarriers&&=JSON.stringify(e.polylineBarriers),i.restrictionAttributeNames&&=e.restrictionAttributeNames?.join(),i.stops&&=JSON.stringify(e.stops),i.travelMode&&=JSON.stringify(e.travelMode),i}function vat(t){const e=t.toJSON(),i=e;return i.accumulateAttributeNames&&=e.accumulateAttributeNames?.join(),i.attributeParameterValues&&=JSON.stringify(e.attributeParameterValues),i.barriers&&=JSON.stringify(e.barriers),i.defaultBreaks&&=e.defaultBreaks?.join(),i.excludeSourcesFromPolygons&&=e.excludeSourcesFromPolygons?.join(),i.facilities&&=JSON.stringify(e.facilities),i.outSR&&=e.outSR?.wkid,i.overrides&&=JSON.stringify(e.overrides),i.polygonBarriers&&=JSON.stringify(e.polygonBarriers),i.polylineBarriers&&=JSON.stringify(e.polylineBarriers),i.restrictionAttributeNames&&=e.restrictionAttributeNames?.join(),i.travelMode&&=JSON.stringify(e.travelMode),i}const wat=new ul({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let bat=class extends el{constructor(t){super(t),this.description=null,this.type=null}};o([Us({type:String,json:{write:!0}})],bat.prototype,"description",void 0),o([Us({type:String,json:{read:wat.read,write:wat.write}})],bat.prototype,"type",void 0),bat=o([Nr("esri.rest.support.GPMessage")],bat);const Sat=bat;const xat=new ul({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});let _at=class extends Sat{constructor(t){super(t),this.type=null}};o([Us({type:String,json:{read:xat.read,write:xat.write}})],_at.prototype,"type",void 0),_at=o([Nr("esri.rest.support.NAMessage")],_at);const Mat=_at;let kat=class extends el{constructor(t){super(t),this.facilities=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.serviceAreaPolylines=null,this.serviceAreaPolygons=null}};o([Us({type:H6})],kat.prototype,"facilities",void 0),o([Us({type:[Mat]})],kat.prototype,"messages",void 0),o([Us({type:H6,json:{read:{source:"barriers"}}})],kat.prototype,"pointBarriers",void 0),o([Us({type:H6})],kat.prototype,"polylineBarriers",void 0),o([Us({type:H6})],kat.prototype,"polygonBarriers",void 0),o([Us({type:H6,json:{read:{source:"saPolylines"}}})],kat.prototype,"serviceAreaPolylines",void 0),o([Us({type:H6,json:{read:{source:"saPolygons"}}})],kat.prototype,"serviceAreaPolygons",void 0),kat=o([Nr("esri.rest.support.ServiceAreaSolveResult")],kat);const Tat=kat;function Aat(t){return t instanceof H6}async function Iat(t,e,i){const n=[],s=[],r={},o={},a=nV(t),{path:l}=a;Aat(e.facilities)&&oat(e.facilities.features,s,"facilities.features",r),Aat(e.pointBarriers)&&oat(e.pointBarriers.features,s,"pointBarriers.features",r),Aat(e.polylineBarriers)&&oat(e.polylineBarriers.features,s,"polylineBarriers.features",r),Aat(e.polygonBarriers)&&oat(e.polygonBarriers.features,s,"polygonBarriers.features",r);const u=await vV(s);for(const t in r){const e=r[t];n.push(t),o[t]=u.slice(e[0],e[1])}if(lat(o,n)){let t=null;try{t=await uat(l,e.apiKey,i)}catch{}t&&!t.hasZ&&aat(o,n)}for(const t in o)o[t].forEach(((i,n)=>{le(e,t)[n].geometry=i}));const c={...i,query:{...a.query,...vat(e),f:"json"}},{data:h}=await hc(`${l}/solveServiceArea`,c);return Tat.fromJSON(h)}const jat="esri-search",Cat={base:jat,widgetIcon:wK.search,hasMultipleSources:`${jat}--multiple-sources`,isLoading:`${jat}--loading`,isSearching:`${jat}--searching`,showSuggestions:`${jat}--show-suggestions`,showSources:`${jat}--sources`,showWarning:`${jat}--warning`,container:`${jat}__container`,input:`${jat}__input`,inputContainer:`${jat}__input-container`,form:`${jat}__form`,submitButton:`${jat}__submit-button`,sourcesButton:`${jat}__sources-button`,sourcesButtonDown:`${jat}__sources-button--down`,sourcesButtonUp:`${jat}__sources-button--up`,clearButton:`${jat}__clear-button`,sourceName:`${jat}__source-name`,suggestionsMenu:`${jat}__suggestions-menu`,suggestionList:`${jat}__suggestions-list`,suggestionListCurrentLocation:`${jat}__suggestions-list--current-location`,sourcesMenu:`${jat}__sources-menu`,source:`${jat}__source`,warningMenu:`${jat}__warning-menu`,warningMenuBody:`${jat}__warning-body`,warningMenuHeader:`${jat}__warning-header`,warningMenuText:`${jat}__warning-text`,noValueText:`${jat}__no-value-text`};const Eat="esri-search-result-renderer",Oat={base:Eat,showMoreResults:`${Eat}__more-results--show-more-results`,moreResults:`${Eat}__more-results`,moreResultsList:`${Eat}__more-results-list`,moreResultsHeader:`${Eat}__more-results-header`,moreResultsItem:`${Eat}__more-results-item`,moreResultsListHeader:`${Eat}__more-results-list-header`};const Lat=96;function Nat(t,e){const i=e||t.extent,n=t.width,s=hd(i?.spatialReference);return i&&n?i.width/n*s*qh*Lat:0}function Rat(t,e){return t/(hd(e)*qh*Lat)}function Pat(t,e){const i=t.extent,n=t.width-(t.padding?t.padding.left+t.padding.right:0),s=Rat(e,i.spatialReference);return i.clone().expand(s*n/i.width)}function Fat(t,e,i){return Dat(t,e)&&$at(t,i)}function Dat(t,e){return 0===e||xa(t,e)||t<e}function $at(t,e){return 0===e||xa(t,e)||t>e}function zat(t){switch(t?.type){case"point":return t;case"extent":return t.center;case"polygon":return t.centroid;case"multipoint":case"polyline":return t.extent?.center;default:return null}}async function Uat(t,e){if(t.hasZ||"2d"===e.type)return t;const i=e.map?.ground;if(!i?.layers.length)return t;const{geometry:n}=await i.queryElevation(t,{cache:e.basemapTerrain?.elevationQueryCache});return n}function Vat(t,e,i){return Bat(t.center,e,i)}function Gat(t,e,i){switch(t?.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return Bat(t,e,i);default:return null}}function Bat(t,e,i){const n=t.hasZ?t.z:void 0;if(e?.map){return(null!=i?Pat(e,i):e.extent).clone().centerAt(t).set({zmax:n,zmin:n})}const{x:s,y:r,spatialReference:o}=t;return new Rf({xmin:s-.25,ymin:r-.25,xmax:s+.25,ymax:r+.25,spatialReference:o,zmin:n,zmax:n})}function qat(t){return t&&"function"==typeof t.highlight}let Hat=class extends(PI(el)){constructor(t){super(t),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};o([Us()],Hat.prototype,"autoNavigate",void 0),o([Us()],Hat.prototype,"filter",void 0),o([Us()],Hat.prototype,"getResults",void 0),o([Us()],Hat.prototype,"getSuggestions",void 0),o([Us()],Hat.prototype,"maxResults",void 0),o([Us()],Hat.prototype,"maxSuggestions",void 0),o([Us()],Hat.prototype,"minSuggestCharacters",void 0),o([Us()],Hat.prototype,"outFields",void 0),o([Us()],Hat.prototype,"placeholder",void 0),o([Us()],Hat.prototype,"popupEnabled",void 0),o([Us()],Hat.prototype,"popupTemplate",void 0),o([Us()],Hat.prototype,"prefix",void 0),o([Us()],Hat.prototype,"resultGraphicEnabled",void 0),o([Us()],Hat.prototype,"resultSymbol",void 0),o([Us()],Hat.prototype,"suggestionsEnabled",void 0),o([Us()],Hat.prototype,"suffix",void 0),o([Us()],Hat.prototype,"withinViewEnabled",void 0),o([Us()],Hat.prototype,"zoomScale",void 0),Hat=o([Nr("esri.widgets.Search.SearchSource")],Hat);const Wat=Hat;const Zat=/https?:\/\/services.*\.arcgis\.com/i,Jat=/(?:\{([^}]+)\})/g,Kat=()=>Ft.getLogger("esri.widgets.Search.support.layerSearchUtils");function Yat(t,e){const{exactMatch:i=!1,location:n,maxResults:s,spatialReference:r,source:o,sourceIndex:a,suggestResult:l,view:u}=t,{layer:c,filter:h,zoomScale:d}=o,f=u?.scale,p=Xat(o,u),m=e?.signal;return elt(c).then((()=>{const t=c.popupTemplate;return t?t.getRequiredFields(c.fieldsIndex):null})).then((t=>{const{objectIdField:e,returnZ:y}=c,g=llt(o);if(!clt(c,g))throw Kat().error("invalid-field: displayField is invalid."),new Qe("getResults():invalid-field","displayField is invalid.");const v=t&&t.length?t:[g],w=o.outFields||v,b=tlt(w);w.includes(e)||b||w.push(e),c.floorInfo?.floorField&&w.push(c.floorInfo.floorField);if(!(b||ult(c,w)))throw Kat().error("invalid-field: outField is invalid."),new Qe("getResults():invalid-field","outField is invalid.");const S=c.createQuery(),{orderByFields:x}=o;if(x&&(S.orderByFields=x),r){S.outSpatialReference=r;const t=1/hd(r);t&&(S.maxAllowableOffset=t)}const _="mesh"===c.geometryType||"multipatch"===c.geometryType,M=c.capabilities?.data?.supportsZ&&!_;if(S.returnZ=M&&!1!==y,S.returnGeometry=!0,S.multipatchOption=_?"xyFootprint":null,w&&(S.outFields=w),n)S.geometry=n;else if(l.key)S.objectIds=[l.key];else{const t=o.searchFields||[g];if(!ult(c,t))throw Kat().error("invalid-field: search field is invalid."),new Qe("getResults():invalid-field","search field is invalid.");olt(c)&&(S.num=s),p&&(S.geometry=p);const e=l.text?.trim();if(!e)return[];const n=l.text,{prefix:r="",suffix:a=""}=o,u=flt(`${r}${n}${a}`);rlt(c)&&nlt(c,t)&&!i&&n&&(S.fullText=slt({text:n,searchFields:t}));const d=glt({searchTerm:u,layer:c,searchFields:t,filter:h,exactMatch:i,query:S,type:"search"});if(S.where=d,!ilt(S))return[]}return c.queryFeatures(S,{signal:m}).then((t=>klt(t,u,o,a,g,f,d)))}))}function Qat(t,e){const{source:i,spatialReference:n,view:s,suggestTerm:r,maxSuggestions:o,sourceIndex:a,exactMatch:l}=t,{layer:u,filter:c}=i,h=e?.signal,d=Xat(i,s);return elt(u).then((()=>{if(!olt(u))return[];const t=llt(i),e=i.searchFields||[t],s=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(Jat,((t,e)=>(s.push(e),t))):s.push(t);const f=tlt(s);s.includes(u.objectIdField)||f||s.push(u.objectIdField);const p=clt(u,t),m=f||ult(u,s),y=ult(u,e);if(!p)throw Kat().error("invalid-field: displayField is invalid."),new Qe("getSuggestions():invalid-field","displayField is invalid.");if(!m)throw Kat().error("invalid-field: outField is invalid."),new Qe("getSuggestions():invalid-field","outField is invalid.");if(!y)throw Kat().error("invalid-field: search field is invalid."),new Qe("getSuggestions():invalid-field","search field is invalid.");const g=u.createQuery(),{orderByFields:v}=i;v&&(g.orderByFields=v),g.outSpatialReference=n,g.returnGeometry=!1,g.num=o,g.outFields=s,d&&(g.geometry=d);if(!r.trim())return[];const{prefix:w="",suffix:b=""}=i,S=flt(`${w}${r}${b}`);rlt(u)&&nlt(u,e)&&!l&&r&&(g.fullText=slt({text:r,searchFields:e}));const x=glt({searchTerm:S,layer:u,searchFields:e,filter:c,exactMatch:l,query:g,type:"suggest"});return g.where=x,ilt(g)?u.queryFeatures(g,{signal:h}).then((e=>xlt(e,i,a,t))):[]}))}function Xat(t,e){const{filter:i,withinViewEnabled:n}=t,s=e?.extent,r=i?.geometry;return r??(n&&s?s:void 0)}function tlt(t){return t&&t.includes("*")}async function elt(t){t&&await t.load()}function ilt(t){return!(!t.fullText&&!t.where)}function nlt(t,e){const i=t?.indexes;if(!i||!e?.length)return!1;return i.filter((t=>"FullText"===t.indexType)).some((t=>{const i=t.fields?.split(",").map((t=>t.trim().toLowerCase()))||[];return e.every((t=>i.includes(t.toLowerCase())))}))}function slt({text:t,searchFields:e}){return t.trim().split(" ").filter((t=>!!t.trim())).map((t=>new ED({onFields:e,searchTerm:t,searchType:"prefix"})))}function rlt(t){return t?.capabilities?.query?.supportsFullTextSearch??!1}function olt(t){return t?.capabilities?.query?.supportsPagination??!1}function alt(t){return t?.fieldsIndex?.fields?.find((t=>"string"===t.type))?.name??""}function llt(t){return t.displayField||t.layer.displayField||alt(t.layer)}function ult(t,e){return!(!t||!e?.length)&&e.every((e=>clt(t,e)))}function clt(t,e){return!!t.getField(e)}function hlt(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function dlt({codedValues:t},e,i){return qt(t??[],(t=>{const n=t.name,s=i?n:n.toLowerCase();return(i?e:e.toLowerCase())===s?t.code.toString():null}))??null}function flt(t){return t.replaceAll("'","''")}function plt(t,e){const i=e?.where;return i?`(${t}) AND (${i})`:t}function mlt({currentTerm:t,field:e,filter:i,exactMatch:n,url:s,type:r}){const o=e?.type,a=e?.name;if("string"===o||"date"===o||"global-id"===o){const e=Zat.test(s??""),o=e&&hlt(t)?"N":"";if(n&&"search"===r)return plt(`${a} = ${o}'${t}'`,i);if(e){return plt(`${a} LIKE ${o}${`'${t}%'`}`,i)}return plt(`${`LOWER(${a})`} LIKE ${o}${`'${t.toLowerCase()}%'`}`,i)}if("oid"===o||"small-integer"===o||"integer"===o||"single"===o||"double"===o){const e=Number(t);return isNaN(e)?null:plt(`${a} = ${e}`,i)}return plt(`${a} = ${t}`,i)}function ylt(t,e){return t?` OR (${e})`:`(${e})`}function glt({searchTerm:t,layer:e,searchFields:i,filter:n,exactMatch:s,query:r,type:o}){const{definitionExpression:a,url:l}=e;let u="";return!r.fullText&&t&&i&&i.forEach((i=>{const r=e.getField(i),a="function"==typeof e.getFieldDomain&&e.getFieldDomain(i),c=(a&&"coded-value"===a.type?dlt(a,t,s):null)||t||null;if(null!==c){const t=mlt({currentTerm:c,field:r,filter:n,exactMatch:s,url:l,type:o});t&&(u+=ylt(u,t))}})),a&&u?`(${a}) AND (${u})`:a||u}function vlt(t,e){let i=null;const{codedValues:n}=t;return n&&n.length&&n.some((t=>t.code===e&&(i=t.name,!0))),i}function wlt(t,e){return t[e]??t[Object.keys(t).find((t=>t.toLowerCase()===e.toLowerCase()))]}function blt(t,e,i){const n=t.sourceLayer,{attributes:s}=t,r="function"==typeof n.getFieldDomain&&n.getFieldDomain(i);if(e)return sv(e,s);if(i&&s){const t=n.getField(i),e=wlt(s,i);return null==e?"":r&&"coded-value"===r.type?vlt(r,e)??"":"date"===t?.type?Hg(new Date(e)):"number"==typeof e?e.toString():"string"!=typeof e?"":e.trim()}return""}function Slt(t,e,i,n){const s=t.sourceLayer,{attributes:r}=t,{objectIdField:o}=s,a=o?r[o]:null;return{text:blt(t,e.suggestionTemplate,n),key:a,sourceIndex:i}}function xlt(t,e,i,n){return t.features.map((t=>Slt(t,e,i,n)))}function _lt(t){return null!=t&&null!=t.minScale&&null!=t.maxScale}function Mlt(t,e,i,n,s,r,o){const a=t.clone(),l=t.sourceLayer,u=l?.objectIdField,c=u?t.attributes[u]:null,h=blt(t,i.searchTemplate,s);null!=r&&_lt(l)&&(l.minScale&&l.minScale<r?r=l.minScale:l.maxScale&&l.maxScale>r&&(r=l.maxScale));const d=a.geometry?Gat(a.geometry,e??void 0,r??void 0):void 0,f="number"==typeof o&&d?Vat(ht(d),e??void 0,o):d,p=t.clone();return null!=f&&(p.geometry=pm.fromExtent(f)),{extent:f,target:p,feature:a,key:c,name:h,sourceIndex:n}}function klt(t,e,i,n,s,r,o){return t.features.map((t=>Mlt(t,e,i,n,s,r,o)))}var Tlt;let Alt=Tlt=class extends Wat{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(t,e)=>Yat({source:this,...t},e),this.getSuggestions=(t,e)=>Qat({source:this,...t},e)}set layer(t){this._set("layer",t),t&&t.load().catch((()=>{}))}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new Tlt({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?ht(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?ht(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find((t=>"string"===t.type))?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;if(!t.loaded)return"";return`: ${(e||[this._getDisplayField()]).map((e=>{const i=t.getField(e);return i?.alias||e})).join(", ")}`}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};o([Us({json:{read:{source:"field.name"},write:{target:"field.name"}}})],Alt.prototype,"displayField",void 0),o([Us({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],Alt.prototype,"exactMatch",void 0),o([Us({value:null})],Alt.prototype,"layer",null),o([Us()],Alt.prototype,"name",null),o([Us({type:[String],json:{write:!0}})],Alt.prototype,"orderByFields",void 0),o([Us()],Alt.prototype,"searchFields",void 0),o([Us()],Alt.prototype,"searchTemplate",void 0),o([Us()],Alt.prototype,"suggestionTemplate",void 0),Alt=Tlt=o([Nr("esri.widgets.Search.LayerSearchSource")],Alt);const Ilt=Alt;function jlt(t){return!!t&&"number"==typeof t.x&&"number"==typeof t.y}function Clt(t){return t&&"number"==typeof t.xmin&&"number"==typeof t.ymin&&"number"==typeof t.xmax&&"number"==typeof t.ymax}let Elt=class extends el{constructor(t){super(t),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};o([Us({type:String,json:{write:!0}})],Elt.prototype,"address",void 0),o([Us({type:Object,json:{write:!0}})],Elt.prototype,"attributes",void 0),o([Us({type:Rf,json:{write:!0}})],Elt.prototype,"extent",void 0),o([Us({type:Qd,json:{write:!0}})],Elt.prototype,"location",void 0),o([Us({type:Number,json:{write:!0}})],Elt.prototype,"score",void 0),Elt=o([Nr("esri.rest.support.AddressCandidate")],Elt);const Olt=Elt;let Llt=class extends el{constructor(t){super(t),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};o([Us({type:Object,json:{write:!0}})],Llt.prototype,"address",void 0),o([Us(bot)],Llt.prototype,"apiKey",void 0),o([Us({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Llt.prototype,"categories",void 0),o([Us({type:String,json:{write:!0}})],Llt.prototype,"countryCode",void 0),o([Us({type:Boolean,json:{write:!0}})],Llt.prototype,"forStorage",void 0),o([Us({type:Qd,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Llt.prototype,"location",void 0),o([Us({type:String,json:{write:!0}})],Llt.prototype,"locationType",void 0),o([Us({type:String,json:{write:!0}})],Llt.prototype,"magicKey",void 0),o([Us({type:Number,json:{write:!0}})],Llt.prototype,"maxLocations",void 0),o([Us({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],Llt.prototype,"outFields",void 0),o([Us({type:jd,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Llt.prototype,"outSpatialReference",void 0),o([Us({type:Rf,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=i}}}})],Llt.prototype,"searchExtent",void 0),Llt=o([Nr("esri.rest.support.AddressToLocationsParameters")],Llt),Llt.from=ks(Llt);const Nlt=Llt;async function Rlt(t,e,i){e=Nlt.from(e);const n=nV(t),{address:s,...r}=e.toJSON(),o={...s,...r,f:"json"},a=sV({...n.query,...o}),l=iV(a,i),u=`${n.path}/findAddressCandidates`;return hc(u,l).then(Plt)}function Plt({data:t}){if(!t)return[];const{candidates:e,spatialReference:i}=t;return e?e.map((t=>{if(!t)return;const{extent:e,location:n}=t,s=!e||Clt(e);return jlt(n)&&s?(e&&(e.spatialReference=i),n&&(n.spatialReference=i),Olt.fromJSON(t)):void 0})):[]}let Flt=class extends el{constructor(t){super(t),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null}};o([Us(bot)],Flt.prototype,"apiKey",void 0),o([Us({type:Qd,json:{write:{writer:(t,e)=>{const i=t?t.clone().normalize():null,n=void 0!==i;e.location=n?i:null}}}})],Flt.prototype,"location",void 0),o([Us({type:String,json:{write:!0}})],Flt.prototype,"locationType",void 0),o([Us({type:jd,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Flt.prototype,"outSpatialReference",void 0),Flt=o([Nr("esri.rest.support.LocationToAddressParameters")],Flt),Flt.from=ks(Flt);const Dlt=Flt;async function $lt(t,e,i){e=Dlt.from(e);const n=nV(t),s={...e.toJSON(),f:"json"},r=sV({...n.query,...s}),o=iV(r,i),a=`${n.path}/reverseGeocode`;return hc(a,o).then(zlt)}function zlt({data:t}){if(!t)return;const{address:e,location:i}=t,n=e?.Match_addr||"";return Olt.fromJSON({address:n,attributes:e||{},location:i,score:100})}let Ult=class extends el{constructor(t){super(t),this.isCollection=null,this.magicKey=null,this.text=null}};o([Us({type:Boolean,json:{write:!0}})],Ult.prototype,"isCollection",void 0),o([Us({type:String,json:{write:!0}})],Ult.prototype,"magicKey",void 0),o([Us({type:String,json:{write:!0}})],Ult.prototype,"text",void 0),Ult=o([Nr("esri.rest.support.SuggestionCandidate")],Ult);const Vlt=Ult;let Glt=class extends el{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};o([Us(bot)],Glt.prototype,"apiKey",void 0),o([Us({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Glt.prototype,"categories",void 0),o([Us({type:String,json:{write:!0}})],Glt.prototype,"countryCode",void 0),o([Us({type:Qd,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Glt.prototype,"location",void 0),o([Us({type:Number,json:{write:!0}})],Glt.prototype,"maxSuggestions",void 0),o([Us({type:jd,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Glt.prototype,"outSpatialReference",void 0),o([Us({type:Rf,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(i)}}}})],Glt.prototype,"searchExtent",void 0),o([Us({type:String,json:{write:!0}})],Glt.prototype,"text",void 0),Glt=o([Nr("esri.rest.support.SuggestLocationsParameters")],Glt),Glt.from=ks(Glt);const Blt=Glt;async function qlt(t,e,i){const n=nV(t),s={...(e=Blt.from(e)).toJSON(),f:"json"},r=sV({...n.query,...s}),o=iV(r,i),a=`${n.path}/suggest`;return hc(a,o).then(Hlt)}function Hlt(t){const{data:e}=t;if(!e)return[];const{suggestions:i}=e;return i?i.map((t=>new Vlt(t))):[]}const Wlt="Single Line Input",Zlt=3e5;function Jlt(t,e){return t.location?iut(t,e):sut(t,e)}function Klt(t,e){if(e.localSearchDisabled)return null;const i=t?.scale;return"number"==typeof i&&i<=Zlt?t?.extent?.center:null}async function Ylt(t,e){const{source:i,spatialReference:n,view:s,suggestTerm:r,maxSuggestions:o,sourceIndex:a}=t,l=new Blt,{apiKey:u,url:c}=i,h=nut(i,s),d=e?.signal;if(!c)return null;u&&(l.apiKey=u),i.categories&&(l.categories=i.categories),n&&(l.outSpatialReference=n);const f=Klt(s,i);f&&(l.location=f);if(!r.trim())return null;const{prefix:p="",suffix:m=""}=i,y=`${p}${r}${m}`;return l.text=y,h&&(l.searchExtent=h),l.maxSuggestions=o,i.countryCode&&(l.countryCode=i.countryCode),qlt(c,l,{signal:d}).then((t=>out(t,a)))}function Qlt(t){return!!t&&/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Xlt(t){return!!t&&/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function tut(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const eut="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function iut(t,e){const{source:i,spatialReference:n,location:s,sourceIndex:r,view:o}=t,{apiKey:a,url:l,zoomScale:u,defaultZoomScale:c}=i;if(null==l)return[];const h=o?.scale,d=e?.signal,f=new Dlt;f.location=s,a&&(f.apiKey=a),n&&(f.outSpatialReference=n);try{return lut([await $lt(l,f,{signal:d})],{sourceIndex:r,scale:h,view:o,zoomScale:u,defaultZoomScale:c})}catch(t){return[]}}function nut(t,e){const{filter:i,withinViewEnabled:n}=t,s=e?.scale,r=e?.extent,o=i?.geometry;return(o?Gat(o,e??void 0,s):void 0)||(n&&r?r:void 0)}async function sut(t,e){const{source:i,suggestResult:n,spatialReference:s,view:r,maxResults:o,sourceIndex:a}=t,l=i?.zoomScale,u=i?.defaultZoomScale,c=n.text?.trim();if(!c)return null;const h=!n.key&&i.prefix?i.prefix:"",d=!n.key&&i.suffix?i.suffix:"",f=`${h}${n.text}${d}`,p=new Nlt,{apiKey:m,url:y}=i,g=r?.scale,v=nut(i,r),w=e?.signal;if(m&&(p.apiKey=m),!y)return null;i.categories&&(p.categories=i.categories),i.locationType&&(p.locationType=i.locationType),s&&(p.outSpatialReference=s);const b=Klt(r,i);b&&(p.location=b),p.maxLocations=o,v&&(p.searchExtent=v),i.countryCode&&(p.countryCode=i.countryCode);const{key:S}=n,x=`${S}`;return S&&(p.magicKey=x),p.address={},p.address[i.singleLineFieldName||Wlt]=f,i.outFields&&(p.outFields=i.outFields),Rlt(y,p,{signal:w}).then((t=>lut(t,{key:x,scale:g,sourceIndex:a,view:r,zoomScale:l,defaultZoomScale:u})))}function rut(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function out(t,e){return t.map((t=>rut(t,e)))}function aut(t,e){const{key:i,scale:n,sourceIndex:s,view:r,zoomScale:o,defaultZoomScale:a}=e,{attributes:l,extent:u,location:c,address:h}=t,d=new NF({geometry:c,attributes:l}),f=u||c,p=f?Gat(f,r??void 0,n??void 0):void 0,m=p?"number"==typeof o?Vat(p,r??void 0,o):"number"==typeof a&&"point"===f?.type?Vat(p,r??void 0,a):p:null,y=c?`${c.x},${c.y}`:"",g=h||y,v=d.clone();return null!=m&&(v.geometry=pm.fromExtent(m)),{extent:m,feature:d,target:v,key:i,name:g,sourceIndex:s}}function lut(t,e){return t.filter(Boolean).map((t=>aut(t,e)))}var uut;const cut="esri.widgets.Search.LocatorSearchSource";let hut=uut=class extends Wat{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(t,e)=>Jlt({source:this,...t},e),this.getSuggestions=(t,e)=>Ylt({source:this,...t},e)}clone(){return new uut({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?ht(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?ht(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};o([Us()],hut.prototype,"apiKey",void 0),o([Us()],hut.prototype,"categories",void 0),o([Us()],hut.prototype,"countryCode",void 0),o([Us({json:{write:!0}})],hut.prototype,"defaultZoomScale",void 0),o([Us()],hut.prototype,"localSearchDisabled",void 0),o([Us()],hut.prototype,"locationType",void 0),o([Us({json:{write:!0}})],hut.prototype,"name",void 0),o([Us({json:{write:!0}})],hut.prototype,"placeholder",void 0),o([Us()],hut.prototype,"searchTemplate",void 0),o([Us({json:{write:!0}})],hut.prototype,"singleLineFieldName",void 0),o([Us({json:{read:{source:"suggest"},write:{target:"suggest"}}})],hut.prototype,"suggestionsEnabled",void 0),o([Us({json:{write:!0}})],hut.prototype,"url",void 0),o([Us({json:{write:!0}})],hut.prototype,"zoomScale",void 0),hut=uut=o([Nr(cut)],hut);const dut=hut;const fut=()=>Ft.getLogger("esri.widgets.support.geolocationUtils"),put={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function mut(){const t=c("esri-geolocation");return t||fut().warn("geolocation-unsupported","Geolocation unsupported."),t}function yut(){const t=window.isSecureContext;return t||fut().warn("insecure-context","Geolocation requires a secure origin."),t}function gut(){return mut()&&yut()}function vut(t){const e=15e3;return t||(t=put),new Promise(((i,n)=>{setTimeout((()=>n(new Qe("geolocation:timeout","getting the current geolocation position timed out"))),e),navigator.geolocation.getCurrentPosition(i,n,t??void 0)}))}function wut(t,e){const{position:i,view:n}=t,s=but(i),r=s?.coords;if(!r)throw new Qe("geometry-service:no-coords","Geolocation has no coordinates");return xut(Sut(r),n,e)}function but(t){const e=t&&t.coords||{},i={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed};return t?{coords:i,timestamp:t.timestamp}:t}function Sut({longitude:t,latitude:e,altitude:i}){return new Qd({longitude:t,latitude:e,z:i||void 0,spatialReference:{wkid:4326}})}function xut(t,e,i){if(!e)return Promise.resolve(t);const n=e.spatialReference;return n.isWGS84?Promise.resolve(t):n.isWebMercator?Promise.resolve(Hd(t)):_ut(i).then((e=>{if(!e)throw new Qe("geometry-service:missing-url","Geometry service URL is missing");const s=new vrt({geometries:[t],outSpatialReference:n});return brt(e,s,i).then((t=>t[0]))}))}function _ut(t){if(It.geometryServiceUrl)return Promise.resolve(It.geometryServiceUrl);const e=YM.getDefault();return e.load(t).catch((()=>{})).then((()=>e.helperServices?.geometry?.url))}function Mut(t,e){return t.hasOwnProperty(e)&&null!=t[e]&&""!==t[e]}const kut=()=>yv("esri/widgets/Search/t9n/Search"),Tut="highlight",Aut=ty.ofType({key:t=>t.layer?"layer":"locator",base:Wat,typeMap:{layer:Ilt,locator:dut}}),Iut=jd.WGS84,jut="esri/images/search/search-symbol-32.png",Cut=/<[\s\S]*?>/g,Eut=-1;let Out=class extends(eY(Pm.EventedMixin(Vr))){constructor(t){super(t),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new Aut,this.defaultSymbols={point:new YP({url:Nc(jut),size:24,width:24,height:24}),polyline:new QL({color:[130,130,130,1],width:2}),polygon:new uF({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=YM.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new Aut,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const t=async()=>{const t=await kut();this.messages=t,this.defaultPopupTemplate=new pL({title:t.searchResult,content:"{Match_addr}"})};t(),this.addHandles([fy((()=>[this.includeDefaultSources,this.view,this.portal]),(()=>this._update()),_y),og(t)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return 1===this.allSources.length||!this.searchAllEnabled?0:Eut}set activeSourceIndex(t){this._overrideIfSome("activeSourceIndex",t)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(t){this._overrideIfSome("allPlaceholder",t)}get allSources(){const{sources:t,defaultSources:e,includeDefaultSources:i}=this,n="function"==typeof i?i.call(null,{sources:t,defaultSources:e}):i?e.concat(t):t,s=this._get("allSources")||new Aut;return s.removeAll(),s.addMany(n.filter(Boolean)),s}get locationEnabled(){return this._get("locationEnabled")||gut()}set locationEnabled(t){if(void 0===t)return void this._clearOverride("locationEnabled");const e=gut();if(t&&!e){const t=new Qe("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});Ft.getLogger(this).error(t)}this._override("locationEnabled",!!t&&e)}get placeholder(){const{allSources:t,activeSourceIndex:e,allPlaceholder:i}=this;if(e===Eut)return i??"";const n=t.at(e);return n?.placeholder??""}set searchTerm(t){this._set("searchTerm",t||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==t&&this._set("selectedSuggestion",null),""===t&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:t,resultGraphic:e}=this;t&&e&&t.graphics.remove(e),this._set("resultGraphic",null)}search(t,e){this.emit("search-start"),this.clearGraphics();const i=this._createSuggestionForSearch(t),n=(async()=>{try{await this.when();const t=await this._getResultsFromSources(i,e);if(e?.signal?.aborted)return null;const n={activeSourceIndex:this.activeSourceIndex,searchTerm:i.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(n,t,i);const s=this._getFirstResult(n.results),r=i.location&&s?s.name:i.text,o=r?.replace(Cut,"");return this._set("searchTerm",o),(i.key&&"number"==typeof i.sourceIndex||i.location)&&this._set("selectedSuggestion",i),this._set("results",n.results),this._set("resultCount",n.results.reduce(((t,e)=>t+(e.results?.length??0)),0)),this.emit("search-complete",n),await this._selectFirstResult(s),n}finally{this._clearSearching()}})();return this._searching=n,n}async searchNearby(t){if(!this.locationEnabled){const t=new Qe("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw Ft.getLogger(this).error(t),t}const e=(async()=>{try{const e=await vut(),i=await wut({position:e,view:this.view},t);return await this.search(i,t)}finally{this._clearSearching()}})();return this._searching=e,e}async select(t){if(this.clearGraphics(),!t){const e=new Qe("select:missing-parameter","Cannot select without a searchResult.",{searchResult:t});throw Ft.getLogger(this).error(e),e}const{view:e}=this,i=Mut(t,"sourceIndex")?t.sourceIndex:this._getSourceIndexOfResult(t),n=null!=i?this.allSources.at(i):null;if(!n){const t=new Qe("select:missing-source","Cannot select without a source.",{source:n});throw Ft.getLogger(this).error(t),t}const s=n instanceof Ilt?this._getLayerSourcePopupTemplate(n):n.popupTemplate,r=n.resultSymbol||this._getDefaultSymbol(t),o=Mut(n,"resultGraphicEnabled")?n.resultGraphicEnabled:this.resultGraphicEnabled,a=Mut(n,"autoNavigate")?n.autoNavigate:this.autoNavigate,l=(Mut(n,"popupEnabled")?n.popupEnabled:this.popupEnabled)?s||this.popupTemplate||this.defaultPopupTemplate:null,{feature:u}=t;if(!u){const t=new Qe("select:missing-feature","Cannot select without a feature.",{feature:u});throw Ft.getLogger(this).error(t),t}const{attributes:c,geometry:h,layer:d,sourceLayer:f}=u,p=h?zat(h):null,m={layerViewQuery:this._getLayerView(u),elevationQuery:e&&null!=p?Uat(p,e):Promise.resolve(p)},y=await Di(m),g=y.layerViewQuery.value,v=y.elevationQuery.value;r instanceof yF&&(r.text=t.name);const w=e&&a?t.target||t.extent:null,b=null!=w?this._goToSearchResult(w):Promise.resolve();await b;const S=g?u:new NF({geometry:h,symbol:r,attributes:c,layer:d,sourceLayer:f,popupTemplate:l}),x=e?.popup,_=x&&S.getEffectivePopupTemplate(x.defaultPopupTemplateEnabled);return _&&await e.openPopup({features:[S],location:v}),g&&qat(g)&&!_&&this._highlightFeature({graphic:S,layerView:g}),!g&&o&&e&&e.graphics.push(S),this._setResultFloor(t),this._set("selectedResult",t),this._set("resultGraphic",S),this.emit("select-result",{result:t,source:n,sourceIndex:i}),t}async suggest(t,e,i){const n=t||this.searchTerm;this.emit("suggest-start",{searchTerm:n}),await this._suggestTimer(e,i);const s=await this._suggestImmediate(n,i);return this._set("suggestions",s?.results),this._set("suggestionCount",s?.results.reduce(((t,e)=>t+(e.results?.length??0)),0)??null),this.emit("suggest-complete",s),s}async when(){await gy((()=>!this.updating))}async _update(){const{portal:t,view:e}=this;if(this.includeDefaultSources){const i=this._updatingPromise=Di([t?.load(),e?.when()]);if(this.destroyed)return;if(await i,i!==this._updatingPromise)return}await gy((()=>this.messages)),this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const t=this.portal?.helperServices?.geocode;if(!t)return[];return t.map((t=>{if(!1===t.placefinding)return;const e=It.apiKey&&tut(t.url)?{url:eut}:null,i=dut.fromJSON({...t,...e}),n=i.url;if(tut(n)||Xlt(n)||Qlt(n)){const t=i.outFields??["Addr_type","Match_addr","StAddr","City"],e=(i.placeholder||this.messages?.placeholder)??"",n="number"==typeof i.defaultZoomScale?i.defaultZoomScale:2500;i.singleLineFieldName="SingleLine",i.outFields=t,i.placeholder=e,i.defaultZoomScale=n}return i.singleLineFieldName?i:void 0})).filter(F)}_destroyFeatureLayers(){this._createdFeatureLayers.forEach((t=>t?.destroy())),this._createdFeatureLayers=[]}_getLayerSources(t,e){const i=this.view?.map;return t.map((t=>{const n=i.findLayerById(t.id);if(!n)return;const s=this._getLayerJSON(t),r=Ilt.fromJSON(s);return r.placeholder=e,this._getLayer(n,s).then((t=>{r.layer=t})),r})).filter(F).toArray()}_getTableSources(t,e){const i=this.view?.map;return t.map((t=>{if(!t.id)return;const n=i.findTableById(t.id);if(!n)return;const s=this._getLayerJSON(t),r=Ilt.fromJSON(s);return r.placeholder=e,this._getLayer(n,s).then((t=>{r.layer=t})),r})).filter(F).toArray()}_convertApplicationProperties(){const t=this.view?.map,e=t?.applicationProperties?.viewing?.search;if(!e)return[];const{enabled:i,hintText:n,layers:s,tables:r}=e;if(!i)return[];return[...this._getLayerSources(s,n),...this._getTableSources(r,n)]}async _getSubLayer(t,e){if(await t.load(),!t.allSublayers)throw new Error;const i=t.allSublayers.find((t=>t.id===e.subLayer));if(!i)throw new Error;const n=await(i.createFeatureLayer?.());if(!n)throw new Error;return this._createdFeatureLayers.push(n),n}async _getBuildingSubLayer(t,e){await t.load();const i=t.allSublayers.find((t=>t.id===e.subLayer));if("building-component"!==i?.type)throw new Error;if(await i.load(),null==i.associatedLayer)throw new Error;return await i.associatedLayer.load(),i}async _getLayer(t,e){if("feature"===t.type||"scene"===t.type||"csv"===t.type||"geojson"===t.type||"ogc-feature"===t.type)return t;if("map-image"===t.type)try{return await this._getSubLayer(t,e)}catch(e){const i=new Qe("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:t});return Ft.getLogger(this).error(i),null}return"building-scene"===t.type?this._getBuildingSubLayer(t,e):null}_getLayerJSON(t){return"function"==typeof t.toJSON?t.toJSON():t}_updateDefaultSources(){const{defaultSources:t,includeDefaultSources:e}=this;this._destroyFeatureLayers(),t.removeAll(),e&&t.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){const t=this.view?.popup,{resultGraphic:e}=this;if(!t||!e)return;const i="selectedFeature"in t,n=i?t.selectedFeature:null;i&&(n&&n===e)&&t.close()}_suggestTimer(t,e){const i=null!=t?t:this.suggestionDelay;return Ui(i,null,e?.signal)}_createLocationForSearch(t){return t instanceof NF&&t.geometry?zat(t.geometry):t instanceof Qd?t:Array.isArray(t)&&2===t.length?new Qd({longitude:t[0],latitude:t[1]}):null}_createSuggestionForSearch(t){if(t&&Mut(t,"key")&&Mut(t,"text")&&Mut(t,"sourceIndex"))return t;const e=this._createLocationForSearch(t),i="string"==typeof t?t:this.searchTerm,{selectedSuggestion:n,selectedResult:s}=this,r=!t&&n&&s,o=r&&n.key===s.key&&n.sourceIndex===s.sourceIndex,a=r&&n.location;return o||a?n:{location:e,text:e?"":i,sourceIndex:null,key:null}}_getFirstResult(t){return qt(t,(({results:t})=>t?.[0]))??null}async _selectFirstResult(t){return this.autoSelect&&t?this.select(t):null}async _suggestImmediate(t,e){await this.when();const i=await this._getSuggestionsFromSources(t,e);if(e?.signal?.aborted)return null;const n={activeSourceIndex:this.activeSourceIndex,searchTerm:t??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(n,i),n}_formatSourceResponse(t,e,i){const n=e?.value||[],s=e?.error,r=this.allSources.at(i);if(s){const e={sourceIndex:i,source:r,error:s};t.errors.push(e),Ft.getLogger(this).error(s),t.numErrors++}else{const e={sourceIndex:i,source:r,results:n};t.results.push(e),t.numResults+=n.length}}_formatResponse(t,e,i){if(e)if(t.activeSourceIndex===Eut){const n=i&&Mut(i,"sourceIndex")&&-1!==i.sourceIndex?i.sourceIndex:void 0;e.forEach(((e,i)=>{const s=void 0!==n?n:i;this._formatSourceResponse(t,e,s)}))}else this._formatSourceResponse(t,e[0],t.activeSourceIndex)}async _getResultsFromSources(t,e){const{allSources:i}=this,n=!t.location&&Mut(t,"sourceIndex")?t.sourceIndex:this.activeSourceIndex,s=[];if(!i.length){const t=new Qe("search:no-sources-defined","At least one source is required.",{allSources:i});throw Ft.getLogger(this).error(t),t}return n===Eut?i.forEach(((i,n)=>{s.push(this._getResultsFromSource(t,n,e))})):s.push(this._getResultsFromSource(t,n,e)),Di(s)}async _getSuggestionsFromSources(t,e){const{allSources:i,activeSourceIndex:n}=this,s=[];if(!i.length){const t=new Qe("suggest:no-sources-defined","At least one source is required.",{allSources:i});throw Ft.getLogger(this).error(t),t}return n===Eut?i.forEach(((i,n)=>{s.push(this._getSuggestionsFromSource(t,n,e))})):s.push(this._getSuggestionsFromSource(t,n,e)),Di(s)}async _getResultsFromSource(t,e,i){const n=null!=e?this.allSources.at(e):null;if(!n)return null;const{location:s=null}=t,r=this.view?.spatialReference||Iut,o=Mut(n,"maxResults")?n.maxResults:this.maxResults,a=!!(n instanceof Ilt&&Mut(n,"exactMatch"))&&n.exactMatch,{view:l}=this;return n.getResults?.({view:l,sourceIndex:e,location:s,suggestResult:t,spatialReference:r,exactMatch:a,maxResults:o},i)}async _getSuggestionsFromSource(t,e,i){const n=this.allSources.at(e);if(!n)return null;t??="";const s=Mut(n,"suggestionsEnabled")?n.suggestionsEnabled:this.suggestionsEnabled,r=t?.length,o=Mut(n,"minSuggestCharacters")?n.minSuggestCharacters:this.minSuggestCharacters;if(s&&t.trim()&&r>=o){const s=this.view?.spatialReference||Iut,r=Mut(n,"maxSuggestions")?n.maxSuggestions:this.maxSuggestions,{view:o}=this,a=!!(n instanceof Ilt&&Mut(n,"exactMatch"))&&n.exactMatch;return n.getSuggestions?.({view:o,sourceIndex:e,suggestTerm:t,spatialReference:s,maxSuggestions:r,exactMatch:a},i)}return null}_getLayerSourcePopupTemplate(t){const{layer:e}=t;if(e)return Mut(t,"popupTemplate")?t.popupTemplate:e.popupTemplate}_getSourceIndexOfResult(t){return qt(this.results??[],(({results:e,sourceIndex:i})=>{const n=e?.includes(t);return n?i:null}))??null}async _goToSearchResult(t){this._abortGoTo();const e=new AbortController;this._gotoController=e;const i={target:{target:t},options:{signal:e.signal}};t||(i.options.animate=!1),await this.callGoTo(i),this._gotoController=null}_getDefaultSymbol(t){const{defaultSymbols:e}=this,i=t.feature?.geometry;if(null==i)return null;switch(i.type){case"point":case"multipoint":return e.point;case"polyline":return e.polyline;case"extent":case"polygon":return e.polygon;default:return null}}_removeHighlight(){this.removeHandles(Tut)}async _getLayerView(t){const{view:e}=this;if(!t||!e||"building-component"===t.layer?.type||"subtype-sublayer"===t.layer?.type)return null;const{layer:i}=t;return i?(await e.when(),e.whenLayerView(i)):null}_highlightFeature(t){const{graphic:e,layerView:i}=t,{attributes:n,layer:s}=e,{objectIdField:r}=s,o=(r&&n?.[r])??null,a=i.highlight(o??e);this.addHandles(a,Tut)}_setResultFloor(t){const{view:e}=this,i=t.feature?.attributes,n=t.feature?.sourceLayer;if(n&&"floorInfo"in n&&n?.floorInfo?.floorField&&i){const t=i[n.floorInfo.floorField];e?.emit("select-result-floor",t)}}};Out.ALL_INDEX=Eut,o([Us()],Out.prototype,"_searching",void 0),o([Us()],Out.prototype,"_updatingPromise",void 0),o([Us({readOnly:!0,value:null})],Out.prototype,"activeSource",null),o([Us()],Out.prototype,"activeSourceIndex",null),o([Us()],Out.prototype,"allPlaceholder",null),o([Us({readOnly:!0})],Out.prototype,"allSources",null),o([Us()],Out.prototype,"autoNavigate",void 0),o([Us()],Out.prototype,"autoSelect",void 0),o([Us()],Out.prototype,"defaultPopupTemplate",void 0),o([Us({readOnly:!0})],Out.prototype,"defaultSources",void 0),o([Us()],Out.prototype,"defaultSymbols",void 0),o([Us()],Out.prototype,"includeDefaultSources",void 0),o([Us()],Out.prototype,"locationEnabled",null),o([Us()],Out.prototype,"maxInputLength",void 0),o([Us()],Out.prototype,"maxResults",void 0),o([Us()],Out.prototype,"maxSuggestions",void 0),o([Us()],Out.prototype,"messages",void 0),o([Us()],Out.prototype,"minSuggestCharacters",void 0),o([Us({readOnly:!0})],Out.prototype,"placeholder",null),o([Us()],Out.prototype,"popupEnabled",void 0),o([Us({type:pL})],Out.prototype,"popupTemplate",void 0),o([Us({type:YM})],Out.prototype,"portal",void 0),o([Us()],Out.prototype,"resultCount",void 0),o([Us()],Out.prototype,"resultGraphicEnabled",void 0),o([Us({readOnly:!0})],Out.prototype,"resultGraphic",void 0),o([Us({readOnly:!0})],Out.prototype,"results",void 0),o([Us({readOnly:!0})],Out.prototype,"selectedSuggestion",void 0),o([Us()],Out.prototype,"searchAllEnabled",void 0),o([Us({readOnly:!0})],Out.prototype,"selectedResult",void 0),o([Us()],Out.prototype,"searchTerm",null),o([Us({type:Aut})],Out.prototype,"sources",void 0),o([Us({readOnly:!0})],Out.prototype,"state",null),o([Us()],Out.prototype,"suggestionDelay",void 0),o([Us()],Out.prototype,"suggestionCount",void 0),o([Us({readOnly:!0})],Out.prototype,"suggestions",void 0),o([Us()],Out.prototype,"suggestionsEnabled",void 0),o([Us({readOnly:!0})],Out.prototype,"updating",null),o([Us()],Out.prototype,"view",void 0),o([Us()],Out.prototype,"clear",null),Out=o([Nr("esri.widgets.Search.SearchViewModel")],Out);const Lut=Out;let Nut=class extends CK{constructor(t,e){super(t,e),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const t={[Oat.showMoreResults]:this.showMoreResultsOpen};return ZK("div",{class:this.classes(Oat.base,zK.widget)},ZK("div",{class:this.classes(Oat.moreResults,t),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return ZK("div",{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){const t=this.viewModel?.selectedResult,e=t?.name||"";return ZK("div",{class:Oat.moreResultsItem,key:"esri-search-renderer__result-name"},e)}_renderMoreResultsLists(){const{viewModel:t}=this;if(!t)return[];const e=t.results;if((t.resultCount??0)<2)return null;const i=e?.map((t=>this._renderMoreResultsList(t)));return ZK("div",{class:Oat.moreResultsList,key:"esri-search-renderer__more-results-container"},i)}_renderMoreResultsButton(){const{messages:t,viewModel:e}=this;if(!e)return null;return(e.resultCount??0)<2?null:ZK("div",{class:Oat.moreResultsItem,key:"esri-search-renderer__more-results-button"},ZK("a",{bind:this,class:zK.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?t.hideMoreResults:t.showMoreResults))}_renderMoreResultsHeader(t,e){return ZK("div",{class:Oat.moreResultsListHeader,key:`esri-search-result-renderer__header-${e}`},t)}_renderMoreResultsList(t){const{results:e}=t,i=e?.length??0,n=i>0,s=this.viewModel?.selectedResult,r=1===i&&e[0]===s,o=this._getSourceName(t.source,t.sourceIndex),a=(this.viewModel?.results?.length??0)>1&&!r?this._renderMoreResultsHeader(o,t.sourceIndex):null,l=n&&e.map(((t,e)=>this._renderMoreResultsListItem(t,e))),u=n&&!r?ZK("ul",{key:`esri-search-result-renderer__list-${t.sourceIndex}`},l):null;return n?ZK("div",{key:`esri-search-result-renderer__results-${t.sourceIndex}`},a,u):null}_renderMoreResultsListItem(t,e){const i=this.viewModel?.selectedResult;return t!==i?ZK("li",{key:`esri-search-result-renderer__list-item-${e}`},ZK("a",{bind:this,class:zK.anchor,"data-result":t,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},t.name)):null}_showMoreResultsClick(t){t.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const e=this.viewModel?.view?.popup;e&&"reposition"in e&&e.reposition()}_selectResultClick(t){t.preventDefault();const e=t.currentTarget["data-result"];this.viewModel?.select(e)}_getSourceName(t,e){return e===Lut.ALL_INDEX?this.messages.all:t.name}};o([Us(),BK("esri/widgets/Search/t9n/Search")],Nut.prototype,"messages",void 0),o([Us()],Nut.prototype,"showMoreResultsOpen",void 0),o([Us()],Nut.prototype,"viewModel",void 0),o([UK()],Nut.prototype,"_showMoreResultsClick",null),o([UK()],Nut.prototype,"_selectResultClick",null),Nut=o([Nr("esri.widgets.Search.SearchResultRenderer")],Nut);const Rut=Nut;function Put(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const i=e._delegatedEventNames,n=Array.isArray(t)?t:Fut(t);i.push(...n)}}function Fut(t){return t.split(",").map((t=>t.trim()))}const Dut=/<[a-z/][\s\S]*>/i,$ut=(t,e)=>{const i=Ot(e).split(/\s/),n=new RegExp(`(${i.join("|")})`,"gi");return t.replace(n,(t=>`<strong>${t}</strong>`))};let zut=class extends CK{constructor(t,e){super(t,e),this._activeMenuItemIndex=-1,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new Rut,this._suggestController=null,this._searchController=null,this._locateFailed=!1,this._container=null,this.activeMenu="none",this.disabled=!1,this.iconClass=Cat.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.viewModel=new Lut,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=t=>{const e=t.relatedTarget;e&&this._container?.contains(e)||this._clearActiveMenu()},this.addHandles([fy((()=>this.searchTerm),(t=>{(t&&"warning"===this.activeMenu||!t&&!this.viewModel?.selectedSuggestion?.location)&&this._clearActiveMenu()})),yy((()=>this.viewModel?.allSources),"change",(()=>this._watchSourceChanges())),fy((()=>this.activeMenu),(()=>this._resetActiveMenuItemIndex()),_y),fy((()=>this.viewModel?.defaultPopupTemplate),(t=>{t&&(t.content=this._renderSearchResultsContent.bind(this))}),_y)])}destroy(){this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer=$t(this._searchResultRenderer)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(t){this.viewModel.activeSourceIndex=t}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(t){this.viewModel.allPlaceholder=t}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(t){this.viewModel.autoNavigate=t}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(t){this.viewModel.autoSelect=t}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(t){this.viewModel.includeDefaultSources=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(t){this.viewModel.locationEnabled=t}get maxResults(){return this.viewModel.maxResults}set maxResults(t){this.viewModel.maxResults=t}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(t){this.viewModel.maxSuggestions=t}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(t){this.viewModel.minSuggestCharacters=t}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(t){this.viewModel.popupEnabled=t}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(t){this.viewModel.popupTemplate=t}get portal(){return this.viewModel?.portal}set portal(t){this.viewModel&&(this.viewModel.portal=t)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(t){this.viewModel.resultGraphic=t}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(t){this.viewModel.resultGraphicEnabled=t}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(t){this.viewModel.searchAllEnabled=t}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(t){this.viewModel.searchTerm=t}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(t){this.viewModel.sources=t}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(t){this.viewModel.suggestionsEnabled=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}clear(){this.viewModel.clear()}focus(){this._inputNode?.focus(),this.emit("search-focus")}blur(){this._inputNode?.blur(),this.emit("search-blur")}async search(t){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:i}=e;this._searchController=e;try{const n=await this.viewModel.search(t,{signal:i});if(this._searchController!==e)return;return this.activeMenu=n?.numResults?"none":"warning",this._searchController=null,n}catch(t){if(this._searchController!==e)return;return this._clearActiveMenu(),void(this._searchController=null)}}async suggest(t){this._cancelSuggest();const e=new AbortController,{signal:i}=e;this._suggestController=e;try{const n=await this.viewModel.suggest(t,null,{signal:i});if(this._suggestController!==e)return;return this._suggestController=null,n?.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),n}catch(t){return this._suggestController!==e||(this._suggestController=null),null}}render(){const{state:t}=this.viewModel,e={[zK.disabled]:"disabled"===t,[zK.widgetDisabled]:this.disabled};return ZK("div",{class:this.classes(Cat.base,zK.widget,e)},"loading"===t?this._renderLoader():this._renderContainer())}_renderSubmitButton(){const{messages:t,disabled:e}=this;return ZK("button",{"aria-label":t.searchButtonTitle,bind:this,class:this.classes(Cat.submitButton,zK.widgetButton),disabled:e,key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:t.searchButtonTitle,type:"button"},ZK("span",{"aria-hidden":"true",class:wK.search}))}_renderWarningMenu(){return ZK("div",{class:this.classes(zK.menu,Cat.warningMenu),key:"esri-search__error-menu"},ZK("div",{class:Cat.warningMenuBody},this._renderWarning()))}_renderSourceMenuButton(){const{messages:t,activeMenu:e,sourceMenuId:i,sourceMenuButtonId:n,disabled:s}=this,{activeSourceIndex:r,allSources:o}=this.viewModel;return o.length>1?ZK("button",{afterCreate:Hx,"aria-controls":i,"aria-expanded":("source"===e).toString(),"aria-haspopup":"true","aria-label":t.searchIn,bind:this,class:this.classes(Cat.sourcesButton,zK.widgetButton),"data-node-ref":"_sourceMenuButtonNode",disabled:s,id:n,key:"esri-search__source-menu-button",onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,title:t.searchIn,type:"button"},ZK("span",{"aria-hidden":"true",class:this.classes(wK.downArrow,Cat.sourcesButtonDown)}),ZK("span",{"aria-hidden":"true",class:this.classes(wK.upArrow,Cat.sourcesButtonUp)}),ZK("span",{class:Cat.sourceName},this._getSourceName(r))):null}_renderSourcesList(){const{allSources:t,searchAllEnabled:e}=this.viewModel,{_activeMenuItemIndex:i,activeMenu:n,sourceMenuId:s,sourceMenuButtonId:r}=this,o="source"===n&&i>-1?this._buildId("source-item",i):null;return t.length>1?ZK("ul",{afterCreate:Hx,"aria-activedescendant":o,"aria-labelledby":r,bind:this,class:zK.menuList,"data-node-ref":"_sourceListNode",id:s,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,role:"menu",tabIndex:-1},e?this._renderSource(Lut.ALL_INDEX):null,t.map(((t,e)=>this._renderSource(e))).toArray()):null}_renderSourcesMenu(){const{allSources:t}=this.viewModel;return t.length>1?ZK("div",{class:this.classes(zK.menu,Cat.sourcesMenu),key:"esri-search__source-menu"},this._renderSourcesList()):null}_renderLoader(){const{messages:t,messagesCommon:e,disabled:i}=this;return ZK("div",{class:zK.loader,key:"base-loader",tabIndex:i?-1:void 0},ZK("span",{"aria-hidden":"true",class:zK.loaderAnimation}),ZK("span",{class:wK.fontFallbackText},t.searchButtonTitle),ZK("span",{class:zK.loaderText},e.loading))}_renderContainer(){const{allSources:t,state:e}=this.viewModel,{activeMenu:i}=this,n={[Cat.hasMultipleSources]:t.length>1,[Cat.isLoading]:"loading"===e,[Cat.isSearching]:"searching"===e,[Cat.showWarning]:"warning"===i,[Cat.showSources]:"source"===i,[Cat.showSuggestions]:"suggestion"===i};return ZK("div",{afterCreate:t=>{this._container=t,t.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:t=>{t.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes(n,Cat.container),key:"base-container",tabIndex:-1},this._renderSourceMenuButton(),this._renderSourcesMenu(),this._renderInputContainer(),this._renderSubmitButton(),this._renderWarningMenu())}_renderClearButton(){return this.searchTerm?ZK("button",{bind:this,class:this.classes(Cat.clearButton,zK.widgetButton),disabled:this.disabled,key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},ZK("span",{"aria-hidden":"true",class:wK.close})):null}_renderLocationGroup(){const{messages:t,locationEnabled:e,displayedSearchTerm:i}=this,n=e&&!i,s="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return n?ZK("ul",{class:this.classes(zK.menuList,Cat.suggestionList,Cat.suggestionListCurrentLocation),key:"esri-search__suggestion-list-current-location",role:"group"},ZK("li",{"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),bind:this,class:this.classes(zK.menuItem,s?zK.menuItemFocus:null),"data-current-location-item":!0,id:this._buildId("suggestion-item",0),onclick:this._handleUseCurrentLocationClick,role:"option"},ZK("span",{"aria-hidden":"true",class:wK.locateCircled})," ",t.useCurrentLocation)):null}_renderInput(){const{activeMenu:t,locationEnabled:e,displayedSearchTerm:i,messages:n,suggestionsMenuId:s,inputId:r,_activeMenuItemIndex:o,disabled:a}=this,{maxInputLength:l,placeholder:u,searchTerm:c,suggestionCount:h}=this.viewModel,d=!(!(e&&!i)&&!h),f="suggestion"===t&&o>-1?this._buildId("suggestion-item",o):null;return ZK("input",{afterCreate:Hx,"aria-activedescendant":f,"aria-autocomplete":"list","aria-controls":d?s:null,"aria-expanded":(d&&"suggestion"===t).toString(),"aria-haspopup":"listbox","aria-label":n.searchButtonTitle,autocomplete:"off",bind:this,class:this.classes(zK.input,Cat.input),"data-node-ref":"_inputNode",disabled:a,id:r,maxlength:l,onblur:this.blur,onclick:this._openSuggestionMenu,onfocus:this.focus,oninput:this._handleInputPaste,onkeyup:this._handleInputKeyup,onpaste:this._handleInputPaste,placeholder:u,role:"combobox",title:c?"":u,type:"text",value:c})}_renderForm(){return ZK("form",{bind:this,class:Cat.form,disabled:this.disabled,key:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this._renderInput())}_renderSuggestList(t){const{sourceIndex:e}=t,{results:i}=t,n=i?.length;return n?ZK("ul",{class:this.classes(zK.menuList,Cat.suggestionList),key:`esri-search__suggestion-list-${e}`,role:"group"},i?.map((t=>this._renderSuggestion(t,this._menuItemCount++)))):null}_renderSuggestionsGroup(){const{suggestions:t}=this.viewModel;return t?t.map((t=>[this._renderSuggestionHeader(t),this._renderSuggestList(t)])):[]}_renderSuggestionsMenu(){const{displayedSearchTerm:t,locationEnabled:e,suggestionsMenuId:i,inputId:n}=this,{suggestionCount:s}=this.viewModel,r=e&&!t||s;return this._menuItemCount=0,r?ZK("div",{afterCreate:Hx,"aria-labelledby":n,bind:this,class:this.classes(zK.menu,Cat.suggestionsMenu),"data-node-ref":"_suggestionListNode",id:i,key:"esri-search__suggestions-menu",role:"listbox"},this._renderLocationGroup(),this._renderSuggestionsGroup()):null}_renderInputContainer(){return ZK("div",{class:Cat.inputContainer,key:"esri-search__input-container"},this._renderForm(),this._renderSuggestionsMenu(),this._renderClearButton())}_renderSuggestionHeader(t){const{allSources:e,activeSourceIndex:i}=this.viewModel,{sourceIndex:n}=t,s=t.results?.length,r=e.length>1&&i===Lut.ALL_INDEX;return s&&r?ZK("div",{class:zK.menuHeader,key:`esri-search__suggestion-header-${n}`},this._getSourceName(n)):null}_renderSuggestion(t,e){const{_activeMenuItemIndex:i,viewModel:{searchTerm:n}}=this;if(!n)return;const s="suggestion"===this.activeMenu&&i===e;return ZK("li",{"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===e).toString(),bind:this,class:this.classes(zK.menuItem,s?zK.menuItemFocus:null),"data-suggestion":t,id:this._buildId("suggestion-item",e),innerHTML:this._getSuggestResultHTML(t.text,n),key:`esri-search__suggestion_${e}`,onclick:this._handleSuggestionClick,role:"option"})}_renderSource(t){const{activeSourceIndex:e,searchAllEnabled:i}=this.viewModel,n={[zK.menuItemActive]:t===e,[zK.menuItemFocus]:"source"===this.activeMenu&&t===(i?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},s=i?t+1:t;return ZK("li",{"aria-checked":(t===e).toString(),bind:this,class:this.classes(Cat.source,zK.menuItem,n),"data-source-index":t,id:this._buildId("source-item",s),key:`esri-search__source-${t}`,onclick:this._handleSourceClick,role:"menuitemradio"},this._getSourceName(t))}_renderNoResultsWarning(t){const{messages:e}=this,i=t?sv(e.noResultsFoundForValue,{value:`"${t}"`}):e.noResultsFound;return ZK("div",{key:"esri-search__no_results"},ZK("div",{class:Cat.warningMenuHeader},e.noResults),ZK("div",{class:Cat.warningMenuText},i))}_renderEmptySearchWarning(){const{messages:t}=this;return ZK("div",{key:"esri-search__empty-search"},ZK("span",{"aria-hidden":"true",class:wK.noticeTriangle}),ZK("span",{class:Cat.noValueText},t.emptyValue))}_renderLocateWarning(){const{messages:t}=this;return ZK("div",{key:"esri-search__locate-error"},ZK("span",{"aria-hidden":"true",class:wK.noticeTriangle}),ZK("span",{class:Cat.noValueText},t.locateError))}_renderWarning(){const{displayedSearchTerm:t,_locateFailed:e}=this,{viewModel:i}=this;return e?this._renderLocateWarning():i.selectedSuggestion?.location||t?this._renderNoResultsWarning(t):this._renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(t,e){return`${this.id}-${t}${void 0===e?"":`-${e}`}`}_watchSourceChanges(){const{viewModel:{allSources:t}}=this,e="sources";this.removeHandles(e),t.forEach((t=>this.addHandles(fy((()=>t.name),(()=>this.scheduleRender())),e)))}_handleSourcesMenuToggleFocus(){"source"!==this.activeMenu&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){const t="source"===this.activeMenu;this.activeMenu=t?"none":"source",this.renderNow(),"source"===this.activeMenu&&this._sourceListNode?.focus()}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(t){const e=Uut(t.currentTarget);e&&(this._focus(),this.search(e))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const t=new AbortController,{signal:e}=t;this._searchController=t;(async()=>{try{const t=await this.viewModel.searchNearby({signal:e});this.activeMenu=t?.numResults?"none":"warning"}catch(t){this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(t){this._setSourceFromMenuItem(t.currentTarget)}_setSourceFromMenuItem(t){if(!t)return;const e=Vut(t);null!=e&&(this.viewModel.activeSourceIndex=e,this._clearActiveMenu(),this._sourceMenuButtonNode?.focus())}_cancelSuggest(){this._suggestController=Vt(this._suggestController)}_cancelSearch(){this._searchController=Vt(this._searchController),this._locateFailed=!1}_handleInputKeyup(t){const{key:e}=t;if(t.ctrlKey||t.metaKey||"Copy"===e||"ArrowLeft"===e||"ArrowRight"===e||"Shift"===e)return;if("Tab"===e||"Escape"===e||t.shiftKey&&"Tab"===e)return this._cancelSuggest(),void("Escape"===e&&this._clearActiveMenu());const i="Home"===e||"End"===e||"ArrowUp"===e||"ArrowDown"===e;if("Enter"===e&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const n=this._suggestionListNode?.getElementsByTagName("li");if(n?.length){if("suggestion"!==this.activeMenu&&this._openSuggestionMenu(),i)return t.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(e,n,this._suggestionListNode);const s=n[this._activeMenuItemIndex];if("Enter"===e&&s){const t=Uut(s);return void(t?(this._focus(),this.search(t)):Gut(s)&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}_handleItemNavigation(t,e,i){const n=this._activeMenuItemIndex;"Home"===t&&(this._activeMenuItemIndex=0),"End"===t&&(this._activeMenuItemIndex=e.length-1),"ArrowUp"===t&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?e.length-1:this._activeMenuItemIndex-1),"ArrowDown"===t&&(this._activeMenuItemIndex=this._activeMenuItemIndex===e.length-1?0:this._activeMenuItemIndex+1),n!==this._activeMenuItemIndex&&i&&Yx(e[this._activeMenuItemIndex],i)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(t){const e=t.target;this.viewModel.searchTerm!==e.value&&(this.viewModel.searchTerm=e.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(t){const{key:e}=t;if(Qx(e)){t.preventDefault();const e=this._sourceListNode?.getElementsByTagName("li"),i=e?.[this._activeMenuItemIndex];this._setSourceFromMenuItem(i)}else"ArrowUp"!==e&&"ArrowDown"!==e&&"End"!==e&&"Home"!==e||t.preventDefault()}_handleSourceMenuKeyup(t){const{key:e}=t,i="ArrowUp"===e||"ArrowDown"===e||"End"===e||"Home"===e;if(i&&t.preventDefault(),"Escape"===e)return this._clearActiveMenu(),void this._sourceMenuButtonNode?.focus();const n=this._sourceListNode?.getElementsByTagName("li");return n&&0!==n.length&&i?("source"!==this.activeMenu&&(this.activeMenu="source"),void this._handleItemNavigation(e,n,this._sourceListNode?.parentElement)):void 0}_focus(t){this.focus(),t&&(this.activeMenu=t)}_formSubmit(t){t.preventDefault(),-1===this._activeMenuItemIndex&&this.search()}_getSourceName(t){const{messages:e}=this,i=this.viewModel,{allSources:n}=i,s=n.at(t);return t===Lut.ALL_INDEX?e.all:s&&s.name||e.untitledSource}_getSuggestResultHTML(t,e){return t?Dut.test(t)?t:$ut(t,e):this.messages.untitledResult}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};function Uut(t){return t?.["data-suggestion"]}function Vut(t){return t?.["data-source-index"]}function Gut(t){return!!t?.["data-current-location-item"]}o([Us()],zut.prototype,"_activeMenuItemIndex",void 0),o([Us()],zut.prototype,"displayedSearchTerm",null),o([Us({readOnly:!0})],zut.prototype,"inputId",null),o([Us({readOnly:!0})],zut.prototype,"suggestionsMenuId",null),o([Us({readOnly:!0})],zut.prototype,"sourceMenuId",null),o([Us({readOnly:!0})],zut.prototype,"sourceMenuButtonId",null),o([Us()],zut.prototype,"activeMenu",void 0),o([Us({readOnly:!0})],zut.prototype,"activeSource",null),o([Us()],zut.prototype,"activeSourceIndex",null),o([Us()],zut.prototype,"allPlaceholder",null),o([Us({readOnly:!0})],zut.prototype,"allSources",null),o([Us()],zut.prototype,"autoNavigate",null),o([Us()],zut.prototype,"autoSelect",null),o([Us({readOnly:!0})],zut.prototype,"defaultSources",null),o([Us()],zut.prototype,"disabled",void 0),o([Us()],zut.prototype,"goToOverride",null),o([Us()],zut.prototype,"iconClass",void 0),o([Us()],zut.prototype,"icon",void 0),o([Us()],zut.prototype,"includeDefaultSources",null),o([Us()],zut.prototype,"label",null),o([Us()],zut.prototype,"locationEnabled",null),o([Us()],zut.prototype,"maxResults",null),o([Us()],zut.prototype,"maxSuggestions",null),o([Us(),BK("esri/widgets/Search/t9n/Search")],zut.prototype,"messages",void 0),o([Us(),BK("esri/t9n/common")],zut.prototype,"messagesCommon",void 0),o([Us()],zut.prototype,"minSuggestCharacters",null),o([Us()],zut.prototype,"popupEnabled",null),o([Us()],zut.prototype,"popupTemplate",null),o([Us()],zut.prototype,"portal",null),o([Us()],zut.prototype,"resultGraphic",null),o([Us()],zut.prototype,"resultGraphicEnabled",null),o([Us({readOnly:!0})],zut.prototype,"results",null),o([Us()],zut.prototype,"searchAllEnabled",null),o([Us()],zut.prototype,"searchTerm",null),o([Us({readOnly:!0})],zut.prototype,"selectedResult",null),o([Us()],zut.prototype,"sources",null),o([Us({readOnly:!0})],zut.prototype,"suggestions",null),o([Us()],zut.prototype,"suggestionsEnabled",null),o([Us()],zut.prototype,"view",null),o([Put(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),Us({type:Lut})],zut.prototype,"viewModel",void 0),zut=o([Nr("esri.widgets.Search")],zut);const But=zut;function qut(t){return t.icon?t.icon:"image"in t&&t.image||t.className?void 0:"question"}function Hut(t){return t?{backgroundImage:`url(${t})`}:{}}function Wut({action:t,feature:e}){const i=e?.attributes,n="image"in t?t.image:void 0;return n&&i?sv(n,i):n??""}const Zut="esri-layer-list",Jut=`${Zut}__item`,Kut={base:Zut,widgetIcon:wK.layers,filterNoResults:`${Zut}__filter-no-results`,item:Jut,itemActive:`${Jut}--active`,itemContent:`${Jut}-content`,itemContentBottom:`${Jut}-content-bottom`,itemMessage:`${Jut}-message`,itemInvisibleAtScale:`${Jut}--invisible-at-scale`,itemActionIcon:`${Jut}-action-icon`,itemActionImage:`${Jut}-action-image`,itemTemporaryIcon:`${Jut}-temporary-icon`,statusIndicator:`${Zut}__status-indicator`,publishing:`${Zut}__publishing`,updating:`${Zut}__updating`,connectionStatus:`${Zut}__connection-status`,connectionStatusConnected:`${Zut}__connection-status--connected`,visibleToggle:`${Zut}__visible-toggle`,visibleIcon:`${Zut}__visible-icon`};var Yut;let Qut=Yut=class extends eL{constructor(t){super(t),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new Yut({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};o([Us()],Qut.prototype,"displayValueEnabled",void 0),o([Us()],Qut.prototype,"max",void 0),o([Us()],Qut.prototype,"min",void 0),o([Us()],Qut.prototype,"step",void 0),o([Us()],Qut.prototype,"value",void 0),Qut=Yut=o([Nr("esri.support.Action.ActionSlider")],Qut);const Xut=Qut;const tct={hide:"hide",hideChildren:"hide-children"},ect="root",ict=10,nct=2;function sct({exclusive:t,visible:e,visibilityAppearance:i}){const n="checkbox"===i;return e?t?"circle-f":n?"check-square-f":"view-visible":t?"circle":n?"square":"view-hide"}function rct({connectionStatus:t,publishing:e}){return t?"connected"===t?"beacon":"offline":e?"square":"bullet-point"}function oct(t){return!!t&&t.listMode===tct.hideChildren}function act(t){if(t)return null!=t.listMode?t.listMode:void 0}function lct(t){return null!=t&&"minScale"in t&&null!=t.minScale?t.minScale:void 0}function uct(t){return null!=t&&"maxScale"in t&&null!=t.maxScale?t.maxScale:void 0}function cct(t){if(!t)return"inherited";const e=bct(wct(t)?t.layer:t);return null!=e?e?"independent":"inherited":"visibilityMode"in t&&null!=t.visibilityMode?t.visibilityMode:"independent"}function hct(t){if(!(!t||"type"in t&&"wmts"===t.type||oct(t)))return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function dct(t){const e=(t?.layer&&wct(t.layer)?t.layer.layer:void 0)??t?.layer;return!!e&&(Sct(e)??!0)}function fct(t){return act(t)!==tct.hide}function pct(t,e){if(!t||null==e||isNaN(e))return!1;const i=lct(t),n=uct(t),s=null!=i&&!isNaN(i)&&i>0&&e>i,r=null!=n&&!isNaN(n)&&n>0&&e<n;return s||r}function mct(t,e){t?.sort(((t,i)=>{const n="uid"in t?e.indexOf(t.uid):-1,s="uid"in i?e.indexOf(i.uid):-1;return n>s?-1:n<s?1:0}))}function yct(t,e){const i=t?.layer;if(!i)return;const n=hct(i);if(!n)return;let s;"layers"===n&&"layers"in i?s=i.layers:"sublayers"===n&&"sublayers"in i&&(s=i.sublayers),mct(s,e)}function gct(t){const e=t?.layer;return e&&"layers"in e?e.layers:null}function vct(t){const e=wct(t)?t:null,i=t?.parent,n=null!=i&&"type"in i&&"map-image"===i.type?e?.source:null,s="";return n&&i?{layer:i,title:s,sublayerIds:[n.mapLayerId]}:{layer:t,title:s}}function wct(t){return null!=t&&"layer"in t&&null!=t.layer}function bct(t){const e=xct(t);return null!=e&&"supportsSublayerVisibility"in e?e.supportsSublayerVisibility:void 0}function Sct(t){const e=xct(t);return null!=e&&"supportsDynamicLayers"in e?e.supportsDynamicLayers:void 0}function xct(t){return t&&"capabilities"in t&&null!=t.capabilities&&"exportMap"in t.capabilities?t.capabilities.exportMap:void 0}function _ct(t){return t?.["data-item"]}function Mct(t){return t?.getAttribute("data-layer-type")}function kct({children:t,error:e,incompatible:i}){return!!t?.filter((t=>!t.hidden)).length&&!e&&!i}function Tct(t){return t&&"function"==typeof t.render}function Act(t){return t&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}const Ict="legends";let jct=class extends(PI(CK)){constructor(t,e){super(t,e),this._legend=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles(fy((()=>this.content),(t=>this._createLegend(t)),_y))}destroy(){this._legend=$t(this._legend)}get className(){const{image:t}=this,e=this._getFirstWidget();return this._get("className")||(!t&&e?e.iconClass??"":"")}set className(t){this._override("className",t)}get disabled(){const{listItem:t,_legend:e,content:i}=this;return!t||!(Array.isArray(i)&&i.length>1)&&(!!e&&(!e.activeLayerInfos?.length||!t.visibleAtCurrentScale||!t.visible))}set disabled(t){this._overrideIfSome("disabled",t)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(t){this._override("title",t)}render(){return ZK("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(t){const{_legend:e,disabled:i}=this;return!t||i?null:"legend"===t&&e?ZK("div",{key:"legend-widget"},e.render()):"string"==typeof t?ZK("div",{innerHTML:t,key:t}):Tct(t)?ZK("div",{key:"content-widget"},t.render()):t instanceof HTMLElement?ZK("div",{afterCreate:this._attachToNode,bind:t,key:"content-element"}):null}_renderContents(){const{content:t}=this;return Array.isArray(t)?t.map((t=>this._renderContent(t))):this._renderContent(t)}_getLegendOptions(){const{listItem:t}=this;if(!t)return{};const{layer:e,view:i}=t;return e&&i&&"subtype-sublayer"!==e.type?{view:i,layerInfos:[vct(e)]}:{}}async _createLegend(t){if(!this._hasLegend(t)||this._legend)return;const{default:e}=await Promise.resolve().then((function(){return ygt})),{listItem:i}=this,n=new e(this._getLegendOptions());this._legend=n,this.notifyChange("className"),this.notifyChange("title");const s=fy((()=>[i?.view,i?.layer,i?.layer?.source,i?.layer?.parent]),(()=>this._updateLegend(n)),_y);this.addHandles(s,Ict),this.scheduleRender()}_hasLegend(t){const e="legend";return t===e||null!=t&&!!Array.isArray(t)&&t.includes(e)}_attachToNode(t){t.appendChild(this)}_updateLegend(t){t.set(this._getLegendOptions()),this.scheduleRender()}_getWidget(t){return"legend"===t?this._legend:Tct(t)?t:null}_getFirstWidget(){const{content:t}=this;return Array.isArray(t)?t.map((t=>this._getWidget(t))).find((t=>t)):this._getWidget(t)}};o([Us()],jct.prototype,"_legend",void 0),o([Us()],jct.prototype,"className",null),o([Us()],jct.prototype,"content",void 0),o([Us()],jct.prototype,"disabled",null),o([Us()],jct.prototype,"flowEnabled",void 0),o([Us()],jct.prototype,"image",void 0),o([Us()],jct.prototype,"listItem",void 0),o([Us()],jct.prototype,"open",void 0),o([Us()],jct.prototype,"title",null),o([Us()],jct.prototype,"visible",void 0),jct=o([Nr("esri.widgets.LayerList.ListItemPanel")],jct);const Cct=jct;var Ect;const Oct=ty.ofType({key:"type",defaultKeyValue:"button",base:eL,typeMap:{button:sL,toggle:aL,slider:Xut}}),Lct=ty.ofType(Oct),Nct="layer",Rct="child-list-mode",Pct="hide",Fct="esri.widgets.LayerList.ListItem";let Dct=Ect=class extends(PI(Vr)){constructor(t){super(t),this.actionsSections=new Lct,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(ty.ofType(Ect)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.layerView=null,this.listItemCreatedFunction=null,this.open=!1,this.panel=null,this.parent=null,this.sortable=!0,this.view=null}initialize(){if(this.addHandles([fy((()=>[this.layer,this.layer?.listMode]),(()=>this._watchLayerProperties(this.layer)),_y),fy((()=>this.checkPublishStatusEnabled),(t=>this._updateChildrenPublishing(t)),_y),fy((()=>this.view),(t=>this._updateChildrenView(t)),_y),fy((()=>this.panel),(t=>this._setListItemOnPanel(t)),_y),fy((()=>[this.layer,this.view]),(()=>this._getLayerView()),_y)]),"function"==typeof this.listItemCreatedFunction){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){this.view=null}get connectionStatus(){const{layerView:t,publishing:e}=this;if(!e&&t&&"connectionStatus"in t)return t.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const{layerView:t}=this;return!(!t||!("spatialReferenceSupported"in t))&&!t.spatialReferenceSupported}castPanel(t){return this.panel?.open&&!t.hasOwnProperty("open")&&(t.open=!0),t?new Cct(t):null}get title(){const t=le(this,"layer.layer");return(!t||t&&le(this,"layer.layer.loaded"))&&le(this,"layer.title")||le(this,"layer.attributes.title")||""}set title(t){this._override("title",t)}get publishing(){const{layer:t,checkPublishStatusEnabled:e}=this;return e&&t&&"publishingInfo"in t&&"publishing"===t.publishingInfo?.status}get updating(){const{layerView:t,connectionStatus:e,layer:i,publishing:n}=this;return!n&&!e&&(t?t.updating:"loading"===i?.loadStatus||!1)}get visible(){return this.layer?.visible}set visible(t){const e=this.layer;e&&(e.visible=t)}get visibleAtCurrentScale(){return!pct(this.layer,this.view?.scale)}get visibilityMode(){return cct(this.layer)}clone(){return new Ect({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(t){t&&(t.listItem=this)}_updateChildrenPublishing(t){const e=this.children;e&&e.forEach((e=>e.checkPublishStatusEnabled=t))}_updateChildrenView(t){const e=this.children;e&&e.forEach((e=>e.view=t))}_addChildren(t){if(this.removeHandles(Rct),this.children.removeAll(),!t)return;t.forEach((e=>{this.addHandles(fy((()=>e.listMode),(()=>this._addChildren(t))),Rct)}));const e=t.filter((t=>act(t)!==Pct));this.children.addMany(this._makeChildren(e))}_watchSublayerChanges(t){t&&this.addHandles(t.on("change",(()=>{this._addChildren(t)})),Nct)}_initializeChildLayers(t){this._addChildren(t),this._watchSublayerChanges(t)}_makeChildren(t){return t.map((t=>fct(t)?new Ect({layer:t,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null)).filter(F).reverse()}_watchLayerProperties(t){if(this.removeHandles(Nct),this.removeHandles(Rct),!t)return;if("hide-children"===act(t))return void this.children.removeAll();const e=hct(t);e&&this.addHandles(fy((()=>t[e]),(i=>{t.hasOwnProperty(e)&&this._initializeChildLayers(i)}),_y),Nct)}async _getLayerView(){const{layer:t,view:e}=this;if(t&&e)try{const i="subtype-sublayer"===t.type?t.parent:t,n=i&&await e.whenLayerView(i);if(n?.layer!==i)return;this._set("layerView",n)}catch{}}};o([Us({type:Lct})],Dct.prototype,"actionsSections",void 0),o([Us()],Dct.prototype,"actionsOpen",void 0),o([Us()],Dct.prototype,"checkPublishStatusEnabled",void 0),o([Us({type:ty})],Dct.prototype,"children",void 0),o([Us()],Dct.prototype,"childrenSortable",void 0),o([Us({readOnly:!0})],Dct.prototype,"connectionStatus",null),o([Us({readOnly:!0})],Dct.prototype,"error",null),o([Us()],Dct.prototype,"hidden",void 0),o([Us({readOnly:!0})],Dct.prototype,"incompatible",null),o([Us()],Dct.prototype,"layer",void 0),o([Us({readOnly:!0})],Dct.prototype,"layerView",void 0),o([Us()],Dct.prototype,"listItemCreatedFunction",void 0),o([Us()],Dct.prototype,"open",void 0),o([Us({type:Cct})],Dct.prototype,"panel",void 0),o([ol("panel")],Dct.prototype,"castPanel",null),o([Us()],Dct.prototype,"parent",void 0),o([Us()],Dct.prototype,"sortable",void 0),o([Us()],Dct.prototype,"title",null),o([Us({readOnly:!0})],Dct.prototype,"publishing",null),o([Us({readOnly:!0})],Dct.prototype,"updating",null),o([Us()],Dct.prototype,"view",void 0),o([Us()],Dct.prototype,"visible",null),o([Us({readOnly:!0})],Dct.prototype,"visibleAtCurrentScale",null),o([Us({readOnly:!0})],Dct.prototype,"visibilityMode",null),Dct=Ect=o([Nr(Fct)],Dct);const $ct=Dct;const zct={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},Uct="hide",Vct=ty.ofType($ct);let Gct=class extends Pm.EventedAccessor{constructor(t){super(t),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.operationalItems=new Vct,this.view=null}initialize(){this.addHandles([fy((()=>!0===this.view?.ready),(()=>this._viewHandles()),_y),fy((()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled]),(()=>this._recompileList()))],zct.view)}destroy(){this.view=null,this.operationalItems.removeAll()}get state(){const{view:t}=this;return t?.ready?"ready":t?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten((t=>t.children)).length}triggerAction(t,e){t&&!t.disabled&&this.emit("trigger-action",{action:t,item:e})}moveListItem(t,e,i,n){const s=t?.layer;if(!s||"subtype-sublayer"===s.type)return;const r=this.view?.map?.layers,o=e?gct(e):r,a=i?gct(i):r;if(!o||!a)return;const{operationalItems:l}=this,u=e?.children||l,c=i?.children||l,h=a.length-n;t.parent=i||null,u.remove(t),o.remove(s),c.includes(t)||c.add(t,h),a.includes(s)||a.add(s,h),this._compileList()}_createLayerViewHandles(t){this.removeHandles(zct.layerViews),this._compileList(),t&&this.addHandles(t.on("change",(()=>this._compileList())),zct.layerViews)}_createMapLayerHandles(t){this.removeHandles(zct.mapLayers),this._compileList(),t&&this.addHandles(t.on("change",(()=>this._compileList())),zct.mapLayers)}_createListItem(t){const{view:e,listItemCreatedFunction:i,checkPublishStatusEnabled:n}=this;return new $ct({checkPublishStatusEnabled:n,layer:t,listItemCreatedFunction:i,view:e})}_removeAllItems(){this.operationalItems.removeAll()}_getViewableLayers(t){if(t)return t.filter((t=>act(t)!==Uct))}_watchLayersListMode(t){this.removeHandles(zct.layerListMode),t&&t.forEach((t=>{"listMode"in t&&this.addHandles(fy((()=>t.listMode),(()=>this._compileList())),zct.layerListMode)}))}_compileList(){const t=this.view?.map?.layers;this._watchLayersListMode(t);const e=this._getViewableLayers(t);e?.length?(this._createNewItems(e),this._removeItems(e),this._sortItems(e)):this._removeAllItems()}_createNewItems(t){const{operationalItems:e}=this;t.forEach((t=>{e.some((e=>e.layer===t))||e.add(this._createListItem(t))}))}_removeItems(t){const{operationalItems:e}=this,i=[];e.forEach((e=>{e&&t&&t.includes(e.layer)||i.push(e)})),e.removeMany(i)}_sortItems(t){const{operationalItems:e}=this;e.sort(((e,i)=>{const n=t.indexOf(e.layer),s=t.indexOf(i.layer);return n>s?-1:n<s?1:0}))}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:t}=this;this.removeHandles([zct.mapLayers,zct.layerViews,zct.viewLayers]),t?.ready?this.addHandles([fy((()=>this.view?.map?.allLayers),(t=>this._createMapLayerHandles(t)),_y),fy((()=>this.view?.allLayerViews),(t=>this._createLayerViewHandles(t)),_y)],zct.viewLayers):this._removeAllItems()}};o([Us()],Gct.prototype,"checkPublishStatusEnabled",void 0),o([Us()],Gct.prototype,"listItemCreatedFunction",void 0),o([Us({type:Vct})],Gct.prototype,"operationalItems",void 0),o([Us({readOnly:!0})],Gct.prototype,"state",null),o([Us()],Gct.prototype,"totalItems",null),o([Us()],Gct.prototype,"view",void 0),Gct=o([Nr("esri.widgets.LayerList.LayerListViewModel")],Gct);const Bct=Gct;let qct=class extends Vr{constructor(){super(...arguments),this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};o([Us({type:Boolean,nonNullable:!0})],qct.prototype,"closeButton",void 0),o([Us({type:Boolean,nonNullable:!0})],qct.prototype,"collapseButton",void 0),o([Us({type:Boolean,nonNullable:!0})],qct.prototype,"errors",void 0),o([Us({type:Boolean,nonNullable:!0})],qct.prototype,"filter",void 0),o([Us({type:Boolean,nonNullable:!0})],qct.prototype,"flow",void 0),o([Us({type:Boolean,nonNullable:!0})],qct.prototype,"heading",void 0),o([Us({type:Boolean,nonNullable:!0})],qct.prototype,"statusIndicators",void 0),o([Us({type:Boolean,nonNullable:!0})],qct.prototype,"temporaryLayerIndicators",void 0),qct=o([Nr("esri.widgets.LayerList.LayerListVisibleElements")],qct);const Hct=qct;const Wct=ty.ofType($ct),Zct="operational";let Jct=class extends CK{constructor(t,e){super(t,e),this._activeItem=null,this._tooltipReferenceMap=new BF,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.icon=null,this.iconClass=Kut.widgetIcon,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=nct,this.minFilterItems=ict,this.selectedItems=new Wct,this.selectionMode="none",this.viewModel=new Bct,this.visibilityAppearance="default",this.visibleElements=new Hct,this._canMove=({dragEl:t,fromEl:e,toEl:i},n)=>{const s="pull"===n?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,r=_ct(t);if(!r?.sortable)return!1;const o=_ct(e),a=Mct(e),l=_ct(i),u=Mct(i),c=!!a&&!!u&&a===u,h={selected:r,from:o,to:l};return e.group&&i.group&&"function"==typeof s?s.call(null,h):c&&"sublayer"!==r?.layer?.type&&"map-image"!==o?.layer?.type&&"map-image"!==l?.layer?.type},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=t=>{if("default"!==this.visibilityAppearance)return;const e=Array.from(t.composedPath()).find((t=>t.classList?.contains(Kut.item)));this._activeItem=_ct(e)},this._onCalciteListOrderChange=t=>{const{_lastDragDetail:e}=this,{toEl:i,fromEl:n,dragEl:s,newIndex:r}=t;if(n&&i&&!(e?.newIndex===r&&e?.dragEl===s&&e?.toEl===i&&e?.fromEl===n))if(this._lastDragDetail=t,n!==i)this._moveLayerFromChildList({toEl:i,fromEl:n,dragEl:s,newIndex:r});else{const t=Array.from(n.children).filter((t=>t?.matches("calcite-list-item"))).map((t=>t.value));this._sortLayers(n,t)}}}loadDependencies(){return lK({action:()=>import("./p-6501cc8a.js"),"action-group":()=>import("./p-6909aeae.js"),"action-menu":()=>import("./p-60d6040e.js"),button:()=>import("./p-9ffe80e7.js"),flow:()=>import("./p-2eccd5f2.js"),"flow-item":()=>import("./p-ed00bde2.js"),icon:()=>import("./p-9ea19e2a.js"),list:()=>import("./p-6ee2eaea.js"),"list-item":()=>import("./p-88508b03.js"),notice:()=>import("./p-ca8550c9.js"),tooltip:()=>import("./p-5e2c8a5f.js")})}destroy(){this._tooltipReferenceMap.clear()}get _dragEnabled(){return this.viewModel.totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this.viewModel.totalItems>=this.minFilterItems&&this.visibleElements.filter}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(t){this.viewModel.listItemCreatedFunction=t}get multipleSelectionEnabled(){return p(Ft.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),"multiple"===this.selectionMode}set multipleSelectionEnabled(t){p(Ft.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=t?"multiple":this.selectionEnabled?"single":"none"}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(t){this.viewModel.operationalItems=t}get selectionEnabled(){return p(Ft.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),"none"!==this.selectionMode&&this.dragEnabled}set selectionEnabled(t){p(Ft.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.dragEnabled=t,this.selectionMode=t?this.multipleSelectionEnabled?"multiple":"single":"none"}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}triggerAction(t,e){return this.viewModel.triggerAction(t,e)}render(){const t=this.viewModel?.state,e={[zK.hidden]:"loading"===t,[zK.disabled]:"disabled"===t},i=this.operationalItems?.filter((t=>!t.hidden&&(this.visibleElements.errors||!t.error)));return ZK("div",{class:this.classes(Kut.base,zK.widget,zK.panel,e)},i?.length?[this._renderItemTooltips(i),this._renderItems(i)]:this._renderNoItems())}_renderItemTooltip(t){const{_tooltipReferenceMap:e,messages:i}=this;return t?ZK("calcite-tooltip",{key:`tooltip-${t.layer.uid}`,referenceElement:e.get(t.layer.uid)},i.layerIncompatibleTooltip):null}_renderItemTooltipNodes(t){return t.incompatible?this._renderItemTooltip(t):t.children?.filter((t=>!t.hidden)).toArray().map((t=>this._renderItemTooltipNodes(t)))}_renderItemTooltips(t){return t?.toArray().map((t=>this._renderItemTooltipNodes(t)))}_renderNoItemsMessage(){return ZK("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return ZK("div",{class:Kut.itemMessage,key:"esri-layer-list__no-items"},ZK("calcite-notice",{icon:"information",kind:"info",open:!0,scale:"m",width:"full"},this._renderNoItemsMessage()))}_renderPanelFlowItems(t){return t?t.flatten((t=>t.children)).filter((t=>!t.hidden)).toArray().filter((({panel:t})=>t?.open&&!t.disabled&&t.flowEnabled)).map((({title:t,panel:e})=>{const i=()=>this._handlePanelFlowItemBack(e);return ZK("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:t,heading:e.title,headingLevel:this.headingLevel,key:`flow-panel-${e.uid}`,onCalciteFlowItemBack:t=>{t.preventDefault(),i()}},e.render(),ZK("calcite-button",{appearance:"transparent",onclick:i,slot:"footer-actions",width:"full"},this.messagesCommon.back))})):[]}_handlePanelFlowItemBack(t){t.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(t){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,requestAnimationFrame((()=>t?.setFocus())))}_focusPanelFlowItemNode(t){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,requestAnimationFrame((()=>t?.setFocus())))}_renderItems(t){const{visible:e,collapsed:i,_filterEnabled:n,visibleElements:{closeButton:s,collapseButton:r,heading:o,flow:a},_dragEnabled:l,selectionMode:u,filterText:c,filterPlaceholder:h,messages:d}=this,f=[ZK("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:s,closed:!e,collapsed:i,collapsible:r,heading:o?d.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},ZK("calcite-list",{afterCreate:t=>{t.addEventListener("focusin",this._setActiveItem),t.addEventListener("focusout",this._clearActiveItem)},afterRemoved:t=>{t.removeEventListener("focusin",this._setActiveItem),t.removeEventListener("focusout",this._clearActiveItem)},canPull:t=>this._canMove(t,"pull"),canPut:t=>this._canMove(t,"put"),"data-layer-type":Zct,dragEnabled:l,filterEnabled:n,filterPlaceholder:h,filterText:n?c:"",group:ect,key:"root-list",label:d.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:u,onCalciteListChange:t=>this._handleCalciteListChange(t),onCalciteListDragEnd:t=>this._handleCalciteListDragEnd(t.detail),onCalciteListFilter:t=>this.filterText=t.target?.filterText??"",onCalciteListOrderChange:t=>this._onCalciteListOrderChange(t.detail)},t?.toArray().map((t=>this._renderItem(t))),t?.length&&n?ZK("div",{class:Kut.filterNoResults,slot:"filter-no-results"},ZK("calcite-notice",{kind:"info",open:!0,scale:"m",width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(t)];return e?a?ZK("calcite-flow",{key:"root-flow"},f):f:null}_renderChildList(t,e=[]){const{_dragEnabled:i}=this,{children:n}=t,s=kct(t),r=!oct(t.layer)&&!s&&i&&"group"===t.layer?.type;return s||r?ZK("calcite-list",{canPull:t=>this._canMove(t,"pull"),canPut:t=>this._canMove(t,"put"),"data-item":t,"data-layer-type":Zct,dragEnabled:!!i&&(t.childrenSortable&&dct(t)),group:t.layer.uid},n?.filter((t=>!t.hidden)).toArray().map((i=>this._renderItem(i,t,[...e,t.title])))):null}_renderItemMessage(t){return t.error?ZK("div",{class:Kut.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},ZK("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},ZK("div",{slot:"message"},this.messages.layerError))):t.incompatible?ZK("div",{class:Kut.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},ZK("calcite-notice",{afterCreate:e=>this._setTooltipReference(e,t),afterRemoved:()=>this._removeTooltipReference(t),bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},ZK("div",{slot:"message"},this.messages.layerIncompatible))):null}_renderItem(t,e,i){const{_activeItem:n,_selectedDragItemLayerUid:s,selectionMode:r,selectedItems:o,messages:a}=this,l=t.title||a.untitledLayer,u=t.visibleAtCurrentScale?l:`${l} (${a.layerInvisibleAtScale})`,c=this._filterActions(t.actionsSections),h=this._countActions(c);return ZK("calcite-list-item",{afterCreate:e=>this._focusSelectedDragEl(e,t),afterUpdate:e=>this._focusSelectedDragEl(e,t),class:this.classes(Kut.item,{[Kut.itemActive]:n===t}),"data-item":t,dragDisabled:!t.sortable,dragSelected:t.layer.uid===s,id:t.layer.uid,key:`list-item-${t.layer.uid}`,label:l,metadata:{parentTitles:i,title:l},open:t.open,selected:"none"!==r&&o.includes(t),title:u,value:t.layer.uid,onCalciteListItemDragHandleChange:e=>this._handleCalciteListItemDragHandleChange(e,t),onCalciteListItemSelect:i=>this._handleCalciteListItemSelect(i,t,e),onCalciteListItemToggle:e=>this._handleCalciteListItemToggle(e,t)},ZK("div",{class:this.classes({[Kut.itemContent]:!0,[Kut.itemInvisibleAtScale]:!t.visibleAtCurrentScale}),slot:"content"},l),this._renderItemStatus(t,e),this._renderItemToggle(t,e),this._renderItemTemporaryIcon(t),this._renderChildList(t,i),this._renderItemMessage(t),this._renderPanel(t.panel),this._renderPanelAction(t.panel),h>1?this._renderActionsSections(t,c):1===h?this._renderAction({item:t,action:this._getSingleActionButton(c),textEnabled:!1}):null)}_renderItemStatus(t,e){const{visibleElements:i}=this;if(!i.statusIndicators)return null;const{connectionStatus:n,publishing:s,updating:r}=t,o=r&&!e,a=!!n;return ZK("calcite-icon",{class:this.classes({[Kut.statusIndicator]:!0,[Kut.publishing]:s,[Kut.updating]:o,[Kut.connectionStatus]:a,[Kut.connectionStatusConnected]:a&&"connected"===n}),icon:rct({connectionStatus:n,publishing:s}),key:"layer-item-status",scale:"s",slot:"actions-end"})}_renderItemTemporaryIcon(t){return this.visibleElements.temporaryLayerIndicators&&"persistenceEnabled"in t.layer&&!t.layer.persistenceEnabled?ZK("calcite-icon",{class:Kut.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"actions-start",title:this.messages.temporary}):null}_renderItemToggle(t,e){const{messages:i,visibilityAppearance:n}=this,{visible:s}=t,r=e?.visibilityMode;if("inherited"===r)return null;const o=sct({visible:s,exclusive:"exclusive"===r,visibilityAppearance:n}),a="checkbox"===n;return ZK("calcite-action",{appearance:"transparent",class:Kut.visibleToggle,icon:a?o:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(t,e),scale:"s",slot:a?"actions-start":"actions-end",text:i.layerVisibility,title:i.layerVisibility},a?null:ZK("calcite-icon",{class:this.classes({[Kut.visibleIcon]:"exclusive"!==r&&s}),icon:o,scale:"s"}))}_renderPanel(t){return!t?.open||t.disabled||t.flowEnabled?null:ZK("div",{class:Kut.itemContentBottom,key:`content-panel-${t.uid}`,slot:"content-bottom"},t.render())}_renderPanelAction(t){if(!t?.visible)return null;const{open:e,title:i,disabled:n}=t;return ZK("calcite-action",{active:e,appearance:"transparent",disabled:n,icon:qut(t),key:`action-${t.uid}`,onclick:()=>this._togglePanel(t),scale:"s",slot:"actions-end",text:i??"",title:i??void 0},this._renderFallbackIcon(t))}_renderActionsSections(t,e){return ZK("calcite-action-menu",{appearance:"transparent",key:"item-action-menu",label:this.messagesCommon.menu,open:t.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:e=>t.actionsOpen=e.target.open},ZK("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:this.messagesCommon.options,title:this.messagesCommon.options}),e.toArray().map(((e,i)=>this._renderActionSection(t,e,i))))}_renderActionSection(t,e,i){return ZK("calcite-action-group",{key:`action-section-${i}`},e.toArray().map((e=>this._renderAction({item:t,action:e,textEnabled:!0}))))}_renderFallbackIcon(t){const{className:e,icon:i}=t;if(i)return null;const n="image"in t?t.image:void 0,s={[Kut.itemActionIcon]:!!e,[Kut.itemActionImage]:!!n};return e&&(s[e]=!0),n||e?ZK("span",{"aria-hidden":"true",class:this.classes(Kut.itemActionIcon,s),key:"icon",styles:Hut(n)}):null}_renderAction(t){const{item:e,action:i,textEnabled:n}=t,{active:s,disabled:r,title:o,type:a,indicator:l}=i;return ZK("calcite-action",{active:"toggle"===a&&i.value,appearance:"transparent",disabled:r,icon:qut(i),indicator:l,key:`action-${i.uid}`,loading:s,onclick:()=>this._triggerAction(e,i),scale:"s",slot:n?void 0:"actions-end",text:o??"",textEnabled:n,title:o??void 0},this._renderFallbackIcon(i))}_setTooltipReference(t,e){this._tooltipReferenceMap.set(e.layer.uid,t)}_removeTooltipReference(t){this._tooltipReferenceMap.delete(t.layer.uid)}_moveLayerFromChildList({toEl:t,fromEl:e,dragEl:i,newIndex:n}){const s=_ct(i),r=_ct(t),o=_ct(e);this.viewModel.moveListItem(s,o,r,n)}_handleCalciteListDragEnd(t){const{fromEl:e,dragEl:i,oldIndex:n}=t;e.insertBefore(i,e.children[n])}_sortLayers(t,e){if(t)if(t.group===ect)mct(this.view?.map?.layers,e);else{const i=_ct(t);if(!i)return;yct(i,e)}}_getSingleActionButton(t){return t.reduce((t=>t)).filter((t=>t&&"button"===t.type)).at(0)}_filterActions(t){return t.map((t=>t.filter((t=>t.visible))))}_countActions(t){return t.reduce(((t,e)=>t+e.length),0)}_triggerAction(t,e){e&&t&&("toggle"===e.type&&(e.value=!e.value),this.triggerAction(e,t))}_handleCalciteListChange(t){const{selectionMode:e,selectedItems:i}=this;if("none"===e)return;const n=t.target.selectedItems.map((t=>_ct(t))).filter(Boolean);i.removeAll(),i.addMany(n)}_handleCalciteListItemToggle(t,e){t.stopPropagation(),e.open=t.target.open}_focusSelectedDragEl(t,e){this._selectedDragItemLayerUid===e.layer.uid&&requestAnimationFrame((()=>t?.setFocus()))}_handleCalciteListItemDragHandleChange(t,e){t.stopPropagation();const i=t.target.dragSelected;this._selectedDragItemLayerUid=i?e.layer.uid:null}_handleCalciteListItemSelect(t,e,i){_ct(t.target)===e&&"none"===this.selectionMode&&"inherited"!==i?.visibilityMode&&this._toggleVisibility(e,i)}_togglePanel(t){t.open=!t.open,t.open&&(this._focusPanelFlowItem=!0)}_toggleVisibility(t,e){if(!t)return;const i=e?.visibilityMode;"exclusive"===i&&t.visible||(t.visible=!t.visible)}};o([Us()],Jct.prototype,"_activeItem",void 0),o([Us()],Jct.prototype,"_tooltipReferenceMap",void 0),o([Us()],Jct.prototype,"_focusRootFlowItem",void 0),o([Us()],Jct.prototype,"_focusPanelFlowItem",void 0),o([Us()],Jct.prototype,"_dragEnabled",null),o([Us()],Jct.prototype,"_filterEnabled",null),o([Us()],Jct.prototype,"collapsed",void 0),o([Us()],Jct.prototype,"dragEnabled",void 0),o([Us()],Jct.prototype,"filterPlaceholder",void 0),o([Us()],Jct.prototype,"filterText",void 0),o([Us()],Jct.prototype,"headingLevel",void 0),o([Us()],Jct.prototype,"icon",void 0),o([Us()],Jct.prototype,"iconClass",void 0),o([Us()],Jct.prototype,"label",null),o([Us()],Jct.prototype,"listItemCanGiveFunction",void 0),o([Us()],Jct.prototype,"listItemCanReceiveFunction",void 0),o([Us()],Jct.prototype,"listItemCreatedFunction",null),o([Us(),BK("esri/widgets/LayerList/t9n/LayerList")],Jct.prototype,"messages",void 0),o([Us(),BK("esri/t9n/common")],Jct.prototype,"messagesCommon",void 0),o([Us()],Jct.prototype,"minDragEnabledItems",void 0),o([Us()],Jct.prototype,"minFilterItems",void 0),o([Us()],Jct.prototype,"multipleSelectionEnabled",null),o([Us()],Jct.prototype,"operationalItems",null),o([Us()],Jct.prototype,"selectionEnabled",null),o([Us()],Jct.prototype,"selectedItems",void 0),o([Us()],Jct.prototype,"selectionMode",void 0),o([Us()],Jct.prototype,"view",null),o([Put("trigger-action"),Us({type:Bct})],Jct.prototype,"viewModel",void 0),o([Us()],Jct.prototype,"visibilityAppearance",void 0),o([Us({type:Hct,nonNullable:!0})],Jct.prototype,"visibleElements",void 0),Jct=o([Nr("esri.widgets.LayerList")],Jct);const Kct=Jct;function Yct(t,e){const i=t.featureReduction;return i&&"selection"!==i.type&&(!("maxScale"in i)||!i.maxScale||i.maxScale<e.scale)?i:null}const Qct=-1;let Xct=class extends Vr{constructor(t){super(t),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=c("mapview-transitions-duration"),this.effects=[]}set effect(t){if(this._get("effect")!==(t=t||"")){this._set("effect",t);try{this._transitionTo(tht(t))}catch(e){this._transitionTo([]),Ft.getLogger(this).warn("Invalid Effect",{effect:t,error:e})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(t){this._updateForScale(t)}get transitioning(){return null!==this._to}canTransitionTo(t){try{return this.scale>0&&eht(this._current,tht(t),this.scale)}catch{return!1}}transitionStep(t,e){this._applyTimeTransition(t),this._updateForScale(e)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(t){this.scale>0&&eht(this._current,t,this.scale)?(this._final=t,this._to=ht(t),iht(this._current,this._to,this.scale),this._from=ht(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=t),this._set("effects",this._current[0]?ht(this._current[0].effects):[])}_applyTimeTransition(t){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=t;const e=Math.min(1,this._time/this.duration);for(let t=0;t<this._current.length;t++){const i=this._current[t],n=this._from[t],s=this._to[t];i.scale=nht(n.scale,s.scale,e);for(let t=0;t<i.effects.length;t++){const r=i.effects[t],o=n.effects[t],a=s.effects[t];r.interpolate(o,a,e)}}1===e&&(this._current=this._final,this._set("effects",this._current[0]?ht(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(t){if(this._set("scale",t),0===this._current.length)return;const e=this._current,i=this._current.length-1;let n,s,r=1;if(1===e.length||t>=e[0].scale)s=n=e[0].effects;else if(t<=e[i].scale)s=n=e[i].effects;else for(let o=0;o<i;o++){const i=e[o],a=e[o+1];if(i.scale>=t&&a.scale<=t){r=(t-i.scale)/(a.scale-i.scale),n=i.effects,s=a.effects;break}}for(let t=0;t<this.effects.length;t++){this.effects[t].interpolate(n[t],s[t],r)}}};function tht(t){const e=i8(t)||[];return sht(e)?[{scale:Qct,effects:e}]:e}function eht(t,e,i){if(!t[0]?.effects||!e[0]?.effects)return!0;return!((t[0]?.scale===Qct||e[0]?.scale===Qct)&&(t.length>1||e.length>1)&&i<=0)&&eI(t[0].effects,e[0].effects)}function iht(t,e,i){const n=t.length>e.length?t:e,s=t.length>e.length?e:t,r=s[s.length-1],o=r?.scale??i,a=r?.effects??[];for(let t=s.length;t<n.length;t++)s.push({scale:o,effects:[...a]});for(let t=0;t<n.length;t++)s[t].scale=s[t].scale===Qct?i:s[t].scale,n[t].scale=n[t].scale===Qct?i:n[t].scale,iI(s[t].effects,n[t].effects)}function nht(t,e,i){return t+(e-t)*i}function sht(t){const e=t[0];return!!e&&"type"in e}o([Us()],Xct.prototype,"_to",void 0),o([Us()],Xct.prototype,"duration",void 0),o([Us({value:""})],Xct.prototype,"effect",null),o([Us({readOnly:!0})],Xct.prototype,"effects",void 0),o([Us({readOnly:!0})],Xct.prototype,"hasEffects",null),o([Us({value:0})],Xct.prototype,"scale",null),o([Us({readOnly:!0})],Xct.prototype,"transitioning",null),Xct=o([Nr("esri.layers.effects.EffectView")],Xct);function rht(t){const e=t.layer;if("floorInfo"in e&&e.floorInfo?.floorField&&"floors"in t.view){return aht(t.view.floors,e.floorInfo.floorField)}return null}function oht(t,e){return"floorInfo"in e&&e.floorInfo?.floorField?aht(t,e.floorInfo.floorField):null}function aht(t,e){if(!t?.length)return null;const i=t.filter((t=>""!==t)).map((t=>`'${t}'`));return i.push("''"),`${e} IN (${i.join(",")}) OR ${e} IS NULL`}function lht(t,e,i){const n=e.flatten((({sublayers:t})=>t)).length;if(n!==t.length)return!0;return!!t.some((t=>t.originIdOf("minScale")>i||t.originIdOf("maxScale")>i||t.originIdOf("renderer")>i||t.originIdOf("labelingInfo")>i||t.originIdOf("opacity")>i||t.originIdOf("labelsVisible")>i||t.originIdOf("source")>i))||!cht(t,e)}function uht(t,e,i){return!!t.some((t=>{const e=t.source;return!(!e||"map-layer"===e.type&&e.mapLayerId===t.id&&(null==e.gdbVersion||e.gdbVersion===i))||t.originIdOf("renderer")>xe.SERVICE||t.originIdOf("labelingInfo")>xe.SERVICE||t.originIdOf("opacity")>xe.SERVICE||t.originIdOf("labelsVisible")>xe.SERVICE}))||!cht(t,e)}function cht(t,e){if(!t?.length||null==e)return!0;const i=e.slice().reverse().flatten((({sublayers:t})=>t&&t.toArray().reverse())).map((t=>t.id)).toArray();if(t.length>i.length)return!1;let n=0;const s=i.length;for(const{id:e}of t){for(;n<s&&i[n]!==e;)n++;if(n>=s)return!1}return!0}function hht(t){return!!t&&t.some((t=>null!=t.minScale||null!=t.layerDefinition?.minScale))}const dht={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let fht=class extends Vr{constructor(t){super(t),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const t=this.visibleSublayers.map((t=>{const e=oht(this.floors,t);return t.toExportImageJSON(e)}));return t.length?JSON.stringify(t):null}get hasDynamicLayers(){return this.layer&&uht(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(t){this._get("layer")!==t&&(this._set("layer",t),this.removeHandles("layer"),t&&this.addHandles([t.allSublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),t.on("sublayer-update",(t=>this.notifyChange(dht[t.propertyName])))],"layer"))}get layers(){const t=this.visibleSublayers;return t?t.length?"show:"+t.map((t=>t.id)).join(","):"show:-1":null}get layerDefs(){const t=!!this.floors?.length,e=this.visibleSublayers.filter((e=>null!=e.definitionExpression||t&&null!=e.floorInfo));return e.length?JSON.stringify(e.reduce(((t,e)=>{const i=oht(this.floors,e),n=gj(i,e.definitionExpression);return null!=n&&(t[e.id]=n),t}),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const t=this.layer;return t&&(t.commitProperty("dpi"),t.commitProperty("imageFormat"),t.commitProperty("imageTransparency"),t.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const t=[];if(!this.layer)return t;const e=this.layer.sublayers,i=this.scale,n=e=>{e.visible&&(0===i||Fat(i,e.minScale,e.maxScale))&&(e.sublayers?e.sublayers.forEach(n):t.unshift(e))};e&&e.forEach(n);const s=this._get("visibleSublayers");return!s||s.length!==t.length||s.some(((e,i)=>t[i]!==e))?t:s}toJSON(){const t=this.layer;let e={dpi:t.dpi,format:t.imageFormat,transparent:t.imageTransparency,gdbVersion:t.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?e.dynamicLayers=this.dynamicLayers:e={...e,layers:this.layers,layerDefs:this.layerDefs},e}};o([Us({readOnly:!0})],fht.prototype,"dynamicLayers",null),o([Us()],fht.prototype,"floors",void 0),o([Us({readOnly:!0})],fht.prototype,"hasDynamicLayers",null),o([Us()],fht.prototype,"layer",null),o([Us({readOnly:!0})],fht.prototype,"layers",null),o([Us({readOnly:!0})],fht.prototype,"layerDefs",null),o([Us({type:Number})],fht.prototype,"scale",void 0),o([Us(D9)],fht.prototype,"timeExtent",void 0),o([Us({readOnly:!0})],fht.prototype,"version",null),o([Us({readOnly:!0})],fht.prototype,"visibleSublayers",null),fht=o([Nr("esri.layers.mixins.ExportImageParameters")],fht);const pht=9999999e31,mht=2e-7,yht={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function ght(t){return yht[t]??[-34028234663852886e22,34028234663852886e22]}function vht(t,e){return null==t||null==e?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function wht(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function bht(t,e,i){if(t.depthCount&&t.depthCount>1)return;const{pixels:n,statistics:s,pixelType:r}=t,o=n[0].length,a=t.bandMasks??[],l=t.mask??new Uint8Array(o).fill(255),u="f32"===r||"f64"===r,c=ght(r);let h=!1;for(let t=0;t<n.length;t++){const o="number"==typeof e?e:e[t];if(null==o)continue;const d=s?.[t]?.minValue??c[0],f=s?.[t]?.maxValue??c[1];if(d>o+Number.EPSILON||f<o-Number.EPSILON)continue;const p=a[t]||l.slice(),m=n[t],y=i?.customFloatTolerance;if(u&&0!==y){let t=y;t||(t=Math.abs(o)>=pht?mht*Math.abs(o):"f32"===r?2**-23:Number.EPSILON);for(let e=0;e<m.length;e++)p[e]&&Math.abs(m[e]-o)<t&&(m[e]=0,p[e]=0,l[e]=0,h=!0)}else for(let t=0;t<m.length;t++)p[t]&&m[t]===o&&(m[t]=0,p[t]=0,l[t]=0,h=!0);a[t]=p}h&&(t.bandMasks=t.bandMasks||t.pixels.length>1?a:null,t.mask=l),h&&"updateStatistics"in t&&t.updateStatistics()}function Sht(t){return null==t||"simple"===t.type||"unique-value"===t.type||"class-breaks"===t.type||"dictionary"===t.type||"heatmap"===t.type}function xht(t){const e=[];return _ht(A2(t),e),e.length?new wT(T2(e[0])):null}function _ht(t,e){if(!t)return;let i;i="CIMTextSymbol"===t.type?t.symbol:t;const n="CIMPolygonSymbol"===t.type;if(i?.symbolLayers)for(const t of i.symbolLayers)if(!(t.colorLocked||n&&(j2(t)||I2(t)&&t.markerPlacement&&E2(t.markerPlacement))))switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":t.tintColor&&Mht(e,t.tintColor);break;case"CIMVectorMarker":t.markerGraphics?.forEach((t=>{_ht(t.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":Mht(e,t.color);break;case"CIMHatchFill":_ht(t.lineSymbol,e)}}function Mht(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function kht(t,e,i){e instanceof wT||(e=new wT(e));const n=A2(t);n&&Tht(n,e,i)}function Tht(t,e,i){if(!t)return;let n;n="CIMTextSymbol"===t.type?t.symbol:t;const s="CIMPolygonSymbol"===n?.type;if(n?.symbolLayers)for(const t of n.symbolLayers){if(t.colorLocked)continue;if(s)if(i){const{layersToColor:e}=i;if((j2(t)||I2(t)&&t.markerPlacement&&E2(t.markerPlacement))&&"fill"===e||C2(t)&&"outline"===e)continue}else if(j2(t)||I2(t)&&t.markerPlacement&&E2(t.markerPlacement))continue;const n=e.toArray();switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":t.tintColor=n;break;case"CIMVectorMarker":t.markerGraphics?.forEach((t=>{Tht(t.symbol,e,i)}));break;case"CIMSolidStroke":case"CIMSolidFill":t.color=n;break;case"CIMHatchFill":Tht(t.lineSymbol,e,i)}}}var Aht;!function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"}(Aht||(Aht={}));const Iht={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function jht(t,e,i){const n=Aht.size;let s=n,r=n;t<1?s*=.75:t>1&&(r*=1.25);const o=0,a=0;let l=n,u=n;e&&i&&(s=r=l=u=0);return[{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[i?l:.875*l,o]},{command:"L",values:[i?s-.5*l:a,r-.5*u]},{command:"L",values:[s-.5*l,r-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[l,e?o:.125*u]},{command:"L",values:[s-.5*l,e?r-.5*u:u]},{command:"L",values:[s-.5*l,r-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s-.5*l,r-.5*u]},{command:"L",values:[i?s-.5*l:a,r-.5*u]},{command:"L",values:[i?s-.5*l:a,e?r-.5*u:u]},{command:"L",values:[s-.5*l,e?r-.5*u:u]},{command:"Z",values:[]}]}]}function Cht(t){const e=Aht.size,i=.5*t,n=0,s=0;return[{type:"path",path:[{command:"M",values:[s,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[s,.7*e+i-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[e,i]},{command:"L",values:[e,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,n]},{command:"L",values:[e,n]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[s,.7*e*.5]},{command:"Z",values:[]}]}]}function Eht(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function Oht(t,e){let i=e?Aht.tallSymbolWidth:t;const n=t,s=e?4:6;i<=Aht.size?i-=.5*s:i-=s;const r=0,o=0,a=e?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,r]},{command:"L",values:[i,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[o,.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[.5*i,n]},{command:"L",values:[o,n-.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,a]},{command:"L",values:[.5*i,n]},{command:"L",values:[i,n-.5*a]},{command:"L",values:[i,.5*a]},{command:"Z",values:[]}]}]}function Lht(t,e){let i=e?Aht.tallSymbolWidth:t;const n=t,s=e?4:6;i<=Aht.size?i-=.5*s:i-=s;const r=.5*i,o=.15*i,a=0,l=n-o;return[{type:"ellipse",cx:.5*i,cy:l,rx:r,ry:o},{type:"path",path:[{command:"M",values:[a,o]},{command:"L",values:[a,l]},{command:"L",values:[i,l]},{command:"L",values:[i,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:o,rx:r,ry:o}]}function Nht(t,e){let i=e?Aht.tallSymbolWidth:t;const n=t,s=e?4:6;i<=Aht.size?i-=.5*s:i-=s;const r=.15*i,o=n-r;return[{type:"ellipse",cx:.5*i,cy:o,rx:.5*i,ry:r},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function Rht(t){let e=t;const i=t,n=6;e<Aht.size?e-=.5*n:e-=n;const s=.15*e,r=0;return[{type:"path",path:[{command:"M",values:[0,r]},{command:"L",values:[e,r]},{command:"L",values:[.5*e,i-s]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:r,rx:.5*e,ry:s}]}function Pht(t){let e=t;const i=t,n=4;e<Aht.size?e-=.5*n:e-=n;const s=0,r=0,o=e,a=i,l=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[r,.5*a-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[.45*o,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,i]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]}]}function Fht(t){const e=t,i=2;let n=t;n<Aht.size?n-=.5*i:n-=i;const s=0,r=0;return[{type:"path",path:[{command:"M",values:[.45*e,s]},{command:"L",values:[e,n]},{command:"L",values:[.45*e,.6*n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,s]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[r,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r,n]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[e,n]},{command:"Z",values:[]}]}]}function Dht(t,e){const i=.75;return Math.round(Math.min(Math.max(t+255*e*i,0),255))}function $ht(t,e){if(null==t)return new wT;if("type"in t&&("linear"===t.type||"pattern"===t.type))return t;const i=new wT(t);return new wT([Dht(i.r,e),Dht(i.g,e),Dht(i.b,e),i.a])}const zht="picture-fill",Uht="simple-fill",Vht="simple-line",Ght="simple-marker",Bht="text",qht="cim",Hht=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),Wht=new E0(1e3);function Zht(t){const e=t.style;let i=null;if(t)switch(t.type){case Ght:"cross"!==e&&"x"!==e&&(i=t.color);break;case Uht:e&&"solid"!==e?"none"!==e&&(i={type:"pattern",x:0,y:0,src:Nc(`esri/symbols/patterns/${e}.png`),width:5,height:5}):i=t.color;break;case zht:i={type:"pattern",src:t.url,width:RT(t.width)*t.xscale,height:RT(t.height)*t.yscale,x:RT(t.xoffset),y:RT(t.yoffset)};break;case Bht:i=t.color;break;case qht:i=xht(t)}return i}function Jht(t,e){const i=t+"-"+e;return void 0!==Wht.get(i)?Promise.resolve(Wht.get(i)):hc(t,{responseType:"image"}).then((t=>{const n=t.data,s=n.naturalWidth,r=n.naturalHeight,o=document.createElement("canvas");o.width=s,o.height=r;const a=o.getContext("2d");a.fillStyle=e,a.fillRect(0,0,s,r),a.globalCompositeOperation="destination-in",a.drawImage(n,0,0);const l=o.toDataURL();return Wht.put(i,l),l}))}function Kht(t){if(!t)return null;let e=null;switch(t.type){case Uht:case zht:case Ght:e=Kht(t.outline);break;case Vht:{const i=RT(t.width);null!=t.style&&"none"!==t.style&&0!==i&&(e={color:t.color,style:Qht(t.style),width:i,cap:t.cap,join:"miter"===t.join?RT(t.miterLimit):t.join},e.dashArray=Yht(e).join(",")||"none");break}default:e=null}return e}function Yht(t){if(!t?.style)return[];const{dashArray:e,style:i,width:n}=t;if("string"==typeof e&&"none"!==e)return e.split(",").map((t=>Number(t)));const s=n??0,r=Hht.has(i)?Hht.get(i).map((t=>t*s)):[];if("butt"!==t.cap)for(const[t,e]of r.entries())r[t]=t%2==1?e+s:Math.max(e-s,1);return r}const Qht=(()=>{const t={};return e=>{if(t[e])return t[e];const i=e.replaceAll("-","");return t[e]=i,i}})(),Xht=new wT([128,128,128]);const tdt="http://www.w3.org/2000/svg";let edt=0,idt=0;const ndt=c("android"),sdt=c("chrome")||ndt&&ndt>=4?"auto":"optimizeLegibility",rdt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},odt=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let adt={},ldt={};const udt=Math.PI;let cdt=1;function hdt(t,e){const i=t*(udt/180);return Math.abs(e*Math.sin(i))+Math.abs(e*Math.cos(i))}function ddt(t){return t.map((t=>`${t.command} ${t.values.join(" ")}`)).join(" ").trim()}function fdt(t,e,i,n,s){if(t){if("circle"===t.type)return ZK("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if("ellipse"===t.type)return ZK("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if("rect"===t.type)return ZK("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,width:t.width,x:t.x,y:t.y});if("image"===t.type)return ZK("image",{alt:s||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if("path"===t.type){const n="string"!=typeof t.path?ddt(t.path):t.path;return ZK("path",{d:n,fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width})}if("text"===t.type)return Dt(n),ZK("text",{"dominant-baseline":n.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":n.font.family,"font-size":n.font.size,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,kerning:n.kerning,rotate:n.rotate,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,"text-anchor":n.align,"text-decoration":n.decoration,"text-rendering":sdt,x:t.x,y:t.y},t.text)}return null}function pdt(t){const e={fill:"none",pattern:null,linearGradient:null};if(t)if("type"in t&&"pattern"===t.type){const i="patternId-"+ ++edt;e.fill=`url(#${i})`,e.pattern={id:i,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}}}else if("type"in t&&"linear"===t.type){const i="linearGradientId-"+ ++idt;e.fill=`url(#${i})`,e.linearGradient={id:i,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map((t=>({offset:t.offset,color:t.color&&new wT(t.color).toString()})))}}else if(t){const i=new wT(t);e.fill=i.toString()}return e}function mdt(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(null!=t.width&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new wT(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=Yht(t).join(",")||"none")),e}function ydt(t,e){const i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const n=t.alignBaseline,s="baseline"===n?"auto":"top"===n?"text-top":"bottom"===n?"hanging":n;i.align=t.align,i.dominantBaseline=s,i.decoration=t.decoration,i.kerning=t.kerning?"auto":"0",i.rotate=t.rotated?"90":"0",Dt(e),i.font.style=e.style||"normal",i.font.variant=e.variant||"normal",i.font.weight=e.weight||"normal",i.font.size=e.size&&e.size.toString()||"10pt",i.font.family=e.family||"serif"}return i}function gdt(t){const{pattern:e,linearGradient:i}=t;if(e)return ZK("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},ZK("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(i){const t=i.stops.map(((t,e)=>ZK("stop",{key:`${e}-stop`,offset:t.offset,"stop-color":t.color})));return ZK("linearGradient",{gradientUnits:"userSpaceOnUse",id:i.id,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2},t)}return null}function vdt(t,e){if(!t||0===t.length)return null;const i=[];for(const e of t){const{shape:t,fill:n,stroke:s,font:r}=e,o=pdt(n),a=mdt(s),l="text"===t.type?ydt(t,r):null,u=fdt(t,o.fill,a,l);u&&i.push(u)}return ZK("mask",{id:e,maskUnits:"userSpaceOnUse"},ZK("g",null,i))}function wdt(t,e,i){return Lz(t,Tz(t),[e,i])}function bdt(t,e,i,n,s){return Oz(t,Tz(t),[e,i]),t[4]=t[4]*e-n*e+n,t[5]=t[5]*i-s*i+s,t}function Sdt(t,e,i,n){const s=e%360*Math.PI/180;Ez(t,Tz(t),s);const r=Math.cos(s),o=Math.sin(s),a=t[4],l=t[5];return t[4]=a*r-l*o+n*o-i*r+i,t[5]=l*r+a*o-i*o-n*r+n,t}function xdt(t,e){adt&&"left"in adt?(null!=adt.left&&adt.left>t&&(adt.left=t),(null==adt.right||adt.right<t)&&(adt.right=t),(null==adt.top||adt.top>e)&&(adt.top=e),(null==adt.bottom||adt.bottom<e)&&(adt.bottom=e)):adt={left:t,bottom:e,right:t,top:e}}function _dt(t){const e=t.args,i=e.length;let n;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(n=0;n<i;n+=2)xdt(e[n],e[n+1]);ldt.x=e[i-2],ldt.y=e[i-1];break;case"H":for(n=0;n<i;++n)xdt(e[n],ldt.y);ldt.x=e[i-1];break;case"V":for(n=0;n<i;++n)xdt(ldt.x,e[n]);ldt.y=e[i-1];break;case"m":{let t=0;"x"in ldt||(xdt(ldt.x=e[0],ldt.y=e[1]),t=2);for(n=t;n<i;n+=2)xdt(ldt.x+=e[n],ldt.y+=e[n+1]);break}case"l":case"t":for(n=0;n<i;n+=2)xdt(ldt.x+=e[n],ldt.y+=e[n+1]);break;case"h":for(n=0;n<i;++n)xdt(ldt.x+=e[n],ldt.y);break;case"v":for(n=0;n<i;++n)xdt(ldt.x,ldt.y+=e[n]);break;case"c":for(n=0;n<i;n+=6)xdt(ldt.x+e[n],ldt.y+e[n+1]),xdt(ldt.x+e[n+2],ldt.y+e[n+3]),xdt(ldt.x+=e[n+4],ldt.y+=e[n+5]);break;case"s":case"q":for(n=0;n<i;n+=4)xdt(ldt.x+e[n],ldt.y+e[n+1]),xdt(ldt.x+=e[n+2],ldt.y+=e[n+3]);break;case"A":for(n=0;n<i;n+=7)xdt(e[n+5],e[n+6]);ldt.x=e[i-2],ldt.y=e[i-1];break;case"a":for(n=0;n<i;n+=7)xdt(ldt.x+=e[n+5],ldt.y+=e[n+6])}}function Mdt(t,e,i){const n=rdt[t.toLowerCase()];let s;"number"==typeof n&&(n?e.length>=n&&(s={action:t,args:e.slice(0,e.length-e.length%n)},i.push(s),_dt(s)):(s={action:t,args:[]},i.push(s),_dt(s)))}function kdt(t){const e=("string"!=typeof t.path?ddt(t.path):t.path).match(odt),i=[];if(adt={},ldt={},!e)return null;let n="",s=[];const r=e.length;for(let t=0;t<r;++t){const r=e[t],o=parseFloat(r);isNaN(o)?(n&&Mdt(n,s,i),s=[],n=r):s.push(o)}Mdt(n,s,i);const o={x:0,y:0,width:0,height:0};return adt&&"left"in adt&&(o.x=adt.left,o.y=adt.top,o.width=adt.right-adt.left,o.height=adt.bottom-adt.top),o}function Tdt(t){const e={x:0,y:0,width:0,height:0};if("circle"===t.type)e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if("ellipse"===t.type)e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if("image"===t.type||"rect"===t.type)e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if("path"===t.type){const i=kdt(t);e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height}return e}function Adt(t){const e={x:0,y:0,width:0,height:0};let i=null,n=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(const r of t)i?(i.x=Math.min(i.x,r.x),i.y=Math.min(i.y,r.y),n=Math.max(n,r.x+r.width),s=Math.max(s,r.y+r.height)):(i=e,i.x=r.x,i.y=r.y,n=r.x+r.width,s=r.y+r.height);return i&&(i.width=n-i.x,i.height=s-i.y),i}function Idt(t,e,i,n,s,r,o,a,l){let u=(o&&r?hdt(r,e):e)/2,c=(o&&r?hdt(r,i):i)/2;if(l){const t=l[0],e=l[1];u=(o&&r?hdt(r,t):t)/2,c=(o&&r?hdt(r,e):e)/2}const h=t.width+n,d=t.height+n,f=aB(),p=aB();let m=!1;if(s&&0!==h&&0!==d){const t=e!==i?e/i:h/d,n=e>i?e:i;let s=1,r=1;isNaN(n)||(t>1?(s=n/h,r=n/t/d):(r=n/d,s=n*t/h)),Cz(p,p,bdt(f,s,r,u,c)),m=!0}const y=t.x+(h-n)/2,g=t.y+(d-n)/2;if(Cz(p,p,wdt(f,u-y,c-g)),!m&&(h>e||d>i)){const t=h/e>d/i,n=(t?e:i)/(t?h:d);Cz(p,p,bdt(f,n,n,y,g))}return r&&Cz(p,p,Sdt(f,r,y,g)),a&&Cz(p,p,wdt(f,a[0],a[1])),`matrix(${p[0]},${p[1]},${p[2]},${p[3]},${p[4]},${p[5]})`}function jdt(t,e,i){const n=t?.effects.find((t=>"bloom"===t.type));if(!n)return null;const{strength:s,radius:r}=n,o=s>0?r:0,a=(s+o)*e,l=4*s+1;return ZK("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${i}`,width:"300%",x:"-100%",y:"-100%"},ZK("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(s+.5*o)*(5**(e/100)*(.4+e/100)),result:"dilate"}),ZK("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:a/25}),ZK("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:a/50}),ZK("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},ZK("feFuncR",{slope:l,type:"linear"}),ZK("feFuncG",{slope:l,type:"linear"}),ZK("feFuncB",{slope:l,type:"linear"})),ZK("feMerge",null,ZK("feMergeNode",{in:"intensityBlur"}),ZK("feMergeNode",{in:"intensityBrightness"}),ZK("feGaussianBlur",{stdDeviation:s/10})))}function Cdt(t,e,i,n={}){const s=[],r=[],o=++cdt,a=jdt(n.effectView,e,o);let l=null;if(a){const t=n.effectView?.effects.find((t=>"bloom"===t.type)),s=(t.strength?t.strength+t.radius/2:0)/3,r=e+e*s,o=i+i*s;l=[Math.max(r,10),Math.max(o,10)]}for(let o=0;o<t.length;o++){const a=t[o],u=[],c=[];let h=0,d=0,f=0;for(const t of a){const{shape:e,fill:i,stroke:r,font:o,offset:a}=t;n.ignoreStrokeWidth||"text"===e.type||(h+=r?.width||0);const l=pdt(i),p=mdt(r),m="text"===e.type?ydt(e,o):null;s.push(gdt(l)),u.push(fdt(e,l.fill,p,m,n.ariaLabel)),c.push(Tdt(e)),a&&(d+=a[0],f+=a[1])}const p=Idt(Adt(c),e,i,h,n.scale??!1,n.rotation,n.useRotationSize??!1,[d,f],l);let m=null;if(n.masking){const t=`mask-${o}`,e=n.masking[o];s.push(vdt(e,t)),m=`url(#${t})`}r.push(m?ZK("g",{mask:m},ZK("g",{transform:p},u)):ZK("g",{transform:p},u))}n.useRotationSize&&n.rotation&&(e=hdt(n.rotation,e),i=hdt(n.rotation,i)),a&&(Dt(l),e=l[0],i=l[1]);const u="display: block;";return ZK("svg",{"aria-labelledby":n.ariaLabel,focusable:!1,height:i,role:"img",style:u,width:e,xmlns:tdt},a,ZK("defs",null,s),a?ZK("g",{filter:`url(#bloom${o})`},r):r)}const Edt=new wT("white");function Odt(t){const e=t.symbolLayers?.at(-1);if(e&&"outline"in e)return e?.outline?.size}function Ldt(t){if(!t)return 0;if(SF(t)){const e=Odt(t);return null!=e?e:0}return PT(Kht(t)?.width)}function Ndt(t){if(null==t||!("symbolLayers"in t)||null==t.symbolLayers)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some((t=>"object"===t.type));case"line-3d":return t.symbolLayers.some((t=>"path"===t.type));case"polygon-3d":return t.symbolLayers.some((t=>"object"===t.type||"extrude"===t.type));default:return!1}}function Rdt(t){return t.resource?.href??""}function Pdt(t,e){if(!t)return null;let i=null;return SF(t)?i=Fdt(t):bF(t)&&(i="cim"===t.type?xht(t):t.color?new wT(t.color):null),i?Ddt(i,e):null}function Fdt(t){const e=t.symbolLayers;if(!e)return null;let i=null;return e.forEach((t=>{"object"===t.type&&t.resource?.href||(i="water"===t.type?t.color:t.material?t.material.color:null)})),i?new wT(i):null}function Ddt(t,e){if(null==e||null==t)return t;const i=t.toRgba();return i[3]=i[3]*e,new wT(i)}function $dt(t,e,i){const n=t.symbolLayers;if(!n)return;const s=t=>Ddt(e=e??t??(null!=i?Edt:null),i);n.forEach((t=>{if("object"!==t.type||!t.resource?.href||e)if("water"===t.type)t.color=s(t.color);else{const e=null!=t.material?t.material.color:null,n=s(e);null==t.material?t.material=new DL({color:n}):t.material.color=n,null!=i&&"outline"in t&&null!=t.outline?.color&&(t.outline.color=Ddt(t.outline.color,i))}}))}function zdt(t,e,i){(e=e??t.color)&&(t.color=Ddt(e,i)),null!=i&&"outline"in t&&t.outline?.color&&(t.outline.color=Ddt(t.outline.color,i))}function Udt(t,e,i){t&&(e||null!=i)&&(e&&(e=new wT(e)),SF(t)?$dt(t,e,i):bF(t)&&zdt(t,e,i))}async function Vdt(t,e){const i=t.symbolLayers;i&&await ey(i,(async t=>Gdt(t,e)))}async function Gdt(t,e){switch(t.type){case"extrude":Hdt(t,e);break;case"icon":case"line":case"text":Bdt(t,e);break;case"path":Zdt(t,e);break;case"object":await Wdt(t,e)}}function Bdt(t,e){const i=qdt(e);null!=i&&(t.size=i)}function qdt(t){for(const e of t)if("number"==typeof e)return e;return null}function Hdt(t,e){t.size="number"==typeof e[2]?e[2]:0}async function Wdt(t,e){const{resourceSize:i,symbolSize:n}=await Kdt(t),s=Jdt(e,i,n);t.width=Ydt(e[0],n[0],i[0],s),t.depth=Ydt(e[1],n[1],i[1],s),t.height=Ydt(e[2],n[2],i[2],s)}function Zdt(t,e){const i=Jdt(e,so,[t.width,void 0,t.height]);t.width=Ydt(e[0],t.width,1,i),t.height=Ydt(e[2],t.height,1,i)}function Jdt(t,e,i){for(let n=0;n<3;n++){const s=t[n];switch(s){case"symbol-value":{const t=i[n];return null!=t?t/e[n]:1}case"proportional":break;default:if(s&&e[n])return s/e[n]}}return 1}async function Kdt(t){const{computeObjectLayerResourceSize:e}=await import("./p-58d81405.js"),i=await e(t,10),{width:n,height:s,depth:r}=t,o=[n,r,s];let a=1;for(let t=0;t<3;t++){const e=o[t];if(null!=e){a=e/i[t];break}}for(let t=0;t<3;t++)null==o[t]&&(o[t]=i[t]*a);return{resourceSize:i,symbolSize:o}}function Ydt(t,e,i,n){switch(t){case"proportional":return i*n;case"symbol-value":return null!=e?e:i;default:return t}}function Qdt(t,e){const i=qdt(e);if(null!=i)switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const e=t.width/t.height;e>1?(t.width=i,t.height=i*e):(t.width=i*e,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}async function Xdt(t,e){if(t&&e)return SF(t)?Vdt(t,e):void(bF(t)&&Qdt(t,e))}function tft(t,e,i){if(t&&null!=e)if(SF(t)){const n=t.symbolLayers;n&&n.forEach((t=>{if(t&&"object"===t.type)switch(i){case"tilt":t.tilt=(t.tilt??0)+e;break;case"roll":t.roll=(t.roll??0)+e;break;default:t.heading=(t.heading??0)+e}}))}else bF(t)&&("simple-marker"!==t.type&&"picture-marker"!==t.type&&"text"!==t.type||(t.angle+=e))}function eft(t){if(!t)return null;const e=t.effects.filter((t=>"bloom"!==t.type)).map((t=>t.toJSON()));return N8(e)}async function ift(t,e){const i=await t.fetchSymbol(e);return i||t.fetchCIMSymbol(e)}const nft=O_();function sft(t,e){nft.append(t,e),nft.detach(e)}function rft(t,e,i){const n=Math.ceil(e[0]),s=Math.ceil(e[1]);if(!t.some((t=>!!t.length)))return null;const r=i?.node||document.createElement("div");null!=i.opacity&&(r.style.opacity=i.opacity.toString()),null!=i.effectView&&(r.style.filter=eft(i.effectView));return sft(r,(()=>Cdt(t,n,s,i))),r}function oft(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=document.createElement("canvas");i.width=t,i.height=e,i.style.width=t+"px",i.style.height=e+"px";const n=i.getContext("2d");return n.clearRect(0,0,t,e),n}function aft(t,e,i){return t?hc(t,{responseType:"image"}).then((t=>{const n=t.data,s=n.width,r=n.height,o=s/r;let a=e;if(i){const t=Math.max(s,r);a=Math.min(a,t)}return{image:n,width:o<=1?Math.ceil(a*o):a,height:o<=1?a:Math.ceil(a/o)}})):Promise.reject(new Qe("renderUtils: imageDataSize","href not provided."))}function lft(t,e){return!(!t||"ignore"===e)&&("multiply"!==e||255!==t.r||255!==t.g||255!==t.b||1!==t.a)}function uft(t,e,i,n,s){switch(s){case"multiply":t[e]*=i[0],t[e+1]*=i[1],t[e+2]*=i[2],t[e+3]*=i[3];break;default:{const s=h2({r:t[e],g:t[e+1],b:t[e+2]});s.h=n.h,s.s=n.s,s.v=s.v/100*n.v;const r=c2(s);t[e]=r.r,t[e+1]=r.g,t[e+2]=r.b,t[e+3]*=i[3];break}}}function cft(t,e,i,n,s){return aft(t,e,s).then((s=>{const r=s.width??e,o=s.height??e;if(s.image&&lft(i,n)){let e=s.image.width,a=s.image.height;c("edge")&&/\.svg$/i.test(t)&&(e-=1,a-=1);const l=oft(r,o);l.drawImage(s.image,0,0,e,a,0,0,r,o);const u=l.getImageData(0,0,r,o),h=[i.r/255,i.g/255,i.b/255,i.a],d=h2(i);for(let t=0;t<u.data.length;t+=4)uft(u.data,t,h,d,n);l.putImageData(u,0,0),t=l.canvas.toDataURL("image/png")}else{const e=Qu?.findCredential(t);if(e?.token){const i=t.includes("?")?"&":"?";t=`${t}${i}token=${e.token}`}}return{url:t,width:r,height:o}})).catch((()=>({url:t,width:e,height:e})))}const hft="esri-relationship-ramp",dft=`${hft}--diamond`,fft=`${hft}--square`,pft="http://www.w3.org/2000/svg",mft={diamondContainer:`${dft}__container`,diamondLeftCol:`${dft}__left-column`,diamondRightCol:`${dft}__right-column`,diamondMidCol:`${dft}__middle-column`,diamondMidColLabel:`${dft}__middle-column--label`,diamondMidColRamp:`${dft}__middle-column--ramp`,squareTable:`${fft}__table`,squareTableRow:`${fft}__table-row`,squareTableCell:`${fft}__table-cell`,squareTableLabel:`${fft}__table-label`,squareTableLabelLeftBottom:`${fft}__table-label--left-bottom`,squareTableLabelRightBottom:`${fft}__table-label--right-bottom`,squareTableLabelLeftTop:`${fft}__table-label--left-top`,squareTableLabelRightTop:`${fft}__table-label--right-top`};function yft(t,e,i={}){const{focus:n,labels:s}=t,r=!!n,o=vft(t,e,i),a={justifyContent:"center"},l=Bx();return r?ZK("div",{class:mft.diamondContainer,styles:a},ZK("div",{class:mft.diamondLeftCol},l?s.right:s.left),ZK("div",{class:mft.diamondMidCol},ZK("div",{class:mft.diamondMidColLabel},s.top),o,ZK("div",{class:mft.diamondMidColLabel},s.bottom)),ZK("div",{class:mft.diamondRightCol},l?s.left:s.right)):ZK("div",{class:mft.squareTable},ZK("div",{class:mft.squareTableRow},ZK("div",{class:Vx(mft.squareTableCell,mft.squareTableLabel,mft.squareTableLabelRightBottom)},l?s.top:s.left),ZK("div",{class:mft.squareTableCell}),ZK("div",{class:Vx(mft.squareTableCell,mft.squareTableLabel,mft.squareTableLabelLeftBottom)},l?s.left:s.top)),ZK("div",{class:mft.squareTableRow},ZK("div",{class:mft.squareTableCell}),o,ZK("div",{class:mft.squareTableCell})),ZK("div",{class:mft.squareTableRow},ZK("div",{class:Vx(mft.squareTableCell,mft.squareTableLabel,mft.squareTableLabelRightTop)},l?s.right:s.bottom),ZK("div",{class:mft.squareTableCell}),ZK("div",{class:Vx(mft.squareTableCell,mft.squareTableLabel,mft.squareTableLabelLeftTop)},l?s.bottom:s.right)))}function gft(t,e,i){const n=`${i}_arrowStart`,s=`${i}_arrowEnd`,r="left"===t,o={markerStart:null,markerEnd:null};switch(e){case"HL":r?o.markerStart=`url(#${s})`:o.markerEnd=`url(#${n})`;break;case"LL":o.markerStart=`url(#${s})`;break;case"LH":r?o.markerEnd=`url(#${n})`:o.markerStart=`url(#${s})`;break;default:o.markerEnd=`url(#${n})`}return o}function vft(t,e,i={}){const{focus:n,numClasses:s,colors:r,rotation:o}=t,{opacity:a,effectList:l,ariaLabel:u}=i,c=i.size??60,h=!!n,d=Math.sqrt(c**2+c**2)+(h?0:5),f=[],p=[],m=[],y=(c||75)/s;for(let t=0;t<s;t++){const e=t*y;for(let i=0;i<s;i++){const n=i*y,s=pdt(r[t][i]),o=mdt(null),a={type:"rect",x:n,y:e,width:y,height:y},l=gdt(s);l&&f.push(l);const u=fdt(a,s.fill,o,null);u&&p.push(u),m.push(Tdt(a))}}const g=10,v=15,w=15,b=10;let S=null;h||(S="margin: -15px -15px -18px -15px");const x=gft("left",n,e),_=gft("right",n,e),M=Adt(m),k=Idt(M,d,d,0,!1,o,!1),T=Idt(M,d,d,0,!1,h?-45:null,!1),A={filter:eft(l)??void 0,opacity:null==a?"":`${a}`};return ZK("div",{class:h?mft.diamondMidColRamp:mft.squareTableCell,styles:A},ZK("svg",{"aria-labelledBy":u,focusable:!1,height:d,role:"image",style:S,width:d,xmlns:pft},ZK("defs",null,ZK("marker",{id:`${e}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},ZK("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),ZK("marker",{id:`${e}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},ZK("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),f),ZK("g",{transform:k},p),ZK("g",{transform:T},ZK("line",{fill:"none","marker-end":x.markerEnd,"marker-start":x.markerStart,stroke:"#555555","stroke-width":"1",x1:-g,x2:-g,y1:c-v,y2:v}),ZK("line",{fill:"none","marker-end":_.markerEnd,"marker-start":_.markerStart,stroke:"#555555","stroke-width":"1",x1:w,x2:c-w,y1:c+b,y2:c+b}))))}function wft(t){return t=t||globalThis.location.hostname,kft.some((e=>null!=t?.match(e)))}function bft(t,e){return t&&(e=e||globalThis.location.hostname)?null!=e.match(Sft)||null!=e.match(_ft)?t.replace("static.arcgis.com","staticdev.arcgis.com"):null!=e.match(xft)||null!=e.match(Mft)?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t}const Sft=/^devext.arcgis.com$/,xft=/^qaext.arcgis.com$/,_ft=/^[\w-]*\.mapsdevext.arcgis.com$/,Mft=/^[\w-]*\.mapsqa.arcgis.com$/,kft=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,Sft,xft,/^jsapps.esri.com$/,_ft,Mft];function Tft(t,e,i,n){const s=t.name;return null==s?Promise.reject(new Qe("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&"Esri2DPointSymbolsStyle"===t.styleName?jft(s,e,n):B5(t,e,n).then((t=>Ift(t,s,e,i,H5,n)))}function Aft(t,e){return e.items.find((e=>e.name===t))}function Ift(t,e,i,n,s,r){const o=null!=i?.portal?i.portal:YM.getDefault(),a={portal:o,url:Ul(t.baseUrl),origin:"portal-item"},l=Aft(e,t.data);if(!l){const t=`The symbol name '${e}' could not be found`;return Promise.reject(new Qe("symbolstyleutils:symbol-name-not-found",t,{symbolName:e}))}let u=sk(s(l,n),a),c=l.thumbnail?.href??null;const h=l.thumbnail?.imageData;wft()&&(u=bft(u)??"",c=bft(c));const d={portal:o,url:Ul(Eu(u)),origin:"portal-item"};return W5(u,r).then((s=>{const r="cimRef"===n?q5(s.data):s.data,o=l0(r,d);if(o&&SF(o)){if(c){const t=sk(c,a);o.thumbnail=new oP({url:t})}else h&&(o.thumbnail=new oP({url:`data:image/png;base64,${h}`}));t.styleUrl?o.styleOrigin=new sP({portal:i.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(o.styleOrigin=new sP({portal:i.portal,styleName:t.styleName,name:e}))}return o}))}function jft(t,e,i){const n=K5.replaceAll(/\{SymbolName\}/gi,t),s=null!=e.portal?e.portal:YM.getDefault();return W5(n,i).then((t=>{const e=q5(t.data);return l0(e,{portal:s,url:Ul(Eu(n)),origin:"portal-item"})}))}const Cft=Object.freeze({__proto__:null,fetchSymbolFromStyle:Ift,getStyleItemFromStyle:Aft,resolveWebStyleSymbol:Tft});const Eft=Aht.size,Oft=Aht.maxSize,Lft=Aht.maxOutlineSize,Nft=Aht.lineWidth,Rft=Aht.tallSymbolWidth;function Pft(t){const e=t.outline,i=null!=t.material?t.material.color:null,n=null!=i?i.toHex():null;if(null==e||"pattern"in e&&null!=e.pattern&&"style"===e.pattern.type&&"none"===e.pattern.style)return"fill"===t.type&&"#ffffff"===n?{color:"#bdc3c7",width:.75}:null;const s=RT(e.size)||0;return{color:"rgba("+(null!=e.color?e.color.toRgba():"255,255,255,1")+")",width:Math.min(s,Lft),style:"pattern"in e&&null!=e.pattern&&"style"===e.pattern.type?Qht(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function Fft(t,e){if(t.thumbnail?.url)return t.thumbnail.url;if("icon"===e.type){const t=e?.resource?.href;if(t)return Rdt(e)}const i=Nc("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const e=await Tft(t.styleOrigin,{portal:t.styleOrigin.portal},"webRef").catch((()=>null));if(e&&"thumbnail"in e&&e.thumbnail?.url)return e.thumbnail.url}return i}function Dft(t,e=1){const i=t.a,n=h2(t),s=n.h,r=n.s/e,o=100-(100-n.v)/e,{r:a,g:l,b:u}=c2({h:s,s:r,v:o});return[a,l,u,i]}function $ft(t){return"water"===t.type?null==t.color?null:t.color:null==t.material?.color?null:t.material.color}function zft(t,e=0){const i=$ft(t);if(!i){if("fill"===t.type)return null;const i=Xht.r,n=Dht(i,e);return[n,n,n,100]}const n=i.toRgba();for(let t=0;t<3;t++)n[t]=Dht(n[t],e);return n}async function Uft(t,e){const i=t.style;if("none"===i)return null;return{type:"pattern",x:0,y:0,src:await Jht(Nc(`esri/symbols/patterns/${i}.png`),e.toCss(!0)),width:5,height:5}}function Vft(t){return t.outline?Pft(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function Gft(t,e){const i=$ft(t);if(!i)return null;let n="rgba(";return n+=Dht(i.r,e)+",",n+=Dht(i.g,e)+",",n+=Dht(i.b,e)+",",n+i.a+");"}function Bft(t,e){const i=Gft(t,e);if(!i)return{};if("pattern"in t&&null!=t.pattern&&"style"===t.pattern.type&&"none"===t.pattern.style)return null;return{color:i,width:Math.min(t.size?RT(t.size):.75,Lft),style:"pattern"in t&&null!=t.pattern&&"style"===t.pattern.type?Qht(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?"miter"===t.join?RT(2):t.join:null}}function qft(t,e,i){const n=null!=i?.75*i:0;return{type:"linear",x1:n?.25*n:0,y1:n?.5*n:0,x2:n||4,y2:n?.5*n:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function Hft(t){const e=t.depth,i=t.height,n=t.width;return 0!==n&&0!==e&&0!==i&&n===e&&null!=n&&null!=i&&n<i}function Wft(t,e,i){const n=[];if(!t)return n;switch(t.type){case"icon":{const i=0,s=0,r=e,o=e;switch(t.resource&&t.resource.primitive||mR){case"circle":n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:zft(t,0),stroke:Pft(t)});break;case"square":n.push({shape:{type:"path",path:[{command:"M",values:[i,o]},{command:"L",values:[i,s]},{command:"L",values:[r,s]},{command:"L",values:[r,o]},{command:"Z",values:[]}]},fill:zft(t,0),stroke:Pft(t)});break;case"triangle":n.push({shape:{type:"path",path:[{command:"M",values:[i,o]},{command:"L",values:[.5*r,s]},{command:"L",values:[r,o]},{command:"Z",values:[]}]},fill:zft(t,0),stroke:Pft(t)});break;case"cross":n.push({shape:{type:"path",path:[{command:"M",values:[.5*r,s]},{command:"L",values:[.5*r,o]},{command:"M",values:[i,.5*o]},{command:"L",values:[r,.5*o]}]},stroke:Vft(t)});break;case"x":n.push({shape:{type:"path",path:[{command:"M",values:[i,s]},{command:"L",values:[r,o]},{command:"M",values:[r,s]},{command:"L",values:[i,o]}]},stroke:Vft(t)});break;case"kite":n.push({shape:{type:"path",path:[{command:"M",values:[i,.5*o]},{command:"L",values:[.5*r,s]},{command:"L",values:[r,.5*o]},{command:"L",values:[.5*r,o]},{command:"Z",values:[]}]},fill:zft(t,0),stroke:Pft(t)})}break}case"object":switch(t.resource&&t.resource.primitive||PR){case"cone":{const s=qft(zft(t,0),zft(t,-.6),i?Rft:e),r=Nht(e,i);n.push({shape:r[0],fill:s},{shape:r[1],fill:s});break}case"inverted-cone":{const i=zft(t,0),s=qft(i,zft(t,-.6),e),r=Rht(e);n.push({shape:r[0],fill:s},{shape:r[1],fill:i});break}case"cube":{const s=Oht(e,i);n.push({shape:s[0],fill:zft(t,0)},{shape:s[1],fill:zft(t,-.3)},{shape:s[2],fill:zft(t,-.5)});break}case"cylinder":{const s=qft(zft(t,0),zft(t,-.6),i?Rft:e),r=Lht(e,i);n.push({shape:r[0],fill:s},{shape:r[1],fill:s},{shape:r[2],fill:zft(t,0)});break}case"diamond":{const i=Pht(e);n.push({shape:i[0],fill:zft(t,-.3)},{shape:i[1],fill:zft(t,0)},{shape:i[2],fill:zft(t,-.3)},{shape:i[3],fill:zft(t,-.7)});break}case"sphere":{const i=qft(zft(t,0),zft(t,-.6));i.x1=0,i.y1=0,i.x2=.25*e,i.y2=.25*e,n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:i});break}case"tetrahedron":{const i=Fht(e);n.push({shape:i[0],fill:zft(t,-.3)},{shape:i[1],fill:zft(t,0)},{shape:i[2],fill:zft(t,-.6)});break}}break}return n}function Zft(t){const e="number"==typeof t?.size?t?.size:null;return e?RT(e):null}function Jft(t){return"icon"===t.type?"multiply":"tint"}async function Kft(t,e){const i=Zft(e),n=e?.maxSize?RT(e.maxSize):null,s=e?.disableUpsampling??!1,r=t.symbolLayers,o=[];let a=0,l=0;const u=r.at(-1);let c;u&&"icon"===u.type&&(c=u.size&&RT(u.size)),r.forEach((r=>{if("icon"!==r.type&&"object"!==r.type)return;const u="icon"===r.type?r.size&&RT(r.size):0,h=i||u?Math.ceil(Math.min(i||u,n||Oft)):Eft;if(r?.resource?.href){const e=Fft(t,r).then((t=>{const e=r?.material?.color,i=Jft(r);return cft(t,h,e,i,s)})).then((t=>{const e=t.width,i=t.height;return a=Math.max(a,e),l=Math.max(l,i),[{shape:{type:"image",x:0,y:0,width:e,height:i,src:t.url},fill:null,stroke:null}]}));o.push(e)}else{let t=h;"icon"===r.type&&c&&i&&(t=h*(u/c));const n="tall"===e?.symbolConfig||e?.symbolConfig?.isTall||"object"===r.type&&Hft(r);a=Math.max(a,n?Rft:t),l=Math.max(l,t),o.push(Promise.resolve(Wft(r,t,n)))}}));const h=await Promise.allSettled(o),d=[];return h.forEach((t=>{"fulfilled"===t.status?d.push(t.value):t.reason&&Ft.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",t.reason)})),rft(d,[a,l],{node:e?.node,scale:!1,opacity:e?.opacity,ariaLabel:e?.ariaLabel})}function Yft(t,e){const i=t.symbolLayers,n=[],s=Ndt(t),r=Zft(e),o=(e?.maxSize?RT(e.maxSize):null)||Lft;let a,l=0,u=0;return i.forEach(((t,e)=>{if(!t)return;if("line"!==t.type&&"path"!==t.type)return;const i=[];switch(t.type){case"line":{const n=Bft(t,0);if(null==n)break;const s=n?.width||0;0===e&&(a=s);const c=Math.min(r||s,o),h=0===e?c:r?c*(s/a):c,d=h>Nft/2?2*h:Nft;u=Math.max(u,h),l=Math.max(l,d),n.width=h,i.push({shape:{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[l,.5*u]}]},stroke:n});break}case"path":{const e=Math.min(r||Eft,o),n=zft(t,0),s=zft(t,-.2),a=Gft(t,-.4),c=a?{color:a,width:1}:{};if("quad"===t.profile){const e=t.width,r=t.height,o=jht(e&&r?e/r:1,0===r,0===e),a={...c,join:"bevel"};i.push({shape:o[0],fill:s,stroke:a},{shape:o[1],fill:s,stroke:a},{shape:o[2],fill:n,stroke:a})}else i.push({shape:Iht.pathSymbol3DLayer[0],fill:s,stroke:c},{shape:Iht.pathSymbol3DLayer[1],fill:n,stroke:c});u=Math.max(u,e),l=u}}n.push(i)})),Promise.resolve(rft(n,[l,u],{node:e?.node,scale:s,opacity:e?.opacity,ariaLabel:e?.ariaLabel}))}async function Qft(t,e){const i="mesh-3d"===t.type,n=t.symbolLayers,s=Zft(e),r=e?.maxSize?RT(e.maxSize):null,o=s||Eft,a=[];let l=0,u=0,c=!1;for(let t=0;t<n.length;t++){const e=n.at(t),s=[];if(!i||"fill"===e.type){switch(e.type){case"fill":{const t=Math.min(o,r||Oft);if(l=Math.max(l,t),u=Math.max(u,t),c=!0,i){const t=Iht.meshSymbol3DFill,i=Gft(e,-.4),n=i?{color:i,width:1,join:"round"}:{};s.push({shape:t[0],fill:zft(e,0),stroke:n},{shape:t[1],fill:zft(e,-.2),stroke:n},{shape:t[2],fill:zft(e,-.6),stroke:n})}else{let t=zft(e,0);const i="pattern"in e?e.pattern:null,n=Pft(e),r=$ft(e);null!=i&&"style"===i.type&&"solid"!==i.style&&r&&(t=await Uft(i,r)),s.push({shape:Iht.fill[0],fill:t,stroke:n})}break}case"line":{const t=Bft(e,0);if(null==t)break;const i={stroke:t,shape:Iht.fill[0]};l=Math.max(l,Eft),u=Math.max(u,Eft),s.push(i);break}case"extrude":{const t={join:"round",width:1,...Bft(e,-.4)},i=zft(e,0),n=zft(e,-.2),a=Math.min(o,r||Oft),c=Cht(a);t.width=1,s.push({shape:c[0],fill:n,stroke:t},{shape:c[1],fill:n,stroke:t},{shape:c[2],fill:i,stroke:t});const h=Eft,d=.7*Eft+.5*a;l=Math.max(l,h),u=Math.max(u,d);break}case"water":{const t=$ft(e),i=Dft(t),n=Dft(t,2),a=Dft(t,3),h=Eht();c=!0,s.push({shape:h[0],fill:i},{shape:h[1],fill:n},{shape:h[2],fill:a});const d=Math.min(o,r||Oft);l=Math.max(l,d),u=Math.max(u,d);break}}a.push(s)}}return rft(a,[l,u],{node:e?.node,scale:c,opacity:e?.opacity,ariaLabel:e?.ariaLabel})}function Xft(t,e){if(0===t.symbolLayers.length)return Promise.reject(new Qe("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return Kft(t,e);case"line-3d":return Yft(t,e);case"polygon-3d":case"mesh-3d":return Qft(t,e)}return Promise.reject(new Qe("symbolPreview: swatchInfo3D","symbol not supported."))}const tpt=Object.freeze({__proto__:null,getPatternDescriptor:Uft,getSizeFromOptions:Zft,getSymbolLayerFill:zft,previewSymbol3D:Xft});const ept={HH:315,HL:45,LL:135,LH:225},ipt={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function npt(t){if(!t)return;const{type:e}=t;if(e.includes("3d"))return zft(t.symbolLayers.at(0));if("simple-line"===e){const e=Kht(t);return e&&e.color}if("simple-marker"===t.type&&("x"===t.style||"cross"===t.style)){const e=Kht(t);return e&&e.color}return Zht(t)}function spt(t,e){const i=e.HH.label,n=e.LL.label,s=e.HL.label,r=e.LH.label;switch(t){case"HH":default:return{top:i,bottom:n,left:s,right:r};case"HL":return{top:s,bottom:r,left:n,right:i};case"LL":return{top:n,bottom:i,left:r,right:s};case"LH":return{top:r,bottom:s,left:i,right:n}}}function rpt(t){const{focus:e,infos:i,numClasses:n}=t,s=ipt[n],r={};i.forEach((t=>{r[t.value]={label:t.label,fill:npt(t.symbol)}}));const o=[];for(let t=0;t<n;t++){const e=[];for(let i=0;i<n;i++){const n=r[s[t][i]];e.push(n.fill)}o.push(e)}return{type:"relationship-ramp",numClasses:n,focus:e,colors:o,labels:spt(e,r),rotation:opt(e)}}function opt(t){let e=ept[t];return t&&null==e&&(e=ept.HH),e||0}let apt=null;const lpt=[255,255,255];function upt(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function cpt(t,e,i){const{backgroundColor:n,outline:s,dotSize:r}=t,o=i?.swatchSize||Aht.size,a=.8,l=Math.round(o*o/Math.max(r,.5)**2*a),u=window.devicePixelRatio,c=document.createElement("canvas"),h=o*u;c.width=h,c.height=h,c.style.width=c.width/u+"px",c.style.height=c.height/u+"px";const d=c.getContext("2d");if(n&&(d.fillStyle=n.toCss(!0),d.fillRect(0,0,h,h),d.fill()),d.fillStyle=e?.toCss(!0)??"",apt&&apt.length/2===l)for(let t=0;t<2*l;t+=2){const e=apt[t],i=apt[t+1];d.fillRect(e,i,r*u,r*u),d.fill()}else{apt=[];for(let t=0;t<2*l;t+=2){const t=upt(0,h),e=upt(0,h);apt.push(t,e),d.fillRect(t,e,r*u,r*u),d.fill()}}s&&(s.color&&(d.strokeStyle=s.color.toCss(!0)),d.lineWidth=s.width,d.strokeRect(0,0,h,h));const f=new Image(o,o);return f.src=c.toDataURL(),f.ariaLabel=i?.ariaLabel??null,f.alt=i?.ariaLabel??"",f}function hpt(t,e={}){const i=e.radius||40,n=2*Math.PI*i,s=t.length,r=n/s,o=[],a=Kht(e.outline);null!=a?.width&&(a.width*=2),(a||e.backgroundColor)&&o.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:e.backgroundColor,stroke:a,offset:[0,0]});const l=e.values,u=l&&l.length===s&&100===l.reduce(((t,e)=>t+e),0),c=[0];for(let e=0;e<s;e++){let s=null;u&&(s=l[e]*n/100,c.push(s+c[e])),o.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(s??r)/2} ${n}`,dashoffset:"-"+(u?c[e]/2:e*(r/2)),color:t[e]},offset:[0,0]})}let h=null;const d=2*i+(a?.width||0),f=e.holePercentage;if(f){a&&o.push({shape:{type:"circle",cx:i,cy:i,r:i*f},fill:null,stroke:a,offset:[0,0]});const t=d/2;h=[[{shape:{type:"circle",cx:t,cy:t,r:t},fill:lpt,stroke:a?{...a,color:lpt}:null,offset:[0,0]},{shape:{type:"circle",cx:t,cy:t,r:i*f},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return rft([o],[d,d],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:h,rotation:-90,ariaLabel:e.ariaLabel})}function dpt(t,e={}){const i=24,n=75,s="horizontal"===e.align,r=s?n:i,o=s?i:n,a=e.width??r,l=e.height??o,u=e.gradient??!0,c=window.devicePixelRatio,h=a*c,d=l*c,f=document.createElement("canvas");f.width=h,f.height=d,f.ariaLabel=e.ariaLabel??null,f.style.width=`${a}px`,f.style.height=`${l}px`;const p=f.getContext("2d"),m=s?h:0,y=s?0:d;if(u){const e=p.createLinearGradient(0,0,m,y),i=t.length,n=1===i?0:1/(i-1);t.forEach(((t,i)=>e.addColorStop(i*n,t.toString()))),p.fillStyle=e,p.fillRect(0,0,h,d)}else{const e=s?h/t.length:h,i=s?d:d/t.length;let n=0,r=0;for(const o of t)p.fillStyle=o.toString(),p.fillRect(n,r,e,i),n=s?n+e:0,r=s?0:r+i}const g=document.createElement("div");return g.style.width=`${a}px`,g.style.height=`${l}px`,fpt(g,e?.effectList),g.appendChild(f),g}function fpt(t,e){if(!e)return;t.style.filter=eft(e);const i=e.effects;if(i)for(const e of i)if("drop-shadow"===e?.type){e.offsetX<0?t.style.marginLeft=`${Math.abs(e.offsetX)}px`:t.style.marginRight=`${e.offsetX}px`;break}}async function ppt(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:i}=await import("./p-f35b125d.js");return i(t,ppt,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await Promise.resolve().then((function(){return tpt}));return i(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await import("./p-8ae0c5b6.js");return i(t,e)}case"cim":{const{previewCIMSymbol:i}=await import("./p-334e8d68.js");return i(t,e)}default:return}}function mpt(t){return t&&"opacity"in t?t.opacity*mpt(t.parent):1}async function ypt(t,e){if(!t)return;const i=t.sourceLayer,n=(null!=e&&e.useSourceLayer?i:t.layer)??i,s=mpt(n);if(null!=t.symbol&&(null==e||!0!==e.ignoreGraphicSymbol)){const i="web-style"===t.symbol.type?await ift(t.symbol,{...e,cache:null!=e?e.webStyleCache:null}):t.symbol.clone();return Udt(i,null,s),i}const r=e?.renderer??gpt(n);let o=r&&"getSymbolAsync"in r?await r.getSymbolAsync(t,e):null;if(!o)return;if(o="web-style"===o.type?await o.fetchSymbol({...e,cache:null!=e?e.webStyleCache:null}):o.clone(),!r||!("visualVariables"in r)||!r.visualVariables?.length)return Udt(o,null,s),o;if("arcadeRequiredForVisualVariables"in r&&r.arcadeRequiredForVisualVariables&&null==e?.arcade){const t={...e};t.arcade=await rC(),e=t}const{getColor:a,getOpacity:l,getAllSizes:u,getRotationAngle:c}=await Promise.resolve().then((function(){return zX})),h=[],d=[],f=[],p=[];for(const t of r.visualVariables)switch(t.type){case"color":h.push(t);break;case"opacity":d.push(t);break;case"rotation":p.push(t);break;case"size":t.target||f.push(t)}const m=!!h.length&&h[h.length-1],y=m?a(m,t,e):null,g=!!d.length&&d[d.length-1];let v=g?l(g,t,e):null;if(null!=s&&(v=null!=v?v*s:s),Udt(o,y,v),f.length){const i=u(f,t,e);await Xdt(o,i)}for(const i of p)tft(o,c(i,t,e),i.axis);return o}function gpt(t){if(t)return"renderer"in t?t.renderer:void 0}function vpt(t,e,i){const n=t.effectiveClusterRenderer;if(!n||!("visualVariables"in n)||!n.visualVariables)return null;const s=n.visualVariables.find((t=>"size"===t.type));if(!("stops"in s)||!s.stops)return null;const r=s.stops.find((t=>t.useMinValue)),o=s.stops.find((t=>t.useMaxValue));if(null==r||null==o)return null;const a=i.featuresTilingScheme.getClosestInfoForScale(i.scale).level,l=s.field,u=e.getDisplayStatistics(a,l);return u?new WX({field:s.field,minSize:t.clusterMinSize,minDataValue:u.minValue,maxSize:t.clusterMaxSize,maxDataValue:u.maxValue}):null}const wpt=/^-?(\d+)(\.(\d+))?$/i;function bpt(t,e){return t-e}function Spt(t,e){let i,n;return i=Number(t.toFixed(e)),i<t?n=i+1/10**e:(n=i,i-=1/10**e),i=Number(i.toFixed(e)),n=Number(n.toFixed(e)),[i,n]}function xpt(t,e,i,n,s){const r=Mpt(t,e,i,n),o=null==r.previous||r.previous<=s,a=null==r.next||r.next<=s;return o&&a||r.previous+r.next<=2*s}function _pt(t){const e=String(t),i=e.match(wpt);if(i&&i[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(e.toLowerCase().includes("e")){const t=e.split("e"),i=t[0],n=t[1];if(i&&n){const t=Number(i);let e=Number(n);const s=e>0;s||(e=Math.abs(e));const r=_pt(t);return s?(r.integer+=e,e>r.fractional?r.fractional=0:r.fractional-=e):(r.fractional+=e,e>r.integer?r.integer=1:r.integer-=e),r}}return{integer:0,fractional:0}}function Mpt(t,e,i,n){const s={previous:null,next:null};if(null!=i){const n=t-i,r=e-i-n;s.previous=Math.floor(Math.abs(100*r/n))}if(null!=n){const i=n-t,r=n-e-i;s.next=Math.floor(Math.abs(100*r/i))}return s}function kpt(t,e={}){const i=t.slice(0),{tolerance:n=2,strictBounds:s=!1,indexes:r=i.map(((t,e)=>e))}=e;r.sort(bpt);for(let t=0;t<r.length;t++){const e=r[t],o=i[e],a=0===e?null:i[e-1],l=e===i.length-1?null:i[e+1],u=_pt(o).fractional;if(u){let r,c=0,h=!1;for(;c<=u&&!h;){const e=Spt(o,c);r=s&&0===t?e[1]:e[0],h=xpt(o,r,a,l,n),c++}h&&(i[e]=r)}}return i}const Tpt={maximumFractionDigits:20};function Apt(t){return iv(t,Tpt)}function Ipt(t){return hE(t)||dE(t)||fE(t)}function jpt(t,e){const{format:i,timeZoneOptions:n,fieldType:s}=e??{};let r,o;if(n&&({timeZone:r,timeZoneName:o}=Tg(n.layerTimeZone,n.datesInUnknownTimezone,n.viewTimeZone,qg(i||"short-date-short-time"),s)),"string"==typeof t&&isNaN(Date.parse("time-only"===s?`1970-01-01T${t}Z`:t)))return t;switch(s){case"date-only":{const e=qg(i||"short-date");return"string"==typeof t?Wg(t,{...e}):Hg(t,{...e,timeZone:yg})}case"time-only":{const e=qg(i||"short-time");return"string"==typeof t?Zg(t,e):Hg(t,{...e,timeZone:yg})}case"timestamp-offset":{if(!r&&"string"==typeof t&&new Date(t).toISOString()!==t)return t;const e=i||n?qg(i||"short-date-short-time"):void 0,s=e?{...e,timeZone:r,timeZoneName:o}:void 0;return"string"==typeof t?Jg(t,s):Hg(t,s)}default:{const e=i||n?qg(i||"short-date-short-time"):void 0;return Hg("string"==typeof t?new Date(t):t,e?{...e,timeZone:r,timeZoneName:o}:void 0)}}}const Cpt="<",Ept=">";function Opt(t,e,i,n){let s="";0===e?s=`${Cpt} `:e===i&&(s=`${Ept} `);return s+(n?jpt(t,n):Apt(t))}const Lpt=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function Npt(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find((t=>"color"===t.type));if(!e)return null;let i=null,n=null;if(e.stops){if(1===e.stops.length)return e.stops[0].color;i=e.stops[0].value,n=e.stops[e.stops.length-1].value}const s=null!=i&&null!=n?i+(n-i)/2:0,{getColor:r}=await Promise.resolve().then((function(){return zX}));return r(e,s)??null}async function Rpt(t,e){const i=t.trailCap,n=t.trailWidth||1,s=e||await Npt(t)||t.color;return new QL({cap:i,color:s,width:n})}function Ppt(t){return null!=t&&"object"==typeof t&&"min"in t&&"max"in t}function Fpt(t,e){if(!e.field)return null;if("featureReduction"in t)switch(t.featureReduction?.type){case"cluster":case"binning":{const i=t.featureReduction.fields.find((({name:t})=>t.toLowerCase()===e.field.toLowerCase()));return i&&"getField"in t?t.getField(i.onStatisticField):null}}return"getField"in t?t.getField?.(e.field):null}function Dpt(t,e){const i="popupTemplate"in t?t.popupTemplate?.fieldInfos:null;if(i?.length&&e)return i.find((t=>t.fieldName?.toLowerCase()===e.toLowerCase()))?.format?.dateFormat}function $pt(t,e,i){const n=Fpt(t,e);if(!n||!Ipt(n)&&!pE(n))return null;let s=Dpt(t,n.name);if(!s&&"date"===n.type){let t=0,i=0;e.stops?(t=e.stops?.at(0)?.value??t,i=e.stops?.at(-1)?.value??i):"minDataValue"in e&&"maxDataValue"in e&&(t=e.minDataValue??t,i=e.maxDataValue??i),s=i-t>2*JI.days?"short-date":"short-date-short-time"}return{fieldType:n.type,format:s,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:i,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}const zpt=new wT([64,64,64]);function Upt(t,e){const i=[],n=t.length-1;return 5===t.length?i.push(0,2,4):i.push(0,n),t.map(((t,s)=>i.includes(s)?Opt(t,s,n,e):null))}async function Vpt(t,e,i){let n=!1,s=[],r=[];if(t.stops){const e=t.stops;s=e.map((t=>t.value)),n=e.some((t=>!!t.label)),n&&(r=e.map((t=>t.label)))}const o=s[0],a=s[s.length-1];if(null==o&&null==a)return null;const l=n?null:Upt(s,i);return(await Promise.all(s.map((async(i,s)=>({value:i,color:"opacity"===t.type?await Gpt(i,t,e):(await Promise.resolve().then((function(){return zX}))).getColor(t,i),label:n?r[s]:l?.[s]??""}))))).reverse()}async function Gpt(t,e,i){const n=new wT(i??zpt),s=(await Promise.resolve().then((function(){return zX}))).getOpacity(e,t);return null!=s&&(n.a=s),n}function Bpt(t){let e=!1,i=[],n=[];i=t.map((t=>t.value)),e=t.some((t=>!!t.label)),e&&(n=t.map((t=>t.label??"")));const s=i[0],r=i[i.length-1];if(null==s&&null==r)return null;const o=e?null:Upt(i);return i.map(((i,s)=>({value:i,color:qpt(i,t),label:e?n[s]:o?.[s]??""}))).reverse()}function qpt(t,e){const{startIndex:i,endIndex:n,weight:s}=Hpt(t,e);if(i===n)return e[i].color;const r=wT.blendColors(e[i].color,e[n].color,s);return new wT(r)}function Hpt(t,e){let i=0,n=e.length-1;return e.some(((e,s)=>t<e.value?(n=s,!0):(i=s,!1))),{startIndex:i,endIndex:n,weight:(t-e[i].value)/(e[n].value-e[i].value)}}function Wpt(t,e){let i=[];if(t&&"multipart"===t.type)t.colorRamps.reverse().forEach(((n,s)=>{0===s?i.push({value:e.max,color:new wT(n.toColor),label:"high"}):i.push({value:null,color:new wT(n.toColor),label:""}),s===t.colorRamps.length-1?i.push({value:e.min,color:new wT(n.fromColor),label:"low"}):i.push({value:null,color:new wT(n.fromColor),label:""})}));else{let n,s;t&&"algorithmic"===t.type?(n=t.fromColor,s=t.toColor):(n=[0,0,0,1],s=[255,255,255,1]),i=[{value:e.max,color:new wT(s),label:"high"},{value:e.min,color:new wT(n),label:"low"}]}return i}function Zpt(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter((t=>t.color?.a>0));let i=e.length-1;if(e&&e[0]){const t=e[i];t&&1!==t.ratio&&(e.push(new W3({ratio:1,color:t.color})),i++)}return e.map(((e,n)=>{let s="";return 0===n?s=t.legendOptions?.minLabel||"low":n===i&&(s=t.legendOptions?.maxLabel||"high"),{color:e.color,label:s,ratio:e.ratio}})).reverse()}const Jpt=30,Kpt=12,Ypt=[255,255,255],Qpt=[200,200,200],Xpt=[128,128,128],tmt=20,emt=5;function imt(t){return"esri.symbols.SimpleMarkerSymbol"===t.declaredClass}function nmt(t){return"esri.symbols.PictureMarkerSymbol"===t.declaredClass}function smt(t){return"esri.symbols.SimpleLineSymbol"===t.declaredClass}function rmt(t){return"esri.symbols.TextSymbol"===t.declaredClass}function omt(t,e){const i=t.length-1;return t.map(((t,n)=>Opt(t,n,i,e)))}async function amt(t,e,i,n,s,r,o){const a=e.legendOptions,l=a?.customValues,u=o||await cmt(t,i),c=e.stops,h=!!u,d=!!l,f=null!=e.minSize&&null!=e.maxSize,p=c&&c.length>1,m=!!e.target;if(!h||!d&&!(f||p&&!m))return;const y=Ndt(u);let g=!1,v=null,w=null;v=y&&!p?kpt([e.minDataValue,e.maxDataValue]):l??await pmt(e,u,n,s?.type);const b=t?.authoringInfo,S="univariate-color-size"===b?.type,x=S&&"above-and-below"===b?.univariateTheme;if(!v&&p&&(v=c.map((t=>t.value)),g=c.some((t=>!!t.label)),"flow"===t.type&&(v=kpt(v)),g&&(w=c.map((t=>t.label)))),y&&null!=v&&v?.length>2&&!x&&(v=[v[0],v[v.length-1]]),!v)return null;S&&5!==v?.length&&(v=mmt({minSize:v[0],maxSize:v[v.length-1]}));const _=y?lmt(t,v):null,M=Ldt(u),k=g?null:omt(v,r);return(await Promise.all(v.map((async(i,r)=>{const o=y?_[r]:await vmt(e,u,i,n,s?.type);return{value:i,symbol:wmt(x&&"class-breaks"===t.type?umt(t,r):u,o),label:g?w[r]:k[r],size:o,outlineSize:M}})))).reverse()}function lmt(t,e){const i=t?.authoringInfo,n="univariate-color-size"===i?.type;let s=[Kpt,Jpt];if(n){const t=e[0],i=e[e.length-1],n=Kpt,r=Jpt;s=e.map((e=>n+(e-t)/(i-t)*(r-n)))}return n&&"below"===i?.univariateTheme&&s.reverse(),s}function umt(t,e){const i=t.classBreakInfos,n=i.length,s=n<2||!(e>=2)?i[0].symbol.clone():i[n-1].symbol.clone();return t.visualVariables.some((t=>"color"===t.type))&&(s.type.includes("3d")?dmt(s):fmt(s)),s}async function cmt(t,e){if("flow"===t.type)return Rpt(t,e);if("pie-chart"===t.type)return new fF({color:null,outline:t.outline?.width?t.outline:new QL});let i=null,n=null;if("simple"===t.type)i=t.symbol;else if("class-breaks"===t.type){const e=t.classBreakInfos;i=e&&e[0]&&e[0].symbol,n=e.length>1}else if("unique-value"===t.type){const e=t.uniqueValueInfos;i=e?.[0]?.symbol,n=null!=e&&e.length>1}return!i||hmt(i)?null:(i=i.clone(),(e||n)&&(i.type.includes("3d")?dmt(i):fmt(i)),i)}function hmt(t){if(t){if(SF(t)){return!!t.symbolLayers&&t.symbolLayers.some((t=>t&&"fill"===t.type))}return t.type.includes("fill")}return!1}function dmt(t){"line-3d"===t.type?t.symbolLayers.forEach((t=>{t.material={color:Xpt}})):t.symbolLayers.forEach((t=>{"icon"!==t.type||t.resource?.href?t.material={color:Qpt}:(t.material={color:Ypt},t.outline={color:Xpt,size:1.5})}))}function fmt(t){const e=BW();if("cim"===t.type)kht(t,new wT(Qpt));else if(t.type.includes("line"))t.color=Xpt;else if(t.color=e?Xpt:Ypt,"simple-marker"===t.type)if(t.outline){const e=t.outline?.color?.toHex();"#ffffff"===e&&(t.outline.color=Xpt)}else t.outline={color:Xpt,width:1.5}}async function pmt(t,e,i,n){const s=(await Promise.resolve().then((function(){return zX}))).getSizeRangeAtScale(t,i,n),r=s&&mmt(s);if(!s||!r)return;let o=r.map((e=>ymt(e,t,s)));o=kpt(o);for(let s=1;s<o.length-1;s++){const a=await gmt(t,e,o[s],o[s-1],i,n);a&&(o[s]=a[0],r[s]=a[1])}return o}function mmt(t){const e=t.minSize,i=t.maxSize,n=emt,s=(i-e)/(n-1),r=[];for(let t=0;t<n;t++)r.push(e+s*t);return r}function ymt(t,e,i){const n=i.minSize,s=i.maxSize,r=e.minDataValue,o=e.maxDataValue;let a;if(t<=n)a=r;else if(t>=s)a=o;else{a=(t-n)/(s-n)*(o-r)+r}return a}async function gmt(t,e,i,n,s,r){const o=await vmt(t,e,i,s,r),a=await vmt(t,e,n,s,r),l=_pt(i),u=l.fractional,c=tmt;let h=l.integer,d=null,f=null;i>0&&i<1&&(d=10**u,h=_pt(i*=d).integer);for(let n=h-1;n>=0;n--){const l=10**n;let u=Math.floor(i/l)*l,h=Math.ceil(i/l)*l;null!=d&&(u/=d,h/=d);let p=(u+h)/2;[,p]=kpt([u,p,h],{indexes:[1]});const m=await vmt(t,e,u,s,r),y=await vmt(t,e,h,s,r),g=await vmt(t,e,p,s,r),v=Mpt(o,m,a,null),w=Mpt(o,y,a,null),b=Mpt(o,g,a,null);let S=v.previous<=c,x=w.previous<=c;if(S&&x&&(v.previous<=w.previous?(S=!0,x=!1):(x=!0,S=!1)),S?f=[u,m]:x?f=[h,y]:b.previous<=c&&(f=[p,g]),f)break}return f}async function vmt(t,e,i,n,s){const{getSize:r}=await Promise.resolve().then((function(){return zX}));return r(t,i,{scale:n,view:s,shape:"simple-marker"===e.type?e.style:null})}function wmt(t,e){const i=t.clone();if(SF(i))Ndt(i)||i.symbolLayers.forEach((t=>{"fill"!==t.type&&(t.size=e)}));else if(imt(i))i.size=e;else if(nmt(i)){const t=i.width,n=i.height;i.height=e,i.width=e*(t/n)}else smt(i)?i.width=e:rmt(i)&&i.font&&(i.font.size=e);return i}function bmt(t){const e=2,i=Math.floor(Math.log10(Math.abs(t)))+1,n=i<4||i>6?4:i,s=1e6,r=Math.abs(t)>=s?"compact":"standard";return iv(t,{notation:r,minimumSignificantDigits:e,maximumSignificantDigits:n})}const Smt="https://utility.arcgis.com/sharing/tools/legend",xmt="esri.layers.ImageryLayer",_mt="esri.layers.ImageryTileLayer",Mmt="esri.layers.WCSLayer",kmt=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Tmt=new ul({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Amt=new fF({size:6,outline:{color:[128,128,128,.5],width:.5}}),Imt=new uF({style:"solid"});function jmt(t){return"flow"===t.type}function Cmt(t){return"vector-field"===t.type}function Emt(t){return"raster-colormap"===t.type}function Omt(t){return"raster-stretch"===t.type}function Lmt(t){return"raster-shaded-relief"===t.type}function Nmt(t){return"esri.renderers.SimpleRenderer"===t.declaredClass}function Rmt(t){return"esri.renderers.ClassBreaksRenderer"===t.declaredClass}function Pmt(t){return"esri.renderers.UniqueValueRenderer"===t.declaredClass}function Fmt(t){return"esri.renderers.HeatmapRenderer"===t.declaredClass}function Dmt(t){return zmt(t)||Umt(t)||Vmt(t)||$mt(t)}function $mt(t){return"esri.renderers.PointCloudRGBRenderer"===t.declaredClass}function zmt(t){return"esri.renderers.PointCloudClassBreaksRenderer"===t.declaredClass}function Umt(t){return"esri.renderers.PointCloudStretchRenderer"===t.declaredClass}function Vmt(t){return"esri.renderers.PointCloudUniqueValueRenderer"===t.declaredClass}function Gmt(t){return"esri.renderers.DotDensityRenderer"===t.declaredClass}function Bmt(t){return"esri.renderers.PieChartRenderer"===t.declaredClass}function qmt(t,e){return Nmt(t)||Rmt(t)||Pmt(t)||Fmt(t)||Gmt(t)||Bmt(t)?"2d"===e.type||Sht(t):Omt(t)||Emt(t)||Lmt(t)||zmt(t)||Umt(t)||Vmt(t)||Cmt(t)||jmt(t)}function Hmt(t){return"esri.layers.BuildingSceneLayer"===t.declaredClass}function Wmt(t){return"esri.layers.SubtypeGroupLayer"===t.declaredClass}function Zmt(t){return"esri.layers.VoxelLayer"===t.declaredClass}function Jmt(t){return"esri.layers.WMSLayer"===t.declaredClass}function Kmt(t){return"esri.layers.WMTSLayer"===t.declaredClass}function Ymt(t){return"esri.layers.MapImageLayer"===t.declaredClass}function Qmt(t){return"esri.layers.TileLayer"===t.declaredClass}function Xmt(t){return t.declaredClass===xmt}function tyt(t){return t.declaredClass===_mt}function eyt(t){return t.declaredClass===Mmt}function iyt(t){return"stretch-ramp"===t.type}function nyt(t){const e="authoringInfo"in t?t?.authoringInfo:null;return"univariate-color-size"===e?.type}function syt(t){const e="authoringInfo"in t?t?.authoringInfo:null;return"univariate-color-size"===e?.type&&"above-and-below"===e?.univariateTheme}function ryt(t){return"sublayers"in t}async function oyt(t,e){const i=await yv("esri/widgets/Legend/t9n/Legend");return"previewTemplateAriaLabel"!==t||e||(t="previewAriaLabel"),sv(i[t],{label:e})}const ayt=new fF({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let lyt={},uyt=class extends Vr{constructor(t){super(t),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this.children=new ty,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const t=()=>this.notifyChange("ready");this.addHandles([yy((()=>this.children),"change",(e=>{const{added:i,removed:n}=e;i.forEach((e=>{const i=`activeLayerInfo-ready-watcher-${e.layer.uid}`;this.addHandles(fy((()=>e.ready),t,_y),i)})),n.forEach((t=>this.removeHandles(t.layer.uid))),t()}))]),this.keepCacheOnDestroy||(lyt={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(lyt=null)}get effectList(){const t=this.layer;let e=null;return"effect"in t&&t.effect&&(e=new Xct,e.effect=t.effect,e.endTransitions(),e.scale=this.scale),e}get opacity(){const t=this.layer.opacity,e=this.parent?.opacity,i=this.layer.parent,n=i&&"uid"in i?this._getParentLayerOpacity(i):null;return null!=e?e*t:null!=n?n*t:t}get ready(){return null===this.layer||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){return this.view?.scale??0}get isScaleDriven(){const t=this.layer;if(null===t)return!1;if("effect"in t&&t.effect&&Array.isArray(t.effect))return!0;if("featureReduction"in t&&t.featureReduction){if("cluster"===t.featureReduction.type)return!0;if("binning"===t.featureReduction.type&&"renderer"in t.featureReduction&&t.featureReduction.renderer)return this._isRendererScaleDriven(t.featureReduction.renderer)}return"renderer"in t&&t.renderer?this._isRendererScaleDriven(t.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(t){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const e=Array.from(t,(t=>{if(Ck(t))return this._getRendererLegendElements(t.renderer,{title:t.title});if(t.featureSet?.features.length){const e=t.layerDefinition,i=e?.drawingInfo,n=i&&f4(i.renderer),s=Tmt.read(e.geometryType);return n?this._getRendererLegendElements(n,{title:t.name,geometryType:s}):(Ft.getLogger(this).warn("drawingInfo not available!"),null)}return null}));try{const t=[],i=await Promise.allSettled(e);for(const e of i)if("fulfilled"===e.status)for(const i of e.value??[])t.push(i);this.legendElements=t,this.notifyChange("ready")}catch(t){Ft.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForRenderer(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getRendererLegendElements(t):[],this.notifyChange("ready")}catch(t){Ft.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForFeatureReduction(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getLegendElementsForFeatureReduction(t):[],this.notifyChange("ready")}catch(t){Ft.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForTools(){const t=this.layer;if(Zmt(t))this._constructLegendElementsForVoxelLayer();else if(Kmt(t))this._constructLegendElementsForWMTSlayer();else if(Jmt(t))await this._constructLegendElementsForWMSSublayers();else if(Hmt(t))await this._constructLegendElementsForBuildingSceneLayer();else if(Ymt(t)||Qmt(t)||Wmt(t))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let e="default";if(Xmt(t)){const i=t;e=(i?.rasterFunction?.functionName||"default")+"_"+(t.bandIds?.length?t.bandIds.join(""):"###")}if(tyt(t))return;await this._getLegendLayers(`${t.uid}-${e}`).then((async e=>{this.legendElements=[],this.notifyChange("ready");const i=e.map((async e=>{if(Xmt(t)){const e=fy((()=>["renderingRule"in t&&t.rasterFunction,t.bandIds]),(()=>qi((async()=>{lyt.default=null,t.renderer?await this.buildLegendElementsForRenderer(t.renderer):await this.buildLegendElementsForTools()}))()));this.addHandles(e,"imageryLayers-watcher")}const i=this._generateSymbolTableElementForLegendLayer(e);i&&i.infos.length&&(Xmt(t)&&(i.title=t.title),this.legendElements.push(i)),this.notifyChange("ready")}));await Promise.allSettled(i)})).catch((t=>{Ft.getLogger(this).warn("Request to server for legend has failed!",t)}))}}async _isLayerInCurrentView(){const t=this.layer,e=this.layerView,i=e&&"createQuery"in e&&"queryFeatureCount"in e;if(!i&&!(e&&"createQuery"in t&&"queryFeatureCount"in t))return!0;await gy((()=>!e.updating));const n=i?"createQuery"in e&&e.createQuery():"createQuery"in t&&t.createQuery();if(!n)return!0;n.geometry=this.view.extent;return 0!==(i?"queryFeatureCount"in e&&await e.queryFeatureCount(n):"queryFeatureCount"in t&&await t.queryFeatureCount(n))}_getParentLayerOpacity(t){let e=1;const i=t.parent;return i&&"uid"in i&&(e=this._getParentLayerOpacity(i)),t.opacity*e}_isGroupActive(){return this.children.some((t=>t.ready))}_isRendererScaleDriven(t){if("dot-density"===t.type)return!0;const e="valueExpression"in t?t.valueExpression:null;if(kmt.test(e))return!0;const i="visualVariables"in t?t.visualVariables:null;return!!i?.some((t=>this._isScaleDrivenSizeVariable(t)))||this._hasScaleDrivenSymbols(t)}_hasScaleDrivenSymbols(t){switch(t.type){case"simple":return this._isScaleDrivenSymbol(t.symbol);case"class-breaks":return this._isScaleDrivenSymbol(t.defaultSymbol)||t.classBreakInfos.some((t=>this._isScaleDrivenSymbol(t.symbol)));case"unique-value":return this._isScaleDrivenSymbol(t.defaultSymbol)||!!t.uniqueValueInfos?.some((t=>this._isScaleDrivenSymbol(t.symbol)))}return!1}_isScaleDrivenSymbol(t){if("cim"===t?.type){const{primitiveOverrides:e,minScale:i,maxScale:n}=t.data,s=e?.some((t=>/\$view\.scale/.test(t.valueExpressionInfo?.expression||"")))??!1;return null!=i||null!=n||s}return!1}_isScaleDrivenSizeVariable(t){if(t&&"size"!==t.type)return!1;const e=t,i=e.minSize,n=e.maxSize;return!("object"!=typeof i||!i||!this._isScaleDrivenSizeVariable(i))||(!("object"!=typeof n||!n||!this._isScaleDrivenSizeVariable(n))||(!!e.expression||kmt.test(e.valueExpression)))}_isLayerScaleDriven(t){if("minScale"in t&&t.minScale>0||"maxScale"in t&&t.maxScale>0)return!0;if("sublayers"in t&&t.sublayers)return t.sublayers.some((t=>this._isLayerScaleDriven(t)));const e=t.parent;if(!1===t.loaded&&e&&Ymt(e)&&"source"in t&&t.source&&"map-layer"===t.source.type)for(const i of e.sourceJSON.layers??[])if(i.id===t.source.mapLayerId&&(i.minScale>0||i.maxScale>0))return!0;return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const t=this.layer;this.addHandles(fy((()=>t.currentVariableId),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-current-variable"),this.addHandles(fy((()=>t.getVariableStyles()),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-style-watcher");const e=t.getVariableStyle(null),i=[];if(e)if(e.uniqueValues?.length){const t=[];e.uniqueValues.forEach((e=>{e.enabled&&t.push({label:e.label||`${e.value}`,value:e.value,symbol:new uF({color:e.color,outline:null})})})),t.length&&i.push({type:"symbol-table",title:e.label,infos:t})}else if(e.transferFunction){const{colorStops:t,stretchRange:n}=e.transferFunction,s=t.toArray().reverse(),r=n.map(((t,e)=>`${0===e?Cpt:Ept} ${bmt(t)}`)).reverse(),o=s.map((t=>({color:t.color,value:null,label:null})));o[0].label=r[0],o[o.length-1].label=r[1],i.push({type:"color-ramp",title:e.label,infos:o,preview:dpt(s.map((t=>t.color)),{ariaLabel:await oyt("previewColorRampAriaLabel")})})}const n=t.opacity,s=i.reduce(((t,e)=>[...t,...this._getAllInfos(e)]),[]).filter((t=>!!t?.symbol)).map((t=>this._getSymbolPreview(t,n)));await Promise.allSettled(s),this.legendElements=i,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const t=this.layer.activeLayer;this.addHandles(fy((()=>{const{layer:t}=this;return t&&"activeLayer"in t&&t.activeLayer}),(()=>this._constructLegendElementsForWMTSlayer())),"wmts-activeLayer-watcher");const e=t.styleId?t.styles?.find((({id:e})=>e===t.styleId))?.legendUrl:void 0;e&&(this.legendElements=[{type:"symbol-table",title:t.title,infos:[{src:e,opacity:this.opacity}]}]),this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const t=this.layer;let e=null;(t.customParameters||t.customLayerParameters)&&(e={...t.customParameters,...t.customLayerParameters}),this.addHandles(fy((()=>{const{layer:t}=this;return t&&"sublayers"in t&&t.sublayers}),(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(t.sublayers,e),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(t,e){const i=this.layer,n=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher");const s=this.sublayerIds?.map((t=>i.findSublayerById(t)))?.filter(F)??[],r=s.length?s:t.toArray();for(const t of r){const i=fy((()=>[t.title,t.visible,t.legendEnabled]),(()=>this._constructLegendElementsForWMSSublayers()));if(this.addHandles(i,"wms-sublayers-watcher"),!this.respectLayerVisibility||t.visible&&t.legendEnabled){const i=await this._generateSymbolTableElementForWMSSublayer(t,e);i?.infos.length&&n.unshift(i)}}return n}async _generateSymbolTableElementForWMSSublayer(t,e){if(!t.legendUrl&&t.sublayers){const i=(await this._generateLegendElementsForWMSSublayers(t.sublayers,e)).filter((t=>t));return{type:"symbol-table",title:t.title,infos:i}}return this._generateSymbolTableElementForLegendUrl(t,e)}async _generateSymbolTableElementForLegendUrl(t,e){let i=t.legendUrl;if(!i)return;const n={type:"symbol-table",title:t.title||t.name||String(t.id??""),infos:[]};e&&(i=Gu(i,e));let s=null;const r=t.layer?.opacity;try{s=(await hc(i,{responseType:"image"})).data,s&&(s.style.opacity=r)}catch{}return n.infos.push({src:i,preview:s,opacity:r}),n}_getLegendLayers(t,e){const i=lyt&&lyt[t];return i?Promise.resolve(i):this._legendRequest(e).then((e=>{const i=e.layers;return lyt[t]=i,i}))}_legendRequest(t){const e=this.layer;let i={f:"json",dynamicLayers:t};if(Xmt(e)){const t=e.exportImageServiceParameters.rasterFunction;if(t&&(i.renderingRule=JSON.stringify(t.functionDefinition?.toJSON()||t.toJSON())),e.bandIds&&(i.bandIds=e.bandIds.join()),e.raster||e.viewId||e.customParameters){const{raster:t,viewId:n,customParameters:s}=e;i={raster:t,viewId:n,...i,...s}}}let n=e.url.replace(/(\/)+$/,"");if("version"in e&&+e.version>=10.01){const t=n.indexOf("?");t>-1?n=n.substring(0,t)+"/legend"+n.substring(t):n+="/legend"}else{const t=n.toLowerCase().indexOf("/rest/"),e=n.substring(0,t)+n.substring(t+5,n.length);n=Smt+"?soapUrl="+encodeURI(e)+"&returnbytes=true"}return hc(n,{query:i}).then((t=>t.data))}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;this.addHandles(fy((()=>t.sublayers),(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(t){Ft.getLogger(this).warn("Request to server for legend has failed!",t)}}async _generateLegendElementsForBuildingSublayers(t,e){let i=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");const n=t.toArray();for(const t of n){const n=fy((()=>["renderer"in t&&t.renderer,t.opacity,t.title,t.visible]),(()=>this._constructLegendElementsForBuildingSceneLayer()));if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||t.visible){const n=null!=t?.opacity?t.opacity:null,s=null!=n?n*e:e;if("building-group"===t.type){const e={type:"symbol-table",title:t.title,infos:[]},n=await this._generateLegendElementsForBuildingSublayers(t.sublayers,s);e.infos.push(...n),i=[e,...i]}else if(t.renderer){i=[...await this._getRendererLegendElements(t.renderer,{title:t.title,opacity:s,sublayer:t}),...i]}}}return i.filter((t=>!!t&&(!("infos"in t)||!t.infos||t.infos.length>0)))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;if(Ymt(t)||Qmt(t)||Wmt(t)){this.addHandles(fy((()=>t.sublayers),(()=>this._constructLegendElementsForSublayers)),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(t){Ft.getLogger(this).warn("Request to server for legend has failed!",t)}}}async _generateLegendElementsForSublayers(t,e,i){const n=this.layer;let s=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForSublayers())),"sublayers-watcher");let r=t.toArray();!i&&this.sublayerIds&&this.sublayerIds.length&&(r=Wmt(n)?this.sublayerIds.map((t=>n.findSublayerForSubtypeCode(t))).filter(F):this.sublayerIds.map((t=>n.findSublayerById(t))).filter(F));for(const t of r){const n=fy((()=>[t.renderer,t.opacity,t.title,t.visible,t.legendEnabled]),(()=>this._constructLegendElementsForSublayers()));if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||t.visible&&t.legendEnabled&&this._isSublayerInScale(t)){const n=null!=t?.opacity?t.opacity:null,r=null!=n?n*e:e,o=!ryt(t)||t.originIdOf("renderer")>xe.SERVICE&&!t.sublayers;if(t.renderer&&o){await t.load();s=[...await this._getRendererLegendElements(t.renderer,{title:t.title,opacity:r,sublayer:t}),...s]}else if(ryt(t)){const e=await this._generateSymbolTableElementForSublayer(t,r,i);e&&s.unshift(e)}}}return s.filter((t=>!!t&&(!("infos"in t)||!t.infos||t.infos.length>0)))}async _generateSymbolTableElementForSublayer(t,e,i){if(!i){i=new Map;const e=this.layer,n=t.source;let s=null;if(!(!n||"map-layer"===n.type&&n.mapLayerId===t.id&&(!n.gdbVersion||n.gdbVersion===("gdbVersion"in e&&e.gdbVersion)))||t.originIdOf("renderer")>xe.SERVICE||t.originIdOf("labelingInfo")>xe.SERVICE||t.originIdOf("labelsVisible")>xe.SERVICE){const t=new fht({layer:this.layer});s=t.hasDynamicLayers?t.dynamicLayers:null,t.destroy()}const r=s||`${e.uid}-default`;(await this._getLegendLayers(r,s)).forEach((t=>i.set(t.layerId,t)))}const n=i.get(t.id);if((!n||n?.subLayerIds&&n.defaultVisibility)&&t.sublayers){const n=await this._generateLegendElementsForSublayers(t.sublayers,e,i);return{type:"symbol-table",title:t.title,infos:n}}return this._generateSymbolTableElementForLegendLayer(n,t,e)}_generateSymbolTableElementForLegendLayer(t,e,i){if(!t?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(t,e))return null;const n=e?.renderer;let s=e?.title||t.layerName;if(n&&(!e||e?.originIdOf("renderer")>xe.SERVICE)){const t=e?.title||this._getRendererTitle(n,e);t&&(s&&"string"!=typeof t&&"title"in t&&(t.title=s),s=t)}const r={type:"symbol-table",title:s,legendType:t.legendType||null,infos:[]},o=e?this._sanitizeLegendForSublayer(t.legend.slice(),e):t.legend;return t.legendGroups&&t.legendGroups.length>0?t.legendGroups.forEach((e=>{const n={type:"symbol-table",title:e.heading,legendType:t.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(o.filter((t=>t.groupId===e.id)),t.layerId,i)};n.infos?.length>0&&r.infos.push(n)})):r.infos=this._generateSymbolTableElementInfosForLegendLayer(o,t.layerId,i),r.infos.length>0?r:null}_generateSymbolTableElementInfosForLegendLayer(t,e,i){return t.map((t=>{let n=t.url;if(t.imageData&&t.imageData.length>0)n=`data:image/png;base64,${t.imageData}`;else{if(0===n.indexOf("http"))return null;n=ec(`${this.layer.url}/${e}/images/${n}`)}return{label:t.label,src:n,opacity:i??this.opacity,width:t.width,height:t.height}})).filter(F)}_isSublayerInScale(t){const e=t.minScale||0,i=t.maxScale||0;return!(e>0&&e<this.scale||i>this.scale)}_isLegendLayerInScale(t,e){const i=e||this.layer;let n=null,s=null,r=!0;return!i.minScale&&0!==i.minScale||!i.maxScale&&0!==i.maxScale?(0===t.minScale&&i.tileInfo&&(n=i.tileInfo.lods[0].scale),0===t.maxScale&&i.tileInfo&&(s=i.tileInfo.lods[i.tileInfo.lods.length-1].scale)):(n=Math.min(i.minScale,t.minScale)||i.minScale||t.minScale,s=Math.max(i.maxScale,t.maxScale)),(n>0&&n<this.scale||s>this.scale)&&(r=!1),r}_sanitizeLegendForSublayer(t,e){if("version"in this.layer&&+this.layer.version<10.1||0===t.length)return t;const i=e.renderer,n=t.some((t=>t.values));let s=0,r=null;return n&&t.some(((t,e)=>(t.values||(s=e,r=t,r.label||(r.label="others")),null!=r))),i?"unique-value"===i.type?r&&(t.splice(s,1),t.push(r)):"class-breaks"===i.type&&(r&&t.splice(s,1),t.reverse(),r&&t.push(r)):r&&(t.splice(s,1),t.push(r)),t}async _getRendererLegendElements(t,e={}){if(!qmt(t,this.view))return Ft.getLogger(this).warn(`Renderer of type '${t.type}' not supported!`),[];if(Dmt(t))return this._constructPointCloudRendererLegendElements(t,e);if(Gmt(t))return this._constructDotDensityRendererLegendElements(t);const i=await this._loadRenderer(t);return Bmt(i)?this._constructPieChartRendererLegendElements(i):this._constructRendererLegendElements(i,e)}async _getLegendElementsForFeatureReduction(t){let e=null;return"binning"===t.type?e=t.renderer:"cluster"===t.type&&(e=this._getClusterRenderer(t)),e?this._getRendererLegendElements(e):[]}_getPointCloudRendererTitle(t){return(t.legendOptions?.title||t.field)??""}async _constructPointCloudRendererLegendElements(t,e={}){const i=e.title,n=[];let s=null,r=null;if(zmt(t))s={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},t.colorClassBreakInfos.forEach((t=>{s.infos.unshift({label:t.label||t.minValue+" - "+t.maxValue,value:[t.minValue,t.maxValue],symbol:this._getAppliedCloneSymbol(Amt,t.color)})}));else if(Umt(t)){const e=t.stops;let n=null;if(e?.length&&(1===e.length&&(n=e[0].color),!n)){const t=e[0].value,i=e[e.length-1].value;if(null!=t&&null!=i){n=qpt(t+(i-t)/2,e)}}s={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Amt,n||Amt.color)}]};const o=Bpt(t.stops??[])??[];r={type:"color-ramp",title:i||this._getPointCloudRendererTitle(t),infos:o,preview:dpt(o.map((t=>t.color)),{ariaLabel:await oyt("previewColorRampAriaLabel")})}}else Vmt(t)&&(s={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},t.colorUniqueValueInfos?.forEach((t=>{s.infos.push({label:t.label||t.values.join(", "),value:t.values.join(", "),symbol:this._getAppliedCloneSymbol(Amt,t.color)})})));s&&s.infos.length&&n.push(s),r&&r.infos.length&&n.push(r);const o=n.reduce(((t,e)=>[...t,...e.infos??[]]),[]).filter((t=>!!t.symbol)).map((e=>this._getSymbolPreview(e,this.opacity,{symbolConfig:{applyColorModulation:!!t.colorModulation}})));return await Promise.allSettled(o),n}async _getElementInfoForDotDensity(t,e){const{color:i,label:n,valueExpressionTitle:s}=e,{backgroundColor:r,outline:o,dotSize:a}=t,l=this.effectList,u=l?.effects.map((t=>t.toJSON())),c=N8(u),h=await oyt("previewTemplateAriaLabel",n||s),d=a+"-"+i+"-"+r+"-"+(o&&JSON.stringify(o.toJSON()))+"-"+c,f=this._dotDensityUrlCache,p=f.has(d)?f.get(d):cpt(t,i,{ariaLabel:h});f.set(d,p);const m={shape:{type:"image",x:0,y:0,width:p.width,height:p.height,src:p.src},fill:null,stroke:null,offset:[0,0]},y=rft([[m]],[p.width,p.height],{effectView:this.effectList,ariaLabel:h});return{opacity:1,src:p.src,preview:y,width:p.width,height:p.height}}async _constructDotDensityRendererLegendElements(t){const e=t.calculateDotValue(this.view.scale),i=t.legendOptions?.unit,n={type:"symbol-table",title:{value:e&&Math.round(e),unit:i||""},infos:[]};for(const e of t.attributes){const i=await this._getElementInfoForDotDensity(t,e);i.label=e.label||e.valueExpressionTitle||e.field,n.infos.push(i)}return[n]}async _constructPieChartRendererLegendElements(t){const e=this.layer.opacity,i=[];let n=null;const s=t.outline;t.attributes.forEach((t=>{const e=new fF({color:t.color,outline:s}),n=t.label||t.valueExpressionTitle||t.field;i.push({label:n,symbol:e})}));const r=i.length?[...i]:[];if(t.othersCategory?.color&&0!==t.othersCategory?.threshold){const e=new fF({color:t.othersCategory.color,outline:s});n=t.othersCategory.label||"Other",i.push({label:n,symbol:e})}if(t.defaultColor?.a){const e=new fF({color:t.defaultColor,outline:s});i.push({label:t.defaultLabel,symbol:e})}const o=await this._getVisualVariableLegendElements(t,this.layer)||[];if(i.length){o.unshift({type:"symbol-table",title:null,infos:i});const e=r.filter((t=>t.label!==n)).map((t=>t.symbol.color)).filter(Boolean),a=hpt(e,{holePercentage:t.holePercentage,backgroundColor:t.backgroundFillSymbol?.color,effectList:this.effectList,outline:s,ariaLabel:await oyt("previewPieChartAriaLabel")});o.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(t,this.layer),infos:i,preview:a})}const a=o.reduce(((t,e)=>[...t,...this._getAllInfos(e)]),[]).filter((t=>!!t?.symbol&&!t?.preview)).map((t=>this._getSymbolPreview(t,e,{effectList:this.effectList})));return await Promise.allSettled(a),o}async _constructRendererLegendElements(t,e={}){const{title:i,sublayer:n}=e,s=n||this.layer;this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const r=await this._getVisualVariableLegendElements(t,s)||[],o={type:"symbol-table",title:i||this._getRendererTitle(t,s),infos:[]};let a=null,l=!1;const u=new Set;if(jmt(t)&&!this._hasSizeRamp){const e=await Rpt(t);o.infos.push({label:null,symbol:e})}else if(nyt(t)){let e=i;const n=syt(t)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",s=r.findIndex((t=>"color-ramp"===t.type)),o=-1!==s?r.splice(s,1)[0]:null,a=r.findIndex((t=>"size-ramp"===t.type)),l=-1!==a?r.splice(a,1)[0]:null,u=[];o&&(e=o.title,u.push(o)),l&&(e=l.title,u.push(l)),u.length>0&&r.push({type:n,title:e,infos:u})}else if(Fmt(t)){const e=Zpt(t);r.push({type:"heatmap-ramp",title:i||this._getRendererTitle(t,s),infos:e,preview:dpt(e.map((t=>t.color)),{effectList:this.effectList,ariaLabel:await oyt("previewColorRampAriaLabel")})})}else if(Pmt(t)){const e=t&&t.authoringInfo;if(e&&"relationship"===e.type){const{numClasses:i,field1:n,field2:a}=e,l=e.focus;if(i&&n&&a){const e=[n,a];let c=opt(l)||0;for(const t of e){const{field:e,normalizationField:i,label:n}=t,r=n||{field:this._getFieldAlias(e,s),normField:i&&this._getFieldAlias(i,s)},a=ayt.clone();a.angle=c,o.infos.push({label:r,symbol:a}),u.add(a),c+=90}const h=rpt({focus:l,numClasses:i,infos:t.uniqueValueInfos??[]});r.unshift(h)}}else if(Xmt(this.layer)||tyt(this.layer))t.uniqueValueInfos?.forEach((t=>{t.symbol&&o.infos.push({label:t.label||t.value,value:t.value,symbol:t.symbol})}));else{const{field:e,field2:n,field3:r,fieldDelimiter:a,valueExpression:u,defaultSymbol:c}=t,h=!(!e&&!u||!n&&!r),d=[];if(t.uniqueValueGroups?.forEach((t=>{const i={type:"symbol-table",title:t.heading,infos:[]};t.classes?.forEach((t=>{const{symbol:o,values:l}=t;if(o){const c=[],d=[];for(const t of l??[]){const{value:i,value2:o,value3:l}=t,f=[],p=[];(e||u)&&(f.push(i),p.push(this._getDomainName(e,i,s))),n&&(f.push(o),p.push(this._getDomainName(n,o,s))),r&&(f.push(l),p.push(this._getDomainName(r,l,s))),c.push(h?f.join(a||""):f[0]),d.push(p.join(" - "))}const f=c.join(", ");let p=t.label;if(!p){const t=d.filter(Boolean);p=t.length?t.join(", "):f}i.infos.push({label:p,value:f,symbol:o})}})),i.infos.length&&d.push(i)})),d.length){const e=d[0];1===d.length&&"title"in e&&!e.title?o.infos.push(...e.infos??[]):(c&&(d.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:c}]}),l=!0),o.infos.push(...d)),i||t.legendOptions?.title||t.valueExpressionTitle||(o.title=null)}}t.defaultSymbol&&!l&&(o.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),l=!0)}else if(Rmt(t)){a=this._isUnclassedRenderer(t);(!a||!this._hasSizeRamp)&&(t.classBreakInfos.forEach((t=>{t.symbol&&o.infos.unshift({label:t.label||(a?null:t.minValue+" - "+t.maxValue),value:[t.minValue,t.maxValue],symbol:t.symbol})})),a&&(o.title=null),this._updateInfosForClassedSizeRenderer(t,o.infos)),t.defaultSymbol&&!a&&(o.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),l=!0)}else if(Omt(t))if(tyt(this.layer)||eyt(this.layer)){const e=await this._constructTileImageryStretchRendererElements(t);iyt(e)?r.push(e):o.infos=e}else{const e=this.layer;let i,n;if(t.statistics?.length){const e=t.statistics[0];Ppt(e)?(i=e.min,n=e.max):[i,n]=e}let s=[],a=e.serviceRasterInfo;if(e.rasterFunction)try{a=await e.generateRasterInfo(e.rasterFunction)}catch{}const l=ght(a.pixelType);if(1===a.bandCount){const s=e.bandIds?.[0]||0;i=null!=i?i:a.statistics?a.statistics[s].min:l[0],n=null!=n?n:a.statistics?a.statistics[s].max:l[1],i||n?r.push(await this._getStretchLegendElements(t,{min:i,max:n})):this._getServerSideLegend()}else if(e.bandIds&&1===e.bandIds.length)i=null!=i?i:a.statistics?a.statistics[e.bandIds[0]].min:l[0],n=null!=n?n:a.statistics?a.statistics[e.bandIds[0]].max:l[1],i||n?r.push(await this._getStretchLegendElements(t,{min:i,max:n})):this._getServerSideLegend();else if(a.bandCount>=3){const{bandInfos:t}=a,{bandIds:i}=e;t.length>=a.bandCount?3===i?.length?(s=i.map((e=>t[e].name)),o.infos=this._createSymbolTableElementMultiBand(s)):"lerc"===e.format?(s=[0,1,2].map((e=>t[e].name)),o.infos=this._createSymbolTableElementMultiBand(s)):this._getServerSideLegend():"lerc"===e.format?(s=["band1","band2","band3"],o.infos=this._createSymbolTableElementMultiBand(s)):this._getServerSideLegend()}else this._getServerSideLegend()}else if(Emt(t))t.colormapInfos.forEach((t=>{o.infos.push({label:t.label,value:t.value,symbol:this._getAppliedCloneSymbol(Imt,t.color)})}));else if(Nmt(t)){let i=t.symbol;switch(e.geometryType){case"point":i="pointSymbol"in s?s.pointSymbol:null;break;case"polyline":i="lineSymbol"in s?s.lineSymbol:null;break;case"polygon":i="polygonSymbol"in s?s.polygonSymbol:null}const n=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;t.symbol&&n&&o.infos.push({label:t.label,symbol:i})}else if(Cmt(t)){t.outputUnit&&(this.title="("+t.toJSON().outputUnit+")"),o.title=t.attributeField;const e=t.getClassBreakInfos();e?.length?e.forEach((t=>{o.infos.push({label:t.minValue+" - "+t.maxValue,symbol:t.symbol})})):o.infos.push({label:t.attributeField,symbol:t.getDefaultSymbol()})}else Lmt(t)&&r.push(await this._getStretchLegendElements(t,{min:0,max:255}));const c=t.defaultSymbol;!c||l||Nmt(t)||a&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||r.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:c}]}),o.infos.length&&r.unshift(o);const h=null==e.opacity?this.opacity:e.opacity,d=this._isTallSymbol("visualVariables"in t?t.visualVariables:null),f=Xmt(this.layer)||tyt(this.layer),p=r.reduce(((t,e)=>[...t,...this._getAllInfos(e)]),[]).filter((t=>!!t?.symbol)).filter((t=>{if("cim"===t.symbol.type){const{minScale:e,maxScale:i}=t.symbol.data;if(e&&e<this.scale||i&&i>this.scale)return!1}return!0})).map((t=>this._getSymbolPreview(t,h,{isDefault:t.symbol===c,applyScaleDrivenSize:!u.has(t.symbol),symbolConfig:{isTall:d,isSquareFill:f},effectList:u.has(t.symbol)?null:this.effectList})));return t=null,await Promise.allSettled(p),r}_getServerSideLegend(){setTimeout((()=>this.buildLegendElementsForTools()),0)}_getAllInfos(t){const e=t?.infos;return e?e.reduce(((t,e)=>t.concat(this._getAllInfos(e))),[]):[t]}async _constructTileImageryStretchRendererElements(t){const e=this.layer,i=e.symbolizer.rasterInfo??e.raster.rasterInfo;let n,s;const r=t?.statistics?.length?t.statistics:i?.statistics;if(r){const t=r[0];Ppt(t)?(n=t.min,s=t.max):[n,s]=t}else{const t=ght(i.pixelType);n=t[0],s=t[1]}if(e.hasStandardTime()&&(n=e.getStandardTimeValue(n),s=e.getStandardTimeValue(s)),1===i.bandCount||1===e.bandIds?.length)return this._getStretchLegendElements(t,{min:n,max:s});const o=(e?.bandIds?.length?e.bandIds:Array.from(Array(Math.min(i.bandCount,3)).keys())).map((t=>i.bandInfos[t].name));return o.length<3?o.push(o[1]):o.length>3&&o.splice(3),this._createSymbolTableElementMultiBand(o)}async _getStretchLegendElements(t,e){const i=t.colorRamp,n=Wpt(i,e);return{type:"stretch-ramp",title:"",infos:n,preview:dpt(n.map((t=>t.color)),{ariaLabel:await oyt("previewColorRampAriaLabel")})}}_getClusterSymbol(){const t=this.layer,e="featureReduction"in t&&t.featureReduction,i=e&&"symbol"in e&&e.renderer;return i&&!0!==i?.authoringInfo?.isAutoGenerated?null:e&&"symbol"in e?e.symbol:null}async _getSizeLegendElement(t,e,i,n){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(e):t,infos:await amt(i,e,await Npt(i),this.scale,this.view,n,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(t){const e=[],i=["red","green","blue"];return t.forEach(((t,n)=>{e.push({label:{colorName:i[n],bandName:t},src:Lpt[n],opacity:this.opacity??1})})),e}_updateInfosForClassedSizeRenderer(t,e){const i=t.authoringInfo&&"class-breaks-size"===t.authoringInfo.type,n=t.classBreakInfos.some((t=>Ndt(t.symbol)));if(i&&n){const i=Jpt,n=Kpt,s=t.classBreakInfos.length,r=(i-n)/(s>1?s-1:s);e.forEach(((t,e)=>{t.size=i-r*e}))}}_isTallSymbol(t){let e=!1,i=!1;if(t)for(let n=0;n<t.length&&(!e||!i);n++){const s=t[n];"size"===s.type&&("height"===s.axis&&(e=!0),"width-and-depth"===s.axis&&(i=!0))}return e&&i}async _getSymbolPreview(t,e,i){let n=!i?.isDefault&&null==t.size&&this._hasSizeRamp?PT(Aht.size):t.size;if(this._scaleDrivenSizeVariable&&i?.applyScaleDrivenSize){const{getSize:e}=await Promise.resolve().then((function(){return zX}));n=e(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===t.symbol.type?t.symbol.style:null})}const s=!i?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!i?.applyScaleDrivenSize);return ppt(t.symbol,{size:n,opacity:e,scale:!1,symbolConfig:i?.symbolConfig,effectView:i?.effectList,style:"legend",cimOptions:{allowScalingUp:s,viewParams:this.isScaleDriven?{viewingMode:"2d"===this.view?.type?"map":this.view?.viewingMode,scale:this.view?.scale}:null},ariaLabel:t.label&&"string"!=typeof t.label?null:await oyt("previewTemplateAriaLabel",t.label)}).then((e=>(t.preview=e,t))).catch((()=>(t.preview=null,t)))}_getClusterRenderer(t){this._hasClusterSizeVariable=!1;const e="renderer"in this.layer?this.layer.renderer:null,i=t.renderer?.clone()||e?.clone(),n=vpt(t,this.layerView,this.view);if(n&&null!=i&&"visualVariables"in i){const e=i.visualVariables?.some((t=>"size"===t.type&&"outline"!==t.target&&!kmt.test(t.valueExpression)));if(!e){if("clusterMinSize"in t&&"clusterMaxSize"in t){const{clusterMinSize:e,clusterMaxSize:i}=t;n.legendOptions=new lX({showLegend:e!==i})}const e=i.visualVariables||[];i.visualVariables=e.concat([n]),this._hasClusterSizeVariable=!0}}return i}async _loadRenderer(t){const e=[],i=t.clone(),n=await Npt(i);if(Rmt(i)||Pmt(i)){const t=(i.classBreakInfos||i.uniqueValueInfos).map((t=>this._fetchSymbol(t.symbol,n).then((e=>{t.symbol=e})).catch((()=>{t.symbol=null}))));Array.prototype.push.apply(e,t)}return e.push(this._fetchSymbol(i.symbol||i.defaultSymbol,i.defaultSymbol?null:n).then((t=>{this._applySymbolToRenderer(i,t,Nmt(i))})).catch((()=>{this._applySymbolToRenderer(i,null,Nmt(i))}))),await Promise.allSettled(e),i}_applySymbolToRenderer(t,e,i){i?t.symbol=e:t.defaultSymbol=e}async _fetchSymbol(t,e){if(!t)throw new Error;if("web-style"===t.type){const i=this._webStyleSymbolCache;try{const n=await("2d"===this.view.type?t.fetchCIMSymbol({cache:i}):t.fetchSymbol({cache:i}));return this._getAppliedCloneSymbol(n,e)}catch{throw Ft.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(t,e)}_getAppliedCloneSymbol(t,e){if(!t||!e)return t;const i=t.clone(),n=e&&e.toRgba();return i.type.includes("3d")?this._applyColorTo3dSymbol(i,n):"cim"===i.type?kht(i,e):i.color&&(i.color=new wT(n||i.color)),i}_applyColorTo3dSymbol(t,e){e&&t.symbolLayers.forEach((t=>{t&&(t.material||(t.material={}),t.material.color=new wT(e))}))}async _getVisualVariableLegendElements(t,e){if(!("visualVariables"in t)||!t.visualVariables||"vector-field"===t.type)return null;const i=t.visualVariables,n=[],s=[],r=[];for(const t of i)"color"===t.type?n.push(t):"size"===t.type?s.push(t):"opacity"===t.type&&r.push(t);const o=[...n,...s,...r];let a,l;if(0===n.length&&Rmt(t)&&t.classBreakInfos&&1===t.classBreakInfos.length){const e=t.classBreakInfos[0];a=e&&e.symbol}if(0===n.length&&Nmt(t)&&(a=t.symbol),a)if(a.type.includes("3d")){const t=a.symbolLayers.at(0);"water"===t.type?null!=t.color&&(l=t.color):null!=t.material?.color&&(l=t.material.color)}else a.url||(l=a.color);const u=this.effectList;return(await Promise.all(o.map((async i=>{if(!i.legendOptions||!1!==i.legendOptions.showLegend){const n=jmt(t)?i.field:this._getRampTitle(i,e);let s=null;const r=$pt(e,i,this.view.timeZone);if("color"===i.type){const t=await Vpt(i,null,r)??[];s={type:"color-ramp",title:n,infos:t,preview:dpt(t.map((t=>t.color)),{effectList:u,ariaLabel:await oyt("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=t.length>0)}else if("size"===i.type&&"outline"!==i.target)kmt.test(i.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=i):(s=await this._getSizeLegendElement(n,i,t,r),this._hasSizeRamp||(this._hasSizeRamp=!(null==s.infos||!s.infos.length)));else if("opacity"===i.type){const t=await Vpt(i,l,r)??[];s={type:"opacity-ramp",title:n,infos:t,preview:dpt(t.map((t=>t.color)),{effectList:u,ariaLabel:await oyt("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=t.length>0)}return s&&s.infos?s:null}})))).filter(F)}_getDomainName(t,e,i){if(t&&"function"!=typeof t){const n="getField"in i&&i.getField?.(t),s=n&&"getFieldDomain"in i&&i.getFieldDomain?i.getFieldDomain(n.name):null;return"coded-value"===s?.type?s.getName(e):null}return null}_getClusterTitle(t){const e=this.layer,i=t.field;if("featureReduction"in e&&e.featureReduction&&"cluster"===e.featureReduction.type){const t=e.featureReduction,n="popupTemplate"in t&&t.popupTemplate,s=n&&n.fieldInfos;if(s)for(const t of s)if(t.fieldName===i)return"cluster_count"===i?t.label||{showCount:!0}:t.label}return{showCount:!0}}_getRampTitle(t,e){let i=t.field,n=t.normalizationField,s=!1,r=!1,o=!1,a=null;i="function"==typeof i?null:i,n="function"==typeof n?null:n;const l=t.legendOptions?.title;if(null!=l)a=l;else if(t.valueExpressionTitle)a=t.valueExpressionTitle;else{if("renderer"in e&&e.renderer&&"authoringInfo"in e.renderer&&e.renderer.authoringInfo?.visualVariables){const t=e.renderer.authoringInfo.visualVariables;for(let e=0;e<t.length;e++){const i=t[e];if("color"===i.type){if("ratio"===i.style){s=!0;break}if("percent"===i.style){r=!0;break}if("percent-of-total"===i.style){o=!0;break}}}}a={field:i&&this._getFieldAlias(i,e),normField:n&&this._getFieldAlias(n,e),ratio:s,ratioPercent:r,ratioPercentTotal:o}}return a}_getRendererTitle(t,e){const i=t;if(i.legendOptions?.title)return i.legendOptions.title;if(i.valueExpressionTitle)return i.valueExpressionTitle;let n=i.field,s=null,r=null;if(Rmt(i)&&(s=i.normalizationField,r="percent-of-total"===i.normalizationType),n="function"==typeof n?null:n,s="function"==typeof s?null:s,Pmt(i)){const{field2:t,field3:s,fieldDelimiter:r}=i;let o=n&&this._getFieldAlias(n,e);return t&&(o=`<${o}>${r}<${this._getFieldAlias(t,e)}>`,s&&(o=`${o}${r}<${this._getFieldAlias(s,e)}>`)),o}let o=null;return(n||s)&&(o={field:n&&this._getFieldAlias(n,e),normField:s&&this._getFieldAlias(s,e),normByPct:r}),o}_getFieldAlias(t,e){const i="popupTemplate"in e?e.popupTemplate:null,n=i?.fieldInfos;let s=n?.find((e=>t===e.fieldName)),r=null;"getField"in e&&e.getField?r=e.getField(t):"fieldsIndex"in e&&e.fieldsIndex&&(r=e.fieldsIndex.get(t));let o=null;const a="featureReduction"in e&&e.featureReduction;a&&(s??="popupTemplate"in a?a.popupTemplate?.fieldInfos?.find((e=>t?.toLowerCase()===e.fieldName?.toLowerCase())):void 0,"fields"in a&&a.fields&&(o=a.fields.find((e=>e.name?.toLowerCase()===t?.toLowerCase()))));const l=s||r||o;let u=null;return l&&(u=s?.label||r?.alias||o?.alias||"name"in l&&l.name||"fieldName"in l&&l.fieldName||null),u}_isUnclassedRenderer(t){const e=t.visualVariables;let i=!1;return Rmt(t)&&t.classBreakInfos&&1===t.classBreakInfos.length&&e&&(i=t.field?e.some((e=>!(!e||t.field!==e.field||(t.normalizationField||e.normalizationField)&&t.normalizationField!==e.normalizationField))):!!e.length),i}};o([Us()],uyt.prototype,"children",void 0),o([Us({readOnly:!0})],uyt.prototype,"effectList",null),o([Us()],uyt.prototype,"layerView",void 0),o([Us()],uyt.prototype,"layer",void 0),o([Us()],uyt.prototype,"legendElements",void 0),o([Us({readOnly:!0})],uyt.prototype,"opacity",null),o([Us()],uyt.prototype,"parent",void 0),o([Us({readOnly:!0,dependsOn:[]})],uyt.prototype,"ready",null),o([Us()],uyt.prototype,"hideLayersNotInCurrentView",void 0),o([Us()],uyt.prototype,"keepCacheOnDestroy",void 0),o([Us()],uyt.prototype,"respectLayerVisibility",void 0),o([Us({readOnly:!0})],uyt.prototype,"scale",null),o([Us()],uyt.prototype,"sublayerIds",void 0),o([Us({readOnly:!0})],uyt.prototype,"isScaleDriven",null),o([Us()],uyt.prototype,"title",void 0),o([Us({readOnly:!0,dependsOn:["ready"],value:0})],uyt.prototype,"version",null),o([Us()],uyt.prototype,"view",void 0),uyt=o([Nr("esri.widgets.Legend.support.ActiveLayerInfo")],uyt);const cyt=uyt;const hyt={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},dyt=ty.ofType(cyt),fyt=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer"]),pyt="view.basemapView.baseLayerViews",myt="view.groundView.layerViews",yyt="view.basemapView.referenceLayerViews",gyt=[pyt,myt,"view.layerViews",yyt];let vyt=class extends Vr{constructor(t){super(t),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new ty,this.activeLayerInfos=new dyt,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(fy((()=>this.view),(()=>this._viewHandles()),_y),hyt.view),this.addHandles(og((()=>this._refresh())))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles(hyt.state),this.view&&this.addHandles(fy((()=>this.state),(()=>this._stateHandles()),_y),hyt.state)}_stateHandles(){this._resetAll(),"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([hyt.allLayerViews,hyt.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(t){this.removeHandles(t);const e=this._activeLayerInfosByLayerViewId[t];delete this._activeLayerInfosByLayerViewId[t],e?.parent&&e.parent.children.remove(e)}_watchPropertiesAndAllLayerViews(){const{view:t}=this;if(!t)return;const{allLayerViews:e}=t;e.length&&this._refresh(),this.addHandles(e.on("change",(t=>this._propertiesChangeHandle())),hyt.allLayerViews),this.addHandles(fy((()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible]),(()=>this._propertiesChangeHandle())),hyt.legendProperties)}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(t){const e=this.view;if(t.length<2||!e)return;const i=[];t.forEach((e=>{if(!e.parent){const n=e.layer.parent,s=n&&"uid"in n&&this._layerViewByLayerId[n.uid],r=s&&this._activeLayerInfosByLayerViewId[s.uid];r&&t.includes(r)&&(i.push(e),e.parent=r,r.children.add(e),this._sortActiveLayerInfos(r.children))}})),t.removeMany(i);const n={};e.allLayerViews.forEach(((t,e)=>n[t.layer.uid]=e)),t.sort(((t,e)=>{const i=n[t.layer.uid]||0;return(n[e.layer.uid]||0)-i}))}_generateLayerViews(){const t=[];return gyt.filter(this._filterLayerViews,this).map((t=>le(this,t))).filter((t=>null!=t)).forEach(this._collectLayerViews("layerViews",t)),t}_filterLayerViews(t){const e=!this.basemapLegendVisible&&(t===pyt||t===yyt),i=!this.groundLegendVisible&&t===myt;return!e&&!i}_collectLayerViews(t,e){const i=n=>(n&&n.forEach((n=>{e.push(n),i(n[t])})),e);return i}_filterLayerViewsByLayerInfos(t){const e=this.layerInfos;return!e||!e.length||e.some((e=>this._hasLayerInfo(e,t)))}_hasLayerInfo(t,e){const i=this._isLayerUIDMatching(t.layer,e.layer.uid);return i&&(this._layerInfosByLayerViewId[e.uid]=t),i}_isLayerUIDMatching(t,e){return t&&(t.uid===e||this._hasLayerUID(t.layers,e))}_hasLayerUID(t,e){return t&&t.some((t=>this._isLayerUIDMatching(t,e)))}_isLayerViewSupported(t){return!!fyt.has(t.layer.declaredClass)&&(this._layerViewByLayerId[t.layer.uid]=t,!0)}_generateActiveLayerInfo(t){this._isLayerActive(t)?this._buildActiveLayerInfo(t):(this.removeHandles(t.uid),this.addHandles(fy((()=>[t.legendEnabled,t.layer?.legendEnabled]),(()=>this._layerActiveHandle(t))),t.uid))}_layerActiveHandle(t){this._isLayerActive(t)&&(this.removeHandles(t.uid),this._buildActiveLayerInfo(t))}_isLayerActive(t){return!this.respectLayerVisibility||t.legendEnabled&&t.layer?.legendEnabled}_buildActiveLayerInfo(t){const e=t.layer,i=t.uid,n=this._layerInfosByLayerViewId[i];let s=this._activeLayerInfosByLayerViewId[i];if(!s){const r=void 0!==n?.title&&n.layer.uid===e.uid;s=new cyt({layer:e,layerView:t,title:r?n.title:e.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:n?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[i]=s}const r=e.parent&&"uid"in e.parent?this._layerViewByLayerId[e.parent?.uid]:null;if(s.parent=this._activeLayerInfosByLayerViewId[r?.uid],!this.hasHandles(i)){const n=[fy((()=>e.title),(t=>this._titleHandle(t,s))),fy((()=>[e.opacity,"renderer"in e&&e.renderer,"pointSymbol"in e&&e.pointSymbol,"lineSymbol"in e&&e.lineSymbol,"polygonSymbol"in e&&e.polygonSymbol]),(()=>this._constructLegendElements(s))),py((()=>!0===this.view?.stationary),(()=>this._scaleHandle(s)),_y),fy((()=>t.layer?Yct(t.layer,t.view):null),(()=>this._constructLegendElements(s))),fy((()=>t.updating),(()=>{if(null==t.layer)return;null!=Yct(t.layer,t.view)&&this._constructLegendElements(s)})),fy((()=>"effect"in e&&e.effect),(()=>this._constructLegendElements(s))),py((()=>this.view?.timeZone),(()=>this._constructLegendElements(s)),_y)];if(this.respectLayerVisibility){const i=fy((()=>t.legendEnabled),(t=>this._legendEnabledHandle(t,s))),r=fy((()=>e.legendEnabled),(t=>this._legendEnabledHandle(t,s)));n.push(i,r)}this.addHandles(n,i)}s.isScaleDriven||this._constructLegendElements(s),this._addActiveLayerInfo(s)}_titleHandle(t,e){e.title=t,this._constructLegendElements(e)}_legendEnabledHandle(t,e){t?this._addActiveLayerInfo(e):this._removeActiveLayerInfo(e)}_scaleHandle(t){(t.isScaleDriven||t.hideLayersNotInCurrentView)&&this._constructLegendElements(t)}_addActiveLayerInfo(t){const{layerView:e,layer:i}=t;if(this._isLayerActive(e)&&!this.activeLayerInfos.includes(t)){const e=t.parent;if(e)e.children.includes(t)||e.children.push(t),this._sortActiveLayerInfos(e.children);else{const e=this.layerInfos?.some((t=>t.layer.uid===i.uid));i.parent&&"uid"in i.parent&&!e?this._activeLayerInfosWithNoParent.add(t):(this.activeLayerInfos.add(t),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const t=[];this._activeLayerInfosWithNoParent.forEach((e=>{const i=e.layer.parent,n=i&&"uid"in i?this._layerViewByLayerId[i?.uid]:null,s=this._activeLayerInfosByLayerViewId[n?.uid];s&&(t.push(e),e.parent=s)})),t.length&&(this._activeLayerInfosWithNoParent.removeMany(t),t.forEach((t=>this._addActiveLayerInfo(t))))}}}_removeActiveLayerInfo(t){const e=t.parent;e?e.children.remove(t):this.activeLayerInfos.remove(t)}_constructLegendElements(t){const e=t.layer;"featureCollections"in e&&e.featureCollections?t.buildLegendElementsForFeatureCollections(e.featureCollections):"featureReduction"in e&&e.featureReduction&&"renderer"in e.featureReduction&&("binning"===e.featureReduction.type||"cluster"===e.featureReduction.type)&&(!this.view||e.featureReduction.maxScale<=this.view.scale)?t.buildLegendElementsForFeatureReduction(e.featureReduction):"renderer"in e&&e.renderer&&!("sublayers"in e)?t.buildLegendElementsForRenderer(e.renderer):"url"in e&&e.url?t.buildLegendElementsForTools():t.children.forEach((t=>this._constructLegendElements(t)))}};o([Us({type:dyt})],vyt.prototype,"activeLayerInfos",void 0),o([Us()],vyt.prototype,"basemapLegendVisible",void 0),o([Us()],vyt.prototype,"groundLegendVisible",void 0),o([Us()],vyt.prototype,"hideLayersNotInCurrentView",void 0),o([Us()],vyt.prototype,"keepCacheOnDestroy",void 0),o([Us()],vyt.prototype,"respectLayerVisibility",void 0),o([Us()],vyt.prototype,"layerInfos",void 0),o([Us({readOnly:!0})],vyt.prototype,"state",null),o([Us()],vyt.prototype,"view",void 0),vyt=o([Nr("esri.widgets.Legend.LegendViewModel")],vyt);const wyt=vyt;const byt="esri-legend--card",Syt="esri-legend",xyt={activated:`${byt}__carousel-indicator--activated`,base:byt,stacked:`${Syt}--stacked`,carouselTitle:`${byt}__carousel-title`,indicator:`${byt}__carousel-indicator`,intervalSeparator:`${byt}__interval-separator`,imageryLayerStretchedImage:`${byt}__imagery-layer-image--stretched`,imageLabel:`${byt}__image-label`,layerCaption:`${byt}__layer-caption`,labelElement:`${byt}__label-element`,layerRow:`${byt}__layer-row`,labelCell:`${byt}__label-cell`,message:`${byt}__message`,rampLabel:`${byt}__ramp-label`,section:`${byt}__section`,relationshipSection:`${byt}__relationship-section`,serviceCaptionText:`${byt}__service-caption-text`,serviceContent:`${byt}__service-content`,service:`${byt}__service`,groupLayer:`${byt}__group-layer`,groupLayerChild:`${byt}__group-layer-child`,symbol:`${byt}__symbol`,sizeRampRow:`${byt}__size-ramp-row`,symbolRow:`${byt}__symbol-row`,symbolCell:`${byt}__symbol-cell`,indicatorContainer:`${byt}__carousel-indicator-container`,intervalSeparatorsContainer:`${byt}__interval-separators-container`,relationshipLabelContainer:`${byt}__relationship-label-container`,labelContainer:`${byt}__label-container`,serviceCaptionContainer:`${byt}__service-caption-container`,symbolContainer:`${byt}__symbol-container`,sizeRampContainer:`${byt}__size-ramp-container`,sizeRampPreview:`${byt}__size-ramp-preview`,pieChartRampPreview:`${byt}__pie-chart-ramp-preview`,rampContainer:`${Syt}__ramps`,sizeRampHorizontal:`${Syt}__size-ramp--horizontal`,rampLabelsContainer:`${Syt}__ramp-labels`,layerInfo:`${Syt}__layer-cell ${Syt}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};const _yt=O_(),Myt=10,kyt=20,Tyt=10,Ayt=20,Iyt={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function jyt(t="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return"vertical"===t?ZK("svg",{height:"4",width:"10"},ZK("line",{style:e,x1:"0",x2:"10",y1:"2",y2:"2"})):ZK("svg",{height:"10",width:"10"},ZK("line",{style:e,x1:"5",x2:"5",y1:"0",y2:"10"}))}function Cyt(t,e="vertical"){const i=document.createElement("div");return i.style.height=`${kyt}px`,i.className=Iyt.univariateAboveAndBelowSymbol,null!=t&&(i.style.opacity=t.toString()),_yt.append(i,jyt.bind(null,e)),i}function Eyt(t,e,i="vertical",n){t.infos.forEach(((t,s)=>{if(n&&2===s)t.preview=Cyt(e,i);else{const e=RT(t.size)+("horizontal"===i?Ayt:Tyt),n=t.preview,s="div"===n?.tagName.toLowerCase(),r=s?n:document.createElement("div");r.className=Iyt.univariateAboveAndBelowSymbol,"horizontal"===i?r.style.width=`${e}px`:r.style.height=`${e}px`,!s&&n&&r.appendChild(n),t.preview=r}}))}function Oyt(t,e="classic"){const i=t.infos;return"classic"===e?(RT(i[0].size)+Tyt)/2:(RT(i[0].size)-RT(i[i.length-1].size))/2}function Lyt(t,e){if(!t)return null;const i=t.infos.map((t=>t.color)),n=dpt("full"===e.type?i:"above"===e.type?i.slice(0,3):i.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,effectList:e.effectList,ariaLabel:e.ariaLabel});return n.className=Iyt.colorRamp,null!=e.opacity&&(n.style.opacity=e.opacity.toString()),n}function Nyt(t,e,i,n="vertical"){let s=0;const r=t.infos,o=Math.floor(r.length/2),a="full"===e||"above"===e?0:o,l="full"===e||"below"===e?r.length-1:o;for(let t=a;t<=l;t++)if(i&&t===o)s+="horizontal"===n?Myt:kyt;else{s+=RT(r[t].size)+("horizontal"===n?Ayt:Tyt)}return Math.round(s)}function Ryt(t,e,i,n="vertical"){const s=Nyt(t,e,i,n),r=t.infos,o=Math.floor(r.length/2),a="full"===e||"above"===e?0:o,l="full"===e||"below"===e?r.length-1:o,u="full"===e?r[a].size+r[l].size:"above"===e?r[a].size:r[l].size,c=i?"vertical"===n?kyt:Myt:0,h="vertical"===n?Tyt*("full"===e?2:1):Ayt*("full"===e?2:1);return Math.round(s-(RT(u)/2+c/2+h/2))}function Pyt(t,e,i="vertical"){const n=t.infos;let s=n.find((({type:t})=>"size-ramp"===t)),r=n.find((({type:t})=>"color-ramp"===t));return s&&(s={...s},s.infos=[...s.infos],Eyt(s,e,i,!0)),r&&(r={...r},r.infos=[...r.infos]),"horizontal"===i&&(s?.infos.reverse(),r?.infos.reverse()),{sizeRampElement:s,colorRampElement:r}}function Fyt(t,e="vertical"){const i=t.infos;let n=i.find((({type:t})=>"size-ramp"===t)),s=i.find((({type:t})=>"color-ramp"===t));return n&&(n={...n},n.infos=[...n.infos],Eyt(n,null,e,!1)),s&&(s={...s},s.infos=[...s.infos]),"horizontal"===e&&(n?.infos.reverse(),s?.infos.reverse()),{sizeRampElement:n,colorRampElement:s}}function Dyt(t,e){return e}function $yt(t){const e=this;t.appendChild(e)}function zyt(t,e,i){if(!e)return;if("number"==typeof e)return e;if("string"==typeof e)return Nt(e);if("value"in e||"unit"in e)return sv(t.dotValue,e);if("colorName"in e&&"bandName"in e)return t[e.colorName]+": "+(t[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?t.clusterCountTitle:void 0;let n=null;return Dyt(e,i)?n=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:Uyt(e,i)&&(n=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),n?sv("showField"===n?"{field}":t[n],{field:e.field,normField:e.normField}):void 0}function Uyt(t,e){return!e}function Vyt(t,e){return!!(e&&"Stretched"===e&&t.version>=10.3&&"esri.layers.ImageryLayer"===t.declaredClass)}function Gyt(t,e){return t.label?e[t.label]+": "+("string"==typeof t.value?t.value:iv(t.value??0,{style:"decimal",notation:t.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}function Byt({level:t,class:e,...i},n){const s=qyt(t);return ZK(`h${s}`,{...i,"aria-level":String(s),class:Vx(zK.heading,e),role:"heading"},n)}function qyt(t){return pa(Math.ceil(t),1,6)}function Hyt(t,e=1){return qyt(t+e)}const Wyt=25,Zyt=25,Jyt=768,Kyt=100;var Yyt;!function(t){t.Auto="auto",t.Stack="stack",t.SideBySide="side-by-side"}(Yyt||(Yyt={}));const Qyt="#ddd",Xyt=window.devicePixelRatio;function tgt(t){if(t){if(t.type.includes("3d")){const e=t.symbolLayers?.length;if(!e)return;const i=t.symbolLayers.at(e-1),n=i.resource?.primitive;return"circle"===n||"cross"===n||"kite"===n||"sphere"===n||"cube"===n||"diamond"===n}{const e=t.style;return"circle"===e||"diamond"===e||"cross"===e}}}function egt(t){if(t){if(t.type.includes("3d")){const e=t.symbolLayers?.length;if(!e)return;const i=t.symbolLayers.at(e-1).get("resource.primitive");return"triangle"===i||"cone"===i||"tetrahedron"===i}return"triangle"===t.style}}let igt=class extends CK{constructor(t,e){super(t,e),this._hasIndicators=!1,this._selectedSectionName=null,this._sectionNames=[],this._sectionMap=new Map,this.activeLayerInfos=null,this.headingLevel=3,this.layout=Yyt.Stack,this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}initialize(){this.addHandles(fy((()=>this.activeLayerInfos),(t=>{this.removeAllHandles(),this._watchForSectionChanges(t)})))}render(){const{view:t}=this;this._hasIndicators=this.layout===Yyt.Auto&&t&&t.container.clientWidth<=Jyt||this.layout===Yyt.Stack;const e=this.activeLayerInfos,i=e&&e.toArray().map((t=>this._renderLegendForLayer(t))).filter((t=>!!t));this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const n=this._sectionNames.length,s=this._sectionNames.map(((t,e)=>{const i=sv(this.messagesCommon.pagination.pageText,{index:e+1,total:n});return ZK("div",{"aria-controls":`${t}-panel`,"aria-label":i,"aria-selected":(this._selectedSectionName===t).toString(),bind:this,class:this.classes(xyt.indicator,{[xyt.activated]:this._selectedSectionName===t}),"data-section-name":t,id:t,key:t,onclick:this._selectSection,onkeydown:this._focusSection,role:"tab",tabIndex:this._selectedSectionName===t?0:-1,title:i})})),r=this._hasIndicators&&n>1?ZK("div",{class:xyt.indicatorContainer,key:"carousel-navigation",role:"tablist"},s):null,o=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):i&&i.length?i:null,a={[xyt.stacked]:this._hasIndicators};return ZK("div",{class:this.classes(xyt.base,a)},o||ZK("div",{class:xyt.message},this.messages.noLegend),r)}_selectSection(t){const e=t.target.getAttribute("data-section-name");e&&(this._selectedSectionName=e)}_focusSection(t){switch(t.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(t);break;case"Enter":case" ":this._selectSection(t)}}_switchSectionOnArrowPress(t){const e=t.key,i="ArrowLeft"===e?-1:1,n=t.target.getAttribute("data-section-name"),s=this._sectionNames.indexOf(n),r=this._sectionNames;let o=null;-1!==s&&(r[s+i]?o=document.getElementById(r[s+i]):"ArrowLeft"===e?o=document.getElementById(r[r.length-1]):"ArrowRight"===e&&(o=document.getElementById(r[0])),o?.focus())}_watchForSectionChanges(t){if(this._generateSectionNames(),t){t.forEach((t=>{const e=`activeLayerInfo-${t.layer.uid}-version-change`;this.removeHandles(e),this._watchForSectionChanges(t.children),this.addHandles(fy((()=>t.version),(()=>this._generateSectionNames())),e)}));const e="activeLayerInfos-collection-change";this.removeHandles(e),this.addHandles(t.on("change",(()=>this._watchForSectionChanges(t))),e)}}_generateSectionNames(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(t,e,i){return`${this.id}${t.uid}-type-${e.type}-${i}`}_generateSectionNamesForActiveLayerInfo(t){t.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),t.legendElements&&t.legendElements.forEach(((e,i)=>{this._sectionNames.push(this._getSectionName(t.layer,e,i))}))}_renderLegendForLayer(t){if(!t.ready)return null;if(t.children.length){const e=t.children.map((t=>this._renderLegendForLayer(t))).toArray();return ZK("div",{class:this.classes(xyt.service,xyt.groupLayer),key:t.layer.uid},ZK("div",{class:xyt.serviceCaptionContainer},t.title),e)}{const e=t.legendElements;if(e&&!e.length)return null;const i=e.some((t=>"relationship-ramp"===t.type)),n=e.map(((e,n)=>this._renderLegendForElement(e,t,n,i))).filter((t=>!!t));if(!n.length)return null;const s={[xyt.groupLayerChild]:!!t.parent};return ZK("div",{class:this.classes(xyt.service,s),key:t.layer.uid},ZK("div",{class:xyt.serviceCaptionContainer},ZK("div",{class:xyt.serviceCaptionText},t.title)),ZK("div",{class:xyt.serviceContent},n))}}_renderLegendForElement(t,e,i,n=!1,s=!1){const r="color-ramp"===t.type,o="opacity-ramp"===t.type,a=e.layer;let l=null;if("string"==typeof t.title)l=t.title;else if(t.title){const e=t.title,i=zyt(this.messages,e,r||o);l=e.title?`${e.title} (${i})`:i}const u=this._getSectionName(a,t,i),c=this._hasIndicators&&!s?ZK("div",null,ZK(Byt,{class:xyt.carouselTitle,level:this.headingLevel},e.title),ZK(Byt,{class:xyt.layerCaption,level:Hyt(this.headingLevel)},l)):l?ZK(Byt,{class:xyt.layerCaption,level:this.headingLevel},l):null,h=e.effectList;let d=null;switch(t.type){case"symbol-table":{const i=t.infos.map(((i,n)=>this._renderLegendForElementInfo(i,e,t.legendType,n))).filter((t=>!!t));if(i.length){const t=i[0].properties.classes?.[xyt.symbolRow],e={[xyt.labelContainer]:!t&&!n,[xyt.relationshipLabelContainer]:n};d=ZK("div",{class:this.classes(e)},i)}break}case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":d=this._renderLegendForRamp(t,a.opacity,h);break;case"size-ramp":d=this._renderSizeRamp(t,a.opacity);break;case"pie-chart-ramp":d=this._renderPieChartRamp(t);break;case"relationship-ramp":d=yft(t,this.id,{opacity:a.opacity,effectList:h,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case"univariate-above-and-below-ramp":d=this._renderUnivariateAboveAndBelowRamp(t,a.opacity,h);break;case"univariate-color-size-ramp":d=this._renderUnivariateColorSizeRamp(t,a.opacity,h)}if(!d)return null;const f=ZK("div",{"aria-labelledby":u,class:xyt.section,id:`${u}-panel`,key:u,role:"tabpanel",tabIndex:0},[c,d]);return s||this._sectionMap.set(u,f),f}_renderPieChartRamp(t){return ZK("div",{afterCreate:$yt,bind:t.preview,class:xyt.pieChartRampPreview})}_renderUnivariateAboveAndBelowRamp(t,e,i){const{sizeRampElement:n,colorRampElement:s}=Pyt(t,e,"horizontal");if(!n)return null;const r=Nyt(n,"full",!0,"horizontal"),o=Ryt(n,"above",!0,"horizontal"),a=Ryt(n,"below",!0,"horizontal"),l=12,u=this.messages?.previewColorRampAriaLabel,c=Lyt(s,{width:o,height:l,rampAlignment:"horizontal",opacity:e,type:"above",effectList:i,ariaLabel:u}),h=Lyt(s,{width:a,height:l,rampAlignment:"horizontal",opacity:e,type:"below",effectList:i,ariaLabel:u}),d=Oyt(n,"card"),f=n.infos.map((t=>t.label)),p=f.length-1,m=f.map(((t,e)=>0===e||e===p?ZK("div",{key:e},t):null)),y={display:"flex",flexDirection:"column"},g={display:"flex",flexDirection:"row"},v={marginTop:"3px",display:"flex"};Bx(this.container)?v.marginRight=`${d}px`:v.marginLeft=`${d}px`;const w={width:`${r}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return ZK("div",{class:xyt.layerRow,key:"size-ramp-preview",styles:y},ZK("div",{class:this.classes(xyt.symbolContainer,xyt.sizeRampHorizontal),styles:g},n.infos.map(((t,e)=>ZK("div",{afterCreate:$yt,bind:t.preview,class:xyt.symbol,key:e})))),c?ZK("div",{class:xyt.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:v},ZK("div",{afterCreate:$yt,bind:c}),ZK("div",{afterCreate:$yt,bind:h})):null,ZK("div",{class:xyt.layerInfo},ZK("div",{class:xyt.rampLabelsContainer,styles:w},m)))}_renderUnivariateColorSizeRamp(t,e,i){const{sizeRampElement:n,colorRampElement:s}=Fyt(t,"horizontal");if(!n)return null;const r=Nyt(n,"full",!1,"horizontal"),o=Ryt(n,"full",!1,"horizontal"),a=Lyt(s,{width:o,height:12,rampAlignment:"horizontal",opacity:e,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),l=Oyt(n,"card"),u=n.infos.length-1,c=n.infos.map(((t,e)=>0===e||e===u?ZK("div",{key:e},t.label):null)),h={display:"flex",flexDirection:"column"},d={display:"flex",flexDirection:"row"},f={marginTop:"3px",display:"flex"};Bx(this.container)?f.marginRight=`${l}px`:f.marginLeft=`${l}px`;const p={width:`${r}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return ZK("div",{class:xyt.layerRow,key:"size-ramp-preview",styles:h},ZK("div",{class:this.classes(xyt.symbolContainer,xyt.sizeRampHorizontal),styles:d},n.infos.map(((t,e)=>ZK("div",{afterCreate:$yt,bind:t.preview,class:xyt.symbol,key:e})))),ZK("div",{class:xyt.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:f},ZK("div",{afterCreate:$yt,bind:a})),ZK("div",{class:xyt.layerInfo},ZK("div",{class:xyt.rampLabelsContainer,styles:p},c)))}_renderLegendForElementInfo(t,e,i,n){const s=e.layer;if(t.type)return this._renderLegendForElement(t,e,n,!1,!0);const r=Vyt(s,i),o=zyt(this.messages,t.label,!1)??"";if(t.preview){if(!t.symbol?.type.includes("simple-fill")){if(!t.label)return ZK("div",{afterCreate:$yt,bind:t.preview,key:n});const e={[xyt.symbolCell]:this._hasIndicators};return ZK("div",{class:this.classes(xyt.layerRow,{[xyt.symbolRow]:this._hasIndicators}),key:n},ZK("div",{afterCreate:$yt,bind:t.preview,class:this.classes(e)}),ZK("div",{class:this.classes(xyt.imageLabel,{[xyt.labelCell]:this._hasIndicators})},o))}let i=255,r=255,a=255,l=0,u=255,c=255,h=255,d=0;const f=t.symbol.color?.a,p=t.symbol.outline?.color?.a;f&&(i=t.symbol.color.r,r=t.symbol.color.g,a=t.symbol.color.b,l=t.symbol.color.a*s.opacity),p&&(u=t.symbol.outline.color.r,c=t.symbol.outline.color.g,h=t.symbol.outline.color.b,d=t.symbol.outline.color.a*s.opacity);const m=t.symbol.color?.isBright??!0,y=m?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",g={background:f?`rgba(${i}, ${r}, ${a}, ${l})`:"none",color:m?"black":"white",textShadow:`-1px -1px 0 ${y},\n                                              1px -1px 0 ${y},\n                                              -1px 1px 0 ${y},\n                                              1px 1px 0 ${y}`,border:p?`1px solid rgba(${u}, ${c}, ${h}, ${d})`:"none",filter:eft(e.effectList)??void 0};return ZK("div",{class:xyt.layerRow,key:n},ZK("div",{class:xyt.labelElement,styles:g},o))}if(t.src){const e=this._renderImage(t,s,r);return ZK("div",{class:xyt.layerRow,key:n},e,ZK("div",{class:xyt.imageLabel},o))}}_renderImage(t,e,i){const{label:n,src:s,opacity:r}=t,o={[xyt.imageryLayerStretchedImage]:i,[xyt.symbol]:!i},a={opacity:`${null!=r?r:e.opacity}`};return ZK("img",{alt:zyt(this.messages,n,!1),"aria-label":zyt(this.messages,n,!1),border:0,class:this.classes(o),height:t.height,src:s,styles:a,width:t.width})}_renderSizeRampLines(t){const e=t.infos,i=e[0],n=e[e.length-1],s=i.symbol,r=this._hasIndicators,o=RT(i.size+i.outlineSize)*Xyt,a=RT(n.size+n.outlineSize)*Xyt,l=r?o:o+50*Xyt,u=r?o/2+50*Xyt:o,c=egt(s),h=tgt(s),d=document.createElement("canvas");d.width=l,d.height=u,d.style.width=d.width/Xyt+"px",d.style.height=d.height/Xyt+"px";const f=d.getContext("2d");if(r){f.beginPath();const t=0,e=0,i=l/2-a/2,n=u;f.moveTo(t,e),f.lineTo(i,n);const s=l,r=0,o=l/2+a/2,c=u;f.moveTo(s,r),f.lineTo(o,c)}else{f.beginPath();const t=0,e=u/2-a/2,i=l,n=0;f.moveTo(t,e),f.lineTo(i,n);const s=0,r=u/2+a/2,o=l,c=u;f.moveTo(s,r),f.lineTo(o,c)}return f.strokeStyle=Qyt,f.stroke(),ZK("div",{afterCreate:$yt,bind:d,styles:r?{display:"flex",marginTop:`-${c?0:h?o/2:0}px`,marginBottom:`-${c?a:h?a/2:0}px`}:{display:"flex",marginRight:`-${c?0:h?o/2:0}px`,marginLeft:`-${c?0:h?a/2:0}px`}})}_renderSizeRamp(t,e){const i=t.infos,n=i[0].label,s=i[i.length-1].label;let r=i[0].preview,o=i[i.length-1].preview;const a=this._hasIndicators,l={"flex-direction":a?"column":"row-reverse"};r&&(r=r.cloneNode(!0),r.style.display="flex"),o&&(o=o.cloneNode(!0),o.style.display="flex");const u={opacity:null!=e?`${e}`:""};return ZK("div",{class:this.classes(xyt.layerRow,{[xyt.sizeRampRow]:a})},ZK("div",{class:xyt.rampLabel},a?n:s),ZK("div",{class:xyt.sizeRampContainer,styles:l},ZK("div",{afterCreate:$yt,bind:r,class:xyt.sizeRampPreview,styles:u}),this._renderSizeRampLines(t),ZK("div",{afterCreate:$yt,bind:o,class:xyt.sizeRampContainer,styles:u})),ZK("div",{class:xyt.rampLabel},a?s:n))}_getRampStopLabel(t,e){switch(e){case"heatmap-ramp":return this.messages[t.label];case"stretch-ramp":return Gyt(t,this.messages);default:return t.label}}_renderLegendForRamp(t,e,i){const n=t.infos,s=t.type,r="heatmap-ramp"===s,o=n.length-1,a=Zyt,l=o>2&&!r?Wyt*o:Kyt,u=l+20,c=10,h=n.slice(0).reverse(),d=h.length-1,f=h.length%2!=0?h[h.length/2|0]:null,p=f&&ZK("div",{class:xyt.intervalSeparatorsContainer},ZK("div",{class:xyt.intervalSeparator},"|"),ZK("div",{class:xyt.rampLabel},this._getRampStopLabel(f,s))),m=[[{shape:{type:"path",path:`M0 ${a/2} L${c} 0 L${c} ${a} Z`},fill:h[0].color,stroke:{width:0}},{shape:{type:"rect",x:c,y:0,width:l,height:a},fill:{type:"linear",x1:c,y1:0,x2:l+c,y2:0,colors:h.map(((t,e)=>({color:t.color,offset:r&&"ratio"in t?t.ratio:e/o})))},stroke:{width:0}},{shape:{type:"path",path:`M${l+c} 0 L${u} ${a/2} L${l+c} ${a} Z`},fill:h[d].color,stroke:{width:0}}]],y=Cdt(m,u,a),g={filter:eft(i)??void 0,opacity:null==e?void 0:`${e}`},v={justifyContent:"center"};return ZK("div",{class:xyt.layerRow,styles:v},ZK("div",{class:xyt.rampLabel},this._getRampStopLabel(h[0],s)),ZK("div",{class:xyt.symbolContainer},ZK("div",{styles:g},y),p),ZK("div",{class:xyt.rampLabel},this._getRampStopLabel(h[d],s)))}};o([Us()],igt.prototype,"activeLayerInfos",void 0),o([Us()],igt.prototype,"headingLevel",void 0),o([Us()],igt.prototype,"layout",void 0),o([Us(),BK("esri/widgets/Legend/t9n/Legend")],igt.prototype,"messages",void 0),o([Us(),BK("esri/t9n/common")],igt.prototype,"messagesCommon",void 0),o([Us({readOnly:!0})],igt.prototype,"type",void 0),o([Us()],igt.prototype,"view",void 0),o([UK()],igt.prototype,"_selectSection",null),igt=o([Nr("esri.widgets.Legend.styles.Card")],igt);const ngt=igt;const sgt="esri-legend",rgt={service:`${sgt}__service`,label:`${sgt}__service-label`,layer:`${sgt}__layer`,groupLayer:`${sgt}__group-layer`,groupLayerChild:`${sgt}__group-layer-child`,layerTable:`${sgt}__layer-table`,layerTableSizeRamp:`${sgt}__layer-table--size-ramp`,layerChildTable:`${sgt}__layer-child-table`,layerCaption:`${sgt}__layer-caption`,layerBody:`${sgt}__layer-body`,layerRow:`${sgt}__layer-row`,layerCell:`${sgt}__layer-cell`,layerInfo:`${sgt}__layer-cell ${sgt}__layer-cell--info`,imageryLayerStretchedImage:`${sgt}__imagery-layer-image--stretched`,imageryLayerCellStretched:`${sgt}__imagery-layer-cell--stretched`,imageryLayerInfoStretched:`${sgt}__imagery-layer-info--stretched`,symbolContainer:`${sgt}__layer-cell ${sgt}__layer-cell--symbols`,symbol:`${sgt}__symbol`,rampContainer:`${sgt}__ramps`,sizeRamp:`${sgt}__size-ramp`,colorRamp:`${sgt}__color-ramp`,opacityRamp:`${sgt}__opacity-ramp`,borderlessRamp:`${sgt}__borderless-ramp`,rampTick:`${sgt}__ramp-tick`,rampFirstTick:`${sgt}__ramp-tick-first`,rampLastTick:`${sgt}__ramp-tick-last`,rampLabelsContainer:`${sgt}__ramp-labels`,rampLabel:`${sgt}__ramp-label`,message:`${sgt}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};const ogt=`${sgt}__`,agt=24,lgt={display:"flex",alignItems:"flex-start"},ugt={marginLeft:"3px"},cgt={display:"table-cell",verticalAlign:"middle"};let hgt=class extends CK{constructor(t,e){super(t,e),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const t=this.activeLayerInfos,e=t&&t.toArray().map((t=>this._renderLegendForLayer(t))).filter((t=>!!t));return ZK("div",null,e&&e.length?e:ZK("div",{class:rgt.message},this.messages.noLegend))}_renderLegendForLayer(t){if(!t.ready)return null;const e=!!t.children.length,i=`${ogt}${t.layer.uid}-version-${t.version}`,n=t.title?Byt({level:this.headingLevel,class:this.classes(zK.heading,rgt.label)},t.title):null;if(e){const e=t.children.map((t=>this._renderLegendForLayer(t))).toArray();return ZK("div",{class:this.classes(rgt.service,rgt.groupLayer),key:i},n,e)}{const e=t.legendElements;if(e&&!e.length)return null;const s=e.map((e=>this._renderLegendForElement(e,t.layer,t.effectList))).filter((t=>!!t));if(!s.length)return null;const r={[rgt.groupLayerChild]:!!t.parent};return ZK("div",{class:this.classes(rgt.service,r),key:i},n,ZK("div",{class:rgt.layer},s))}}_renderLegendForElement(t,e,i,n){const s="color-ramp"===t.type,r="opacity-ramp"===t.type,o="size-ramp"===t.type;let a=null;if("symbol-table"===t.type||o){const n=t.infos.map((n=>this._renderLegendForElementInfo(n,e,i,o,t.legendType))).filter((t=>!!t));n.length&&(a=ZK("div",{class:rgt.layerBody},n))}else"color-ramp"===t.type||"opacity-ramp"===t.type||"heatmap-ramp"===t.type||"stretch-ramp"===t.type?a=this._renderLegendForRamp(t,e.opacity):"relationship-ramp"===t.type?a=yft(t,this.id,{opacity:e.opacity,effectList:i,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):"pie-chart-ramp"===t.type?a=this._renderPieChartRamp(t):"univariate-above-and-below-ramp"===t.type?a=this._renderUnivariateAboveAndBelowRamp(t,e.opacity,i):"univariate-color-size-ramp"===t.type&&(a=this._renderUnivariateColorSizeRamp(t,e.opacity,i));if(!a)return null;const l=t.title;let u=null;if("string"==typeof l)u=l;else if(l){const t=zyt(this.messages,l,s||r);u=Uyt(l,s||r)&&l.title?`${l.title} (${t})`:t}const c=n?rgt.layerChildTable:rgt.layerTable,h=u?ZK("div",{class:rgt.layerCaption},u):null,d={[rgt.layerTableSizeRamp]:o||!n};return ZK("div",{class:this.classes(c,d)},h,a)}_renderPieChartRamp(t){return ZK("div",{afterCreate:$yt,bind:t.preview})}_renderUnivariateAboveAndBelowRamp(t,e,i){const{sizeRampElement:n,colorRampElement:s}=Pyt(t,e);if(!n)return null;const r=this.messages?.previewColorRampAriaLabel,o=Ryt(n,"above",!0),a=Ryt(n,"below",!0),l=12,u=Lyt(s,{width:l,height:o,rampAlignment:"vertical",opacity:e,type:"above",effectList:i,ariaLabel:r}),c=Lyt(s,{width:l,height:a,rampAlignment:"vertical",opacity:e,type:"below",effectList:i,ariaLabel:r}),h=Oyt(n),d=n.infos.map((t=>t.label)),f=d.map(((t,e)=>{const i=2===e;return 0===e?ZK("div",{class:t?u?rgt.univariateAboveAndBelowLabel:rgt.rampLabel:void 0,key:e},t):i?ZK("div",null):null})),p=d.length-1,m=Math.floor(d.length/2),y=d.map(((t,e)=>e===m||e===p?ZK("div",{class:t?u?rgt.univariateAboveAndBelowLabel:rgt.rampLabel:void 0,key:e},t):null)),g={display:"table-cell",verticalAlign:"middle"},v={marginTop:`${h}px`},w={height:`${o}px`},b={height:`${a}px`};return ZK("div",{key:"univariate-above-and-below-ramp-preview",styles:lgt},ZK("div",{class:rgt.layerBody},n.infos.map(((t,e)=>ZK("div",{class:this.classes(rgt.layerRow,rgt.sizeRamp)},ZK("div",{afterCreate:$yt,bind:t.preview,class:rgt.symbol,styles:g}),u||e%2!=0?null:ZK("div",{class:rgt.layerInfo},d[e]))))),u?ZK("div",{key:"color-ramp-preview",styles:v},ZK("div",{styles:ugt},ZK("div",{styles:cgt},ZK("div",{afterCreate:$yt,bind:u,class:rgt.rampContainer})),ZK("div",{styles:cgt},ZK("div",{class:rgt.rampLabelsContainer,styles:w},f))),ZK("div",{styles:ugt},ZK("div",{styles:cgt},ZK("div",{afterCreate:$yt,bind:c,class:rgt.rampContainer})),ZK("div",{styles:cgt},ZK("div",{class:rgt.rampLabelsContainer,styles:b},y)))):null)}_renderUnivariateColorSizeRamp(t,e,i){const{sizeRampElement:n,colorRampElement:s}=Fyt(t);if(!n)return null;const r=Oyt(n),o=12,a=Ryt(n,"full",!1),l=Lyt(s,{width:o,height:a,rampAlignment:"vertical",opacity:e,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),u=n.infos.length-1,c=n.infos.map(((t,e)=>0===e||e===u?ZK("div",{class:t.label?s?rgt.univariateAboveAndBelowLabel:rgt.rampLabel:void 0,key:e},t.label):null)),h={display:"table-cell",verticalAlign:"middle"},d={marginTop:`${r}px`},f={height:`${a}px`};return ZK("div",{key:"univariate-above-and-below-ramp-preview",styles:lgt},ZK("div",{class:rgt.layerBody},n.infos.map((t=>ZK("div",{class:this.classes(rgt.layerRow,rgt.sizeRamp)},ZK("div",{afterCreate:$yt,bind:t.preview,class:rgt.symbol,styles:h}))))),ZK("div",{key:"color-ramp-preview",styles:d},ZK("div",{styles:ugt},ZK("div",{styles:cgt},ZK("div",{afterCreate:$yt,bind:l,class:rgt.rampContainer})),ZK("div",{styles:cgt},ZK("div",{class:rgt.rampLabelsContainer,styles:f},c)))))}_renderLegendForRamp(t,e){const i=t.infos,n="opacity-ramp"===t.type,s="heatmap-ramp"===t.type,r="stretch-ramp"===t.type,o=t.preview,a=n?rgt.opacityRamp:"";o.className=`${rgt.colorRamp} ${a}`,null!=e&&(o.style.opacity=e.toString());const l=i.map((t=>ZK("div",{class:t.label?rgt.rampLabel:void 0},s?this.messages[t.label]||t.label:r?Gyt(t,this.messages):t.label))),u={width:`${agt}px`},c={height:o.style.height};return ZK("div",{class:rgt.layerRow},ZK("div",{class:rgt.symbolContainer,styles:u},ZK("div",{afterCreate:$yt,bind:o,class:rgt.rampContainer})),ZK("div",{class:rgt.layerInfo},ZK("div",{class:rgt.rampLabelsContainer,styles:c},l)))}_renderLegendForElementInfo(t,e,i,n,s){if(t.type)return this._renderLegendForElement(t,e,i,!0);let r=null;const o=Vyt(e,s);if(t.preview?r=ZK("div",{afterCreate:$yt,bind:t.preview,class:rgt.symbol}):t.src&&(r=this._renderImage(t,e,o)),!r)return null;const a={[rgt.imageryLayerInfoStretched]:o},l={[rgt.imageryLayerInfoStretched]:o,[rgt.sizeRamp]:!o&&n};return ZK("div",{class:rgt.layerRow},ZK("div",{class:this.classes(rgt.symbolContainer,l)},r),ZK("div",{class:this.classes(rgt.layerInfo,a)},zyt(this.messages,t.label,!1)||""))}_renderImage(t,e,i){const{label:n,src:s,opacity:r}=t,o={[rgt.imageryLayerStretchedImage]:i,[rgt.symbol]:!i},a={opacity:`${null!=r?r:e.opacity}`};return ZK("img",{alt:zyt(this.messages,n,!1),"aria-label":zyt(this.messages,n,!1),border:0,class:this.classes(o),height:t.height,src:s,styles:a,width:t.width})}};o([Us()],hgt.prototype,"activeLayerInfos",void 0),o([Us()],hgt.prototype,"headingLevel",void 0),o([Us(),BK("esri/widgets/Legend/t9n/Legend")],hgt.prototype,"messages",void 0),o([Us({readOnly:!0})],hgt.prototype,"type",void 0),hgt=o([Nr("esri.widgets.Legend.styles.Classic")],hgt);const dgt=hgt;const fgt={base:"esri-legend",widgetIcon:wK.layerList};let pgt=class extends CK{constructor(t,e){super(t,e),this.headingLevel=3,this.iconClass=fgt.widgetIcon,this.icon=null,this.messages=null,this.style=new dgt,this.viewModel=new wyt}initialize(){this.addHandles([yy((()=>this.view),"resize",(()=>this.scheduleRender())),yy((()=>this.activeLayerInfos),"change",(()=>this._refreshActiveLayerInfos(this.activeLayerInfos))),fy((()=>this.headingLevel),(t=>{const{style:e}=this;e&&(e.headingLevel=t)})),fy((()=>this.style),((t,e)=>{e&&t!==e&&e.destroy(),t&&(t.activeLayerInfos=this.activeLayerInfos,"card"===t.type&&(t.view=this.view),t.headingLevel=this.headingLevel)}),_y)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(t){this.viewModel.activeLayerInfos=t}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(t){this.viewModel.basemapLegendVisible=t}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(t){this.viewModel.groundLegendVisible=t}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(t){this.viewModel.hideLayersNotInCurrentView=t}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(t){this.viewModel.keepCacheOnDestroy=t}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(t){this.viewModel.respectLayerVisibility=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(t){this.viewModel.layerInfos=t}castStyle(t){if(t instanceof ngt||t instanceof dgt)return t;if("string"==typeof t)return"card"===t?new ngt:new dgt;if(t&&"string"==typeof t.type){const e={...t};delete e.type;return new("card"===t.type?ngt:dgt)(e)}return new dgt}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){return ZK("div",{class:this.classes(fgt.base,zK.widget,this.style instanceof dgt?zK.panel:null)},this.style.render())}_refreshActiveLayerInfos(t){t.forEach((t=>{this.removeHandles(`version_${t.layer.uid}`),this._renderOnActiveLayerInfoChange(t)})),this.scheduleRender()}_renderOnActiveLayerInfoChange(t){const e=fy((()=>t.version),(()=>this.scheduleRender()));this.addHandles(e,`version_${t.layer.uid}`);const i=yy((()=>t.children),"change",(()=>t.children.forEach((t=>this._renderOnActiveLayerInfoChange(t)))),_y);this.addHandles(i,`version_${t.layer.uid}`),t.children.forEach((t=>this._renderOnActiveLayerInfoChange(t)))}};o([Us()],pgt.prototype,"activeLayerInfos",null),o([Us()],pgt.prototype,"basemapLegendVisible",null),o([Us()],pgt.prototype,"groundLegendVisible",null),o([Us()],pgt.prototype,"headingLevel",void 0),o([Us()],pgt.prototype,"hideLayersNotInCurrentView",null),o([Us()],pgt.prototype,"keepCacheOnDestroy",null),o([Us()],pgt.prototype,"respectLayerVisibility",null),o([Us()],pgt.prototype,"iconClass",void 0),o([Us()],pgt.prototype,"icon",void 0),o([Us()],pgt.prototype,"label",null),o([Us()],pgt.prototype,"layerInfos",null),o([Us(),BK("esri/widgets/Legend/t9n/Legend")],pgt.prototype,"messages",void 0),o([Us()],pgt.prototype,"style",void 0),o([ol("style")],pgt.prototype,"castStyle",null),o([Us()],pgt.prototype,"view",null),o([Us()],pgt.prototype,"viewModel",void 0),pgt=o([Nr("esri.widgets.Legend")],pgt);const mgt=pgt;const ygt=Object.freeze({__proto__:null,default:mgt});var ggt;let vgt=ggt=class extends Vr{constructor(t){super(t),this.autoCloseMenu=!1,this.iconClass=null,this.items=null,this.label=null,this.open=!1,this.selected=!1,this.selectionEnabled=!1,this.clickFunction=null}castItems(t){return t?t.map((t=>t instanceof ggt?t:new ggt(t))):null}};o([Us()],vgt.prototype,"autoCloseMenu",void 0),o([Us()],vgt.prototype,"iconClass",void 0),o([Us()],vgt.prototype,"items",void 0),o([ol("items")],vgt.prototype,"castItems",null),o([Us()],vgt.prototype,"label",void 0),o([Us()],vgt.prototype,"open",void 0),o([Us()],vgt.prototype,"selected",void 0),o([Us()],vgt.prototype,"selectionEnabled",void 0),o([Us()],vgt.prototype,"clickFunction",void 0),vgt=ggt=o([Nr("esri.widgets.FeatureTable.Grid.support.ButtonMenuItem")],vgt);const wgt=vgt;let bgt=class extends Vr{constructor(t){super(t),this.items=null,this.open=!1}castItems(t){return t?t.map((t=>t instanceof wgt?t:new wgt(t))):null}};o([Us()],bgt.prototype,"items",void 0),o([ol("items")],bgt.prototype,"castItems",null),o([Us()],bgt.prototype,"open",void 0),bgt=o([Nr("esri.widgets.FeatureTable.Grid.support.ButtonMenuViewModel")],bgt);const Sgt=bgt;const xgt="esri-button-menu",_gt={base:xgt,content:`${xgt}__content`,itemWrapper:`${xgt}__item-wrapper`,label:`${xgt}__label`,icon:`${xgt}__icon`,item:`${xgt}__item`,itemLabel:`${xgt}__item-label`,itemLabelContent:`${xgt}__item-label-content`,selectableMenuItem:`${xgt}__item--selectable`,selectedMenuItem:`${xgt}__item--selected`,checkbox:`${xgt}__checkbox`,embeddedContentWrapper:`${xgt}__embedded-content-wrapper`,button:`${xgt}__button`,buttonSelected:`${xgt}__button--selected`};let Mgt=class extends CK{constructor(t,e){super(t,e),this._popover=null,this.disabled=!1,this.iconClass="",this.viewModel=new Sgt}loadDependencies(){return lK({button:()=>import("./p-9ffe80e7.js"),popover:()=>import("./p-19efd6d7.js")})}destroy(){this._popover=null}get items(){return this.viewModel.items}set items(t){this.viewModel.items=t}get open(){return this.viewModel.open}set open(t){this.viewModel.open=t}render(){const{open:t}=this,e=`${this.id}-button`;return ZK("div",{class:this.classes(_gt.base,zK.widget),key:"menu"},ZK("calcite-button",{appearance:"transparent",bind:this,class:this.classes(_gt.button,t&&_gt.buttonSelected),disabled:this.disabled,iconStart:t?"x":"ellipsis",id:e,kind:"neutral",label:this.label||"button",onclick:()=>this._toggleOpen(t),tabIndex:0}),ZK("calcite-popover",{afterCreate:Hx,afterUpdate:()=>this._popover?.reposition(),autoClose:!0,bind:this,"data-node-ref":"_popover",label:this.label||"menu",open:t,overlayPositioning:"fixed",pointerDisabled:!0,referenceElement:e,onCalcitePopoverClose:this._onPopoverClose},this._renderMenuContent()))}_onPopoverClose(){this.open=!1}_renderMenuContent(){const{id:t,open:e}=this;return ZK("div",{afterCreate:this._afterMenuContentNodeCreate,bind:this,class:_gt.content,hidden:!e,key:"esri-button-menu-content"},ZK("ul",{"aria-labelledby":`${t}-button`,bind:this,class:_gt.itemWrapper,id:`${t}-menu`,role:"menu"},this.items?.length?this._renderItems():null))}_renderItems(){return this.items?.map(((t,e)=>this._renderItem(t,e)))}_renderItem(t,e,i){const n=null!=i?`${this.id}-menu-item-${e}-${i}`:`${this.id}-menu-item-${e}`,s=`${n}-label`,r=this.classes(_gt.item,t.selectionEnabled?_gt.selectableMenuItem:null,t.selectionEnabled&&t.selected?_gt.selectedMenuItem:null);return ZK("li",{afterCreate:this._afterMenuItemCreate,bind:this,class:r,"data-item-index":e,"data-item-subIndex":i,for:n,key:n,onclick:e=>this._handleMenuItemInteraction(e,t),onkeydown:e=>this._handleMenuItemKeydown(e,t),role:"menuitem",tabIndex:this.disabled?-1:0},ZK("input",{checked:t.selected,class:_gt.checkbox,disabled:!0,id:n,name:n,tabIndex:-1,type:"checkbox"}),ZK("label",{class:_gt.itemLabel,for:n,id:s},ZK("span",{"aria-hidden":"true",class:this.classes(_gt.icon,t.iconClass)}),ZK("span",{class:_gt.itemLabelContent},Kx.sanitize(t.label))),ZK("ul",{"aria-labelledby":s,class:_gt.embeddedContentWrapper,id:`${this.id}-submenu`,role:"menu"},t?.items?.map(((t,i)=>this._renderItem(t,e,i)))))}_handleMenuItemInteraction(t,e){e.selected=!e.selected,e.open=!(!e.selected||!e.items),e.autoCloseMenu&&this.set("open",!1),e.clickFunction&&e.clickFunction({event:t,item:e}),t.stopPropagation()}_handleMenuItemKeydown(t,e){const{key:i}=t;Qx(i)&&this._handleMenuItemInteraction(t,e),"Escape"===i&&(this.open=!1,t.preventDefault(),t.stopPropagation())}_afterMenuContentNodeCreate(t){t.focus()}_toggleOpen(t){this.open=!t}_afterMenuItemCreate(t){0===t["data-item-index"]&&t.focus()}};o([Us()],Mgt.prototype,"disabled",void 0),o([Us()],Mgt.prototype,"iconClass",void 0),o([Us()],Mgt.prototype,"items",null),o([Us()],Mgt.prototype,"open",null),o([Us()],Mgt.prototype,"viewModel",void 0),Mgt=o([Nr("esri.widgets.FeatureTable.Grid.support.ButtonMenu")],Mgt);const kgt=Mgt;const Tgt="esri-column",Agt={menuContainer:`${Tgt}__menu-container`,sorter:`${Tgt}__sorter`,headerContent:`${Tgt}__header-content`,headerLabel:`${Tgt}__header-label`},Igt={keyboardSort1:"Enter",keyboardSort2:"Spacebar"};let jgt=class extends Pm.EventedAccessor{constructor(t){super(t),this._menuContainer=document.createElement("div"),this.activeRowIndex=null,this.autoWidth=!1,this.cellValueFormatFunction=({value:t})=>Kx.sanitize(t),this.direction=null,this.flexGrow=1,this.footerRenderFunction=null,this.frozen=!1,this.frozenToEnd=!1,this.grid=null,this.header=null,this.headerRenderFunction=t=>{const{root:e}=t;if(this.removeCellContent(e),e.classList.add(Agt.headerContent),this.sortable)this.headerSorterRenderFunction(t);else{const t=document.createElement("div");t.classList.add(Agt.headerLabel);const i=document.createElement("span");i.textContent=this.label,i.setAttribute("title",this.label),t.appendChild(i),e.appendChild(t)}this.headerMenuEnabled&&this.headerMenuRenderFunction(t)},this.headerMenuRenderFunction=({root:t})=>{this.menu?.items?.length&&t.appendChild(this._menuContainer)},this.headerSorterRenderFunction=({root:t})=>{const{label:e,sortElement:i}=this;if(!i)return void(t.textContent=e);i.textContent!==e&&i.setAttribute("textContent",e),t.appendChild(i);const n=this.grid?.getSlotElementByName(t.slot),s=n?.parentElement;s&&!s.onkeydown&&(s.onkeydown=({key:t})=>{t!==Igt.keyboardSort1&&t!==Igt.keyboardSort2||i.click()})},this.hidden=!1,this.headerMenuEnabled=!0,this.initialSortPriority=null,this.menu=null,this.menuConfig=null,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.path=null,this.renderFunction=({root:t,column:e,rowData:i})=>{const n=this.getCellValue(e,i),s=this.cellValueFormatFunction({column:e,rowData:i,value:n});t.innerHTML!==s&&(t.innerHTML=s)},this.resizable=!0,this.sortable=!1,this.textAlign="start",this.timeZone=null,this.timeZoneName=null,this.width=200}initialize(){const{messages:t,path:e}=this;this._set("sortElement",this.createSortElement()),this.sortElement.setAttribute("path",e??""),this._menuContainer.classList.add(Agt.menuContainer),this.menu=new kgt({container:this._menuContainer,label:t?.options,iconClass:wK.handleHorizontal,...this.menuConfig}),this.menu.set("items",this.getMenuItems()),this.addHandles([fy((()=>this.direction),(t=>{const{sortElement:e}=this;this.sortable&&e&&(t?this.sortElement.direction!==t&&e.setAttribute("direction",t):e.removeAttribute("direction"))})),fy((()=>this.hidden),(()=>this.menu?.set("open",!1))),fy((()=>this.path),(t=>{const{sortElement:e}=this,i=t??"";e&&e.path!==i&&e.setAttribute("path",i)}))])}destroy(){this.menu?.destroy()}set invalid(t){this._set("invalid",t),this.grid?.generateCellPartNames()}get label(){return Kx.sanitize(this.header??this.path??"")}getMenuItems(){const{menuConfig:t,sortable:e}=this,i=t?.items,n=this.getSortMenuItems(),s=[];return e&&s.push(...n),i?.length&&s.push(...i),s.length?s:null}getSortMenuItems(){const{messages:t}=this;return[{selected:"asc"===this.direction,iconClass:wK.arrowUp,label:t?.sortAsc,autoCloseMenu:!0,clickFunction:()=>this.set("direction","asc"!==this.direction?"asc":null)},{selected:"desc"===this.direction,iconClass:wK.arrowDown,label:t?.sortDesc,autoCloseMenu:!0,clickFunction:()=>this.set("direction","desc"!==this.direction?"desc":null)}]}getCellValue(t,e){return t.path&&e?.item?e.item[t.path]:""}createSortElement(){const{direction:t,label:e,path:i,initialSortPriority:n}=this,s=document.createElement("vaadin-grid-sorter");return s.classList.add(Agt.sorter),s.setAttribute("path",i??""),s.setAttribute("title",e),s.textContent=e,t&&s.setAttribute("direction",t),null!=n&&(s._initialOrder=n),s.addEventListener("direction-changed",(()=>{this.direction!==s.direction&&this._set("direction",s.direction)})),s}createCalciteAction(t){const e=document.createElement("calcite-action"),{click:i,icon:n,text:s}=t;return e.scale="s",e.text=s,e.title=s,e.icon=n,e.onclick=i,e}removeCellContent(t){if(t&&t.firstChild)try{for(;t?.firstChild;)t?.removeChild(t.firstChild)}catch(t){}}};o([Us()],jgt.prototype,"activeRowIndex",void 0),o([Us()],jgt.prototype,"autoWidth",void 0),o([Us()],jgt.prototype,"cellValueFormatFunction",void 0),o([Us()],jgt.prototype,"direction",void 0),o([Us()],jgt.prototype,"flexGrow",void 0),o([Us()],jgt.prototype,"footerRenderFunction",void 0),o([Us()],jgt.prototype,"frozen",void 0),o([Us()],jgt.prototype,"frozenToEnd",void 0),o([Us()],jgt.prototype,"grid",void 0),o([Us()],jgt.prototype,"header",void 0),o([Us()],jgt.prototype,"invalid",null),o([Us()],jgt.prototype,"headerRenderFunction",void 0),o([Us()],jgt.prototype,"headerMenuRenderFunction",void 0),o([Us()],jgt.prototype,"headerSorterRenderFunction",void 0),o([Us()],jgt.prototype,"hidden",void 0),o([Us()],jgt.prototype,"headerMenuEnabled",void 0),o([Us({constructOnly:!0})],jgt.prototype,"initialSortPriority",void 0),o([Us({readOnly:!0})],jgt.prototype,"label",null),o([Us()],jgt.prototype,"menu",void 0),o([Us()],jgt.prototype,"menuConfig",void 0),o([Us()],jgt.prototype,"messages",void 0),o([Us()],jgt.prototype,"messagesCommon",void 0),o([Us()],jgt.prototype,"messagesURIUtils",void 0),o([Us()],jgt.prototype,"path",void 0),o([Us()],jgt.prototype,"renderFunction",void 0),o([Us()],jgt.prototype,"resizable",void 0),o([Us()],jgt.prototype,"sortable",void 0),o([Us({readOnly:!0})],jgt.prototype,"sortElement",void 0),o([Us()],jgt.prototype,"textAlign",void 0),o([Us()],jgt.prototype,"timeZone",void 0),o([Us()],jgt.prototype,"timeZoneName",void 0),o([Us()],jgt.prototype,"width",void 0),jgt=o([Nr("esri.widgets.FeatureTable.Grid.Column")],jgt);const Cgt=jgt;const Egt={attachmentsColumn:"esri-feature-table__column--attachments"};let Ogt=class extends Cgt{constructor(t){super(t),this.header="",this.path="EsriFeatureTableAttachmentsColumn",this.renderFunction=({root:t,rowData:e})=>{const i=this._countFromItem(e?.item).toString();t.innerHTML=`<div class="${Egt.attachmentsColumn}">${i}</div>`},this.sortable=!1,this.textAlign="center"}_countFromItem(t){return t?.attachments?.length||0}};o([Us({constructOnly:!0})],Ogt.prototype,"header",void 0),o([Us({readOnly:!0})],Ogt.prototype,"path",void 0),o([Us()],Ogt.prototype,"renderFunction",void 0),o([Us({readOnly:!0})],Ogt.prototype,"sortable",void 0),o([Us({readOnly:!0})],Ogt.prototype,"textAlign",void 0),Ogt=o([Nr("esri.widgets.FeatureTable.AttachmentsColumn")],Ogt);const Lgt=Ogt;const Ngt="esri.widgets.Feature.support.featureUtils",Rgt=()=>Ft.getLogger(Ngt),Pgt=/href=(""|'')/gi,Fgt=/(\{([^\{\r\n]+)\})/g,Dgt=/\'/g,$gt=/^\s*expression\//i,zgt=/(\n)/gi,Ugt=/[\u00A0-\u9999<>\&]/gim,Vgt=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,Ggt=/^(?:mailto:|tel:)/,Bgt="relationships/",qgt=qg("short-date-short-time");function Hgt(t){if(null!=t)return(t.sourceLayer||t.layer)??void 0}async function Wgt(t,e){return"function"==typeof t?t(e):t}function Zgt(t=""){if(t)return!Ggt.test(t.trim().toLowerCase())}function Jgt(t){return!!t&&$gt.test(t)}function Kgt(t,e){if(!Jgt(e)||!t)return;const i=e.replace($gt,"").toLowerCase();return t.find((({name:t})=>t.toLowerCase()===i))}function Ygt(t,e){const i=Kgt(e,t?.fieldName);return i?i.title||null:t?t.label||t.fieldName:null}function Qgt(t,e){const i=e.get(t.toLowerCase());return`{${i?.fieldName||t}}`}function Xgt(t){return t.replaceAll(Pgt,"")}function tvt(t,e){const i=ivt(e,t);return i?i.name:t}function evt(t,e){return t&&t.map((t=>tvt(t,e)))}function ivt(t,e){return t&&"function"==typeof t.getField&&e?t.getField(e)??null:null}function nvt(t){return`${t}`.trim()}function svt({attributes:t,globalAttributes:e,layer:i,text:n,expressionAttributes:s,fieldInfoMap:r}){return n?rvt({formattedAttributes:e,template:cvt(n,{...e,...s,...t},i),fieldInfoMap:r}):""}function rvt({formattedAttributes:t,template:e,fieldInfoMap:i}){return nvt(Xgt(Et(Et(e,(t=>Qgt(t,i))),t)))}function ovt(t,e,i=!1){const n=e[t];if("string"==typeof n){const s="%27",r=(i?encodeURIComponent(n):n).replaceAll(Dgt,s);e[t]=r}}function avt(t,e=!1){const i={...t};return Object.keys(i).forEach((t=>ovt(t,i,e))),i}function lvt(t,e,i){const n=(e=nvt(e))&&"{"!==e[0];return Et(t,avt(i,n||!1))}function uvt(t,e){return t.replaceAll(Fgt,((t,i,n)=>{const s=ivt(e,n);return s?`{${s.name}}`:i}))}function cvt(t,e,i){const n=uvt(t,i);return n?n.replaceAll(Vgt,((t,i,n)=>lvt(t,i||n,e))):n}function hvt(t,e){if("string"==typeof t&&e&&null==e.dateFormat&&(null!=e.places||null!=e.digitSeparator)){const e=Number(t);if(!isNaN(e))return e}return t}function dvt(t){return null!=t&&"object"==typeof t&&"fieldsIndex"in t&&"geometryType"in t&&"getField"in t&&"load"in t&&"loaded"in t&&"objectIdField"in t&&"spatialReference"in t&&"type"in t&&("feature"===t.type||"scene"===t.type)&&"when"in t}function fvt(t){return null!=t&&"object"==typeof t&&"createQuery"in t&&"queryFeatureCount"in t&&"queryObjectIds"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t&&"relationships"in t}function pvt(t){return dvt(t)&&fvt(t)}function mvt(t,e){const{fieldInfos:i,fieldName:n,preventPlacesFormatting:s,layer:r,timeZone:o}=e,a=vvt(i,n),l=ivt(r,n);if(a&&!LE(n)){const e=l?.type,i=a.format?.dateFormat;if("date"===e||"date-only"===e||"time-only"===e||"timestamp-offset"===e||i)return jpt(t,{format:i,fieldType:e,timeZoneOptions:{layerTimeZone:r&&"preferredTimeZone"in r?r.preferredTimeZone:null,viewTimeZone:o,datesInUnknownTimezone:!(!r||!("datesInUnknownTimezone"in r))&&!!r.datesInUnknownTimezone}})}const u=a?.format;return"string"==typeof t&&LE(n)&&u?yvt(t,u):"string"==typeof(t=hvt(t,u))||null==t||null==u?kvt(t):iv(t,s?{...ev(u),minimumFractionDigits:0,maximumFractionDigits:20}:ev(u))}function yvt(t,e){return t=t.trim(),/\d{2}-\d{2}/.test(t)?t:t.includes(",")?gvt(t,",",", ",e):t.includes(";")?gvt(t,";","; ",e):t.includes(" ")?gvt(t," "," ",e):iv(Number(t),ev(e))}function gvt(t,e,i,n){return t.trim().split(e).map((t=>iv(Number(t),ev(n)))).join(i)}function vvt(t,e){if(t?.length&&e)return t.find((t=>t.fieldName?.toLowerCase()===e.toLowerCase()))}function wvt({fieldName:t,graphic:e,layer:i}){if(Evt(t))return null;if(!i||"function"!=typeof i.getFeatureType)return null;const{typeIdField:n}=i;if(!n||t!==n)return null;const s=i.getFeatureType(e);return s?s.name:null}function bvt({fieldName:t,value:e,graphic:i,layer:n}){if(Evt(t))return null;if(!n||"function"!=typeof n.getFieldDomain)return null;const s=i&&n.getFieldDomain(t,{feature:i});return s&&"coded-value"===s.type?s.getName(e):null}function Svt(t,e,i,n){const{creatorField:s,creationDateField:r,editorField:o,editDateField:a}=t;if(!e)return;const l=Tg(n&&"preferredTimeZone"in n?n.preferredTimeZone:null,!(!n||!("datesInUnknownTimezone"in n))&&!!n.datesInUnknownTimezone,i,qgt,"date"),u={...qgt,...l},c=e[a];if("number"==typeof c){const t=e[o];return{type:"edit",date:Hg(c,u),user:t}}const h=e[r];if("number"==typeof h){const t=e[s];return{type:"create",date:Hg(h,u),user:t}}return null}function xvt(t,e){const i=new Map;return t?(t.forEach((t=>{const n=tvt(t.fieldName,e);t.fieldName=n,i.set(n.toLowerCase(),t)})),i):i}function _vt(t){const e=[];if(!t)return e;const{fieldInfos:i,content:n}=t;return i&&e.push(...i),n&&Array.isArray(n)?(n.forEach((t=>{if("fields"===t.type){const i=t?.fieldInfos;i&&e.push(...i)}})),e):e}function Mvt(t){return t.replaceAll(Ugt,(t=>`&#${t.charCodeAt(0)};`))}function kvt(t){return"string"==typeof t?t.replaceAll(zgt,'<br class="esri-text-new-line" />'):t}function Tvt(t){const{value:e,fieldName:i,fieldInfos:n,fieldInfoMap:s,layer:r,graphic:o,timeZone:a}=t;if(null==e)return"";const l=bvt({fieldName:i,value:e,graphic:o,layer:r});if(l)return l;const u=wvt({fieldName:i,graphic:o,layer:r});if(u)return u;if(s.get(i.toLowerCase()))return mvt(e,{fieldInfos:n||Array.from(s.values()),fieldName:i,layer:r,timeZone:a});const c=r?.fieldsIndex?.get(i);return c&&(Ipt(c)||pE(c))?jpt(e,{fieldType:c.type,timeZoneOptions:{layerTimeZone:r&&"preferredTimeZone"in r?r.preferredTimeZone:null,viewTimeZone:a,datesInUnknownTimezone:!(!r||!("datesInUnknownTimezone"in r))&&!!r.datesInUnknownTimezone}}):kvt(e)}function Avt({fieldInfos:t,attributes:e,layer:i,graphic:n,fieldInfoMap:s,relatedInfos:r,timeZone:o}){const a={};return r?.forEach((e=>Nvt({attributes:a,relatedInfo:e,fieldInfoMap:s,fieldInfos:t,layer:i,timeZone:o}))),e&&Object.keys(e).forEach((r=>{const l=e[r];a[r]=Tvt({fieldName:r,fieldInfos:t,fieldInfoMap:s,layer:i,value:l,graphic:n,timeZone:o})})),a}async function Ivt(t,e){const{layer:i,graphic:n,outFields:s,objectIds:r,returnGeometry:o,spatialReference:a}=t,l=r[0];if("number"!=typeof l&&"string"!=typeof l){const t="Could not query required fields for the specified feature. The feature's ID is invalid.",e={layer:i,graphic:n,objectId:l,requiredFields:s};return Rgt().warn(t,e),null}if(!Gk(i)?.operations?.supportsQuery){const t="The specified layer cannot be queried. The following fields will not be available.",e={layer:i,graphic:n,requiredFields:s,returnGeometry:o};return Rgt().warn(t,e),null}const u=i.createQuery();u.objectIds=r,u.outFields=s?.length?s:[i.objectIdField],u.returnGeometry=!!o,u.returnZ=!!o,u.returnM=!!o,u.outSpatialReference=a;return(await i.queryFeatures(u,e)).features[0]}async function jvt(t){if(!t.expressionInfos?.length)return!1;const e=await rC(),{arcadeUtils:{hasGeometryFunctions:i}}=e;return i(t)}async function Cvt({graphic:t,popupTemplate:e,layer:i,spatialReference:n},s){if(!i||!e)return;if("function"==typeof i.load&&await i.load(s),!t.attributes)return;const r=t.attributes[i.objectIdField];if(null==r)return;const o=[r],a=await e.getRequiredFields(i.fieldsIndex),l=EE(a,t),u=l?[]:a,c=e.returnGeometry||await jvt(e);if(l&&!c)return;const h=await Ivt({layer:i,graphic:t,outFields:u,objectIds:o,returnGeometry:c,spatialReference:n},s);h&&(h.geometry&&(t.geometry=h.geometry),h.attributes&&(t.attributes={...t.attributes,...h.attributes}))}function Evt(t=""){return!!t&&t.includes(Bgt)}function Ovt(t){return t?`${Bgt}${t.layerId}/${t.fieldName}`:""}function Lvt({attributes:t,graphic:e,relatedInfo:i,fieldInfos:n,fieldInfoMap:s,layer:r,timeZone:o}){t&&e&&i&&Object.keys(e.attributes).forEach((a=>{const l=Ovt({layerId:i.relation.id.toString(),fieldName:a}),u=e.attributes[a];t[l]=Tvt({fieldName:l,fieldInfos:n,fieldInfoMap:s,layer:r,value:u,graphic:e,timeZone:o})}))}function Nvt({attributes:t,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:s,timeZone:r}){t&&e&&(e.relatedFeatures?.forEach((o=>Lvt({attributes:t,graphic:o,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:s,timeZone:r}))),e.relatedStatsFeatures?.forEach((o=>Lvt({attributes:t,graphic:o,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:s,timeZone:r}))))}const Rvt=t=>{if(!t)return!1;const e=t.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},Pvt=({layer:t,method:e,query:i,definitionExpression:n})=>{if(!t.capabilities?.query?.supportsCacheHint||"attachments"===e)return;const s=null!=i.where?i.where:null,r=null!=i.geometry?i.geometry:null;Rvt(n)||Rvt(s)||"extent"===r?.type||"tile"===i.resultType||(i.cacheHint=!0)},Fvt=({query:t,layer:e,method:i})=>{Pvt({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},Dvt=({queryPayload:t,layer:e,method:i})=>{Pvt({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function $vt(t,e,i){return t&&e&&i?zvt(t.allLayers,e,i)||zvt(t.allTables,e,i):null}function zvt(t,e,{relatedTableId:i}){const n="scene"===e.type&&e.associatedLayer?e.associatedLayer.url:e.url;return t.filter(pvt).find((t=>t!==e&&t.url===n&&t.layerId===i))}const Uvt=t=>null!=t&&(Vvt(t,"combo-box")||Vvt(t,"radio-buttons")),Vvt=(t,e)=>null!=t&&t.input?.type===e,Gvt=t=>null!=t&&(Vvt(t,"text-box")||Vvt(t,"text-area")),Bvt={typeFieldName:null,types:[]};function qvt(t){const{attributes:e,fieldsIndex:i,label:n,timeZone:s}=t;if(!e||"object"!=typeof e)return n;const r=Object.keys(e).filter((t=>Rt(n,t))),o=r.map((t=>e[t])),a=r.map((t=>i.get(t))).filter(F);return Wvt(n,Hvt({values:o,fields:a,timeZone:s}))}function Hvt(t){const{fields:e,values:i}=t,n=t.timeZone??void 0,s=e.map(((t,e)=>{let s=i[e];if(t.domain&&"coded-value"===t.domain.type){const e=t.domain.codedValues.find((t=>t.code===s));e?.name&&(s=e.name)}return(Ipt(t)||pE(t))&&(s=Rj(t,s,{timeZone:n,...Nj(t)})),[t.name,s]}));return Object.fromEntries(s)}function Wvt(t,e){return Et(Et(t,(t=>`{${t.toLowerCase()}}`)),Object.fromEntries(Object.entries(e).map((([t,e])=>[t.toLowerCase(),e]))))}const Zvt=t=>t?"subtype-sublayer"===t.type?{typeFieldName:t.parent?.subtypeField,types:t.parent?.subtypes??[]}:"types"in t&&t.types?{typeFieldName:t.typeIdField,types:t.types.map((({id:t,name:e,domains:i})=>({code:t,name:e,domains:i})))}:Bvt:Bvt,Jvt=(t,e)=>{if(!t)return!0;const{operations:i}=t;switch(e){case"INSERT":return i.supportsAdd;case"UPDATE":case"DELETE":return i.supportsUpdate;default:return!0}};var Kvt;!function(t){t.TOO_SHORT="length-validation-error::too-short"}(Kvt||(Kvt={}));const Yvt=t=>{const e=[];if(t.formTemplate){const{description:i,title:n}=t.formTemplate;t.fields?.forEach((t=>{const s=n&&Rt(n,t.name),r=i&&Rt(i,t.name);(s||r)&&e.push(t.name)}))}return e};function Qvt(t,e){return null==t||e.onValue!==t&&e.offValue!==t}let Xvt=class extends Vr{constructor(t){super(t),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){return this.element?.description}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get label(){return this.element?.label}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}};o([Us({readOnly:!0})],Xvt.prototype,"description",null),o([Us({constructOnly:!0})],Xvt.prototype,"element",void 0),o([Us()],Xvt.prototype,"evaluatedVisibilityExpression",null),o([Us()],Xvt.prototype,"feature",void 0),o([Us()],Xvt.prototype,"label",null),o([Us()],Xvt.prototype,"layer",void 0),o([Us()],Xvt.prototype,"timeZone",void 0),o([Us()],Xvt.prototype,"type",void 0),o([Us()],Xvt.prototype,"visible",null),o([Us()],Xvt.prototype,"visibilityExpressionExecutor",void 0),Xvt=o([Nr("esri.widgets.FeatureForm.InputBase")],Xvt);const twt=Xvt;let ewt=class extends twt{constructor(t){super(t),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:t}=this;if(!t)return!1;const e=Gk(t),i=e?.operations.supportsEditing,n=Jvt(e,this.arcadeEditType);return!(!i||!n)}};o([Us()],ewt.prototype,"arcadeEditType",void 0),o([Us()],ewt.prototype,"editable",null),o([Us()],ewt.prototype,"editableExpressionExecutor",void 0),o([Us()],ewt.prototype,"evaluatedEditableExpression",null),o([Us()],ewt.prototype,"layerAllowsEdits",null),ewt=o([Nr("esri.widgets.FeatureForm.EditableInput")],ewt);const iwt=ewt;var nwt;!function(t){t.Text="text",t.Number="number",t.Date="date",t.Unsupported="unsupported"}(nwt||(nwt={}));const swt="__internal-type-based-coded-value-domain__";let rwt=class extends iwt{constructor(t){super(t),this._storedValue=null,this.error=null,this.preservesValueWhenHidden=!0,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this._fieldInputWasVisibleDuringLifetime=!1,this.valueExpressionExecutor=null}initialize(){this.addHandles(fy((()=>this.feature),(()=>this._fieldInputWasVisibleDuringLifetime=!1),xy))}get _dateFormRange(){const{element:t,field:e}=this;if("date"!==this.dataType)return{};const i=t?.domain?eC(e,t.domain):null;if(!t?.input)return i??{};const n=t.input,{type:s}=n;let r={};if("date-picker"!==s&&"time-picker"!==s&&"datetimeoffset-picker"!==s||(r=iC(e,n.max,n.min)),"datetime-picker"===s){const{max:t,min:e}=n;r={max:null!=t&&owt(t)?t.getTime():null,min:null!=e&&owt(e)?e.getTime():null}}const{max:o,min:a}=r;if(i){const{max:t,min:e}=i,n=vj(t)&&(null==o||null!=o&&t<o),s=vj(e)&&(null==a||null!=a&&e>a);return{max:n?t:o??null,min:s?e:a??null,rawMax:n?i.rawMax:r?.rawMax??null,rawMin:s?i.rawMin:r?.rawMin??null}}return{min:a,max:o,rawMax:r?.rawMax??null,rawMin:r?.rawMin??null}}get _dateRange(){const{_dateFormRange:t,field:e}=this;if("date"!==this.dataType)return{};const i=eC(e);if(!i)return t;const{max:n,min:s,rawMax:r,rawMin:o}=t;if("date"===e.type){const{max:t,min:e}=i;return{max:vj(n)&&(null===t||null!=t&&n<t)?n:t??null,min:vj(s)&&(null===e||null!=e&&s>e)?s:e??null}}if("date-only"===e.type||"time-only"===e.type||"timestamp-offset"===e.type){const{max:t,min:e,rawMax:a,rawMin:l}=i,u=vj(n)&&r&&(null==t||n<t);return{max:u?n:t,min:vj(s)&&o&&(null==e||s>e)?s:e,rawMax:u?r:a,rawMin:u?o:l}}return{max:null,min:null}}get _configAllowsEdits(){const{element:t,layer:e,name:i}=this;if(null!=t)return t.editableExpression?!!this.evaluatedEditableExpression:!1!==t.editable;if(e?.userHasUpdateItemPrivileges)return!0;const n=e&&"popupTemplate"in e?e?.popupTemplate?.fieldInfos?.find((({fieldName:t})=>t===i)):null;return n?.isEditable??!0}get _layerAndFieldAllowEdits(){return this.layerAllowsEdits&&this.field?.editable}get _isVisibleByDefault(){const{field:t,layer:e}=this;return!!t?.visible&&BC(t,e)}get _isEditTrackingField(){return VC(this.layer).includes(this.name?.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&null!=this.valueExpressionExecutor}get _isSubtypeField(){const{layer:t}=this;if(t&&"subtypeField"in t){const{subtypeField:e,fieldsIndex:i}=t;return(i.get(e)?.name??e)===this.name}return!1}get test(){return{_isSubtypeField:this._isSubtypeField}}get dataType(){const{field:t}=this;return uE(t)?nwt.Number:cE(t)?nwt.Text:Ipt(t)||pE(t)?nwt.Date:nwt.Unsupported}get dateDataType(){if(this.dataType===nwt.Date)return"date"!==this.field.type?"string":"number"}get description(){const{element:t,feature:e,layer:i,timeZone:n}=this,s=t?.description;return null!=i&&null!=s?qvt({label:s,attributes:e.attributes,fieldsIndex:i.fieldsIndex,timeZone:n}):s}get domain(){const{layer:t}=this,{typeFieldName:e,types:i}=Zvt(t);if(this._isSubtypeField&&"subtypes"in t&&t.subtypes)return new QF({name:swt,codedValues:t.subtypes.map((({code:t,name:e})=>new HF({code:t,name:e})))});if(e===this.name&&null==this.field.domain)return new QF({name:swt,codedValues:i.map((({code:t,name:e})=>new HF({code:t,name:e})))});const{feature:n}=this,s=t?.getFieldDomain(this.name,{feature:n}),r=this.element?.domain;return null!=r&&this._isDomainCompatible(r)?r:s}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:t}=this;return null!=t?t.lastEvaluatedValue:null}get hint(){return this.element?.hint}get includeDate(){return!(this.dataType!==nwt.Date||"time-only"===this.field.type)}get includeTime(){const{element:t,field:e}=this;if(this.dataType!==nwt.Date)return!1;if("time-only"===e.type)return!0;if("date-only"===e.type)return!1;const i="datetime-picker"===t?.input?.type?t.input.includeTime:void 0;return void 0===i||i}get includeTimeOffset(){if("timestamp-offset"!==this.field.type)return!1;const t=this.element?.input;return!t||"datetimeoffset-picker"===t.type&&t.includeTimeOffset}set initialFeature(t){this._set("initialFeature",t),this.notifyChange("valid")}get inputType(){return this.element?.input?.type}get hasInvalidSwitchValue(){const{element:t}=this,e=Vvt(t,"switch")?t.input:null;return!e||Qvt(this.value,e)}get isRelationshipKeyField(){const{field:t,layer:e}=this;return pvt(e)&&!!e.relationships?.some((e=>e.keyField===t.name))}get label(){const{element:t,feature:e,field:i,layer:n,timeZone:s}=this;return null!=n&&null!=t?.label?qvt({label:t.label,attributes:e.attributes,fieldsIndex:n.fieldsIndex,timeZone:s}):t?.label||i.alias||i.name}get maxLength(){const t=-1;if(this.dataType===nwt.Date)return t;const{field:e,element:i}=this,n=e?.length??-1,s=Gvt(i)?i.input.maxLength:NaN;return null!=s&&!isNaN(s)&&s>=t&&(n===t||s<=n)?s:n}get minLength(){const t=-1;if(this.dataType===nwt.Date)return t;const{field:e,element:i}=this,n=e?.length??-1,s=Gvt(i)?i.input.minLength:NaN;return null!=s&&!isNaN(s)&&s>=t&&(n===t||s<=n)?s:t}get name(){return this.field?.name}get range(){const{domain:t,element:e,field:i}=this;if("date"===this.dataType)return this._dateRange;const n=eC(i,t)||_E(i,t),s=n?.max===Number.MAX_VALUE?null:n?.max??null,r=n?.min===-Number.MAX_VALUE?null:n?.min??null;if(!e?.domain||"range"!==e.domain.type)return{max:s,min:r};const{max:o,min:a}=eC(i)||{};return{max:null!=o&&(null===s||null!=s&&o<s)?o:s,min:null!=a&&(null===r||null!=r&&a>r)?a:r}}get required(){const{editable:t,evaluatedRequiredExpression:e,field:i,visible:n,_isSubtypeField:s}=this;if(!t)return!1;if(!1===i?.nullable)return!0;if(s)return!0;return!(!n||!1===this.group?.visible||null==e)&&e}set required(t){this._overrideIfSome("required",t)}get showNoValueOptionEnabled(){const{element:t}=this;return!this.required&&(!Uvt(t)||t.input.showNoValueOption)}get showNoValueLabel(){const{element:t}=this;return Uvt(t)?t.input.noValueOptionLabel:null}get submittable(){const{field:t,required:e,valid:i,value:n}=this;return(!e||null!=n)&&(!!i||this.initialFeature.getAttribute(t.name)===n)}get timeResolution(){const t=this.element?.input;if(t&&("datetimeoffset-picker"===t.type||"time-picker"===t.type))return t.timeResolution??"minutes"}get timeStep(){return null!=this.timeResolution?xj.get(this.timeResolution):void 0}get updating(){const{editableExpressionExecutor:t,valueExpressionExecutor:e,visibilityExpressionExecutor:i,preservesValueWhenHidden:n}=this;return null!=e&&e.updating||null!=t&&t.updating||!1===n&&null!=i&&i.updating}get valid(){const t=this.editable?this._validate():null;return this._set("error",t),null===t}get value(){if(this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&!1!==this.group?.visible,!1===this.preservesValueWhenHidden&&this._fieldInputWasVisibleDuringLifetime&&(!1===this.visibilityExpressionExecutor?.lastEvaluatedValue||!1===this.group?.visibilityExpressionExecutor?.lastEvaluatedValue))return null!==this._storedValue&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const t=this.evaluatedValueExpression;return this.dataType===nwt.Date?this._arcadeOutputToDateFieldValue(t):null!=t&&"object"==typeof t?t.toString():t}return this._storedValue}set value(t){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",t)}get visible(){return!this._isEditTrackingField&&(null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element||this._isVisibleByDefault)}_arcadeOutputToDateFieldValue(t){const e=this.field.type;try{if("object"==typeof t){if(null===t)throw new Qe("feature-form:invalid-date-value");if(Gj(t))return Vj(t,e);if("getTime"in t&&"function"==typeof t.getTime&&"date"===e)return parseInt(t.getTime(),10);if("date-only"===e||"time-only"===e||"timestamp-offset"===e)return t.toString()}else{if("string"==typeof t)return"date"===e?parseInt(t,10):t;if("number"==typeof t&&"date"===e)return t}throw new Qe("feature-form:invalid-date-value")}catch{return"date"===e?NaN:""}}_isDomainCompatible(t){const{field:e}=this;if("coded-value"===t?.type){const i=typeof t.codedValues[0].code;if("string"===i&&cE(e)||"number"===i&&uE(e))return!0}return!!("range"===t?.type&&uE(e)||Ipt(e)||pE(e))}_validate(){const{dataType:t,domain:e,field:i,initialFeature:n,minLength:s,range:r,required:o,valid:a,value:l}=this,u=o&&null==l,c=void 0!==a;return!u&&n.getAttribute(i.name)===l&&c?null:u?wE.INVALID_TYPE:"text"===t&&s>-1&&"string"==typeof l&&l.length<s?Kvt.TOO_SHORT:"date"!==t||null==l||Wj({type:i.type,range:r,value:l})?e?null!==l||o?tC(i,l):null:SE(i,l):vE.OUT_OF_RANGE}};o([Us()],rwt.prototype,"_dateFormRange",null),o([Us()],rwt.prototype,"_dateRange",null),o([Us()],rwt.prototype,"_storedValue",void 0),o([Us()],rwt.prototype,"_configAllowsEdits",null),o([Us()],rwt.prototype,"_layerAndFieldAllowEdits",null),o([Us()],rwt.prototype,"_isVisibleByDefault",null),o([Us()],rwt.prototype,"_isEditTrackingField",null),o([Us()],rwt.prototype,"_shouldUseValueExpression",null),o([Us()],rwt.prototype,"_isSubtypeField",null),o([Us()],rwt.prototype,"dataType",null),o([Us()],rwt.prototype,"dateDataType",null),o([Us()],rwt.prototype,"description",null),o([Us()],rwt.prototype,"domain",null),o([Us()],rwt.prototype,"editable",null),o([Us({readOnly:!0})],rwt.prototype,"error",void 0),o([Us({constructOnly:!0})],rwt.prototype,"preservesValueWhenHidden",void 0),o([Us()],rwt.prototype,"evaluatedRequiredExpression",null),o([Us()],rwt.prototype,"evaluatedValueExpression",null),o([Us()],rwt.prototype,"field",void 0),o([Us()],rwt.prototype,"group",void 0),o([Us({readOnly:!0})],rwt.prototype,"hint",null),o([Us()],rwt.prototype,"includeDate",null),o([Us()],rwt.prototype,"includeTime",null),o([Us()],rwt.prototype,"includeTimeOffset",null),o([Us()],rwt.prototype,"initialFeature",null),o([Us({readOnly:!0})],rwt.prototype,"inputType",null),o([Us()],rwt.prototype,"hasInvalidSwitchValue",null),o([Us()],rwt.prototype,"isRelationshipKeyField",null),o([Us()],rwt.prototype,"label",null),o([Us()],rwt.prototype,"maxLength",null),o([Us()],rwt.prototype,"minLength",null),o([Us({readOnly:!0})],rwt.prototype,"name",null),o([Us()],rwt.prototype,"range",null),o([Us()],rwt.prototype,"required",null),o([Us()],rwt.prototype,"requiredExpressionExecutor",void 0),o([Us()],rwt.prototype,"showNoValueOptionEnabled",null),o([Us()],rwt.prototype,"submittable",null),o([Us()],rwt.prototype,"timeResolution",null),o([Us()],rwt.prototype,"timeStep",null),o([Us({readOnly:!0})],rwt.prototype,"type",void 0),o([Us()],rwt.prototype,"updating",null),o([Us()],rwt.prototype,"valid",null),o([Us({value:null})],rwt.prototype,"value",null),o([Us()],rwt.prototype,"valueExpressionExecutor",void 0),o([Us()],rwt.prototype,"visible",null),rwt=o([Nr("esri.widgets.FeatureForm.FieldInput")],rwt);const owt=t=>t&&!Number.isNaN(t.valueOf()),awt=rwt;const lwt=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function uwt(t,e){if("string"!=typeof e||!e)return e;const i=lwt.find((t=>t.pattern.test(e)));if(!i)return e;const n=e.match(i.pattern),s=n&&n[2],r=Et(Et(i.label,{messages:t,hierPart:s}),{appName:i.appName}),o=i.target?` target="${i.target}"`:"",a="_blank"===i.target?' rel="noreferrer"':"";return e.replace(i.pattern,`<a${o} href="$1"${a}>${r}</a>`)}const cwt="esri-editor-column__cell-input",hwt={input:cwt,inputContainer:`${cwt}--container`},dwt={showInput:"Enter",hideInput:"Escape"};let fwt=class extends Cgt{constructor(t){super(t),this.activeEditInfo=null,this.cellValueValidatorFunction=({oldValue:t,value:e})=>t!==e,this.editable=!1,this.inputRenderFunction=({root:t,column:e,rowData:i})=>{if(this.activeEditInfo||!this.editable)return;const n=this.getCellValue(e,i),s=this.createInputElement({root:t,column:e,rowData:i,value:n});this._set("activeEditInfo",{column:e,inputs:[s],root:t,rowData:i,oldValue:n});const r=this.createInputContainer();r.appendChild(s),this.removeCellContent(t),t.appendChild(r),s.focus(),s instanceof HTMLInputElement&&s.select()},this.loadingMessage="",this.inputType="text",this.maxLength=null,this.parseInputValueFunction=({inputs:t})=>t?.length||1!==t.length||Array.isArray(t[0].value)?null:t[0].value,this.renderFunction=t=>{const{root:e,column:i,rowData:n}=t,{activeEditInfo:s}=this;if(s)return;const r=this.getCellValue(i,n),o=this.cellValueFormatFunction({column:i,rowData:n,value:r});e.onclick=()=>e.focus(),e.ondblclick=()=>this.inputRenderFunction(t),e.ontouchend=()=>this.inputRenderFunction(t);const a=this.grid?.getSlotElementByName(e.slot),l=a?.parentElement;l&&!l.onkeydown&&(l.onkeydown=e=>{e.key!==dwt.showInput||this.activeEditInfo||this.inputRenderFunction(t),e.key===dwt.hideInput&&this.activeEditInfo&&this.cancel()}),null!=r&&null!=o?e.title=o.toString():e.title&&e.removeAttribute("title");const u=uwt(this.messagesURIUtils,o);o?.toString()!==e.innerHTML&&u!==e.innerHTML&&(e.innerHTML=u)},this.required=!1,this.store=null,this.updateRowItemFunction=({rowData:t,column:e,value:i})=>{Dt(t),e.path&&t?.item&&(t.item[e.path]=i)},this.updateStoreItemFunction=async({rowData:t,column:e,value:i})=>{Dt(t),e.path&&await(this.store?.updateItem({index:t.index,name:e.path,value:i}))}}onEditComplete(){this._set("activeEditInfo",null),this.grid?.generateCellPartNames()}cancel(){const{activeEditInfo:t}=this;if(!t)return;const{column:e,root:i,rowData:n}=t;this.onEditComplete(),this.renderFunction({column:e,root:i,rowData:n})}createInputContainer(){const t=document.createElement("div");return t.classList.add(hwt.inputContainer),t}createInputElement({value:t}){const e=document.createElement("input");return e.classList.add(hwt.input),null!=this.maxLength&&(e.maxLength=this.maxLength),e.type=this.inputType,e.value=t,e.onblur=()=>{e.onblur=null,this.submit()},e}createDateComponent(){const t=document.createElement("calcite-input-date-picker");return t.focusTrapDisabled=!0,t.overlayPositioning="fixed",t}createTimeComponent(){const t=document.createElement("calcite-input-time-picker");return t.overlayPositioning="fixed",t.placement="auto-start",t.step=1,t}createTimeZoneComponent(){const t=document.createElement("calcite-input-time-zone");return t.maxItems=4,t.overlayPositioning="fixed",t}async submit(){const{activeEditInfo:t}=this;if(!t)return;const{column:e,inputs:i,root:n,rowData:s,oldValue:r}=t,o=this.parseInputValueFunction({inputs:i,column:e,rowData:s});if(!this.cellValueValidatorFunction({value:o,oldValue:r,column:e,rowData:s}))this.cancel();else{n.textContent=this.loadingMessage;try{await this.updateStoreItemFunction({rowData:s,column:e,value:o}),this.updateRowItemFunction({rowData:s,column:e,value:o}),this.onEditComplete(),this.renderFunction({column:e,root:n,rowData:s}),this.emit("value-change",{column:e,rowData:s,value:this.getCellValue(e,s)})}catch(t){this.cancel()}}}};o([Us({readOnly:!0})],fwt.prototype,"activeEditInfo",void 0),o([Us()],fwt.prototype,"cellValueValidatorFunction",void 0),o([Us()],fwt.prototype,"editable",void 0),o([Us()],fwt.prototype,"inputRenderFunction",void 0),o([Us({constructOnly:!0})],fwt.prototype,"loadingMessage",void 0),o([Us()],fwt.prototype,"inputType",void 0),o([Us()],fwt.prototype,"maxLength",void 0),o([Us()],fwt.prototype,"parseInputValueFunction",void 0),o([Us()],fwt.prototype,"renderFunction",void 0),o([Us()],fwt.prototype,"required",void 0),o([Us()],fwt.prototype,"store",void 0),o([Us()],fwt.prototype,"updateRowItemFunction",void 0),o([Us()],fwt.prototype,"updateStoreItemFunction",void 0),fwt=o([Nr("esri.widgets.FeatureTable.Grid.EditorColumn")],fwt);const pwt=fwt;const mwt={cancelEdit:"Escape"},ywt="esri-field-column",gwt={headerRoot:`${ywt}__header-root`,headerRootEditable:`${ywt}__header-root--editable`,headerRootMenuEnabled:`${ywt}__header-root--menu-enabled`,headerContent:`${ywt}__header-content`,headerLabel:`${ywt}__header-label`,input:`${ywt}__cell-input`,inputContainer:`${ywt}__cell__input-container`,dateInputContainer:`${ywt}__cell__date-input-container`},vwt=qg("short-date-short-time"),wwt=qg("short-date"),bwt={useGrouping:!0,maximumFractionDigits:20};let Swt=class extends pwt{constructor(t){super(t),this._activeFieldInput=null,this.cellValueFormatFunction=({rowData:t,value:e})=>{if(this.formatFunction){const{template:t,field:i}=this;return this.formatFunction({template:t,field:i,value:Kx.sanitize(e)})}if(null===e)return"&nbsp;";const{field:i}=this,n=this._getDomainForFeature(t?.item?.feature);if(n){const t=this._getComputedDomain(e,n);if("date"===i.type&&"range"===n.type)return this._formatDateValueForDisplay(i,t);if(uE(i)&&"range"===n.type){const t=this.template?.format,i=t?ev(t):bwt;return iv(parseFloat(e),i)}return Ij.has(i.type)?"range"===n.type?Kx.sanitize(Rj(i,t)):Kx.sanitize(t):t}if("date"===i.type||Ij.has(i.type))return this._formatDateValueForDisplay(i,e);if(uE(i)){const t=this.template?.format,i=t?ev(t):bwt;return iv(parseFloat(e),i)}return Kx.sanitize(e)},this.cellValueValidatorFunction=({oldValue:t,value:e})=>{const{field:i}=this;if(this.required&&(null==e||""===e))return!1;if(uE(i)&&SE(i,e))return Ft.getLogger(this).warn("value-exceeds-valid-range","Field value exceeds valid range. Attempted edit was rejected."),!1;if(this._isAnyDateOrTimeField){const t=i.type,n=this._effectiveRange;if(!Wj({type:t,range:n,value:e}))return!1}return t!==e},this.editingEnabled=!1,this.expressionInfos=null,this.field=null,this.formatFunction=null,this.headerRenderFunction=t=>{const{root:e}=t,{editable:i,editingEnabled:n,headerMenuEnabled:s,menu:r,sortable:o}=this;if(!e.childElementCount){e.classList.add(gwt.headerRoot);const t=document.createElement("div");t.classList.add(gwt.headerContent),e.appendChild(t);const i=document.createElement("div");if(i.classList.add(wK.locked),t.appendChild(i),o&&this.sortElement)t.appendChild(this.sortElement);else{const e=document.createElement("span");e.classList.add(gwt.headerLabel),e.textContent=this.label,t.appendChild(e)}r?.container&&t.appendChild(r.container)}n&&!i?e.classList.add(gwt.headerRootEditable):e.classList.remove(gwt.headerRootEditable),s&&r?.items?.length?e.classList.add(gwt.headerRootMenuEnabled):e.classList.remove(gwt.headerRootMenuEnabled)},this.inputRenderFunction=({root:t,column:e,rowData:i})=>{if(this.activeEditInfo||!this.editable)return;const n=this.getCellValue(e,i),{field:s}=this;if(uE(s)&&SE(s,n))return void Ft.getLogger(this).warn("value-exceeds-valid-range","Field value is beyond supported limit. Editing is disabled for this field value.");const r=i?.item.feature;if(!r)return;this._activeFieldInput=this._setUpFieldInput(r,n);const o=document.createElement("div");o.classList.add(gwt.inputContainer);const a=[],l="coded-value"===this._effectiveDomain?.type;if(this._isAnyDateOrTimeField&&!l){const t=document.createElement("div");t.classList.add(gwt.dateInputContainer);const e=this._setUpDateComponents(n),i=this._setUpDateActionBar();e.forEach((e=>t.appendChild(e))),o.appendChild(t),o.appendChild(i),a.push(...e)}else{const s=this.createInputElement({root:t,column:e,rowData:i,value:n});o.appendChild(s),a.push(s)}this._set("activeEditInfo",{column:e,inputs:a,root:t,rowData:i,oldValue:n}),this.removeCellContent(t),t.appendChild(o),this._syncRowEditingState(t,!0),this.grid?.generateCellPartNames();const u=a[0];u&&(u.focus(),u instanceof HTMLInputElement&&u.select())},this.layer=null,this.parseInputValueFunction=({inputs:t})=>{const{activeEditInfo:e,field:i,includeTime:n}=this;if(!e||!t.length)return null;const s=t[0];if(this._isAnyDateOrTimeField){const r=e.oldValue??void 0;if("coded-value"===this._effectiveDomain?.type)return null!=s.value?parseFloat(s.value):null;switch(i.type){case"date-only":{const t=s.value;return""!==t?t:null}case"time-only":{const t=Uj(s.value);return""!==t?t:null}case"timestamp-offset":{const e=n?t[1]:void 0,i=t.at(-1);return Pj({oldValue:r,dateComponent:s,timeComponent:e,timeZoneComponent:i,defaultTimeZone:this.timeZone})}case"date":{const{max:e,min:i}=this._effectiveRange;return Fj({oldValue:r,dateComponent:s,timeComponent:t[1],timeZone:this.timeZone??void 0,max:e,min:i})}}return null}const r=s.value,{required:o}=this;return o||""!==r?uE(i)?parseFloat(r):cE(i)?r.trim():r:null},this.sortable=!0,this.store=null,this.template=null,this.updateRowItemFunction=({rowData:t,column:e,value:i})=>{t&&e.path&&(t.item.feature.attributes[e.path]=i)},this.updateStoreItemFunction=async({rowData:t,column:e,value:i})=>{if(!t||!this.store||!e.path)return;const n=t.item.objectId,s=this.store.getObjectIdIndex(n)??t.index;await this.store.updateItem({index:s,name:e.path,value:i})}}get _effectiveDomain(){const t=this._activeFieldInput?.feature;return t?this._getDomainForFeature(t):null}get _effectiveRange(){return this._activeFieldInput?.range??{max:null,min:null}}get _isAnyDateOrTimeField(){const{field:t}=this;return Ipt(t)||pE(t)}get alias(){return this.field?.alias}get defaultValue(){return this.field?.defaultValue}get description(){return this.template?.description??this.field?.description??null}get editable(){const{editingEnabled:t,field:e,layer:i,template:n}=this;if(null==e||null==i)return!1;const s=ET(i),r=Gk(i),o=r?.operations.supportsUpdate;return!!(e.editable&&s&&o&&"oid"!==e.type)&&(t?!(!1===n?.editable):!!n?.editable)}get header(){return this.template?.label||this.alias||this.path||null}get includeTime(){const{field:t,template:e}=this;return"time-only"===t.type||"date-only"!==t.type&&(!e?.input||"includeTime"in e.input&&!1!==e.input.includeTime)}get loadingMessage(){return this.messages?.loading||"..."}get maxLength(){const{field:t,template:e}=this,i=t?.length??-1,n=e?.input&&"maxLength"in e.input?e.input.maxLength:null;return null!=n&&!isNaN(n)&&n>=-1&&(-1===i||n<=i)?n:i}get minLength(){const{template:t,maxLength:e}=this,i=t?.input&&"minLength"in t.input?t.input.minLength:null;return e&&i<=e?i:null}get name(){return this.field?.name}get nullable(){return this.field?.nullable??!1}get path(){return this.field?.name}get required(){return!(!this.editable||this.field?.nullable&&!this._activeFieldInput?.required&&!this.template?.required)}createInputElement({value:t}){const{_effectiveDomain:e,field:i,maxLength:n,minLength:s,required:r}=this;let o;"coded-value"===e?.type?(o=this._createSelectElement(t,e.codedValues.map((({code:t,name:e})=>({value:t,name:e}))),r),o.onchange=()=>{o.onblur=null,l()}):(o=document.createElement("input"),o.type=uE(i)?"number":"text",n>-1&&(o.maxLength=n),s>0&&(o.minLength=s)),o.classList.add(gwt.input),o.value=t,o.required=r;let a=!1;o.onkeydown=t=>{a=t.key===mwt.cancelEdit},o.onblur=()=>{o.onblur=null,l()};const l=()=>{a?this.cancel():this.submit()};return o}getCellValue({path:t},e){return t&&e?.item?.feature?.attributes?e.item.feature.attributes?.[t]:null}onEditComplete(){const t=this.activeEditInfo?.root;t&&this._syncRowEditingState(t,!1),this._activeFieldInput=null,super.onEditComplete()}_clearActiveEditValues(){this.activeEditInfo?.inputs?.forEach((t=>t.value=""))}_setUpDateActionBar(){const{cancel:t,clear:e,save:i}=this.messagesCommon,n=document.createElement("calcite-action-bar");return n.expandDisabled=!0,n.layout="horizontal",n.appendChild(this.createCalciteAction({text:i,icon:"save",click:()=>this.submit()})),this.required||n.appendChild(this.createCalciteAction({text:e,icon:"trash",click:()=>{this._clearActiveEditValues(),this.submit()}})),n.appendChild(this.createCalciteAction({text:t,icon:"x",click:()=>this.cancel()})),n}_formatDateValueForDisplay(t,e){const{timeZone:i,timeZoneName:n}=this;return null!=e?Rj(t,e,{...this._getDateFormatOptions(),timeZone:i??void 0,timeZoneName:n??void 0}):null}_setUpDateComponents(t){const{_effectiveRange:{max:e,min:i,rawMax:n,rawMin:s},field:r,required:o}=this,a=this._getDateFieldValuesForComponents(r,t),l=[];if(Ipt(r)){const t=this.createDateComponent(),u=dE(r)||fE(r)?n:e,c=dE(r)||fE(r)?s:i,h=this._getDateFieldValuesForComponents(r,u??null),d=this._getDateFieldValuesForComponents(r,c??null);t.value=a.date??"",t.max=h.date??"",t.min=d.date??"",t.required=o,t.addEventListener("calciteInputDatePickerOpen",(()=>this._onDateComponentOpen(t))),l.push(t)}if(this.includeTime){const t=this.createTimeComponent();t.value=a.time??"",t.required=o,t.addEventListener("calciteInputTimePickerOpen",(()=>this._onDateComponentOpen(t))),l.push(t)}if("timestamp-offset"===r.type){const t=this.createTimeZoneComponent();t.value=a.timeZoneOffset??"0",t.addEventListener("calciteInputTimeZoneOpen",(()=>this._onDateComponentOpen(t))),l.push(t)}return l}_onDateComponentOpen(t){this.activeEditInfo?.inputs.forEach((e=>{e!==t&&"open"in e&&(e.open=!1)}))}_syncRowEditingState(t,e=!1){const i=this.grid?.getRowContainingNode(t);i&&(e?i.setAttribute("editing","true"):i.removeAttribute("editing"))}_getDateFieldValuesForComponents(t,e){switch(t.type){case"date":return Lj(e,this.timeZone??void 0);case"date-only":return{date:e};case"time-only":return{time:e};case"timestamp-offset":return Oj(e);default:return{}}}_createSelectElement(t,e,i=!1){let n=!1;const s=e.map((e=>{e.value===t&&(n=!0);const i=document.createElement("option");return i.text=e.name,i.value=e.value,i}));if(null!=t&&""!==t&&!n){const e=document.createElement("option");e.text=t,e.value=t,s.unshift(e)}if(!i&&null==t){const t=document.createElement("option");t.value="",s.unshift(t)}const r=document.createElement("select");return s.forEach((t=>r.add(t))),r.value=t,r}_setUpFieldInput(t,e){const{field:i,layer:n,timeZone:s}=this,r=new awt({feature:t,field:i,initialFeature:t.clone(),layer:n,timeZone:s});return r.set("value",e),r}_isDomainCompatible(t){const{field:e}=this;if(t&&"coded-value"===t.type){const i=typeof t.codedValues[0].code;if("string"===i&&cE(e)||"number"===i&&uE(e))return!0}return!(!t||"range"!==t.type||!uE(e))}_getDomainForFeature(t){const{layer:e,name:i,template:n}=this;if(!e||!t)return null;if("wfs"===e.type||"geojson"===e.type||"csv"===e.type)return null;if(n?.domain&&this._isDomainCompatible(n.domain))return n.domain;const{typeIdField:s}=e,r=s===i,o=this.field.domain;if(r&&!o)return new QF({name:"__internal-type-based-coded-value-domain__",codedValues:e.types?.map((({id:t,name:e})=>new HF({code:t,name:e})))});return s&&null!=i&&e.getFieldDomain(i,{feature:t})||o}_getComputedDomain(t,e){if(!e)return null;if("range"===e.type)return t;if("coded-value"===e.type){const i=e.codedValues.filter((e=>e.hasOwnProperty("code")&&e.code===t));return i&&i.length?i[0].name:t}return null}_getDateFormatOptions(){const{template:t}=this,e=t?.format?.dateFormat;return e?qg(e):t?.input&&"includeTime"in t.input&&!1===t.input.includeTime?wwt:vwt}};o([Us()],Swt.prototype,"_effectiveDomain",null),o([Us()],Swt.prototype,"_activeFieldInput",void 0),o([Us()],Swt.prototype,"_effectiveRange",null),o([Us()],Swt.prototype,"_isAnyDateOrTimeField",null),o([Us({readOnly:!0})],Swt.prototype,"alias",null),o([Us()],Swt.prototype,"cellValueFormatFunction",void 0),o([Us()],Swt.prototype,"cellValueValidatorFunction",void 0),o([Us({readOnly:!0})],Swt.prototype,"defaultValue",null),o([Us({readOnly:!0})],Swt.prototype,"description",null),o([Us({readOnly:!0})],Swt.prototype,"editable",null),o([Us()],Swt.prototype,"editingEnabled",void 0),o([Us()],Swt.prototype,"expressionInfos",void 0),o([Us()],Swt.prototype,"field",void 0),o([Us()],Swt.prototype,"formatFunction",void 0),o([Us({readOnly:!0})],Swt.prototype,"header",null),o([Us()],Swt.prototype,"headerRenderFunction",void 0),o([Us()],Swt.prototype,"includeTime",null),o([Us()],Swt.prototype,"inputRenderFunction",void 0),o([Us()],Swt.prototype,"layer",void 0),o([Us({readOnly:!0})],Swt.prototype,"loadingMessage",null),o([Us()],Swt.prototype,"maxLength",null),o([Us()],Swt.prototype,"minLength",null),o([Us({readOnly:!0})],Swt.prototype,"name",null),o([Us({readOnly:!0})],Swt.prototype,"nullable",null),o([Us()],Swt.prototype,"parseInputValueFunction",void 0),o([Us({readOnly:!0})],Swt.prototype,"path",null),o([Us({readOnly:!0})],Swt.prototype,"required",null),o([Us()],Swt.prototype,"sortable",void 0),o([Us()],Swt.prototype,"store",void 0),o([Us()],Swt.prototype,"template",void 0),o([Us()],Swt.prototype,"updateRowItemFunction",void 0),o([Us()],Swt.prototype,"updateStoreItemFunction",void 0),Swt=o([Nr("esri.widgets.FeatureTable.FieldColumn")],Swt);const xwt=Swt;
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function _wt(t){const e=customElements.get(t.is);if(!e){Object.defineProperty(t,"version",{get(){return"24.3.10"}});customElements.define(t.is,t)}else{const i=e.version;if(i&&t.version&&i===t.version){console.warn(`The component ${t.is} has been loaded twice`)}else{console.error(`Tried to define ${t.is} version ${t.version} when version ${e.version} is already in use. Something will probably break.`)}}}
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class Mwt extends HTMLElement{static get is(){return"vaadin-lumo-styles"}}_wt(Mwt);
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const kwt=globalThis,Twt=kwt.ShadowRoot&&(void 0===kwt.ShadyCSS||kwt.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Awt=Symbol(),Iwt=new WeakMap;class jwt{constructor(t,e,i){if(this._$cssResult$=!0,i!==Awt)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(Twt&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=Iwt.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&Iwt.set(e,t))}return t}toString(){return this.cssText}}const Cwt=t=>new jwt("string"==typeof t?t:t+"",void 0,Awt),Ewt=(t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,i,n)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[n+1]),t[0]);return new jwt(i,t,Awt)},Owt=(t,e)=>{if(Twt)t.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const i of e){const e=document.createElement("style"),n=kwt.litNonce;void 0!==n&&e.setAttribute("nonce",n),e.textContent=i.cssText,t.appendChild(e)}},Lwt=Twt?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return Cwt(e)})(t):t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;const{is:Nwt,defineProperty:Rwt,getOwnPropertyDescriptor:Pwt,getOwnPropertyNames:Fwt,getOwnPropertySymbols:Dwt,getPrototypeOf:$wt}=Object,zwt=globalThis,Uwt=zwt.trustedTypes,Vwt=Uwt?Uwt.emptyScript:"",Gwt=zwt.reactiveElementPolyfillSupport,Bwt=(t,e)=>t,qwt={toAttribute(t,e){switch(e){case Boolean:t=t?Vwt:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},Hwt=(t,e)=>!Nwt(t,e),Wwt={attribute:!0,type:String,converter:qwt,reflect:!1,hasChanged:Hwt};Symbol.metadata??=Symbol("metadata"),zwt.litPropertyMetadata??=new WeakMap;class Zwt extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=Wwt){if(e.state&&(e.attribute=!1),this._$Ei(),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),n=this.getPropertyDescriptor(t,i,e);void 0!==n&&Rwt(this.prototype,t,n)}}static getPropertyDescriptor(t,e,i){const{get:n,set:s}=Pwt(this.prototype,t)??{get(){return this[e]},set(t){this[e]=t}};return{get(){return n?.call(this)},set(e){const r=n?.call(this);s.call(this,e),this.requestUpdate(t,r,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??Wwt}static _$Ei(){if(this.hasOwnProperty(Bwt("elementProperties")))return;const t=$wt(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(Bwt("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Bwt("properties"))){const t=this.properties,e=[...Fwt(t),...Dwt(t)];for(const i of e)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const e=litPropertyMetadata.get(t);if(void 0!==e)for(const[t,i]of e)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,e]of this.elementProperties){const i=this._$Eu(t,e);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(Lwt(t))}else void 0!==t&&e.push(Lwt(t));return e}static _$Eu(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Owt(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EC(t,e){const i=this.constructor.elementProperties.get(t),n=this.constructor._$Eu(t,i);if(void 0!==n&&!0===i.reflect){const s=(void 0!==i.converter?.toAttribute?i.converter:qwt).toAttribute(e,i.type);this._$Em=t,null==s?this.removeAttribute(n):this.setAttribute(n,s),this._$Em=null}}_$AK(t,e){const i=this.constructor,n=i._$Eh.get(t);if(void 0!==n&&this._$Em!==n){const t=i.getPropertyOptions(n),s="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:qwt;this._$Em=n,this[n]=s.fromAttribute(e,t.type),this._$Em=null}}requestUpdate(t,e,i){if(void 0!==t){if(i??=this.constructor.getPropertyOptions(t),!(i.hasChanged??Hwt)(this[t],e))return;this.P(t,e,i)}!1===this.isUpdatePending&&(this._$ES=this._$ET())}P(t,e,i){this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$Em!==t&&(this._$Ej??=new Set).add(t)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,e]of this._$Ep)this[t]=e;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[e,i]of t)!0!==i.wrapped||this._$AL.has(e)||void 0===this[e]||this.P(e,this[e],i)}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(e)):this._$EU()}catch(e){throw t=!1,this._$EU(),e}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Ej&&=this._$Ej.forEach((t=>this._$EC(t,this[t]))),this._$EU()}updated(t){}firstUpdated(t){}}Zwt.elementStyles=[],Zwt.shadowRootOptions={mode:"open"},Zwt[Bwt("elementProperties")]=new Map,Zwt[Bwt("finalized")]=new Map,Gwt?.({ReactiveElement:Zwt}),(zwt.reactiveElementVersions??=[]).push("2.0.4");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Jwt=globalThis,Kwt=Jwt.trustedTypes,Ywt=Kwt?Kwt.createPolicy("lit-html",{createHTML:t=>t}):void 0,Qwt="$lit$",Xwt=`lit$${(Math.random()+"").slice(9)}$`,tbt="?"+Xwt,ebt=`<${tbt}>`,ibt=document,nbt=()=>ibt.createComment(""),sbt=t=>null===t||"object"!=typeof t&&"function"!=typeof t,rbt=Array.isArray,obt=t=>rbt(t)||"function"==typeof t?.[Symbol.iterator],abt="[ \t\n\f\r]",lbt=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,ubt=/-->/g,cbt=/>/g,hbt=RegExp(`>|${abt}(?:([^\\s"'>=/]+)(${abt}*=${abt}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),dbt=/'/g,fbt=/"/g,pbt=/^(?:script|style|textarea|title)$/i,mbt=Symbol.for("lit-noChange"),ybt=Symbol.for("lit-nothing"),gbt=new WeakMap,vbt=ibt.createTreeWalker(ibt,129);function wbt(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==Ywt?Ywt.createHTML(e):e}const bbt=(t,e)=>{const i=t.length-1,n=[];let s,r=2===e?"<svg>":"",o=lbt;for(let e=0;e<i;e++){const i=t[e];let a,l,u=-1,c=0;for(;c<i.length&&(o.lastIndex=c,l=o.exec(i),null!==l);)c=o.lastIndex,o===lbt?"!--"===l[1]?o=ubt:void 0!==l[1]?o=cbt:void 0!==l[2]?(pbt.test(l[2])&&(s=RegExp("</"+l[2],"g")),o=hbt):void 0!==l[3]&&(o=hbt):o===hbt?">"===l[0]?(o=s??lbt,u=-1):void 0===l[1]?u=-2:(u=o.lastIndex-l[2].length,a=l[1],o=void 0===l[3]?hbt:'"'===l[3]?fbt:dbt):o===fbt||o===dbt?o=hbt:o===ubt||o===cbt?o=lbt:(o=hbt,s=void 0);const h=o===hbt&&t[e+1].startsWith("/>")?" ":"";r+=o===lbt?i+ebt:u>=0?(n.push(a),i.slice(0,u)+Qwt+i.slice(u)+Xwt+h):i+Xwt+(-2===u?e:h)}return[wbt(t,r+(t[i]||"<?>")+(2===e?"</svg>":"")),n]};class Sbt{constructor({strings:t,_$litType$:e},i){let n;this.parts=[];let s=0,r=0;const o=t.length-1,a=this.parts,[l,u]=bbt(t,e);if(this.el=Sbt.createElement(l,i),vbt.currentNode=this.el.content,2===e){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(n=vbt.nextNode())&&a.length<o;){if(1===n.nodeType){if(n.hasAttributes())for(const t of n.getAttributeNames())if(t.endsWith(Qwt)){const e=u[r++],i=n.getAttribute(t).split(Xwt),o=/([.?@])?(.*)/.exec(e);a.push({type:1,index:s,name:o[2],strings:i,ctor:"."===o[1]?Tbt:"?"===o[1]?Abt:"@"===o[1]?Ibt:kbt}),n.removeAttribute(t)}else t.startsWith(Xwt)&&(a.push({type:6,index:s}),n.removeAttribute(t));if(pbt.test(n.tagName)){const t=n.textContent.split(Xwt),e=t.length-1;if(e>0){n.textContent=Kwt?Kwt.emptyScript:"";for(let i=0;i<e;i++)n.append(t[i],nbt()),vbt.nextNode(),a.push({type:2,index:++s});n.append(t[e],nbt())}}}else if(8===n.nodeType)if(n.data===tbt)a.push({type:2,index:s});else{let t=-1;for(;-1!==(t=n.data.indexOf(Xwt,t+1));)a.push({type:7,index:s}),t+=Xwt.length-1}s++}}static createElement(t,e){const i=ibt.createElement("template");return i.innerHTML=t,i}}function xbt(t,e,i=t,n){if(e===mbt)return e;let s=void 0!==n?i._$Co?.[n]:i._$Cl;const r=sbt(e)?void 0:e._$litDirective$;return s?.constructor!==r&&(s?._$AO?.(!1),void 0===r?s=void 0:(s=new r(t),s._$AT(t,i,n)),void 0!==n?(i._$Co??=[])[n]=s:i._$Cl=s),void 0!==s&&(e=xbt(t,s._$AS(t,e.values),s,n)),e}class _bt{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:i}=this._$AD,n=(t?.creationScope??ibt).importNode(e,!0);vbt.currentNode=n;let s=vbt.nextNode(),r=0,o=0,a=i[0];for(;void 0!==a;){if(r===a.index){let e;2===a.type?e=new Mbt(s,s.nextSibling,this,t):1===a.type?e=new a.ctor(s,a.name,a.strings,this,t):6===a.type&&(e=new jbt(s,this,t)),this._$AV.push(e),a=i[++o]}r!==a?.index&&(s=vbt.nextNode(),r++)}return vbt.currentNode=ibt,n}p(t){let e=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class Mbt{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,e,i,n){this.type=2,this._$AH=ybt,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=n,this._$Cv=n?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t?.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=xbt(this,t,e),sbt(t)?t===ybt||null==t||""===t?(this._$AH!==ybt&&this._$AR(),this._$AH=ybt):t!==this._$AH&&t!==mbt&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):obt(t)?this.k(t):this._(t)}S(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.S(t))}_(t){this._$AH!==ybt&&sbt(this._$AH)?this._$AA.nextSibling.data=t:this.T(ibt.createTextNode(t)),this._$AH=t}$(t){const{values:e,_$litType$:i}=t,n="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=Sbt.createElement(wbt(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===n)this._$AH.p(e);else{const t=new _bt(n,this),i=t.u(this.options);t.p(e),this.T(i),this._$AH=t}}_$AC(t){let e=gbt.get(t.strings);return void 0===e&&gbt.set(t.strings,e=new Sbt(t)),e}k(t){rbt(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,n=0;for(const s of t)n===e.length?e.push(i=new Mbt(this.S(nbt()),this.S(nbt()),this,this.options)):i=e[n],i._$AI(s),n++;n<e.length&&(this._$AR(i&&i._$AB.nextSibling,n),e.length=n)}_$AR(t=this._$AA.nextSibling,e){for(this._$AP?.(!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class kbt{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,i,n,s){this.type=1,this._$AH=ybt,this._$AN=void 0,this.element=t,this.name=e,this._$AM=n,this.options=s,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=ybt}_$AI(t,e=this,i,n){const s=this.strings;let r=!1;if(void 0===s)t=xbt(this,t,e,0),r=!sbt(t)||t!==this._$AH&&t!==mbt,r&&(this._$AH=t);else{const n=t;let o,a;for(t=s[0],o=0;o<s.length-1;o++)a=xbt(this,n[i+o],e,o),a===mbt&&(a=this._$AH[o]),r||=!sbt(a)||a!==this._$AH[o],a===ybt?t=ybt:t!==ybt&&(t+=(a??"")+s[o+1]),this._$AH[o]=a}r&&!n&&this.j(t)}j(t){t===ybt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class Tbt extends kbt{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===ybt?void 0:t}}class Abt extends kbt{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==ybt)}}class Ibt extends kbt{constructor(t,e,i,n,s){super(t,e,i,n,s),this.type=5}_$AI(t,e=this){if((t=xbt(this,t,e,0)??ybt)===mbt)return;const i=this._$AH,n=t===ybt&&i!==ybt||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,s=t!==ybt&&(i===ybt||n);n&&this.element.removeEventListener(this.name,this,i),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class jbt{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){xbt(this,t)}}const Cbt=Jwt.litHtmlPolyfillSupport;Cbt?.(Sbt,Mbt),(Jwt.litHtmlVersions??=[]).push("3.1.2");const Ebt=(t,e,i)=>{const n=i?.renderBefore??e;let s=n._$litPart$;if(void 0===s){const t=i?.renderBefore??null;n._$litPart$=s=new Mbt(e.insertBefore(nbt(),t),t,void 0,i??{})}return s._$AI(t),s
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */};class Obt extends Zwt{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=Ebt(e,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return mbt}}Obt._$litElement$=!0,Obt["finalized"]=!0,globalThis.litElementHydrateSupport?.({LitElement:Obt});const Lbt=globalThis.litElementPolyfillSupport;Lbt?.({LitElement:Obt});(globalThis.litElementVersions??=[]).push("4.0.4");
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const Nbt=t=>class e extends t{static get properties(){return{_theme:{type:String,readOnly:true}}}static get observedAttributes(){return[...super.observedAttributes,"theme"]}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i);if(t==="theme"){this._set_theme(i)}}}
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const Rbt=[];function Pbt(t){return t&&Object.prototype.hasOwnProperty.call(t,"__themes")}function Fbt(t){return Pbt(customElements.get(t))}function Dbt(t=[]){return[t].flat(Infinity).filter((t=>{if(t instanceof jwt){return true}console.warn("An item in styles is not of type CSSResult. Use `unsafeCSS` or `css`.");return false}))}function $bt(t,e,i={}){if(t){if(Fbt(t)){console.warn(`The custom element definition for "${t}"\n      was finalized before a style module was registered.\n      Make sure to add component specific style modules before\n      importing the corresponding custom element.`)}}e=Dbt(e);if(window.Vaadin&&window.Vaadin.styleModules){window.Vaadin.styleModules.registerStyles(t,e,i)}else{Rbt.push({themeFor:t,styles:e,include:i.include,moduleId:i.moduleId})}}function zbt(){if(window.Vaadin&&window.Vaadin.styleModules){return window.Vaadin.styleModules.getAllThemes()}return Rbt}function Ubt(t,e){return(t||"").split(" ").some((t=>new RegExp(`^${t.split("*").join(".*")}$`,"u").test(e)))}function Vbt(t=""){let e=0;if(t.startsWith("lumo-")||t.startsWith("material-")){e=1}else if(t.startsWith("vaadin-")){e=2}return e}function Gbt(t){const e=[];if(t.include){[].concat(t.include).forEach((t=>{const i=zbt().find((e=>e.moduleId===t));if(i){e.push(...Gbt(i),...i.styles)}else{console.warn(`Included moduleId ${t} not found in style registry`)}}),t.styles)}return e}function Bbt(t,e){const i=document.createElement("style");i.innerHTML=t.map((t=>t.cssText)).join("\n");e.content.appendChild(i)}function qbt(t){const e=`${t}-default-theme`;const i=zbt().filter((i=>i.moduleId!==e&&Ubt(i.themeFor,t))).map((t=>({...t,styles:[...Gbt(t),...t.styles],includePriority:Vbt(t.moduleId)}))).sort(((t,e)=>e.includePriority-t.includePriority));if(i.length>0){return i}return zbt().filter((t=>t.moduleId===e))}const Hbt=t=>class e extends(Nbt(t)){static finalize(){super.finalize();if(this.elementStyles){return}const t=this.prototype._template;if(!t||Pbt(this)){return}Bbt(this.getStylesForThis(),t)}static finalizeStyles(t){const e=this.getStylesForThis();return t?[...super.finalizeStyles(t),...e]:e}static getStylesForThis(){const t=Object.getPrototypeOf(this.prototype);const e=(t?t.constructor.__themes:[])||[];this.__themes=[...e,...qbt(this.is)];const i=this.__themes.flatMap((t=>t.styles));return i.filter(((t,e)=>e===i.lastIndexOf(t)))}}
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const Wbt=(t,...e)=>{const i=document.createElement("style");i.id=t;i.textContent=e.map((t=>t.toString())).join("\n").replace(":host","html");document.head.insertAdjacentElement("afterbegin",i)};const Zbt=(t,...e)=>{Wbt(`lumo-${t}`,e)};
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const Jbt=Ewt`
  :host {
    /* Base (background) */
    --lumo-base-color: #fff;

    /* Tint */
    --lumo-tint-5pct: hsla(0, 0%, 100%, 0.3);
    --lumo-tint-10pct: hsla(0, 0%, 100%, 0.37);
    --lumo-tint-20pct: hsla(0, 0%, 100%, 0.44);
    --lumo-tint-30pct: hsla(0, 0%, 100%, 0.5);
    --lumo-tint-40pct: hsla(0, 0%, 100%, 0.57);
    --lumo-tint-50pct: hsla(0, 0%, 100%, 0.64);
    --lumo-tint-60pct: hsla(0, 0%, 100%, 0.7);
    --lumo-tint-70pct: hsla(0, 0%, 100%, 0.77);
    --lumo-tint-80pct: hsla(0, 0%, 100%, 0.84);
    --lumo-tint-90pct: hsla(0, 0%, 100%, 0.9);
    --lumo-tint: #fff;

    /* Shade */
    --lumo-shade-5pct: hsla(214, 61%, 25%, 0.05);
    --lumo-shade-10pct: hsla(214, 57%, 24%, 0.1);
    --lumo-shade-20pct: hsla(214, 53%, 23%, 0.16);
    --lumo-shade-30pct: hsla(214, 50%, 22%, 0.26);
    --lumo-shade-40pct: hsla(214, 47%, 21%, 0.38);
    --lumo-shade-50pct: hsla(214, 45%, 20%, 0.52);
    --lumo-shade-60pct: hsla(214, 43%, 19%, 0.6);
    --lumo-shade-70pct: hsla(214, 42%, 18%, 0.69);
    --lumo-shade-80pct: hsla(214, 41%, 17%, 0.83);
    --lumo-shade-90pct: hsla(214, 40%, 16%, 0.94);
    --lumo-shade: hsl(214, 35%, 15%);

    /* Contrast */
    --lumo-contrast-5pct: var(--lumo-shade-5pct);
    --lumo-contrast-10pct: var(--lumo-shade-10pct);
    --lumo-contrast-20pct: var(--lumo-shade-20pct);
    --lumo-contrast-30pct: var(--lumo-shade-30pct);
    --lumo-contrast-40pct: var(--lumo-shade-40pct);
    --lumo-contrast-50pct: var(--lumo-shade-50pct);
    --lumo-contrast-60pct: var(--lumo-shade-60pct);
    --lumo-contrast-70pct: var(--lumo-shade-70pct);
    --lumo-contrast-80pct: var(--lumo-shade-80pct);
    --lumo-contrast-90pct: var(--lumo-shade-90pct);
    --lumo-contrast: var(--lumo-shade);

    /* Text */
    --lumo-header-text-color: var(--lumo-contrast);
    --lumo-body-text-color: var(--lumo-contrast-90pct);
    --lumo-secondary-text-color: var(--lumo-contrast-70pct);
    --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
    --lumo-disabled-text-color: var(--lumo-contrast-30pct);

    /* Primary */
    --lumo-primary-color: hsl(214, 100%, 48%);
    --lumo-primary-color-50pct: hsla(214, 100%, 49%, 0.76);
    --lumo-primary-color-10pct: hsla(214, 100%, 60%, 0.13);
    --lumo-primary-text-color: hsl(214, 100%, 43%);
    --lumo-primary-contrast-color: #fff;

    /* Error */
    --lumo-error-color: hsl(3, 85%, 48%);
    --lumo-error-color-50pct: hsla(3, 85%, 49%, 0.5);
    --lumo-error-color-10pct: hsla(3, 85%, 49%, 0.1);
    --lumo-error-text-color: hsl(3, 89%, 42%);
    --lumo-error-contrast-color: #fff;

    /* Success */
    --lumo-success-color: hsl(145, 72%, 30%);
    --lumo-success-color-50pct: hsla(145, 72%, 31%, 0.5);
    --lumo-success-color-10pct: hsla(145, 72%, 31%, 0.1);
    --lumo-success-text-color: hsl(145, 85%, 25%);
    --lumo-success-contrast-color: #fff;

    /* Warning */
    --lumo-warning-color: hsl(48, 100%, 50%);
    --lumo-warning-color-10pct: hsla(48, 100%, 50%, 0.25);
    --lumo-warning-text-color: hsl(32, 100%, 30%);
    --lumo-warning-contrast-color: var(--lumo-shade-90pct);
  }

  /* forced-colors mode adjustments */
  @media (forced-colors: active) {
    html {
      --lumo-disabled-text-color: GrayText;
    }
  }
`;Zbt("color-props",Jbt);const Kbt=Ewt`
  [theme~='dark'] {
    /* Base (background) */
    --lumo-base-color: hsl(214, 35%, 21%);

    /* Tint */
    --lumo-tint-5pct: hsla(214, 65%, 85%, 0.06);
    --lumo-tint-10pct: hsla(214, 60%, 80%, 0.14);
    --lumo-tint-20pct: hsla(214, 64%, 82%, 0.23);
    --lumo-tint-30pct: hsla(214, 69%, 84%, 0.32);
    --lumo-tint-40pct: hsla(214, 73%, 86%, 0.41);
    --lumo-tint-50pct: hsla(214, 78%, 88%, 0.5);
    --lumo-tint-60pct: hsla(214, 82%, 90%, 0.58);
    --lumo-tint-70pct: hsla(214, 87%, 92%, 0.69);
    --lumo-tint-80pct: hsla(214, 91%, 94%, 0.8);
    --lumo-tint-90pct: hsla(214, 96%, 96%, 0.9);
    --lumo-tint: hsl(214, 100%, 98%);

    /* Shade */
    --lumo-shade-5pct: hsla(214, 0%, 0%, 0.07);
    --lumo-shade-10pct: hsla(214, 4%, 2%, 0.15);
    --lumo-shade-20pct: hsla(214, 8%, 4%, 0.23);
    --lumo-shade-30pct: hsla(214, 12%, 6%, 0.32);
    --lumo-shade-40pct: hsla(214, 16%, 8%, 0.41);
    --lumo-shade-50pct: hsla(214, 20%, 10%, 0.5);
    --lumo-shade-60pct: hsla(214, 24%, 12%, 0.6);
    --lumo-shade-70pct: hsla(214, 28%, 13%, 0.7);
    --lumo-shade-80pct: hsla(214, 32%, 13%, 0.8);
    --lumo-shade-90pct: hsla(214, 33%, 13%, 0.9);
    --lumo-shade: hsl(214, 33%, 13%);

    /* Contrast */
    --lumo-contrast-5pct: var(--lumo-tint-5pct);
    --lumo-contrast-10pct: var(--lumo-tint-10pct);
    --lumo-contrast-20pct: var(--lumo-tint-20pct);
    --lumo-contrast-30pct: var(--lumo-tint-30pct);
    --lumo-contrast-40pct: var(--lumo-tint-40pct);
    --lumo-contrast-50pct: var(--lumo-tint-50pct);
    --lumo-contrast-60pct: var(--lumo-tint-60pct);
    --lumo-contrast-70pct: var(--lumo-tint-70pct);
    --lumo-contrast-80pct: var(--lumo-tint-80pct);
    --lumo-contrast-90pct: var(--lumo-tint-90pct);
    --lumo-contrast: var(--lumo-tint);

    /* Text */
    --lumo-header-text-color: var(--lumo-contrast);
    --lumo-body-text-color: var(--lumo-contrast-90pct);
    --lumo-secondary-text-color: var(--lumo-contrast-70pct);
    --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
    --lumo-disabled-text-color: var(--lumo-contrast-30pct);

    /* Primary */
    --lumo-primary-color: hsl(214, 90%, 48%);
    --lumo-primary-color-50pct: hsla(214, 90%, 70%, 0.69);
    --lumo-primary-color-10pct: hsla(214, 90%, 55%, 0.13);
    --lumo-primary-text-color: hsl(214, 90%, 77%);
    --lumo-primary-contrast-color: #fff;

    /* Error */
    --lumo-error-color: hsl(3, 79%, 49%);
    --lumo-error-color-50pct: hsla(3, 75%, 62%, 0.5);
    --lumo-error-color-10pct: hsla(3, 75%, 62%, 0.14);
    --lumo-error-text-color: hsl(3, 100%, 80%);

    /* Success */
    --lumo-success-color: hsl(145, 72%, 30%);
    --lumo-success-color-50pct: hsla(145, 92%, 51%, 0.5);
    --lumo-success-color-10pct: hsla(145, 92%, 51%, 0.1);
    --lumo-success-text-color: hsl(145, 85%, 46%);

    /* Warning */
    --lumo-warning-color: hsl(43, 100%, 48%);
    --lumo-warning-color-10pct: hsla(40, 100%, 50%, 0.2);
    --lumo-warning-text-color: hsl(45, 100%, 60%);
    --lumo-warning-contrast-color: var(--lumo-shade-90pct);
  }

  html {
    color: var(--lumo-body-text-color);
    background-color: var(--lumo-base-color);
    color-scheme: light;
  }

  [theme~='dark'] {
    color: var(--lumo-body-text-color);
    background-color: var(--lumo-base-color);
    color-scheme: dark;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: var(--lumo-header-text-color);
  }

  a:where(:any-link) {
    color: var(--lumo-primary-text-color);
  }

  a:not(:any-link) {
    color: var(--lumo-disabled-text-color);
  }

  blockquote {
    color: var(--lumo-secondary-text-color);
  }

  code,
  pre {
    background-color: var(--lumo-contrast-10pct);
    border-radius: var(--lumo-border-radius-m);
  }
`;$bt("",Kbt,{moduleId:"lumo-color"});
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const Ybt=Ewt`
  @font-face {
    font-family: 'lumo-icons';
    src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABEgAAsAAAAAIjQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAQwAAAFZAIUuKY21hcAAAAYgAAAD4AAADrsCU8d5nbHlmAAACgAAAC2cAABeAWri7U2hlYWQAAA3oAAAAMAAAADZa/6SsaGhlYQAADhgAAAAdAAAAJAbpA35obXR4AAAOOAAAABAAAACspBAAAGxvY2EAAA5IAAAAWAAAAFh57oA4bWF4cAAADqAAAAAfAAAAIAFKAXBuYW1lAAAOwAAAATEAAAIuUUJZCHBvc3QAAA/0AAABKwAAAelm8SzVeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGS+yDiBgZWBgamKaQ8DA0MPhGZ8wGDIyAQUZWBlZsAKAtJcUxgcXjG+0mIO+p/FEMUcxDANKMwIkgMABn8MLQB4nO3SWW6DMABF0UtwCEnIPM/zhLK8LqhfXRybSP14XUYtHV9hGYQwQBNIo3cUIPkhQeM7rib1ekqnXg981XuC1qvy84lzojleh3puxL0hPjGjRU473teloEefAUNGjJkwZcacBUtWrNmwZceeA0dOnLlw5cadB09elPGhGf+j0NTI/65KfXerT6JhqKnpRKtgOpuqaTrtKjPUlqHmhto21I7pL6i6hlqY3q7qGWrfUAeGOjTUkaGODXViqFNDnRnq3FAXhro01JWhrg11Y6hbQ90Z6t5QD4Z6NNSToZ4N9WKoV0O9GerdUB+G+jTUl6GWRvkL24BkEXictVh9bFvVFb/nxvbz+7Rf/N6zHcd2bCfP+Wic1Z9N0jpNHCD9SNqqoVBgbQoMjY+pjA4hNnWa2pV1rHSIif0DGkyT2k10Kmu1Cag6huj4ZpqYBHSqJsTEJgZCG3TaVBFv595nO3ZIv4RIrPPuvefe884599zzO/cRF8G/tgn6CFFImNgkR0ggX8wlspbhSSWSdrC5ozd30s2dw5afzvgtyz9/zG9t1hV4RtF1pXolowvtzc2z6L2aYUQM45jKH9WDTvd1LRDoDASYWhfTzTyvboXz6uZX4ARX5wrF39y+HM2+CJ8d0pkyqBIqoze3D12ez4DrFoYzxI8dWwMrDlZ2DMqQAR9AROsJU+2smlTPaTTco52BVxXa2a2+I8vvqd2dVHm1LoPeTn/AZPRYGthDYOeZjBjKoFsVGulR3lGU95SeCK44oHU7MhWUGUKZDT3oSUcG2GWuh+EDDfUYA/jhIhl0TOsJNYSEu7mQmi3UzfXwZKA4BsVsHLXQYGgJW95qEtpJ1VcW9HiTriZBlFEqxsDjA09yCNUoQxxwd7KWSTt2y3GTKifkqHRCoWZc3m11Wa/dKdFgXD4kSYfkeJBKd8KMz7J8dZn/cGRCcLGDnA2Ge3bKzcvlnTDNthFWLH7Xt80ua5FMjA4WKelWv5Xo16vHuYzpRbJhhdVlftuRK0VlR27D9lu5TF0DPBi60OrHNO0AfP/uRWvhn/U3LXICE+nh+3IHPUJ8JE6GyBjZQLbjGchlrSgYngF8zyrIF4NJD3atUcgWsWunGN/UHX5B5/yg7uF87Nqp4Gf52F3gH73DjEZNRoqCKAr9giQJp5rGJABpiVE2htNhW9R8nw0jqYjCYcY4LIjwYNScf4WN06IZnZCEqsI4cFaQbo4Z1TsZBx40YhXkHOecaYE5oY37IIQ+iJJ+UsDYSun5MuRSBRZRUUhlY2DqOGajOR6zrSU/5My6l2DnusH1GQgnw5BZP7iuYM/ahcfQ7Z8y51ddfutvuwNqWQ0cBYr8fj0U0vsHpwerVaB2sWhXT2NExi2r1KUE2tUuVMnkepVQrxTmpQrZTG4iu8he8iPyM3KcPE/+RP5KPoE2CEAKclCBzXATxkYOtUY/o961PWRqsj0chRrHFBbtrjP9/P0ven5pcbRdpL94vfsy33e5+izuwz3nFLFPVNayPZx/jdG1fOChflFRvYzsW6L18efgLrSWIgvcqnGJYi4skO4xREURjbDuxKke5v0T3Mrzkt2fi31uyZlLLrqIpEuXXsMlgw442Jb0GAxjS1DM20kBoCzHLXm/jEm0IltdcvU0fEW24jgiwwRjVd9u4NJHcIyoHJcwvyVqgqj5hqBJ1ZWSJryh9p56UWhX1XbhRbW2ZopuZWsQd5y8mEQ8M+C6xjRYxZbDKWf5AgY+Qq/l6wSPk16zDFjowYuu+wjx13mfkxbyDDxadYT/LijZyI0THB+6yfLaWsRcO82zo9mWTNtpO18qlorZoIVMwSN40tky5DOQ1MCIAe24mvlsuwIIxPb10+uXDQ4uWz/9m3rj+ql7p6bufZARuPVq5tXtsn6KwfP8Jy0TeWOyNhUJN6mhX5rkUTtUppQWEMNTqEdaCGKFYKJaQrCE4JtDLYOlNEKmO5kBTPGY2A0N2sY3+dVlo1N9ycBsIGtOjQ2p/tlZvzo0ur4v6cOh8NTospB7U/X40KahoU3bGIH97dnwmtHlYffVG3R1YOwKM2vNhrPhCT5zk64sG53oS4b31aYjqe/B7+kQiXBN+b6h21hNUPMq29B8CU4elINdygMPKF1B+WBTG7Z9ZshpN/xwEuuDQZR+nuoo4CDaAiiwXmLpmukMQyPf/JMclqgL1ixZQ/nnP2VbdUODFGt2fgBvL123rlLYu/6A9ckb7F3K0/CyBMEu6aQoPscroCcacVehvyQyCZAsizsWWBkoLC+WAiWnOksLKaeuQDzGuqSk42aiYTiJ4zf9afl17SrqaTO1f+XlZAfIuYcq7/IqYMaMrksOJ6vHkOCPDq943xcCnHqVD9pHFRpMqSPXrIua1WNs+tOz1U+ciTCDpPk+c4QYJIHnYhxP/kVPAq+ahFpVhPcHp8qyarhiF+HsBU9Hrl+UZa876fbKipL0KqB6OdUveErgtOI97fZ63ae9SvWU6k2w1JfwqnUbHsYcFCJFrC/W12zIMMirWYEHxMPs6LGYSdkSZ5TsNP9PCpwnWC3HKZ1lydNjWHC2Mn3l6vL0dHn1ldP3LTSrX+vKrBqv7KmMr8p0SR6P1NqF63or6XRlIyO90f7+kf7+myOhvt4tq7f09oUiTc2/dycGgqFQcCDRLYmi1NL7fk0CknVMxEg/cdfs/TnpJMNkgqwj17B8beVazSrVbU4lG67IZYOCnWrYy3yBR9cyWcChywos3LJBEdhhFoAdYjiw0rLGm0xU5OzoGm5/ZfmHjVZpNNg6SznzGKDdwv2cCtVn6Eaxo12cfxLprpVtTcZ6hVx6dow7Yq7e8LXO8PY9Jgjoze9yCtU5FNbegcKkQMdCbt9au/te4Ebe0jkc0ukUL32eYnTpNs20h0KpUOhZPYwVcfhZnfdqeCvDfXiuCbAoYWcXERPc/mDQD3/hdF+wK4i/xv3kYfprIpAuMkk2kW3kdtS0kBIKpZwp8KxmsCyfM1MFzAss9LBkDxRyThiaqTLwKYKJVTwmWTudMyz+yks09346MDh4m72yOxCKrt1XMlQ1qPVlTEVVQ1ofdK/sCWjtZu9qGwZ8YZ9PPWlo1IV3eW3+U0aXblP39zrt+JPf6UhEQ1rUjNBULN+utyuaDNW34kpAVuSOeMTyWbSNWnooFu+QFNWQ4d/Ox4IPWx41fP/fB/Rjeoz08ezPA9TysMtmnOXfGN7Ui3xIYLDALrlDLOP09qtJuY2OeL0+QZXdRnR1nxRVBF/SOyKKPpcrn9mWzH4rH9IidE+PTNU2182+hOgSItrE1slByS24vaLvJpxOqe4Pduf3HJkZ+jLqUz9rRzB7p8gKcgWZwV1L8JtUS5Z2JxZSOCuBoMTQihMzLbCPA0KqGMAljRQjONklW/wjnXKy8vxT/Elvm3/KiMUMOoV0/vnDYlhec0SMKtt3/kKMyOt33tj2bqxQLsTjSGLl+EAsNhCnTyRGktW55EgCn/A4PlnWn+Mg8bgZrWqHxTbPwMuyy1u5YeZF2SUM7JRhddwRgiRuxpmgJmxn9ZW7XpcF3ViX/ar6ptRpGJ0S9Adg4qhb9sI3vbL7qNJV/y4i07t5TZBiho1imFoMz3gED+CtjYUxvP4SOxov4bFoNPg5aR1e+G4UgDPoedJTpogyCJ7oYvRqoVS0MQAy+CoNEdTDUjok5ZHZL/WtjV7rFj3PKQE3iKp7ou+rIxN3b9LB1dGjeT4cvKo3FrnWpYpuaFd/h3dtV8UeKN1Y9hpR3dt4p0H/zKuPQq0kZQUIIpuDfoiETsnIk+gCWMJZUXHtE8V9LkUc2TE8vOMbO4ax/MACabzyaGXc7u3FBr11ThBdB8SIeMAlCntG2KThHSPsaj2Dc9KNyY2a0KZ7ODaTHoRiFkeYz+shZBpCS4X6471KKKnuHd84edfk5F37d1XO5bbkcltu2ZLNbvnPXiUVAnVvprJrP+NObryjxrllS65md6Tm6wzFHRR4dY3QUUjb7MgxaIixU8hspi98fl/Xc+IB4iU66eCVL9YfAfahiSUt4TONS8x0D8W7u8vd3fGWx6OXlM/U1IoU/s61PGhpyXRFa3eReq2qG56lvmYtXavCC1iN7lbiBpWxXHU+cSlztVLVz0tVN600fVsLxaVDknhYioeoXP3t4lqV1r79MAw0GCI1FTL1YIGzPL1MMlJ9ZsN9P7lvA2yr9ZFUzwzPrVgxN/x/SS+chwB4nGNgZGBgAOLPrYdY4vltvjJwM78AijDUqG5oRND/XzNPZboF5HIwMIFEAU/lC+J4nGNgZGBgDvqfBSRfMAAB81QGRgZUoA0AVvYDbwAAAHicY2BgYGB+MTQwAM8EJo8AAAAAAE4AmgDoAQoBLAFOAXABmgHEAe4CGgKcAugEmgS8BNYE8gUOBSoFegXQBf4GRAZmBrYHGAeQCBgIUghqCP4JRgm+CdoKBAo+CoQKugr0C1QLmgvAeJxjYGRgYNBmTGEQZQABJiDmAkIGhv9gPgMAGJQBvAB4nG2RPU7DMBiG3/QP0UoIBGJh8QILavozdmRo9w7d09RpUzlx5LgVvQMn4BAcgoEzcAgOwVvzSZVQbcnf48fvFysJgGt8IcJxROiG9TgauODuj5ukG+EW+UG4jR4ehTv0Q+EunjER7uEWmk+IWpc0d3gVbuAKb8JN+nfhFvlDuI17fAp36L+Fu1jgR7iHp+jF7Arbz1Nb1nO93pnEncSJFtrVuS3VKB6e5EyX2iVer9TyoOr9eux9pjJnCzW1pdfGWFU5u9WpjzfeV5PBIBMfp7aAwQ4FLPrIkbKWqDHn+67pDRK4s4lzbsEux5qHvcIIMb/nueSMyTKkE3jWFdNLHLjW2PPmMa1Hxn3GjGW/wjT0HtOG09JU4WxLk9LH2ISuiv9twJn9y8fh9uIXI+BknAAAAHicbY7ZboMwEEW5CVBCSLrv+76kfJRjTwHFsdGAG+Xvy5JUfehIHp0rnxmNN/D6ir3/a4YBhvARIMQOIowQY4wEE0yxiz3s4wCHOMIxTnCKM5zjApe4wjVucIs73OMBj3jCM17wije84wMzfHqJ0EVmUkmmJo77oOmrHvfIRZbXsTCZplTZldlgb3TYGVHProwFs11t1A57tcON2rErR3PBqcwF1/6ctI6k0GSU4JHMSS6WghdJQ99sTbfuN7QLJ9vQ37dNrgyktnIxlDYLJNuqitpRbYWKFNuyDT6pog6oOYKHtKakeakqKjHXpPwlGRcsC+OqxLIiJpXqoqqDMreG2l5bv9Ri3TRX+c23DZna9WFFgmXuO6Ps1Jm/w6ErW8N3FbHn/QC444j0AA==)
      format('woff');
    font-weight: normal;
    font-style: normal;
  }

  html {
    --lumo-icons-align-center: '\\ea01';
    --lumo-icons-align-left: '\\ea02';
    --lumo-icons-align-right: '\\ea03';
    --lumo-icons-angle-down: '\\ea04';
    --lumo-icons-angle-left: '\\ea05';
    --lumo-icons-angle-right: '\\ea06';
    --lumo-icons-angle-up: '\\ea07';
    --lumo-icons-arrow-down: '\\ea08';
    --lumo-icons-arrow-left: '\\ea09';
    --lumo-icons-arrow-right: '\\ea0a';
    --lumo-icons-arrow-up: '\\ea0b';
    --lumo-icons-bar-chart: '\\ea0c';
    --lumo-icons-bell: '\\ea0d';
    --lumo-icons-calendar: '\\ea0e';
    --lumo-icons-checkmark: '\\ea0f';
    --lumo-icons-chevron-down: '\\ea10';
    --lumo-icons-chevron-left: '\\ea11';
    --lumo-icons-chevron-right: '\\ea12';
    --lumo-icons-chevron-up: '\\ea13';
    --lumo-icons-clock: '\\ea14';
    --lumo-icons-cog: '\\ea15';
    --lumo-icons-cross: '\\ea16';
    --lumo-icons-download: '\\ea17';
    --lumo-icons-dropdown: '\\ea18';
    --lumo-icons-edit: '\\ea19';
    --lumo-icons-error: '\\ea1a';
    --lumo-icons-eye: '\\ea1b';
    --lumo-icons-eye-disabled: '\\ea1c';
    --lumo-icons-menu: '\\ea1d';
    --lumo-icons-minus: '\\ea1e';
    --lumo-icons-ordered-list: '\\ea1f';
    --lumo-icons-phone: '\\ea20';
    --lumo-icons-photo: '\\ea21';
    --lumo-icons-play: '\\ea22';
    --lumo-icons-plus: '\\ea23';
    --lumo-icons-redo: '\\ea24';
    --lumo-icons-reload: '\\ea25';
    --lumo-icons-search: '\\ea26';
    --lumo-icons-undo: '\\ea27';
    --lumo-icons-unordered-list: '\\ea28';
    --lumo-icons-upload: '\\ea29';
    --lumo-icons-user: '\\ea2a';
  }
`;Zbt("font-icons",Ybt);
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const Qbt=Ewt`
  :host {
    --lumo-size-xs: 1.625rem;
    --lumo-size-s: 1.875rem;
    --lumo-size-m: 2.25rem;
    --lumo-size-l: 2.75rem;
    --lumo-size-xl: 3.5rem;

    /* Icons */
    --lumo-icon-size-s: 1.25em;
    --lumo-icon-size-m: 1.5em;
    --lumo-icon-size-l: 2.25em;
    /* For backwards compatibility */
    --lumo-icon-size: var(--lumo-icon-size-m);
  }
`;Zbt("sizing-props",Qbt);
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const Xbt=Ewt`
  :host {
    /* Square */
    --lumo-space-xs: 0.25rem;
    --lumo-space-s: 0.5rem;
    --lumo-space-m: 1rem;
    --lumo-space-l: 1.5rem;
    --lumo-space-xl: 2.5rem;

    /* Wide */
    --lumo-space-wide-xs: calc(var(--lumo-space-xs) / 2) var(--lumo-space-xs);
    --lumo-space-wide-s: calc(var(--lumo-space-s) / 2) var(--lumo-space-s);
    --lumo-space-wide-m: calc(var(--lumo-space-m) / 2) var(--lumo-space-m);
    --lumo-space-wide-l: calc(var(--lumo-space-l) / 2) var(--lumo-space-l);
    --lumo-space-wide-xl: calc(var(--lumo-space-xl) / 2) var(--lumo-space-xl);

    /* Tall */
    --lumo-space-tall-xs: var(--lumo-space-xs) calc(var(--lumo-space-xs) / 2);
    --lumo-space-tall-s: var(--lumo-space-s) calc(var(--lumo-space-s) / 2);
    --lumo-space-tall-m: var(--lumo-space-m) calc(var(--lumo-space-m) / 2);
    --lumo-space-tall-l: var(--lumo-space-l) calc(var(--lumo-space-l) / 2);
    --lumo-space-tall-xl: var(--lumo-space-xl) calc(var(--lumo-space-xl) / 2);
  }
`;Zbt("spacing-props",Xbt);
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const tSt=Ewt`
  :host {
    /* Border radius */
    --lumo-border-radius-s: 0.25em; /* Checkbox, badge, date-picker year indicator, etc */
    --lumo-border-radius-m: var(--lumo-border-radius, 0.25em); /* Button, text field, menu overlay, etc */
    --lumo-border-radius-l: 0.5em; /* Dialog, notification, etc */

    /* Shadow */
    --lumo-box-shadow-xs: 0 1px 4px -1px var(--lumo-shade-50pct);
    --lumo-box-shadow-s: 0 2px 4px -1px var(--lumo-shade-20pct), 0 3px 12px -1px var(--lumo-shade-30pct);
    --lumo-box-shadow-m: 0 2px 6px -1px var(--lumo-shade-20pct), 0 8px 24px -4px var(--lumo-shade-40pct);
    --lumo-box-shadow-l: 0 3px 18px -2px var(--lumo-shade-20pct), 0 12px 48px -6px var(--lumo-shade-40pct);
    --lumo-box-shadow-xl: 0 4px 24px -3px var(--lumo-shade-20pct), 0 18px 64px -8px var(--lumo-shade-40pct);

    /* Clickable element cursor */
    --lumo-clickable-cursor: default;
  }
`;Ewt`
  html {
    /* Button */
    --vaadin-button-background: var(--lumo-contrast-5pct);
    --vaadin-button-border: none;
    --vaadin-button-border-radius: var(--lumo-border-radius-m);
    --vaadin-button-font-size: var(--lumo-font-size-m);
    --vaadin-button-font-weight: 500;
    --vaadin-button-height: var(--lumo-size-m);
    --vaadin-button-margin: var(--lumo-space-xs) 0;
    --vaadin-button-min-width: calc(var(--vaadin-button-height) * 2);
    --vaadin-button-padding: 0 calc(var(--vaadin-button-height) / 3 + var(--lumo-border-radius-m) / 2);
    --vaadin-button-text-color: var(--lumo-primary-text-color);
    --vaadin-button-primary-background: var(--lumo-primary-color);
    --vaadin-button-primary-border: none;
    --vaadin-button-primary-font-weight: 600;
    --vaadin-button-primary-text-color: var(--lumo-primary-contrast-color);
    --vaadin-button-tertiary-background: transparent !important;
    --vaadin-button-tertiary-text-color: var(--lumo-primary-text-color);
    --vaadin-button-tertiary-font-weight: 500;
    --vaadin-button-tertiary-padding: 0 calc(var(--vaadin-button-height) / 6);
    /* Checkbox */
    --vaadin-checkbox-background: var(--lumo-contrast-20pct);
    --vaadin-checkbox-background-hover: var(--lumo-contrast-30pct);
    --vaadin-checkbox-border-radius: var(--lumo-border-radius-s);
    --vaadin-checkbox-checkmark-char: var(--lumo-icons-checkmark);
    --vaadin-checkbox-checkmark-char-indeterminate: '';
    --vaadin-checkbox-checkmark-color: var(--lumo-primary-contrast-color);
    --vaadin-checkbox-checkmark-size: calc(var(--vaadin-checkbox-size) + 2px);
    --vaadin-checkbox-label-color: var(--lumo-body-text-color);
    --vaadin-checkbox-label-font-size: var(--lumo-font-size-m);
    --vaadin-checkbox-label-padding: var(--lumo-space-xs) var(--lumo-space-s) var(--lumo-space-xs) var(--lumo-space-xs);
    --vaadin-checkbox-size: calc(var(--lumo-size-m) / 2);
    /* Radio button */
    --vaadin-radio-button-background: var(--lumo-contrast-20pct);
    --vaadin-radio-button-background-hover: var(--lumo-contrast-30pct);
    --vaadin-radio-button-dot-color: var(--lumo-primary-contrast-color);
    --vaadin-radio-button-dot-size: 3px;
    --vaadin-radio-button-label-color: var(--lumo-body-text-color);
    --vaadin-radio-button-label-font-size: var(--lumo-font-size-m);
    --vaadin-radio-button-label-padding: var(--lumo-space-xs) var(--lumo-space-s) var(--lumo-space-xs)
      var(--lumo-space-xs);
    --vaadin-radio-button-size: calc(var(--lumo-size-m) / 2);
    --vaadin-selection-color: var(--lumo-primary-color);
    --vaadin-selection-color-text: var(--lumo-primary-text-color);
    --vaadin-input-field-border-radius: var(--lumo-border-radius-m);
    --vaadin-focus-ring-color: var(--lumo-primary-color-50pct);
    --vaadin-focus-ring-width: 2px;
    /* Label */
    --vaadin-input-field-label-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-focused-label-color: var(--lumo-primary-text-color);
    --vaadin-input-field-hovered-label-color: var(--lumo-body-text-color);
    --vaadin-input-field-label-font-size: var(--lumo-font-size-s);
    --vaadin-input-field-label-font-weight: 500;
    /* Helper */
    --vaadin-input-field-helper-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-helper-font-size: var(--lumo-font-size-xs);
    --vaadin-input-field-helper-font-weight: 400;
    --vaadin-input-field-helper-spacing: 0.4em;
    /* Error message */
    --vaadin-input-field-error-color: var(--lumo-error-text-color);
    --vaadin-input-field-error-font-size: var(--lumo-font-size-xs);
    --vaadin-input-field-error-font-weight: 400;
    /* Input field */
    --vaadin-input-field-background: var(--lumo-contrast-10pct);
    --vaadin-input-field-icon-color: var(--lumo-contrast-60pct);
    --vaadin-input-field-icon-size: var(--lumo-icon-size-m);
    --vaadin-input-field-invalid-background: var(--lumo-error-color-10pct);
    --vaadin-input-field-invalid-hover-highlight: var(--lumo-error-color-50pct);
    --vaadin-input-field-height: var(--lumo-size-m);
    --vaadin-input-field-hover-highlight: var(--lumo-contrast-50pct);
    --vaadin-input-field-placeholder-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-readonly-border: 1px dashed var(--lumo-contrast-30pct);
    --vaadin-input-field-value-color: var(--lumo-body-text-color);
    --vaadin-input-field-value-font-size: var(--lumo-font-size-m);
    --vaadin-input-field-value-font-weight: 400;
  }
`;Zbt("style-props",tSt);
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const eSt=Ewt`
  :host {
    /* prettier-ignore */
    --lumo-font-family: -apple-system, BlinkMacSystemFont, 'Roboto', 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';

    /* Font sizes */
    --lumo-font-size-xxs: 0.75rem;
    --lumo-font-size-xs: 0.8125rem;
    --lumo-font-size-s: 0.875rem;
    --lumo-font-size-m: 1rem;
    --lumo-font-size-l: 1.125rem;
    --lumo-font-size-xl: 1.375rem;
    --lumo-font-size-xxl: 1.75rem;
    --lumo-font-size-xxxl: 2.5rem;

    /* Line heights */
    --lumo-line-height-xs: 1.25;
    --lumo-line-height-s: 1.375;
    --lumo-line-height-m: 1.625;
  }
`;const iSt=Ewt`
  body,
  :host {
    font-family: var(--lumo-font-family);
    font-size: var(--lumo-font-size-m);
    line-height: var(--lumo-line-height-m);
    -webkit-text-size-adjust: 100%;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  small,
  [theme~='font-size-s'] {
    font-size: var(--lumo-font-size-s);
    line-height: var(--lumo-line-height-s);
  }

  [theme~='font-size-xs'] {
    font-size: var(--lumo-font-size-xs);
    line-height: var(--lumo-line-height-xs);
  }

  :where(h1, h2, h3, h4, h5, h6) {
    font-weight: 600;
    line-height: var(--lumo-line-height-xs);
    margin-block: 0;
  }

  :where(h1) {
    font-size: var(--lumo-font-size-xxxl);
  }

  :where(h2) {
    font-size: var(--lumo-font-size-xxl);
  }

  :where(h3) {
    font-size: var(--lumo-font-size-xl);
  }

  :where(h4) {
    font-size: var(--lumo-font-size-l);
  }

  :where(h5) {
    font-size: var(--lumo-font-size-m);
  }

  :where(h6) {
    font-size: var(--lumo-font-size-xs);
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  p,
  blockquote {
    margin-top: 0.5em;
    margin-bottom: 0.75em;
  }

  a {
    text-decoration: none;
  }

  a:where(:any-link):hover {
    text-decoration: underline;
  }

  hr {
    display: block;
    align-self: stretch;
    height: 1px;
    border: 0;
    padding: 0;
    margin: var(--lumo-space-s) calc(var(--lumo-border-radius-m) / 2);
    background-color: var(--lumo-contrast-10pct);
  }

  blockquote {
    border-left: 2px solid var(--lumo-contrast-30pct);
  }

  b,
  strong {
    font-weight: 600;
  }

  /* RTL specific styles */
  blockquote[dir='rtl'] {
    border-left: none;
    border-right: 2px solid var(--lumo-contrast-30pct);
  }
`;$bt("",iSt,{moduleId:"lumo-typography"});Zbt("typography-props",eSt);$bt("vaadin-checkbox",Ewt`
    :host {
      color: var(--vaadin-checkbox-label-color, var(--lumo-body-text-color));
      font-size: var(--vaadin-checkbox-label-font-size, var(--lumo-font-size-m));
      font-family: var(--lumo-font-family);
      line-height: var(--lumo-line-height-s);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      -webkit-tap-highlight-color: transparent;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
      cursor: default;
      outline: none;
      --_checkbox-size: var(--vaadin-checkbox-size, calc(var(--lumo-size-m) / 2));
      --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
      --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
      --_selection-color: var(--vaadin-selection-color, var(--lumo-primary-color));
    }

    :host([has-label]) ::slotted(label) {
      padding: var(
        --vaadin-checkbox-label-padding,
        var(--lumo-space-xs) var(--lumo-space-s) var(--lumo-space-xs) var(--lumo-space-xs)
      );
    }

    [part='checkbox'] {
      width: var(--_checkbox-size);
      height: var(--_checkbox-size);
      margin: var(--lumo-space-xs);
      position: relative;
      border-radius: var(--vaadin-checkbox-border-radius, var(--lumo-border-radius-s));
      background: var(--vaadin-checkbox-background, var(--lumo-contrast-20pct));
      transition: transform 0.2s cubic-bezier(0.12, 0.32, 0.54, 2), background-color 0.15s;
      cursor: var(--lumo-clickable-cursor);
      /* Default field border color */
      --_input-border-color: var(--vaadin-input-field-border-color, var(--lumo-contrast-50pct));
    }

    :host([indeterminate]),
    :host([checked]) {
      --vaadin-input-field-border-color: transparent;
    }

    :host([indeterminate]) [part='checkbox'],
    :host([checked]) [part='checkbox'] {
      background-color: var(--_selection-color);
    }

    /* Checkmark */
    [part='checkbox']::after {
      pointer-events: none;
      font-family: 'lumo-icons';
      content: var(--vaadin-checkbox-checkmark-char, var(--lumo-icons-checkmark));
      color: var(--vaadin-checkbox-checkmark-color, var(--lumo-primary-contrast-color));
      font-size: var(--vaadin-checkbox-checkmark-size, calc(var(--_checkbox-size) + 2px));
      line-height: 1;
      position: absolute;
      top: -1px;
      left: -1px;
      contain: content;
      opacity: 0;
    }

    :host([checked]) [part='checkbox']::after {
      opacity: 1;
    }

    /* Indeterminate checkmark */
    :host([indeterminate]) [part='checkbox']::after {
      content: var(--vaadin-checkbox-checkmark-char-indeterminate, '');
      opacity: 1;
      top: 45%;
      height: 10%;
      left: 22%;
      right: 22%;
      width: auto;
      border: 0;
      background-color: var(--lumo-primary-contrast-color);
    }

    /* Focus ring */
    :host([focus-ring]) [part='checkbox'] {
      box-shadow: 0 0 0 1px var(--lumo-base-color), 0 0 0 calc(var(--_focus-ring-width) + 1px) var(--_focus-ring-color),
        inset 0 0 0 var(--_input-border-width, 0) var(--_input-border-color);
    }

    /* Disabled */
    :host([disabled]) {
      pointer-events: none;
      color: var(--lumo-disabled-text-color);
      --vaadin-input-field-border-color: var(--lumo-contrast-20pct);
    }

    :host([disabled]) ::slotted(label) {
      color: inherit;
    }

    :host([disabled]) [part='checkbox'] {
      background-color: var(--lumo-contrast-10pct);
    }

    :host([disabled]) [part='checkbox']::after {
      color: var(--lumo-contrast-30pct);
    }

    :host([indeterminate][disabled]) [part='checkbox']::after {
      background-color: var(--lumo-contrast-30pct);
    }

    /* RTL specific styles */
    :host([dir='rtl'][has-label]) ::slotted(label) {
      padding: var(--lumo-space-xs) var(--lumo-space-xs) var(--lumo-space-xs) var(--lumo-space-s);
    }

    /* Used for activation "halo" */
    [part='checkbox']::before {
      pointer-events: none;
      color: transparent;
      width: 100%;
      height: 100%;
      line-height: var(--_checkbox-size);
      border-radius: inherit;
      background-color: inherit;
      transform: scale(1.4);
      opacity: 0;
      transition: transform 0.1s, opacity 0.8s;
    }

    /* Hover */
    :host(:not([checked]):not([indeterminate]):not([disabled]):hover) [part='checkbox'] {
      background: var(--vaadin-checkbox-background-hover, var(--lumo-contrast-30pct));
    }

    /* Disable hover for touch devices */
    @media (pointer: coarse) {
      :host(:not([checked]):not([indeterminate]):not([disabled]):hover) [part='checkbox'] {
        background: var(--vaadin-checkbox-background, var(--lumo-contrast-20pct));
      }
    }

    /* Active */
    :host([active]) [part='checkbox'] {
      transform: scale(0.9);
      transition-duration: 0.05s;
    }

    :host([active][checked]) [part='checkbox'] {
      transform: scale(1.1);
    }

    :host([active]:not([checked])) [part='checkbox']::before {
      transition-duration: 0.01s, 0.01s;
      transform: scale(0);
      opacity: 0.4;
    }
  `,{moduleId:"lumo-checkbox"});$bt("vaadin-grid",Ewt`
    :host {
      font-family: var(--lumo-font-family);
      font-size: var(--lumo-font-size-m);
      line-height: var(--lumo-line-height-s);
      color: var(--lumo-body-text-color);
      background-color: var(--lumo-base-color);
      box-sizing: border-box;
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
      --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
      /* For internal use only */
      --_lumo-grid-border-color: var(--lumo-contrast-20pct);
      --_lumo-grid-secondary-border-color: var(--lumo-contrast-10pct);
      --_lumo-grid-border-width: 1px;
      --_lumo-grid-selected-row-color: var(--lumo-primary-color-10pct);
    }

    /* No (outer) border */

    :host(:not([theme~='no-border'])) {
      border: var(--_lumo-grid-border-width) solid var(--_lumo-grid-border-color);
    }

    :host([disabled]) {
      opacity: 0.7;
    }

    /* Cell styles */

    [part~='cell'] {
      min-height: var(--lumo-size-m);
      background-color: var(--vaadin-grid-cell-background, var(--lumo-base-color));
      cursor: default;
      --_cell-padding: var(--vaadin-grid-cell-padding, var(--_cell-default-padding));
      --_cell-default-padding: var(--lumo-space-xs) var(--lumo-space-m);
    }

    [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      cursor: inherit;
      padding: var(--_cell-padding);
    }

    /* Apply row borders by default and introduce the "no-row-borders" variant */
    :host(:not([theme~='no-row-borders'])) [part~='cell']:not([part~='details-cell']) {
      border-top: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    /* Hide first body row top border */
    :host(:not([theme~='no-row-borders'])) [part~='first-row'] [part~='cell']:not([part~='details-cell']) {
      border-top: 0;
      min-height: calc(var(--lumo-size-m) - var(--_lumo-grid-border-width));
    }

    /* Focus-ring */

    [part~='row'] {
      position: relative;
    }

    [part~='row']:focus,
    [part~='focused-cell']:focus {
      outline: none;
    }

    :host([navigating]) [part~='row']:focus::before,
    :host([navigating]) [part~='focused-cell']:focus::before {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
    }

    :host([navigating]) [part~='row']:focus::before {
      transform: translateX(calc(-1 * var(--_grid-horizontal-scroll-position)));
      z-index: 3;
    }

    /* Drag and Drop styles */
    :host([dragover])::after {
      content: '';
      position: absolute;
      z-index: 100;
      inset: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
    }

    [part~='row'][dragover] {
      z-index: 100 !important;
    }

    [part~='row'][dragover] [part~='cell'] {
      overflow: visible;
    }

    [part~='row'][dragover] [part~='cell']::after {
      content: '';
      position: absolute;
      inset: 0;
      height: calc(var(--_lumo-grid-border-width) + 2px);
      pointer-events: none;
      background: var(--lumo-primary-color-50pct);
    }

    [part~='row'][dragover] [part~='cell'][last-frozen]::after {
      right: -1px;
    }

    :host([theme~='no-row-borders']) [dragover] [part~='cell']::after {
      height: 2px;
    }

    [part~='row'][dragover='below'] [part~='cell']::after {
      top: 100%;
      bottom: auto;
      margin-top: -1px;
    }

    :host([all-rows-visible]) [part~='last-row'][dragover='below'] [part~='cell']::after {
      height: 1px;
    }

    [part~='row'][dragover='above'] [part~='cell']::after {
      top: auto;
      bottom: 100%;
      margin-bottom: -1px;
    }

    [part~='row'][details-opened][dragover='below'] [part~='cell']:not([part~='details-cell'])::after,
    [part~='row'][details-opened][dragover='above'] [part~='details-cell']::after {
      display: none;
    }

    [part~='row'][dragover][dragover='on-top'] [part~='cell']::after {
      height: 100%;
      opacity: 0.5;
    }

    [part~='row'][dragstart] [part~='cell'] {
      border: none !important;
      box-shadow: none !important;
    }

    [part~='row'][dragstart] [part~='cell'][last-column] {
      border-radius: 0 var(--lumo-border-radius-s) var(--lumo-border-radius-s) 0;
    }

    [part~='row'][dragstart] [part~='cell'][first-column] {
      border-radius: var(--lumo-border-radius-s) 0 0 var(--lumo-border-radius-s);
    }

    #scroller [part~='row'][dragstart]:not([dragstart=''])::after {
      display: block;
      position: absolute;
      left: var(--_grid-drag-start-x);
      top: var(--_grid-drag-start-y);
      z-index: 100;
      content: attr(dragstart);
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      padding: calc(var(--lumo-space-xs) * 0.8);
      color: var(--lumo-error-contrast-color);
      background-color: var(--lumo-error-color);
      border-radius: var(--lumo-border-radius-m);
      font-family: var(--lumo-font-family);
      font-size: var(--lumo-font-size-xxs);
      line-height: 1;
      font-weight: 500;
      text-transform: initial;
      letter-spacing: initial;
      min-width: calc(var(--lumo-size-s) * 0.7);
      text-align: center;
    }

    /* Headers and footers */

    [part~='header-cell'],
    [part~='footer-cell'],
    [part~='reorder-ghost'] {
      font-size: var(--lumo-font-size-s);
      font-weight: 500;
    }

    [part~='footer-cell'] {
      font-weight: 400;
    }

    [part~='row']:only-child [part~='header-cell'] {
      min-height: var(--lumo-size-xl);
    }

    /* Header borders */

    /* Hide first header row top border */
    :host(:not([theme~='no-row-borders'])) [part~='row']:first-child [part~='header-cell'] {
      border-top: 0;
    }

    /* Hide header row top border if previous row is hidden */
    [part~='row'][hidden] + [part~='row'] [part~='header-cell'] {
      border-top: 0;
    }

    [part~='row']:last-child [part~='header-cell'] {
      border-bottom: var(--_lumo-grid-border-width) solid transparent;
    }

    :host(:not([theme~='no-row-borders'])) [part~='row']:last-child [part~='header-cell'] {
      border-bottom-color: var(--_lumo-grid-secondary-border-color);
    }

    /* Overflow uses a stronger border color */
    :host([overflow~='top']) [part~='row']:last-child [part~='header-cell'] {
      border-bottom-color: var(--_lumo-grid-border-color);
    }

    /* Footer borders */

    [part~='row']:first-child [part~='footer-cell'] {
      border-top: var(--_lumo-grid-border-width) solid transparent;
    }

    :host(:not([theme~='no-row-borders'])) [part~='row']:first-child [part~='footer-cell'] {
      border-top-color: var(--_lumo-grid-secondary-border-color);
    }

    /* Overflow uses a stronger border color */
    :host([overflow~='bottom']) [part~='row']:first-child [part~='footer-cell'] {
      border-top-color: var(--_lumo-grid-border-color);
    }

    /* Column reordering */

    :host([reordering]) [part~='cell'] {
      background: linear-gradient(var(--lumo-shade-20pct), var(--lumo-shade-20pct)) var(--lumo-base-color);
    }

    :host([reordering]) [part~='cell'][reorder-status='allowed'] {
      background: var(--lumo-base-color);
    }

    :host([reordering]) [part~='cell'][reorder-status='dragging'] {
      background: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct)) var(--lumo-base-color);
    }

    [part~='reorder-ghost'] {
      opacity: 0.85;
      box-shadow: var(--lumo-box-shadow-s);
      /* TODO Use the same styles as for the cell element (reorder-ghost copies styles from the cell element) */
      padding: var(--lumo-space-s) var(--lumo-space-m) !important;
    }

    /* Column resizing */

    [part='resize-handle'] {
      width: 3px;
      background-color: var(--lumo-primary-color-50pct);
      opacity: 0;
      transition: opacity 0.2s;
    }

    :host(:not([reordering])) *:not([column-resizing]) [part~='cell']:hover [part='resize-handle'],
    [part='resize-handle']:active {
      opacity: 1;
      transition-delay: 0.15s;
    }

    /* Column borders */

    :host([theme~='column-borders']) [part~='cell']:not([last-column]):not([part~='details-cell']) {
      border-right: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    /* Frozen columns */

    [last-frozen] {
      border-right: var(--_lumo-grid-border-width) solid transparent;
      overflow: hidden;
    }

    :host([overflow~='start']) [part~='cell'][last-frozen]:not([part~='details-cell']) {
      border-right-color: var(--_lumo-grid-border-color);
    }

    [first-frozen-to-end] {
      border-left: var(--_lumo-grid-border-width) solid transparent;
    }

    :host([overflow~='end']) [part~='cell'][first-frozen-to-end]:not([part~='details-cell']) {
      border-left-color: var(--_lumo-grid-border-color);
    }

    /* Row stripes */

    :host([theme~='row-stripes']) [part~='even-row'] [part~='body-cell'],
    :host([theme~='row-stripes']) [part~='even-row'] [part~='details-cell'] {
      background-image: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct));
      background-repeat: repeat-x;
    }

    /* Selected row */

    /* Raise the selected rows above unselected rows (so that box-shadow can cover unselected rows) */
    :host(:not([reordering])) [part~='row'][selected] {
      z-index: 1;
    }

    :host(:not([reordering])) [part~='row'][selected] [part~='body-cell']:not([part~='details-cell']) {
      background-image: linear-gradient(var(--_lumo-grid-selected-row-color), var(--_lumo-grid-selected-row-color));
      background-repeat: repeat;
    }

    /* Cover the border of an unselected row */
    :host(:not([theme~='no-row-borders'])) [part~='row'][selected] [part~='cell']:not([part~='details-cell']) {
      box-shadow: 0 var(--_lumo-grid-border-width) 0 0 var(--_lumo-grid-selected-row-color);
    }

    /* Compact */

    :host([theme~='compact']) [part~='row']:only-child [part~='header-cell'] {
      min-height: var(--lumo-size-m);
    }

    :host([theme~='compact']) [part~='cell'] {
      min-height: var(--lumo-size-s);
      --_cell-default-padding: var(--lumo-space-xs) var(--lumo-space-s);
    }

    :host([theme~='compact']) [part~='first-row'] [part~='cell']:not([part~='details-cell']) {
      min-height: calc(var(--lumo-size-s) - var(--_lumo-grid-border-width));
    }

    /* Wrap cell contents */

    :host([theme~='wrap-cell-content']) [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      white-space: normal;
    }

    /* RTL specific styles */

    :host([dir='rtl']) [part~='row'][dragstart] [part~='cell'][last-column] {
      border-radius: var(--lumo-border-radius-s) 0 0 var(--lumo-border-radius-s);
    }

    :host([dir='rtl']) [part~='row'][dragstart] [part~='cell'][first-column] {
      border-radius: 0 var(--lumo-border-radius-s) var(--lumo-border-radius-s) 0;
    }

    :host([dir='rtl'][theme~='column-borders']) [part~='cell']:not([last-column]):not([part~='details-cell']) {
      border-right: none;
      border-left: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    :host([dir='rtl']) [last-frozen] {
      border-right: none;
      border-left: var(--_lumo-grid-border-width) solid transparent;
    }

    :host([dir='rtl']) [first-frozen-to-end] {
      border-left: none;
      border-right: var(--_lumo-grid-border-width) solid transparent;
    }

    :host([dir='rtl'][overflow~='start']) [part~='cell'][last-frozen]:not([part~='details-cell']) {
      border-left-color: var(--_lumo-grid-border-color);
    }

    :host([dir='rtl'][overflow~='end']) [part~='cell'][first-frozen-to-end]:not([part~='details-cell']) {
      border-right-color: var(--_lumo-grid-border-color);
    }
  `,{moduleId:"lumo-grid"});
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/window.JSCompiler_renameProperty=function(t,e){return t};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let nSt=/(url\()([^)]*)(\))/g;let sSt=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/;let rSt;let oSt;function aSt(t,e){if(t&&sSt.test(t)){return t}if(t==="//"){return t}if(rSt===undefined){rSt=false;try{const t=new URL("b","http://a");t.pathname="c%20d";rSt=t.href==="http://a/c%20d"}catch(t){}}if(!e){e=document.baseURI||window.location.href}if(rSt){try{return new URL(t,e).href}catch(e){return t}}if(!oSt){oSt=document.implementation.createHTMLDocument("temp");oSt.base=oSt.createElement("base");oSt.head.appendChild(oSt.base);oSt.anchor=oSt.createElement("a");oSt.body.appendChild(oSt.anchor)}oSt.base.href=e;oSt.anchor.href=t;return oSt.anchor.href||t}function lSt(t,e){return t.replace(nSt,(function(t,i,n,s){return i+"'"+aSt(n.replace(/["']/g,""),e)+"'"+s}))}function uSt(t){return t.substring(0,t.lastIndexOf("/")+1)}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const cSt=!window.ShadyDOM||!window.ShadyDOM.inUse;const hSt=cSt&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{const t=new CSSStyleSheet;t.replaceSync("");const e=document.createElement("div");e.attachShadow({mode:"open"});e.shadowRoot.adoptedStyleSheets=[t];return e.shadowRoot.adoptedStyleSheets[0]===t}catch(t){return false}})();let dSt=window.Polymer&&window.Polymer.rootPath||uSt(document.baseURI||window.location.href);let fSt=window.Polymer&&window.Polymer.sanitizeDOMValue||undefined;let pSt=window.Polymer&&window.Polymer.strictTemplatePolicy||false;let mSt=window.Polymer&&window.Polymer.allowTemplateFromDomModule||false;let ySt=window.Polymer&&window.Polymer.legacyOptimizations||false;let gSt=window.Polymer&&window.Polymer.legacyWarnings||false;let vSt=window.Polymer&&window.Polymer.syncInitialRender||false;let wSt=window.Polymer&&window.Polymer.legacyUndefined||false;let bSt=window.Polymer&&window.Polymer.orderedComputed||false;let SSt=window.Polymer&&window.Polymer.removeNestedTemplates||false;let xSt=window.Polymer&&window.Polymer.fastDomIf||false;let _St=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||false;
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let MSt=0;const kSt=function(t){let e=t.__mixinApplications;if(!e){e=new WeakMap;t.__mixinApplications=e}let i=MSt++;function n(n){let s=n.__mixinSet;if(s&&s[i]){return n}let r=e;let o=r.get(n);if(!o){o=t(n);r.set(n,o);let e=Object.create(o.__mixinSet||s||null);e[i]=true;o.__mixinSet=e}return o}return n};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let TSt={};let ASt={};function ISt(t,e){TSt[t]=ASt[t.toLowerCase()]=e}function jSt(t){return TSt[t]||ASt[t.toLowerCase()]}function CSt(t){if(t.querySelector("style")){console.warn("dom-module %s has style outside template",t.id)}}class ESt extends HTMLElement{static get observedAttributes(){return["id"]}static import(t,e){if(t){let i=jSt(t);if(i&&e){return i.querySelector(e)}return i}return null}attributeChangedCallback(t,e,i,n){if(e!==i){this.register()}}get assetpath(){if(!this.__assetpath){const t=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument;const e=aSt(this.getAttribute("assetpath")||"",t.baseURI);this.__assetpath=uSt(e)}return this.__assetpath}register(t){t=t||this.id;if(t){if(pSt&&jSt(t)!==undefined){ISt(t,null);throw new Error(`strictTemplatePolicy: dom-module ${t} re-registered`)}this.id=t;ISt(t,this);CSt(this)}}}ESt.prototype["modules"]=TSt;customElements.define("dom-module",ESt);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const OSt="link[rel=import][type~=css]";const LSt="include";const NSt="shady-unscoped";function RSt(t){return ESt.import(t)}function PSt(t){let e=t.body?t.body:t;const i=lSt(e.textContent,t.baseURI);const n=document.createElement("style");n.textContent=i;return n}function FSt(t){const e=t.trim().split(/\s+/);const i=[];for(let t=0;t<e.length;t++){i.push(...DSt(e[t]))}return i}function DSt(t){const e=RSt(t);if(!e){console.warn("Could not find style data in module named",t);return[]}if(e._styles===undefined){const t=[];t.push(...USt(e));const i=e.querySelector("template");if(i){t.push(...$St(i,e.assetpath))}e._styles=t}return e._styles}function $St(t,e){if(!t._styles){const i=[];const n=t.content.querySelectorAll("style");for(let t=0;t<n.length;t++){let s=n[t];let r=s.getAttribute(LSt);if(r){i.push(...FSt(r).filter((function(t,e,i){return i.indexOf(t)===e})))}if(e){s.textContent=lSt(s.textContent,e)}i.push(s)}t._styles=i}return t._styles}function zSt(t){let e=RSt(t);return e?USt(e):[]}function USt(t){const e=[];const i=t.querySelectorAll(OSt);for(let t=0;t<i.length;t++){let n=i[t];if(n.import){const t=n.import;const i=n.hasAttribute(NSt);if(i&&!t._unscopedStyle){const e=PSt(t);e.setAttribute(NSt,"");t._unscopedStyle=e}else if(!t._style){t._style=PSt(t)}e.push(i?t._unscopedStyle:t._style)}}return e}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const VSt=window["ShadyDOM"]&&window["ShadyDOM"]["noPatch"]&&window["ShadyDOM"]["wrap"]?window["ShadyDOM"]["wrap"]:window["ShadyDOM"]?t=>ShadyDOM["patch"](t):t=>t;
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function GSt(t){return t.indexOf(".")>=0}function BSt(t){let e=t.indexOf(".");if(e===-1){return t}return t.slice(0,e)}function qSt(t,e){return t.indexOf(e+".")===0}function HSt(t,e){return e.indexOf(t+".")===0}function WSt(t,e,i){return e+i.slice(t.length)}function ZSt(t){if(Array.isArray(t)){let e=[];for(let i=0;i<t.length;i++){let n=t[i].toString().split(".");for(let t=0;t<n.length;t++){e.push(n[t])}}return e.join(".")}else{return t}}function JSt(t){if(Array.isArray(t)){return ZSt(t).split(".")}return t.toString().split(".")}function KSt(t,e,i){let n=t;let s=JSt(e);for(let t=0;t<s.length;t++){if(!n){return}let e=s[t];n=n[e]}if(i){i.path=s.join(".")}return n}function YSt(t,e,i){let n=t;let s=JSt(e);let r=s[s.length-1];if(s.length>1){for(let t=0;t<s.length-1;t++){let e=s[t];n=n[e];if(!n){return}}n[r]=i}else{n[e]=i}return s.join(".")}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const QSt={};const XSt=/-[a-z]/g;const txt=/([A-Z])/g;function ext(t){return QSt[t]||(QSt[t]=t.indexOf("-")<0?t:t.replace(XSt,(t=>t[1].toUpperCase())))}function ixt(t){return QSt[t]||(QSt[t]=t.replace(txt,"-$1").toLowerCase())}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let nxt=0;let sxt=0;let rxt=[];let oxt=0;let axt=false;let lxt=document.createTextNode("");new window.MutationObserver(uxt).observe(lxt,{characterData:true});function uxt(){axt=false;const t=rxt.length;for(let e=0;e<t;e++){let t=rxt[e];if(t){try{t()}catch(t){setTimeout((()=>{throw t}))}}}rxt.splice(0,t);sxt+=t}const cxt={run(t){if(!axt){axt=true;lxt.textContent=oxt++}rxt.push(t);return nxt++},cancel(t){const e=t-sxt;if(e>=0){if(!rxt[e]){throw new Error("invalid async handle: "+t)}rxt[e]=null}}};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const hxt=cxt;const dxt=kSt((t=>{class e extends t{static createProperties(t){const e=this.prototype;for(let i in t){if(!(i in e)){e._createPropertyAccessor(i)}}}static attributeNameForProperty(t){return t.toLowerCase()}static typeForProperty(t){}_createPropertyAccessor(t,e){this._addPropertyToAttributeMap(t);if(!this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))){this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)}if(!this.__dataHasAccessor[t]){this.__dataHasAccessor[t]=true;this._definePropertyAccessor(t,e)}}_addPropertyToAttributeMap(t){if(!this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))){this.__dataAttributes=Object.assign({},this.__dataAttributes)}let e=this.__dataAttributes[t];if(!e){e=this.constructor.attributeNameForProperty(t);this.__dataAttributes[e]=t}return e}_definePropertyAccessor(t,e){Object.defineProperty(this,t,{get(){return this.__data[t]},set:e?function(){}:function(e){if(this._setPendingProperty(t,e,true)){this._invalidateProperties()}}})}constructor(){super();this.__dataEnabled=false;this.__dataReady=false;this.__dataInvalid=false;this.__data={};this.__dataPending=null;this.__dataOld=null;this.__dataInstanceProps=null;this.__dataCounter=0;this.__serializing=false;this._initializeProperties()}ready(){this.__dataReady=true;this._flushProperties()}_initializeProperties(){for(let t in this.__dataHasAccessor){if(this.hasOwnProperty(t)){this.__dataInstanceProps=this.__dataInstanceProps||{};this.__dataInstanceProps[t]=this[t];delete this[t]}}}_initializeInstanceProperties(t){Object.assign(this,t)}_setProperty(t,e){if(this._setPendingProperty(t,e)){this._invalidateProperties()}}_getProperty(t){return this.__data[t]}_setPendingProperty(t,e,i){let n=this.__data[t];let s=this._shouldPropertyChange(t,e,n);if(s){if(!this.__dataPending){this.__dataPending={};this.__dataOld={}}if(this.__dataOld&&!(t in this.__dataOld)){this.__dataOld[t]=n}this.__data[t]=e;this.__dataPending[t]=e}return s}_isPropertyPending(t){return!!(this.__dataPending&&this.__dataPending.hasOwnProperty(t))}_invalidateProperties(){if(!this.__dataInvalid&&this.__dataReady){this.__dataInvalid=true;hxt.run((()=>{if(this.__dataInvalid){this.__dataInvalid=false;this._flushProperties()}}))}}_enableProperties(){if(!this.__dataEnabled){this.__dataEnabled=true;if(this.__dataInstanceProps){this._initializeInstanceProperties(this.__dataInstanceProps);this.__dataInstanceProps=null}this.ready()}}_flushProperties(){this.__dataCounter++;const t=this.__data;const e=this.__dataPending;const i=this.__dataOld;if(this._shouldPropertiesChange(t,e,i)){this.__dataPending=null;this.__dataOld=null;this._propertiesChanged(t,e,i)}this.__dataCounter--}_shouldPropertiesChange(t,e,i){return Boolean(e)}_propertiesChanged(t,e,i){}_shouldPropertyChange(t,e,i){return i!==e&&(i===i||e===e)}attributeChangedCallback(t,e,i,n){if(e!==i){this._attributeToProperty(t,i)}if(super.attributeChangedCallback){super.attributeChangedCallback(t,e,i,n)}}_attributeToProperty(t,e,i){if(!this.__serializing){const n=this.__dataAttributes;const s=n&&n[t]||t;this[s]=this._deserializeValue(e,i||this.constructor.typeForProperty(s))}}_propertyToAttribute(t,e,i){this.__serializing=true;i=arguments.length<3?this[t]:i;this._valueToNodeAttribute(this,i,e||this.constructor.attributeNameForProperty(t));this.__serializing=false}_valueToNodeAttribute(t,e,i){const n=this._serializeValue(e);if(i==="class"||i==="name"||i==="slot"){t=VSt(t)}if(n===undefined){t.removeAttribute(i)}else{t.setAttribute(i,n===""&&window.trustedTypes?window.trustedTypes.emptyScript:n)}}_serializeValue(t){switch(typeof t){case"boolean":return t?"":undefined;default:return t!=null?t.toString():undefined}}_deserializeValue(t,e){switch(e){case Boolean:return t!==null;case Number:return Number(t);default:return t}}}return e}));
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const fxt={};let pxt=HTMLElement.prototype;while(pxt){let t=Object.getOwnPropertyNames(pxt);for(let e=0;e<t.length;e++){fxt[t[e]]=true}pxt=Object.getPrototypeOf(pxt)}const mxt=(()=>{if(!window.trustedTypes){return()=>false}return t=>trustedTypes.isHTML(t)||trustedTypes.isScript(t)||trustedTypes.isScriptURL(t)})();function yxt(t,e){if(!fxt[e]){let i=t[e];if(i!==undefined){if(t.__data){t._setPendingProperty(e,i)}else{if(!t.__dataProto){t.__dataProto={}}else if(!t.hasOwnProperty(JSCompiler_renameProperty("__dataProto",t))){t.__dataProto=Object.create(t.__dataProto)}t.__dataProto[e]=i}}}}const gxt=kSt((t=>{const e=dxt(t);class i extends e{static createPropertiesForAttributes(){let t=this.observedAttributes;for(let e=0;e<t.length;e++){this.prototype._createPropertyAccessor(ext(t[e]))}}static attributeNameForProperty(t){return ixt(t)}_initializeProperties(){if(this.__dataProto){this._initializeProtoProperties(this.__dataProto);this.__dataProto=null}super._initializeProperties()}_initializeProtoProperties(t){for(let e in t){this._setProperty(e,t[e])}}_ensureAttribute(t,e){const i=this;if(!i.hasAttribute(t)){this._valueToNodeAttribute(i,e,t)}}_serializeValue(t){switch(typeof t){case"object":if(t instanceof Date){return t.toString()}else if(t){if(mxt(t)){return t}try{return JSON.stringify(t)}catch(t){return""}}default:return super._serializeValue(t)}}_deserializeValue(t,e){let i;switch(e){case Object:try{i=JSON.parse(t)}catch(e){i=t}break;case Array:try{i=JSON.parse(t)}catch(e){i=null;console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${t}`)}break;case Date:i=isNaN(t)?String(t):Number(t);i=new Date(i);break;default:i=super._deserializeValue(t,e);break}return i}_definePropertyAccessor(t,e){yxt(this,t);super._definePropertyAccessor(t,e)}_hasAccessor(t){return this.__dataHasAccessor&&this.__dataHasAccessor[t]}_isPropertyPending(t){return Boolean(this.__dataPending&&t in this.__dataPending)}}return i}));
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const vxt={"dom-if":true,"dom-repeat":true};let wxt=false;let bxt=false;function Sxt(){if(!wxt){wxt=true;const t=document.createElement("textarea");t.placeholder="a";bxt=t.placeholder===t.textContent}return bxt}function xxt(t){if(Sxt()&&t.localName==="textarea"&&t.placeholder&&t.placeholder===t.textContent){t.textContent=null}}const _xt=(()=>{const t=window.trustedTypes&&window.trustedTypes.createPolicy("polymer-template-event-attribute-policy",{createScript:t=>t});return(e,i,n)=>{const s=i.getAttribute(n);if(t&&n.startsWith("on-")){e.setAttribute(n,t.createScript(s,n));return}e.setAttribute(n,s)}})();function Mxt(t){let e=t.getAttribute("is");if(e&&vxt[e]){let i=t;i.removeAttribute("is");t=i.ownerDocument.createElement(e);i.parentNode.replaceChild(t,i);t.appendChild(i);while(i.attributes.length){const{name:e}=i.attributes[0];_xt(t,i,e);i.removeAttribute(e)}}return t}function kxt(t,e){let i=e.parentInfo&&kxt(t,e.parentInfo);if(i){for(let t=i.firstChild,n=0;t;t=t.nextSibling){if(e.parentIndex===n++){return t}}}else{return t}}function Txt(t,e,i,n){if(n.id){e[n.id]=i}}function Axt(t,e,i){if(i.events&&i.events.length){for(let n=0,s=i.events,r;n<s.length&&(r=s[n]);n++){t._addMethodEventListenerToNode(e,r.name,r.value,t)}}}function Ixt(t,e,i,n){if(i.templateInfo){e._templateInfo=i.templateInfo;e._parentTemplateInfo=n}}function jxt(t,e,i){t=t._methodHost||t;let n=function(e){if(t[i]){t[i](e,e.detail)}else{console.warn("listener method `"+i+"` not defined")}};return n}const Cxt=kSt((t=>{class e extends t{static _parseTemplate(t,e){if(!t._templateInfo){let i=t._templateInfo={};i.nodeInfoList=[];i.nestedTemplate=Boolean(e);i.stripWhiteSpace=e&&e.stripWhiteSpace||t.hasAttribute&&t.hasAttribute("strip-whitespace");this._parseTemplateContent(t,i,{parent:null})}return t._templateInfo}static _parseTemplateContent(t,e,i){return this._parseTemplateNode(t.content,e,i)}static _parseTemplateNode(t,e,i){let n=false;let s=t;if(s.localName=="template"&&!s.hasAttribute("preserve-content")){n=this._parseTemplateNestedTemplate(s,e,i)||n}else if(s.localName==="slot"){e.hasInsertionPoint=true}xxt(s);if(s.firstChild){this._parseTemplateChildNodes(s,e,i)}if(s.hasAttributes&&s.hasAttributes()){n=this._parseTemplateNodeAttributes(s,e,i)||n}return n||i.noted}static _parseTemplateChildNodes(t,e,i){if(t.localName==="script"||t.localName==="style"){return}for(let n=t.firstChild,s=0,r;n;n=r){if(n.localName=="template"){n=Mxt(n)}r=n.nextSibling;if(n.nodeType===Node.TEXT_NODE){let i=r;while(i&&i.nodeType===Node.TEXT_NODE){n.textContent+=i.textContent;r=i.nextSibling;t.removeChild(i);i=r}if(e.stripWhiteSpace&&!n.textContent.trim()){t.removeChild(n);continue}}let o={parentIndex:s,parentInfo:i};if(this._parseTemplateNode(n,e,o)){o.infoIndex=e.nodeInfoList.push(o)-1}if(n.parentNode){s++}}}static _parseTemplateNestedTemplate(t,e,i){let n=t;let s=this._parseTemplate(n,e);let r=s.content=n.content.ownerDocument.createDocumentFragment();r.appendChild(n.content);i.templateInfo=s;return true}static _parseTemplateNodeAttributes(t,e,i){let n=false;let s=Array.from(t.attributes);for(let r=s.length-1,o;o=s[r];r--){n=this._parseTemplateNodeAttribute(t,e,i,o.name,o.value)||n}return n}static _parseTemplateNodeAttribute(t,e,i,n,s){if(n.slice(0,3)==="on-"){t.removeAttribute(n);i.events=i.events||[];i.events.push({name:n.slice(3),value:s});return true}else if(n==="id"){i.id=s;return true}return false}static _contentForTemplate(t){let e=t._templateInfo;return e&&e.content||t.content}_stampTemplate(t,e){if(t&&!t.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate){HTMLTemplateElement.decorate(t)}e=e||this.constructor._parseTemplate(t);let i=e.nodeInfoList;let n=e.content||t.content;let s=document.importNode(n,true);s.__noInsertionPoint=!e.hasInsertionPoint;let r=s.nodeList=new Array(i.length);s.$={};for(let t=0,n=i.length,o;t<n&&(o=i[t]);t++){let i=r[t]=kxt(s,o);Txt(this,s.$,i,o);Ixt(this,i,o,e);Axt(this,i,o)}s=s;return s}_addMethodEventListenerToNode(t,e,i,n){n=n||t;let s=jxt(n,e,i);this._addEventListenerToNode(t,e,s);return s}_addEventListenerToNode(t,e,i){t.addEventListener(e,i)}_removeEventListenerFromNode(t,e,i){t.removeEventListener(e,i)}}return e}));
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */let Ext=0;const Oxt=[];const Lxt={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"};const Nxt="__computeInfo";const Rxt=/[A-Z]/;function Pxt(t,e,i){let n=t[e];if(!n){n=t[e]={}}else if(!t.hasOwnProperty(e)){n=t[e]=Object.create(t[e]);if(i){for(let t in n){let e=n[t];let i=n[t]=Array(e.length);for(let t=0;t<e.length;t++){i[t]=e[t]}}}}return n}function Fxt(t,e,i,n,s,r){if(e){let o=false;const a=Ext++;for(let l in i){let u=s?BSt(l):l;let c=e[u];if(c){for(let e=0,u=c.length,h;e<u&&(h=c[e]);e++){if((!h.info||h.info.lastRun!==a)&&(!s||$xt(l,h.trigger))){if(h.info){h.info.lastRun=a}h.fn(t,l,i,n,h.info,s,r);o=true}}}}return o}return false}function Dxt(t,e,i,n,s,r,o,a){let l=false;let u=o?BSt(n):n;let c=e[u];if(c){for(let e=0,u=c.length,h;e<u&&(h=c[e]);e++){if((!h.info||h.info.lastRun!==i)&&(!o||$xt(n,h.trigger))){if(h.info){h.info.lastRun=i}h.fn(t,n,s,r,h.info,o,a);l=true}}}return l}function $xt(t,e){if(e){let i=e.name;return i==t||!!(e.structured&&qSt(i,t))||!!(e.wildcard&&HSt(i,t))}else{return true}}function zxt(t,e,i,n,s){let r=typeof s.method==="string"?t[s.method]:s.method;let o=s.property;if(r){r.call(t,t.__data[o],n[o])}else if(!s.dynamicFn){console.warn("observer method `"+s.method+"` not defined")}}function Uxt(t,e,i,n,s){let r=t[Lxt.NOTIFY];let o;let a=Ext++;for(let l in e){if(e[l]){if(r&&Dxt(t,r,a,l,i,n,s)){o=true}else if(s&&Vxt(t,l,i)){o=true}}}let l;if(o&&(l=t.__dataHost)&&l._invalidateProperties){l._invalidateProperties()}}function Vxt(t,e,i){let n=BSt(e);if(n!==e){let s=ixt(n)+"-changed";Gxt(t,s,i[e],e);return true}return false}function Gxt(t,e,i,n){let s={value:i,queueProperty:true};if(n){s.path=n}VSt(t).dispatchEvent(new CustomEvent(e,{detail:s}))}function Bxt(t,e,i,n,s,r){let o=r?BSt(e):e;let a=o!=e?e:null;let l=a?KSt(t,a):t.__data[e];if(a&&l===undefined){l=i[e]}Gxt(t,s.eventName,l,a)}function qxt(t,e,i,n,s){let r;let o=t.detail;let a=o&&o.path;if(a){n=WSt(i,n,a);r=o&&o.value}else{r=t.currentTarget[i]}r=s?!r:r;if(!e[Lxt.READ_ONLY]||!e[Lxt.READ_ONLY][n]){if(e._setPendingPropertyOrPath(n,r,true,Boolean(a))&&(!o||!o.queueProperty)){e._invalidateProperties()}}}function Hxt(t,e,i,n,s){let r=t.__data[e];if(fSt){r=fSt(r,s.attrName,"attribute",t)}t._propertyToAttribute(e,s.attrName,r)}function Wxt(t,e,i,n){let s=t[Lxt.COMPUTE];if(s){if(bSt){Ext++;const r=Kxt(t);const o=[];for(let t in e){Jxt(t,s,o,r,n)}let a;while(a=o.shift()){if(Qxt(t,"",e,i,a)){Jxt(a.methodInfo,s,o,r,n)}}Object.assign(i,t.__dataOld);Object.assign(e,t.__dataPending);t.__dataPending=null}else{let r=e;while(Fxt(t,s,r,i,n)){Object.assign(i,t.__dataOld);Object.assign(e,t.__dataPending);r=t.__dataPending;t.__dataPending=null}}}}const Zxt=(t,e,i)=>{let n=0;let s=e.length-1;let r=-1;while(n<=s){const o=n+s>>1;const a=i.get(e[o].methodInfo)-i.get(t.methodInfo);if(a<0){n=o+1}else if(a>0){s=o-1}else{r=o;break}}if(r<0){r=s+1}e.splice(r,0,t)};const Jxt=(t,e,i,n,s)=>{const r=s?BSt(t):t;const o=e[r];if(o){for(let e=0;e<o.length;e++){const r=o[e];if(r.info.lastRun!==Ext&&(!s||$xt(t,r.trigger))){r.info.lastRun=Ext;Zxt(r.info,i,n)}}}};function Kxt(t){let e=t.constructor.__orderedComputedDeps;if(!e){e=new Map;const i=t[Lxt.COMPUTE];let{counts:n,ready:s,total:r}=Yxt(t);let o;while(o=s.shift()){e.set(o,e.size);const t=i[o];if(t){t.forEach((t=>{const e=t.info.methodInfo;--r;if(--n[e]===0){s.push(e)}}))}}if(r!==0){const e=t;console.warn(`Computed graph for ${e.localName} incomplete; circular?`)}t.constructor.__orderedComputedDeps=e}return e}function Yxt(t){const e=t[Nxt];const i={};const n=t[Lxt.COMPUTE];const s=[];let r=0;for(let t in e){const n=e[t];r+=i[t]=n.args.filter((t=>!t.literal)).length+(n.dynamicFn?1:0)}for(let t in n){if(!e[t]){s.push(t)}}return{counts:i,ready:s,total:r}}function Qxt(t,e,i,n,s){let r=c_t(t,e,i,n,s);if(r===Oxt){return false}let o=s.methodInfo;if(t.__dataHasAccessor&&t.__dataHasAccessor[o]){return t._setPendingProperty(o,r,true)}else{t[o]=r;return false}}function Xxt(t,e,i){let n=t.__dataLinkedPaths;if(n){let s;for(let r in n){let o=n[r];if(HSt(r,e)){s=WSt(r,o,e);t._setPendingPropertyOrPath(s,i,true,true)}else if(HSt(o,e)){s=WSt(o,r,e);t._setPendingPropertyOrPath(s,i,true,true)}}}}function t_t(t,e,i,n,s,r,o){i.bindings=i.bindings||[];let a={kind:n,target:s,parts:r,literal:o,isCompound:r.length!==1};i.bindings.push(a);if(r_t(a)){let{event:t,negate:e}=a.parts[0];a.listenerEvent=t||ixt(s)+"-changed";a.listenerNegate=e}let l=e.nodeInfoList.length;for(let i=0;i<a.parts.length;i++){let n=a.parts[i];n.compoundIndex=i;e_t(t,e,a,n,l)}}function e_t(t,e,i,n,s){if(!n.literal){if(i.kind==="attribute"&&i.target[0]==="-"){console.warn("Cannot set attribute "+i.target+' because "-" is not a valid attribute starting character')}else{let r=n.dependencies;let o={index:s,binding:i,part:n,evaluator:t};for(let i=0;i<r.length;i++){let n=r[i];if(typeof n=="string"){n=j_t(n);n.wildcard=true}t._addTemplatePropertyEffect(e,n.rootProperty,{fn:i_t,info:o,trigger:n})}}}}function i_t(t,e,i,n,s,r,o){let a=o[s.index];let l=s.binding;let u=s.part;if(r&&u.source&&e.length>u.source.length&&l.kind=="property"&&!l.isCompound&&a.__isPropertyEffectsClient&&a.__dataHasAccessor&&a.__dataHasAccessor[l.target]){let n=i[e];e=WSt(u.source,l.target,e);if(a._setPendingPropertyOrPath(e,n,false,true)){t._enqueueClient(a)}}else{let o=s.evaluator._evaluateBinding(t,u,e,i,n,r);if(o!==Oxt){n_t(t,a,l,u,o)}}}function n_t(t,e,i,n,s){s=s_t(e,s,i,n);if(fSt){s=fSt(s,i.target,i.kind,e)}if(i.kind=="attribute"){t._valueToNodeAttribute(e,s,i.target)}else{let n=i.target;if(e.__isPropertyEffectsClient&&e.__dataHasAccessor&&e.__dataHasAccessor[n]){if(!e[Lxt.READ_ONLY]||!e[Lxt.READ_ONLY][n]){if(e._setPendingProperty(n,s)){t._enqueueClient(e)}}}else{t._setUnmanagedPropertyToNode(e,n,s)}}}function s_t(t,e,i,n){if(i.isCompound){let s=t.__dataCompoundStorage[i.target];s[n.compoundIndex]=e;e=s.join("")}if(i.kind!=="attribute"){if(i.target==="textContent"||i.target==="value"&&(t.localName==="input"||t.localName==="textarea")){e=e==undefined?"":e}}return e}function r_t(t){return Boolean(t.target)&&t.kind!="attribute"&&t.kind!="text"&&!t.isCompound&&t.parts[0].mode==="{"}function o_t(t,e){let{nodeList:i,nodeInfoList:n}=e;if(n.length){for(let e=0;e<n.length;e++){let s=n[e];let r=i[e];let o=s.bindings;if(o){for(let e=0;e<o.length;e++){let i=o[e];a_t(r,i);l_t(r,t,i)}}r.__dataHost=t}}}function a_t(t,e){if(e.isCompound){let i=t.__dataCompoundStorage||(t.__dataCompoundStorage={});let n=e.parts;let s=new Array(n.length);for(let t=0;t<n.length;t++){s[t]=n[t].literal}let r=e.target;i[r]=s;if(e.literal&&e.kind=="property"){if(r==="className"){t=VSt(t)}t[r]=e.literal}}}function l_t(t,e,i){if(i.listenerEvent){let n=i.parts[0];t.addEventListener(i.listenerEvent,(function(t){qxt(t,e,i.target,n.source,n.negate)}))}}function u_t(t,e,i,n,s,r){r=e.static||r&&(typeof r!=="object"||r[e.methodName]);let o={methodName:e.methodName,args:e.args,methodInfo:s,dynamicFn:r};for(let s=0,r;s<e.args.length&&(r=e.args[s]);s++){if(!r.literal){t._addPropertyEffect(r.rootProperty,i,{fn:n,info:o,trigger:r})}}if(r){t._addPropertyEffect(e.methodName,i,{fn:n,info:o})}return o}function c_t(t,e,i,n,s){let r=t._methodHost||t;let o=r[s.methodName];if(o){let n=t._marshalArgs(s.args,e,i);return n===Oxt?Oxt:o.apply(r,n)}else if(!s.dynamicFn){console.warn("method `"+s.methodName+"` not defined")}}const h_t=[];const d_t="(?:"+"[a-zA-Z_$][\\w.:$\\-*]*"+")";const f_t="(?:"+"[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?"+")";const p_t="(?:"+"'(?:[^'\\\\]|\\\\.)*'"+")";const m_t="(?:"+'"(?:[^"\\\\]|\\\\.)*"'+")";const y_t="(?:"+p_t+"|"+m_t+")";const g_t="(?:("+d_t+"|"+f_t+"|"+y_t+")\\s*"+")";const v_t="(?:"+g_t+"(?:,\\s*"+g_t+")*"+")";const w_t="(?:"+"\\(\\s*"+"(?:"+v_t+"?"+")"+"\\)\\s*"+")";const b_t="("+d_t+"\\s*"+w_t+"?"+")";const S_t="(\\[\\[|{{)"+"\\s*";const x_t="(?:]]|}})";const __t="(?:(!)\\s*)?";const M_t=S_t+__t+b_t+x_t;const k_t=new RegExp(M_t,"g");function T_t(t){let e="";for(let i=0;i<t.length;i++){let n=t[i].literal;e+=n||""}return e}function A_t(t){let e=t.match(/([^\s]+?)\(([\s\S]*)\)/);if(e){let t=e[1];let i={methodName:t,static:true,args:h_t};if(e[2].trim()){let t=e[2].replace(/\\,/g,"&comma;").split(",");return I_t(t,i)}else{return i}}return null}function I_t(t,e){e.args=t.map((function(t){let i=j_t(t);if(!i.literal){e.static=false}return i}),this);return e}function j_t(t){let e=t.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1");let i={name:e,value:"",literal:false};let n=e[0];if(n==="-"){n=e[1]}if(n>="0"&&n<="9"){n="#"}switch(n){case"'":case'"':i.value=e.slice(1,-1);i.literal=true;break;case"#":i.value=Number(e);i.literal=true;break}if(!i.literal){i.rootProperty=BSt(e);i.structured=GSt(e);if(i.structured){i.wildcard=e.slice(-2)==".*";if(i.wildcard){i.name=e.slice(0,-2)}}}return i}function C_t(t,e,i){let n=KSt(t,i);if(n===undefined){n=e[i]}return n}function E_t(t,e,i,n){const s={indexSplices:n};if(wSt&&!t._overrideLegacyUndefined){e.splices=s}t.notifyPath(i+".splices",s);t.notifyPath(i+".length",e.length);if(wSt&&!t._overrideLegacyUndefined){s.indexSplices=[]}}function O_t(t,e,i,n,s,r){E_t(t,e,i,[{index:n,addedCount:s,removed:r,object:e,type:"splice"}])}function L_t(t){return t[0].toUpperCase()+t.substring(1)}const N_t=kSt((t=>{const e=Cxt(gxt(t));class i extends e{constructor(){super();this.__isPropertyEffectsClient=true}get PROPERTY_EFFECT_TYPES(){return Lxt}_initializeProperties(){super._initializeProperties();this._registerHost();this.__dataClientsReady=false;this.__dataPendingClients=null;this.__dataToNotify=null;this.__dataLinkedPaths=null;this.__dataHasPaths=false;this.__dataCompoundStorage=this.__dataCompoundStorage||null;this.__dataHost=this.__dataHost||null;this.__dataTemp={};this.__dataClientsInitialized=false}_registerHost(){if(R_t.length){let t=R_t[R_t.length-1];t._enqueueClient(this);this.__dataHost=t}}_initializeProtoProperties(t){this.__data=Object.create(t);this.__dataPending=Object.create(t);this.__dataOld={}}_initializeInstanceProperties(t){let e=this[Lxt.READ_ONLY];for(let i in t){if(!e||!e[i]){this.__dataPending=this.__dataPending||{};this.__dataOld=this.__dataOld||{};this.__data[i]=this.__dataPending[i]=t[i]}}}_addPropertyEffect(t,e,i){this._createPropertyAccessor(t,e==Lxt.READ_ONLY);let n=Pxt(this,e,true)[t];if(!n){n=this[e][t]=[]}n.push(i)}_removePropertyEffect(t,e,i){let n=Pxt(this,e,true)[t];let s=n.indexOf(i);if(s>=0){n.splice(s,1)}}_hasPropertyEffect(t,e){let i=this[e];return Boolean(i&&i[t])}_hasReadOnlyEffect(t){return this._hasPropertyEffect(t,Lxt.READ_ONLY)}_hasNotifyEffect(t){return this._hasPropertyEffect(t,Lxt.NOTIFY)}_hasReflectEffect(t){return this._hasPropertyEffect(t,Lxt.REFLECT)}_hasComputedEffect(t){return this._hasPropertyEffect(t,Lxt.COMPUTE)}_setPendingPropertyOrPath(t,e,i,n){if(n||BSt(Array.isArray(t)?t[0]:t)!==t){if(!n){let i=KSt(this,t);t=YSt(this,t,e);if(!t||!super._shouldPropertyChange(t,e,i)){return false}}this.__dataHasPaths=true;if(this._setPendingProperty(t,e,i)){Xxt(this,t,e);return true}}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[t]){return this._setPendingProperty(t,e,i)}else{this[t]=e}}return false}_setUnmanagedPropertyToNode(t,e,i){if(i!==t[e]||typeof i=="object"){if(e==="className"){t=VSt(t)}t[e]=i}}_setPendingProperty(t,e,i){let n=this.__dataHasPaths&&GSt(t);let s=n?this.__dataTemp:this.__data;if(this._shouldPropertyChange(t,e,s[t])){if(!this.__dataPending){this.__dataPending={};this.__dataOld={}}if(!(t in this.__dataOld)){this.__dataOld[t]=this.__data[t]}if(n){this.__dataTemp[t]=e}else{this.__data[t]=e}this.__dataPending[t]=e;if(n||this[Lxt.NOTIFY]&&this[Lxt.NOTIFY][t]){this.__dataToNotify=this.__dataToNotify||{};this.__dataToNotify[t]=i}return true}return false}_setProperty(t,e){if(this._setPendingProperty(t,e,true)){this._invalidateProperties()}}_invalidateProperties(){if(this.__dataReady){this._flushProperties()}}_enqueueClient(t){this.__dataPendingClients=this.__dataPendingClients||[];if(t!==this){this.__dataPendingClients.push(t)}}_flushClients(){if(!this.__dataClientsReady){this.__dataClientsReady=true;this._readyClients();this.__dataReady=true}else{this.__enableOrFlushClients()}}__enableOrFlushClients(){let t=this.__dataPendingClients;if(t){this.__dataPendingClients=null;for(let e=0;e<t.length;e++){let i=t[e];if(!i.__dataEnabled){i._enableProperties()}else if(i.__dataPending){i._flushProperties()}}}}_readyClients(){this.__enableOrFlushClients()}setProperties(t,e){for(let i in t){if(e||!this[Lxt.READ_ONLY]||!this[Lxt.READ_ONLY][i]){this._setPendingPropertyOrPath(i,t[i],true)}}this._invalidateProperties()}ready(){this._flushProperties();if(!this.__dataClientsReady){this._flushClients()}if(this.__dataPending){this._flushProperties()}}_propertiesChanged(t,e,i){let n=this.__dataHasPaths;this.__dataHasPaths=false;let s;Wxt(this,e,i,n);s=this.__dataToNotify;this.__dataToNotify=null;this._propagatePropertyChanges(e,i,n);this._flushClients();Fxt(this,this[Lxt.REFLECT],e,i,n);Fxt(this,this[Lxt.OBSERVE],e,i,n);if(s){Uxt(this,s,e,i,n)}if(this.__dataCounter==1){this.__dataTemp={}}}_propagatePropertyChanges(t,e,i){if(this[Lxt.PROPAGATE]){Fxt(this,this[Lxt.PROPAGATE],t,e,i)}if(this.__templateInfo){this._runEffectsForTemplate(this.__templateInfo,t,e,i)}}_runEffectsForTemplate(t,e,i,n){const s=(e,n)=>{Fxt(this,t.propertyEffects,e,i,n,t.nodeList);for(let s=t.firstChild;s;s=s.nextSibling){this._runEffectsForTemplate(s,e,i,n)}};if(t.runEffects){t.runEffects(s,e,n)}else{s(e,n)}}linkPaths(t,e){t=ZSt(t);e=ZSt(e);this.__dataLinkedPaths=this.__dataLinkedPaths||{};this.__dataLinkedPaths[t]=e}unlinkPaths(t){t=ZSt(t);if(this.__dataLinkedPaths){delete this.__dataLinkedPaths[t]}}notifySplices(t,e){let i={path:""};let n=KSt(this,t,i);E_t(this,n,i.path,e)}get(t,e){return KSt(e||this,t)}set(t,e,i){if(i){YSt(i,t,e)}else{if(!this[Lxt.READ_ONLY]||!this[Lxt.READ_ONLY][t]){if(this._setPendingPropertyOrPath(t,e,true)){this._invalidateProperties()}}}}push(t,...e){let i={path:""};let n=KSt(this,t,i);let s=n.length;let r=n.push(...e);if(e.length){O_t(this,n,i.path,s,e.length,[])}return r}pop(t){let e={path:""};let i=KSt(this,t,e);let n=Boolean(i.length);let s=i.pop();if(n){O_t(this,i,e.path,i.length,0,[s])}return s}splice(t,e,i,...n){let s={path:""};let r=KSt(this,t,s);if(e<0){e=r.length-Math.floor(-e)}else if(e){e=Math.floor(e)}let o;if(arguments.length===2){o=r.splice(e)}else{o=r.splice(e,i,...n)}if(n.length||o.length){O_t(this,r,s.path,e,n.length,o)}return o}shift(t){let e={path:""};let i=KSt(this,t,e);let n=Boolean(i.length);let s=i.shift();if(n){O_t(this,i,e.path,0,0,[s])}return s}unshift(t,...e){let i={path:""};let n=KSt(this,t,i);let s=n.unshift(...e);if(e.length){O_t(this,n,i.path,0,e.length,[])}return s}notifyPath(t,e){let i;if(arguments.length==1){let n={path:""};e=KSt(this,t,n);i=n.path}else if(Array.isArray(t)){i=ZSt(t)}else{i=t}if(this._setPendingPropertyOrPath(i,e,true,true)){this._invalidateProperties()}}_createReadOnlyProperty(t,e){this._addPropertyEffect(t,Lxt.READ_ONLY);if(e){this["_set"+L_t(t)]=function(e){this._setProperty(t,e)}}}_createPropertyObserver(t,e,i){let n={property:t,method:e,dynamicFn:Boolean(i)};this._addPropertyEffect(t,Lxt.OBSERVE,{fn:zxt,info:n,trigger:{name:t}});if(i){this._addPropertyEffect(e,Lxt.OBSERVE,{fn:zxt,info:n,trigger:{name:e}})}}_createMethodObserver(t,e){let i=A_t(t);if(!i){throw new Error("Malformed observer expression '"+t+"'")}u_t(this,i,Lxt.OBSERVE,c_t,null,e)}_createNotifyingProperty(t){this._addPropertyEffect(t,Lxt.NOTIFY,{fn:Bxt,info:{eventName:ixt(t)+"-changed",property:t}})}_createReflectedProperty(t){let e=this.constructor.attributeNameForProperty(t);if(e[0]==="-"){console.warn("Property "+t+" cannot be reflected to attribute "+e+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.')}else{this._addPropertyEffect(t,Lxt.REFLECT,{fn:Hxt,info:{attrName:e}})}}_createComputedProperty(t,e,i){let n=A_t(e);if(!n){throw new Error("Malformed computed expression '"+e+"'")}const s=u_t(this,n,Lxt.COMPUTE,Qxt,t,i);Pxt(this,Nxt)[t]=s}_marshalArgs(t,e,i){const n=this.__data;const s=[];for(let r=0,o=t.length;r<o;r++){let{name:o,structured:a,wildcard:l,value:u,literal:c}=t[r];if(!c){if(l){const t=HSt(o,e);const s=C_t(n,i,t?e:o);u={path:t?e:o,value:s,base:t?KSt(n,o):s}}else{u=a?C_t(n,i,o):n[o]}}if(wSt&&!this._overrideLegacyUndefined&&u===undefined&&t.length>1){return Oxt}s[r]=u}return s}static addPropertyEffect(t,e,i){this.prototype._addPropertyEffect(t,e,i)}static createPropertyObserver(t,e,i){this.prototype._createPropertyObserver(t,e,i)}static createMethodObserver(t,e){this.prototype._createMethodObserver(t,e)}static createNotifyingProperty(t){this.prototype._createNotifyingProperty(t)}static createReadOnlyProperty(t,e){this.prototype._createReadOnlyProperty(t,e)}static createReflectedProperty(t){this.prototype._createReflectedProperty(t)}static createComputedProperty(t,e,i){this.prototype._createComputedProperty(t,e,i)}static bindTemplate(t){return this.prototype._bindTemplate(t)}_bindTemplate(t,e){let i=this.constructor._parseTemplate(t);let n=this.__preBoundTemplateInfo==i;if(!n){for(let t in i.propertyEffects){this._createPropertyAccessor(t)}}if(e){i=Object.create(i);i.wasPreBound=n;if(!this.__templateInfo){this.__templateInfo=i}else{const e=t._parentTemplateInfo||this.__templateInfo;const n=e.lastChild;i.parent=e;e.lastChild=i;i.previousSibling=n;if(n){n.nextSibling=i}else{e.firstChild=i}}}else{this.__preBoundTemplateInfo=i}return i}static _addTemplatePropertyEffect(t,e,i){let n=t.hostProps=t.hostProps||{};n[e]=true;let s=t.propertyEffects=t.propertyEffects||{};let r=s[e]=s[e]||[];r.push(i)}_stampTemplate(t,e){e=e||this._bindTemplate(t,true);R_t.push(this);let i=super._stampTemplate(t,e);R_t.pop();e.nodeList=i.nodeList;if(!e.wasPreBound){let t=e.childNodes=[];for(let e=i.firstChild;e;e=e.nextSibling){t.push(e)}}i.templateInfo=e;o_t(this,e);if(this.__dataClientsReady){this._runEffectsForTemplate(e,this.__data,null,false);this._flushClients()}return i}_removeBoundDom(t){const e=t.templateInfo;const{previousSibling:i,nextSibling:n,parent:s}=e;if(i){i.nextSibling=n}else if(s){s.firstChild=n}if(n){n.previousSibling=i}else if(s){s.lastChild=i}e.nextSibling=e.previousSibling=null;let r=e.childNodes;for(let t=0;t<r.length;t++){let e=r[t];VSt(VSt(e).parentNode).removeChild(e)}}static _parseTemplateNode(t,i,n){let s=e._parseTemplateNode.call(this,t,i,n);if(t.nodeType===Node.TEXT_NODE){let e=this._parseBindings(t.textContent,i);if(e){t.textContent=T_t(e)||" ";t_t(this,i,n,"text","textContent",e);s=true}}return s}static _parseTemplateNodeAttribute(t,i,n,s,r){let o=this._parseBindings(r,i);if(o){let e=s;let r="property";if(Rxt.test(s)){r="attribute"}else if(s[s.length-1]=="$"){s=s.slice(0,-1);r="attribute"}let a=T_t(o);if(a&&r=="attribute"){if(s=="class"&&t.hasAttribute("class")){a+=" "+t.getAttribute(s)}t.setAttribute(s,a)}if(r=="attribute"&&e=="disable-upgrade$"){t.setAttribute(s,"")}if(t.localName==="input"&&e==="value"){t.setAttribute(e,"")}t.removeAttribute(e);if(r==="property"){s=ext(s)}t_t(this,i,n,r,s,o,a);return true}else{return e._parseTemplateNodeAttribute.call(this,t,i,n,s,r)}}static _parseTemplateNestedTemplate(t,i,n){let s=e._parseTemplateNestedTemplate.call(this,t,i,n);const r=t.parentNode;const o=n.templateInfo;const a=r.localName==="dom-if";const l=r.localName==="dom-repeat";if(SSt&&(a||l)){r.removeChild(t);n=n.parentInfo;n.templateInfo=o;n.noted=true;s=false}let u=o.hostProps;if(xSt&&a){if(u){i.hostProps=Object.assign(i.hostProps||{},u);if(!SSt){n.parentInfo.noted=true}}}else{let t="{";for(let e in u){let s=[{mode:t,source:e,dependencies:[e],hostProp:true}];t_t(this,i,n,"property","_host_"+e,s)}}return s}static _parseBindings(t,e){let i=[];let n=0;let s;while((s=k_t.exec(t))!==null){if(s.index>n){i.push({literal:t.slice(n,s.index)})}let r=s[1][0];let o=Boolean(s[2]);let a=s[3].trim();let l=false,u="",c=-1;if(r=="{"&&(c=a.indexOf("::"))>0){u=a.substring(c+2);a=a.substring(0,c);l=true}let h=A_t(a);let d=[];if(h){let{args:t,methodName:i}=h;for(let e=0;e<t.length;e++){let i=t[e];if(!i.literal){d.push(i)}}let n=e.dynamicFns;if(n&&n[i]||h.static){d.push(i);h.dynamicFn=true}}else{d.push(a)}i.push({source:a,mode:r,negate:o,customEvent:l,signature:h,dependencies:d,event:u});n=k_t.lastIndex}if(n&&n<t.length){let e=t.substring(n);if(e){i.push({literal:e})}}if(i.length){return i}else{return null}}static _evaluateBinding(t,e,i,n,s,r){let o;if(e.signature){o=c_t(t,i,n,s,e.signature)}else if(i!=e.source){o=KSt(t,e.source)}else{if(r&&GSt(i)){o=KSt(t,i)}else{o=t.__data[i]}}if(e.negate){o=!o}return o}}return i}));const R_t=[];
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function P_t(t){const e={};for(let i in t){const n=t[i];e[i]=typeof n==="function"?{type:n}:n}return e}const F_t=kSt((t=>{const e=dxt(t);function i(t){const e=Object.getPrototypeOf(t);return e.prototype instanceof s?e:null}function n(t){if(!t.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",t))){let e=null;if(t.hasOwnProperty(JSCompiler_renameProperty("properties",t))){const i=t.properties;if(i){e=P_t(i)}}t.__ownProperties=e}return t.__ownProperties}class s extends e{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){const t=this._properties;this.__observedAttributes=t?Object.keys(t).map((t=>this.prototype._addPropertyToAttributeMap(t))):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const t=i(this);if(t){t.finalize()}this.__finalized=true;this._finalizeClass()}}static _finalizeClass(){const t=n(this);if(t){this.createProperties(t)}}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const t=i(this);this.__properties=Object.assign({},t&&t._properties,n(this))}return this.__properties}static typeForProperty(t){const e=this._properties[t];return e&&e.type}_initializeProperties(){this.constructor.finalize();super._initializeProperties()}connectedCallback(){if(super.connectedCallback){super.connectedCallback()}this._enableProperties()}disconnectedCallback(){if(super.disconnectedCallback){super.disconnectedCallback()}}}return s}));
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */const D_t="3.5.1";const $_t=window.ShadyCSS&&window.ShadyCSS["cssBuild"];const z_t=kSt((t=>{const e=F_t(N_t(t));function i(t){if(!t.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",t))){t.__propertyDefaults=null;let e=t._properties;for(let i in e){let n=e[i];if("value"in n){t.__propertyDefaults=t.__propertyDefaults||{};t.__propertyDefaults[i]=n}}}return t.__propertyDefaults}function n(t){if(!t.hasOwnProperty(JSCompiler_renameProperty("__ownObservers",t))){t.__ownObservers=t.hasOwnProperty(JSCompiler_renameProperty("observers",t))?t.observers:null}return t.__ownObservers}function s(t,e,i,n){if(i.computed){i.readOnly=true}if(i.computed){if(t._hasReadOnlyEffect(e)){console.warn(`Cannot redefine computed property '${e}'.`)}else{t._createComputedProperty(e,i.computed,n)}}if(i.readOnly&&!t._hasReadOnlyEffect(e)){t._createReadOnlyProperty(e,!i.computed)}else if(i.readOnly===false&&t._hasReadOnlyEffect(e)){console.warn(`Cannot make readOnly property '${e}' non-readOnly.`)}if(i.reflectToAttribute&&!t._hasReflectEffect(e)){t._createReflectedProperty(e)}else if(i.reflectToAttribute===false&&t._hasReflectEffect(e)){console.warn(`Cannot make reflected property '${e}' non-reflected.`)}if(i.notify&&!t._hasNotifyEffect(e)){t._createNotifyingProperty(e)}else if(i.notify===false&&t._hasNotifyEffect(e)){console.warn(`Cannot make notify property '${e}' non-notify.`)}if(i.observer){t._createPropertyObserver(e,i.observer,n[i.observer])}t._addPropertyToAttributeMap(e)}function r(t,e,i,n){if(!$_t){const s=e.content.querySelectorAll("style");const r=$St(e);const o=zSt(i);const a=e.content.firstElementChild;for(let i=0;i<o.length;i++){let s=o[i];s.textContent=t._processStyleText(s.textContent,n);e.content.insertBefore(s,a)}let l=0;for(let e=0;e<r.length;e++){let i=r[e];let o=s[l];if(o!==i){i=i.cloneNode(true);o.parentNode.insertBefore(i,o)}else{l++}i.textContent=t._processStyleText(i.textContent,n)}}if(window.ShadyCSS){window.ShadyCSS.prepareTemplate(e,i)}if(_St&&$_t&&hSt){const i=e.content.querySelectorAll("style");if(i){let e="";Array.from(i).forEach((t=>{e+=t.textContent;t.parentNode.removeChild(t)}));t._styleSheet=new CSSStyleSheet;t._styleSheet.replaceSync(e)}}}function o(t){let e=null;if(t&&(!pSt||mSt)){e=ESt.import(t,"template");if(pSt&&!e){throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${t}`)}}return e}class a extends e{static get polymerElementVersion(){return D_t}static _finalizeClass(){e._finalizeClass.call(this);const t=n(this);if(t){this.createObservers(t,this._properties)}this._prepareTemplate()}static _prepareTemplate(){let t=this.template;if(t){if(typeof t==="string"){console.error("template getter must return HTMLTemplateElement");t=null}else if(!ySt){t=t.cloneNode(true)}}this.prototype._template=t}static createProperties(t){for(let e in t){s(this.prototype,e,t[e],t)}}static createObservers(t,e){const i=this.prototype;for(let n=0;n<t.length;n++){i._createMethodObserver(t[n],e)}}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){let t=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:undefined;if(typeof t==="function"){t=t()}this._template=t!==undefined?t:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&o(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(t){this._template=t}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const t=this.importMeta;if(t){this._importPath=uSt(t.url)}else{const t=ESt.import(this.is);this._importPath=t&&t.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super()}_initializeProperties(){this.constructor.finalize();this.constructor._finalizeTemplate(this.localName);super._initializeProperties();this.rootPath=dSt;this.importPath=this.constructor.importPath;let t=i(this.constructor);if(!t){return}for(let e in t){let i=t[e];if(this._canApplyPropertyDefault(e)){let t=typeof i.value=="function"?i.value.call(this):i.value;if(this._hasAccessor(e)){this._setPendingProperty(e,t,true)}else{this[e]=t}}}}_canApplyPropertyDefault(t){return!this.hasOwnProperty(t)}static _processStyleText(t,e){return lSt(t,e)}static _finalizeTemplate(t){const e=this.prototype._template;if(e&&!e.__polymerFinalized){e.__polymerFinalized=true;const i=this.importPath;const n=i?aSt(i):"";r(this,e,t,n);this.prototype._bindTemplate(e)}}connectedCallback(){if(window.ShadyCSS&&this._template){window.ShadyCSS.styleElement(this)}super.connectedCallback()}ready(){if(this._template){this.root=this._stampTemplate(this._template);this.$=this.root.$}super.ready()}_readyClients(){if(this._template){this.root=this._attachDom(this.root)}super._readyClients()}_attachDom(t){const e=VSt(this);if(e.attachShadow){if(t){if(!e.shadowRoot){e.attachShadow({mode:"open",shadyUpgradeFragment:t});e.shadowRoot.appendChild(t);if(this.constructor._styleSheet){e.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet]}}if(vSt&&window.ShadyDOM){window.ShadyDOM.flushInitial(e.shadowRoot)}return e.shadowRoot}return null}else{throw new Error("ShadowDOM not available. "+"PolymerElement can create dom as children instead of in "+"ShadowDOM by setting `this.root = this;` before `ready`.")}}updateStyles(t){if(window.ShadyCSS){window.ShadyCSS.styleSubtree(this,t)}}resolveUrl(t,e){if(!e&&this.importPath){e=aSt(this.importPath)}return aSt(t,e)}static _parseTemplateContent(t,i,n){i.dynamicFns=i.dynamicFns||this._properties;return e._parseTemplateContent.call(this,t,i,n)}static _addTemplatePropertyEffect(t,i,n){if(gSt&&!(i in this._properties)&&!(n.info.part.signature&&n.info.part.signature.static)&&!n.info.part.hostProp&&!t.nestedTemplate){console.warn(`Property '${i}' used in template but not declared in 'properties'; `+`attribute will not be observed.`)}return e._addTemplatePropertyEffect.call(this,t,i,n)}}return a}));
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const U_t=window.trustedTypes&&trustedTypes.createPolicy("polymer-html-literal",{createHTML:t=>t});class V_t{constructor(t,e){H_t(t,e);const i=e.reduce(((e,i,n)=>e+G_t(i)+t[n+1]),t[0]);this.value=i.toString()}toString(){return this.value}}function G_t(t){if(t instanceof V_t){return t.value}else{throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${t}`)}}function B_t(t){if(t instanceof HTMLTemplateElement){return t.innerHTML}else if(t instanceof V_t){return G_t(t)}else{throw new Error(`non-template value passed to Polymer's html function: ${t}`)}}const q_t=function t(e,...i){H_t(e,i);const n=document.createElement("template");let s=i.reduce(((t,i,n)=>t+B_t(i)+e[n+1]),e[0]);if(U_t){s=U_t.createHTML(s)}n.innerHTML=s;return n};const H_t=(t,e)=>{if(!Array.isArray(t)||!Array.isArray(t.raw)||e.length!==t.length-1){throw new TypeError("Invalid call to the html template tag")}};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const W_t=z_t(HTMLElement);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */let Z_t=0;let J_t=0;const K_t=[];let Y_t=false;function Q_t(){Y_t=false;const t=K_t.length;for(let e=0;e<t;e++){const t=K_t[e];if(t){try{t()}catch(t){setTimeout((()=>{throw t}))}}}K_t.splice(0,t);J_t+=t}const X_t={after(t){return{run(e){return window.setTimeout(e,t)},cancel(t){window.clearTimeout(t)}}},run(t,e){return window.setTimeout(t,e)},cancel(t){window.clearTimeout(t)}};const tMt={run(t){return window.requestAnimationFrame(t)},cancel(t){window.cancelAnimationFrame(t)}};const eMt={run(t){return window.requestIdleCallback?window.requestIdleCallback(t):window.setTimeout(t,16)},cancel(t){if(window.cancelIdleCallback){window.cancelIdleCallback(t)}else{window.clearTimeout(t)}}};const iMt={run(t){if(!Y_t){Y_t=true;queueMicrotask((()=>Q_t()))}K_t.push(t);const e=Z_t;Z_t+=1;return e},cancel(t){const e=t-J_t;if(e>=0){if(!K_t[e]){throw new Error(`invalid async handle: ${t}`)}K_t[e]=null}}};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const nMt=new Set;class sMt{static debounce(t,e,i){if(t instanceof sMt){t._cancelAsync()}else{t=new sMt}t.setConfig(e,i);return t}constructor(){this._asyncModule=null;this._callback=null;this._timer=null}setConfig(t,e){this._asyncModule=t;this._callback=e;this._timer=this._asyncModule.run((()=>{this._timer=null;nMt.delete(this);this._callback()}))}cancel(){if(this.isActive()){this._cancelAsync();nMt.delete(this)}}_cancelAsync(){if(this.isActive()){this._asyncModule.cancel(this._timer);this._timer=null}}flush(){if(this.isActive()){this.cancel();this._callback()}}isActive(){return this._timer!=null}}function rMt(t){nMt.add(t)}function oMt(){const t=Boolean(nMt.size);nMt.forEach((t=>{try{t.flush()}catch(t){setTimeout((()=>{throw t}))}}));return t}const aMt=()=>{let t;do{t=oMt()}while(t)};
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const lMt=[];function uMt(t,e,i=t.getAttribute("dir")){if(e){t.setAttribute("dir",e)}else if(i!=null){t.removeAttribute("dir")}}function cMt(){return document.documentElement.getAttribute("dir")}function hMt(){const t=cMt();lMt.forEach((e=>{uMt(e,t)}))}const dMt=new MutationObserver(hMt);dMt.observe(document.documentElement,{attributes:true,attributeFilter:["dir"]});const fMt=t=>class e extends t{static get properties(){return{dir:{type:String,value:"",reflectToAttribute:true,converter:{fromAttribute:t=>!t?"":t,toAttribute:t=>t===""?null:t}}}}get __isRTL(){return this.getAttribute("dir")==="rtl"}connectedCallback(){super.connectedCallback();if(!this.hasAttribute("dir")||this.__restoreSubscription){this.__subscribe();uMt(this,cMt(),null)}}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i);if(t!=="dir"){return}const n=cMt();const s=i===n&&lMt.indexOf(this)===-1;const r=!i&&e&&lMt.indexOf(this)===-1;const o=i!==n&&e===n;if(s||r){this.__subscribe();uMt(this,n,i)}else if(o){this.__unsubscribe()}}disconnectedCallback(){super.disconnectedCallback();this.__restoreSubscription=lMt.includes(this);this.__unsubscribe()}_valueToNodeAttribute(t,e,i){if(i==="dir"&&e===""&&!t.hasAttribute("dir")){return}super._valueToNodeAttribute(t,e,i)}_attributeToProperty(t,e,i){if(t==="dir"&&!e){this.dir=""}else{super._attributeToProperty(t,e,i)}}__subscribe(){if(!lMt.includes(this)){lMt.push(this)}}__unsubscribe(){if(lMt.includes(this)){lMt.splice(lMt.indexOf(this),1)}}}
/**
 * @license
 * Copyright (c) 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;function pMt(t,e){return t.split(".").reduce(((t,e)=>t?t[e]:undefined),e)}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function mMt(t){if(window.Vaadin&&window.Vaadin.templateRendererCallback){window.Vaadin.templateRendererCallback(t);return}if(t.querySelector("template")){console.warn(`WARNING: <template> inside <${t.localName}> is no longer supported. Import @vaadin/polymer-legacy-adapter/template-renderer.js to enable compatibility.`)}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function yMt(t,e){if(!e){return null}return e.closest(t)||yMt(t,e.getRootNode().host)}function gMt(t){if(!t){return new Set}return new Set(t.split(" "))}function vMt(t){return t?[...t].join(" "):""}function wMt(t,e,i){const n=gMt(t.getAttribute(e));n.add(i);t.setAttribute(e,vMt(n))}function bMt(t,e,i){const n=gMt(t.getAttribute(e));n.delete(i);if(n.size===0){t.removeAttribute(e);return}t.setAttribute(e,vMt(n))}function SMt(t){return t.nodeType===Node.TEXT_NODE&&t.textContent.trim()===""}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function xMt(t){return t.__cells||Array.from(t.querySelectorAll('[part~="cell"]:not([part~="details-cell"])'))}function _Mt(t,e){[...t.children].forEach(e)}function MMt(t,e){xMt(t).forEach(e);if(t.__detailsCell){e(t.__detailsCell)}}function kMt(t,e,i){let n=1;t.forEach((t=>{if(n%10===0){n+=1}t._order=i+n*e;n+=1}))}function TMt(t,e,i){switch(typeof i){case"boolean":t.toggleAttribute(e,i);break;case"string":t.setAttribute(e,i);break;default:t.removeAttribute(e);break}}function AMt(t,e,i){if(e||e===""){wMt(t,"part",i)}else{bMt(t,"part",i)}}function IMt(t,e,i){t.forEach((t=>{AMt(t,i,e)}))}function jMt(t,e){const i=xMt(t);Object.entries(e).forEach((([e,n])=>{TMt(t,e,n);const s=`${e}-row`;AMt(t,n,s);IMt(i,`${s}-cell`,n)}))}function CMt(t,e){const i=xMt(t);Object.entries(e).forEach((([e,n])=>{const s=t.getAttribute(e);TMt(t,e,n);if(s){const n=`${e}-${s}-row`;AMt(t,false,n);IMt(i,`${n}-cell`,false)}if(n){const s=`${e}-${n}-row`;AMt(t,n,s);IMt(i,`${s}-cell`,n)}}))}function EMt(t,e,i,n,s){TMt(t,e,i);if(s){AMt(t,false,s)}AMt(t,i,n||`${e}-cell`)}class OMt{constructor(t,e){this.__host=t;this.__callback=e;this.__currentSlots=[];this.__onMutation=this.__onMutation.bind(this);this.__observer=new MutationObserver(this.__onMutation);this.__observer.observe(t,{childList:true});this.__initialCallDebouncer=sMt.debounce(this.__initialCallDebouncer,iMt,(()=>this.__onMutation()))}disconnect(){this.__observer.disconnect();this.__initialCallDebouncer.cancel();this.__toggleSlotChangeListeners(false)}flush(){this.__onMutation()}__toggleSlotChangeListeners(t){this.__currentSlots.forEach((e=>{if(t){e.addEventListener("slotchange",this.__onMutation)}else{e.removeEventListener("slotchange",this.__onMutation)}}))}__onMutation(){const t=!this.__currentColumns;this.__currentColumns||=[];const e=OMt.getColumns(this.__host);const i=e.filter((t=>!this.__currentColumns.includes(t)));const n=this.__currentColumns.filter((t=>!e.includes(t)));const s=this.__currentColumns.some(((t,i)=>t!==e[i]));this.__currentColumns=e;this.__toggleSlotChangeListeners(false);this.__currentSlots=[...this.__host.children].filter((t=>t instanceof HTMLSlotElement));this.__toggleSlotChangeListeners(true);const r=t||i.length||n.length||s;if(r){this.__callback(i,n)}}static __isColumnElement(t){return t.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/u.test(t.localName)}static getColumns(t){const e=[];const i=t._isColumnElement||OMt.__isColumnElement;[...t.children].forEach((t=>{if(i(t)){e.push(t)}else if(t instanceof HTMLSlotElement){[...t.assignedElements({flatten:true})].filter((t=>i(t))).forEach((t=>e.push(t)))}}));return e}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const LMt=t=>class e extends t{static get properties(){return{resizable:{type:Boolean,sync:true,value(){if(this.localName==="vaadin-grid-column-group"){return}const t=this.parentNode;if(t&&t.localName==="vaadin-grid-column-group"){return t.resizable||false}return false}},frozen:{type:Boolean,value:false,sync:true},frozenToEnd:{type:Boolean,value:false,sync:true},rowHeader:{type:Boolean,value:false,sync:true},hidden:{type:Boolean,value:false,sync:true},header:{type:String,sync:true},textAlign:{type:String,sync:true},headerPartName:{type:String,sync:true},footerPartName:{type:String,sync:true},_lastFrozen:{type:Boolean,value:false,sync:true},_bodyContentHidden:{type:Boolean,value:false,sync:true},_firstFrozenToEnd:{type:Boolean,value:false,sync:true},_order:{type:Number,sync:true},_reorderStatus:{type:Boolean,sync:true},_emptyCells:Array,_headerCell:Object,_footerCell:Object,_grid:Object,__initialized:{type:Boolean,value:true},headerRenderer:{type:Function,sync:true},_headerRenderer:{type:Function,computed:"_computeHeaderRenderer(headerRenderer, header, __initialized)",sync:true},footerRenderer:{type:Function,sync:true},_footerRenderer:{type:Function,computed:"_computeFooterRenderer(footerRenderer, __initialized)",sync:true},__gridColumnElement:{type:Boolean,value:true}}}static get observers(){return["_widthChanged(width, _headerCell, _footerCell, _cells)","_frozenChanged(frozen, _headerCell, _footerCell, _cells)","_frozenToEndChanged(frozenToEnd, _headerCell, _footerCell, _cells)","_flexGrowChanged(flexGrow, _headerCell, _footerCell, _cells)","_textAlignChanged(textAlign, _cells, _headerCell, _footerCell)","_orderChanged(_order, _headerCell, _footerCell, _cells)","_lastFrozenChanged(_lastFrozen)","_firstFrozenToEndChanged(_firstFrozenToEnd)","_onRendererOrBindingChanged(_renderer, _cells, _bodyContentHidden, path)","_onHeaderRendererOrBindingChanged(_headerRenderer, _headerCell, path, header)","_onFooterRendererOrBindingChanged(_footerRenderer, _footerCell)","_resizableChanged(resizable, _headerCell)","_reorderStatusChanged(_reorderStatus, _headerCell, _footerCell, _cells)","_hiddenChanged(hidden, _headerCell, _footerCell, _cells)","_rowHeaderChanged(rowHeader, _cells)","__headerFooterPartNameChanged(_headerCell, _footerCell, headerPartName, footerPartName)"]}get _grid(){if(!this._gridValue){this._gridValue=this._findHostGrid()}return this._gridValue}get _allCells(){return[].concat(this._cells||[]).concat(this._emptyCells||[]).concat(this._headerCell).concat(this._footerCell).filter((t=>t))}connectedCallback(){super.connectedCallback();requestAnimationFrame((()=>{if(!this._grid){return}this._allCells.forEach((t=>{if(!t._content.parentNode){this._grid.appendChild(t._content)}}))}))}disconnectedCallback(){super.disconnectedCallback();requestAnimationFrame((()=>{if(this._grid){return}this._allCells.forEach((t=>{if(t._content.parentNode){t._content.parentNode.removeChild(t._content)}}))}));this._gridValue=undefined}ready(){super.ready();mMt(this)}_findHostGrid(){let t=this;while(t&&!/^vaadin.*grid(-pro)?$/u.test(t.localName)){t=t.assignedSlot?t.assignedSlot.parentNode:t.parentNode}return t||undefined}_renderHeaderAndFooter(){this._renderHeaderCellContent(this._headerRenderer,this._headerCell);this._renderFooterCellContent(this._footerRenderer,this._footerCell)}_flexGrowChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("flexGrow")}this._allCells.forEach((e=>{e.style.flexGrow=t}))}_orderChanged(t){this._allCells.forEach((e=>{e.style.order=t}))}_widthChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("width")}this._allCells.forEach((e=>{e.style.width=t}))}_frozenChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("frozen",t)}this._allCells.forEach((e=>{EMt(e,"frozen",t)}));if(this._grid&&this._grid._frozenCellsChanged){this._grid._frozenCellsChanged()}}_frozenToEndChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("frozenToEnd",t)}this._allCells.forEach((e=>{if(this._grid&&e.parentElement===this._grid.$.sizer){return}EMt(e,"frozen-to-end",t)}));if(this._grid&&this._grid._frozenCellsChanged){this._grid._frozenCellsChanged()}}_lastFrozenChanged(t){this._allCells.forEach((e=>{EMt(e,"last-frozen",t)}));if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._lastFrozen=t}}_firstFrozenToEndChanged(t){this._allCells.forEach((e=>{if(this._grid&&e.parentElement===this._grid.$.sizer){return}EMt(e,"first-frozen-to-end",t)}));if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._firstFrozenToEnd=t}}_rowHeaderChanged(t,e){if(!e){return}e.forEach((e=>{e.setAttribute("role",t?"rowheader":"gridcell")}))}_generateHeader(t){return t.substr(t.lastIndexOf(".")+1).replace(/([A-Z])/gu,"-$1").toLowerCase().replace(/-/gu," ").replace(/^./u,(t=>t.toUpperCase()))}_reorderStatusChanged(t){const e=this.__previousReorderStatus;const i=e?`reorder-${e}-cell`:"";const n=`reorder-${t}-cell`;this._allCells.forEach((e=>{EMt(e,"reorder-status",t,n,i)}));this.__previousReorderStatus=t}_resizableChanged(t,e){if(t===undefined||e===undefined){return}if(e){[e].concat(this._emptyCells).forEach((e=>{if(e){const i=e.querySelector('[part~="resize-handle"]');if(i){e.removeChild(i)}if(t){const t=document.createElement("div");t.setAttribute("part","resize-handle");e.appendChild(t)}}}))}}_textAlignChanged(t){if(t===undefined||this._grid===undefined){return}if(["start","end","center"].indexOf(t)===-1){console.warn('textAlign can only be set as "start", "end" or "center"');return}let e;if(getComputedStyle(this._grid).direction==="ltr"){if(t==="start"){e="left"}else if(t==="end"){e="right"}}else if(t==="start"){e="right"}else if(t==="end"){e="left"}this._allCells.forEach((i=>{i._content.style.textAlign=t;if(getComputedStyle(i._content).textAlign!==t){i._content.style.textAlign=e}}))}_hiddenChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("hidden",t)}if(!!t!==!!this._previousHidden&&this._grid){if(t===true){this._allCells.forEach((t=>{if(t._content.parentNode){t._content.parentNode.removeChild(t._content)}}))}this._grid._debouncerHiddenChanged=sMt.debounce(this._grid._debouncerHiddenChanged,tMt,(()=>{if(this._grid&&this._grid._renderColumnTree){this._grid._renderColumnTree(this._grid._columnTree)}}));if(this._grid._debounceUpdateFrozenColumn){this._grid._debounceUpdateFrozenColumn()}if(this._grid._resetKeyboardNavigation){this._grid._resetKeyboardNavigation()}}this._previousHidden=t}_runRenderer(t,e,i){const n=i&&i.item&&!e.parentElement.hidden;const s=n||t===this._headerRenderer||t===this._footerRenderer;if(!s){return}const r=[e._content,this];if(n){r.push(i)}t.apply(this,r)}__renderCellsContent(t,e){if(this.hidden||!this._grid){return}e.forEach((e=>{if(!e.parentElement){return}const i=this._grid.__getRowModel(e.parentElement);if(!t){return}if(e._renderer!==t){this._clearCellContent(e)}e._renderer=t;this._runRenderer(t,e,i)}))}_clearCellContent(t){t._content.innerHTML="";delete t._content._$litPart$}_renderHeaderCellContent(t,e){if(!e||!t){return}this.__renderCellsContent(t,[e]);if(this._grid&&e.parentElement){this._grid.__debounceUpdateHeaderFooterRowVisibility(e.parentElement)}}_onHeaderRendererOrBindingChanged(t,e,...i){this._renderHeaderCellContent(t,e)}__headerFooterPartNameChanged(t,e,i,n){[{cell:t,partName:i},{cell:e,partName:n}].forEach((({cell:t,partName:e})=>{if(t){const i=t.__customParts||[];t.part.remove(...i);t.__customParts=e?e.trim().split(" "):[];t.part.add(...t.__customParts)}}))}_renderBodyCellsContent(t,e){if(!e||!t){return}this.__renderCellsContent(t,e)}_onRendererOrBindingChanged(t,e,...i){this._renderBodyCellsContent(t,e)}_renderFooterCellContent(t,e){if(!e||!t){return}this.__renderCellsContent(t,[e]);if(this._grid&&e.parentElement){this._grid.__debounceUpdateHeaderFooterRowVisibility(e.parentElement)}}_onFooterRendererOrBindingChanged(t,e){this._renderFooterCellContent(t,e)}__setTextContent(t,e){if(t.textContent!==e){t.textContent=e}}__textHeaderRenderer(){this.__setTextContent(this._headerCell._content,this.header)}_defaultHeaderRenderer(){if(!this.path){return}this.__setTextContent(this._headerCell._content,this._generateHeader(this.path))}_defaultRenderer(t,e,{item:i}){if(!this.path){return}this.__setTextContent(t,pMt(this.path,i))}_defaultFooterRenderer(){}_computeHeaderRenderer(t,e){if(t){return t}if(e!==undefined&&e!==null){return this.__textHeaderRenderer}return this._defaultHeaderRenderer}_computeRenderer(t){if(t){return t}return this._defaultRenderer}_computeFooterRenderer(t){if(t){return t}return this._defaultFooterRenderer}};const NMt=t=>class extends(LMt(fMt(t))){static get properties(){return{width:{type:String,value:"100px",sync:true},flexGrow:{type:Number,value:1,sync:true},renderer:{type:Function,sync:true},_renderer:{type:Function,computed:"_computeRenderer(renderer, __initialized)",sync:true},path:{type:String,sync:true},autoWidth:{type:Boolean,value:false},_focusButtonMode:{type:Boolean,value:false},_cells:{type:Array,sync:true}}}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class RMt extends(NMt(W_t)){static get is(){return"vaadin-grid-column"}}_wt(RMt);
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const PMt=kSt((t=>{if(typeof t.prototype.addController==="function"){return t}return class e extends t{constructor(){super();this.__controllers=new Set}connectedCallback(){super.connectedCallback();this.__controllers.forEach((t=>{if(t.hostConnected){t.hostConnected()}}))}disconnectedCallback(){super.disconnectedCallback();this.__controllers.forEach((t=>{if(t.hostDisconnected){t.hostDisconnected()}}))}addController(t){this.__controllers.add(t);if(this.$!==undefined&&this.isConnected&&t.hostConnected){t.hostConnected()}}removeController(t){this.__controllers.delete(t)}}}));const FMt=/\/\*[\*!]\s+vaadin-dev-mode:start([\s\S]*)vaadin-dev-mode:end\s+\*\*\//i;const DMt=window.Vaadin&&window.Vaadin.Flow&&window.Vaadin.Flow.clients;function $Mt(){function t(){return true}return BMt(t)}function zMt(){try{if(UMt()){return true}if(!VMt()){return false}if(DMt){return!GMt()}return!$Mt()}catch(t){return false}}function UMt(){return localStorage.getItem("vaadin.developmentmode.force")}function VMt(){return["localhost","127.0.0.1"].indexOf(window.location.hostname)>=0}function GMt(){if(DMt){const t=Object.keys(DMt).map((t=>DMt[t])).filter((t=>t.productionMode));if(t.length>0){return true}}return false}function BMt(t,e){if(typeof t!=="function"){return}const i=FMt.exec(t.toString());if(i){try{t=new Function(i[1])}catch(t){console.log("vaadin-development-mode-detector: uncommentAndRun() failed",t)}}return t(e)}window["Vaadin"]=window["Vaadin"]||{};const qMt=function(t,e){if(window.Vaadin.developmentMode){return BMt(t,e)}};if(window.Vaadin.developmentMode===undefined){window.Vaadin.developmentMode=zMt()}function HMt(){}const WMt=function(){if(typeof qMt==="function"){return qMt(HMt)}};
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */if(!window.Vaadin){window.Vaadin={}}if(!window.Vaadin.registrations){window.Vaadin.registrations=[]}if(!window.Vaadin.developmentModeCallback){window.Vaadin.developmentModeCallback={}}window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]=function(){WMt()};let ZMt;const JMt=new Set;const KMt=t=>class e extends(fMt(t)){static finalize(){super.finalize();const{is:t}=this;if(t&&!JMt.has(t)){window.Vaadin.registrations.push(this);JMt.add(t);if(window.Vaadin.developmentModeCallback){ZMt=sMt.debounce(ZMt,eMt,(()=>{window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]()}));rMt(ZMt)}}}constructor(){super();if(document.doctype===null){console.warn('Vaadin components require the "standards mode" declaration. Please add <!DOCTYPE html> to the HTML document.')}}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;let YMt=false;window.addEventListener("keydown",(()=>{YMt=true}),{capture:true});window.addEventListener("mousedown",(()=>{YMt=false}),{capture:true});function QMt(){return YMt}function XMt(t){const e=t.style;if(e.visibility==="hidden"||e.display==="none"){return true}const i=window.getComputedStyle(t);if(i.visibility==="hidden"||i.display==="none"){return true}return false}function tkt(t){if(t.offsetParent===null&&t.clientWidth===0&&t.clientHeight===0){return true}return XMt(t)}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const ekt=kSt((t=>class e extends t{static get properties(){return{disabled:{type:Boolean,value:false,observer:"_disabledChanged",reflectToAttribute:true}}}_disabledChanged(t){this._setAriaDisabled(t)}_setAriaDisabled(t){if(t){this.setAttribute("aria-disabled","true")}else{this.removeAttribute("aria-disabled")}}click(){if(!this.disabled){super.click()}}}));
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const ikt=t=>class e extends(ekt(t)){static get properties(){return{tabindex:{type:Number,reflectToAttribute:true,observer:"_tabindexChanged"},_lastTabIndex:{type:Number}}}_disabledChanged(t,e){super._disabledChanged(t,e);if(t){if(this.tabindex!==undefined){this._lastTabIndex=this.tabindex}this.tabindex=-1}else if(e){this.tabindex=this._lastTabIndex}}_tabindexChanged(t){if(this.disabled&&t!==-1){this._lastTabIndex=t;this.tabindex=-1}}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const nkt=t=>t.test(navigator.userAgent);const skt=t=>t.test(navigator.platform);const rkt=t=>t.test(navigator.vendor);const okt=nkt(/Android/u);const akt=nkt(/Chrome/u)&&rkt(/Google Inc/u);const lkt=nkt(/Firefox/u);const ukt=skt(/^iPad/u)||skt(/^Mac/u)&&navigator.maxTouchPoints>1;const ckt=skt(/^iPhone/u);const hkt=ckt||ukt;const dkt=nkt(/^((?!chrome|android).)*safari/iu);const fkt=(()=>{try{document.createEvent("TouchEvent");return true}catch(t){return false}})();
/**
 * @license
 * Copyright (c) 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class pkt{constructor(t,e){this.slot=t;this.callback=e;this._storedNodes=[];this._connected=false;this._scheduled=false;this._boundSchedule=()=>{this._schedule()};this.connect();this._schedule()}connect(){this.slot.addEventListener("slotchange",this._boundSchedule);this._connected=true}disconnect(){this.slot.removeEventListener("slotchange",this._boundSchedule);this._connected=false}_schedule(){if(!this._scheduled){this._scheduled=true;queueMicrotask((()=>{this.flush()}))}}flush(){if(!this._connected){return}this._scheduled=false;this._processNodes()}_processNodes(){const t=this.slot.assignedNodes({flatten:true});let e=[];const i=[];const n=[];if(t.length){e=t.filter((t=>!this._storedNodes.includes(t)))}if(this._storedNodes.length){this._storedNodes.forEach(((e,s)=>{const r=t.indexOf(e);if(r===-1){i.push(e)}else if(r!==s){n.push(e)}}))}if(e.length||i.length||n.length){this.callback({addedNodes:e,movedNodes:n,removedNodes:i})}this._storedNodes=t}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */let mkt=0;function ykt(){return mkt++}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class gkt extends EventTarget{static generateId(t,e){const i=e||"default";return`${i}-${t.localName}-${ykt()}`}constructor(t,e,i,n={}){super();const{initializer:s,multiple:r,observe:o,useUniqueId:a}=n;this.host=t;this.slotName=e;this.tagName=i;this.observe=typeof o==="boolean"?o:true;this.multiple=typeof r==="boolean"?r:false;this.slotInitializer=s;if(r){this.nodes=[]}if(a){this.defaultId=this.constructor.generateId(t,e)}}hostConnected(){if(!this.initialized){if(this.multiple){this.initMultiple()}else{this.initSingle()}if(this.observe){this.observeSlot()}this.initialized=true}}initSingle(){let t=this.getSlotChild();if(!t){t=this.attachDefaultNode();this.initNode(t)}else{this.node=t;this.initAddedNode(t)}}initMultiple(){const t=this.getSlotChildren();if(t.length===0){const t=this.attachDefaultNode();if(t){this.nodes=[t];this.initNode(t)}}else{this.nodes=t;t.forEach((t=>{this.initAddedNode(t)}))}}attachDefaultNode(){const{host:t,slotName:e,tagName:i}=this;let n=this.defaultNode;if(!n&&i){n=document.createElement(i);if(n instanceof Element){if(e!==""){n.setAttribute("slot",e)}this.node=n;this.defaultNode=n}}if(n){t.appendChild(n)}return n}getSlotChildren(){const{slotName:t}=this;return Array.from(this.host.childNodes).filter((e=>e.nodeType===Node.ELEMENT_NODE&&e.slot===t||e.nodeType===Node.TEXT_NODE&&e.textContent.trim()&&t===""))}getSlotChild(){return this.getSlotChildren()[0]}initNode(t){const{slotInitializer:e}=this;if(e){e(t,this.host)}}initCustomNode(t){}teardownNode(t){}initAddedNode(t){if(t!==this.defaultNode){this.initCustomNode(t);this.initNode(t)}}observeSlot(){const{slotName:t}=this;const e=t===""?"slot:not([name])":`slot[name=${t}]`;const i=this.host.shadowRoot.querySelector(e);this.__slotObserver=new pkt(i,(({addedNodes:t,removedNodes:e})=>{const i=this.multiple?this.nodes:[this.node];const n=t.filter((t=>!SMt(t)&&!i.includes(t)));if(e.length){this.nodes=i.filter((t=>!e.includes(t)));e.forEach((t=>{this.teardownNode(t)}))}if(n&&n.length>0){if(this.multiple){if(this.defaultNode){this.defaultNode.remove()}this.nodes=[...i,...n].filter((t=>t!==this.defaultNode));n.forEach((t=>{this.initAddedNode(t)}))}else{if(this.node){this.node.remove()}this.node=n[0];this.initAddedNode(this.node)}}}))}}
/**
 * @license
 * Copyright (c) 2022 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class vkt extends gkt{constructor(t){super(t,"tooltip");this.setTarget(t)}initCustomNode(t){t.target=this.target;if(this.ariaTarget!==undefined){t.ariaTarget=this.ariaTarget}if(this.context!==undefined){t.context=this.context}if(this.manual!==undefined){t.manual=this.manual}if(this.opened!==undefined){t.opened=this.opened}if(this.position!==undefined){t._position=this.position}if(this.shouldShow!==undefined){t.shouldShow=this.shouldShow}this.__notifyChange()}teardownNode(){this.__notifyChange()}setAriaTarget(t){this.ariaTarget=t;const e=this.node;if(e){e.ariaTarget=t}}setContext(t){this.context=t;const e=this.node;if(e){e.context=t}}setManual(t){this.manual=t;const e=this.node;if(e){e.manual=t}}setOpened(t){this.opened=t;const e=this.node;if(e){e.opened=t}}setPosition(t){this.position=t;const e=this.node;if(e){e._position=t}}setShouldShow(t){this.shouldShow=t;const e=this.node;if(e){e.shouldShow=t}}setTarget(t){this.target=t;const e=this.node;if(e){e.target=t}}__notifyChange(){this.dispatchEvent(new CustomEvent("tooltip-changed",{detail:{node:this.node}}))}}
/**
 * @license
 * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */const wkt=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/u);const bkt=wkt&&wkt[1]>=8;const Skt=3;const xkt={_ratio:.5,_scrollerPaddingTop:0,_scrollPosition:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_estScrollHeight:0,_scrollHeight:0,_viewportHeight:0,_viewportWidth:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_lastVisibleIndexVal:null,_maxPages:2,_templateCost:0,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportHeight},get _virtualEnd(){return this._virtualStart+this._physicalCount-1},get _hiddenContentSize(){return this._physicalSize-this._viewportHeight},get _maxScrollTop(){return this._estScrollHeight-this._viewportHeight+this._scrollOffset},get _maxVirtualStart(){const t=this._virtualCount;return Math.max(0,t-this._physicalCount)},get _virtualStart(){return this._virtualStartVal||0},set _virtualStart(t){t=this._clamp(t,0,this._maxVirtualStart);this._virtualStartVal=t},get _physicalStart(){return this._physicalStartVal||0},set _physicalStart(t){t%=this._physicalCount;if(t<0){t=this._physicalCount+t}this._physicalStartVal=t},get _physicalEnd(){return(this._physicalStart+this._physicalCount-1)%this._physicalCount},get _physicalCount(){return this._physicalCountVal||0},set _physicalCount(t){this._physicalCountVal=t},get _optPhysicalSize(){return this._viewportHeight===0?Infinity:this._viewportHeight*this._maxPages},get _isVisible(){return Boolean(this.offsetWidth||this.offsetHeight)},get firstVisibleIndex(){let t=this._firstVisibleIndexVal;if(t==null){let e=this._physicalTop+this._scrollOffset;t=this._iterateItems(((t,i)=>{e+=this._getPhysicalSizeIncrement(t);if(e>this._scrollPosition){return i}}))||0;this._firstVisibleIndexVal=t}return t},get lastVisibleIndex(){let t=this._lastVisibleIndexVal;if(t==null){let e=this._physicalTop+this._scrollOffset;this._iterateItems(((i,n)=>{if(e<this._scrollBottom){t=n}e+=this._getPhysicalSizeIncrement(i)}));this._lastVisibleIndexVal=t}return t},get _scrollOffset(){return this._scrollerPaddingTop+this.scrollOffset},_scrollHandler(){const t=Math.max(0,Math.min(this._maxScrollTop,this._scrollTop));let e=t-this._scrollPosition;const i=e>=0;this._scrollPosition=t;this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null;if(Math.abs(e)>this._physicalSize&&this._physicalSize>0){e-=this._scrollOffset;const t=Math.round(e/this._physicalAverage);this._virtualStart+=t;this._physicalStart+=t;this._physicalTop=Math.min(Math.floor(this._virtualStart)*this._physicalAverage,this._scrollPosition);this._update()}else if(this._physicalCount>0){const t=this._getReusables(i);if(i){this._physicalTop=t.physicalTop;this._virtualStart+=t.indexes.length;this._physicalStart+=t.indexes.length}else{this._virtualStart-=t.indexes.length;this._physicalStart-=t.indexes.length}this._update(t.indexes,i?null:t.indexes);this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,0),iMt)}},_getReusables(t){let e,i,n;const s=[];const r=this._hiddenContentSize*this._ratio;const o=this._virtualStart;const a=this._virtualEnd;const l=this._physicalCount;let u=this._physicalTop+this._scrollOffset;const c=this._physicalBottom+this._scrollOffset;const h=this._scrollPosition;const d=this._scrollBottom;if(t){e=this._physicalStart;i=h-u}else{e=this._physicalEnd;i=c-d}while(true){n=this._getPhysicalSizeIncrement(e);i-=n;if(s.length>=l||i<=r){break}if(t){if(a+s.length+1>=this._virtualCount){break}if(u+n>=h-this._scrollOffset){break}s.push(e);u+=n;e=(e+1)%l}else{if(o-s.length<=0){break}if(u+this._physicalSize-n<=d){break}s.push(e);u-=n;e=e===0?l-1:e-1}}return{indexes:s,physicalTop:u-this._scrollOffset}},_update(t,e){if(t&&t.length===0||this._physicalCount===0){return}this._assignModels(t);this._updateMetrics(t);if(e){while(e.length){const t=e.pop();this._physicalTop-=this._getPhysicalSizeIncrement(t)}}this._positionItems();this._updateScrollerSize()},_isClientFull(){return this._scrollBottom!==0&&this._physicalBottom-1>=this._scrollBottom&&this._physicalTop<=this._scrollPosition},_increasePoolIfNeeded(t){const e=this._clamp(this._physicalCount+t,Skt,this._virtualCount-this._virtualStart);const i=e-this._physicalCount;let n=Math.round(this._physicalCount*.5);if(i<0){return}if(i>0){const t=window.performance.now();[].push.apply(this._physicalItems,this._createPool(i));for(let t=0;t<i;t++){this._physicalSizes.push(0)}this._physicalCount+=i;if(this._physicalStart>this._physicalEnd&&this._isIndexRendered(this._focusedVirtualIndex)&&this._getPhysicalIndex(this._focusedVirtualIndex)<this._physicalEnd){this._physicalStart+=i}this._update();this._templateCost=(window.performance.now()-t)/i;n=Math.round(this._physicalCount*.5)}if(this._virtualEnd>=this._virtualCount-1||n===0);else if(!this._isClientFull()){this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,n),iMt)}else if(this._physicalSize<this._optPhysicalSize){this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,this._clamp(Math.round(50/this._templateCost),1,n)),eMt)}},_render(){if(!this.isAttached||!this._isVisible){return}if(this._physicalCount!==0){const t=this._getReusables(true);this._physicalTop=t.physicalTop;this._virtualStart+=t.indexes.length;this._physicalStart+=t.indexes.length;this._update(t.indexes);this._update();this._increasePoolIfNeeded(0)}else if(this._virtualCount>0){this.updateViewportBoundaries();this._increasePoolIfNeeded(Skt)}},_itemsChanged(t){if(t.path==="items"){this._virtualStart=0;this._physicalTop=0;this._virtualCount=this.items?this.items.length:0;this._physicalIndexForKey={};this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null;if(!this._physicalItems){this._physicalItems=[]}if(!this._physicalSizes){this._physicalSizes=[]}this._physicalStart=0;if(this._scrollTop>this._scrollOffset){this._resetScrollPosition(0)}this._debounce("_render",this._render,tMt)}},_iterateItems(t,e){let i,n,s,r;if(arguments.length===2&&e){for(r=0;r<e.length;r++){i=e[r];n=this._computeVidx(i);if((s=t.call(this,i,n))!=null){return s}}}else{i=this._physicalStart;n=this._virtualStart;for(;i<this._physicalCount;i++,n++){if((s=t.call(this,i,n))!=null){return s}}for(i=0;i<this._physicalStart;i++,n++){if((s=t.call(this,i,n))!=null){return s}}}},_computeVidx(t){if(t>=this._physicalStart){return this._virtualStart+(t-this._physicalStart)}return this._virtualStart+(this._physicalCount-this._physicalStart)+t},_positionItems(){this._adjustScrollPosition();let t=this._physicalTop;this._iterateItems((e=>{this.translate3d(0,`${t}px`,0,this._physicalItems[e]);t+=this._physicalSizes[e]}))},_getPhysicalSizeIncrement(t){return this._physicalSizes[t]},_adjustScrollPosition(){const t=this._virtualStart===0?this._physicalTop:Math.min(this._scrollPosition+this._physicalTop,0);if(t!==0){this._physicalTop-=t;const e=this._scrollPosition;if(!bkt&&e>0){this._resetScrollPosition(e-t)}}},_resetScrollPosition(t){if(this.scrollTarget&&t>=0){this._scrollTop=t;this._scrollPosition=this._scrollTop}},_updateScrollerSize(t){const e=this._physicalBottom+Math.max(this._virtualCount-this._physicalCount-this._virtualStart,0)*this._physicalAverage;this._estScrollHeight=e;if(t||this._scrollHeight===0||this._scrollPosition>=e-this._physicalSize||Math.abs(e-this._scrollHeight)>=this._viewportHeight){this.$.items.style.height=`${e}px`;this._scrollHeight=e}},scrollToIndex(t){if(typeof t!=="number"||t<0||t>this.items.length-1){return}aMt();if(this._physicalCount===0){return}t=this._clamp(t,0,this._virtualCount-1);if(!this._isIndexRendered(t)||t>=this._maxVirtualStart){this._virtualStart=t-1}this._assignModels();this._updateMetrics();this._physicalTop=this._virtualStart*this._physicalAverage;let e=this._physicalStart;let i=this._virtualStart;let n=0;const s=this._hiddenContentSize;while(i<t&&n<=s){n+=this._getPhysicalSizeIncrement(e);e=(e+1)%this._physicalCount;i+=1}this._updateScrollerSize(true);this._positionItems();this._resetScrollPosition(this._physicalTop+this._scrollOffset+n);this._increasePoolIfNeeded(0);this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null},_resetAverage(){this._physicalAverage=0;this._physicalAverageCount=0},_resizeHandler(){this._debounce("_render",(()=>{this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null;if(this._isVisible){this.updateViewportBoundaries();this.toggleScrollListener(true);this._resetAverage();this._render()}else{this.toggleScrollListener(false)}}),tMt)},_isIndexRendered(t){return t>=this._virtualStart&&t<=this._virtualEnd},_getPhysicalIndex(t){return(this._physicalStart+(t-this._virtualStart))%this._physicalCount},_clamp(t,e,i){return Math.min(i,Math.max(e,t))},_debounce(t,e,i){if(!this._debouncers){this._debouncers={}}this._debouncers[t]=sMt.debounce(this._debouncers[t],i,e.bind(this));rMt(this._debouncers[t])}};
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const _kt=1e5;const Mkt=1e3;class kkt{constructor({createElements:t,updateElement:e,scrollTarget:i,scrollContainer:n,elementsContainer:s,reorderElements:r}){this.isAttached=true;this._vidxOffset=0;this.createElements=t;this.updateElement=e;this.scrollTarget=i;this.scrollContainer=n;this.elementsContainer=s||n;this.reorderElements=r;this._maxPages=1.3;this.__placeholderHeight=200;this.__elementHeightQueue=Array(10);this.timeouts={SCROLL_REORDER:500,IGNORE_WHEEL:500,FIX_INVALID_ITEM_POSITIONING:100};this.__resizeObserver=new ResizeObserver((()=>this._resizeHandler()));if(getComputedStyle(this.scrollTarget).overflow==="visible"){this.scrollTarget.style.overflow="auto"}if(getComputedStyle(this.scrollContainer).position==="static"){this.scrollContainer.style.position="relative"}this.__resizeObserver.observe(this.scrollTarget);this.scrollTarget.addEventListener("scroll",(()=>this._scrollHandler()));this._scrollLineHeight=this._getScrollLineHeight();this.scrollTarget.addEventListener("wheel",(t=>this.__onWheel(t)));if(this.reorderElements){this.scrollTarget.addEventListener("mousedown",(()=>{this.__mouseDown=true}));this.scrollTarget.addEventListener("mouseup",(()=>{this.__mouseDown=false;if(this.__pendingReorder){this.__reorderElements()}}))}}get scrollOffset(){return 0}get adjustedFirstVisibleIndex(){return this.firstVisibleIndex+this._vidxOffset}get adjustedLastVisibleIndex(){return this.lastVisibleIndex+this._vidxOffset}__hasPlaceholders(){return this.__getVisibleElements().some((t=>t.__virtualizerPlaceholder))}scrollToIndex(t){if(typeof t!=="number"||isNaN(t)||this.size===0||!this.scrollTarget.offsetHeight){return}delete this.__pendingScrollToIndex;if(this._physicalCount<=3){this.flush()}t=this._clamp(t,0,this.size-1);const e=this.__getVisibleElements().length;let i=Math.floor(t/this.size*this._virtualCount);if(this._virtualCount-i<e){i=this._virtualCount-(this.size-t);this._vidxOffset=this.size-this._virtualCount}else if(i<e){if(t<Mkt){i=t;this._vidxOffset=0}else{i=Mkt;this._vidxOffset=t-i}}else{this._vidxOffset=t-i}this.__skipNextVirtualIndexAdjust=true;super.scrollToIndex(i);if(this.adjustedFirstVisibleIndex!==t&&this._scrollTop<this._maxScrollTop&&!this.grid){this._scrollTop-=this.__getIndexScrollOffset(t)||0}this._scrollHandler();if(this.__hasPlaceholders()){this.__pendingScrollToIndex=t}}flush(){const t=this._physicalCount;if(this.scrollTarget.offsetHeight===0){return}this._resizeHandler();aMt();this._scrollHandler();if(this.__fixInvalidItemPositioningDebouncer){this.__fixInvalidItemPositioningDebouncer.flush()}if(this.__scrollReorderDebouncer){this.__scrollReorderDebouncer.flush()}if(this.__debouncerWheelAnimationFrame){this.__debouncerWheelAnimationFrame.flush()}if(this._physicalCount!==t){this.flush()}}update(t=0,e=this.size-1){const i=[];this.__getVisibleElements().forEach((n=>{if(n.__virtualIndex>=t&&n.__virtualIndex<=e){this.__updateElement(n,n.__virtualIndex,true);i.push(n)}}));this.__afterElementsUpdated(i)}_updateMetrics(t){aMt();let e=0;let i=0;const n=this._physicalAverageCount;const s=this._physicalAverage;this._iterateItems(((t,n)=>{i+=this._physicalSizes[t];this._physicalSizes[t]=Math.ceil(this.__getBorderBoxHeight(this._physicalItems[t]));e+=this._physicalSizes[t];this._physicalAverageCount+=this._physicalSizes[t]?1:0}),t);this._physicalSize=this._physicalSize+e-i;if(this._physicalAverageCount!==n){this._physicalAverage=Math.round((s*n+e)/this._physicalAverageCount)}}__getBorderBoxHeight(t){const e=getComputedStyle(t);const i=parseFloat(e.height)||0;if(e.boxSizing==="border-box"){return i}const n=parseFloat(e.paddingBottom)||0;const s=parseFloat(e.paddingTop)||0;const r=parseFloat(e.borderBottomWidth)||0;const o=parseFloat(e.borderTopWidth)||0;return i+n+s+r+o}__updateElement(t,e,i){if(t.__virtualizerPlaceholder){t.style.paddingTop="";t.__virtualizerPlaceholder=false}if(!this.__preventElementUpdates&&(t.__lastUpdatedIndex!==e||i)){this.updateElement(t,e);t.__lastUpdatedIndex=e}}__afterElementsUpdated(t){t.forEach((t=>{const e=t.offsetHeight;if(e===0){t.style.paddingTop=`${this.__placeholderHeight}px`;t.__virtualizerPlaceholder=true;this.__placeholderClearDebouncer=sMt.debounce(this.__placeholderClearDebouncer,tMt,(()=>this._resizeHandler()))}else{this.__elementHeightQueue.push(e);this.__elementHeightQueue.shift();const t=this.__elementHeightQueue.filter((t=>t!==undefined));this.__placeholderHeight=Math.round(t.reduce(((t,e)=>t+e),0)/t.length)}}));if(this.__pendingScrollToIndex!==undefined&&!this.__hasPlaceholders()){this.scrollToIndex(this.__pendingScrollToIndex)}}__getIndexScrollOffset(t){const e=this.__getVisibleElements().find((e=>e.__virtualIndex===t));return e?this.scrollTarget.getBoundingClientRect().top-e.getBoundingClientRect().top:undefined}get size(){return this.__size}set size(t){if(t===this.size){return}if(this.__fixInvalidItemPositioningDebouncer){this.__fixInvalidItemPositioningDebouncer.cancel()}if(this._debouncers&&this._debouncers._increasePoolIfNeeded){this._debouncers._increasePoolIfNeeded.cancel()}this.__preventElementUpdates=true;let e;let i;if(t>0){e=this.adjustedFirstVisibleIndex;i=this.__getIndexScrollOffset(e)}this.__size=t;this._itemsChanged({path:"items"});aMt();if(t>0){e=Math.min(e,t-1);this.scrollToIndex(e);const n=this.__getIndexScrollOffset(e);if(i!==undefined&&n!==undefined){this._scrollTop+=i-n}}this.__preventElementUpdates=false;if(!this._isVisible){this._assignModels()}if(!this.elementsContainer.children.length){requestAnimationFrame((()=>this._resizeHandler()))}this._resizeHandler();aMt()}get _scrollTop(){return this.scrollTarget.scrollTop}set _scrollTop(t){this.scrollTarget.scrollTop=t}get items(){return{length:Math.min(this.size,_kt)}}get offsetHeight(){return this.scrollTarget.offsetHeight}get $(){return{items:this.scrollContainer}}updateViewportBoundaries(){const t=window.getComputedStyle(this.scrollTarget);this._scrollerPaddingTop=this.scrollTarget===this?0:parseInt(t["padding-top"],10);this._isRTL=Boolean(t.direction==="rtl");this._viewportWidth=this.elementsContainer.offsetWidth;this._viewportHeight=this.scrollTarget.offsetHeight;this._scrollPageHeight=this._viewportHeight-this._scrollLineHeight;if(this.grid){this._updateGridMetrics()}}setAttribute(){}_createPool(t){const e=this.createElements(t);const i=document.createDocumentFragment();e.forEach((t=>{t.style.position="absolute";i.appendChild(t);this.__resizeObserver.observe(t)}));this.elementsContainer.appendChild(i);return e}_assignModels(t){const e=[];this._iterateItems(((t,i)=>{const n=this._physicalItems[t];n.hidden=i>=this.size;if(!n.hidden){n.__virtualIndex=i+(this._vidxOffset||0);this.__updateElement(n,n.__virtualIndex);e.push(n)}else{delete n.__lastUpdatedIndex}}),t);this.__afterElementsUpdated(e)}_isClientFull(){setTimeout((()=>{this.__clientFull=true}));return this.__clientFull||super._isClientFull()}translate3d(t,e,i,n){n.style.transform=`translateY(${e})`}toggleScrollListener(){}_scrollHandler(){if(this.scrollTarget.offsetHeight===0){return}this._adjustVirtualIndexOffset(this._scrollTop-(this.__previousScrollTop||0));const t=this.scrollTarget.scrollTop-this._scrollPosition;super._scrollHandler();if(this._physicalCount!==0){const e=t>=0;const i=this._getReusables(!e);if(i.indexes.length){this._physicalTop=i.physicalTop;if(e){this._virtualStart-=i.indexes.length;this._physicalStart-=i.indexes.length}else{this._virtualStart+=i.indexes.length;this._physicalStart+=i.indexes.length}this._resizeHandler()}}if(t){this.__fixInvalidItemPositioningDebouncer=sMt.debounce(this.__fixInvalidItemPositioningDebouncer,X_t.after(this.timeouts.FIX_INVALID_ITEM_POSITIONING),(()=>this.__fixInvalidItemPositioning()))}if(this.reorderElements){this.__scrollReorderDebouncer=sMt.debounce(this.__scrollReorderDebouncer,X_t.after(this.timeouts.SCROLL_REORDER),(()=>this.__reorderElements()))}this.__previousScrollTop=this._scrollTop;if(this._scrollTop===0&&this.firstVisibleIndex!==0&&Math.abs(t)>0){this.scrollToIndex(0)}}__fixInvalidItemPositioning(){if(!this.scrollTarget.isConnected){return}const t=this._physicalTop>this._scrollTop;const e=this._physicalBottom<this._scrollBottom;const i=this.adjustedFirstVisibleIndex===0;const n=this.adjustedLastVisibleIndex===this.size-1;if(t&&!i||e&&!n){const t=e;const i=this._ratio;this._ratio=0;this._scrollPosition=this._scrollTop+(t?-1:1);this._scrollHandler();this._ratio=i}}__onWheel(t){if(t.ctrlKey||this._hasScrolledAncestor(t.target,t.deltaX,t.deltaY)){return}let e=t.deltaY;if(t.deltaMode===WheelEvent.DOM_DELTA_LINE){e*=this._scrollLineHeight}else if(t.deltaMode===WheelEvent.DOM_DELTA_PAGE){e*=this._scrollPageHeight}if(!this._deltaYAcc){this._deltaYAcc=0}if(this._wheelAnimationFrame){this._deltaYAcc+=e;t.preventDefault();return}e+=this._deltaYAcc;this._deltaYAcc=0;this._wheelAnimationFrame=true;this.__debouncerWheelAnimationFrame=sMt.debounce(this.__debouncerWheelAnimationFrame,tMt,(()=>{this._wheelAnimationFrame=false}));const i=Math.abs(t.deltaX)+Math.abs(e);if(this._canScroll(this.scrollTarget,t.deltaX,e)){t.preventDefault();this.scrollTarget.scrollTop+=e;this.scrollTarget.scrollLeft+=t.deltaX;this._hasResidualMomentum=true;this._ignoreNewWheel=true;this._debouncerIgnoreNewWheel=sMt.debounce(this._debouncerIgnoreNewWheel,X_t.after(this.timeouts.IGNORE_WHEEL),(()=>{this._ignoreNewWheel=false}))}else if(this._hasResidualMomentum&&i<=this._previousMomentum||this._ignoreNewWheel){t.preventDefault()}else if(i>this._previousMomentum){this._hasResidualMomentum=false}this._previousMomentum=i}_hasScrolledAncestor(t,e,i){if(t===this.scrollTarget||t===this.scrollTarget.getRootNode().host){return false}else if(this._canScroll(t,e,i)&&["auto","scroll"].indexOf(getComputedStyle(t).overflow)!==-1){return true}else if(t!==this&&t.parentElement){return this._hasScrolledAncestor(t.parentElement,e,i)}}_canScroll(t,e,i){return i>0&&t.scrollTop<t.scrollHeight-t.offsetHeight||i<0&&t.scrollTop>0||e>0&&t.scrollLeft<t.scrollWidth-t.offsetWidth||e<0&&t.scrollLeft>0}_increasePoolIfNeeded(t){if(this._physicalCount>2&&t){const e=Math.ceil(this._optPhysicalSize/this._physicalAverage);const i=e-this._physicalCount;super._increasePoolIfNeeded(Math.max(t,Math.min(100,i)))}else{super._increasePoolIfNeeded(t)}}_getScrollLineHeight(){const t=document.createElement("div");t.style.fontSize="initial";t.style.display="none";document.body.appendChild(t);const e=window.getComputedStyle(t).fontSize;document.body.removeChild(t);return e?window.parseInt(e):undefined}__getVisibleElements(){return Array.from(this.elementsContainer.children).filter((t=>!t.hidden))}__reorderElements(){if(this.__mouseDown){this.__pendingReorder=true;return}this.__pendingReorder=false;const t=this._virtualStart+(this._vidxOffset||0);const e=this.__getVisibleElements();const i=e.find((t=>t.contains(this.elementsContainer.getRootNode().activeElement)||t.contains(this.scrollTarget.getRootNode().activeElement)));const n=i||e[0];if(!n){return}const s=n.__virtualIndex-t;const r=e.indexOf(n)-s;if(r>0){for(let t=0;t<r;t++){this.elementsContainer.appendChild(e[t])}}else if(r<0){for(let t=e.length+r;t<e.length;t++){this.elementsContainer.insertBefore(e[t],e[0])}}if(dkt){const{transform:t}=this.scrollTarget.style;this.scrollTarget.style.transform="translateZ(0)";setTimeout((()=>{this.scrollTarget.style.transform=t}))}}_adjustVirtualIndexOffset(t){if(this._virtualCount>=this.size){this._vidxOffset=0}else if(this.__skipNextVirtualIndexAdjust){this.__skipNextVirtualIndexAdjust=false}else if(Math.abs(t)>1e4){const t=this._scrollTop/(this.scrollTarget.scrollHeight-this.scrollTarget.offsetHeight);const e=t*this.size;this._vidxOffset=Math.round(e-t*this._virtualCount)}else{const t=this._vidxOffset;const e=Mkt;const i=100;if(this._scrollTop===0){this._vidxOffset=0;if(t!==this._vidxOffset){super.scrollToIndex(0)}}else if(this.firstVisibleIndex<e&&this._vidxOffset>0){this._vidxOffset-=Math.min(this._vidxOffset,i);super.scrollToIndex(this.firstVisibleIndex+(t-this._vidxOffset))}const n=this.size-this._virtualCount;if(this._scrollTop>=this._maxScrollTop&&this._maxScrollTop>0){this._vidxOffset=n;if(t!==this._vidxOffset){super.scrollToIndex(this._virtualCount-1)}}else if(this.firstVisibleIndex>this._virtualCount-e&&this._vidxOffset<n){this._vidxOffset+=Math.min(n-this._vidxOffset,i);super.scrollToIndex(this.firstVisibleIndex-(this._vidxOffset-t))}}}}Object.setPrototypeOf(kkt.prototype,xkt);class Tkt{constructor(t){this.__adapter=new kkt(t)}get firstVisibleIndex(){return this.__adapter.adjustedFirstVisibleIndex}get lastVisibleIndex(){return this.__adapter.adjustedLastVisibleIndex}get size(){return this.__adapter.size}set size(t){this.__adapter.size=t}scrollToIndex(t){this.__adapter.scrollToIndex(t)}update(t=0,e=this.size-1){this.__adapter.update(t,e)}flush(){this.__adapter.flush()}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const Akt=t=>class e extends t{static get observers(){return["_a11yUpdateGridSize(size, _columnTree)"]}_a11yGetHeaderRowCount(t){return t.filter((t=>t.some((t=>t.headerRenderer||t.path||t.header)))).length}_a11yGetFooterRowCount(t){return t.filter((t=>t.some((t=>t.headerRenderer)))).length}_a11yUpdateGridSize(t,e){if(t===undefined||e===undefined){return}const i=e[e.length-1];this.$.table.setAttribute("aria-rowcount",t+this._a11yGetHeaderRowCount(e)+this._a11yGetFooterRowCount(e));this.$.table.setAttribute("aria-colcount",i&&i.length||0);this._a11yUpdateHeaderRows();this._a11yUpdateFooterRows()}_a11yUpdateHeaderRows(){_Mt(this.$.header,((t,e)=>{t.setAttribute("aria-rowindex",e+1)}))}_a11yUpdateFooterRows(){_Mt(this.$.footer,((t,e)=>{t.setAttribute("aria-rowindex",this._a11yGetHeaderRowCount(this._columnTree)+this.size+e+1)}))}_a11yUpdateRowRowindex(t,e){t.setAttribute("aria-rowindex",e+this._a11yGetHeaderRowCount(this._columnTree)+1)}_a11yUpdateRowSelected(t,e){t.setAttribute("aria-selected",Boolean(e));MMt(t,(t=>{t.setAttribute("aria-selected",Boolean(e))}))}_a11yUpdateRowExpanded(t){if(this.__isRowExpandable(t)){t.setAttribute("aria-expanded","false")}else if(this.__isRowCollapsible(t)){t.setAttribute("aria-expanded","true")}else{t.removeAttribute("aria-expanded")}}_a11yUpdateRowLevel(t,e){if(e>0||this.__isRowCollapsible(t)||this.__isRowExpandable(t)){t.setAttribute("aria-level",e+1)}else{t.removeAttribute("aria-level")}}_a11ySetRowDetailsCell(t,e){MMt(t,(t=>{if(t!==e){t.setAttribute("aria-controls",e.id)}}))}_a11yUpdateCellColspan(t,e){t.setAttribute("aria-colspan",Number(e))}_a11yUpdateSorters(){Array.from(this.querySelectorAll("vaadin-grid-sorter")).forEach((t=>{let e=t.parentNode;while(e&&e.localName!=="vaadin-grid-cell-content"){e=e.parentNode}if(e&&e.assignedSlot){const i=e.assignedSlot.parentNode;i.setAttribute("aria-sort",{asc:"ascending",desc:"descending"}[String(t.direction)]||"none")}}))}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const Ikt=t=>{if(!t.parentNode){return false}const e=Array.from(t.parentNode.querySelectorAll("[tabindex], button, input, select, textarea, object, iframe, a[href], area[href]")).filter((t=>{const e=t.getAttribute("part");return!(e&&e.includes("body-cell"))}));const i=e.includes(t);return!t.disabled&&i&&t.offsetParent&&getComputedStyle(t).visibility!=="hidden"};const jkt=t=>class e extends t{static get properties(){return{activeItem:{type:Object,notify:true,value:null,sync:true}}}ready(){super.ready();this.$.scroller.addEventListener("click",this._onClick.bind(this));this.addEventListener("cell-activate",this._activateItem.bind(this));this.addEventListener("row-activate",this._activateItem.bind(this))}_activateItem(t){const e=t.detail.model;const i=e?e.item:null;if(i){this.activeItem=!this._itemsEqual(this.activeItem,i)?i:null}}_onClick(t){if(t.defaultPrevented){return}const e=t.composedPath();const i=e[e.indexOf(this.$.table)-3];if(!i||i.getAttribute("part").indexOf("details-cell")>-1){return}const n=i._content;const s=this.getRootNode().activeElement;const r=n.contains(s);if(!r&&!this._isFocusable(t.target)&&!(t.target instanceof HTMLLabelElement)){this.dispatchEvent(new CustomEvent("cell-activate",{detail:{model:this.__getRowModel(i.parentElement)}}))}}_isFocusable(t){return Ikt(t)}};function Ckt(t,e){return t.split(".").reduce(((t,e)=>t[e]),e)}function Ekt(t,e,i){if(i.length===0){return false}let n=true;t.forEach((({path:t})=>{if(!t||t.indexOf(".")===-1){return}const s=t.replace(/\.[^.]*$/u,"");if(Ckt(s,i[0])===undefined){console.warn(`Path "${t}" used for ${e} does not exist in all of the items, ${e} is disabled.`);n=false}}));return n}function Okt(t){if([undefined,null].indexOf(t)>=0){return""}else if(isNaN(t)){return t.toString()}return t}function Lkt(t,e){t=Okt(t);e=Okt(e);if(t<e){return-1}if(t>e){return 1}return 0}function Nkt(t,e){return t.sort(((t,i)=>e.map((e=>{if(e.direction==="asc"){return Lkt(Ckt(e.path,t),Ckt(e.path,i))}else if(e.direction==="desc"){return Lkt(Ckt(e.path,i),Ckt(e.path,t))}return 0})).reduce(((t,e)=>t!==0?t:e),0)))}function Rkt(t,e){return t.filter((t=>e.every((e=>{const i=Okt(Ckt(e.path,t));const n=Okt(e.value).toString().toLowerCase();return i.toString().toLowerCase().includes(n)}))))}const Pkt=t=>(e,i)=>{let n=t?[...t]:[];if(e.filters&&Ekt(e.filters,"filtering",n)){n=Rkt(n,e.filters)}if(Array.isArray(e.sortOrders)&&e.sortOrders.length&&Ekt(e.sortOrders,"sorting",n)){n=Nkt(n,e.sortOrders)}const s=Math.min(n.length,e.pageSize);const r=e.page*s;const o=r+s;const a=n.slice(r,o);i(a,n.length)};
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const Fkt=t=>class e extends t{static get properties(){return{items:{type:Array,sync:true}}}static get observers(){return["__dataProviderOrItemsChanged(dataProvider, items, isAttached, _filters, _sorters, items.*)"]}__setArrayDataProvider(t){const e=Pkt(this.items);e.__items=t;this._arrayDataProvider=e;this.size=t.length;this.dataProvider=e}__dataProviderOrItemsChanged(t,e,i){if(!i){return}if(this._arrayDataProvider){if(t!==this._arrayDataProvider){this._arrayDataProvider=undefined;this.items=undefined}else if(!e){this._arrayDataProvider=undefined;this.dataProvider=undefined;this.size=0;this.clearCache()}else if(this._arrayDataProvider.__items===e){this.clearCache();this.size=this._flatSize}else{this.__setArrayDataProvider(e)}}else if(e){this.__setArrayDataProvider(e)}}}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/;const Dkt=false;const $kt=t=>t;const zkt=typeof document.head.style.touchAction==="string";const Ukt="__polymerGestures";const Vkt="__polymerGesturesHandled";const Gkt="__polymerGesturesTouchAction";const Bkt=25;const qkt=5;const Hkt=2;const Wkt=["mousedown","mousemove","mouseup","click"];const Zkt=[0,1,4,2];const Jkt=function(){try{return new MouseEvent("test",{buttons:1}).buttons===1}catch(t){return false}}();function Kkt(t){return Wkt.indexOf(t)>-1}let Ykt=false;(function(){try{const t=Object.defineProperty({},"passive",{get(){Ykt=true}});window.addEventListener("test",null,t);window.removeEventListener("test",null,t)}catch(t){}})();function Qkt(t){if(Kkt(t)||t==="touchend"){return}if(zkt&&Ykt&&Dkt){return{passive:true}}}const Xkt=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/u);const tTt={button:true,command:true,fieldset:true,input:true,keygen:true,optgroup:true,option:true,select:true,textarea:true};function eTt(t){const e=t.type;if(!Kkt(e)){return false}if(e==="mousemove"){let e=t.buttons===undefined?1:t.buttons;if(t instanceof window.MouseEvent&&!Jkt){e=Zkt[t.which]||0}return Boolean(e&1)}const i=t.button===undefined?0:t.button;return i===0}function iTt(t){if(t.type==="click"){if(t.detail===0){return true}const e=hTt(t);if(!e.nodeType||e.nodeType!==Node.ELEMENT_NODE){return true}const i=e.getBoundingClientRect();const n=t.pageX,s=t.pageY;return!(n>=i.left&&n<=i.right&&s>=i.top&&s<=i.bottom)}return false}const nTt={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:false}};function sTt(t){let e="auto";const i=aTt(t);for(let t=0,n;t<i.length;t++){n=i[t];if(n[Gkt]){e=n[Gkt];break}}return e}function rTt(t,e,i){t.movefn=e;t.upfn=i;document.addEventListener("mousemove",e);document.addEventListener("mouseup",i)}function oTt(t){document.removeEventListener("mousemove",t.movefn);document.removeEventListener("mouseup",t.upfn);t.movefn=null;t.upfn=null}const aTt=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:t=>t.composedPath&&t.composedPath()||[];const lTt={};const uTt=[];function cTt(t,e){let i=document.elementFromPoint(t,e);let n=i;while(n&&n.shadowRoot&&!window.ShadyDOM){const s=n;n=n.shadowRoot.elementFromPoint(t,e);if(s===n){break}if(n){i=n}}return i}function hTt(t){const e=aTt(t);return e.length>0?e[0]:t.target}function dTt(t){const e=t.type;const i=t.currentTarget;const n=i[Ukt];if(!n){return}const s=n[e];if(!s){return}if(!t[Vkt]){t[Vkt]={};if(e.startsWith("touch")){const i=t.changedTouches[0];if(e==="touchstart"){if(t.touches.length===1){nTt.touch.id=i.identifier}}if(nTt.touch.id!==i.identifier){return}if(!zkt){if(e==="touchstart"||e==="touchmove"){fTt(t)}}}}const r=t[Vkt];if(r.skip){return}for(let e=0,i;e<uTt.length;e++){i=uTt[e];if(s[i.name]&&!r[i.name]){if(i.flow&&i.flow.start.indexOf(t.type)>-1&&i.reset){i.reset()}}}for(let i=0,n;i<uTt.length;i++){n=uTt[i];if(s[n.name]&&!r[n.name]){r[n.name]=true;n[e](t)}}}function fTt(t){const e=t.changedTouches[0];const i=t.type;if(i==="touchstart"){nTt.touch.x=e.clientX;nTt.touch.y=e.clientY;nTt.touch.scrollDecided=false}else if(i==="touchmove"){if(nTt.touch.scrollDecided){return}nTt.touch.scrollDecided=true;const i=sTt(t);let n=false;const s=Math.abs(nTt.touch.x-e.clientX);const r=Math.abs(nTt.touch.y-e.clientY);if(!t.cancelable);else if(i==="none"){n=true}else if(i==="pan-x"){n=r>s}else if(i==="pan-y"){n=s>r}if(n){t.preventDefault()}else{bTt("track")}}}function pTt(t,e,i){if(lTt[e]){mTt(t,e,i);return true}return false}function mTt(t,e,i){const n=lTt[e];const s=n.deps;const r=n.name;let o=t[Ukt];if(!o){t[Ukt]=o={}}for(let e=0,i,n;e<s.length;e++){i=s[e];if(Xkt&&Kkt(i)&&i!=="click"){continue}n=o[i];if(!n){o[i]=n={_count:0}}if(n._count===0){t.addEventListener(i,dTt,Qkt(i))}n[r]=(n[r]||0)+1;n._count=(n._count||0)+1}t.addEventListener(e,i);if(n.touchAction){vTt(t,n.touchAction)}}function yTt(t){uTt.push(t);t.emits.forEach((e=>{lTt[e]=t}))}function gTt(t){for(let e=0,i;e<uTt.length;e++){i=uTt[e];for(let e=0,n;e<i.emits.length;e++){n=i.emits[e];if(n===t){return i}}}return null}function vTt(t,e){if(zkt&&t instanceof HTMLElement){iMt.run((()=>{t.style.touchAction=e}))}t[Gkt]=e}function wTt(t,e,i){const n=new Event(e,{bubbles:true,cancelable:true,composed:true});n.detail=i;$kt(t).dispatchEvent(n);if(n.defaultPrevented){const t=i.preventer||i.sourceEvent;if(t&&t.preventDefault){t.preventDefault()}}}function bTt(t){const e=gTt(t);if(e.info){e.info.prevent=true}}yTt({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset(){oTt(this.info)},mousedown(t){if(!eTt(t)){return}const e=hTt(t);const i=this;const n=t=>{if(!eTt(t)){STt("up",e,t);oTt(i.info)}};const s=t=>{if(eTt(t)){STt("up",e,t)}oTt(i.info)};rTt(this.info,n,s);STt("down",e,t)},touchstart(t){STt("down",hTt(t),t.changedTouches[0],t)},touchend(t){STt("up",hTt(t),t.changedTouches[0],t)}});function STt(t,e,i,n){if(!e){return}wTt(e,t,{x:i.clientX,y:i.clientY,sourceEvent:i,preventer:n,prevent(t){return bTt(t)}})}yTt({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:false,moves:[],addMove(t){if(this.moves.length>Hkt){this.moves.shift()}this.moves.push(t)},movefn:null,upfn:null,prevent:false},reset(){this.info.state="start";this.info.started=false;this.info.moves=[];this.info.x=0;this.info.y=0;this.info.prevent=false;oTt(this.info)},mousedown(t){if(!eTt(t)){return}const e=hTt(t);const i=this;const n=t=>{const n=t.clientX,s=t.clientY;if(xTt(i.info,n,s)){i.info.state=i.info.started?t.type==="mouseup"?"end":"track":"start";if(i.info.state==="start"){bTt("tap")}i.info.addMove({x:n,y:s});if(!eTt(t)){i.info.state="end";oTt(i.info)}if(e){_Tt(i.info,e,t)}i.info.started=true}};const s=t=>{if(i.info.started){n(t)}oTt(i.info)};rTt(this.info,n,s);this.info.x=t.clientX;this.info.y=t.clientY},touchstart(t){const e=t.changedTouches[0];this.info.x=e.clientX;this.info.y=e.clientY},touchmove(t){const e=hTt(t);const i=t.changedTouches[0];const n=i.clientX,s=i.clientY;if(xTt(this.info,n,s)){if(this.info.state==="start"){bTt("tap")}this.info.addMove({x:n,y:s});_Tt(this.info,e,i);this.info.state="track";this.info.started=true}},touchend(t){const e=hTt(t);const i=t.changedTouches[0];if(this.info.started){this.info.state="end";this.info.addMove({x:i.clientX,y:i.clientY});_Tt(this.info,e,i)}}});function xTt(t,e,i){if(t.prevent){return false}if(t.started){return true}const n=Math.abs(t.x-e);const s=Math.abs(t.y-i);return n>=qkt||s>=qkt}function _Tt(t,e,i){if(!e){return}const n=t.moves[t.moves.length-2];const s=t.moves[t.moves.length-1];const r=s.x-t.x;const o=s.y-t.y;let a,l=0;if(n){a=s.x-n.x;l=s.y-n.y}wTt(e,"track",{state:t.state,x:i.clientX,y:i.clientY,dx:r,dy:o,ddx:a,ddy:l,sourceEvent:i,hover(){return cTt(i.clientX,i.clientY)}})}yTt({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:false},reset(){this.info.x=NaN;this.info.y=NaN;this.info.prevent=false},mousedown(t){if(eTt(t)){this.info.x=t.clientX;this.info.y=t.clientY}},click(t){if(eTt(t)){MTt(this.info,t)}},touchstart(t){const e=t.changedTouches[0];this.info.x=e.clientX;this.info.y=e.clientY},touchend(t){MTt(this.info,t.changedTouches[0],t)}});function MTt(t,e,i){const n=Math.abs(e.clientX-t.x);const s=Math.abs(e.clientY-t.y);const r=hTt(i||e);if(!r||tTt[r.localName]&&r.hasAttribute("disabled")){return}if(isNaN(n)||isNaN(s)||n<=Bkt&&s<=Bkt||iTt(e)){if(!t.prevent){wTt(r,"tap",{x:e.clientX,y:e.clientY,sourceEvent:e,preventer:i})}}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const kTt=t=>class e extends t{static get properties(){return{columnReorderingAllowed:{type:Boolean,value:false},_orderBaseScope:{type:Number,value:1e7}}}static get observers(){return["_updateOrders(_columnTree)"]}ready(){super.ready();pTt(this,"track",this._onTrackEvent);this._reorderGhost=this.shadowRoot.querySelector('[part="reorder-ghost"]');this.addEventListener("touchstart",this._onTouchStart.bind(this));this.addEventListener("touchmove",this._onTouchMove.bind(this));this.addEventListener("touchend",this._onTouchEnd.bind(this));this.addEventListener("contextmenu",this._onContextMenu.bind(this))}_onContextMenu(t){if(this.hasAttribute("reordering")){t.preventDefault();if(!fkt){this._onTrackEnd()}}}_onTouchStart(t){this._startTouchReorderTimeout=setTimeout((()=>{this._onTrackStart({detail:{x:t.touches[0].clientX,y:t.touches[0].clientY}})}),100)}_onTouchMove(t){if(this._draggedColumn){t.preventDefault()}clearTimeout(this._startTouchReorderTimeout)}_onTouchEnd(){clearTimeout(this._startTouchReorderTimeout);this._onTrackEnd()}_onTrackEvent(t){if(t.detail.state==="start"){const e=t.composedPath();const i=e[e.indexOf(this.$.header)-2];if(!i||!i._content){return}if(i._content.contains(this.getRootNode().activeElement)){return}if(this.$.scroller.hasAttribute("column-resizing")){return}if(!this._touchDevice){this._onTrackStart(t)}}else if(t.detail.state==="track"){this._onTrack(t)}else if(t.detail.state==="end"){this._onTrackEnd(t)}}_onTrackStart(t){if(!this.columnReorderingAllowed){return}const e=t.composedPath&&t.composedPath();if(e&&e.some((t=>t.hasAttribute&&t.hasAttribute("draggable")))){return}const i=this._cellFromPoint(t.detail.x,t.detail.y);if(!i||!i.getAttribute("part").includes("header-cell")){return}this.toggleAttribute("reordering",true);this._draggedColumn=i._column;while(this._draggedColumn.parentElement.childElementCount===1){this._draggedColumn=this._draggedColumn.parentElement}this._setSiblingsReorderStatus(this._draggedColumn,"allowed");this._draggedColumn._reorderStatus="dragging";this._updateGhost(i);this._reorderGhost.style.visibility="visible";this._updateGhostPosition(t.detail.x,this._touchDevice?t.detail.y-50:t.detail.y);this._autoScroller()}_onTrack(t){if(!this._draggedColumn){return}const e=this._cellFromPoint(t.detail.x,t.detail.y);if(!e){return}const i=this._getTargetColumn(e,this._draggedColumn);if(this._isSwapAllowed(this._draggedColumn,i)&&this._isSwappableByPosition(i,t.detail.x)){const t=this._columnTree.findIndex((t=>t.includes(i)));const e=this._getColumnsInOrder(t);const n=e.indexOf(this._draggedColumn);const s=e.indexOf(i);const r=n<s?1:-1;for(let t=n;t!==s;t+=r){this._swapColumnOrders(this._draggedColumn,e[t+r])}}this._updateGhostPosition(t.detail.x,this._touchDevice?t.detail.y-50:t.detail.y);this._lastDragClientX=t.detail.x}_onTrackEnd(){if(!this._draggedColumn){return}this.toggleAttribute("reordering",false);this._draggedColumn._reorderStatus="";this._setSiblingsReorderStatus(this._draggedColumn,"");this._draggedColumn=null;this._lastDragClientX=null;this._reorderGhost.style.visibility="hidden";this.dispatchEvent(new CustomEvent("column-reorder",{detail:{columns:this._getColumnsInOrder()}}))}_getColumnsInOrder(t=this._columnTree.length-1){return this._columnTree[t].filter((t=>!t.hidden)).sort(((t,e)=>t._order-e._order))}_cellFromPoint(t=0,e=0){if(!this._draggedColumn){this.$.scroller.toggleAttribute("no-content-pointer-events",true)}const i=this.shadowRoot.elementFromPoint(t,e);this.$.scroller.toggleAttribute("no-content-pointer-events",false);if(i&&i._column){return i}}_updateGhostPosition(t,e){const i=this._reorderGhost.getBoundingClientRect();const n=t-i.width/2;const s=e-i.height/2;const r=parseInt(this._reorderGhost._left||0);const o=parseInt(this._reorderGhost._top||0);this._reorderGhost._left=r-(i.left-n);this._reorderGhost._top=o-(i.top-s);this._reorderGhost.style.transform=`translate(${this._reorderGhost._left}px, ${this._reorderGhost._top}px)`}_updateGhost(t){const e=this._reorderGhost;e.textContent=t._content.innerText;const i=window.getComputedStyle(t);["boxSizing","display","width","height","background","alignItems","padding","border","flex-direction","overflow"].forEach((t=>{e.style[t]=i[t]}));return e}_updateOrders(t){if(t===undefined){return}t[0].forEach((t=>{t._order=0}));kMt(t[0],this._orderBaseScope,0)}_setSiblingsReorderStatus(t,e){_Mt(t.parentNode,(i=>{if(/column/u.test(i.localName)&&this._isSwapAllowed(i,t)){i._reorderStatus=e}}))}_autoScroller(){if(this._lastDragClientX){const t=this._lastDragClientX-this.getBoundingClientRect().right+50;const e=this.getBoundingClientRect().left-this._lastDragClientX+50;if(t>0){this.$.table.scrollLeft+=t/10}else if(e>0){this.$.table.scrollLeft-=e/10}}if(this._draggedColumn){setTimeout((()=>this._autoScroller()),10)}}_isSwapAllowed(t,e){if(t&&e){const i=t!==e;const n=t.parentElement===e.parentElement;const s=t.frozen&&e.frozen||t.frozenToEnd&&e.frozenToEnd||!t.frozen&&!t.frozenToEnd&&!e.frozen&&!e.frozenToEnd;return i&&n&&s}}_isSwappableByPosition(t,e){const i=Array.from(this.$.header.querySelectorAll('tr:not([hidden]) [part~="cell"]')).find((e=>t.contains(e._column)));const n=this.$.header.querySelector("tr:not([hidden]) [reorder-status=dragging]").getBoundingClientRect();const s=i.getBoundingClientRect();if(s.left>n.left){return e>s.right-n.width}return e<s.left+n.width}_swapColumnOrders(t,e){[t._order,e._order]=[e._order,t._order];this._debounceUpdateFrozenColumn();this._updateFirstAndLastColumn()}_getTargetColumn(t,e){if(t&&e){let i=t._column;while(i.parentElement!==e.parentElement&&i!==this){i=i.parentElement}if(i.parentElement===e.parentElement){return i}return t._column}}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const TTt=t=>class e extends t{ready(){super.ready();const t=this.$.scroller;pTt(t,"track",this._onHeaderTrack.bind(this));t.addEventListener("touchmove",(e=>t.hasAttribute("column-resizing")&&e.preventDefault()));t.addEventListener("contextmenu",(t=>t.target.getAttribute("part")==="resize-handle"&&t.preventDefault()));t.addEventListener("mousedown",(t=>t.target.getAttribute("part")==="resize-handle"&&t.preventDefault()))}_onHeaderTrack(t){const e=t.target;if(e.getAttribute("part")==="resize-handle"){const i=e.parentElement;let n=i._column;this.$.scroller.toggleAttribute("column-resizing",true);while(n.localName==="vaadin-grid-column-group"){n=n._childColumns.slice(0).sort(((t,e)=>t._order-e._order)).filter((t=>!t.hidden)).pop()}const s=this.__isRTL;const r=t.detail.x;const o=Array.from(this.$.header.querySelectorAll('[part~="row"]:last-child [part~="cell"]'));const a=o.find((t=>t._column===n));if(a.offsetWidth){const t=getComputedStyle(a._content);const e=10+parseInt(t.paddingLeft)+parseInt(t.paddingRight)+parseInt(t.borderLeftWidth)+parseInt(t.borderRightWidth)+parseInt(t.marginLeft)+parseInt(t.marginRight);let i;const o=a.offsetWidth;const l=a.getBoundingClientRect();if(a.hasAttribute("frozen-to-end")){i=o+(s?r-l.right:l.left-r)}else{i=o+(s?l.left-r:r-l.right)}n.width=`${Math.max(e,i)}px`;n.flexGrow=0}o.sort(((t,e)=>t._column._order-e._column._order)).forEach(((t,e,i)=>{if(e<i.indexOf(a)){t._column.width=`${t.offsetWidth}px`;t._column.flexGrow=0}}));const l=this._frozenToEndCells[0];if(l&&this.$.table.scrollWidth>this.$.table.offsetWidth){const t=l.getBoundingClientRect();const e=r-(s?t.right:t.left);if(s&&e<=0||!s&&e>=0){this.$.table.scrollLeft+=e}}if(t.detail.state==="end"){this.$.scroller.toggleAttribute("column-resizing",false);this.dispatchEvent(new CustomEvent("column-resize",{detail:{resizedColumn:n}}))}this._resizeHandler()}}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;function ATt(t,e,i=0){let n=e;for(const e of t.subCaches){const t=e.parentCacheIndex;if(n<=t){break}else if(n<=t+e.flatSize){return ATt(e,n-t-1,i+1)}n-=e.flatSize}return{cache:t,item:t.items[n],index:n,page:Math.floor(n/t.pageSize),level:i}}function ITt({getItemId:t},e,i,n=0,s=0){for(let r=0;r<e.items.length;r++){const o=e.items[r];if(!!o&&t(o)===t(i)){return{cache:e,level:n,item:o,index:r,page:Math.floor(r/e.pageSize),subCache:e.getSubCache(r),flatIndex:s+e.getFlatIndex(r)}}}for(const r of e.subCaches){const o=s+e.getFlatIndex(r.parentCacheIndex);const a=ITt({getItemId:t},r,i,n+1,o+1);if(a){return a}}}function jTt(t,[e,...i],n=0){if(e===Infinity){e=t.size-1}const s=t.getFlatIndex(e);const r=t.getSubCache(e);if(r&&r.flatSize>0&&i.length){return jTt(r,i,n+s+1)}return n+s}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class CTt{context;size=0;pageSize;items=[];pendingRequests={};__subCacheByIndex={};__flatSize=0;constructor(t,e,i,n,s){this.context=t;this.pageSize=e;this.size=i||0;this.parentCache=n;this.parentCacheIndex=s;this.__flatSize=i||0}get parentItem(){return this.parentCache&&this.parentCache.items[this.parentCacheIndex]}get subCaches(){return Object.values(this.__subCacheByIndex)}get isLoading(){if(Object.keys(this.pendingRequests).length>0){return true}return this.subCaches.some((t=>t.isLoading))}get flatSize(){return this.__flatSize}get effectiveSize(){console.warn("<vaadin-grid> The `effectiveSize` property of ItemCache is deprecated and will be removed in Vaadin 25.");return this.flatSize}recalculateFlatSize(){this.__flatSize=!this.parentItem||this.context.isExpanded(this.parentItem)?this.size+this.subCaches.reduce(((t,e)=>{e.recalculateFlatSize();return t+e.flatSize}),0):0}setPage(t,e){const i=t*this.pageSize;e.forEach(((t,e)=>{this.items[i+e]=t}))}getSubCache(t){return this.__subCacheByIndex[t]}removeSubCache(t){delete this.__subCacheByIndex[t]}removeSubCaches(){this.__subCacheByIndex={}}createSubCache(t){const e=new CTt(this.context,this.pageSize,0,this,t);this.__subCacheByIndex[t]=e;return e}getFlatIndex(t){const e=Math.max(0,Math.min(this.size-1,t));return this.subCaches.reduce(((t,i)=>{const n=i.parentCacheIndex;return e>n?t+i.flatSize:t}),e)}getItemForIndex(t){console.warn("<vaadin-grid> The `getItemForIndex` method of ItemCache is deprecated and will be removed in Vaadin 25.");const{item:e}=ATt(this,t);return e}getCacheAndIndex(t){console.warn("<vaadin-grid> The `getCacheAndIndex` method of ItemCache is deprecated and will be removed in Vaadin 25.");const{cache:e,index:i}=ATt(this,t);return{cache:e,scaledIndex:i}}updateSize(){console.warn("<vaadin-grid> The `updateSize` method of ItemCache is deprecated and will be removed in Vaadin 25.");this.recalculateFlatSize()}ensureSubCacheForScaledIndex(t){console.warn("<vaadin-grid> The `ensureSubCacheForScaledIndex` method of ItemCache is deprecated and will be removed in Vaadin 25.");if(!this.getSubCache(t)){const e=this.createSubCache(t);this.context.__controller.__loadCachePage(e,0)}}get grid(){console.warn("<vaadin-grid> The `grid` property of ItemCache is deprecated and will be removed in Vaadin 25.");return this.context.__controller.host}get itemCaches(){console.warn("<vaadin-grid> The `itemCaches` property of ItemCache is deprecated and will be removed in Vaadin 25.");return this.__subCacheByIndex}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class ETt extends EventTarget{host;dataProvider;dataProviderParams;size;pageSize;isExpanded;getItemId;rootCache;constructor(t,{size:e,pageSize:i,isExpanded:n,getItemId:s,dataProvider:r,dataProviderParams:o}){super();this.host=t;this.pageSize=i;this.getItemId=s;this.isExpanded=n;this.dataProvider=r;this.dataProviderParams=o;this.rootCache=this.__createRootCache(e)}get flatSize(){return this.rootCache.flatSize}get __cacheContext(){return{isExpanded:this.isExpanded,__controller:this}}isLoading(){return this.rootCache.isLoading}setPageSize(t){this.pageSize=t;this.clearCache()}setDataProvider(t){this.dataProvider=t;this.clearCache()}recalculateFlatSize(){this.rootCache.recalculateFlatSize()}clearCache(){this.rootCache=this.__createRootCache(this.rootCache.size)}getFlatIndexContext(t){return ATt(this.rootCache,t)}getItemContext(t){return ITt({getItemId:this.getItemId},this.rootCache,t)}getFlatIndexByPath(t){return jTt(this.rootCache,t)}ensureFlatIndexLoaded(t){const{cache:e,page:i,item:n}=this.getFlatIndexContext(t);if(!n){this.__loadCachePage(e,i)}}ensureFlatIndexHierarchy(t){const{cache:e,item:i,index:n}=this.getFlatIndexContext(t);if(i&&this.isExpanded(i)&&!e.getSubCache(n)){const t=e.createSubCache(n);this.__loadCachePage(t,0)}}loadFirstPage(){this.__loadCachePage(this.rootCache,0)}__createRootCache(t){return new CTt(this.__cacheContext,this.pageSize,t)}__loadCachePage(t,e){if(!this.dataProvider||t.pendingRequests[e]){return}let i={page:e,pageSize:this.pageSize,parentItem:t.parentItem};if(this.dataProviderParams){i={...i,...this.dataProviderParams()}}const n=(n,s)=>{if(s!==undefined){t.size=s}else if(i.parentItem){t.size=n.length}t.setPage(e,n);this.recalculateFlatSize();this.dispatchEvent(new CustomEvent("page-received"));delete t.pendingRequests[e];this.dispatchEvent(new CustomEvent("page-loaded"))};t.pendingRequests[e]=n;this.dispatchEvent(new CustomEvent("page-requested"));this.dataProvider(i,n)}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const OTt=t=>class e extends t{static get properties(){return{size:{type:Number,notify:true,sync:true},_flatSize:{type:Number,sync:true},pageSize:{type:Number,value:50,observer:"_pageSizeChanged",sync:true},dataProvider:{type:Object,notify:true,observer:"_dataProviderChanged",sync:true},loading:{type:Boolean,notify:true,readOnly:true,reflectToAttribute:true},_hasData:{type:Boolean,value:false,sync:true},itemHasChildrenPath:{type:String,value:"children",observer:"__itemHasChildrenPathChanged",sync:true},itemIdPath:{type:String,value:null,sync:true},expandedItems:{type:Object,notify:true,value:()=>[],sync:true},__expandedKeys:{type:Object,computed:"__computeExpandedKeys(itemIdPath, expandedItems)"}}}static get observers(){return["_sizeChanged(size)","_expandedItemsChanged(expandedItems)"]}constructor(){super();this._dataProviderController=new ETt(this,{size:this.size,pageSize:this.pageSize,getItemId:this.getItemId.bind(this),isExpanded:this._isExpanded.bind(this),dataProvider:this.dataProvider?this.dataProvider.bind(this):null,dataProviderParams:()=>({sortOrders:this._mapSorters(),filters:this._mapFilters()})});this._dataProviderController.addEventListener("page-requested",this._onDataProviderPageRequested.bind(this));this._dataProviderController.addEventListener("page-received",this._onDataProviderPageReceived.bind(this));this._dataProviderController.addEventListener("page-loaded",this._onDataProviderPageLoaded.bind(this))}get _cache(){console.warn("<vaadin-grid> The `_cache` property is deprecated and will be removed in Vaadin 25.");return this._dataProviderController.rootCache}get _effectiveSize(){console.warn("<vaadin-grid> The `_effectiveSize` property is deprecated and will be removed in Vaadin 25.");return this._flatSize}_sizeChanged(t){this._dataProviderController.rootCache.size=t;this._dataProviderController.recalculateFlatSize();this._flatSize=this._dataProviderController.flatSize}__itemHasChildrenPathChanged(t,e){if(!e&&t==="children"){return}this.requestContentUpdate()}_getItem(t,e){if(t>=this._flatSize){return}e.index=t;const{item:i}=this._dataProviderController.getFlatIndexContext(t);if(i){this.__updateLoading(e,false);this._updateItem(e,i);if(this._isExpanded(i)){this._dataProviderController.ensureFlatIndexHierarchy(t)}}else{this.__updateLoading(e,true);this._dataProviderController.ensureFlatIndexLoaded(t)}}__updateLoading(t,e){const i=xMt(t);TMt(t,"loading",e);IMt(i,"loading-row-cell",e)}getItemId(t){return this.itemIdPath?pMt(this.itemIdPath,t):t}_isExpanded(t){return this.__expandedKeys&&this.__expandedKeys.has(this.getItemId(t))}_expandedItemsChanged(){this._dataProviderController.recalculateFlatSize();this._flatSize=this._dataProviderController.flatSize;this.__updateVisibleRows()}__computeExpandedKeys(t,e){const i=e||[];const n=new Set;i.forEach((t=>{n.add(this.getItemId(t))}));return n}expandItem(t){if(!this._isExpanded(t)){this.expandedItems=[...this.expandedItems,t]}}collapseItem(t){if(this._isExpanded(t)){this.expandedItems=this.expandedItems.filter((e=>!this._itemsEqual(e,t)))}}_getIndexLevel(t=0){const{level:e}=this._dataProviderController.getFlatIndexContext(t);return e}_loadPage(t,e){console.warn("<vaadin-grid> The `_loadPage` method is deprecated and will be removed in Vaadin 25.");this._dataProviderController.__loadCachePage(e,t)}_onDataProviderPageRequested(){this._setLoading(true)}_onDataProviderPageReceived(){this._flatSize=this._dataProviderController.flatSize;this._getRenderedRows().forEach((t=>{this._dataProviderController.ensureFlatIndexHierarchy(t.index)}));this._hasData=true}_onDataProviderPageLoaded(){this._debouncerApplyCachedData=sMt.debounce(this._debouncerApplyCachedData,X_t.after(0),(()=>{this._setLoading(false);this._getRenderedRows().forEach((t=>{const{item:e}=this._dataProviderController.getFlatIndexContext(t.index);if(e){this._getItem(t.index,t)}}));this.__scrollToPendingIndexes();this.__dispatchPendingBodyCellFocus()}));if(!this._dataProviderController.isLoading()){this._debouncerApplyCachedData.flush()}}__debounceClearCache(){this.__clearCacheDebouncer=sMt.debounce(this.__clearCacheDebouncer,iMt,(()=>this.clearCache()))}clearCache(){this._dataProviderController.clearCache();this._dataProviderController.rootCache.size=this.size;this._dataProviderController.recalculateFlatSize();this._hasData=false;this.__updateVisibleRows();if(!this.__virtualizer||!this.__virtualizer.size){this._dataProviderController.loadFirstPage()}}_pageSizeChanged(t,e){this._dataProviderController.setPageSize(t);if(e!==undefined&&t!==e){this.clearCache()}}_checkSize(){if(this.size===undefined&&this._flatSize===0){console.warn("The <vaadin-grid> needs the total number of items in"+" order to display rows, which you can specify either by setting"+" the `size` property, or by providing it to the second argument"+" of the `dataProvider` function `callback` call.")}}_dataProviderChanged(t,e){this._dataProviderController.setDataProvider(t?t.bind(this):null);if(e!==undefined){this.clearCache()}this._ensureFirstPageLoaded();this._debouncerCheckSize=sMt.debounce(this._debouncerCheckSize,X_t.after(2e3),this._checkSize.bind(this))}_ensureFirstPageLoaded(){if(!this._hasData){this._dataProviderController.loadFirstPage()}}_itemsEqual(t,e){return this.getItemId(t)===this.getItemId(e)}_getItemIndexInArray(t,e){let i=-1;e.forEach(((e,n)=>{if(this._itemsEqual(e,t)){i=n}}));return i}scrollToIndex(...t){let e;while(e!==(e=this._dataProviderController.getFlatIndexByPath(t))){this._scrollToFlatIndex(e)}if(this._dataProviderController.isLoading()||!this.clientHeight){this.__pendingScrollToIndexes=t}}__scrollToPendingIndexes(){if(this.__pendingScrollToIndexes&&this.$.items.children.length){const t=this.__pendingScrollToIndexes;delete this.__pendingScrollToIndexes;this.scrollToIndex(...t)}}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const LTt={BETWEEN:"between",ON_TOP:"on-top",ON_TOP_OR_BETWEEN:"on-top-or-between",ON_GRID:"on-grid"};const NTt={ON_TOP:"on-top",ABOVE:"above",BELOW:"below",EMPTY:"empty"};const RTt=!("draggable"in document.createElement("div"));const PTt=t=>class e extends t{static get properties(){return{dropMode:{type:String,sync:true},rowsDraggable:{type:Boolean,sync:true},dragFilter:{type:Function,sync:true},dropFilter:{type:Function,sync:true},__dndAutoScrollThreshold:{value:50}}}static get observers(){return["_dragDropAccessChanged(rowsDraggable, dropMode, dragFilter, dropFilter, loading)"]}ready(){super.ready();this.$.table.addEventListener("dragstart",this._onDragStart.bind(this));this.$.table.addEventListener("dragend",this._onDragEnd.bind(this));this.$.table.addEventListener("dragover",this._onDragOver.bind(this));this.$.table.addEventListener("dragleave",this._onDragLeave.bind(this));this.$.table.addEventListener("drop",this._onDrop.bind(this));this.$.table.addEventListener("dragenter",(t=>{if(this.dropMode){t.preventDefault();t.stopPropagation()}}))}_onDragStart(t){if(this.rowsDraggable){let e=t.target;if(e.localName==="vaadin-grid-cell-content"){e=e.assignedSlot.parentNode.parentNode}if(e.parentNode!==this.$.items){return}t.stopPropagation();this.toggleAttribute("dragging-rows",true);if(this._safari){const t=e.style.transform;e.style.top=/translateY\((.*)\)/u.exec(t)[1];e.style.transform="none";requestAnimationFrame((()=>{e.style.top="";e.style.transform=t}))}const i=e.getBoundingClientRect();if(RTt){t.dataTransfer.setDragImage(e)}else{t.dataTransfer.setDragImage(e,t.clientX-i.left,t.clientY-i.top)}let n=[e];if(this._isSelected(e._item)){n=this.__getViewportRows().filter((t=>this._isSelected(t._item))).filter((t=>!this.dragFilter||this.dragFilter(this.__getRowModel(t))))}t.dataTransfer.setData("text",this.__formatDefaultTransferData(n));jMt(e,{dragstart:n.length>1?`${n.length}`:""});this.style.setProperty("--_grid-drag-start-x",`${t.clientX-i.left+20}px`);this.style.setProperty("--_grid-drag-start-y",`${t.clientY-i.top+10}px`);requestAnimationFrame((()=>{jMt(e,{dragstart:false});this.style.setProperty("--_grid-drag-start-x","");this.style.setProperty("--_grid-drag-start-y","")}));const s=new CustomEvent("grid-dragstart",{detail:{draggedItems:n.map((t=>t._item)),setDragData:(e,i)=>t.dataTransfer.setData(e,i),setDraggedItemsCount:t=>e.setAttribute("dragstart",t)}});s.originalEvent=t;this.dispatchEvent(s)}}_onDragEnd(t){this.toggleAttribute("dragging-rows",false);t.stopPropagation();const e=new CustomEvent("grid-dragend");e.originalEvent=t;this.dispatchEvent(e)}_onDragLeave(t){t.stopPropagation();this._clearDragStyles()}_onDragOver(t){if(this.dropMode){this._dropLocation=undefined;this._dragOverItem=undefined;if(this.__dndAutoScroll(t.clientY)){this._clearDragStyles();return}let e=t.composedPath().find((t=>t.localName==="tr"));if(!this._flatSize||this.dropMode===LTt.ON_GRID){this._dropLocation=NTt.EMPTY}else if(!e||e.parentNode!==this.$.items){if(e){return}else if(this.dropMode===LTt.BETWEEN||this.dropMode===LTt.ON_TOP_OR_BETWEEN){e=Array.from(this.$.items.children).filter((t=>!t.hidden)).pop();this._dropLocation=NTt.BELOW}else{return}}else{const i=e.getBoundingClientRect();this._dropLocation=NTt.ON_TOP;if(this.dropMode===LTt.BETWEEN){const e=t.clientY-i.top<i.bottom-t.clientY;this._dropLocation=e?NTt.ABOVE:NTt.BELOW}else if(this.dropMode===LTt.ON_TOP_OR_BETWEEN){if(t.clientY-i.top<i.height/3){this._dropLocation=NTt.ABOVE}else if(t.clientY-i.top>i.height/3*2){this._dropLocation=NTt.BELOW}}}if(e&&e.hasAttribute("drop-disabled")){this._dropLocation=undefined;return}t.stopPropagation();t.preventDefault();if(this._dropLocation===NTt.EMPTY){this.toggleAttribute("dragover",true)}else if(e){this._dragOverItem=e._item;if(e.getAttribute("dragover")!==this._dropLocation){CMt(e,{dragover:this._dropLocation})}}else{this._clearDragStyles()}}}__dndAutoScroll(t){if(this.__dndAutoScrolling){return true}const e=this.$.header.getBoundingClientRect().bottom;const i=this.$.footer.getBoundingClientRect().top;const n=e-t+this.__dndAutoScrollThreshold;const s=t-i+this.__dndAutoScrollThreshold;let r=0;if(s>0){r=s*2}else if(n>0){r=-n*2}if(r){const t=this.$.table.scrollTop;this.$.table.scrollTop+=r;const e=t!==this.$.table.scrollTop;if(e){this.__dndAutoScrolling=true;setTimeout((()=>{this.__dndAutoScrolling=false}),20);return true}}}__getViewportRows(){const t=this.$.header.getBoundingClientRect().bottom;const e=this.$.footer.getBoundingClientRect().top;return Array.from(this.$.items.children).filter((i=>{const n=i.getBoundingClientRect();return n.bottom>t&&n.top<e}))}_clearDragStyles(){this.removeAttribute("dragover");_Mt(this.$.items,(t=>{CMt(t,{dragover:null})}))}_onDrop(t){if(this.dropMode){t.stopPropagation();t.preventDefault();const e=t.dataTransfer.types&&Array.from(t.dataTransfer.types).map((e=>({type:e,data:t.dataTransfer.getData(e)})));this._clearDragStyles();const i=new CustomEvent("grid-drop",{bubbles:t.bubbles,cancelable:t.cancelable,detail:{dropTargetItem:this._dragOverItem,dropLocation:this._dropLocation,dragData:e}});i.originalEvent=t;this.dispatchEvent(i)}}__formatDefaultTransferData(t){return t.map((t=>Array.from(t.children).filter((t=>!t.hidden&&t.getAttribute("part").indexOf("details-cell")===-1)).sort(((t,e)=>t._column._order>e._column._order?1:-1)).map((t=>t._content.textContent.trim())).filter((t=>t)).join("\t"))).join("\n")}_dragDropAccessChanged(){this.filterDragAndDrop()}filterDragAndDrop(){_Mt(this.$.items,(t=>{if(!t.hidden){this._filterDragAndDrop(t,this.__getRowModel(t))}}))}_filterDragAndDrop(t,e){const i=this.loading||t.hasAttribute("loading");const n=!this.rowsDraggable||i||this.dragFilter&&!this.dragFilter(e);const s=!this.dropMode||i||this.dropFilter&&!this.dropFilter(e);MMt(t,(t=>{if(n){t._content.removeAttribute("draggable")}else{t._content.setAttribute("draggable",true)}}));jMt(t,{"drag-disabled":!!n,"drop-disabled":!!s})}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;function FTt(t,e){if(!t||!e||t.length!==e.length){return false}for(let i=0,n=t.length;i<n;i++){if(t[i]instanceof Array&&e[i]instanceof Array){if(!FTt(t[i],e[i])){return false}}else if(t[i]!==e[i]){return false}}return true}const DTt=t=>class e extends t{static get properties(){return{_columnTree:Object}}ready(){super.ready();this._addNodeObserver()}_hasColumnGroups(t){return t.some((t=>t.localName==="vaadin-grid-column-group"))}_getChildColumns(t){return OMt.getColumns(t)}_flattenColumnGroups(t){return t.map((t=>{if(t.localName==="vaadin-grid-column-group"){return this._getChildColumns(t)}return[t]})).reduce(((t,e)=>t.concat(e)),[])}_getColumnTree(){const t=OMt.getColumns(this);const e=[t];let i=t;while(this._hasColumnGroups(i)){i=this._flattenColumnGroups(i);e.push(i)}return e}_debounceUpdateColumnTree(){this.__updateColumnTreeDebouncer=sMt.debounce(this.__updateColumnTreeDebouncer,iMt,(()=>this._updateColumnTree()))}_updateColumnTree(){const t=this._getColumnTree();if(!FTt(t,this._columnTree)){t.forEach((t=>{t.forEach((t=>{if(t.performUpdate){t.performUpdate()}}))}));this._columnTree=t}}_addNodeObserver(){this._observer=new OMt(this,((t,e)=>{const i=e.flatMap((t=>t._allCells));const n=t=>i.filter((e=>e&&e._content.contains(t))).length;this.__removeSorters(this._sorters.filter(n));this.__removeFilters(this._filters.filter(n));this._debounceUpdateColumnTree();this._debouncerCheckImports=sMt.debounce(this._debouncerCheckImports,X_t.after(2e3),this._checkImports.bind(this));this._ensureFirstPageLoaded()}))}_checkImports(){["vaadin-grid-column-group","vaadin-grid-filter","vaadin-grid-filter-column","vaadin-grid-tree-toggle","vaadin-grid-selection-column","vaadin-grid-sort-column","vaadin-grid-sorter"].forEach((t=>{const e=this.querySelector(t);if(e&&!customElements.get(t)){console.warn(`Make sure you have imported the required module for <${t}> element.`)}}))}_updateFirstAndLastColumn(){Array.from(this.shadowRoot.querySelectorAll("tr")).forEach((t=>this._updateFirstAndLastColumnForRow(t)))}_updateFirstAndLastColumnForRow(t){Array.from(t.querySelectorAll('[part~="cell"]:not([part~="details-cell"])')).sort(((t,e)=>t._column._order-e._column._order)).forEach(((t,e,i)=>{EMt(t,"first-column",e===0);EMt(t,"last-column",e===i.length-1)}))}_isColumnElement(t){return t.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/u.test(t.localName)}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const $Tt=t=>class e extends t{getEventContext(t){const e={};const i=t.__composedPath||t.composedPath();const n=i[i.indexOf(this.$.table)-3];if(!n){return e}e.section=["body","header","footer","details"].find((t=>n.getAttribute("part").indexOf(t)>-1));if(n._column){e.column=n._column}if(e.section==="body"||e.section==="details"){Object.assign(e,this.__getRowModel(n.parentElement))}return e}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const zTt=t=>class e extends t{static get properties(){return{_filters:{type:Array,value:()=>[]}}}constructor(){super();this._filterChanged=this._filterChanged.bind(this);this.addEventListener("filter-changed",this._filterChanged)}_filterChanged(t){t.stopPropagation();this.__addFilter(t.target);this.__applyFilters()}__removeFilters(t){if(t.length===0){return}this._filters=this._filters.filter((e=>t.indexOf(e)<0));this.__applyFilters()}__addFilter(t){const e=this._filters.indexOf(t);if(e===-1){this._filters.push(t)}}__applyFilters(){if(this.dataProvider&&this.isAttached){this.clearCache()}}_mapFilters(){return this._filters.map((t=>({path:t.path,value:t.value})))}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const UTt=t=>class e extends t{static get properties(){return{_headerFocusable:{type:Object,observer:"_focusableChanged",sync:true},_itemsFocusable:{type:Object,observer:"_focusableChanged",sync:true},_footerFocusable:{type:Object,observer:"_focusableChanged",sync:true},_navigatingIsHidden:Boolean,_focusedItemIndex:{type:Number,value:0},_focusedColumnOrder:Number,_focusedCell:{type:Object,observer:"_focusedCellChanged",sync:true},interacting:{type:Boolean,value:false,reflectToAttribute:true,readOnly:true,observer:"_interactingChanged"}}}get __rowFocusMode(){return this.__isRow(this._itemsFocusable)||this.__isRow(this._headerFocusable)||this.__isRow(this._footerFocusable)}set __rowFocusMode(t){["_itemsFocusable","_footerFocusable","_headerFocusable"].forEach((e=>{const i=this[e];if(t){const t=i&&i.parentElement;if(this.__isCell(i)){this[e]=t}else if(this.__isCell(t)){this[e]=t.parentElement}}else if(!t&&this.__isRow(i)){const t=i.firstElementChild;this[e]=t._focusButton||t}}))}get _visibleItemsCount(){return this._lastVisibleIndex-this._firstVisibleIndex-1}ready(){super.ready();if(this._ios||this._android){return}this.addEventListener("keydown",this._onKeyDown);this.addEventListener("keyup",this._onKeyUp);this.addEventListener("focusin",this._onFocusIn);this.addEventListener("focusout",this._onFocusOut);this.$.table.addEventListener("focusin",this._onContentFocusIn.bind(this));this.addEventListener("mousedown",(()=>{this.toggleAttribute("navigating",false);this._isMousedown=true;this._focusedColumnOrder=undefined}));this.addEventListener("mouseup",(()=>{this._isMousedown=false}))}_focusableChanged(t,e){if(e){e.setAttribute("tabindex","-1")}if(t){this._updateGridSectionFocusTarget(t)}}_focusedCellChanged(t,e){if(e){bMt(e,"part","focused-cell")}if(t){wMt(t,"part","focused-cell")}}_interactingChanged(){this._updateGridSectionFocusTarget(this._headerFocusable);this._updateGridSectionFocusTarget(this._itemsFocusable);this._updateGridSectionFocusTarget(this._footerFocusable)}__updateItemsFocusable(){if(!this._itemsFocusable){return}const t=this.shadowRoot.activeElement===this._itemsFocusable;this._getRenderedRows().forEach((t=>{if(t.index===this._focusedItemIndex){if(this.__rowFocusMode){this._itemsFocusable=t}else{let e=this._itemsFocusable.parentElement;let i=this._itemsFocusable;if(e){if(this.__isCell(e)){i=e;e=e.parentElement}const n=[...e.children].indexOf(i);this._itemsFocusable=this.__getFocusable(t,t.children[n])}}}}));if(t){this._itemsFocusable.focus()}}_onKeyDown(t){const e=t.key;let i;switch(e){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"PageUp":case"PageDown":case"Home":case"End":i="Navigation";break;case"Enter":case"Escape":case"F2":i="Interaction";break;case"Tab":i="Tab";break;case" ":i="Space";break}this._detectInteracting(t);if(this.interacting&&i!=="Interaction"){i=undefined}if(i){this[`_on${i}KeyDown`](t,e)}}_ensureScrolledToIndex(t){const e=[...this.$.items.children].find((e=>e.index===t));if(!e){this.scrollToIndex(t)}else{this.__scrollIntoViewport(t)}}__isRowExpandable(t){if(this.itemHasChildrenPath){const e=t._item;return!!(e&&pMt(this.itemHasChildrenPath,e)&&!this._isExpanded(e))}}__isRowCollapsible(t){return this._isExpanded(t._item)}__isDetailsCell(t){return t.matches('[part~="details-cell"]')}__isCell(t){return t instanceof HTMLTableCellElement}__isRow(t){return t instanceof HTMLTableRowElement}__getIndexOfChildElement(t){return Array.prototype.indexOf.call(t.parentNode.children,t)}_onNavigationKeyDown(t,e){t.preventDefault();const i=this.__isRTL;const n=t.composedPath().find((t=>this.__isRow(t)));const s=t.composedPath().find((t=>this.__isCell(t)));let r=0,o=0;switch(e){case"ArrowRight":r=i?-1:1;break;case"ArrowLeft":r=i?1:-1;break;case"Home":if(this.__rowFocusMode){o=-Infinity}else if(t.ctrlKey){o=-Infinity}else{r=-Infinity}break;case"End":if(this.__rowFocusMode){o=Infinity}else if(t.ctrlKey){o=Infinity}else{r=Infinity}break;case"ArrowDown":o=1;break;case"ArrowUp":o=-1;break;case"PageDown":if(this.$.items.contains(n)){const t=this.__getIndexInGroup(n,this._focusedItemIndex);this._scrollToFlatIndex(t)}o=this._visibleItemsCount;break;case"PageUp":o=-this._visibleItemsCount;break}if(this.__rowFocusMode&&!n||!this.__rowFocusMode&&!s){return}const a=i?"ArrowLeft":"ArrowRight";const l=i?"ArrowRight":"ArrowLeft";if(e===a){if(this.__rowFocusMode){if(this.__isRowExpandable(n)){this.expandItem(n._item);return}this.__rowFocusMode=false;this._onCellNavigation(n.firstElementChild,0,0);return}}else if(e===l){if(this.__rowFocusMode){if(this.__isRowCollapsible(n)){this.collapseItem(n._item);return}}else{const t=[...n.children].sort(((t,e)=>t._order-e._order));if(s===t[0]||this.__isDetailsCell(s)){this.__rowFocusMode=true;this._onRowNavigation(n,0);return}}}if(this.__rowFocusMode){this._onRowNavigation(n,o)}else{this._onCellNavigation(s,r,o)}}_onRowNavigation(t,e){const{dstRow:i}=this.__navigateRows(e,t);if(i){i.focus()}}__getIndexInGroup(t,e){const i=t.parentNode;if(i===this.$.items){return e!==undefined?e:t.index}return this.__getIndexOfChildElement(t)}__navigateRows(t,e,i){const n=this.__getIndexInGroup(e,this._focusedItemIndex);const s=e.parentNode;const r=(s===this.$.items?this._flatSize:s.children.length)-1;let o=Math.max(0,Math.min(n+t,r));if(s!==this.$.items){if(o>n){while(o<r&&s.children[o].hidden){o+=1}}else if(o<n){while(o>0&&s.children[o].hidden){o-=1}}this.toggleAttribute("navigating",true);return{dstRow:s.children[o]}}let a=false;if(i){const r=this.__isDetailsCell(i);if(s===this.$.items){const i=e._item;const{item:s}=this._dataProviderController.getFlatIndexContext(o);if(r){a=t===0}else{a=t===1&&this._isDetailsOpened(i)||t===-1&&o!==n&&this._isDetailsOpened(s)}if(a!==r&&(t===1&&a||t===-1&&!a)){o=n}}}this._ensureScrolledToIndex(o);this._focusedItemIndex=o;this.toggleAttribute("navigating",true);return{dstRow:[...s.children].find((t=>!t.hidden&&t.index===o)),dstIsRowDetails:a}}_onCellNavigation(t,e,i){const n=t.parentNode;const{dstRow:s,dstIsRowDetails:r}=this.__navigateRows(i,n,t);if(!s){return}let o=this.__getIndexOfChildElement(t);if(this.$.items.contains(t)){o=[...this.$.sizer.children].findIndex((e=>e._column===t._column))}const a=this.__isDetailsCell(t);const l=n.parentNode;const u=this.__getIndexInGroup(n,this._focusedItemIndex);if(this._focusedColumnOrder===undefined){if(a){this._focusedColumnOrder=0}else{this._focusedColumnOrder=this._getColumns(l,u).filter((t=>!t.hidden))[o]._order}}if(r){const t=[...s.children].find((t=>this.__isDetailsCell(t)));t.focus()}else{const n=this.__getIndexInGroup(s,this._focusedItemIndex);const r=this._getColumns(l,n).filter((t=>!t.hidden));const o=r.map((t=>t._order)).sort(((t,e)=>t-e));const u=o.length-1;const c=o.indexOf(o.slice(0).sort(((t,e)=>Math.abs(t-this._focusedColumnOrder)-Math.abs(e-this._focusedColumnOrder)))[0]);const h=i===0&&a?c:Math.max(0,Math.min(c+e,u));if(h!==c){this._focusedColumnOrder=undefined}const d=r.reduce(((t,e,i)=>{t[e._order]=i;return t}),{});const f=d[o[h]];let p;if(this.$.items.contains(t)){const t=this.$.sizer.children[f];if(this._lazyColumns){if(!this.__isColumnInViewport(t._column)){t.scrollIntoView()}this.__updateColumnsBodyContentHidden();this.__updateHorizontalScrollPosition()}p=[...s.children].find((e=>e._column===t._column));this._scrollHorizontallyToCell(p)}else{p=s.children[f];this._scrollHorizontallyToCell(p)}p.focus()}}_onInteractionKeyDown(t,e){const i=t.composedPath()[0];const n=i.localName==="input"&&!/^(button|checkbox|color|file|image|radio|range|reset|submit)$/iu.test(i.type);let s;switch(e){case"Enter":s=this.interacting?!n:true;break;case"Escape":s=false;break;case"F2":s=!this.interacting;break}const{cell:r}=this._getGridEventLocation(t);if(this.interacting!==s&&r!==null){if(s){const e=r._content.querySelector("[focus-target]")||[...r._content.querySelectorAll("*")].find((t=>this._isFocusable(t)));if(e){t.preventDefault();e.focus();this._setInteracting(true);this.toggleAttribute("navigating",false)}}else{t.preventDefault();this._focusedColumnOrder=undefined;r.focus();this._setInteracting(false);this.toggleAttribute("navigating",true)}}if(e==="Escape"){this._hideTooltip(true)}}_predictFocusStepTarget(t,e){const i=[this.$.table,this._headerFocusable,this._itemsFocusable,this._footerFocusable,this.$.focusexit];let n=i.indexOf(t);n+=e;while(n>=0&&n<=i.length-1){let t=i[n];if(t&&!this.__rowFocusMode){t=i[n].parentNode}if(!t||t.hidden){n+=e}else{break}}let s=i[n];if(s&&!this.__isHorizontallyInViewport(s)){const t=this._getColumnsInOrder().find((t=>this.__isColumnInViewport(t)));if(t){if(s===this._headerFocusable){s=t._headerCell}else if(s===this._itemsFocusable){const e=s._column._cells.indexOf(s);s=t._cells[e]}else if(s===this._footerFocusable){s=t._footerCell}}}return s}_onTabKeyDown(t){const e=this._predictFocusStepTarget(t.composedPath()[0],t.shiftKey?-1:1);if(!e){return}t.stopPropagation();if(e===this.$.table){this.$.table.focus()}else if(e===this.$.focusexit){this.$.focusexit.focus()}else if(e===this._itemsFocusable){let i=e;const n=this.__isRow(e)?e:e.parentNode;this._ensureScrolledToIndex(this._focusedItemIndex);if(n.index!==this._focusedItemIndex&&this.__isCell(e)){const t=Array.from(n.children).indexOf(this._itemsFocusable);const e=Array.from(this.$.items.children).find((t=>!t.hidden&&t.index===this._focusedItemIndex));if(e){i=e.children[t]}}t.preventDefault();i.focus()}else{t.preventDefault();e.focus()}this.toggleAttribute("navigating",true)}_onSpaceKeyDown(t){t.preventDefault();const e=t.composedPath()[0];const i=this.__isRow(e);if(i||!e._content||!e._content.firstElementChild){this.dispatchEvent(new CustomEvent(i?"row-activate":"cell-activate",{detail:{model:this.__getRowModel(i?e:e.parentElement)}}))}}_onKeyUp(t){if(!/^( |SpaceBar)$/u.test(t.key)||this.interacting){return}t.preventDefault();const e=t.composedPath()[0];if(e._content&&e._content.firstElementChild){const i=this.hasAttribute("navigating");e._content.firstElementChild.dispatchEvent(new MouseEvent("click",{shiftKey:t.shiftKey,bubbles:true,composed:true,cancelable:true}));this.toggleAttribute("navigating",i)}}_onFocusIn(t){if(!this._isMousedown){this.toggleAttribute("navigating",true)}const e=t.composedPath()[0];if(e===this.$.table||e===this.$.focusexit){this._predictFocusStepTarget(e,e===this.$.table?1:-1).focus();this._setInteracting(false)}else{this._detectInteracting(t)}}_onFocusOut(t){this.toggleAttribute("navigating",false);this._detectInteracting(t);this._hideTooltip();this._focusedCell=null}_onContentFocusIn(t){const{section:e,cell:i,row:n}=this._getGridEventLocation(t);if(!i&&!this.__rowFocusMode){return}this._detectInteracting(t);if(e&&(i||n)){this._activeRowGroup=e;if(this.$.header===e){this._headerFocusable=this.__getFocusable(n,i)}else if(this.$.items===e){this._itemsFocusable=this.__getFocusable(n,i)}else if(this.$.footer===e){this._footerFocusable=this.__getFocusable(n,i)}if(i){const e=this.getEventContext(t);this.__pendingBodyCellFocus=this.loading&&e.section==="body";if(!this.__pendingBodyCellFocus){i.dispatchEvent(new CustomEvent("cell-focus",{bubbles:true,composed:true,detail:{context:e}}))}this._focusedCell=i._focusButton||i;if(QMt()&&t.target===i){this._showTooltip(t)}}else{this._focusedCell=null}}this._detectFocusedItemIndex(t)}__dispatchPendingBodyCellFocus(){if(this.__pendingBodyCellFocus&&this.shadowRoot.activeElement===this._itemsFocusable){this._itemsFocusable.dispatchEvent(new Event("focusin",{bubbles:true,composed:true}))}}__getFocusable(t,e){return this.__rowFocusMode?t:e._focusButton||e}_detectInteracting(t){const e=t.composedPath().some((t=>t.localName==="vaadin-grid-cell-content"));this._setInteracting(e);this.__updateHorizontalScrollPosition()}_detectFocusedItemIndex(t){const{section:e,row:i}=this._getGridEventLocation(t);if(e===this.$.items){this._focusedItemIndex=i.index}}_updateGridSectionFocusTarget(t){if(!t){return}const e=this._getGridSectionFromFocusTarget(t);const i=this.interacting&&e===this._activeRowGroup;t.tabIndex=i?-1:0}_preventScrollerRotatingCellFocus(t,e){if(t.index===this._focusedItemIndex&&this.hasAttribute("navigating")&&this._activeRowGroup===this.$.items){this._navigatingIsHidden=true;this.toggleAttribute("navigating",false)}if(e===this._focusedItemIndex&&this._navigatingIsHidden){this._navigatingIsHidden=false;this.toggleAttribute("navigating",true)}}_getColumns(t,e){let i=this._columnTree.length-1;if(t===this.$.header){i=e}else if(t===this.$.footer){i=this._columnTree.length-1-e}return this._columnTree[i]}__isValidFocusable(t){return this.$.table.contains(t)&&t.offsetHeight}_resetKeyboardNavigation(){if(!this.$&&this.performUpdate){this.performUpdate()}["header","footer"].forEach((t=>{if(!this.__isValidFocusable(this[`_${t}Focusable`])){const e=[...this.$[t].children].find((t=>t.offsetHeight));const i=e?[...e.children].find((t=>!t.hidden)):null;if(e&&i){this[`_${t}Focusable`]=this.__getFocusable(e,i)}}}));if(!this.__isValidFocusable(this._itemsFocusable)&&this.$.items.firstElementChild){const t=this.__getFirstVisibleItem();const e=t?[...t.children].find((t=>!t.hidden)):null;if(e&&t){this._focusedColumnOrder=undefined;this._itemsFocusable=this.__getFocusable(t,e)}}else{this.__updateItemsFocusable()}}_scrollHorizontallyToCell(t){if(t.hasAttribute("frozen")||t.hasAttribute("frozen-to-end")||this.__isDetailsCell(t)){return}const e=t.getBoundingClientRect();const i=t.parentNode;const n=Array.from(i.children).indexOf(t);const s=this.$.table.getBoundingClientRect();let r=s.left,o=s.right;for(let t=n-1;t>=0;t--){const e=i.children[t];if(e.hasAttribute("hidden")||this.__isDetailsCell(e)){continue}if(e.hasAttribute("frozen")||e.hasAttribute("frozen-to-end")){r=e.getBoundingClientRect().right;break}}for(let t=n+1;t<i.children.length;t++){const e=i.children[t];if(e.hasAttribute("hidden")||this.__isDetailsCell(e)){continue}if(e.hasAttribute("frozen")||e.hasAttribute("frozen-to-end")){o=e.getBoundingClientRect().left;break}}if(e.left<r){this.$.table.scrollLeft+=Math.round(e.left-r)}if(e.right>o){this.$.table.scrollLeft+=Math.round(e.right-o)}}_getGridEventLocation(t){const e=t.composedPath();const i=e.indexOf(this.$.table);const n=i>=1?e[i-1]:null;const s=i>=2?e[i-2]:null;const r=i>=3?e[i-3]:null;return{section:n,row:s,cell:r}}_getGridSectionFromFocusTarget(t){if(t===this._headerFocusable){return this.$.header}if(t===this._itemsFocusable){return this.$.items}if(t===this._footerFocusable){return this.$.footer}return null}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const VTt=t=>class e extends t{static get properties(){return{detailsOpenedItems:{type:Array,value:()=>[],sync:true},rowDetailsRenderer:{type:Function,sync:true},_detailsCells:{type:Array}}}static get observers(){return["_detailsOpenedItemsChanged(detailsOpenedItems, rowDetailsRenderer)","_rowDetailsRendererChanged(rowDetailsRenderer)"]}ready(){super.ready();this._detailsCellResizeObserver=new ResizeObserver((t=>{t.forEach((({target:t})=>{this._updateDetailsCellHeight(t.parentElement)}));this.__virtualizer.__adapter._resizeHandler()}))}_rowDetailsRendererChanged(t){if(!t){return}if(this._columnTree){_Mt(this.$.items,(t=>{if(!t.querySelector("[part~=details-cell]")){this._updateRow(t,this._columnTree[this._columnTree.length-1]);const e=this._isDetailsOpened(t._item);this._toggleDetailsCell(t,e)}}))}}_detailsOpenedItemsChanged(t,e){_Mt(this.$.items,(t=>{if(t.hasAttribute("details-opened")){this._updateItem(t,t._item);return}if(e&&this._isDetailsOpened(t._item)){this._updateItem(t,t._item)}}))}_configureDetailsCell(t){t.setAttribute("part","cell details-cell");t.toggleAttribute("frozen",true);this._detailsCellResizeObserver.observe(t)}_toggleDetailsCell(t,e){const i=t.querySelector('[part~="details-cell"]');if(!i){return}i.hidden=!e;if(i.hidden){return}if(this.rowDetailsRenderer){i._renderer=this.rowDetailsRenderer}}_updateDetailsCellHeight(t){const e=t.querySelector('[part~="details-cell"]');if(!e){return}this.__updateDetailsRowPadding(t,e);requestAnimationFrame((()=>this.__updateDetailsRowPadding(t,e)))}__updateDetailsRowPadding(t,e){if(e.hidden){t.style.removeProperty("padding-bottom")}else{t.style.setProperty("padding-bottom",`${e.offsetHeight}px`)}}_updateDetailsCellHeights(){_Mt(this.$.items,(t=>{this._updateDetailsCellHeight(t)}))}_isDetailsOpened(t){return this.detailsOpenedItems&&this._getItemIndexInArray(t,this.detailsOpenedItems)!==-1}openItemDetails(t){if(!this._isDetailsOpened(t)){this.detailsOpenedItems=[...this.detailsOpenedItems,t]}}closeItemDetails(t){if(this._isDetailsOpened(t)){this.detailsOpenedItems=this.detailsOpenedItems.filter((e=>!this._itemsEqual(e,t)))}}}
/**
 * @license
 * Copyright (c) 2022 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const GTt=document.createElement("div");GTt.style.position="fixed";GTt.style.clip="rect(0px, 0px, 0px, 0px)";GTt.setAttribute("aria-live","polite");document.body.appendChild(GTt);
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const BTt=kSt((t=>class e extends t{ready(){super.ready();this.addEventListener("keydown",(t=>{this._onKeyDown(t)}));this.addEventListener("keyup",(t=>{this._onKeyUp(t)}))}_onKeyDown(t){switch(t.key){case"Enter":this._onEnter(t);break;case"Escape":this._onEscape(t);break}}_onKeyUp(t){}_onEnter(t){}_onEscape(t){}}));
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const qTt=t=>class e extends(ekt(BTt(t))){get _activeKeys(){return[" "]}ready(){super.ready();pTt(this,"down",(t=>{if(this._shouldSetActive(t)){this._setActive(true)}}));pTt(this,"up",(()=>{this._setActive(false)}))}disconnectedCallback(){super.disconnectedCallback();this._setActive(false)}_shouldSetActive(t){return!this.disabled}_onKeyDown(t){super._onKeyDown(t);if(this._shouldSetActive(t)&&this._activeKeys.includes(t.key)){this._setActive(true);document.addEventListener("keyup",(t=>{if(this._activeKeys.includes(t.key)){this._setActive(false)}}),{once:true})}}_setActive(t){this.toggleAttribute("active",t)}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const HTt=kSt((t=>class e extends t{get _keyboardActive(){return QMt()}ready(){this.addEventListener("focusin",(t=>{if(this._shouldSetFocus(t)){this._setFocused(true)}}));this.addEventListener("focusout",(t=>{if(this._shouldRemoveFocus(t)){this._setFocused(false)}}));super.ready()}disconnectedCallback(){super.disconnectedCallback();if(this.hasAttribute("focused")){this._setFocused(false)}}_setFocused(t){this.toggleAttribute("focused",t);this.toggleAttribute("focus-ring",t&&this._keyboardActive)}_shouldSetFocus(t){return true}_shouldRemoveFocus(t){return true}}));
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const WTt=kSt((t=>class e extends(HTt(ikt(t))){static get properties(){return{autofocus:{type:Boolean},focusElement:{type:Object,readOnly:true,observer:"_focusElementChanged"},_lastTabIndex:{value:0}}}constructor(){super();this._boundOnBlur=this._onBlur.bind(this);this._boundOnFocus=this._onFocus.bind(this)}ready(){super.ready();if(this.autofocus&&!this.disabled){requestAnimationFrame((()=>{this.focus();this.setAttribute("focus-ring","")}))}}focus(){if(this.focusElement&&!this.disabled){this.focusElement.focus()}}blur(){if(this.focusElement){this.focusElement.blur()}}click(){if(this.focusElement&&!this.disabled){this.focusElement.click()}}_focusElementChanged(t,e){if(t){t.disabled=this.disabled;this._addFocusListeners(t);this.__forwardTabIndex(this.tabindex)}else if(e){this._removeFocusListeners(e)}}_addFocusListeners(t){t.addEventListener("blur",this._boundOnBlur);t.addEventListener("focus",this._boundOnFocus)}_removeFocusListeners(t){t.removeEventListener("blur",this._boundOnBlur);t.removeEventListener("focus",this._boundOnFocus)}_onFocus(t){t.stopPropagation();this.dispatchEvent(new Event("focus"))}_onBlur(t){t.stopPropagation();this.dispatchEvent(new Event("blur"))}_shouldSetFocus(t){return t.target===this.focusElement}_shouldRemoveFocus(t){return t.target===this.focusElement}_disabledChanged(t,e){super._disabledChanged(t,e);if(this.focusElement){this.focusElement.disabled=t}if(t){this.blur()}}_tabindexChanged(t){this.__forwardTabIndex(t)}__forwardTabIndex(t){if(t!==undefined&&this.focusElement){this.focusElement.tabIndex=t;if(t!==-1){this.tabindex=undefined}}if(this.disabled&&t){if(t!==-1){this._lastTabIndex=t}this.tabindex=undefined}}}));
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function ZTt(t,e){const{scrollLeft:i}=t;if(e!=="rtl"){return i}return t.scrollWidth-t.clientWidth+i}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const JTt=new ResizeObserver((t=>{setTimeout((()=>{t.forEach((t=>{if(t.target.resizables){t.target.resizables.forEach((e=>{e._onResize(t.contentRect)}))}else{t.target._onResize(t.contentRect)}}))}))}));const KTt=kSt((t=>class e extends t{get _observeParent(){return false}connectedCallback(){super.connectedCallback();JTt.observe(this);if(this._observeParent){const t=this.parentNode instanceof ShadowRoot?this.parentNode.host:this.parentNode;if(!t.resizables){t.resizables=new Set;JTt.observe(t)}t.resizables.add(this);this.__parent=t}}disconnectedCallback(){super.disconnectedCallback();JTt.unobserve(this);const t=this.__parent;if(this._observeParent&&t){const e=t.resizables;if(e){e.delete(this);if(e.size===0){JTt.unobserve(t)}}this.__parent=null}}_onResize(t){}}));
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const YTt={SCROLLING:500,UPDATE_CONTENT_VISIBILITY:100};const QTt=t=>class e extends(KTt(t)){static get properties(){return{columnRendering:{type:String,value:"eager",sync:true},_frozenCells:{type:Array,value:()=>[]},_frozenToEndCells:{type:Array,value:()=>[]},_rowWithFocusedElement:Element}}static get observers(){return["__columnRenderingChanged(_columnTree, columnRendering)"]}get _scrollLeft(){return this.$.table.scrollLeft}get _scrollTop(){return this.$.table.scrollTop}set _scrollTop(t){this.$.table.scrollTop=t}get _lazyColumns(){return this.columnRendering==="lazy"}ready(){super.ready();this.scrollTarget=this.$.table;this.$.items.addEventListener("focusin",(t=>{const e=t.composedPath().indexOf(this.$.items);this._rowWithFocusedElement=t.composedPath()[e-1]}));this.$.items.addEventListener("focusout",(()=>{this._rowWithFocusedElement=undefined}));this.$.table.addEventListener("scroll",(()=>this._afterScroll()))}_onResize(){this._updateOverflow();this.__updateHorizontalScrollPosition();if(this._firefox){const t=!tkt(this);if(t&&this.__previousVisible===false){this._scrollTop=this.__memorizedScrollTop||0}this.__previousVisible=t}}_scrollToFlatIndex(t){t=Math.min(this._flatSize-1,Math.max(0,t));this.__virtualizer.scrollToIndex(t);this.__scrollIntoViewport(t)}__scrollIntoViewport(t){const e=[...this.$.items.children].find((e=>e.index===t));if(e){const t=e.getBoundingClientRect();const i=this.$.footer.getBoundingClientRect().top;const n=this.$.header.getBoundingClientRect().bottom;if(t.bottom>i){this.$.table.scrollTop+=t.bottom-i}else if(t.top<n){this.$.table.scrollTop-=n-t.top}}}_scheduleScrolling(){if(!this._scrollingFrame){this._scrollingFrame=requestAnimationFrame((()=>this.$.scroller.toggleAttribute("scrolling",true)))}this._debounceScrolling=sMt.debounce(this._debounceScrolling,X_t.after(YTt.SCROLLING),(()=>{cancelAnimationFrame(this._scrollingFrame);delete this._scrollingFrame;this.$.scroller.toggleAttribute("scrolling",false)}))}_afterScroll(){this.__updateHorizontalScrollPosition();if(!this.hasAttribute("reordering")){this._scheduleScrolling()}if(!this.hasAttribute("navigating")){this._hideTooltip(true)}this._updateOverflow();this._debounceColumnContentVisibility=sMt.debounce(this._debounceColumnContentVisibility,X_t.after(YTt.UPDATE_CONTENT_VISIBILITY),(()=>{if(this._lazyColumns&&this.__cachedScrollLeft!==this._scrollLeft){this.__cachedScrollLeft=this._scrollLeft;this.__updateColumnsBodyContentHidden()}}));if(this._firefox){const t=!tkt(this);if(t&&this.__previousVisible!==false){this.__memorizedScrollTop=this._scrollTop}}}__updateColumnsBodyContentHidden(){if(!this._columnTree){return}const t=this._getColumnsInOrder();if(!t[0]||!t[0]._sizerCell){return}let e=false;t.forEach((i=>{const n=this._lazyColumns&&!this.__isColumnInViewport(i);if(i._bodyContentHidden!==n){e=true;i._cells.forEach((e=>{if(e!==i._sizerCell){if(n){e.remove()}else if(e.__parentRow){const n=[...e.__parentRow.children].find((e=>t.indexOf(e._column)>t.indexOf(i)));e.__parentRow.insertBefore(e,n)}}}))}i._bodyContentHidden=n}));if(e){this._frozenCellsChanged()}if(this._lazyColumns){const e=[...t].reverse().find((t=>t.frozen));const i=this.__getColumnEnd(e);const n=t.find((t=>!t.frozen&&!t._bodyContentHidden));this.__lazyColumnsStart=this.__getColumnStart(n)-i;this.$.items.style.setProperty("--_grid-lazy-columns-start",`${this.__lazyColumnsStart}px`);this._resetKeyboardNavigation()}}__getColumnEnd(t){if(!t){return this.__isRTL?this.$.table.clientWidth:0}return t._sizerCell.offsetLeft+(this.__isRTL?0:t._sizerCell.offsetWidth)}__getColumnStart(t){if(!t){return this.__isRTL?this.$.table.clientWidth:0}return t._sizerCell.offsetLeft+(this.__isRTL?t._sizerCell.offsetWidth:0)}__isColumnInViewport(t){if(t.frozen||t.frozenToEnd){return true}return this.__isHorizontallyInViewport(t._sizerCell)}__isHorizontallyInViewport(t){return t.offsetLeft+t.offsetWidth>=this._scrollLeft&&t.offsetLeft<=this._scrollLeft+this.clientWidth}__columnRenderingChanged(t,e){if(e==="eager"){this.$.scroller.removeAttribute("column-rendering")}else{this.$.scroller.setAttribute("column-rendering",e)}this.__updateColumnsBodyContentHidden()}_updateOverflow(){this._debounceOverflow=sMt.debounce(this._debounceOverflow,tMt,(()=>{this.__doUpdateOverflow()}))}__doUpdateOverflow(){let t="";const e=this.$.table;if(e.scrollTop<e.scrollHeight-e.clientHeight){t+=" bottom"}if(e.scrollTop>0){t+=" top"}const i=ZTt(e,this.getAttribute("dir"));if(i>0){t+=" start"}if(i<e.scrollWidth-e.clientWidth){t+=" end"}if(this.__isRTL){t=t.replace(/start|end/giu,(t=>t==="start"?"end":"start"))}if(e.scrollLeft<e.scrollWidth-e.clientWidth){t+=" right"}if(e.scrollLeft>0){t+=" left"}const n=t.trim();if(n.length>0&&this.getAttribute("overflow")!==n){this.setAttribute("overflow",n)}else if(n.length===0&&this.hasAttribute("overflow")){this.removeAttribute("overflow")}}_frozenCellsChanged(){this._debouncerCacheElements=sMt.debounce(this._debouncerCacheElements,iMt,(()=>{Array.from(this.shadowRoot.querySelectorAll('[part~="cell"]')).forEach((t=>{t.style.transform=""}));this._frozenCells=Array.prototype.slice.call(this.$.table.querySelectorAll("[frozen]"));this._frozenToEndCells=Array.prototype.slice.call(this.$.table.querySelectorAll("[frozen-to-end]"));this.__updateHorizontalScrollPosition()}));this._debounceUpdateFrozenColumn()}_debounceUpdateFrozenColumn(){this.__debounceUpdateFrozenColumn=sMt.debounce(this.__debounceUpdateFrozenColumn,iMt,(()=>this._updateFrozenColumn()))}_updateFrozenColumn(){if(!this._columnTree){return}const t=this._columnTree[this._columnTree.length-1].slice(0);t.sort(((t,e)=>t._order-e._order));let e;let i;for(let n=0;n<t.length;n++){const s=t[n];s._lastFrozen=false;s._firstFrozenToEnd=false;if(i===undefined&&s.frozenToEnd&&!s.hidden){i=n}if(s.frozen&&!s.hidden){e=n}}if(e!==undefined){t[e]._lastFrozen=true}if(i!==undefined){t[i]._firstFrozenToEnd=true}this.__updateColumnsBodyContentHidden()}__updateHorizontalScrollPosition(){if(!this._columnTree){return}const t=this.$.table.scrollWidth;const e=this.$.table.clientWidth;const i=Math.max(0,this.$.table.scrollLeft);const n=ZTt(this.$.table,this.getAttribute("dir"));const s=`translate(${-i}px, 0)`;this.$.header.style.transform=s;this.$.footer.style.transform=s;this.$.items.style.transform=s;const r=this.__isRTL?n+e-t:i;const o=`translate(${r}px, 0)`;this._frozenCells.forEach((t=>{t.style.transform=o}));const a=this.__isRTL?n:i+e-t;const l=`translate(${a}px, 0)`;let u=l;if(this._lazyColumns){const t=this._getColumnsInOrder();const e=[...t].reverse().find((t=>!t.frozenToEnd&&!t._bodyContentHidden));const i=this.__getColumnEnd(e);const n=t.find((t=>t.frozenToEnd));const s=this.__getColumnStart(n);const r=a+(s-i)+this.__lazyColumnsStart;u=`translate(${r}px, 0)`}this._frozenToEndCells.forEach((t=>{if(this.$.items.contains(t)){t.style.transform=u}else{t.style.transform=l}}));if(this.hasAttribute("navigating")&&this.__rowFocusMode){this.$.table.style.setProperty("--_grid-horizontal-scroll-position",`${-r}px`)}}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const XTt=t=>class e extends t{static get properties(){return{selectedItems:{type:Object,notify:true,value:()=>[],sync:true},__selectedKeys:{type:Object,computed:"__computeSelectedKeys(itemIdPath, selectedItems)"}}}static get observers(){return["__selectedItemsChanged(itemIdPath, selectedItems)"]}_isSelected(t){return this.__selectedKeys.has(this.getItemId(t))}selectItem(t){if(!this._isSelected(t)){this.selectedItems=[...this.selectedItems,t]}}deselectItem(t){if(this._isSelected(t)){this.selectedItems=this.selectedItems.filter((e=>!this._itemsEqual(e,t)))}}_toggleItem(t){if(!this._isSelected(t)){this.selectItem(t)}else{this.deselectItem(t)}}__selectedItemsChanged(){this.requestContentUpdate()}__computeSelectedKeys(t,e){const i=e||[];const n=new Set;i.forEach((t=>{n.add(this.getItemId(t))}));return n}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;let tAt="prepend";const eAt=t=>class e extends t{static get properties(){return{multiSort:{type:Boolean,value:false},multiSortPriority:{type:String,value:()=>tAt},multiSortOnShiftClick:{type:Boolean,value:false},_sorters:{type:Array,value:()=>[]},_previousSorters:{type:Array,value:()=>[]}}}static setDefaultMultiSortPriority(t){tAt=["append","prepend"].includes(t)?t:"prepend"}ready(){super.ready();this.addEventListener("sorter-changed",this._onSorterChanged)}_onSorterChanged(t){const e=t.target;t.stopPropagation();e._grid=this;this.__updateSorter(e,t.detail.shiftClick,t.detail.fromSorterClick);this.__applySorters()}__removeSorters(t){if(t.length===0){return}this._sorters=this._sorters.filter((e=>t.indexOf(e)<0));if(this.multiSort){this.__updateSortOrders()}this.__applySorters()}__updateSortOrders(){this._sorters.forEach(((t,e)=>{t._order=this._sorters.length>1?e:null}))}__appendSorter(t){if(!t.direction){this._removeArrayItem(this._sorters,t)}else if(!this._sorters.includes(t)){this._sorters.push(t)}this.__updateSortOrders()}__prependSorter(t){this._removeArrayItem(this._sorters,t);if(t.direction){this._sorters.unshift(t)}this.__updateSortOrders()}__updateSorter(t,e,i){if(!t.direction&&this._sorters.indexOf(t)===-1){return}t._order=null;if(this.multiSort&&(!this.multiSortOnShiftClick||!i)||this.multiSortOnShiftClick&&e){if(this.multiSortPriority==="append"){this.__appendSorter(t)}else{this.__prependSorter(t)}}else if(t.direction||this.multiSortOnShiftClick){const e=this._sorters.filter((e=>e!==t));this._sorters=t.direction?[t]:[];e.forEach((t=>{t._order=null;t.direction=null}))}}__applySorters(){if(this.dataProvider&&this.isAttached&&JSON.stringify(this._previousSorters)!==JSON.stringify(this._mapSorters())){this.__debounceClearCache()}this._a11yUpdateSorters();this._previousSorters=this._mapSorters()}_mapSorters(){return this._sorters.map((t=>({path:t.path,direction:t.direction})))}_removeArrayItem(t,e){const i=t.indexOf(e);if(i>-1){t.splice(i,1)}}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const iAt=t=>class e extends t{static get properties(){return{cellClassNameGenerator:{type:Function,sync:true},cellPartNameGenerator:{type:Function,sync:true}}}static get observers(){return["__cellClassNameGeneratorChanged(cellClassNameGenerator)","__cellPartNameGeneratorChanged(cellPartNameGenerator)"]}__cellClassNameGeneratorChanged(){this.generateCellClassNames()}__cellPartNameGeneratorChanged(){this.generateCellPartNames()}generateCellClassNames(){_Mt(this.$.items,(t=>{if(!t.hidden&&!t.hasAttribute("loading")){this._generateCellClassNames(t,this.__getRowModel(t))}}))}generateCellPartNames(){_Mt(this.$.items,(t=>{if(!t.hidden&&!t.hasAttribute("loading")){this._generateCellPartNames(t,this.__getRowModel(t))}}))}_generateCellClassNames(t,e){MMt(t,(t=>{if(t.__generatedClasses){t.__generatedClasses.forEach((e=>t.classList.remove(e)))}if(this.cellClassNameGenerator){const i=this.cellClassNameGenerator(t._column,e);t.__generatedClasses=i&&i.split(" ").filter((t=>t.length>0));if(t.__generatedClasses){t.__generatedClasses.forEach((e=>t.classList.add(e)))}}}))}_generateCellPartNames(t,e){MMt(t,(t=>{if(t.__generatedParts){t.__generatedParts.forEach((e=>{AMt(t,null,e)}))}if(this.cellPartNameGenerator){const i=this.cellPartNameGenerator(t._column,e);t.__generatedParts=i&&i.split(" ").filter((t=>t.length>0));if(t.__generatedParts){t.__generatedParts.forEach((e=>{AMt(t,true,e)}))}}}))}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const nAt=t=>class extends(Fkt(OTt(DTt(jkt(QTt(XTt(eAt(VTt(UTt(Akt(zTt(kTt(TTt($Tt(PTt(iAt(ikt(t)))))))))))))))))){static get observers(){return["_columnTreeChanged(_columnTree)","_flatSizeChanged(_flatSize, __virtualizer, _hasData, _columnTree)"]}static get properties(){return{_safari:{type:Boolean,value:dkt},_ios:{type:Boolean,value:hkt},_firefox:{type:Boolean,value:lkt},_android:{type:Boolean,value:okt},_touchDevice:{type:Boolean,value:fkt},allRowsVisible:{type:Boolean,value:false,reflectToAttribute:true},__pendingRecalculateColumnWidths:{type:Boolean,value:true},isAttached:{value:false},__gridElement:{type:Boolean,value:true}}}constructor(){super();this.addEventListener("animationend",this._onAnimationEnd)}get _firstVisibleIndex(){const t=this.__getFirstVisibleItem();return t?t.index:undefined}get _lastVisibleIndex(){const t=this.__getLastVisibleItem();return t?t.index:undefined}connectedCallback(){super.connectedCallback();this.isAttached=true;this.recalculateColumnWidths()}disconnectedCallback(){super.disconnectedCallback();this.isAttached=false;this._hideTooltip(true)}__getFirstVisibleItem(){return this._getRenderedRows().find((t=>this._isInViewport(t)))}__getLastVisibleItem(){return this._getRenderedRows().reverse().find((t=>this._isInViewport(t)))}_isInViewport(t){const e=this.$.table.getBoundingClientRect();const i=t.getBoundingClientRect();const n=this.$.header.getBoundingClientRect().height;const s=this.$.footer.getBoundingClientRect().height;return i.bottom>e.top+n&&i.top<e.bottom-s}_getRenderedRows(){return Array.from(this.$.items.children).filter((t=>!t.hidden)).sort(((t,e)=>t.index-e.index))}_getRowContainingNode(t){const e=yMt("vaadin-grid-cell-content",t);if(!e){return}const i=e.assignedSlot.parentElement;return i.parentElement}_isItemAssignedToRow(t,e){const i=this.__getRowModel(e);return this.getItemId(t)===this.getItemId(i.item)}ready(){super.ready();this.__virtualizer=new Tkt({createElements:this._createScrollerRows.bind(this),updateElement:this._updateScrollerItem.bind(this),scrollContainer:this.$.items,scrollTarget:this.$.table,reorderElements:true});new ResizeObserver((()=>setTimeout((()=>{this.__updateColumnsBodyContentHidden();this.__tryToRecalculateColumnWidthsIfPending()})))).observe(this.$.table);mMt(this);this._tooltipController=new vkt(this);this.addController(this._tooltipController);this._tooltipController.setManual(true)}__getBodyCellCoordinates(t){if(this.$.items.contains(t)&&t.localName==="td"){return{item:t.parentElement._item,column:t._column}}}__focusBodyCell({item:t,column:e}){const i=this._getRenderedRows().find((e=>e._item===t));const n=i&&[...i.children].find((t=>t._column===e));if(n){n.focus()}}_focusFirstVisibleRow(){const t=this.__getFirstVisibleItem();this.__rowFocusMode=true;t.focus()}_flatSizeChanged(t,e,i,n){if(e&&i&&n){const i=this.shadowRoot.activeElement;const n=this.__getBodyCellCoordinates(i);const s=e.size||0;e.size=t;e.update(s-1,s-1);if(t<s){e.update(t-1,t-1)}if(n&&i.parentElement.hidden){this.__focusBodyCell(n)}this._resetKeyboardNavigation()}}__getIntrinsicWidth(t){if(!this.__intrinsicWidthCache.has(t)){this.__calculateAndCacheIntrinsicWidths([t])}return this.__intrinsicWidthCache.get(t)}__getDistributedWidth(t,e){if(t==null||t===this){return 0}const i=Math.max(this.__getIntrinsicWidth(t),this.__getDistributedWidth((t.assignedSlot||t).parentElement,t));if(!e){return i}const n=t;const s=i;const r=n._visibleChildColumns.map((t=>this.__getIntrinsicWidth(t))).reduce(((t,e)=>t+e),0);const o=Math.max(0,s-r);const a=this.__getIntrinsicWidth(e)/r;const l=a*o;return this.__getIntrinsicWidth(e)+l}_recalculateColumnWidths(t){this.__virtualizer.flush();[...this.$.header.children,...this.$.footer.children].forEach((t=>{if(t.__debounceUpdateHeaderFooterRowVisibility){t.__debounceUpdateHeaderFooterRowVisibility.flush()}}));if(this._debouncerHiddenChanged){this._debouncerHiddenChanged.flush()}this.__intrinsicWidthCache=new Map;const e=this._firstVisibleIndex;const i=this._lastVisibleIndex;this.__viewportRowsCache=this._getRenderedRows().filter((t=>t.index>=e&&t.index<=i));this.__calculateAndCacheIntrinsicWidths(t);t.forEach((t=>{t.width=`${this.__getDistributedWidth(t)}px`}))}__setVisibleCellContentAutoWidth(t,e){t._allCells.filter((t=>{if(this.$.items.contains(t)){return this.__viewportRowsCache.includes(t.parentElement)}return true})).forEach((t=>{t.__measuringAutoWidth=e;if(t.__measuringAutoWidth){t.__originalWidth=t.style.width;t.style.width="auto";t.style.position="absolute"}else{t.style.width=t.__originalWidth;delete t.__originalWidth;t.style.position=""}}))}__getAutoWidthCellsMaxWidth(t){return t._allCells.reduce(((t,e)=>e.__measuringAutoWidth?Math.max(t,e.offsetWidth+1):t),0)}__calculateAndCacheIntrinsicWidths(t){t.forEach((t=>this.__setVisibleCellContentAutoWidth(t,true)));t.forEach((t=>{const e=this.__getAutoWidthCellsMaxWidth(t);this.__intrinsicWidthCache.set(t,e)}));t.forEach((t=>this.__setVisibleCellContentAutoWidth(t,false)))}recalculateColumnWidths(){if(!this._columnTree){return}if(tkt(this)||this._dataProviderController.isLoading()){this.__pendingRecalculateColumnWidths=true;return}const t=this._getColumns().filter((t=>!t.hidden&&t.autoWidth));this._recalculateColumnWidths(t)}__tryToRecalculateColumnWidthsIfPending(){if(!this.__pendingRecalculateColumnWidths||tkt(this)||this._dataProviderController.isLoading()){return}const t=[...this.$.items.children].some((t=>t.index===undefined));if(t){return}const e=[...this.$.items.children].some((t=>t.clientHeight>0));if(e){this.__pendingRecalculateColumnWidths=false;this.recalculateColumnWidths()}}_onDataProviderPageLoaded(){super._onDataProviderPageLoaded();this.__tryToRecalculateColumnWidthsIfPending()}_createScrollerRows(t){const e=[];for(let i=0;i<t;i++){const t=document.createElement("tr");t.setAttribute("part","row body-row");t.setAttribute("role","row");t.setAttribute("tabindex","-1");if(this._columnTree){this._updateRow(t,this._columnTree[this._columnTree.length-1],"body",false,true)}e.push(t)}if(this._columnTree){this._columnTree[this._columnTree.length-1].forEach((t=>{if(t.isConnected&&t._cells){t._cells=[...t._cells]}}))}this.__afterCreateScrollerRowsDebouncer=sMt.debounce(this.__afterCreateScrollerRowsDebouncer,tMt,(()=>{this._afterScroll();this.__tryToRecalculateColumnWidthsIfPending()}));return e}_createCell(t,e){const i=this._contentIndex=this._contentIndex+1||0;const n=`vaadin-grid-cell-content-${i}`;const s=document.createElement("vaadin-grid-cell-content");s.setAttribute("slot",n);const r=document.createElement(t);r.id=n.replace("-content-","-");r.setAttribute("role",t==="td"?"gridcell":"columnheader");if(!okt&&!hkt){r.addEventListener("mouseenter",(t=>{if(!this.$.scroller.hasAttribute("scrolling")){this._showTooltip(t)}}));r.addEventListener("mouseleave",(()=>{this._hideTooltip()}));r.addEventListener("mousedown",(()=>{this._hideTooltip(true)}))}if(e&&e._onCellKeyDown){r.addEventListener("keydown",e._onCellKeyDown.bind(e))}const o=document.createElement("slot");o.setAttribute("name",n);if(e&&e._focusButtonMode){const t=document.createElement("div");t.setAttribute("role","button");t.setAttribute("tabindex","-1");r.appendChild(t);r._focusButton=t;r.focus=function(){r._focusButton.focus()};t.appendChild(o)}else{r.setAttribute("tabindex","-1");r.appendChild(o)}r._content=s;s.addEventListener("mousedown",(()=>{if(akt){const t=e=>{const i=s.contains(this.getRootNode().activeElement);const n=e.composedPath().includes(s);if(!i&&n){r.focus()}document.removeEventListener("mouseup",t,true)};document.addEventListener("mouseup",t,true)}else{setTimeout((()=>{if(!s.contains(this.getRootNode().activeElement)){r.focus()}}))}}));return r}_updateRow(t,e,i="body",n=false,s=false){const r=document.createDocumentFragment();MMt(t,(t=>{t._vacant=true}));t.innerHTML="";if(i==="body"){t.__cells=[];t.__detailsCell=null}e.filter((t=>!t.hidden)).forEach(((e,o,a)=>{let l;if(i==="body"){if(!e._cells){e._cells=[]}l=e._cells.find((t=>t._vacant));if(!l){l=this._createCell("td",e);e._cells.push(l)}l.setAttribute("part","cell body-cell");l.__parentRow=t;t.__cells.push(l);const i=t===this.$.sizer;if(!e._bodyContentHidden||i){t.appendChild(l)}if(i){e._sizerCell=l}if(o===a.length-1&&this.rowDetailsRenderer){if(!this._detailsCells){this._detailsCells=[]}const e=this._detailsCells.find((t=>t._vacant))||this._createCell("td");if(this._detailsCells.indexOf(e)===-1){this._detailsCells.push(e)}if(!e._content.parentElement){r.appendChild(e._content)}this._configureDetailsCell(e);t.appendChild(e);t.__detailsCell=e;this._a11ySetRowDetailsCell(t,e);e._vacant=false}if(!s){e._cells=[...e._cells]}}else{const s=i==="header"?"th":"td";if(n||e.localName==="vaadin-grid-column-group"){l=e[`_${i}Cell`]||this._createCell(s,e);l._column=e;t.appendChild(l);e[`_${i}Cell`]=l}else{if(!e._emptyCells){e._emptyCells=[]}l=e._emptyCells.find((t=>t._vacant))||this._createCell(s);l._column=e;t.appendChild(l);if(e._emptyCells.indexOf(l)===-1){e._emptyCells.push(l)}}l.part.add("cell",`${i}-cell`)}if(!l._content.parentElement){r.appendChild(l._content)}l._vacant=false;l._column=e}));if(i!=="body"){this.__debounceUpdateHeaderFooterRowVisibility(t)}this.appendChild(r);this._frozenCellsChanged();this._updateFirstAndLastColumnForRow(t)}__debounceUpdateHeaderFooterRowVisibility(t){t.__debounceUpdateHeaderFooterRowVisibility=sMt.debounce(t.__debounceUpdateHeaderFooterRowVisibility,iMt,(()=>this.__updateHeaderFooterRowVisibility(t)))}__updateHeaderFooterRowVisibility(t){if(!t){return}const e=Array.from(t.children).filter((e=>{const i=e._column;if(i._emptyCells&&i._emptyCells.indexOf(e)>-1){return false}if(t.parentElement===this.$.header){if(i.headerRenderer){return true}if(i.header===null){return false}if(i.path||i.header!==undefined){return true}}else if(i.footerRenderer){return true}return false}));if(t.hidden!==!e.length){t.hidden=!e.length}this._resetKeyboardNavigation()}_updateScrollerItem(t,e){this._preventScrollerRotatingCellFocus(t,e);if(!this._columnTree){return}this._updateRowOrderParts(t,e);this._a11yUpdateRowRowindex(t,e);this._getItem(e,t)}_columnTreeChanged(t){this._renderColumnTree(t);this.recalculateColumnWidths();this.__updateColumnsBodyContentHidden()}_updateRowOrderParts(t,e=t.index){jMt(t,{first:e===0,last:e===this._flatSize-1,odd:e%2!==0,even:e%2===0})}_updateRowStateParts(t,{expanded:e,selected:i,detailsOpened:n}){jMt(t,{expanded:e,collapsed:this.__isRowExpandable(t),selected:i,"details-opened":n})}_renderColumnTree(t){_Mt(this.$.items,(e=>{this._updateRow(e,t[t.length-1],"body",false,true);const i=this.__getRowModel(e);this._updateRowOrderParts(e);this._updateRowStateParts(e,i);this._filterDragAndDrop(e,i)}));while(this.$.header.children.length<t.length){const t=document.createElement("tr");t.setAttribute("part","row");t.setAttribute("role","row");t.setAttribute("tabindex","-1");this.$.header.appendChild(t);const e=document.createElement("tr");e.setAttribute("part","row");e.setAttribute("role","row");e.setAttribute("tabindex","-1");this.$.footer.appendChild(e)}while(this.$.header.children.length>t.length){this.$.header.removeChild(this.$.header.firstElementChild);this.$.footer.removeChild(this.$.footer.firstElementChild)}_Mt(this.$.header,((e,i,n)=>{this._updateRow(e,t[i],"header",i===t.length-1);const s=xMt(e);IMt(s,"first-header-row-cell",i===0);IMt(s,"last-header-row-cell",i===n.length-1)}));_Mt(this.$.footer,((e,i,n)=>{this._updateRow(e,t[t.length-1-i],"footer",i===0);const s=xMt(e);IMt(s,"first-footer-row-cell",i===0);IMt(s,"last-footer-row-cell",i===n.length-1)}));this._updateRow(this.$.sizer,t[t.length-1]);this._resizeHandler();this._frozenCellsChanged();this._updateFirstAndLastColumn();this._resetKeyboardNavigation();this._a11yUpdateHeaderRows();this._a11yUpdateFooterRows();this.generateCellClassNames();this.generateCellPartNames();this.__updateHeaderAndFooter()}_updateItem(t,e){t._item=e;const i=this.__getRowModel(t);this._toggleDetailsCell(t,i.detailsOpened);this._a11yUpdateRowLevel(t,i.level);this._a11yUpdateRowSelected(t,i.selected);this._updateRowStateParts(t,i);this._generateCellClassNames(t,i);this._generateCellPartNames(t,i);this._filterDragAndDrop(t,i);_Mt(t,(t=>{if(t._renderer){const e=t._column||this;t._renderer.call(e,t._content,e,i)}}));this._updateDetailsCellHeight(t);this._a11yUpdateRowExpanded(t,i.expanded)}_resizeHandler(){this._updateDetailsCellHeights();this.__updateHorizontalScrollPosition()}_onAnimationEnd(t){if(t.animationName.indexOf("vaadin-grid-appear")===0){t.stopPropagation();this.__tryToRecalculateColumnWidthsIfPending();requestAnimationFrame((()=>{this.__scrollToPendingIndexes()}))}}__getRowModel(t){return{index:t.index,item:t._item,level:this._getIndexLevel(t.index),expanded:this._isExpanded(t._item),selected:this._isSelected(t._item),detailsOpened:!!this.rowDetailsRenderer&&this._isDetailsOpened(t._item)}}_showTooltip(t){const e=this._tooltipController.node;if(e&&e.isConnected){this._tooltipController.setTarget(t.target);this._tooltipController.setContext(this.getEventContext(t));e._stateController.open({focus:t.type==="focusin",hover:t.type==="mouseenter"})}}_hideTooltip(t){const e=this._tooltipController&&this._tooltipController.node;if(e){e._stateController.close(t)}}requestContentUpdate(){this.__updateHeaderAndFooter();this.__updateVisibleRows()}__updateHeaderAndFooter(){(this._columnTree||[]).forEach((t=>{t.forEach((t=>{if(t._renderHeaderAndFooter){t._renderHeaderAndFooter()}}))}))}__updateVisibleRows(t,e){if(this.__virtualizer){this.__virtualizer.update(t,e)}}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const sAt=Ewt`
  @keyframes vaadin-grid-appear {
    to {
      opacity: 1;
    }
  }

  :host {
    display: flex;
    flex-direction: column;
    animation: 1ms vaadin-grid-appear;
    height: 400px;
    flex: 1 1 auto;
    align-self: stretch;
    position: relative;
  }

  :host([hidden]) {
    display: none !important;
  }

  :host([disabled]) {
    pointer-events: none;
  }

  #scroller {
    display: flex;
    flex-direction: column;
    min-height: 100%;
    transform: translateY(0);
    width: auto;
    height: auto;
    position: absolute;
    inset: 0;
  }

  :host([all-rows-visible]) {
    height: auto;
    align-self: flex-start;
    flex-grow: 0;
    width: 100%;
  }

  :host([all-rows-visible]) #scroller {
    width: 100%;
    height: 100%;
    position: relative;
  }

  :host([all-rows-visible]) #items {
    min-height: 1px;
  }

  #table {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    overflow: auto;
    position: relative;
    outline: none;
    /* Workaround for a Desktop Safari bug: new stacking context here prevents the scrollbar from getting hidden */
    z-index: 0;
  }

  #header,
  #footer {
    display: block;
    position: -webkit-sticky;
    position: sticky;
    left: 0;
    overflow: visible;
    width: 100%;
    z-index: 1;
  }

  #header {
    top: 0;
  }

  th {
    text-align: inherit;
  }

  /* Safari doesn't work with "inherit" */
  [safari] th {
    text-align: initial;
  }

  #footer {
    bottom: 0;
  }

  #items {
    flex-grow: 1;
    flex-shrink: 0;
    display: block;
    position: -webkit-sticky;
    position: sticky;
    width: 100%;
    left: 0;
    overflow: visible;
  }

  [part~='row'] {
    display: flex;
    width: 100%;
    box-sizing: border-box;
    margin: 0;
  }

  [part~='row'][loading] [part~='body-cell'] ::slotted(vaadin-grid-cell-content) {
    visibility: hidden;
  }

  [column-rendering='lazy'] [part~='body-cell']:not([frozen]):not([frozen-to-end]) {
    transform: translateX(var(--_grid-lazy-columns-start));
  }

  #items [part~='row'] {
    position: absolute;
  }

  #items [part~='row']:empty {
    height: 100%;
  }

  [part~='cell']:not([part~='details-cell']) {
    flex-shrink: 0;
    flex-grow: 1;
    box-sizing: border-box;
    display: flex;
    width: 100%;
    position: relative;
    align-items: center;
    padding: 0;
    white-space: nowrap;
  }

  [part~='cell'] > [tabindex] {
    display: flex;
    align-items: inherit;
    outline: none;
    position: absolute;
    inset: 0;
  }

  [part~='details-cell'] {
    position: absolute;
    bottom: 0;
    width: 100%;
    box-sizing: border-box;
    padding: 0;
  }

  [part~='cell'] ::slotted(vaadin-grid-cell-content) {
    display: block;
    width: 100%;
    box-sizing: border-box;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  [hidden] {
    display: none !important;
  }

  [frozen],
  [frozen-to-end] {
    z-index: 2;
    will-change: transform;
  }

  [no-scrollbars][safari] #table,
  [no-scrollbars][firefox] #table {
    overflow: hidden;
  }

  /* Reordering styles */
  :host([reordering]) [part~='cell'] ::slotted(vaadin-grid-cell-content),
  :host([reordering]) [part~='resize-handle'],
  #scroller[no-content-pointer-events] [part~='cell'] ::slotted(vaadin-grid-cell-content) {
    pointer-events: none;
  }

  [part~='reorder-ghost'] {
    visibility: hidden;
    position: fixed;
    pointer-events: none;
    opacity: 0.5;

    /* Prevent overflowing the grid in Firefox */
    top: 0;
    left: 0;
  }

  :host([reordering]) {
    -moz-user-select: none;
    -webkit-user-select: none;
    user-select: none;
  }

  /* Resizing styles */
  [part~='resize-handle'] {
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
    cursor: col-resize;
    z-index: 1;
  }

  [part~='resize-handle']::before {
    position: absolute;
    content: '';
    height: 100%;
    width: 35px;
    transform: translateX(-50%);
  }

  [last-column] [part~='resize-handle']::before,
  [last-frozen] [part~='resize-handle']::before {
    width: 18px;
    transform: none;
    right: 0;
  }

  [frozen-to-end] [part~='resize-handle'] {
    left: 0;
    right: auto;
  }

  [frozen-to-end] [part~='resize-handle']::before {
    left: 0;
    right: auto;
  }

  [first-frozen-to-end] [part~='resize-handle']::before {
    width: 18px;
    transform: none;
  }

  [first-frozen-to-end] {
    margin-inline-start: auto;
  }

  /* Hide resize handle if scrolled to end */
  :host(:not([overflow~='end'])) [first-frozen-to-end] [part~='resize-handle'] {
    display: none;
  }

  #scroller[column-resizing] {
    -ms-user-select: none;
    -moz-user-select: none;
    -webkit-user-select: none;
    user-select: none;
  }

  /* Sizer styles */
  #sizer {
    display: flex;
    position: absolute;
    visibility: hidden;
  }

  #sizer [part~='details-cell'] {
    display: none !important;
  }

  #sizer [part~='cell'][hidden] {
    display: none !important;
  }

  #sizer [part~='cell'] {
    display: block;
    flex-shrink: 0;
    line-height: 0;
    height: 0 !important;
    min-height: 0 !important;
    max-height: 0 !important;
    padding: 0 !important;
    border: none !important;
  }

  #sizer [part~='cell']::before {
    content: '-';
  }

  #sizer [part~='cell'] ::slotted(vaadin-grid-cell-content) {
    display: none !important;
  }

  /* RTL specific styles */

  :host([dir='rtl']) #items,
  :host([dir='rtl']) #header,
  :host([dir='rtl']) #footer {
    left: auto;
  }

  :host([dir='rtl']) [part~='reorder-ghost'] {
    left: auto;
    right: 0;
  }

  :host([dir='rtl']) [part~='resize-handle'] {
    left: 0;
    right: auto;
  }

  :host([dir='rtl']) [part~='resize-handle']::before {
    transform: translateX(50%);
  }

  :host([dir='rtl']) [last-column] [part~='resize-handle']::before,
  :host([dir='rtl']) [last-frozen] [part~='resize-handle']::before {
    left: 0;
    right: auto;
  }

  :host([dir='rtl']) [frozen-to-end] [part~='resize-handle'] {
    right: 0;
    left: auto;
  }

  :host([dir='rtl']) [frozen-to-end] [part~='resize-handle']::before {
    right: 0;
    left: auto;
  }

  @media (forced-colors: active) {
    [part~='selected-row'] [part~='first-column-cell']::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      border: 2px solid;
    }

    [part~='focused-cell']::before {
      outline: 2px solid !important;
      outline-offset: -1px;
    }
  }
`
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;$bt("vaadin-grid",sAt,{moduleId:"vaadin-grid-styles"});class rAt extends(nAt(KMt(Hbt(PMt(W_t))))){static get template(){return q_t`
      <div
        id="scroller"
        safari$="[[_safari]]"
        ios$="[[_ios]]"
        loading$="[[loading]]"
        column-reordering-allowed$="[[columnReorderingAllowed]]"
      >
        <table id="table" role="treegrid" aria-multiselectable="true" tabindex="0">
          <caption id="sizer" part="row"></caption>
          <thead id="header" role="rowgroup"></thead>
          <tbody id="items" role="rowgroup"></tbody>
          <tfoot id="footer" role="rowgroup"></tfoot>
        </table>

        <div part="reorder-ghost"></div>
      </div>

      <slot name="tooltip"></slot>

      <div id="focusexit" tabindex="0"></div>
    `}static get is(){return"vaadin-grid"}}_wt(rAt);
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const oAt=t=>class extends(LMt(t)){static get properties(){return{_childColumns:{value(){return this._getChildColumns(this)}},flexGrow:{type:Number,readOnly:true,sync:true},width:{type:String,readOnly:true},_visibleChildColumns:Array,_colSpan:Number,_rootColumns:Array}}static get observers(){return["_groupFrozenChanged(frozen, _rootColumns)","_groupFrozenToEndChanged(frozenToEnd, _rootColumns)","_groupHiddenChanged(hidden)","_colSpanChanged(_colSpan, _headerCell, _footerCell)","_groupOrderChanged(_order, _rootColumns)","_groupReorderStatusChanged(_reorderStatus, _rootColumns)","_groupResizableChanged(resizable, _rootColumns)"]}connectedCallback(){super.connectedCallback();this._addNodeObserver();this._updateFlexAndWidth()}disconnectedCallback(){super.disconnectedCallback();if(this._observer){this._observer.disconnect()}}_columnPropChanged(t,e){if(t==="hidden"){this._preventHiddenSynchronization=true;this._updateVisibleChildColumns(this._childColumns);this._preventHiddenSynchronization=false}if(/flexGrow|width|hidden|_childColumns/u.test(t)){this._updateFlexAndWidth()}if(t==="frozen"&&!this.frozen){this.frozen=e}if(t==="lastFrozen"&&!this._lastFrozen){this._lastFrozen=e}if(t==="frozenToEnd"&&!this.frozenToEnd){this.frozenToEnd=e}if(t==="firstFrozenToEnd"&&!this._firstFrozenToEnd){this._firstFrozenToEnd=e}}_groupOrderChanged(t,e){if(e){const i=e.slice(0);if(!t){i.forEach((t=>{t._order=0}));return}const n=/(0+)$/u.exec(t).pop().length;const s=~~(Math.log(e.length)/Math.LN10)+1;const r=10**(n-s);if(i[0]&&i[0]._order){i.sort(((t,e)=>t._order-e._order))}kMt(i,r,t)}}_groupReorderStatusChanged(t,e){if(t===undefined||e===undefined){return}e.forEach((e=>{e._reorderStatus=t}))}_groupResizableChanged(t,e){if(t===undefined||e===undefined){return}e.forEach((e=>{e.resizable=t}))}_updateVisibleChildColumns(t){this._visibleChildColumns=Array.prototype.filter.call(t,(t=>!t.hidden));this._colSpan=this._visibleChildColumns.length;this._updateAutoHidden()}_updateFlexAndWidth(){if(!this._visibleChildColumns){return}if(this._visibleChildColumns.length>0){const t=this._visibleChildColumns.reduce(((t,e)=>{t+=` + ${(e.width||"0px").replace("calc","")}`;return t}),"").substring(3);this._setWidth(`calc(${t})`)}else{this._setWidth("0px")}this._setFlexGrow(Array.prototype.reduce.call(this._visibleChildColumns,((t,e)=>t+e.flexGrow),0))}__scheduleAutoFreezeWarning(t,e){if(this._grid){const i=e.replace(/([A-Z])/gu,"-$1").toLowerCase();const n=t[0][e]||t[0].hasAttribute(i);const s=t.every((t=>(t[e]||t.hasAttribute(i))===n));if(!s){this._grid.__autoFreezeWarningDebouncer=sMt.debounce(this._grid.__autoFreezeWarningDebouncer,tMt,(()=>{console.warn(`WARNING: Joining ${e} and non-${e} Grid columns inside the same column group! `+`This will automatically freeze all the joined columns to avoid rendering issues. `+`If this was intentional, consider marking each joined column explicitly as ${e}. `+`Otherwise, exclude the ${e} columns from the joined group.`)}))}}}_groupFrozenChanged(t,e){if(e===undefined||t===undefined){return}if(t!==false){this.__scheduleAutoFreezeWarning(e,"frozen");Array.from(e).forEach((e=>{e.frozen=t}))}}_groupFrozenToEndChanged(t,e){if(e===undefined||t===undefined){return}if(t!==false){this.__scheduleAutoFreezeWarning(e,"frozenToEnd");Array.from(e).forEach((e=>{e.frozenToEnd=t}))}}_groupHiddenChanged(t){if(t||this.__groupHiddenInitialized){this._synchronizeHidden()}this.__groupHiddenInitialized=true}_updateAutoHidden(){const t=this._autoHidden;this._autoHidden=(this._visibleChildColumns||[]).length===0;if(t||this._autoHidden){this.hidden=this._autoHidden}}_synchronizeHidden(){if(this._childColumns&&!this._preventHiddenSynchronization){this._childColumns.forEach((t=>{t.hidden=this.hidden}))}}_colSpanChanged(t,e,i){if(e){e.setAttribute("colspan",t);if(this._grid){this._grid._a11yUpdateCellColspan(e,t)}}if(i){i.setAttribute("colspan",t);if(this._grid){this._grid._a11yUpdateCellColspan(i,t)}}}_getChildColumns(t){return OMt.getColumns(t)}_addNodeObserver(){this._observer=new OMt(this,(()=>{this._preventHiddenSynchronization=true;this._rootColumns=this._getChildColumns(this);this._childColumns=this._rootColumns;this._updateVisibleChildColumns(this._childColumns);this._preventHiddenSynchronization=false;if(this._grid&&this._grid._debounceUpdateColumnTree){this._grid._debounceUpdateColumnTree()}}));this._observer.flush()}_isColumnElement(t){return t.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/u.test(t.localName)}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class aAt extends(oAt(W_t)){static get is(){return"vaadin-grid-column-group"}}_wt(aAt);
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const lAt=kSt((t=>class e extends t{static get properties(){return{stateTarget:{type:Object,observer:"_stateTargetChanged"}}}static get delegateAttrs(){return[]}static get delegateProps(){return[]}ready(){super.ready();this._createDelegateAttrsObserver();this._createDelegatePropsObserver()}_stateTargetChanged(t){if(t){this._ensureAttrsDelegated();this._ensurePropsDelegated()}}_createDelegateAttrsObserver(){this._createMethodObserver(`_delegateAttrsChanged(${this.constructor.delegateAttrs.join(", ")})`)}_createDelegatePropsObserver(){this._createMethodObserver(`_delegatePropsChanged(${this.constructor.delegateProps.join(", ")})`)}_ensureAttrsDelegated(){this.constructor.delegateAttrs.forEach((t=>{this._delegateAttribute(t,this[t])}))}_ensurePropsDelegated(){this.constructor.delegateProps.forEach((t=>{this._delegateProperty(t,this[t])}))}_delegateAttrsChanged(...t){this.constructor.delegateAttrs.forEach(((e,i)=>{this._delegateAttribute(e,t[i])}))}_delegatePropsChanged(...t){this.constructor.delegateProps.forEach(((e,i)=>{this._delegateProperty(e,t[i])}))}_delegateAttribute(t,e){if(!this.stateTarget){return}if(t==="invalid"){this._delegateAttribute("aria-invalid",e?"true":false)}if(typeof e==="boolean"){this.stateTarget.toggleAttribute(t,e)}else if(e){this.stateTarget.setAttribute(t,e)}else{this.stateTarget.removeAttribute(t)}}_delegateProperty(t,e){if(!this.stateTarget){return}this.stateTarget[t]=e}}));
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const uAt=kSt((t=>class e extends t{static get properties(){return{inputElement:{type:Object,readOnly:true,observer:"_inputElementChanged"},type:{type:String,readOnly:true},value:{type:String,value:"",observer:"_valueChanged",notify:true,sync:true},_hasInputValue:{type:Boolean,value:false,observer:"_hasInputValueChanged"}}}constructor(){super();this._boundOnInput=this.__onInput.bind(this);this._boundOnChange=this._onChange.bind(this)}get _hasValue(){return this.value!=null&&this.value!==""}get _inputElementValueProperty(){return"value"}get _inputElementValue(){return this.inputElement?this.inputElement[this._inputElementValueProperty]:undefined}set _inputElementValue(t){if(this.inputElement){this.inputElement[this._inputElementValueProperty]=t}}clear(){this._hasInputValue=false;this.value="";this._inputElementValue=""}_addInputListeners(t){t.addEventListener("input",this._boundOnInput);t.addEventListener("change",this._boundOnChange)}_removeInputListeners(t){t.removeEventListener("input",this._boundOnInput);t.removeEventListener("change",this._boundOnChange)}_forwardInputValue(t){if(!this.inputElement){return}this._inputElementValue=t!=null?t:""}_inputElementChanged(t,e){if(t){this._addInputListeners(t)}else if(e){this._removeInputListeners(e)}}_hasInputValueChanged(t,e){if(t||e){this.dispatchEvent(new CustomEvent("has-input-value-changed"))}}__onInput(t){this._setHasInputValue(t);this._onInput(t)}_onInput(t){const e=t.composedPath()[0];this.__userInput=t.isTrusted;this.value=e.value;this.__userInput=false}_onChange(t){}_toggleHasValue(t){this.toggleAttribute("has-value",t)}_valueChanged(t,e){this._toggleHasValue(this._hasValue);if(t===""&&e===undefined){return}if(this.__userInput){return}this._forwardInputValue(t)}_setHasInputValue(t){const e=t.composedPath()[0];this._hasInputValue=e.value.length>0}}));
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const cAt=kSt((t=>class e extends(lAt(ekt(uAt(t)))){static get properties(){return{checked:{type:Boolean,value:false,notify:true,reflectToAttribute:true}}}static get delegateProps(){return[...super.delegateProps,"checked"]}_onChange(t){const e=t.target;this._toggleChecked(e.checked)}_toggleChecked(t){this.checked=t}}));
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class hAt extends gkt{constructor(t,e){super(t,"input","input",{initializer:(t,i)=>{if(i.value){t.value=i.value}if(i.type){t.setAttribute("type",i.type)}t.id=this.defaultId;if(typeof e==="function"){e(t)}},useUniqueId:true})}}
/**
 * @license
 * Copyright (c) 2022 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class dAt extends gkt{constructor(t,e,i,n={}){super(t,e,i,{...n,useUniqueId:true})}initCustomNode(t){this.__updateNodeId(t);this.__notifyChange(t)}teardownNode(t){const e=this.getSlotChild();if(e&&e!==this.defaultNode){this.__notifyChange(e)}else{this.restoreDefaultNode();this.updateDefaultNode(this.node)}}attachDefaultNode(){const t=super.attachDefaultNode();if(t){this.__updateNodeId(t)}return t}restoreDefaultNode(){}updateDefaultNode(t){this.__notifyChange(t)}observeNode(t){if(this.__nodeObserver){this.__nodeObserver.disconnect()}this.__nodeObserver=new MutationObserver((t=>{t.forEach((t=>{const e=t.target;const i=e===this.node;if(t.type==="attributes"){if(i){this.__updateNodeId(e)}}else if(i||e.parentElement===this.node){this.__notifyChange(this.node)}}))}));this.__nodeObserver.observe(t,{attributes:true,attributeFilter:["id"],childList:true,subtree:true,characterData:true})}__hasContent(t){if(!t){return false}return t.nodeType===Node.ELEMENT_NODE&&(customElements.get(t.localName)||t.children.length>0)||t.textContent&&t.textContent.trim()!==""}__notifyChange(t){this.dispatchEvent(new CustomEvent("slot-content-changed",{detail:{hasContent:this.__hasContent(t),node:t}}))}__updateNodeId(t){const e=!this.nodes||t===this.nodes[0];if(t.nodeType===Node.ELEMENT_NODE&&(!this.multiple||e)&&!t.id){t.id=this.defaultId}}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class fAt extends dAt{constructor(t){super(t,"label","label")}setLabel(t){this.label=t;const e=this.getSlotChild();if(!e){this.restoreDefaultNode()}if(this.node===this.defaultNode){this.updateDefaultNode(this.node)}}restoreDefaultNode(){const{label:t}=this;if(t&&t.trim()!==""){const t=this.attachDefaultNode();this.observeNode(t)}}updateDefaultNode(t){if(t){t.textContent=this.label}super.updateDefaultNode(t)}initCustomNode(t){super.initCustomNode(t);this.observeNode(t)}}
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const pAt=kSt((t=>class e extends(PMt(t)){static get properties(){return{label:{type:String,observer:"_labelChanged"}}}constructor(){super();this._labelController=new fAt(this);this._labelController.addEventListener("slot-content-changed",(t=>{this.toggleAttribute("has-label",t.detail.hasContent)}))}get _labelId(){const t=this._labelNode;return t&&t.id}get _labelNode(){return this._labelController.node}ready(){super.ready();this.addController(this._labelController)}_labelChanged(t){this._labelController.setLabel(t)}}));
/**
 * @license
 * Copyright (c) 2021 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class mAt{constructor(t,e){this.input=t;this.__preventDuplicateLabelClick=this.__preventDuplicateLabelClick.bind(this);e.addEventListener("slot-content-changed",(t=>{this.__initLabel(t.detail.node)}));this.__initLabel(e.node)}__initLabel(t){if(t){t.addEventListener("click",this.__preventDuplicateLabelClick);if(this.input){t.setAttribute("for",this.input.id)}}}__preventDuplicateLabelClick(){const t=e=>{e.stopImmediatePropagation();this.input.removeEventListener("click",t)};this.input.addEventListener("click",t)}}
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const yAt=t=>class e extends(pAt(cAt(WTt(qTt(t))))){static get properties(){return{indeterminate:{type:Boolean,notify:true,value:false,reflectToAttribute:true},name:{type:String,value:""},tabindex:{type:Number,value:0,reflectToAttribute:true}}}static get delegateProps(){return[...super.delegateProps,"indeterminate"]}static get delegateAttrs(){return[...super.delegateAttrs,"name"]}constructor(){super();this._setType("checkbox");this.value="on"}ready(){super.ready();this.addController(new hAt(this,(t=>{this._setInputElement(t);this._setFocusElement(t);this.stateTarget=t;this.ariaTarget=t})));this.addController(new mAt(this.inputElement,this._labelController))}_shouldSetActive(t){if(t.target.localName==="a"){return false}return super._shouldSetActive(t)}_toggleChecked(t){if(this.indeterminate){this.indeterminate=false}super._toggleChecked(t)}}
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const gAt=Ewt`
  :host {
    display: inline-block;
  }

  :host([hidden]) {
    display: none !important;
  }

  :host([disabled]) {
    -webkit-tap-highlight-color: transparent;
  }

  .vaadin-checkbox-container {
    display: grid;
    grid-template-columns: auto 1fr;
    align-items: baseline;
  }

  [part='checkbox'],
  ::slotted(input),
  ::slotted(label) {
    grid-row: 1;
  }

  [part='checkbox'],
  ::slotted(input) {
    grid-column: 1;
  }

  [part='checkbox'] {
    width: var(--vaadin-checkbox-size, 1em);
    height: var(--vaadin-checkbox-size, 1em);
    --_input-border-width: var(--vaadin-input-field-border-width, 0);
    --_input-border-color: var(--vaadin-input-field-border-color, transparent);
    box-shadow: inset 0 0 0 var(--_input-border-width, 0) var(--_input-border-color);
  }

  [part='checkbox']::before {
    display: block;
    content: '\\202F';
    line-height: var(--vaadin-checkbox-size, 1em);
    contain: paint;
  }

  /* visually hidden */
  ::slotted(input) {
    opacity: 0;
    cursor: inherit;
    margin: 0;
    align-self: stretch;
    -webkit-appearance: none;
    width: initial;
    height: initial;
  }

  @media (forced-colors: active) {
    [part='checkbox'] {
      outline: 1px solid;
      outline-offset: -1px;
    }

    :host([disabled]) [part='checkbox'],
    :host([disabled]) [part='checkbox']::after {
      outline-color: GrayText;
    }

    :host(:is([checked], [indeterminate])) [part='checkbox']::after {
      outline: 1px solid;
      outline-offset: -1px;
      border-radius: inherit;
    }

    :host([focused]) [part='checkbox'],
    :host([focused]) [part='checkbox']::after {
      outline-width: 2px;
    }
  }
`
/**
 * @license
 * Copyright (c) 2017 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;$bt("vaadin-checkbox",gAt,{moduleId:"vaadin-checkbox-styles"});class vAt extends(yAt(KMt(Hbt(W_t)))){static get is(){return"vaadin-checkbox"}static get template(){return q_t`
      <div class="vaadin-checkbox-container">
        <div part="checkbox" aria-hidden="true"></div>
        <slot name="input"></slot>
        <slot name="label"></slot>
      </div>
      <slot name="tooltip"></slot>
    `}ready(){super.ready();this._tooltipController=new vkt(this);this._tooltipController.setAriaTarget(this.inputElement);this.addController(this._tooltipController)}}_wt(vAt);
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const wAt=t=>class e extends t{static get properties(){return{width:{type:String,value:"58px",sync:true},flexGrow:{type:Number,value:0,sync:true},selectAll:{type:Boolean,value:false,notify:true,sync:true},autoSelect:{type:Boolean,value:false,sync:true},dragSelect:{type:Boolean,value:false,sync:true},_indeterminate:{type:Boolean,sync:true},_selectAllHidden:Boolean}}static get observers(){return["_onHeaderRendererOrBindingChanged(_headerRenderer, _headerCell, path, header, selectAll, _indeterminate, _selectAllHidden)"]}_defaultHeaderRenderer(t,e){let i=t.firstElementChild;if(!i){i=document.createElement("vaadin-checkbox");i.setAttribute("aria-label","Select All");i.classList.add("vaadin-grid-select-all-checkbox");t.appendChild(i);i.addEventListener("checked-changed",this.__onSelectAllCheckedChanged.bind(this))}const n=this.__isChecked(this.selectAll,this._indeterminate);i.__rendererChecked=n;i.checked=n;i.hidden=this._selectAllHidden;i.indeterminate=this._indeterminate}_defaultRenderer(t,e,{item:i,selected:n}){let s=t.firstElementChild;if(!s){s=document.createElement("vaadin-checkbox");s.setAttribute("aria-label","Select Row");t.appendChild(s);s.addEventListener("checked-changed",this.__onSelectRowCheckedChanged.bind(this));pTt(t,"track",this.__onCellTrack.bind(this));t.addEventListener("mousedown",this.__onCellMouseDown.bind(this));t.addEventListener("click",this.__onCellClick.bind(this))}s.__item=i;s.__rendererChecked=n;s.checked=n}__onSelectAllCheckedChanged(t){if(t.target.checked===t.target.__rendererChecked){return}if(this._indeterminate||t.target.checked){this._selectAll()}else{this._deselectAll()}}__onSelectRowCheckedChanged(t){if(t.target.checked===t.target.__rendererChecked){return}if(t.target.checked){this._selectItem(t.target.__item)}else{this._deselectItem(t.target.__item)}}__onCellTrack(t){if(!this.dragSelect){return}this.__dragCurrentY=t.detail.y;this.__dragDy=t.detail.dy;if(t.detail.state==="start"){const e=this._grid._getRenderedRows();const i=e.find((e=>e.contains(t.currentTarget.assignedSlot)));this.__selectOnDrag=!this._grid._isSelected(i._item);this.__dragStartIndex=i.index;this.__dragStartItem=i._item;this.__dragAutoScroller()}else if(t.detail.state==="end"){if(this.__dragStartItem){if(this.__selectOnDrag){this._selectItem(this.__dragStartItem)}else{this._deselectItem(this.__dragStartItem)}}setTimeout((()=>{this.__dragStartIndex=undefined}))}}__onCellMouseDown(t){if(this.dragSelect){t.preventDefault()}}__onCellClick(t){if(this.__dragStartIndex!==undefined){t.preventDefault()}}_onCellKeyDown(t){const e=t.composedPath()[0];if(t.keyCode===32&&(e===this._headerCell||this._cells.includes(e)&&!this.autoSelect)){const t=e._content.firstElementChild;t.checked=!t.checked}}__dragAutoScroller(){if(this.__dragStartIndex===undefined){return}const t=this._grid._getRenderedRows();const e=t.find((t=>{const e=t.getBoundingClientRect();return this.__dragCurrentY>=e.top&&this.__dragCurrentY<=e.bottom}));let i=e?e.index:undefined;const n=this.__getScrollableArea();if(this.__dragCurrentY<n.top){i=this._grid._firstVisibleIndex}else if(this.__dragCurrentY>n.bottom){i=this._grid._lastVisibleIndex}if(i!==undefined){t.forEach((t=>{if(i>this.__dragStartIndex&&t.index>=this.__dragStartIndex&&t.index<=i||i<this.__dragStartIndex&&t.index<=this.__dragStartIndex&&t.index>=i){if(this.__selectOnDrag){this._selectItem(t._item)}else{this._deselectItem(t._item)}this.__dragStartItem=undefined}}))}const s=n.height*.15;const r=10;if(this.__dragDy<0&&this.__dragCurrentY<n.top+s){const t=n.top+s-this.__dragCurrentY;const e=Math.min(1,t/s);this._grid.$.table.scrollTop-=e*r}if(this.__dragDy>0&&this.__dragCurrentY>n.bottom-s){const t=this.__dragCurrentY-(n.bottom-s);const e=Math.min(1,t/s);this._grid.$.table.scrollTop+=e*r}setTimeout((()=>this.__dragAutoScroller()),10)}__getScrollableArea(){const t=this._grid.$.table.getBoundingClientRect();const e=this._grid.$.header.getBoundingClientRect();const i=this._grid.$.footer.getBoundingClientRect();return{top:t.top+e.height,bottom:t.bottom-i.height,left:t.left,right:t.right,height:t.height-e.height-i.height,width:t.width}}_selectAll(){}_deselectAll(){}_selectItem(t){}_deselectItem(t){}__isChecked(t,e){return e||t}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const bAt=t=>class extends(wAt(t)){static get properties(){return{__previousActiveItem:Object}}static get observers(){return["__onSelectAllChanged(selectAll)"]}constructor(){super();this.__boundOnActiveItemChanged=this.__onActiveItemChanged.bind(this);this.__boundOnDataProviderChanged=this.__onDataProviderChanged.bind(this);this.__boundOnSelectedItemsChanged=this.__onSelectedItemsChanged.bind(this)}disconnectedCallback(){this._grid.removeEventListener("active-item-changed",this.__boundOnActiveItemChanged);this._grid.removeEventListener("data-provider-changed",this.__boundOnDataProviderChanged);this._grid.removeEventListener("filter-changed",this.__boundOnSelectedItemsChanged);this._grid.removeEventListener("selected-items-changed",this.__boundOnSelectedItemsChanged);super.disconnectedCallback()}connectedCallback(){super.connectedCallback();if(this._grid){this._grid.addEventListener("active-item-changed",this.__boundOnActiveItemChanged);this._grid.addEventListener("data-provider-changed",this.__boundOnDataProviderChanged);this._grid.addEventListener("filter-changed",this.__boundOnSelectedItemsChanged);this._grid.addEventListener("selected-items-changed",this.__boundOnSelectedItemsChanged)}}__onSelectAllChanged(t){if(t===undefined||!this._grid){return}if(!this.__selectAllInitialized){this.__selectAllInitialized=true;return}if(this._selectAllChangeLock){return}if(t&&this.__hasArrayDataProvider()){this.__withFilteredItemsArray((t=>{this._grid.selectedItems=t}))}else{this._grid.selectedItems=[]}}__arrayContains(t,e){return Array.isArray(t)&&Array.isArray(e)&&e.every((e=>t.includes(e)))}_selectAll(){this.selectAll=true}_deselectAll(){this.selectAll=false}_selectItem(t){this._grid.selectItem(t)}_deselectItem(t){this._grid.deselectItem(t)}__onActiveItemChanged(t){const e=t.detail.value;if(this.autoSelect){const t=e||this.__previousActiveItem;if(t){this._grid._toggleItem(t)}}this.__previousActiveItem=e}__hasArrayDataProvider(){return Array.isArray(this._grid.items)&&!!this._grid.dataProvider}__onSelectedItemsChanged(){this._selectAllChangeLock=true;if(this.__hasArrayDataProvider()){this.__withFilteredItemsArray((t=>{if(!this._grid.selectedItems.length){this.selectAll=false;this._indeterminate=false}else if(this.__arrayContains(this._grid.selectedItems,t)){this.selectAll=true;this._indeterminate=false}else{this.selectAll=false;this._indeterminate=true}}))}this._selectAllChangeLock=false}__onDataProviderChanged(){this._selectAllHidden=!Array.isArray(this._grid.items)}__withFilteredItemsArray(t){const e={page:0,pageSize:Infinity,sortOrders:[],filters:this._grid._mapFilters()};this._grid.dataProvider(e,(e=>t(e)))}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class SAt extends(bAt(RMt)){static get is(){return"vaadin-grid-selection-column"}}_wt(SAt);$bt("vaadin-grid-sorter",Ewt`
    :host {
      justify-content: flex-start;
      align-items: baseline;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
      cursor: var(--lumo-clickable-cursor);
    }

    [part='content'] {
      display: inline-block;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    [part='indicators'] {
      margin-left: var(--lumo-space-s);
    }

    [part='indicators']::before {
      transform: scale(0.8);
    }

    :host(:not([direction]):not(:hover)) [part='indicators'] {
      color: var(--lumo-tertiary-text-color);
    }

    :host([direction]) {
      color: var(--vaadin-selection-color-text, var(--lumo-primary-text-color));
    }

    [part='order'] {
      font-size: var(--lumo-font-size-xxs);
      line-height: 1;
    }

    /* RTL specific styles */

    :host([dir='rtl']) [part='indicators'] {
      margin-right: var(--lumo-space-s);
      margin-left: 0;
    }
  `,{moduleId:"lumo-grid-sorter"});
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const xAt=document.createElement("template");xAt.innerHTML=`\n  <style>\n    @font-face {\n      font-family: 'vaadin-grid-sorter-icons';\n      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAQwAA0AAAAABuwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEFAAAABkAAAAcfep+mUdERUYAAAP4AAAAHAAAAB4AJwAOT1MvMgAAAZgAAAA/AAAAYA8TBPpjbWFwAAAB7AAAAFUAAAFeF1fZ4mdhc3AAAAPwAAAACAAAAAgAAAAQZ2x5ZgAAAlgAAABcAAAAnMvguMloZWFkAAABMAAAAC8AAAA2C5Ap72hoZWEAAAFgAAAAHQAAACQGbQPHaG10eAAAAdgAAAAUAAAAHAoAAABsb2NhAAACRAAAABIAAAASAIwAYG1heHAAAAGAAAAAFgAAACAACwAKbmFtZQAAArQAAAECAAACZxWCgKhwb3N0AAADuAAAADUAAABZCrApUXicY2BkYGAA4rDECVrx/DZfGbhZGEDgyqNPOxH0/wNMq5kPALkcDEwgUQBWRA0dAHicY2BkYGA+8P8AAwMLAwgwrWZgZEAFbABY4QM8AAAAeJxjYGRgYOAAQiYGEICQSAAAAi8AFgAAeJxjYGY6yziBgZWBgWkm0xkGBoZ+CM34msGYkZMBFTAKoAkwODAwvmRiPvD/AIMDMxCD1CDJKjAwAgBktQsXAHicY2GAAMZQCM0EwqshbAALxAEKeJxjYGBgZoBgGQZGBhCIAPIYwXwWBhsgzcXAwcAEhIwMCi+Z/v/9/x+sSuElA4T9/4k4K1gHFwMMMILMY2QDYmaoABOQYGJABUA7WBiGNwAAJd4NIQAAAAAAAAAACAAIABAAGAAmAEAATgAAeJyNjLENgDAMBP9tIURJwQCMQccSZgk2i5fIYBDAidJjycXr7x5EPwE2wY8si7jmyBNXGo/bNBerxJNrpxhbO3/fEFpx8ZICpV+ghxJ74fAMe+h7Ox14AbrsHB14nK2QQWrDMBRER4mTkhQK3ZRQKOgCNk7oGQqhhEIX2WSlWEI1BAlkJ5CDdNsj5Ey9Rncdi38ES+jzNJo/HwTgATcoDEthhY3wBHc4CE+pfwsX5F/hGe7Vo/AcK/UhvMSz+mGXKhZU6pww8ISz3oWn1BvhgnwTnuEJf8Jz1OpFeIlX9YULDLdFi4ASHolkSR0iuYdjLak1vAequBhj21D61Nqyi6l3qWybGPjySbPHGScGJl6dP58MYcQRI0bts7mjebBqrFENH7t3qWtj0OuqHnXcW7b0HOTZFnKryRGW2hFX1m0O2vEM3opNMfTau+CS6Z3Vx6veNnEXY6jwDxhsc2gAAHicY2BiwA84GBgYmRiYGJkZmBlZGFkZ2djScyoLMgzZS/MyDQwMwLSrpYEBlIbxjQDrzgsuAAAAAAEAAf//AA94nGNgZGBg4AFiMSBmYmAEQnYgZgHzGAAD6wA2eJxjYGBgZACCKyoz1cD0o087YTQATOcIewAAAA==) format('woff');\n      font-weight: normal;\n      font-style: normal;\n    }\n  </style>\n`;document.head.appendChild(xAt.content);$bt("vaadin-grid-sorter",Ewt`
    :host {
      display: inline-flex;
      cursor: pointer;
      max-width: 100%;
    }

    [part='content'] {
      flex: 1 1 auto;
    }

    [part='indicators'] {
      position: relative;
      align-self: center;
      flex: none;
    }

    [part='order'] {
      display: inline;
      vertical-align: super;
    }

    [part='indicators']::before {
      font-family: 'vaadin-grid-sorter-icons';
      display: inline-block;
    }

    :host(:not([direction])) [part='indicators']::before {
      content: '\\e901';
    }

    :host([direction='asc']) [part='indicators']::before {
      content: '\\e900';
    }

    :host([direction='desc']) [part='indicators']::before {
      content: '\\e902';
    }
  `,{moduleId:"vaadin-grid-sorter-styles"});const _At=t=>class e extends t{static get properties(){return{path:String,direction:{type:String,reflectToAttribute:true,notify:true,value:null,sync:true},_order:{type:Number,value:null,sync:true},_isConnected:{type:Boolean,observer:"__isConnectedChanged"}}}static get observers(){return["_pathOrDirectionChanged(path, direction)"]}ready(){super.ready();this.addEventListener("click",this._onClick.bind(this))}connectedCallback(){super.connectedCallback();this._isConnected=true}disconnectedCallback(){super.disconnectedCallback();this._isConnected=false;if(!this.parentNode&&this._grid){this._grid.__removeSorters([this])}}_pathOrDirectionChanged(){this.__dispatchSorterChangedEvenIfPossible()}__isConnectedChanged(t,e){if(e===false){return}this.__dispatchSorterChangedEvenIfPossible()}__dispatchSorterChangedEvenIfPossible(){if(this.path===undefined||this.direction===undefined||!this._isConnected){return}this.dispatchEvent(new CustomEvent("sorter-changed",{detail:{shiftClick:Boolean(this._shiftClick),fromSorterClick:Boolean(this._fromSorterClick)},bubbles:true,composed:true}));this._fromSorterClick=false;this._shiftClick=false}_getDisplayOrder(t){return t===null?"":t+1}_onClick(t){if(t.defaultPrevented){return}const e=this.getRootNode().activeElement;if(this!==e&&this.contains(e)){return}t.preventDefault();this._shiftClick=t.shiftKey;this._fromSorterClick=true;if(this.direction==="asc"){this.direction="desc"}else if(this.direction==="desc"){this.direction=null}else{this.direction="asc"}}}
/**
 * @license
 * Copyright (c) 2016 - 2023 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class MAt extends(_At(Hbt(fMt(W_t)))){static get template(){return q_t`
      <div part="content">
        <slot></slot>
      </div>
      <div part="indicators">
        <span part="order">[[_getDisplayOrder(_order)]]</span>
      </div>
    `}static get is(){return"vaadin-grid-sorter"}}_wt(MAt);let kAt=class extends Pm.EventedAccessor{constructor(t){super(t),this.cellClassNameGenerator=null,this.cellPartNameGenerator=(t,e)=>{const i=this.findColumn(t?.path);let n="";return i?(i.invalid&&(n+=" invalid"),"activeEditInfo"in i&&i.activeEditInfo&&i.activeEditInfo.rowData?.index===e.index&&(n+=" editing"),n):n},this.columnPerformanceModeEnabled=!0,this.columnReorderingEnabled=!0,this.columns=new ty,this.dataProvider=async(t,e)=>{const{store:i}=this;if(!e)return;if(!i)return void(e&&e([]));e(await i.fetchItems(t))},this.multiSortEnabled=!1,this.pageSize=50,this.rowDetailsRenderer=null,this.store=null}get highlightIds(){return this._get("highlightIds")||new ty}set highlightIds(t){Array.isArray(t)?this._set("highlightIds",new ty(t)):this._set("highlightIds",t)}get size(){return this.store?.count||0}get state(){const{store:t}=this;return t&&"disabled"!==t.state?"loading"===t.state?"loading":"loaded"===t.state?"loaded":"ready":"disabled"}closeColumnMenus(){this.columns?.forEach((t=>{t.menu&&t.menu.open&&t.menu.set("open",!1)}))}sortColumn(t,e){if(!t)return;const i=this.findColumn(t);i&&(i.direction=e)}hideColumn(t){const e=this.findColumn(t);!1===e?.hidden&&(e.hidden=!0)}showColumn(t){const e=this.findColumn(t);e?.hidden&&(e.hidden=!1)}showAllColumns(){this.columns?.forEach((t=>{t.hidden&&(t.hidden=!1)}))}findColumn(t){const e=[];return this.columns.forEach((t=>{e.push(t),"columns"in t&&t.columns?.forEach((t=>e.push(t)))})),e.find((e=>e.path===t))}getRowItemAt(t){return this.store?.getLocalItemAt(t)}refresh(){this.store&&(this.store.reset(),this.store.load())}};o([Us()],kAt.prototype,"cellClassNameGenerator",void 0),o([Us()],kAt.prototype,"cellPartNameGenerator",void 0),o([Us()],kAt.prototype,"columnPerformanceModeEnabled",void 0),o([Us()],kAt.prototype,"columnReorderingEnabled",void 0),o([Us()],kAt.prototype,"columns",void 0),o([Us()],kAt.prototype,"dataProvider",void 0),o([Us()],kAt.prototype,"highlightIds",null),o([Us()],kAt.prototype,"multiSortEnabled",void 0),o([Us()],kAt.prototype,"pageSize",void 0),o([Us()],kAt.prototype,"rowDetailsRenderer",void 0),o([Us({readOnly:!0})],kAt.prototype,"size",null),o([Us()],kAt.prototype,"store",void 0),o([Us({readOnly:!0})],kAt.prototype,"state",null),kAt=o([Nr("esri.widgets.FeatureTable.Grid.GridViewModel")],kAt);const TAt=kAt;const AAt={selectionColumn:!0,columnMenus:!0},IAt="esri-grid",jAt="compact column-borders",CAt={base:IAt,content:`${IAt}__content`,grid:`${IAt}__grid`,noColumnMenu:`${IAt}--no-column-menu`};let EAt=class extends CK{constructor(t,e){super(t,e),this._columnElements=[],this._grid=null,this.itemIdPath=null,this.messages=null,this.viewModel=new TAt,this.visibleElements={...AAt}}initialize(){this.addHandles([this.columns.on("before-changes",(()=>this.renderNow())),this.columns.on("change",(()=>this.onColumnChange())),fy((()=>this.viewModel?.size),(()=>this._updateGridSize())),fy((()=>this.store?.state),((t,e)=>{"ready"!==t||"loaded"!==e&&"error"!==e||this.refreshPageCache()})),yy((()=>this._grid?.$?.table),"scroll",(()=>this.viewModel?.closeColumnMenus()))])}destroy(){this.resetColumns(),this.columns.destroyed||this.columns.destroy()}resetColumns(){this.columns.drain((t=>!t.destroyed&&t.destroy()))}get _activeEditInfos(){return this._editorColumns.map((t=>t.activeEditInfo)).filter(F)}get _editorColumns(){return this.columns.filter((t=>"activeEditInfo"in t)).toArray()}get cellClassNameGenerator(){return this.viewModel.cellClassNameGenerator}set cellClassNameGenerator(t){this.viewModel.cellClassNameGenerator=t}get cellPartNameGenerator(){return this.viewModel.cellPartNameGenerator}set cellPartNameGenerator(t){this.viewModel.cellPartNameGenerator=t}get columns(){return this.viewModel.columns}set columns(t){this.viewModel.columns=t}get columnPerformanceModeEnabled(){return this.viewModel.columnPerformanceModeEnabled}set columnPerformanceModeEnabled(t){this.viewModel.columnPerformanceModeEnabled=t}get columnReorderingEnabled(){return this.viewModel.columnReorderingEnabled}set columnReorderingEnabled(t){this.viewModel.columnReorderingEnabled=t}get dataProvider(){return this.viewModel.dataProvider}set dataProvider(t){this.viewModel.dataProvider=t}get highlightIds(){return this.viewModel.highlightIds}set highlightIds(t){this.viewModel.highlightIds=t}get isEditingActive(){return!!this._activeEditInfos.length}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get multiSortEnabled(){return this.viewModel.multiSortEnabled}set multiSortEnabled(t){this.viewModel.multiSortEnabled=t}get pageSize(){return this.viewModel.pageSize}set pageSize(t){this.viewModel.pageSize=t}get rowDetailsRenderer(){return this.viewModel.rowDetailsRenderer}set rowDetailsRenderer(t){this.viewModel.rowDetailsRenderer=t}get size(){return this.viewModel.size}get sortOrders(){return this._grid?._sorters?this._grid._sorters.filter((t=>!!t&&t.path)).map((({direction:t,path:e})=>({direction:t,path:e}))):[]}get store(){return this.viewModel.store}set store(t){this.viewModel.store=t}castVisibleElements(t){return{...AAt,...t}}getColumnProps(t,e){const{id:i}=this,{autoWidth:n,direction:s,flexGrow:r,frozen:o,frozenToEnd:a,header:l,hidden:u,invalid:c,path:h,resizable:d,textAlign:f,width:p}=t,m=`${i}_${l}_${e??h}`,{renderFunction:y,footerRenderFunction:g,headerRenderFunction:v}=t,w=g?(t,e)=>g({root:t,column:e}):void 0,b=v?(t,e)=>v({root:t,column:e}):void 0,S=y?(t,e,i)=>y({root:t,column:e,rowData:i}):void 0;return{footerRenderer:w,headerRenderer:b,renderer:S,autoWidth:n,direction:s,flexGrow:r,frozen:o,frozenToEnd:a,header:l,hidden:u,key:m,path:h,resizable:d,bind:this,headerPartName:c?"invalid":void 0,"text-align":f,width:"number"==typeof p?`${p}px`:p,afterCreate:this._afterColumnCreate,afterRemoved:this._afterColumnRemoved}}clearSelection(){this._clearSelection(),this.scheduleRender()}clearSort(){let t=!1;if(this._grid){if(this._grid._sorters?.length&&(this._grid._sorters.forEach((t=>{t._order=null,t.direction=null})),t=!0),this.columns.length){this.columns.some((t=>!!t.direction))&&(this.columns.forEach((t=>t.direction=null)),t=!0)}t&&(this.notifyChange("sortOrders"),this.scheduleRender())}}findColumn(t){this.viewModel.findColumn(t)}generateCellClassNames(){this._grid?.generateCellClassNames()}generateCellPartNames(){this._grid?.generateCellPartNames()}getRowContainingNode(t){return this._grid?._getRowContainingNode(t)}getSlotElementByName(t){return this._grid?.shadowRoot?.querySelector(`slot[name='${t}']`)??null}hideColumn(t){this.viewModel?.hideColumn(t)}recalculateColumnWidths(){this._grid?.recalculateColumnWidths()}async reset(){this._clearSelection(),await(this.store?.reset()),this.scrollToTop()}refreshPageCache(){this._grid?.clearCache()}selectRows(t){const e=t?.filter((t=>!this.highlightIds.includes(t.objectId))),i=e.map((t=>t.objectId));i.length&&this.highlightIds.addMany(i)}deselectRows(t){const e=t?.map((t=>t.objectId))||[];e.length&&this.highlightIds.removeMany(e)}showColumn(t){this.viewModel?.showColumn(t)}sort({path:t,direction:e}){this.viewModel?.sortColumn(t,e),this.notifyChange("sortOrders")}scrollToIndex(t){this._grid?.scrollToIndex(t)}scrollToTop(){this._grid?.scrollToIndex(0)}onColumnChange(){this._columnElements.forEach((t=>{this._applyRenderersToColumnElement(t)})),this._grid?.requestContentUpdate()}render(){const{columnMenus:t}=this.visibleElements;return ZK("div",{bind:this,class:this.classes(CAt.base,zK.widget,{[CAt.noColumnMenu]:!t})},ZK("div",{bind:this,class:CAt.content},this._renderGrid()))}_renderGrid(){const t=this.highlightIds.map((t=>this.store?.getLocalItemByKey(t)||{objectId:t})).toArray(),e=this.columnPerformanceModeEnabled?"lazy":"eager";return ZK("vaadin-grid",{afterCreate:this._afterGridCreate,afterUpdate:this._afterGridUpdate,bind:this,cellClassNameGenerator:this.cellClassNameGenerator,cellPartNameGenerator:this.cellPartNameGenerator,class:CAt.grid,columnRendering:e,columnReorderingAllowed:this.columnReorderingEnabled,dataProvider:this.dataProvider,id:`${this.id}_grid`,itemIdPath:this.itemIdPath,multiSort:this.multiSortEnabled,pageSize:this.pageSize,ref:"grid",rowDetailsRenderer:this.rowDetailsRenderer,selectedItems:t,size:this.size},this._renderAllColumns())}_renderAllColumns(){return"disabled"!==this.viewModel.state&&this.columns.length?[this._renderSelectionColumn(),this._renderColumns()]:null}_renderSelectionColumn(){return ZK("vaadin-grid-selection-column",{_selectAllHidden:!0,bind:this,dragSelect:!0,frozen:!0,hidden:!this.visibleElements.selectionColumn,selectAll:!1,sortable:!1,textAlign:"center"})}_renderColumns(){return Array.from(this.columns,((t,e)=>"columns"in t?this._renderGroupColumn(t,e):ZK("vaadin-grid-column",{...this.getColumnProps(t,e)}))).filter(F)}_renderGroupColumn(t,e){const i=this.getColumnProps(t,e);if(i.hidden||!t.columns)return null;const n=t.columns.filter((({hidden:t})=>!t));return n.length?ZK("vaadin-grid-column-group",{...i},n.map((t=>ZK("vaadin-grid-column",{...this.getColumnProps(t,e)})))):null}_afterGridCreate(t){const e=this._grid=t;e.setAttribute("theme",jAt),customElements.whenDefined("vaadin-grid").then((()=>{this._appendStyles(),this._addGridEventListeners()})),e.__updateSorter=t=>{const i=e._sorters,n=!i.includes(t);if(t.direction||!n)if(t._order=null,e.multiSort)e._removeArrayItem(i,t),t.direction&&(null!=t._initialOrder?(n?i[t._initialOrder]=t:i.splice(t._initialOrder,0,t),t._initialOrder=null):i.unshift(t)),e.__updateSortOrders();else if(t.direction){const n=i.filter((e=>e!==t));e._sorters=[t],n.forEach((t=>{t._order=null,t.direction=null}))}}}_appendStyles(){const t=this._grid?.shadowRoot,e=document.createElement("style");t&&(e.textContent='\n      #items [part~="row"][editing], \n      #items [part~="row"][editing][selected] { \n        z-index: 2; \n      }\n\n      #items [part~="editing"],\n      #items [part~="editing"][selected] {\n        z-index: 3;\n      }\n\n      [frozen], [frozen-to-end] {\n        z-index: 4;\n      }\n    ',t.appendChild(e))}_afterGridUpdate(t){this._grid||(this._grid=t)}_afterColumnCreate(t){this._columnElements.push(t)}_afterColumnRemoved(t){const e=this._columnElements.indexOf(t,0);e>-1&&this._columnElements.splice(e,1)}_updateGridSize(){this._grid&&(this._grid.size=this.size||0,this.scheduleRender())}_addGridEventListeners(){const t=this._grid;Dt(t),this.addHandles([Mi(t,"click",(t=>this._onRowClick(t))),Mi(t,"selected-items-changed",(t=>this._onSelectedItemsChange(t))),Mi(t,"sorter-changed",(()=>this.notifyChange("sortOrders")))])}_onRowClick(t){const e=this._grid;Dt(e);const i=e.getEventContext(t),{item:n,section:s}=i;n&&s&&"details"!==s&&"header"!==s&&this.emit("row-click",{context:i,native:t})}_clearSelection(){this.highlightIds.removeAll()}_onSelectedItemsChange(t){const{highlightIds:e}=this,i=t.detail.value.map((t=>t.objectId)),n=i.filter((t=>!e.includes(t))),s=e.filter((t=>!i.includes(t)));e.removeMany(s),e.addMany(n)}_applyRenderersToColumnElement(t){const e=t?.path,i=null!=e?this.viewModel.findColumn(e):void 0;if(i)try{const{renderFunction:e,footerRenderFunction:n,headerRenderFunction:s}=i;e&&"renderer"in t&&(t.renderer=(t,i,n)=>e({root:t,column:i,rowData:n})),n&&(t.footerRenderer=(t,e)=>n({root:t,column:e})),s&&(t.headerRenderer=(t,e)=>s({root:t,column:e}))}catch(t){}}};o([Us()],EAt.prototype,"_activeEditInfos",null),o([Us()],EAt.prototype,"_columnElements",void 0),o([Us()],EAt.prototype,"_editorColumns",null),o([Us()],EAt.prototype,"_grid",void 0),o([Us()],EAt.prototype,"cellClassNameGenerator",null),o([Us()],EAt.prototype,"cellPartNameGenerator",null),o([Us()],EAt.prototype,"columns",null),o([Us()],EAt.prototype,"columnPerformanceModeEnabled",null),o([Us()],EAt.prototype,"columnReorderingEnabled",null),o([Us()],EAt.prototype,"dataProvider",null),o([Us()],EAt.prototype,"highlightIds",null),o([Us()],EAt.prototype,"isEditingActive",null),o([Us()],EAt.prototype,"itemIdPath",void 0),o([Us()],EAt.prototype,"label",null),o([Us(),BK("esri/widgets/FeatureTable/t9n/FeatureTable")],EAt.prototype,"messages",void 0),o([Us()],EAt.prototype,"multiSortEnabled",null),o([Us()],EAt.prototype,"pageSize",null),o([Us()],EAt.prototype,"rowDetailsRenderer",null),o([Us()],EAt.prototype,"size",null),o([Us({readOnly:!0})],EAt.prototype,"sortOrders",null),o([Us()],EAt.prototype,"store",null),o([Us()],EAt.prototype,"viewModel",void 0),o([Us()],EAt.prototype,"visibleElements",void 0),o([ol("visibleElements")],EAt.prototype,"castVisibleElements",null),EAt=o([Nr("esri.widgets.FeatureTable.Grid.Grid")],EAt);const OAt=EAt;let LAt=class extends Cgt{constructor(t){super(t),this.columns=null,this.sortable=!1}get path(){return this.header}set path(t){this.header=t}};o([Us()],LAt.prototype,"columns",void 0),o([Us()],LAt.prototype,"path",null),o([Us({readOnly:!0})],LAt.prototype,"sortable",void 0),LAt=o([Nr("esri.widgets.FeatureTable.Grid.GroupColumn")],LAt);const NAt=LAt;const RAt="esri.widgets.FeatureTable.support.FeatureStore";function PAt(t,e,i){Ft.getLogger(RAt).error(new Qe(t,e,i))}let FAt=class extends Vr{constructor(t){super(t),this._loaded=!1,this._loadError=!1,this._loading=!1,this._editOperationQueue=[],this._queryOperationQueue=[],this._objectIdCache=new ty,this._hasStaleCache=!1,this.count=0,this.failures=new ty,this.itemCache=new ty,this.relatedRecordsEnabled=!1}destroy(){this.layer=null,this.itemCache?.destroy(),this.failures?.destroy(),this._set("itemCache",null)}set attachmentsEnabled(t){this._reset(),this._set("attachmentsEnabled",t),this.notifyChange("state")}set filterGeometry(t){this._reset(),this._set("filterGeometry",t),this.notifyChange("state")}set layer(t){this._reset(),this._set("layer",t),this.notifyChange("state")}set objectIds(t){this._reset(),this._set("objectIds",t||null),this.notifyChange("state")}get orderByFields(){return this._get("orderByFields")||[]}set orderByFields(t){const e=this.orderByFields;_(t,e)||(this.itemCache.removeAll(),this._hasStaleCache=!0,this._set("orderByFields",t))}get querying(){return this._queryOperationQueue.length>0}set returnGeometry(t){this._reset(),this._set("returnGeometry",t),this.notifyChange("state")}get state(){const{layer:t,_loaded:e,_loadError:i,_loading:n}=this;return i?"error":!t||t.loadError?"disabled":n?"loading":"loaded"===t.loadStatus&&e?"loaded":"ready"}get syncing(){return this._editOperationQueue.length>0}set timeExtent(t){this._reset(),this._set("timeExtent",t),this.notifyChange("state")}get where(){return this._get("where")||null}set where(t){this._reset(),this._set("where",t),this.notifyChange("state")}async load(){this._reset();const{layer:t}=this;if(t){this._loading=!0,this.notifyChange("state");try{await t.when(),await this._syncLayerInfo(),this._loading=!1,this._loaded=!0,this.notifyChange("state")}catch(t){throw this._reset(),this._loadError=!0,this.notifyChange("state"),PAt("store:load-error","An error occurred.",{error:t}),t}}}async refreshLayerInfo(){return this._syncLayerInfo()}async addItems(t){}async fetchItems(t){const{page:e,pageSize:i}=t,n=e*i,s=n+i,{layer:r,state:o}=this;if(!r||"loaded"!==o)return[];this.notifyChange("querying");const a=await this._query({start:n,num:s,page:e,pageSize:i});return this.notifyChange("state"),a}async verifyFeaturesByObjectId(t){const{layer:e,state:i}=this;if(!e||"loaded"!==i)return[];const{features:n}=await this._verifyFeaturesByObjectId(t);return t.map((t=>n.some((e=>e?.getObjectId()===t))))}async query(t){const{layer:e,state:i}=this;if(!e||"loaded"!==i)return[];this.notifyChange("querying");const n=await this._query(t);return this.notifyChange("state"),n}async removeItemAt(t){}async reset(){this._reset()}async updateItem(t){return this._update(t).then((()=>{}))}async deleteRowsByObjectId(t){const{layer:e}=this,{operations:i}=Gk(e);if(!i.supportsDelete||!("applyEdits"in e))throw new Qe("store:delete-error","Delete is not supported.");const n=t.map((t=>this.getItemByObjectId(t)?.feature)).filter(F);return this._queueEditOperation((()=>e.applyEdits({deleteFeatures:n})))}getLocalItemByKey(t){return this.getItemByObjectId(t)}getItemByObjectId(t){const{itemCache:e,layer:{objectIdField:i}}=this;return e.find((e=>e.feature?.attributes[i]===t))}getLocalItemAt(t){return this.itemCache.at(t)}at(t){return Promise.resolve(this.itemCache.at(t))}getObjectIdIndex(t){const{itemCache:e,layer:{objectIdField:i}}=this;return e.findIndex((e=>e.feature?.attributes[i]===t))}_reset(){this.itemCache.removeAll(),this.failures.removeAll(),this._editOperationQueue=[],this._queryOperationQueue=[],this._hasStaleCache=!1,this._loading=!1,this._loaded=!1,this._loadError=!1,this._set("count",0),this._objectIdCache.removeAll(),this.notifyChange("querying"),this.notifyChange("syncing"),this.notifyChange("state")}_getIdsFromFeatures(t){return t.map((t=>t.attributes[this.layer.objectIdField]))}_toFeatureData(t,e){const{layer:{objectIdField:i}}=this;return t.map((t=>{const{attributes:n}=t,s=n[i];return{objectId:s,feature:t,attachments:e?e[s]:null,relatedRecords:null}}))}async _update(t){const{layer:e}=this,{operations:i}=Gk(e);if(!i.supportsUpdate||!("applyEdits"in e))throw new Qe("store:update-error","Update is not supported.");const{index:n,name:s,value:r}=t,o=await this.at(n);if(!o?.feature)throw new Qe("store:update-error","Feature with provided 'objectId' not found.");const{feature:a}=o,l=ht(a.attributes);l[s]=r;const u=new NF({attributes:l}),c=e.applyEdits({updateFeatures:[u]}).then((t=>{const{updateFeatureResults:e}=t,i=e.find((t=>!!t.error));if(i)throw i.error;return e.length&&(a.attributes=l),t}));return this._queueEditOperation((()=>c))}async _query(t){const{refresh:e}=t;return!0===e?(this.itemCache.removeAll(),this._syncLayerInfo().then((()=>this._queryFeatureData(t)))):(this._hasStaleCache&&(await this._updateIds(),this._hasStaleCache=!1),this._queryFeatureData(t))}async _queryFeatureData(t){return this._queueQueryOperation((async()=>{const{features:e}=await this._queryFeatures(t),i=this._getIdsFromFeatures(e),n=await this._queryAttachments(i);return this._toFeatureData(e,n)||[]}))}async _syncLayerInfo(){await this._updateCount(),await this._updateIds()}async _updateCount(){await this._queryCount().then((t=>this._set("count",t)))}async _updateIds(){this.layer?.capabilities?.query?.supportsPagination||(this._objectIdCache.removeAll(),await this._queryForObjectIds().then((t=>this._objectIdCache.addMany(t))))}_queryCount(){const{filterGeometry:t,layer:e}=this,i=e.capabilities?.query?.supportsCacheHint,n=e.createQuery();return n.geometry=t,n.returnGeometry=!1,n.where=this._getWhere(),n.timeExtent=this._getTimeExtent(),n.objectIds=this.objectIds,i&&(n.cacheHint=!0),e.queryFeatureCount(n)}_queryForObjectIds(){const{filterGeometry:t,layer:e,orderByFields:i}=this,n=e.capabilities?.query,s=n?.supportsCacheHint,r=n?.supportsOrderBy,o=e.createQuery();return o.geometry=t,o.outFields=[e.objectIdField],o.returnGeometry=!1,o.where=this._getWhere(),o.timeExtent=this._getTimeExtent(),o.objectIds=this.objectIds,r&&(o.orderByFields=i),s&&(o.cacheHint=!0),e.queryObjectIds(o)}async _queryFeatures(t){const{layer:e}=this;if(!Gk(e)?.operations.supportsQuery)throw new Qe("store:query-error","Layer does not support query operation.");const{filterGeometry:i,orderByFields:n,returnGeometry:s}=this,r=this.layer?.capabilities?.query,{start:o,pageSize:a}=t,l=e.createQuery();return l.returnGeometry=s,r?.supportsPagination?(l.start=o,l.num=a,l.where=this._getWhere(),l.timeExtent=this._getTimeExtent(),l.objectIds=this.objectIds):l.objectIds=this.objectIds||this._getObjectIdsForPage(o,a??0),r?.supportsOrderBy&&(l.orderByFields=n),i&&(l.geometry=i),r?.supportsCacheHint&&(l.cacheHint=!0),e.queryFeatures(l)}async _verifyFeaturesByObjectId(t){const{layer:e}=this;if(!Gk(e)?.operations.supportsQuery)throw new Qe("store:query-error","Layer does not support query operation.");const{orderByFields:i}=this,n=this.layer?.capabilities?.query,s=e.createQuery();return s.where=this._getWhere(),s.timeExtent=this._getTimeExtent(),s.returnGeometry=!1,s.objectIds=t,s.outFields=[e.objectIdField],n?.supportsOrderBy&&(s.orderByFields=i),n?.supportsCacheHint&&(s.cacheHint=!0),e.queryFeatures(s)}_getObjectIdsForPage(t,e){const i=this._objectIdCache.toArray();return i.length>=t+e?i.slice(t,t+e):i.slice(t)}_queryAttachments(t){const{attachmentsEnabled:e,layer:i}=this,{capabilities:n}=i,s=n?.data.supportsAttachment,r=n?.operations?.supportsQueryAttachments;return e&&s&&r&&"queryAttachments"in i?i.queryAttachments(new X9({objectIds:t,where:this._getWhere()})):Promise.resolve(null)}_syncLocalCache(t){t.forEach((t=>{if(t.feature){const e=t.feature.getObjectId();if(null!=e){const i=this.getObjectIdIndex(e);-1===i?this.itemCache.add(t):this.itemCache.splice(i,1,t)}}}))}_queueQueryOperation(t){return this._queryOperationQueue.push(t),this.notifyChange("querying"),t().then((e=>this._queryOperationQueue.includes(t)?(this._syncLocalCache(e),e):[])).catch((e=>{PAt("store:query-error","An error occurred.",{error:e});const i={error:e,retry:()=>{this.failures.remove(i),this._queueQueryOperation(t)},cancel:()=>this.failures.remove(i)};return this.failures.add(i),[]})).then((e=>(P(this._queryOperationQueue,t),this.notifyChange("querying"),e)))}_queueEditOperation(t){return this._editOperationQueue.push(t),this.notifyChange("syncing"),t().then((e=>(P(this._editOperationQueue,t),this.notifyChange("syncing"),e))).catch((e=>{PAt("store:edit-error","An error occurred.",{error:e});const i={error:e,retry:()=>{this.failures.remove(i),this._queueEditOperation(t)},cancel:()=>this.failures.remove(i)};throw this.failures.add(i),P(this._editOperationQueue,t),this.notifyChange("syncing"),e}))}_getWhere(){return this.where||this.layer?.definitionExpression||"1=1"}_getTimeExtent(){const t=this.layer;return this.timeExtent||t&&"timeExtent"in t&&t.timeExtent||null}};o([Us()],FAt.prototype,"attachmentsEnabled",null),o([Us({readOnly:!0})],FAt.prototype,"count",void 0),o([Us({readOnly:!0})],FAt.prototype,"failures",void 0),o([Us()],FAt.prototype,"filterGeometry",null),o([Us({readOnly:!0})],FAt.prototype,"itemCache",void 0),o([Us({value:null})],FAt.prototype,"layer",null),o([Us({value:null})],FAt.prototype,"objectIds",null),o([Us()],FAt.prototype,"orderByFields",null),o([Us({readOnly:!0})],FAt.prototype,"querying",null),o([Us()],FAt.prototype,"relatedRecordsEnabled",void 0),o([Us({value:!1})],FAt.prototype,"returnGeometry",null),o([Us({readOnly:!0})],FAt.prototype,"state",null),o([Us({readOnly:!0})],FAt.prototype,"syncing",null),o([Us()],FAt.prototype,"timeExtent",null),o([Us()],FAt.prototype,"where",null),FAt=o([Nr(RAt)],FAt);const DAt=FAt;let $At=class extends TAt{constructor(t){super(t),this._debounceRefresh=qi((()=>this._refresh())),this._highlights=new w,this.activeFilters=new ty,this.attachmentsEnabled=!1,this.autoRefreshEnabled=!0,this.cellClassNameGenerator=(t,e)=>t.path||"",this.columns=new ty,this.dataProvider=async(t,e)=>{const{store:i}=this,n=this._sortOrdersToLayerOrderByFields(t.sortOrders);e&&(i?(i.set({orderByFields:n}),"loaded"!==i.state&&"loading"!==i.state&&await i.load(),e&&e(await i.fetchItems(t))):e&&e([]))},this.editingEnabled=!1,this.grid=null,this.highlightEnabled=!0,this.itemIdPath="objectId",this.layer=null,this.messagesCommon=null,this.messagesURIUtils=null,this.relatedRecordsEnabled=!1,this.returnGeometryEnabled=!1,this.store=null,this.tableTemplate=null,this.timeZone=null,this.view=null,this._onLayerRefresh=this._onLayerRefresh.bind(this),this._set("store",new DAt),this._set("grid",new OAt({itemIdPath:this.itemIdPath,viewModel:this}))}initialize(){const t=async()=>{this.messages=await yv("esri/widgets/FeatureTable/t9n/FeatureTable"),this.messagesCommon=await yv("esri/t9n/common"),this.messagesURIUtils=await yv("esri/widgets/support/t9n/uriUtils")};t(),this.addHandles([og((()=>{t(),this._generateColumns()})),yy((()=>this.highlightIds),"change",(t=>this._onHighlightIdsChange(t)),{onListenerAdd:()=>{this.highlightIds.forEach((t=>this._highlight(t)))},onListenerRemove:()=>{this.highlightIds.forEach((t=>this._removeHighlight(t)))}}),fy((()=>this.attachmentsEnabled),(t=>{this.store.attachmentsEnabled=t,this.layer?.loaded&&this._generateColumns()})),fy((()=>this.layerView),(t=>{this._highlights.removeAll(),t&&this.highlightEnabled&&this.highlightIds?.forEach((t=>this._highlight(t)))})),fy((()=>this.highlightEnabled),(t=>{this._highlights.removeAll(),t&&this.highlightIds?.forEach((t=>this._highlight(t)))})),fy((()=>this.relatedRecordsEnabled),(t=>this.store.relatedRecordsEnabled=t)),fy((()=>this.returnGeometryEnabled),(t=>this.store.returnGeometry=t)),fy((()=>this.layer),(async(t,e)=>{const i=this.grid;i&&(i.clearSort(),t&&e&&await i.reset()),this._drainColumns(),t&&(this.store.layer=t,t.loaded?this._onLayerLoad():t.load().catch((()=>{})))})),fy((()=>this.layer?.loaded),(t=>t&&this._onLayerLoad())),fy((()=>this.store.state),(t=>{"loaded"===t&&this.grid?.scrollToTop()})),fy((()=>[this.messages,this.tableTemplate]),(()=>this.layer?.loaded&&this._generateColumns())),fy((()=>[this.timeZone,this.view?.timeZone]),(()=>{this.columns.forEach((t=>{if("field"in t&&t.field){const{timeZone:e,timeZoneName:i}=this._getTimeZoneInfoForFieldColumn(t.field);t.set({timeZone:e,timeZoneName:i})}})),this.grid?.onColumnChange()})),fy((()=>this.editingEnabled),(t=>{this.columns.forEach((e=>{"editingEnabled"in e&&(e.editingEnabled=t)})),this.grid?.onColumnChange()})),fy((()=>this.layer?.definitionExpression),((t,e)=>(t||e)&&"loaded"===this.store.state&&this.reset())),fy((()=>this.layer&&"timeExtent"in this.layer&&this.layer.timeExtent),((t,e)=>(t||e)&&!this.timeExtent&&"loaded"===this.store.state&&this.reset())),yy((()=>this.layer),"refresh",(t=>this._onLayerRefresh(t)))])}destroy(){this._drainColumns(),this._highlights.removeAll(),this._highlights.destroy(),this.grid?.destroy(),this.columns.destroyed||this.columns.destroy(),this.layer=null,this.view=null}get _defaultHiddenFields(){return zC(this.layer)}get activeSortOrders(){return this.grid?.sortOrders?this.grid.sortOrders.map((({path:t,direction:e})=>({fieldName:t,direction:e}))).filter((t=>t.fieldName&&t.direction)):[]}set filterGeometry(t){if(!this.filterGeometry&&!t)return;const e=this.activeFilters.find((t=>"geometry"===t.type));e&&this.activeFilters.remove(e),this._set("filterGeometry",t),this.store.filterGeometry=t,t&&this.activeFilters.add({type:"geometry",geometry:t})}get hiddenFields(){return this._get("hiddenFields")??new ty}set hiddenFields(t){Array.isArray(t)?this._set("hiddenFields",new ty(t)):this._set("hiddenFields",t)}get highlightOnRowSelectEnabled(){return this.highlightEnabled}set highlightOnRowSelectEnabled(t){this.highlightEnabled=t}get layerView(){return this.view?.allLayerViews.find((t=>t.layer===this.layer))||null}set messages(t){this.grid?.set("messages",t),this._set("messages",t)}get state(){const{store:t}=this;return t&&"disabled"!==t.state?"loading"===t.state?"loading":"loaded"===t.state?"loaded":"ready":"disabled"}set timeExtent(t){this._set("timeExtent",t),this.store.timeExtent=t}clearSelection(){this.grid?.clearSelection()}async deleteSelection(){const t=this.highlightIds.toArray();if(!t?.length)return;const{deleteFeatureResults:e}=await this.store.deleteRowsByObjectId(t),i=e.filter((t=>!t.error)).map((t=>t.objectId));i.length&&(this.deselectRows(i),await this.refresh())}deselectRows(t){const e=this._getStoreItemsFromSelectionParams(t);this.grid?.deselectRows(e)}filterBySelection(){const t=this.highlightIds.toArray();t.length&&(this.clearSelectionFilter(),this.store.objectIds=t,this.activeFilters.add({type:"selection",objectIds:t}))}getObjectIdIndex(t){return this.store?.getObjectIdIndex(t)}getValue(t,e){const i=this.store.getItemByObjectId(t);return i?.feature?.attributes[e]}get highlightIds(){return this._get("highlightIds")||new ty}set highlightIds(t){Array.isArray(t)?this._set("highlightIds",new ty(t)):this._set("highlightIds",t)}async refresh(){return Fi(this._debounceRefresh())}reset(){this.grid?.reset()}selectRows(t){const e=this._getStoreItemsFromSelectionParams(t);return this.grid?.selectRows(e)}scrollToIndex(t){this.grid?.scrollToIndex(t)}clearSelectionFilter(){this.store.objectIds=null;const t=this.activeFilters.find((t=>"selection"===t.type));t&&this.activeFilters.remove(t)}async zoomToSelection(){const{layer:t,view:e}=this,i=this.highlightIds.toArray();if(!t||!e||!i.length)return;const n=t.createQuery();n.objectIds=i,n.returnGeometry=!0;const s=await t.queryFeatures(n);try{await e.goTo(s.features)}catch(t){"AbortError"!==t.name&&console.error(t)}}async _refresh(){await this.store.refreshLayerInfo();const t=this.highlightIds.toArray();if(t.length){(await this.store.verifyFeaturesByObjectId(t)).forEach(((e,i)=>{e||this.deselectRows(t[i])}))}this.grid?.refreshPageCache()}_onLayerLoad(){const t=this.layer.capabilities?.query.maxRecordCount;t&&t<this.pageSize&&this.grid&&(this.grid.pageSize=t),this._generateColumns()}_onLayerRefresh(t){this.autoRefreshEnabled&&t.dataChanged&&this.refresh()}_generateColumns(){this._drainColumns();const t=[],e=this.tableTemplate?.columnTemplates?this._generateColumnsFromTemplates(this.tableTemplate.columnTemplates):this._generateDefaultFieldColumns();t.push(...e),t.length&&this.attachmentsEnabled&&t.push(this._generateAttachmentsColumn()),this.columns.addMany([...t])}_generateColumnsFromTemplates(t){const{editingEnabled:e,grid:i,layer:n,messages:s,messagesCommon:r,messagesURIUtils:o,store:a,tableTemplate:l}=this,u=n?.fields??[],c=t=>{const e="fieldName"in t&&t.fieldName?.toLowerCase();return u.find((t=>e===t.name?.toLowerCase()))};return t.map((t=>({template:t,field:c(t)}))).filter((({template:t,field:e})=>null!=e||"group"===t.type&&"columnTemplates"in t||"column"===t.type)).map((({template:t,field:u})=>{if("fieldName"in t){const c=!1===t.visible||!0!==t.visible&&this._isFieldHidden(u?.name),{direction:h,formatFunction:d,frozen:f,frozenToEnd:p,initialSortPriority:m,invalid:y,menuConfig:g,sortable:v,textAlign:w}=t,b=l?.expressionInfos||null,{timeZone:S,timeZoneName:x}=this._getTimeZoneInfoForFieldColumn(u);return new xwt({sortable:!1!==v,direction:h,editingEnabled:e,expressionInfos:b,field:u,formatFunction:d,frozen:f,frozenToEnd:p,grid:i,hidden:c,initialSortPriority:m,invalid:y,layer:n,messages:s,messagesCommon:r,messagesURIUtils:o,menuConfig:g,store:a,template:t,textAlign:w,timeZone:S,timeZoneName:x})}if("group"===t.type&&"columnTemplates"in t){const e=this._generateColumnsFromTemplates(t.columnTemplates),i=!1===t.visible||!0!==t.visible&&this._isFieldHidden(t.label),{label:n}=t;return new NAt({header:n,columns:e,hidden:i})}return new Cgt({...t,timeZone:this.timeZone})}))}_generateDefaultFieldColumns(){const{editingEnabled:t,grid:e,layer:i,messages:n,messagesCommon:s,messagesURIUtils:r,store:o}=this;return(this.layer?.fields??[]).map((a=>{const{timeZone:l,timeZoneName:u}=this._getTimeZoneInfoForFieldColumn(a);return new xwt({editingEnabled:t,field:a,grid:e,hidden:this._isFieldHidden(a.name),layer:i,store:o,messages:n,messagesCommon:s,messagesURIUtils:r,timeZone:l,timeZoneName:u})}))}_getTimeZoneInfoForFieldColumn(t){const{timeZone:e,view:i}=this;return!t||"date"!==t?.type&&"timestamp-offset"!==t?.type?{timeZone:void 0,timeZoneName:void 0}:Tg("preferredTimeZone"in this.layer?this.layer.preferredTimeZone:null,"datesInUnknownTimezone"in this.layer&&this.layer.datesInUnknownTimezone,e??i?.timeZone??pg,qg("short-time"),t.type)}_generateAttachmentsColumn(){return new Lgt({header:this.messages?.attachments??"Attachments"})}_sortOrdersToLayerOrderByFields(t){return t?.length?t.filter(((t,e,i)=>i.map((t=>t.path)).indexOf(t.path)===e)).filter((({direction:t})=>!!t)).map((({direction:t,path:e})=>e+" "+t?.toUpperCase())):[]}_isFieldHidden(t){const e=t?.toLowerCase();return(this.hiddenFields??this._defaultHiddenFields).some((t=>t.toLowerCase()===e))}_highlight(t){this.layerView&&qat(this.layerView)&&this._highlights.add(this.layerView.highlight(t),t)}_removeHighlight(t){this._highlights.remove(t)}_getStoreItemsFromSelectionParams(t){const e=[];return this.layer?((t=t instanceof Array?t:[t]).forEach((t=>{let i=t instanceof NF?t:null;const n=i?i.getObjectId():t;if("number"==typeof n||"string"==typeof n){if(!i){const t=this.store.getItemByObjectId(n);t&&(i=t.feature)}e.push({objectId:n,feature:i})}})),e):[]}_onHighlightIdsChange(t){const{highlightEnabled:e}=this,{added:i,removed:n}=t;e&&(i.forEach((t=>this._highlight(t))),n.forEach((t=>this._removeHighlight(t)))),this.emit("selection-change",{added:i,removed:n})}_drainColumns(){this.columns.drain((t=>!t.destroyed&&t.destroy()))}};o([Us()],$At.prototype,"_defaultHiddenFields",null),o([Us({readOnly:!0})],$At.prototype,"activeFilters",void 0),o([Us({readOnly:!0})],$At.prototype,"activeSortOrders",null),o([Us()],$At.prototype,"attachmentsEnabled",void 0),o([Us()],$At.prototype,"autoRefreshEnabled",void 0),o([Us()],$At.prototype,"cellClassNameGenerator",void 0),o([Us({readOnly:!0})],$At.prototype,"columns",void 0),o([Us()],$At.prototype,"dataProvider",void 0),o([Us()],$At.prototype,"editingEnabled",void 0),o([Us()],$At.prototype,"filterGeometry",null),o([Us({readOnly:!0})],$At.prototype,"grid",void 0),o([Us()],$At.prototype,"hiddenFields",null),o([Us()],$At.prototype,"highlightEnabled",void 0),o([Us()],$At.prototype,"highlightOnRowSelectEnabled",null),o([Us({readOnly:!0})],$At.prototype,"itemIdPath",void 0),o([Us()],$At.prototype,"layer",void 0),o([Us()],$At.prototype,"layerView",null),o([Us()],$At.prototype,"messages",null),o([Us(),BK("esri/t9n/common")],$At.prototype,"messagesCommon",void 0),o([Us(),BK("esri/widgets/support/t9n/uriUtils")],$At.prototype,"messagesURIUtils",void 0),o([Us()],$At.prototype,"relatedRecordsEnabled",void 0),o([Us()],$At.prototype,"returnGeometryEnabled",void 0),o([Us({readOnly:!0})],$At.prototype,"state",null),o([Us({readOnly:!0,type:DAt})],$At.prototype,"store",void 0),o([Us()],$At.prototype,"tableTemplate",void 0),o([Us()],$At.prototype,"timeExtent",null),o([Us()],$At.prototype,"timeZone",void 0),o([Us()],$At.prototype,"view",void 0),o([Us()],$At.prototype,"highlightIds",null),$At=o([Nr("esri.widgets.FeatureTable.FeatureTableViewModel")],$At);const zAt=$At;const UAt={header:!0,menu:!0,menuItems:{clearSelection:!0,refreshData:!0,toggleColumns:!0,selectedRecordsShowAllToggle:!0,selectedRecordsShowSelectedToggle:!0,zoomToSelection:!0,deleteSelection:!0},selectionColumn:!0,columnMenus:!0},VAt="esri-feature-table",GAt=`${VAt}__prompt`,BAt={base:VAt,header:`${VAt}__header`,title:`${VAt}__title`,content:`${VAt}__content`,loader:`${VAt}__loader`,loaderContainer:`${VAt}__loader-container`,menuContainer:`${VAt}__menu`,promptContainer:GAt,promptHeader:`${GAt}__header`,promptHeading:`${GAt}__header__heading`,promptMessage:`${GAt}__message`,promptDivider:`${GAt}__divider`,promptActions:`${GAt}__actions`};let qAt=class extends CK{constructor(t,e){super(t,e),this._prompt=null,this.menu=null,this.menuConfig=null,this.viewModel=new zAt,this.visibleElements={...UAt},this._showDeletePrompt=this._showDeletePrompt.bind(this),this._onDeleteSelectionClick=this._onDeleteSelectionClick.bind(this)}initialize(){this.addHandles([yy((()=>this.viewModel.columns),"change",(()=>this._syncMenuConfig())),yy((()=>this.viewModel.activeFilters),"change",(()=>this._syncMenuConfig())),yy((()=>this.viewModel),"selection-change",(t=>{this._syncMenuConfig(),this.emit("selection-change",t)})),fy((()=>[this.viewModel.store.querying,this.viewModel.store.syncing,this.editingEnabled]),(()=>this.scheduleRender())),fy((()=>[this.menuConfig,this.editingEnabled]),(()=>this._syncMenuConfig())),fy((()=>this.messages),(()=>{this.menu&&(this.menu.label=this.messages?.options),this._syncMenuConfig()}))]),this._set("menu",new kgt({label:this.messages?.options,iconClass:wK.handleHorizontal,...this.menuConfig}));const{attachmentsEnabled:t,relatedRecordsEnabled:e}=this;this.viewModel?.store?.set({attachmentsEnabled:t,relatedRecordsEnabled:e})}loadDependencies(){return lK({button:()=>import("./p-9ffe80e7.js"),icon:()=>import("./p-9ea19e2a.js"),scrim:()=>import("./p-c8e2cf96.js"),action:()=>import("./p-6501cc8a.js"),"action-bar":()=>import("./p-b4bd7070.js"),"input-date-picker":()=>import("./p-692db75d.js"),"input-time-picker":()=>import("./p-81562e63.js"),"input-time-zone":()=>import("./p-86af718a.js")})}destroy(){this._prompt=null,this.menu?.destroy()}get activeFilters(){return this.viewModel.activeFilters}get activeSortOrders(){return this.viewModel.activeSortOrders}get attachmentsEnabled(){return this.viewModel.attachmentsEnabled}set attachmentsEnabled(t){this.viewModel.attachmentsEnabled=t}get autoRefreshEnabled(){return this.viewModel.autoRefreshEnabled}set autoRefreshEnabled(t){this.viewModel.autoRefreshEnabled=t}get columnPerformanceModeEnabled(){return this.viewModel.columnPerformanceModeEnabled}set columnPerformanceModeEnabled(t){this.viewModel.columnPerformanceModeEnabled=t}get columnReorderingEnabled(){return this.viewModel.columnReorderingEnabled}set columnReorderingEnabled(t){this.viewModel.columnReorderingEnabled=t}get columns(){return this.viewModel.columns}get editingEnabled(){return this.viewModel.editingEnabled}set editingEnabled(t){this.viewModel.editingEnabled=t}get filterGeometry(){return this.viewModel.filterGeometry}set filterGeometry(t){this.viewModel.filterGeometry=t}get grid(){return this.viewModel.grid}get hiddenFields(){return this.viewModel.hiddenFields}set hiddenFields(t){this.viewModel.hiddenFields=t}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(t){this.viewModel.highlightEnabled=t}get highlightIds(){return this.viewModel.highlightIds}set highlightIds(t){this.viewModel.highlightIds=t}get highlightOnRowSelectEnabled(){return this.viewModel.highlightEnabled}set highlightOnRowSelectEnabled(t){this.viewModel.highlightEnabled=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get layer(){return this.viewModel.layer}set layer(t){this.viewModel.layer=t}get messages(){return this.viewModel.messages}set messages(t){this.viewModel.messages=t}get messagesCommon(){return this.viewModel.messagesCommon}set messagesCommon(t){this.viewModel.messagesCommon=t}get messagesURIUtils(){return this.viewModel.messagesURIUtils}set messagesURIUtils(t){this.viewModel.messagesURIUtils=t}get multiSortEnabled(){return this.viewModel.multiSortEnabled}set multiSortEnabled(t){this.viewModel.multiSortEnabled=t}get pageSize(){return this.viewModel.pageSize}set pageSize(t){this.viewModel.pageSize=t}get relatedRecordsEnabled(){return this.viewModel.relatedRecordsEnabled}set relatedRecordsEnabled(t){this.viewModel.relatedRecordsEnabled=t}get state(){return this.viewModel.state}get tableTemplate(){return this.viewModel.tableTemplate}set tableTemplate(t){this.viewModel.tableTemplate=t}get timeExtent(){return this.viewModel.timeExtent}set timeExtent(t){this.viewModel.timeExtent=t}get timeZone(){return this.viewModel.timeZone}set timeZone(t){this.viewModel.timeZone=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){const e={...UAt,...t};return this.grid?.set("visibleElements",{...this.grid.visibleElements,selectionColumn:e.selectionColumn,columnMenus:e.columnMenus}),e}clearSelection(){return f(Ft.getLogger(this),"`FeatureTable.clearSelection` is deprecated in favor of 'FeatureTable.highlightIds'",{replacement:"FeatureTable.highlightIds",version:"4.25",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-FeatureTable.html#highlightIds"}),this.viewModel.clearSelection()}clearSelectionFilter(){return this.viewModel.clearSelectionFilter()}deleteSelection(t){return this.highlightIds.length?t?(this._showDeletePrompt(),this.scheduleRender(),Promise.resolve()):this.viewModel.deleteSelection():Promise.resolve()}deselectRows(t){return this.viewModel.deselectRows(t)}filterBySelection(){return this.viewModel.filterBySelection()}findColumn(t){return this.viewModel.findColumn(t)}hideColumn(t){this.grid?.hideColumn(t),this._syncMenuConfig()}refresh(){return this.viewModel.refresh()}get returnGeometryEnabled(){return this.viewModel.returnGeometryEnabled}set returnGeometryEnabled(t){this.viewModel.returnGeometryEnabled=t}showAllColumns(){return this.viewModel.showAllColumns()}showColumn(t){this.grid?.showColumn(t),this._syncMenuConfig()}sortColumn(t,e){return this.viewModel.sortColumn(t,e)}selectRows(t){return this.viewModel.selectRows(t)}scrollToIndex(t){return this.viewModel.scrollToIndex(t)}zoomToSelection(){this.viewModel.zoomToSelection()}render(){const{_prompt:t}=this,e=null!=t?ZK("calcite-scrim",null,this._renderPrompt(t)):null;return ZK("div",{bind:this,class:this.classes(BAt.base,zK.widget)},this.visibleElements.header?this._renderHeader():null,ZK("div",{class:BAt.content},"disabled"!==this.state&&this.grid?.render()),e)}_renderPrompt({title:t,message:e,context:i,actions:n}){const s=ZK("calcite-button",{appearance:"solid",key:"prompt-primary-button",kind:"danger"===i?"danger":"brand",onclick:n.primary.action,width:n.secondary?"half":"full"},n.primary.label),r=n.secondary?ZK("calcite-button",{appearance:"outline",key:"prompt-secondary-button",kind:"danger"===i?"danger":"brand",onclick:n.secondary.action,width:"half"},n.secondary.label):null;return ZK("div",{class:`${BAt.promptContainer}--${i}`},ZK("div",{class:BAt.promptHeader},ZK("calcite-icon",{icon:"exclamation-mark-triangle"}),ZK(Byt,{class:BAt.promptHeading,level:2},t)),ZK("div",{class:BAt.promptMessage},e),ZK("div",{class:BAt.promptDivider}),ZK("div",{class:BAt.promptActions},r,s))}_renderHeader(){return ZK("div",{class:BAt.header,key:"header"},this._renderLoader(),this._renderTitle(),this.visibleElements.menu?this._renderMenu():null)}_renderTitle(){return ZK("div",{class:BAt.title,key:"title"},this._getTitle())}_getTitle(){const{grid:t,highlightIds:e,layer:i,messages:n,viewModel:{size:s}}=this;return t&&i?sv(n.header,{title:i.title,count:s,selected:e.length||0}):""}_renderLoader(){const{state:t,store:e}=this.viewModel,i="loading"===t||e.syncing||e.querying;return ZK("div",{class:BAt.loaderContainer},i?ZK("div",{class:BAt.loader,key:"loader"}):null)}_renderMenu(){return ZK("div",{class:BAt.menuContainer},this.menu?.render())}_syncMenuConfig(){this.menu?.set({...this.menuConfig,items:this._getMenuItems()})}_getMenuItems(){const t=this.menuConfig?.items,e=this._getDefaultMenuItems(),i=[];return e?.length&&i.push(...e),t?.length&&i.push(...t),i}_getDefaultMenuItems(){const{highlightIds:t,messages:e,viewModel:i,visibleElements:n}=this,{menuItems:s}=n,r=[];if(s?.refreshData&&r.push(new wgt({selectionEnabled:!1,label:e?.refreshData,clickFunction:()=>this.refresh()})),t.length){const i=this._getSelectionFilter();if(s?.clearSelection&&r.push(new wgt({selectionEnabled:!1,label:e?.clearSelection,clickFunction:()=>this.highlightIds?.removeAll()})),s?.zoomToSelection&&this.view&&r.push(new wgt({selectionEnabled:!1,label:e?.zoomToSelection,clickFunction:()=>this.viewModel.zoomToSelection()})),s?.selectedRecordsShowSelectedToggle&&(!i||t.length!==i.objectIds.length)){const t=e?.showSelected,i=new wgt({selectionEnabled:!1,label:t,clickFunction:()=>{this.filterBySelection(),i.set("label",t)}});r.push(i)}s?.deleteSelection&&this.editingEnabled&&this.layer?.capabilities?.operations?.supportsDelete&&r.push(new wgt({selectionEnabled:!1,label:e.deleteSelection,clickFunction:this._showDeletePrompt}))}if(s?.selectedRecordsShowAllToggle&&this._hasSelectionFilter()){const t=e.showAllRecords,i=new wgt({selectionEnabled:!1,label:t,clickFunction:()=>{this.clearSelectionFilter(),i.set("label",t)}});r.push(i)}return s?.toggleColumns&&r.push(new wgt({iconClass:wK.right,label:e?.toggleColumns,clickFunction:this._toggleMenuItemSelectedIcon,items:i?.columns?.items.map((({header:t,hidden:e,path:i})=>new wgt({label:t||i,selected:!e,selectionEnabled:!0,iconClass:wK.checkMark,clickFunction:()=>this._toggleColumnFromMenuItem(i)})))})),r.length?r:null}_toggleMenuItemSelectedIcon({item:t}){t?.set("iconClass",t?.selected?wK.down:wK.right)}_toggleColumnFromMenuItem(t){const{grid:e,viewModel:i}=this,n=i.findColumn(t);n?.hidden?e?.showColumn(t):e?.hideColumn(t)}_showDeletePrompt(){const{messages:t,messagesCommon:e}=this,i=this.highlightIds.length||0,n=sv(t.deleteSelectionCount,{count:i});this.menu&&(this.menu.open=!1),this._prompt={title:n,message:t.deleteRecordsRemoved,context:"danger",actions:{primary:{label:e.delete,action:this._onDeleteSelectionClick},secondary:{label:t.keepRecords,action:()=>this._prompt=null}}}}async _onDeleteSelectionClick(){await this.viewModel.deleteSelection(),this._prompt=null}_getSelectionFilter(){return this.viewModel.activeFilters?.find((t=>"selection"===t.type))}_hasSelectionFilter(){return!!this._getSelectionFilter()}};o([Us({readOnly:!0})],qAt.prototype,"activeFilters",null),o([Us({readOnly:!0})],qAt.prototype,"activeSortOrders",null),o([Us()],qAt.prototype,"attachmentsEnabled",null),o([Us()],qAt.prototype,"autoRefreshEnabled",null),o([Us()],qAt.prototype,"columnPerformanceModeEnabled",null),o([Us()],qAt.prototype,"columnReorderingEnabled",null),o([Us({readOnly:!0})],qAt.prototype,"columns",null),o([Us()],qAt.prototype,"editingEnabled",null),o([Us()],qAt.prototype,"filterGeometry",null),o([Us({readOnly:!0})],qAt.prototype,"grid",null),o([Us()],qAt.prototype,"hiddenFields",null),o([Us()],qAt.prototype,"highlightEnabled",null),o([Us()],qAt.prototype,"highlightIds",null),o([Us()],qAt.prototype,"highlightOnRowSelectEnabled",null),o([Us()],qAt.prototype,"label",null),o([Us()],qAt.prototype,"layer",null),o([Us(),BK("esri/widgets/FeatureTable/t9n/FeatureTable")],qAt.prototype,"messages",null),o([Us(),BK("esri/t9n/common")],qAt.prototype,"messagesCommon",null),o([Us(),BK("esri/widgets/support/t9n/uriUtils")],qAt.prototype,"messagesURIUtils",null),o([Us({readOnly:!0})],qAt.prototype,"menu",void 0),o([Us()],qAt.prototype,"menuConfig",void 0),o([Us()],qAt.prototype,"multiSortEnabled",null),o([Us()],qAt.prototype,"pageSize",null),o([Us()],qAt.prototype,"relatedRecordsEnabled",null),o([Us({readOnly:!0})],qAt.prototype,"state",null),o([Us()],qAt.prototype,"tableTemplate",null),o([Us()],qAt.prototype,"timeExtent",null),o([Us()],qAt.prototype,"timeZone",null),o([Us()],qAt.prototype,"view",null),o([Us()],qAt.prototype,"viewModel",void 0),o([Us()],qAt.prototype,"visibleElements",void 0),o([ol("visibleElements")],qAt.prototype,"castVisibleElements",null),o([Us()],qAt.prototype,"returnGeometryEnabled",null),qAt=o([Nr("esri.widgets.FeatureTable")],qAt);const HAt=qAt;let WAt=class extends Vr{constructor(t){super(t),this._viewpointHandle=null,this.group=null}initialize(){this.addHandles(yy((()=>this.view?.ui),"expand",(t=>{const{target:e}=t;e&&e!==this&&e.expanded&&e.group&&e.group===this.group&&this._collapse()})))}destroy(){this._viewpointHandle=null,this.view=null}set autoCollapse(t){this._set("autoCollapse",t),this._watchViewpoint()}set expanded(t){const e=!!t;this._set("expanded",e);const i=this.view?.ui;i&&i.emit("expand",{target:this}),this._viewpointHandleChange(e)}get state(){return this.view?.ready?"ready":"disabled"}set view(t){this._get("view")!==t&&(this._set("view",t),t&&py((()=>t.ready),(()=>{this.view===t&&this._watchViewpoint()}),{once:!0,initial:!0}))}_viewpointHandleChange(t){this._viewpointHandle&&(t?py((()=>this.view?.stationary),(()=>this._viewpointHandle?.resume()),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const t="viewpoint";this.removeHandles(t),this._viewpointHandle=null;const{autoCollapse:e,view:i}=this;if(!i||!e)return;const n=Sy((()=>"3d"===i.type?i.camera:i.viewpoint),(()=>this._collapse()));this.addHandles(n,t),this._viewpointHandle=n}_collapse(){this.expanded=!1}};o([Us({value:!1})],WAt.prototype,"autoCollapse",null),o([Us({value:!1})],WAt.prototype,"expanded",null),o([Us()],WAt.prototype,"group",void 0),o([Us({readOnly:!0})],WAt.prototype,"state",null),o([Us({value:null})],WAt.prototype,"view",null),WAt=o([Nr("esri.widgets.Expand.ExpandViewModel")],WAt);const ZAt=WAt;const JAt="esri-expand",KAt={base:JAt,modeAuto:`${JAt}--auto`,modeDrawer:`${JAt}--drawer`,modeFloating:`${JAt}--floating`,container:`${JAt}__container`,containerExpanded:`${JAt}__container--expanded`,panel:`${JAt}__panel`,icon:"esri-collapse__icon",iconFlip:"esri-collapse__icon-flip",iconExpanded:`${JAt}__icon--expanded`,iconNumber:`${JAt}__icon-number`,iconNumberExpanded:`${JAt}__icon-number--expanded`,content:`${JAt}__content`,contentExpanded:`${JAt}__content--expanded`,expandMask:`${JAt}__mask`,expandMaskExpanded:`${JAt}__mask--expanded`};let YAt=class extends CK{constructor(t,e){super(t,e),this.closeOnEsc=!0,this.collapseIcon=null,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconClass=null,this.icon=null,this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new ZAt,this.toggle=()=>{this.viewModel.expanded=!this.viewModel.expanded},this._handleKeyDown=t=>{const{closeOnEsc:e,_toggleButtonEl:i,expanded:n}=this;if(!n||!e||t.target===i||"Escape"!==t.key)return;("function"==typeof e?e(t):e)&&(this.expanded=!1,i?.focus())}}loadDependencies(){return lK({button:()=>import("./p-9ffe80e7.js"),icon:()=>import("./p-9ea19e2a.js")})}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:t,messagesCommon:e,collapseTooltip:i,expandTooltip:n}=this;return(t?i||e?.collapse:n||e?.expand)??""}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(t){this.viewModel.autoCollapse=t}get collapseIconClass(){return wK.collapse}set collapseIconClass(t){this._overrideIfSome("collapseIconClass",t)}get expanded(){return this.viewModel.expanded}set expanded(t){this.viewModel.expanded=t}get expandIconClass(){return Tct(this.content)?this.content.iconClass:wK.expand}set expandIconClass(t){this._overrideIfSome("expandIconClass",t)}get expandIcon(){return Tct(this.content)?this.content.icon:void 0}set expandIcon(t){this._overrideIfSome("expandIcon",t)}get group(){return this.viewModel.group}set group(t){this.viewModel.group=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}render(){const{mode:t}=this,e={[KAt.modeAuto]:"auto"===t,[KAt.modeDrawer]:"drawer"===t,[KAt.modeFloating]:"floating"===t};return ZK("div",{class:this.classes(KAt.base,zK.widget,e),onkeydown:this._handleKeyDown},this._renderMask(),this._renderContainer())}_renderContainer(){const{expanded:t}=this,e={[KAt.containerExpanded]:t};return ZK("div",{class:this.classes(KAt.container,e)},this._renderPanel(),this._renderContent())}_renderMask(){const{expanded:t}=this,e={[KAt.expandMaskExpanded]:t};return ZK("div",{bind:this,class:this.classes(KAt.expandMask,e),onclick:this.toggle})}_renderBadgeNumber(){const{expanded:t,iconNumber:e}=this;return e&&!t?ZK("span",{class:KAt.iconNumber,key:"expand__icon-number"},e):null}_renderPanelNumber(){const{iconNumber:t,expanded:e}=this;return t&&e?ZK("span",{class:this.classes(KAt.iconNumber,KAt.iconNumberExpanded),key:"expand__expand-icon-number"},t):null}_renderLegacyIcon(){const{collapseIconClass:t,expandIconClass:e,expanded:i}=this,n={[KAt.iconExpanded]:i};return null!=e&&(n[e]=!i),null!=t&&(n[t]=t===e||i),ZK("span",{"aria-hidden":"true",class:this.classes(KAt.icon,n),key:"legacy-icon"})}_renderToggleButton(){const{expanded:t,expandTitle:e,expandIcon:i,collapseIcon:n,contentId:s,expandIconClass:r,collapseIconClass:o}=this,a=r===wK.expand?"chevrons-left":void 0,l=o===wK.collapse?"chevrons-right":void 0,u=t?n??l:i??a,c=u===a||u===l;return ZK("calcite-button",{afterCreate:this._storeToggleButtonEl,"aria-controls":s,"aria-expanded":t?"true":"false",class:zK.widgetButton,kind:"neutral",label:e,onclick:this.toggle,scale:"s",title:e},u?ZK("calcite-icon",{class:this.classes(KAt.icon,c&&KAt.iconFlip),icon:u,scale:"s"}):this._renderLegacyIcon())}_renderPanel(){return ZK("div",{class:KAt.panel},this._renderToggleButton(),this._renderBadgeNumber(),this._renderPanelNumber())}_renderContent(){const{expanded:t,contentId:e,content:i}=this,n={[KAt.contentExpanded]:t},s={id:e,role:"region",class:this.classes(KAt.content,n)};return"string"==typeof i?ZK("div",{innerHTML:i,key:"content__string",...s}):Tct(i)?ZK("div",{key:"content__widget",...s},i.render()):i instanceof HTMLElement?ZK("div",{afterCreate:this._attachToNode,bind:i,key:"content__html-element",...s}):Act(i)?ZK("div",{afterCreate:this._attachToNode,bind:i.domNode,key:"content__node",...s}):null}_attachToNode(t){const e=this;t.appendChild(e)}_storeToggleButtonEl(t){this._toggleButtonEl=t}};o([Us({readOnly:!0})],YAt.prototype,"contentId",null),o([Us({readOnly:!0})],YAt.prototype,"expandTitle",null),o([Us()],YAt.prototype,"autoCollapse",null),o([Us()],YAt.prototype,"closeOnEsc",void 0),o([Us()],YAt.prototype,"collapseIconClass",null),o([Us()],YAt.prototype,"collapseIcon",void 0),o([Us()],YAt.prototype,"collapseTooltip",void 0),o([Us()],YAt.prototype,"content",void 0),o([Us()],YAt.prototype,"expanded",null),o([Us()],YAt.prototype,"expandIconClass",null),o([Us()],YAt.prototype,"expandIcon",null),o([Us()],YAt.prototype,"expandTooltip",void 0),o([Us()],YAt.prototype,"group",null),o([Us()],YAt.prototype,"iconClass",void 0),o([Us()],YAt.prototype,"icon",void 0),o([Us()],YAt.prototype,"iconNumber",void 0),o([Us()],YAt.prototype,"label",null),o([Us(),BK("esri/widgets/Expand/t9n/Expand")],YAt.prototype,"messages",void 0),o([Us(),BK("esri/t9n/common")],YAt.prototype,"messagesCommon",void 0),o([Us()],YAt.prototype,"mode",void 0),o([Us()],YAt.prototype,"view",null),o([Us({type:ZAt})],YAt.prototype,"viewModel",void 0),YAt=o([Nr("esri.widgets.Expand")],YAt);const QAt=YAt;class XAt{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function tIt(t,e){if(!t){e=e||"Assertion";const t=new Error(e).stack;throw new XAt(`${e} at ${t}`)}}function eIt(t,e,i,n){let s,r=(i[0]-t[0])/e[0],o=(n[0]-t[0])/e[0];r>o&&(s=r,r=o,o=s);let a=(i[1]-t[1])/e[1],l=(n[1]-t[1])/e[1];if(a>l&&(s=a,a=l,l=s),r>l||a>o)return!1;a>r&&(r=a),l<o&&(o=l);let u=(i[2]-t[2])/e[2],c=(n[2]-t[2])/e[2];return u>c&&(s=u,u=c,c=s),!(r>c||u>o)&&(c<o&&(o=c),!(o<0))}class iIt{constructor(t){this.client=t,this._cancelled=!1,this.size=0,this.duration=0}}class nIt{constructor(t){this.typeWorkerQuota=t,this.tasks=new Array,this.numWorkers=0,this.statistics=new sIt}}class sIt{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0}}class rIt{constructor(t,e,i,n){this._workerFunc=t,this._callbackFunc=e,this._maxTotalNumWorkers=i,this._totalNumWorkers=0,this._clients=n.map((t=>new nIt(t)))}destroy(){this._clients.length=0}hasQuota(t){const e=this._clients[t];return!!e&&(this._totalNumWorkers<this._maxTotalNumWorkers||e.numWorkers+e.tasks.length<e.typeWorkerQuota)}push(t){const e=this._clients[t.client];e&&(this._totalNumWorkers<this._maxTotalNumWorkers?(e.numWorkers++,this._totalNumWorkers++,this._workerFunc(t,((t,e)=>this._taskCallback(t,e)))):e.tasks.push(t))}cancel(t){this._taskFinished(t),t._cancelled=!0}_taskFinished(t){const e=this._clients[t.client];this._totalNumWorkers--,e&&(e.numWorkers--,e.statistics.requests++,e.statistics.size+=t.size||0,e.statistics.duration+=t.duration||0,e.statistics.speed=e.statistics.duration>0?e.statistics.size/e.statistics.duration:0,tIt(e.numWorkers>=0)),this._next()}_next(){for(const t of this._clients)if(t&&t.numWorkers<t.typeWorkerQuota&&this._processQueue(t))return;for(const t of this._clients)if(t&&this._processQueue(t))return}_processQueue(t){for(;t.tasks.length>0;)if(this._workerFunc(t.tasks.shift(),((t,e)=>this._taskCallback(t,e))))return t.numWorkers++,this._totalNumWorkers++,!0;return!1}_taskCallback(t,e){t._cancelled||(this._callbackFunc(t,e),this._taskFinished(t))}getStatsForType(t){const e=this._clients[t];return e?{quota:e.typeWorkerQuota,workers:e.numWorkers,queueSize:e.tasks.length,requestStats:e.statistics}:null}get test(){const t=this;return{set workerFunc(e){t._workerFunc=e}}}}const oIt=Symbol("Yield");class aIt{constructor(){this._tasks=new Array,this._runningTasks=eM(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(t){if(0===this.length)return oIt;for(;!t.done&&this._process(t);)t.madeProgress()}push(t,e,i){return++this._runningTasks.value,new Promise(((n,s)=>this._tasks.push(new lIt(n,s,t,e,i)))).finally((()=>--this._runningTasks.value))}unshift(t,e,i){return++this._runningTasks.value,new Promise(((n,s)=>this._tasks.unshift(new lIt(n,s,t,e,i)))).finally((()=>--this._runningTasks.value))}_process(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const i=Ci(e.signal);if(i&&!e.abortCallback)e.reject(Ai());else{const n=i?e.abortCallback?.(Ai()):e.callback(t);Gi(n)?n.then(e.resolve,e.reject):e.resolve(n)}}catch(t){e.reject(t)}return!0}cancelAll(){const t=Ai();for(const e of this._tasks)if(e.abortCallback){const i=e.abortCallback(t);e.resolve(i)}else e.reject(t);this._tasks.length=0}}class lIt{constructor(t,e,i,n=void 0,s=void 0){this.resolve=t,this.reject=e,this.callback=i,this.signal=n,this.abortCallback=s}}let uIt=class extends Vr{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};o([Us()],uIt.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),o([Us()],uIt.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),uIt=o([Nr("esri.views.support.DebugFlags")],uIt);const cIt=new uIt;var hIt;!function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"}(hIt||(hIt={}));var dIt;!function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"}(dIt||(dIt={}));const fIt=0,pIt=new Map([[dIt.RESOURCE_CONTROLLER_IMMEDIATE,fIt],[dIt.RESOURCE_CONTROLLER,4],[dIt.SLIDE,fIt],[dIt.STREAM_DATA_LOADER,fIt],[dIt.ELEVATION_QUERY,fIt],[dIt.TERRAIN_SURFACE,1],[dIt.SURFACE_GEOMETRY_UPDATES,1],[dIt.LOD_RENDERER,2],[dIt.GRAPHICS_CORE,2],[dIt.I3S_CONTROLLER,2],[dIt.POINT_CLOUD_LAYER,2],[dIt.FEATURE_TILE_FETCHER,2],[dIt.OVERLAY,4],[dIt.STAGE,4],[dIt.GRAPHICS_DECONFLICTOR,4],[dIt.FILTER_VISIBILITY,4],[dIt.SCALE_VISIBILITY,4],[dIt.FRUSTUM_VISIBILITY,4],[dIt.CLOUDS_GENERATOR,4],[dIt.POINT_OF_INTEREST_FREQUENT,6],[dIt.POINT_OF_INTEREST_INFREQUENT,30],[dIt.LABELER,8],[dIt.FEATURE_QUERY_ENGINE,8],[dIt.FEATURE_TILE_TREE,16],[dIt.FEATURE_TILE_TREE_ACTIVE,fIt],[dIt.ELEVATION_ALIGNMENT,12],[dIt.ELEVATION_ALIGNMENT_SCENE,14],[dIt.TEXT_TEXTURE_ATLAS,12],[dIt.TEXTURE_UNLOAD,12],[dIt.LINE_OF_SIGHT_TOOL,16],[dIt.LINE_OF_SIGHT_TOOL_INTERACTIVE,fIt],[dIt.SNAPPING,fIt],[dIt.SHADOW_ACCUMULATOR,30]]);function mIt(t){return pIt.has(t)?pIt.get(t):"number"==typeof t?t:1}const yIt=Zi(6.5),gIt=Zi(1),vIt=Zi(30),wIt=Zi(1e3/30),bIt=Zi(100),SIt=.9;var xIt,_It;!function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((t=>t.needsUpdate))}constructor(){this._updating=eM(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new di("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new n,this._state=hIt.INTERACTING,this._tasks=new gi,this._runQueue=new gi,this._load=0,this._idleStateCallbacks=new gi,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=fy((()=>cIt.SCHEDULER_LOG_SLOW_TASKS),(t=>this._debug=t),_y);for(const t of Object.keys(dIt))this.performanceInfo.tasks.set(dIt[t],new di(dIt[t]));const t=this;this._test={FRAME_SAFETY_BUDGET:yIt,INTERACTING_BUDGET:wIt,IDLE_BUDGET:bIt,get availableBudget(){return t._budget.budget},usedBudget:0,getBudget:()=>t._budget,setBudget:e=>t._budget=e,updateTask:t=>this._updateTask(t),getState:t=>this._getState(t),getRuntime:t=>this._getRuntime(t),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach((t=>t.remove())),this._tasks.clear(),Ut(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(t){this._updatingChanged(),t&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())})))}registerTask(t,e){const n=new i(this,t,e);return this._tasks.push(n),this._updatingChanged(),this.performanceInfo.tasks.has(t)||this.performanceInfo.tasks.set(t,new di(t)),n}registerIdleStateCallbacks(t,e){const i={idleBegin:t,idleEnd:e};this._idleStateCallbacks.push(i),this.state===hIt.IDLE&&this._idleUpdatesStartFired&&i.idleBegin();const n=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(t){n._idleUpdatesStartFired&&(i.idleEnd(),n._state===hIt.IDLE&&t()),i.idleBegin=t},set idleEnd(t){i.idleEnd=t}}}get load(){return this._load}set state(t){this._state!==t&&(this._state=t,this.state!==hIt.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((t=>t.idleEnd()))))}get state(){return this._state}updateBudget(t){this._test.usedBudget=0,++this._frameNumber;let e=yIt,i=t.frameDuration,n=gIt;switch(this.state){case hIt.IDLE:e=Zi(0),i=Zi(Math.max(bIt,t.frameDuration)),n=vIt;break;case hIt.INTERACTING:i=Zi(Math.max(wIt,t.frameDuration))}return i=Zi(i-t.elapsedFrameTime-e),this.state!==hIt.IDLE&&i<gIt&&!this._forceTask?(this._forceTask=!0,!1):(i=Zi(Math.max(i,n)),this._budget.reset(i,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case hIt.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((t=>t.idleBegin()))),this._runIdle();break;case hIt.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(Zi(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(t){this._idleUpdatesStartFired&&t.idleEnd(),this._idleStateCallbacks.removeUnordered(t)}removeTask(t){this._tasks.removeUnordered(t),this._runQueue.removeUnordered(t),this._updatingChanged()}_updateTask(t){this._tasks.forAll((e=>{e.name===t&&e.setPriority(t)}))}_getState(t){if(this._runQueue.some((e=>e.name===t)))return _It.SCHEDULED;let e=_It.IDLE;return this._tasks.forAll((i=>{i.name===t&&i.needsUpdate&&(i.schedulePriority<=1?e=_It.READY:e!==_It.READY&&(e=_It.WAITING))})),e}_getRuntime(t){let e=0;return this._tasks.forAll((i=>{i.name===t&&(e+=i.runtime)})),e}_resetRuntimes(){this._tasks.forAll((t=>t.runtime=0))}_getRunning(){const t=new Map;if(this._tasks.forAll((e=>{e.needsUpdate&&t.set(e.name,(t.get(e.name)||0)+1)})),0===t.size)return null;let e="";return t.forEach(((t,i)=>{e+=t>1?` ${t}x ${i}`:` ${i}`})),e}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const t=this._tasks.reduce(((t,e)=>e.needsUpdate?++t:t),0);this._load=this._load*SIt+t*(1-SIt)}_schedule(){for(this._runQueue.filterInPlace((t=>!!t.needsUpdate||(t.schedulePriority=t.basePriority,!1))),this._tasks.forAll((t=>{t.basePriority===fIt&&t.needsUpdate&&!this._runQueue.includes(t)&&t.blockFrame!==this._frameNumber&&this._runQueue.unshift(t)}));0===this._runQueue.length;){let t=!1;if(this._tasks.forAll((e=>{if(e.needsUpdate&&0!==e.schedulePriority&&e.basePriority!==fIt&&e.blockFrame!==this._frameNumber)if(t=!0,1===e.schedulePriority)e.schedulePriority=0,this._runQueue.push(e);else--e.schedulePriority})),!t)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const t=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const e=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.task.runTask(this._budget)===oIt&&(i.blockFrame=this._frameNumber)}catch(t){Ft.getLogger("esri.views.support.Scheduler").error(`Exception in task "${i.name}"`,t),i.blockFrame=this._frameNumber}!this._budget.hasProgressed&&i.blockFrame!==this._frameNumber&&i.needsUpdate&&(i.blockFrame=this._frameNumber),i.schedulePriority=i.basePriority;const n=this._budget.now()-e;if(i.runtime+=n,this._frameTaskTimes.set(i.priority,this._frameTaskTimes.get(i.priority)+n),this._debug&&n>2*this._budget.budget&&console.log("Task",i.name,"used",n,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-t)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-t)}_startFrameTaskTimes(){for(const t of Object.keys(dIt))this._frameTaskTimes.set(dIt[t],0)}_recordFrameTaskTimes(t){this._frameTaskTimes.forEach(((t,e)=>this.performanceInfo.tasks.get(e).record(t))),this.performanceInfo.total.record(t)}get test(){return this._test}}t.Scheduler=e;class i{get task(){return this._task.value}get updating(){return this._queue.running}constructor(t,e,i){this._scheduler=t,this.name=e,this.blockFrame=0,this.runtime=0,this._queue=new aIt,this._handles=new w,this._basePriority=mIt(e),this.schedulePriority=this._basePriority,this._task=eM(null!=i?i:this._queue),this._handles.add(py((()=>this.task.running),(e=>t.taskRunningChanged(e))))}remove(){this.processQueue(MIt),this._scheduler.removeTask(this),this.schedule=TIt.schedule,this.reschedule=TIt.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(t){if(this.name===t)return;this.name=t;const e=mIt(t);this._basePriority!==fIt&&0===this.schedulePriority||(this.schedulePriority=e),this._basePriority=e}get priority(){return this.name}set priority(t){this.setPriority(t)}get needsUpdate(){return this.updating||this.task.running}schedule(t,e,i){return this._queue.push(t,e,i)}reschedule(t,e,i){return this._queue.unshift(t,e,i)}processQueue(t){return this._queue.runTask(t)}}class n{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=hIt.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(t){return!this.done&&(!0===t()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(t){this._enabled=t}reset(t,e){this._begin=this.now(),this._budget=t,this._state=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=n}(xIt||(xIt={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(_It||(_It={}));const MIt=(()=>{const t=new xIt.Budget;return t.enabled=!1,t})();class kIt{remove(){}processQueue(){}schedule(t,e,i){try{if(Ci(e)){const t=Ai();return i?Promise.resolve(i(t)):Promise.reject(t)}return Bi(t(MIt))}catch(t){return Promise.reject(t)}}reschedule(t,e,i){return this.schedule(t,e,i)}}const TIt=new kIt;let AIt=class extends Vr{constructor(){super(...arguments),this._tasks=new Map,this._onLoadQueue=new Array,this._doneQueue=new Array,this.updating=!1}setup(t,e,i){this._loadQueue=new rIt(((t,e)=>this._startLoading(t,e)),((t,e)=>this._doneLoadingCB(t,e)),t,e),i&&(this._frameTask=i.registerTask(dIt.STREAM_DATA_LOADER,this))}destroy(){this._frameTask=Ut(this._frameTask),this._tasks.forEach((t=>Vt(t.abortController))),this._loadQueue=$t(this._loadQueue),this._onLoadQueue=null,this._doneQueue=null,this._tasks=null}hasDownloadSlots(t){return this._loadQueue.hasQuota(t)}request(t,e,i,n={}){const s=Hi();s.__signal=null!=n?n.signal:null;const r=this._createOrUpdateTask(t,e,i,n,s);return Li(n,(()=>this._cancelRequest(r,s))),s.promise}_createTask(t,e,i,n,s,r){const o=new EIt(t,e,i,n,s);return this._updateTask(o,r),this._tasks.set(s,o),1===this._tasks.size&&this._set("updating",!0),this._loadQueue.push(o),o}_cancelRequest(t,e){L(t.resolvers,e),e.reject(Ai()),0===t.resolvers.length&&(t.status===LIt.DOWNLOADING&&(t.status=LIt.CANCELLED,this._loadQueue.cancel(t),t.abortController?.abort(),t.request=null,t.abortController=null),t.status=LIt.CANCELLED,this._tasks.delete(t.key),0===this._tasks.size&&this._set("updating",!1))}_updateTask(t,e){t.resolvers.push(e)}_createOrUpdateTask(t,e,i,n,s){const r=OIt(n?.uid||t,e,i),o=this._tasks.get(r);return o?(this._updateTask(o,s),o):this._createTask(t,n,e,i,r,s)}_doneLoadingCB(t,e){this._loadQueue&&(tIt(t.status===LIt.DOWNLOADING),t.status=LIt.DOWNLOADED,this._frameTask?this._doneQueue.push({task:t,err:e}):this._doneLoading(t,e))}get running(){return this._doneQueue.length>0||this._onLoadQueue.length>0}runTask(t){for(;!t.done&&this._onLoadQueue.length>0;){const e=this._onLoadQueue.shift();Ii(e.task.abortController),e.task.abortController=null,e.callback(e.task),t.madeProgress()}for(;!t.done&&this._doneQueue.length>0;){const e=this._doneQueue.shift();e.task.status!==LIt.DOWNLOADED&&(e.err=e.err||Ai()),this._doneLoading(e.task,e.err),t.madeProgress()}}_doneLoading(t,e){if(e&&!Pi(e)&&t.numRetries>0)return--t.numRetries,void this._loadQueue.push(t);let i=t.result instanceof HTMLImageElement?0:t.resolvers.length;for(const n of t.resolvers)if(e)Pi(e)?n.reject(e):n.reject(new Qe("stream-data-loader:request-error",`Failed to request resource at '${t.url}'. ${e}`,{url:t.url,error:e}));else{--i;const e=i>0?ht(t.result):t.result;n.resolve(e)}this._tasks.delete(t.key),0===this._tasks.size&&this._set("updating",!1)}_startLoading(t,e){if(t.status===LIt.CANCELLED)return!1;let i,n;switch(t.startTime=performance.now(),t.status=LIt.DOWNLOADING,t.docType){case"binary":n="array-buffer",i=0;break;case"image":n="image";break;case"image+type":n="array-buffer";break;default:n="json"}t.abortController=new AbortController;const s=t.abortController.signal;t.request=hc(t.url,{...t.options,responseType:n,timeout:i,signal:s});let r=()=>{};const o=i=>{t.duration=performance.now()-t.startTime,t.size=i instanceof ArrayBuffer?i.byteLength:t.size||0,t.result=i,this._frameTask?this._onLoadQueue.push({callback:e,task:t}):(t.abortController=null,e(t))},a=i=>{t.status===LIt.DOWNLOADING&&e(t,i),r()};return"image+type"!==t.docType?(t.request.then((t=>o(t.data)),a),!0):(t.request.then((e=>{const l=e.data,u=jIt(l);if(n="image",t.size=l.byteLength,"unknown"===u)return t.request=hc(t.url,{responseType:n,timeout:i,signal:s}),void t.request.then((t=>o(t.data)),a);const c=new Blob([l],{type:u}),h=window.URL.createObjectURL(c);r=()=>window.URL.revokeObjectURL(h),t.request=hc(h,{responseType:n,timeout:i,signal:s}),t.request.then((t=>o(new CIt(t.data,u,r))),a)}),a),!0)}get test(){return{loadQueue:this._loadQueue}}};o([Us({readOnly:!0})],AIt.prototype,"updating",void 0),AIt=o([Nr("esri.views.3d.support.StreamDataLoader")],AIt);const IIt={numRetries:0};function jIt(t){if(t.byteLength<2)return"unknown";const e=new Uint8Array(t,0,t.byteLength);return 137===e[0]&&80===e[1]?"image/png":71===e[0]&&73===e[1]?"image/gif":66===e[0]&&77===e[1]?"image/bmp":255===e[0]&&216===e[1]?"image/jpeg":"unknown"}class CIt{constructor(t,e,i){this.image=t,this.type=e,this.release=i}get isOpaque(){return"image/jpeg"===this.type}}class EIt extends iIt{constructor(t,e,i,n,s){super(n),this.url=t,this.options=e,this.docType=i,this.key=s,this.result=null,this.status=LIt.QUEUED,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0,this.numRetries=IIt.numRetries}}function OIt(t,e,i){return`${t}:${e}:${i}`}var LIt;!function(t){t[t.QUEUED=1]="QUEUED",t[t.DOWNLOADING=2]="DOWNLOADING",t[t.DOWNLOADED=3]="DOWNLOADED",t[t.CANCELLED=4]="CANCELLED"}(LIt||(LIt={}));var NIt,RIt;!function(t){t[t.INSIDE=0]="INSIDE",t[t.INTERSECTS=1]="INTERSECTS",t[t.OUTSIDE=2]="OUTSIDE"}(NIt||(NIt={})),function(t){t[t.NORTH=0]="NORTH",t[t.NORTH_EAST=1]="NORTH_EAST",t[t.EAST=2]="EAST",t[t.SOUTH_EAST=3]="SOUTH_EAST",t[t.SOUTH=4]="SOUTH",t[t.SOUTH_WEST=5]="SOUTH_WEST",t[t.WEST=6]="WEST",t[t.NORTH_WEST=7]="NORTH_WEST"}(RIt||(RIt={}));const PIt=12;class FIt{constructor(t){const e=FIt.checkUnsupported(t);if(null!=e)throw e;const i=t;this.spatialReference=i.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=Bb(this.spatialReference)||Th(this.spatialReference)||Ih(this.spatialReference),this.origin=[i.origin.x,i.origin.y],this.pixelSize=i.size[0],this.dpi=i.dpi;const n=i.lods.reduce(((t,e,i)=>(e.level<t.min&&(t.min=e.level,t.minIndex=i),t.max=Math.max(t.max,e.level),t)),{min:1/0,minIndex:0,max:-1/0}),s=i.lods[n.minIndex],r=2**s.level;let o=s.resolution*r,a=s.scale*r;this.levels=new Array(n.max+1);for(let t=0;t<this.levels.length;t++)this.levels[t]={resolution:o,scale:a,tileSize:[o*i.size[0],o*i.size[1]]},o/=2,a/=2}clone(){return new FIt(this.toTileInfo())}toTileInfo(){return new tS({dpi:this.dpi,origin:new Qd({x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference}),size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map(((t,e)=>new Jb({level:e,scale:t.scale,resolution:t.resolution})))})}getExtent(t,e,i,n){const s=this.levels[t],r=s.tileSize[0],o=s.tileSize[1];n[0]=this.origin[0]+i*r,n[2]=this.origin[0]+(i+1)*r,n[3]=this.origin[1]-e*o,n[1]=this.origin[1]-(e+1)*o}convertExtentToRadians(t,e){this._isWebMercator?(e[0]=Fd(t[0]),e[1]=Dd(t[1]),e[2]=Fd(t[2]),e[3]=Dd(t[3])):this._isGCS&&(e[0]=va(t[0]),e[1]=va(t[1]),e[2]=va(t[2]),e[3]=va(t[3]))}getExtentGeometry(t,e,i,n=new Rf){return this.getExtent(t,e,i,$It),n.spatialReference=this.spatialReference,n.xmin=$It[0],n.ymin=$It[1],n.xmax=$It[2],n.ymax=$It[3],n.zmin=void 0,n.zmax=void 0,n}ensureMaxLod(t){if(null==t)return!1;let e=!1;for(;this.levels.length<=t;){const t=this.levels[this.levels.length-1],i=t.resolution/2;this.levels.push({resolution:i,scale:t.scale/2,tileSize:[i*this.pixelSize,i*this.pixelSize]}),e=!0}return e}capMaxLod(t){this.levels.length>t+1&&(this.levels.length=t+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(t){return this.levels[0].scale/2**t}levelAtScale(t){const e=this.levels[0].scale;return t>=e?0:Math.log(e/t)*Math.LOG2E}resolutionAtLevel(t){return this.levels[0].resolution/2**t}compatibleWith(t){if(!(t instanceof FIt)){if(FIt.checkUnsupported(t))return!1;t=new FIt(t)}if(!t.spatialReference.equals(this.spatialReference))return!1;if(t.pixelSize!==this.pixelSize)return!1;const e=Math.min(this.levels.length,t.levels.length)-1,i=this.levels[e].resolution;let n=.5*i;if(!xa(t.origin[0],this.origin[0],n)||!xa(t.origin[1],this.origin[1],n))return!1;return n=.5*i/2**e/this.pixelSize*PIt,xa(i,t.levels[e].resolution,n)}rootTilesInExtent(t,e=null,i=1/0){const n=new Array,s=this.levels[0].tileSize;if(null==t||0===s[0]||0===s[1])return n;FIt.computeRowColExtent(t,s,this.origin,$It);let r=$It[1],o=$It[3],a=$It[0],l=$It[2];const u=l-a,c=o-r;if(u*c>i){const t=Math.floor(Math.sqrt(i));c>t&&(r=r+Math.floor(.5*c)-Math.floor(.5*t),o=r+t),u>t&&(a=a+Math.floor(.5*u)-Math.floor(.5*t),l=a+t)}for(let t=r;t<o;t++)for(let e=a;e<l;e++)n.push([0,t,e]);return null!=e&&(e[0]=this.origin[0]+a*s[0],e[1]=this.origin[1]-o*s[1],e[2]=this.origin[0]+l*s[0],e[3]=this.origin[1]-r*s[1]),n}static computeRowColExtent(t,e,i,n){const s=.001*(t[2]-t[0]+(t[3]-t[1]));n[0]=Math.max(0,Math.floor((t[0]+s-i[0])/e[0])),n[2]=Math.max(0,Math.ceil((t[2]-s-i[0])/e[0])),n[1]=Math.max(0,Math.floor((i[1]-t[3]+s)/e[1])),n[3]=Math.max(0,Math.ceil((i[1]-t[1]-s)/e[1]))}static isPowerOfTwo(t){const e=t.lods,i=e[0].resolution*2**e[0].level;return!e.some((t=>!Ia(t.resolution,i/2**t.level)))}static hasGapInLevels(t){const e=t.lods.map((t=>t.level));e.sort(((t,e)=>t-e));for(let t=1;t<e.length;t++)if(e[t]!==e[0]+t)return!0;return!1}static tileSizeSupported(t){const e=t.size[1];return e===t.size[0]&&0==(e&e-1)&&e>=128&&e<=512}static hasOriginPerLODs(t){const e=t.origin;return t.lods.some((t=>null!=t.origin&&(t.origin[0]!==e.x||t.origin[1]!==e.y)))}static getMissingTileInfoError(){return new Qe("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(t){return null==t?DIt():t.lods.length<1?new Qe("tilingscheme:generic","Tiling scheme must have at least one level"):FIt.isPowerOfTwo(t)?FIt.hasGapInLevels(t)?new Qe("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):FIt.tileSizeSupported(t)?FIt.hasOriginPerLODs(t)?new Qe("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new Qe("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new Qe("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(t,e){const i=t[2]-t[0],n=t[3]-t[1],s=hd(e),r=1.2*Math.max(i,n),o=256,a=96,l=.0254,u=new FIt(new tS({size:[o,o],origin:new Qd({x:t[0]-.5*(r-i),y:t[3]+.5*(r-n)}),lods:[new Jb({level:0,resolution:r/o,scale:1/(o/a*l/(r*s))})],spatialReference:e}));return u.ensureMaxLod(20),u}static makeWebMercatorAuxiliarySphere(t){const e=new FIt(FIt.WebMercatorAuxiliarySphereTileInfo);return e.ensureMaxLod(t),e}static makeGCSWithTileSize(t,e=256,i=16){const n=256/e,s=new FIt(new tS({size:[e,e],origin:new Qd({x:-180,y:90,spatialReference:t}),spatialReference:t,lods:[new Jb({level:0,resolution:.703125*n,scale:295497598.570834*n})]}));return s.ensureMaxLod(i),s}get test(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}}function DIt(){return new Qe("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}FIt.WebMercatorAuxiliarySphereTileInfo=new tS({size:[256,256],origin:new Qd({x:-20037508.342787,y:20037508.342787,spatialReference:jd.WebMercator}),spatialReference:jd.WebMercator,lods:[new Jb({level:0,resolution:156543.03392800014,scale:591657527.591555})]}),FIt.WebMercatorAuxiliarySphere=FIt.makeWebMercatorAuxiliarySphere(19);const $It=pp();const zIt=64;ja(La/10);const UIt=pp();FIt.WebMercatorAuxiliarySphere.getExtent(0,0,0,UIt);const VIt=Wr(),GIt=Wr(),BIt=Wr(),qIt=Wr();function HIt(t,e,i=0){const n=t.extent;if(null==n)return!1;if(0===i)return Mp(n,e);const s=Math.min(n[2]-n[0],n[3]-n[1]);return Tp(n,e,i*s)}function WIt(t,e,i,n){wo(VIt,i),VIt[n]=e[n];const s=xo(VIt,VIt,e),r=xo(GIt,t,e),o=zo(r,s),a=zo(s,s);let l;l=o<=0?e:a<=o?i:So(VIt,e,Oo(s,s,o/a));const u=xo(VIt,t,l);return Math.PI/2-Math.atan(u[2]/Math.sqrt(u[0]*u[0]+u[1]*u[1]))}function ZIt(t,e,i){const n=t.extent;if(null==n)return 0;BIt[0]=n[0],BIt[1]=n[1],BIt[2]=i,qIt[0]=n[2],qIt[1]=n[3],qIt[2]=i;let s=1/0,r=1/0;return e[0]<BIt[0]?s=WIt(e,BIt,qIt,0):e[0]>qIt[0]&&(s=WIt(e,qIt,BIt,0)),e[1]<BIt[1]?r=WIt(e,BIt,qIt,1):e[1]>qIt[1]&&(r=WIt(e,qIt,BIt,1)),Math.min(s,r)}function JIt(t,e,i){if(null==t)return DIt();if(t.spatialReference.isGeographic&&!Bb(t.spatialReference))return new Qe("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const n=FIt.checkUnsupported(t);if(null!=n)return n;if(null==i)return new Qe("tilingscheme:extent-not-exist","The layer does not provide a layer extent.");const s=KIt(t,i);if(s)return s;const r=t.spatialReference;return null==e||r.equals(e)||e.isWGS84&&r.isWebMercator?null:new Qe("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene")}function KIt(t,e){const i=t.lods,n=i[0].resolution*2**i[0].level,s=[n*t.size[0],n*t.size[1]],r=[t.origin.x,t.origin.y],o=gp(e),a=pp();FIt.computeRowColExtent(o,s,r,a);const l=(a[2]-a[0])*(a[3]-a[1]);if(l>zIt){const e=i[0].scale*2**i[0].level;let s=Math.max((o[3]-o[1])/t.size[1],(o[2]-o[0])/t.size[0])*e/n;const r=Math.floor(Math.log(s)/Math.log(10));return s=Math.ceil(s/10**r)*10**r,new Qe("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(e).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+s.toLocaleString()+".",{level0Scale:e,suggestedLevel0Scale:s,requiredNumRootTiles:l,allowedNumRootTiles:zIt})}return null}const YIt=Object.freeze(Object.defineProperty({__proto__:null,checkIfTileInfoSupportedForViewSR:JIt,isInsideExtent:HIt,tiltToExtentEdge:ZIt},Symbol.toStringTag,{value:"Module"}));function QIt(){return!0}function XIt(){return 0}function tjt(t,e){if(null==t)return DIt();const i=t.lods.length-1,n=t.spatialReference,s=Bb(n)||Th(n)||Ih(n);if(n.isWebMercator){if(!FIt.makeWebMercatorAuxiliarySphere(i).compatibleWith(t))return new Qe("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!s)return new Qe("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!FIt.makeGCSWithTileSize(t.spatialReference,t.size[0],i).compatibleWith(t))return t.spatialReference.isWGS84?new Qe("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new Qe("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}return null==e||t.spatialReference.equals(e)?void 0:new Qe("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}const ejt=Object.freeze(Object.defineProperty({__proto__:null,checkIfTileInfoSupportedForViewSR:tjt,isInsideExtent:QIt,tiltToExtentEdge:XIt},Symbol.toStringTag,{value:"Module"}));const ijt={[az.Global]:ejt,[az.Local]:YIt};function njt(t,e,i,n){return ijt[n].checkIfTileInfoSupportedForViewSR(t,i,e)}function sjt(t,e,i){const n=zk(t);if(null!=n){if(!ty.isCollection(n))return{tileInfo:n.tileInfo,fullExtent:n.fullExtent};{const t=n.find((t=>null==njt(t.tileInfo,t.fullExtent,e,i)));if(t)return{tileInfo:t.tileInfo,fullExtent:t.fullExtent}}}return{tileInfo:null,fullExtent:null}}function rjt(t,e){return null!=t&&(null==e||(e===az.Local?!t.isGeographic||(t.isWGS84||t.wkid===rh.CGCS2000):t.isWebMercator||t.isWGS84||t.wkid===rh.CGCS2000||t.wkid===rh.GCSMARS2000||t.wkid===rh.GCSMARS2000_SPHERE||t.wkid===rh.GCSMOON2000))}async function ojt(t,e={}){const{basemap:i,view:n}=t;await i.load(e),ujt(i),await hjt(i,n,e),Ii(e)}async function ajt(t,e={}){const{basemap:i,view:n}=t;Ii(e);const s=i.baseLayers.find((t=>"unknown"===t.type))?.loadError;if(null!=s)throw s;if(!n||"spatialReferenceLocked"in n&&!n.spatialReferenceLocked)return;if(await i.load(e),Ii(e),0===i.baseLayers.length)return;const r=i.baseLayers.at(0);if(!Rk(r))return;if(i.spatialReference){if(n.spatialReference.equals(i.spatialReference))return;ljt()}await r.load(e),Ii(e);const o=(("supportedSpatialReferences"in r?r.supportedSpatialReferences:null)||["tileInfo"in r?r.tileInfo?.spatialReference:null]).filter(F);0!==o.length&&o.every((t=>!n.spatialReference.equals(t)))&&ljt()}function ljt(){throw new Qe("basemap-compatibility:incompatible-spatial-reference","Basemap spatial reference is not compatible with the view")}function ujt(t){if(0===t.baseLayers.length&&0===t.referenceLayers.length)return;const e=t.baseLayers.concat(t.referenceLayers).toArray().filter((t=>!jk(t))).map((t=>cjt(t)));if(e.length)throw e[0]}function cjt(t){return new Qe("basemap-compatibility:unsupported-basemap-layer-type","Unsupported basemap layer type ${operationalLayerType}",{layer:t,operationalLayerType:t.operationalLayerType||"unknown"})}async function hjt(t,e,i){if(0===t.baseLayers.length)return;const n=t.baseLayers.at(0);if(Nk(n)){try{await n.load(i)}catch(t){const e="basemap-compatibility:unknown-error",i="Unknown basemap compatibility error",{name:n=e,message:s=i,details:r}=t;throw new Qe(n,s,r)}djt(n,e)}}function djt(t,e){const i=e.state.viewingMode;if(!i)return;let n,s;if("wmts"===t?.type){const r=sjt(t,e.spatialReference,i);if(null==r.tileInfo)throw new Qe("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view");n=r.tileInfo,s=r.fullExtent}else n=t.tileInfo,s=t.fullExtent;if(null==n)return;if(!rjt(n.spatialReference,i))throw new Qe(`basemapgalleryitem:spatial-reference-unsupported-${lz(i)}`,`Basemap spatial reference is unsupported in ${lz(i)} mode`);const r=n.spatialReference.isGeographic,o="vector-tile"===t?.type?n.getOrCreateCompatible(256,r?1:2):null;if(i===az.Global){let e=njt(n,s,null,i);if(e&&"vector-tile"===t?.type&&null!=s&&o&&!njt(o,s,null,i)&&(e=null),e){const t=n.spatialReference.isWebMercator?"web-mercator":"wgs84";throw new Qe(`basemapgalleryitem:tiling-scheme-unsupported-${t}-global`,"Basemap tiling scheme is unsupported in global mode",{error:e})}}else if(FIt.checkUnsupported(n))throw new Qe("basemapgalleryitem:tiling-scheme-unsupported-local","Basemap tiling scheme is unsupported in local mode");const a=e.basemapTerrain?.tilingScheme;if(a&&!a.compatibleWith(n)&&("vector-tile"!==t?.type||!o||!a.compatibleWith(o)))throw new Qe("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view")}let fjt=class extends(PI(Vr)){constructor(t){super(t),this.compatibilityFunction=null,this.error=null,this.state="loading",this.view=null}initialize(){const t=()=>this.refresh();this.addHandles([fy((()=>this.basemap?.loadStatus),t),fy((()=>this.compatibilityFunction),t),fy((()=>this.view&&"basemapTerrain"in this.view&&this.view.basemapTerrain?.tilingScheme),t),fy((()=>this.view?.ready),t),fy((()=>this.view?.spatialReference),t)]),this.refresh()}destroy(){this._cancelRefresh(),this.basemap=null,this.compatibilityFunction=null,this.view=null}get _spatialReferenceTask(){return mI(this.view,this.basemap)}set basemap(t){t&&t.load().catch((()=>{})),this._set("basemap",t)}get spatialReference(){return this._spatialReferenceTask.spatialReference}refresh(){this._cancelRefresh(),this._set("state","loading");const t=this.basemap?.loadStatus;if("loaded"!==t&&"failed"!==t)return;if(!this.compatibilityFunction)return void("loaded"===t?(this._set("state","ready"),this._set("error",null)):(this._set("state","error"),this._set("error",this.basemap.loadError)));const e=new AbortController,{signal:i}=e;this.compatibilityFunction(this,{signal:i}).then((()=>gy((()=>!this._spatialReferenceTask.updating),i))).then((()=>{this._set("state","ready"),this._set("error",null)})).catch((t=>{Pi(t)||(this._set("state","error"),this._set("error",t))})),this._refreshController=e}_cancelRefresh(){this._refreshController&&(this._refreshController.abort(),this._refreshController=null)}};o([Us({readOnly:!0})],fjt.prototype,"_spatialReferenceTask",null),o([Us()],fjt.prototype,"basemap",null),o([Us()],fjt.prototype,"compatibilityFunction",void 0),o([Us({readOnly:!0})],fjt.prototype,"error",void 0),o([Us({readOnly:!0})],fjt.prototype,"spatialReference",null),o([Us({readOnly:!0})],fjt.prototype,"state",void 0),o([Us()],fjt.prototype,"view",void 0),fjt=o([Nr("esri.widgets.BasemapGallery.support.BasemapGalleryItem")],fjt);const pjt=fjt;const mjt=ty.ofType(oT);let yjt=class extends Vr{constructor(t){super(t),this.basemaps=new mjt}destroy(){this.basemaps.forEach((t=>t.destroy()))}get state(){return"ready"}refresh(){}};o([Us({type:mjt})],yjt.prototype,"basemaps",void 0),o([Us({readOnly:!0})],yjt.prototype,"state",null),yjt=o([Nr("esri.widgets.BasemapGallery.support.LocalBasemapsSource")],yjt);const gjt=yjt;const vjt=ty.ofType(oT);let wjt=class extends(AM.LoadableMixin(wM(gjt))){constructor(t){super(t),this._lastPortalBasemapFetchController=null,this.basemaps=new vjt,this.filterFunction=null,this.portal=YM.getDefault(),this.query=null,this.updateBasemapsCallback=null,this.viewType=null}initialize(){this.addHandles(fy((()=>[this.filterFunction,this.loadStatus,this.portal?.basemapGalleryGroupQuery,this.portal?.basemapGalleryGroupQuery3D,this.portal?.user,this.query,this.updateBasemapsCallback]),(()=>this.refresh()),_y))}destroy(){this.filterFunction=null,this.portal=null,this.basemaps.forEach((t=>t.destroy()))}get state(){return"not-loaded"===this.loadStatus?"not-loaded":"loading"===this.loadStatus||this._lastPortalBasemapFetchController?"loading":"ready"}load(t){return this.addResolvingPromise(this.portal.load(t)),Promise.resolve(this)}async refresh(){if("loaded"!==this.loadStatus)return;this._lastPortalBasemapFetchController&&(this._lastPortalBasemapFetchController.abort(),this._lastPortalBasemapFetchController=null);const t=this.portal,e=new AbortController;this._lastPortalBasemapFetchController=e,this.notifyChange("state");try{const i=await t.fetchBasemaps(this._toQueryString(this.query),{signal:e.signal,include3d:"3d"===this.viewType||void 0});await this._updateBasemaps(i)}catch(t){if(Pi(t))throw t;Ft.getLogger(this).warn(new Qe("basemap-source:fetch-basemaps-error","Could not fetch basemaps from portal.",{error:t})),await this._updateBasemaps()}this._lastPortalBasemapFetchController=null,this.notifyChange("state")}_toQueryString(t){return t&&"string"!=typeof t?Object.keys(t).map((e=>`${e}:${t[e]}`)).join(" AND "):t}async _updateBasemaps(t=[]){let e=await this._filterBasemaps(t);e=this.updateBasemapsCallback?await this.updateBasemapsCallback(e):e,this.basemaps.removeAll(),this.basemaps.addMany(e)}async _filterBasemaps(t){if(!this.filterFunction)return t;const e=t.map(this.filterFunction),i=await Promise.all(e);return t.filter(((t,e)=>i[e]))}};o([Us({readOnly:!0,type:vjt})],wjt.prototype,"basemaps",void 0),o([Us()],wjt.prototype,"filterFunction",void 0),o([Us({type:YM})],wjt.prototype,"portal",void 0),o([Us()],wjt.prototype,"query",void 0),o([Us({readOnly:!0})],wjt.prototype,"state",null),o([Us()],wjt.prototype,"updateBasemapsCallback",void 0),o([Us()],wjt.prototype,"viewType",void 0),wjt=o([Nr("esri.widgets.BasemapGallery.support.PortalBasemapsSource")],wjt);const bjt=wjt;const Sjt=ty.ofType(pjt);function xjt(t){return t&&"esri.portal.Portal"===t.declaredClass}function _jt(t){return t&&!(t instanceof bjt)&&(!!t.portal||!!t.query)}function Mjt(t){return t&&"basemaps"in t&&"state"in t&&"refresh"in t}let kjt=class extends AM{constructor(t){super(t),this._loadingProjectionEngine=!1,this.items=new Sjt,this.source=new bjt,this.view=null}initialize(){const t=()=>this._recreateItems();this.addHandles([fy((()=>"ready"===this.state?this.compatibilityFunction:null),(()=>this._updateItems())),yy((()=>this.source?.basemaps),"change",t,{onListenerAdd:t}),py((()=>this.view),(()=>{this.source instanceof bjt&&(this.source.viewType=this.view?.type)}),{once:!0})])}destroy(){const t=this.source.basemaps.find((t=>t===this.activeBasemap));t&&this.source.basemaps.remove(t),this.source?.destroy()}get activeBasemap(){return this.view?.map?.basemap??null}set activeBasemap(t){const e=this.view;if(!e?.map)return;const i="string"==typeof t?oT.fromId(t):t;if(!i||!e.ready)return e.map.basemap=i,void this._clearOverride("activeBasemap");const n=i.spatialReference||this.items?.find((t=>this.basemapEquals(i,t.basemap)))?.spatialReference;if(n&&"spatialReferenceLocked"in e&&!e.spatialReferenceLocked){const s=e.spatialReference;if(null!=n&&!mh(s,n)&&!Cb(e.spatialReference,n)&&!pb())return this._override("activeBasemap",i),this._loadingProjectionEngine=!0,void vb().then((()=>{this._get("activeBasemap")===t&&(e.map.basemap=t,e.spatialReference=n,this._clearOverride("activeBasemap"))}),(()=>{})).then((()=>{this._loadingProjectionEngine=!1}));e.map.basemap=i,this._clearOverride("activeBasemap"),null==n||mh(e.spatialReference,n)||(e.spatialReference=n)}else e.map.basemap=i,this._clearOverride("activeBasemap")}get activeBasemapIndex(){const{state:t,activeBasemap:e}=this;return"ready"!==t?-1:this._findBasemapIndex(e)}get compatibilityFunction(){return"3d"===this.view?.type?ojt:ajt}set compatibilityFunction(t){this._overrideIfSome("compatibilityFunction",t)}castSource(t){return Array.isArray(t)||ty.isCollection(t)?new gjt({basemaps:t}):xjt(t)?new bjt({portal:t}):_jt(t)?new bjt(t):Mjt(t)?t:null}get state(){return this.view?.ready&&this.source?this._loadingProjectionEngine?"loading":"ready":"disabled"}basemapEquals(t,e){return dI(t,e)}refresh(){this._recreateItems()}load(){return this.loadSource()}loadSource(t){return this.addResolvingPromise(AM.isLoadable(this.source)?this.source.load(t):null),Promise.resolve(this)}_findBasemapIndex(t){const{items:e}=this,i=e.findIndex((e=>e.basemap===t));return-1===i?e.findIndex((e=>this.basemapEquals(e.basemap,t))):i}_recreateItems(){const t=this.source?.basemaps??[],{view:e,compatibilityFunction:i}=this,n=new Map(this.items.map((t=>[t.basemap,t]))),s=t.map((t=>{const s=n.get(t);return s?(n.delete(t),s):new pjt({basemap:t,compatibilityFunction:i,view:e})}));this.items.removeAll(),this.items.addMany(s),n.forEach((t=>t.destroy()))}_updateItems(){for(const t of this.items)t.compatibilityFunction=this.compatibilityFunction,t.view=this.view}};o([Us()],kjt.prototype,"_loadingProjectionEngine",void 0),o([Us()],kjt.prototype,"activeBasemap",null),o([Us({readOnly:!0})],kjt.prototype,"activeBasemapIndex",null),o([Us()],kjt.prototype,"compatibilityFunction",null),o([Us({readOnly:!0,type:Sjt})],kjt.prototype,"items",void 0),o([Us()],kjt.prototype,"source",void 0),o([ol("source")],kjt.prototype,"castSource",null),o([Us({readOnly:!0})],kjt.prototype,"state",null),o([Us()],kjt.prototype,"view",void 0),kjt=o([Nr("esri.widgets.BasemapGallery.BasemapGalleryViewModel")],kjt);const Tjt=kjt;const Ajt="esri-basemap-gallery",Ijt={base:Ajt,widgetIcon:wK.basemap,sourceLoading:`${Ajt}--source-loading`,layoutGrid:`${Ajt}--grid`,narrowItems:`${Ajt}--narrow-items`,loader:`${Ajt}__loader`,item:`${Ajt}__item`,itemContainer:`${Ajt}__item-container`,itemContent:`${Ajt}__item-content`,itemTitle:`${Ajt}__item-title`,itemTagsContainer:`${Ajt}__item-tags-container`,itemThumbnail:`${Ajt}__item-thumbnail`,selectedItem:`${Ajt}__item--selected`,itemError:`${Ajt}__item--error`};const jjt={small:200,default:280,wide:420};let Cjt=class extends CK{constructor(t,e){super(t,e),this.disabled=!1,this.headingLevel=2,this.iconClass=Ijt.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new Tjt,this._focusBasemapItemEnabled=!1,this._container=null,this._width=0,this._onContainerCreated=t=>{this._container=t}}initialize(){this.addHandles([Gx((()=>this._container),(({contentRect:t})=>{this._width=t.width})),py((()=>this.source),(()=>this.viewModel.loadSource()),{sync:!0,initial:!0})])}loadDependencies(){return lK({scrim:()=>import("./p-c8e2cf96.js"),chip:()=>import("./p-a131b5d2.js")})}get activeBasemap(){return this.viewModel.activeBasemap}set activeBasemap(t){this.viewModel.activeBasemap=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get source(){return this.viewModel.source}set source(t){this.viewModel.source=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t="loading"===this.source.state,e=this.disabled||"disabled"===this.viewModel.state,i=this.viewModel.items,n={[Ijt.sourceLoading]:t,[zK.disabled]:e},s=this._width;s<=jjt.small||s>=jjt.wide?n[Ijt.layoutGrid]=!0:s<jjt.default&&(n[Ijt.narrowItems]=!0);const r=t?ZK("div",{class:Ijt.loader,key:"loader"}):null,o=t?null:i.length>0?ZK("ul",{"aria-disabled":this.disabled,"aria-label":this.label,bind:this,class:Ijt.itemContainer,key:"item-container",onkeydown:this._handleKeyDown,role:"radiogroup"},i.map(((t,e)=>this._renderBasemapGalleryItem(t,e))).toArray()):ZK("div",{class:zK.empty,key:"empty-message"},ZK(Byt,{level:this.headingLevel},this.messages.noBasemaps));return ZK("div",{afterCreate:this._onContainerCreated,class:this.classes(Ijt.base,zK.widget,zK.panelHeightOnly,n),key:"container"},0===this._width?null:[r,o])}_getRoundRobinIndex(t,e){return(t+e)%e}_handleKeyDown(t){const{key:e}=t;if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e))return;t.preventDefault();const{items:i,activeBasemapIndex:n}=this.viewModel,s="ArrowUp"===e||"ArrowLeft"===e?this._getRoundRobinIndex(Math.max(n-1,-1),i.length):this._getRoundRobinIndex(n+1,i.length),r=i.at(s);"ready"===r?.state&&(this.viewModel.activeBasemap=r.basemap),this._focusBasemapItemEnabled=!0}_focusBasemapItem(t){this._focusBasemapItemEnabled&&0===t.tabIndex&&(t.focus(),this._focusBasemapItemEnabled=!1)}_handleClick(t){const e=t.currentTarget["data-item"];"ready"===e.state&&(this.viewModel.activeBasemap=e.basemap)}_renderBasemapGalleryItem(t,e){const i=jI(t.basemap)||Nc("esri/themes/base/images/basemap-toggle-64.svg"),n=t.basemap.title,s=t.basemap.portalItem?.snippet,r=t.error?.message||s||n,{viewModel:{state:o,activeBasemapIndex:a}}=this,l=this.disabled||"disabled"===o,u=a===e,c=u||-1===a&&0===e?0:-1,h="loading"===o,d={[Ijt.selectedItem]:u,[Ijt.itemError]:"error"===t.state},f=`basemapgallery-item-${t.uid}`;return ZK("li",{afterUpdate:this._focusBasemapItem,"aria-checked":u.toString(),"aria-disabled":l.toString(),"aria-labelledby":f,bind:this,class:this.classes(Ijt.item,d),"data-item":t,key:t.uid,onclick:this._handleClick,onkeydown:this._handleClick,role:"radio",tabIndex:c,title:r},ZK("img",{alt:"",class:Ijt.itemThumbnail,src:i}),ZK("div",{class:Ijt.itemContent,key:"content"},ZK("div",{class:Ijt.itemTitle,key:"title"},ZK("span",{id:f},n)),uI(t.basemap)?this._renderTags(t.basemap):null),"loading"===t.state||u&&h?ZK("calcite-scrim",null,ZK("span",{"aria-hidden":"true",class:zK.loaderAnimation,key:"loader",role:"presentation"})):null)}_renderTags(t){return ZK("div",{class:Ijt.itemTagsContainer,key:"tag"},this._render3DTag(),cI(t)?this._renderBetaTag():null)}_render3DTag(){const{messages:t}=this;return ZK("calcite-chip",{key:"tag-3d",scale:"s",value:t.tag3D},this.messages.tag3D)}_renderBetaTag(){const{messages:t}=this;return ZK("calcite-chip",{appearance:"outline-fill",key:"tag-beta",scale:"s",value:t.tagBeta},this.messages.tagBeta)}};o([Us()],Cjt.prototype,"activeBasemap",null),o([Us()],Cjt.prototype,"disabled",void 0),o([Us()],Cjt.prototype,"headingLevel",void 0),o([Us()],Cjt.prototype,"iconClass",void 0),o([Us()],Cjt.prototype,"icon",void 0),o([Us()],Cjt.prototype,"label",null),o([Us(),BK("esri/widgets/BasemapGallery/t9n/BasemapGallery")],Cjt.prototype,"messages",void 0),o([Us()],Cjt.prototype,"source",null),o([Us()],Cjt.prototype,"view",null),o([Us()],Cjt.prototype,"viewModel",void 0),o([Us()],Cjt.prototype,"_focusBasemapItemEnabled",void 0),o([Us()],Cjt.prototype,"_container",void 0),o([Us()],Cjt.prototype,"_width",void 0),o([UK()],Cjt.prototype,"_handleClick",null),Cjt=o([Nr("esri.widgets.BasemapGallery")],Cjt);const Ejt=Cjt;const Ojt="esri-identity-modal",Ljt={base:Ojt,info:`${Ojt}__info`,notice:`${Ojt}__notice`},Njt="ArcGIS Online";let Rjt=class extends CK{constructor(t,e){super(t,e),this.container=document.createElement("div"),this.error=null,this.oAuthPrompt=!1,this.open=!1,this.signingIn=!1,this.server=null,this.resource=null,this._usernameInputNode=null,this._passwordInputNode=null,document.body.appendChild(this.container)}loadDependencies(){return lK({button:()=>import("./p-9ffe80e7.js"),input:()=>import("./p-5969ab83.js"),label:()=>import("./p-5ad0b9d8.js"),modal:()=>import("./p-d41ebfa3.js"),notice:()=>import("./p-ca8550c9.js")})}get title(){return this.commonMessages?.auth.signIn}render(){const{open:t,title:e,messages:i,signingIn:n,oAuthPrompt:s,server:r,resource:o,error:a}=this,{info:l,oAuthInfo:u,lblItem:c,invalidUser:h,noAuthService:d,lblUser:f,lblPwd:p,lblCancel:m,lblSigning:y,lblOk:g}=i;return ZK("div",{class:this.classes(Ljt.base,qW())},ZK("form",{bind:this,onsubmit:this._submit},ZK("calcite-modal",{bind:this,open:t,outsideCloseDisabled:!0,scale:"s",widthScale:"s",onCalciteModalClose:this._cancel,onCalciteModalOpen:this._focusUsernameInput},ZK("div",{slot:"header"},e),ZK("div",{slot:"content"},ZK("div",{class:Ljt.info},sv(s?u:l,{server:r&&/\.arcgis\.com/i.test(r)?Njt:r,resource:`(${o||c})`})),a?ZK("calcite-notice",{class:Ljt.notice,icon:"exclamation-mark-triangle",kind:"danger",open:!0},ZK("div",{slot:"message"},a.details?.httpStatus?h:d)):null,s?null:[ZK("calcite-label",null,f,ZK("calcite-input",{afterCreate:t=>this._usernameInputNode=t,autocomplete:"off",bind:this,name:"username",required:!0,spellcheck:!1,type:"text",value:""})),ZK("calcite-label",null,p,ZK("calcite-input",{afterCreate:t=>this._passwordInputNode=t,bind:this,name:"password",required:!0,type:"password",value:""}))]),ZK("calcite-button",{appearance:"outline",bind:this,onclick:this._cancel,slot:"secondary",type:"button",width:"full"},m),ZK("calcite-button",{loading:!!n,slot:"primary",type:"submit",width:"full"},n?y:g))))}_focusUsernameInput(){requestAnimationFrame((()=>{this._usernameInputNode?.setFocus()}))}_cancel(){this._set("signingIn",!1),this.open=!1,this._usernameInputNode&&(this._usernameInputNode.value=""),this._passwordInputNode&&(this._passwordInputNode.value=""),this.emit("cancel")}_submit(t){t.preventDefault(),this._set("signingIn",!0);const e=this.oAuthPrompt?{}:{username:this._usernameInputNode?.value,password:this._passwordInputNode?.value};this.emit("submit",e)}};o([Us({readOnly:!0})],Rjt.prototype,"container",void 0),o([Us(),BK("esri/t9n/common")],Rjt.prototype,"commonMessages",void 0),o([Us()],Rjt.prototype,"error",void 0),o([Us(),BK("esri/identity/t9n/identity")],Rjt.prototype,"messages",void 0),o([Us()],Rjt.prototype,"oAuthPrompt",void 0),o([Us()],Rjt.prototype,"open",void 0),o([Us()],Rjt.prototype,"signingIn",void 0),o([Us()],Rjt.prototype,"server",void 0),o([Us({readOnly:!0})],Rjt.prototype,"title",null),o([Us()],Rjt.prototype,"resource",void 0),Rjt=o([Nr("esri.identity.IdentityModal")],Rjt);const Pjt=Rjt;const Fjt="esriJSAPIOAuth";class Djt{constructor(t,e){this.oAuthInfo=null,this.storage=null,this.appId=null,this.codeVerifier=null,this.expires=null,this.refreshToken=null,this.ssl=null,this.stateUID=null,this.token=null,this.userId=null,this.oAuthInfo=t,this.storage=e,this._init()}isValid(){let t=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)t=!0;else if(this.expires){const e=Date.now();if(this.expires>e){(this.expires-e)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}}return t}save(){if(!this.storage)return!1;const t=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let i=t[e.authNamespace];i||(i=t[e.authNamespace]={}),this.appId||(this.appId=e.appId),i[e.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem(Fjt,JSON.stringify(t))}catch(t){return console.warn(t),!1}return!0}return!1}destroy(){const t=this._load(),e=this.oAuthInfo;if(e?.appId&&e?.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){const t=e.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",i=new FormData;if(i.append("f","json"),i.append("auth_token",this.refreshToken||this.token),i.append("client_id",e.appId),i.append("token_type_hint",this.refreshToken?"refresh_token":"access_token"),"function"==typeof navigator.sendBeacon)navigator.sendBeacon(t,i);else{const e=new XMLHttpRequest;e.open("POST",t),e.send(i)}}if(e&&e.authNamespace&&e.portalUrl&&this.storage){const i=t[e.authNamespace];if(i){delete i[e.portalUrl];try{this.storage.setItem(Fjt,JSON.stringify(t))}catch(t){console.log(t)}}}e&&(e._oAuthCred=null,this.oAuthInfo=null)}_init(){const t=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let i=t[e.authNamespace];i&&(i=i[e.portalUrl],i&&(this.appId=i.appId,this.codeVerifier=i.codeVerifier,this.expires=i.expires,this.refreshToken=i.refreshToken,this.ssl=i.ssl,this.stateUID=i.stateUID,this.token=i.token,this.userId=i.userId))}}_load(){let t={};if(this.storage){const e=this.storage.getItem(Fjt);if(e)try{t=JSON.parse(e)}catch(t){console.warn(t)}}return t}}Djt.prototype.declaredClass="esri.identity.OAuthCredential";var $jt;let zjt=$jt=class extends el{constructor(t){super(t),this._oAuthCred=null,this.appId=null,this.authNamespace="/",this.expiration=20160,this.flowType="auto",this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl="oauth-callback.html",this.popupWindowFeatures="height=490,width=800,resizable,scrollbars,status",this.portalUrl="https://www.arcgis.com",this.preserveUrlHash=!1,this.userId=null}clone(){return $jt.fromJSON(this.toJSON())}};o([Us({json:{write:!0}})],zjt.prototype,"appId",void 0),o([Us({json:{write:!0}})],zjt.prototype,"authNamespace",void 0),o([Us({json:{write:!0}})],zjt.prototype,"expiration",void 0),o([Us({json:{write:!0}})],zjt.prototype,"flowType",void 0),o([Us({json:{write:!0}})],zjt.prototype,"forceLogin",void 0),o([Us({json:{write:!0}})],zjt.prototype,"forceUserId",void 0),o([Us({json:{write:!0}})],zjt.prototype,"locale",void 0),o([Us({json:{write:!0}})],zjt.prototype,"minTimeUntilExpiration",void 0),o([Us({json:{write:!0}})],zjt.prototype,"popup",void 0),o([Us({json:{write:!0}})],zjt.prototype,"popupCallbackUrl",void 0),o([Us({json:{write:!0}})],zjt.prototype,"popupWindowFeatures",void 0),o([Us({json:{write:!0}})],zjt.prototype,"portalUrl",void 0),o([Us({json:{write:!0}})],zjt.prototype,"preserveUrlHash",void 0),o([Us({json:{write:!0}})],zjt.prototype,"userId",void 0),zjt=$jt=o([Nr("esri.identity.OAuthInfo")],zjt);const Ujt=zjt;let Vjt=class extends el{constructor(t){super(t),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};o([Us({json:{write:!0}})],Vjt.prototype,"adminTokenServiceUrl",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"currentVersion",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"hasPortal",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"hasServer",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"owningSystemUrl",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"owningTenant",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"server",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"shortLivedTokenValidity",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"tokenServiceUrl",void 0),o([Us({json:{write:!0}})],Vjt.prototype,"webTierAuth",void 0),Vjt=o([Nr("esri.identity.ServerInfo")],Vjt);const Gjt=Vjt;const Bjt={},qjt=t=>{const e=new Ol(t.owningSystemUrl).host,i=new Ol(t.server).host,n=/.+\.arcgis\.com$/i;return n.test(e)&&n.test(i)},Hjt=(t,e)=>!!(qjt(t)&&e&&e.some((e=>e.test(t.server))));let Wjt=null,Zjt=null;try{Wjt=window.localStorage,Zjt=window.sessionStorage}catch{}class Jjt extends Pm{constructor(){super(),this._portalConfig=globalThis.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this._defaultOAuthInfo=null,this._defaultTokenValidity=60,this.dialog=null,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appOrigin="null"!==window.origin?window.origin:window.location.origin,this._appUrlObj=Ul(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthLocationParams=null,this._gwTokenUrl="/sharing/rest/generateToken",this._agsRest="/rest/services",this._agsPortal=/\/sharing(\/|$)/i,this._agsAdmin=/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i,this._adminSvcs=/\/rest\/admin\/services(\/|$)/i,this._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}],this._legacyFed=[],this._regexSDirUrl=/http.+\/rest\/services\/?/gi,this._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MissionServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer|VideoServer)).*/gi,this._gwUser=/http.+\/users\/([^\/]+)\/?.*/i,this._gwItem=/http.+\/items\/([^\/]+)\/?.*/i,this._gwGroup=/http.+\/groups\/([^\/]+)\/?.*/i,this._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getOAuthLocationParams(),window.addEventListener("pageshow",(t=>{this._pageShowHandler(t)}))}registerServers(t){const e=this.serverInfos;e?(t=t.filter((t=>!this.findServerInfo(t.server))),this.serverInfos=e.concat(t)):this.serverInfos=t,t.forEach((t=>{t.owningSystemUrl&&this._portals.push(t.owningSystemUrl),t.hasPortal&&this._portals.push(t.server)}))}registerOAuthInfos(t){const e=this.oAuthInfos;if(e){for(const i of t){const t=this.findOAuthInfo(i.portalUrl);t&&e.splice(e.indexOf(t),1)}this.oAuthInfos=e.concat(t)}else this.oAuthInfos=t}registerToken(t){t={...t};const e=this._sanitizeUrl(t.server),i=this._isServerRsrc(e);let n,s=this.findServerInfo(e),r=!0;s||(s=new Gjt,s.server=this._getServerInstanceRoot(e),i?s.hasServer=!0:(s.tokenServiceUrl=this._getTokenSvcUrl(e),s.hasPortal=!0),this.registerServers([s])),n=this._findCredential(e),n?(delete t.server,Object.assign(n,t),r=!1):(n=new Kjt({userId:t.userId,server:s.server,token:t.token,expires:t.expires,ssl:t.ssl,scope:i?"server":"portal"}),n.resources=[e],this.credentials.push(n)),n.emitTokenChange(!1),r||n.refreshServerTokens()}toJSON(){return ct({serverInfos:this.serverInfos.map((t=>t.toJSON())),oAuthInfos:this.oAuthInfos.map((t=>t.toJSON())),credentials:this.credentials.map((t=>t.toJSON()))})}initialize(t){if(!t)return;"string"==typeof t&&(t=JSON.parse(t));const e=t.serverInfos,i=t.oAuthInfos,n=t.credentials;if(e){const t=[];e.forEach((e=>{e.server&&e.tokenServiceUrl&&t.push(e.declaredClass?e:new Gjt(e))})),t.length&&this.registerServers(t)}if(i){const t=[];i.forEach((e=>{e.appId&&t.push(e.declaredClass?e:new Ujt(e))})),t.length&&this.registerOAuthInfos(t)}n&&n.forEach((t=>{t.server&&t.token&&t.expires&&t.expires>Date.now()&&((t=t.declaredClass?t:new Kjt(t)).emitTokenChange(),this.credentials.push(t))}))}findServerInfo(t){let e;t=this._sanitizeUrl(t);for(const i of this.serverInfos)if(this._hasSameServerInstance(i.server,t)){e=i;break}return e}findOAuthInfo(t){let e;t=this._sanitizeUrl(t);for(const i of this.oAuthInfos)if(this._hasSameServerInstance(i.portalUrl,t)){e=i;break}return e}findCredential(t,e){if(!t)return;let i;t=this._sanitizeUrl(t);const n=this._isServerRsrc(t)?"server":"portal";if(e){for(const s of this.credentials)if(this._hasSameServerInstance(s.server,t)&&e===s.userId&&s.scope===n){i=s;break}}else for(const e of this.credentials)if(this._hasSameServerInstance(e.server,t)&&-1!==this._getIdenticalSvcIdx(t,e)&&e.scope===n){i=e;break}return i}getCredential(t,e){let i,n,s=!0;e&&(i=!!e.token,n=e.error,s=!1!==e.prompt),e={...e},t=this._sanitizeUrl(t);const r=new AbortController,o=Hi();if(e.signal&&Li(e.signal,(()=>{r.abort()})),Li(r,(()=>{o.reject(new Qe("identity-manager:user-aborted","ABORTED"))})),Ci(r))return o.promise;e.signal=r.signal;const a=this._isAdminResource(t),l=i?this.findCredential(t):null;let u;if(l&&n&&n.details&&498===n.details.httpStatus)l.destroy();else if(l)return u=new Qe("identity-manager:not-authorized","You are currently signed in as: '"+l.userId+"'. You do not have access to this resource: "+t,{error:n}),o.reject(u),o.promise;const c=this._findCredential(t,e);if(c)return o.resolve(c),o.promise;let h=this.findServerInfo(t);if(h)!h.hasPortal&&h.server&&h.owningSystemUrl&&this._hasSameServerInstance(h.server,h.owningSystemUrl)&&(h.hasPortal=!0),!h.hasServer&&this._isServerRsrc(t)&&(h._restInfoPms=this._getTokenSvcUrl(t),h.hasServer=!0);else{const e=this._getTokenSvcUrl(t);if(!e)return u=new Qe("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),o.reject(u),o.promise;h=new Gjt,h.server=this._getServerInstanceRoot(t),"string"==typeof e?(h.tokenServiceUrl=e,h.hasPortal=!0):(h._restInfoPms=e,h.hasServer=!0),this.registerServers([h])}return h.hasPortal&&void 0===h._selfReq&&(s||eu(h.tokenServiceUrl,this._appOrigin)||this._gwDomains.some((t=>t.tokenServiceUrl===h.tokenServiceUrl)))&&(h._selfReq={owningTenant:e?.owningTenant,selfDfd:this._getPortalSelf(h.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),t)}),this._enqueue(t,h,e,o,a)}getResourceName(t){return this._isRESTService(t)?t.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(t)&&t.replace(this._gwUser,"$1")||this._gwItem.test(t)&&t.replace(this._gwItem,"$1")||this._gwGroup.test(t)&&t.replace(this._gwGroup,"$1")||""}generateToken(t,e,i){const n=this._rePortalTokenSvc.test(t.tokenServiceUrl),s=new Ol(this._appOrigin),r=t.shortLivedTokenValidity;let o,a,l,u,c,h,d,f;e&&(f=this.tokenValidity||r||this._defaultTokenValidity,f>r&&r>0&&(f=r)),i&&(o=i.isAdmin,a=i.serverUrl,l=i.token,h=i.signal,d=i.ssl,t.customParameters=i.customParameters),o?u=t.adminTokenServiceUrl:(u=t.tokenServiceUrl,c=new Ol(u.toLowerCase()),t.webTierAuth&&i?.serverUrl&&!d&&"http"===s.scheme&&(eu(s.uri,u,!0)||"https"===c.scheme&&s.host===c.host&&"7080"===s.port&&"7443"===c.port)&&(u=u.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));const p={query:{request:"getToken",username:e?.username,password:e?.password,serverUrl:a,token:l,expiration:f,referer:o||n?this._appOrigin:null,client:o?"referer":null,f:"json",...t.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(t,i),signal:h,...i?.ioArgs};n||(p.withCredentials=!1);return hc(u,p).then((i=>{const n=i.data;if(!n?.token)return new Qe("identity-manager:authentication-failed","Unable to generate token");const s=t.server;return Bjt[s]||(Bjt[s]={}),e&&(Bjt[s][e.username]=e.password),n.validity=f,n}))}isBusy(){return!!this._busy}checkSignInStatus(t){return this.checkAppAccess(t,"").then((t=>t.credential))}checkAppAccess(t,e,i){let n=!1;return this.getCredential(t,{prompt:!1}).then((s=>{let r;const o={f:"json"};if("portal"===s.scope)if(e&&(this._doPortalSignIn(t)||i?.force))r=s.server+"/sharing/rest/oauth2/validateAppAccess",o.client_id=e;else{if(!s.token)return{credential:s};r=s.server+"/sharing/rest"}else{if(!s.token)return{credential:s};r=s.server+"/rest/services"}return s.token&&(o.token=s.token),hc(r,{query:o,authMode:"anonymous"}).then((t=>{if(!1===t.data.valid)throw new Qe("identity-manager:not-authorized",`You are currently signed in as: '${s.userId}'.`,t.data);return n=!!t.data.viewOnlyUserTypeApp,{credential:s}})).catch((t=>{if("identity-manager:not-authorized"===t.name)throw t;const e=t.details?.httpStatus;if(498===e)throw s.destroy(),new Qe("identity-manager:not-authenticated","User is not signed in.");if(400===e)throw new Qe("identity-manager:invalid-request");return{credential:s}}))})).then((t=>({credential:t.credential,viewOnly:n})))}setOAuthResponseHash(t){t&&("#"===t.charAt(0)&&(t=t.substring(1)),this._processOAuthPopupParams(Vl(t)))}setOAuthRedirectionHandler(t){this._oAuthRedirectFunc=t}setProtocolErrorHandler(t){this._protocolFunc=t}signIn(t,e,i={}){const n=Hi(),s=()=>{a?.remove(),l?.remove(),this.dialog?.destroy(),this.dialog=a=l=null},r=()=>{s(),this._oAuthDfd=null,n.reject(new Qe("identity-manager:user-aborted","ABORTED"))};i.signal&&Li(i.signal,(()=>{r()}));const o=new Pjt({open:!0,resource:this.getResourceName(t),server:e.server});this.dialog=o,this.emit("dialog-create");let a=o.on("cancel",r),l=o.on("submit",(t=>{this.generateToken(e,t,{isAdmin:i.isAdmin,signal:i.signal}).then((r=>{s();const o=new Kjt({userId:t.username,server:e.server,token:r.token,expires:null!=r.expires?Number(r.expires):null,ssl:!!r.ssl,isAdmin:i.isAdmin,validity:r.validity});n.resolve(o)})).catch((t=>{o.error=t,o.signingIn=!1}))}));return n.promise}oAuthSignIn(t,e,i,n){this._oAuthDfd=Hi();const s=this._oAuthDfd;let r;n?.signal&&Li(n.signal,(()=>{const t=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;t&&!t.closed?t.close():this.dialog&&u()})),s.resUrl_=t,s.sinfo_=e,s.oinfo_=i;const o=i._oAuthCred;if(o.storage&&("authorization-code"===i.flowType||"auto"===i.flowType&&e.currentVersion>=8.4)){let t=crypto.getRandomValues(new Uint8Array(32));r=fu(t),o.codeVerifier=r,t=crypto.getRandomValues(new Uint8Array(32)),o.stateUID=fu(t),o.save()||(o.codeVerifier=r=null)}else o.codeVerifier=null;let a,l;this._getCodeChallenge(r).then((s=>{const r=!n||!1!==n.oAuthPopupConfirmation;if(!i.popup||!r)return void this._doOAuthSignIn(t,e,i,s);const o=new Pjt({oAuthPrompt:!0,server:e.server,open:!0});this.dialog=o,this.emit("dialog-create"),a=o.on("cancel",u),l=o.on("submit",(()=>{c(),this._doOAuthSignIn(t,e,i,s)}))}));const u=()=>{c(),this._oAuthDfd=null,s.reject(new Qe("identity-manager:user-aborted","ABORTED"))},c=()=>{a?.remove(),l?.remove(),this.dialog?.destroy(),this.dialog=null};return s.promise}destroyCredentials(){if(this.credentials){this.credentials.slice().forEach((t=>{t.destroy()}))}this.emit("credentials-destroy")}enablePostMessageAuth(t="https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=Mi(window,"message",(e=>{if((e.origin===this._appOrigin||e.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===e.data?.type){const i=e.source;this.getCredential(t).then((t=>{i.postMessage({type:"arcgis:auth:credential",credential:{expires:t.expires,server:t.server,ssl:t.ssl,token:t.token,userId:t.userId}},e.origin)})).catch((t=>{i.postMessage({type:"arcgis:auth:error",error:{name:t.name,message:t.message}},e.origin)}))}}))}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthLocationParams(){let t=window.location.hash;if(t){"#"===t.charAt(0)&&(t=t.substring(1));const e=Vl(t);let i=!1;if(e.access_token&&e.expires_in&&e.state&&e.hasOwnProperty("username"))try{e.state=JSON.parse(e.state),e.state.portalUrl&&(this._oAuthLocationParams=e,i=!0)}catch{}else if(e.error&&e.error_description&&(console.log("IdentityManager OAuth Error: ",e.error," - ",e.error_description),"access_denied"===e.error&&(i=!0,e.state)))try{e.state=JSON.parse(e.state)}catch{}i&&(window.location.hash=e.state?.hash||"")}let e=window.location.search;if(e){"?"===e.charAt(0)&&(e=e.substring(1));const t=Vl(e);let i=!1;if(t.code&&t.state)try{t.state=JSON.parse(t.state),t.state.portalUrl&&t.state.uid&&(this._oAuthLocationParams=t,i=!0)}catch{}else if(t.error&&t.error_description&&(console.log("IdentityManager OAuth Error: ",t.error," - ",t.error_description),"access_denied"===t.error&&(i=!0,t.state)))try{t.state=JSON.parse(t.state)}catch{}if(i){const e={...t};["code","error","error_description","message_code","persist","state"].forEach((t=>{delete e[t]}));const i=Gl(e),n=window.location.pathname+(i?`?${i}`:"")+(t.state?.hash||"");window.history.replaceState(window.history.state,"",n)}}}_getOAuthToken(t,e,i,n,s){return t=t.replace(/^http:/i,"https:"),hc(`${t}/sharing/rest/oauth2/token`,{authMode:"anonymous",method:"post",query:n&&s?{grant_type:"authorization_code",code:e,redirect_uri:n,client_id:i,code_verifier:s}:{grant_type:"refresh_token",refresh_token:e,client_id:i}}).then((t=>t.data))}_getCodeChallenge(t){if(t&&globalThis.isSecureContext){const e=(new TextEncoder).encode(t);return crypto.subtle.digest("SHA-256",e).then((t=>fu(new Uint8Array(t))))}return Promise.resolve(null)}_pageShowHandler(t){if(t.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const t=new Qe("identity-manager:user-aborted","ABORTED");this._errbackFunc(t)}}_findCredential(t,e){let i,n,s,r,o=-1;const a=e?.token,l=e?.resource,u=this._isServerRsrc(t)?"server":"portal",c=this.credentials.filter((e=>this._hasSameServerInstance(e.server,t)&&e.scope===u));if(t=l||t,c.length)if(1===c.length){if(i=c[0],s=this.findServerInfo(i.server),n=s?.owningSystemUrl,r=n?this.findCredential(n,i.userId):void 0,o=this._getIdenticalSvcIdx(t,i),!a)return-1===o&&i.resources.push(t),this._addResource(t,r),i;-1!==o&&(i.resources.splice(o,1),this._removeResource(t,r))}else{let e,i;if(c.some((a=>(i=this._getIdenticalSvcIdx(t,a),-1!==i&&(e=a,s=this.findServerInfo(e.server),n=s?.owningSystemUrl,r=n?this.findCredential(n,e.userId):void 0,o=i,!0)))),a)e&&(e.resources.splice(o,1),this._removeResource(t,r));else if(e)return this._addResource(t,r),e}}_findOAuthInfo(t){let e=this.findOAuthInfo(t);if(!e)for(const i of this.oAuthInfos)if(this._isIdProvider(i.portalUrl,t)){e=i;break}return e}_addResource(t,e){e&&-1===this._getIdenticalSvcIdx(t,e)&&e.resources.push(t)}_removeResource(t,e){let i=-1;e&&(i=this._getIdenticalSvcIdx(t,e),i>-1&&e.resources.splice(i,1))}_useProxy(t,e){return e?.isAdmin&&!eu(t.adminTokenServiceUrl,this._appOrigin)||!this._isPortalDomain(t.tokenServiceUrl)&&"10.1"===String(t.currentVersion)&&!eu(t.tokenServiceUrl,this._appOrigin)}_getOrigin(t){const e=new Ol(t);return e.scheme+"://"+e.host+(null!=e.port?":"+e.port:"")}_getServerInstanceRoot(t){const e=t.toLowerCase();let i=e.indexOf(this._agsRest);return-1===i&&this._isAdminResource(t)&&(i=this._agsAdmin.test(t)?t.replace(this._agsAdmin,"$1").length:t.search(this._adminSvcs)),-1!==i||vl(e)||(i=e.indexOf("/sharing")),-1===i&&"/"===e.substr(-1)&&(i=e.length-1),i>-1?t.substring(0,i):t}_hasSameServerInstance(t,e){return"/"===t.substr(-1)&&(t=t.slice(0,-1)),t=t.toLowerCase(),e=this._getServerInstanceRoot(e).toLowerCase(),t=this._normalizeAGOLorgDomain(t),e=this._normalizeAGOLorgDomain(e),(t=t.substr(t.indexOf(":")))===(e=e.substr(e.indexOf(":")))}_normalizeAGOLorgDomain(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,n=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):i.test(t)?t=t.replace(i,"https://devext.arcgis.com"):n.test(t)&&(t=t.replace(n,"https://qaext.arcgis.com")),t}_sanitizeUrl(t){const e=(It.request.proxyUrl||"").toLowerCase(),i=e?t.toLowerCase().indexOf(e+"?"):-1;return-1!==i&&(t=t.substring(i+e.length+1)),t=ou(t),Ul(t).path}_isRESTService(t){return t.includes(this._agsRest)}_isAdminResource(t){return this._agsAdmin.test(t)||this._adminSvcs.test(t)}_isServerRsrc(t){return this._isRESTService(t)||this._isAdminResource(t)}_isIdenticalService(t,e){let i=!1;if(this._isRESTService(t)&&this._isRESTService(e)){const n=this._getSuffix(t).toLowerCase(),s=this._getSuffix(e).toLowerCase();if(i=n===s,!i){const t=/(.*)\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi;i=n.replaceAll(t,"$1")===s.replaceAll(t,"$1")}}else this._isAdminResource(t)&&this._isAdminResource(e)?i=!0:this._isServerRsrc(t)||this._isServerRsrc(e)||!this._isPortalDomain(t)||(i=!0);return i}_isPortalDomain(t){const e=new Ol(t.toLowerCase()),i=this._portalConfig;let n=this._gwDomains.some((t=>t.regex.test(e.uri)));return!n&&i&&(n=this._hasSameServerInstance(this._getServerInstanceRoot(i.restBaseUrl),e.uri)),n||It.portalUrl&&(n=eu(e,It.portalUrl,!0)),n||(n=this._portals.some((t=>this._hasSameServerInstance(t,e.uri)))),n=n||this._agsPortal.test(e.path),n}_isIdProvider(t,e){let i=-1,n=-1;this._gwDomains.forEach(((s,r)=>{-1===i&&s.regex.test(t)&&(i=r),-1===n&&s.regex.test(e)&&(n=r)}));let s=!1;if(i>-1&&n>-1&&(0===i||4===i?0!==n&&4!==n||(s=!0):1===i?1!==n&&2!==n||(s=!0):2===i?2===n&&(s=!0):3===i&&3===n&&(s=!0)),!s){const i=this.findServerInfo(e),n=i?.owningSystemUrl;n&&qjt(i)&&this._isPortalDomain(n)&&this._isIdProvider(t,n)&&(s=!0)}return s}_getIdenticalSvcIdx(t,e){let i=-1;for(let n=0;n<e.resources.length;n++){const s=e.resources[n];if(this._isIdenticalService(t,s)){i=n;break}}return i}_getSuffix(t){return t.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")}_getTokenSvcUrl(t){let e,i,n;if(this._isRESTService(t)||this._isAdminResource(t)){const n=this._getServerInstanceRoot(t);return e=n+"/admin/generateToken",i=hc(t=n+"/rest/info",{query:{f:"json"}}).then((t=>t.data)),{adminUrl:e,promise:i}}if(this._isPortalDomain(t)){let e="";if(this._gwDomains.some((i=>(i.regex.test(t)&&(e=i.tokenServiceUrl),!!e))),e||this._portals.some((i=>(this._hasSameServerInstance(i,t)&&(e=i+this._gwTokenUrl),!!e))),e||(n=t.toLowerCase().indexOf("/sharing"),-1!==n&&(e=t.substring(0,n)+this._gwTokenUrl)),e||(e=this._getOrigin(t)+this._gwTokenUrl),e){const i=new Ol(t).port;/^http:\/\//i.test(t)&&"7080"===i&&(e=e.replace(/:7080/i,":7443")),e=e.replace(/http:/i,"https:")}return e}if(t.toLowerCase().includes("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"}_processOAuthResponseParams(t,e,i){const n=e._oAuthCred;if(t.code){const s=n.codeVerifier;return n.codeVerifier=null,n.stateUID=null,n.save(),this._getOAuthToken(i.server,t.code,e.appId,this._getRedirectURI(e,!0),s).then((s=>{const r=new Kjt({userId:s.username,server:i.server,token:s.access_token,expires:Date.now()+1e3*s.expires_in,ssl:s.ssl,oAuthState:t.state,_oAuthCred:n});return e.userId=r.userId,n.storage=s.persist?Wjt:Zjt,n.refreshToken=s.refresh_token,n.token=null,n.expires=s.refresh_token_expires_in?Date.now()+1e3*s.refresh_token_expires_in:null,n.userId=r.userId,n.ssl=r.ssl,n.save(),r}))}const s=new Kjt({userId:t.username,server:i.server,token:t.access_token,expires:Date.now()+1e3*Number(t.expires_in),ssl:"true"===t.ssl,oAuthState:t.state,_oAuthCred:n});return e.userId=s.userId,n.storage=t.persist?Wjt:Zjt,n.refreshToken=null,n.token=s.token,n.expires=s.expires,n.userId=s.userId,n.ssl=s.ssl,n.save(),Promise.resolve(s)}_processOAuthPopupParams(t){const e=this._oAuthDfd;if(this._oAuthDfd=null,e)if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle?.remove(),t.error){const i="access_denied"===t.error,n=new Qe(i?"identity-manager:user-aborted":"identity-manager:authentication-failed",i?"ABORTED":"OAuth: "+t.error+" - "+t.error_description);e.reject(n)}else this._processOAuthResponseParams(t,e.oinfo_,e.sinfo_).then((t=>{e.resolve(t)})).catch((t=>{e.reject(t)}))}_setOAuthResponseQueryString(t){t&&("?"===t.charAt(0)&&(t=t.substring(1)),this._processOAuthPopupParams(Vl(t)))}_exchangeToken(t,e,i){return hc(`${t}/sharing/rest/oauth2/exchangeToken`,{authMode:"anonymous",method:"post",query:{f:"json",client_id:e,token:i}}).then((t=>t.data.token))}_getPlatformSelf(t,e){return t=t.replace(/^http:/i,"https:"),hc(`${t}/sharing/rest/oauth2/platformSelf`,{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":e,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json",expiration:30},withCredentials:!0}).then((t=>t.data))}_getPortalSelf(t,e){let i;if(this._gwDomains.some((e=>(e.regex.test(t)&&(i=e.customBaseUrl),!!i))),i)return Promise.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:i,portalMode:"multitenant",supportsOAuth:!0});this._appOrigin.startsWith("https:")?t=t.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(e)&&(t=t.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return hc(t,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then((t=>t.data))}_doPortalSignIn(t){const e=this._portalConfig,i=window.location.href,n=this.findServerInfo(t);return!(!e&&!this._isPortalDomain(i)||!(n?n.hasPortal||n.owningSystemUrl&&this._isPortalDomain(n.owningSystemUrl):this._isPortalDomain(t))||!(this._isIdProvider(i,t)||e&&(this._hasSameServerInstance(this._getServerInstanceRoot(e.restBaseUrl),t)||this._isIdProvider(e.restBaseUrl,t))||eu(i,t,!0)))}_checkProtocol(t,e,i,n){let s=!0;const r=n?e.adminTokenServiceUrl:e.tokenServiceUrl;if(r.trim().toLowerCase().startsWith("https:")&&!this._appOrigin.startsWith("https:")&&Kl(r)&&(s=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:t,serverInfo:e}),!s)){i(new Qe("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection."))}return s}_enqueue(t,e,i,n,s,r){return n||(n=Hi()),n.resUrl_=t,n.sinfo_=e,n.options_=i,n.admin_=s,n.refresh_=r,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(t),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(n)):this._xoReqs.push(n):this._doSignIn(n),n.promise}_doSignIn(t){this._busy=t,this._rejectOnPersistedPageShow=!1;const e=e=>{const i=t.options_?.resource,n=t.resUrl_,s=t.refresh_;let r=!1;this.credentials.includes(e)||(s&&this.credentials.includes(s)?(s.userId=e.userId,s.token=e.token,s.expires=e.expires,s.validity=e.validity,s.ssl=e.ssl,s.creationTime=e.creationTime,r=!0,e=s):this.credentials.push(e)),e.resources||(e.resources=[]),e.resources.includes(i||n)||e.resources.push(i||n),e.scope=this._isServerRsrc(n)?"server":"portal",e.emitTokenChange();const o=this._soReqs,a={};this._soReqs=[],o.forEach((t=>{if(!this._isIdenticalService(n,t.resUrl_)){const i=this._getSuffix(t.resUrl_);a[i]||(a[i]=!0,e.resources.push(t.resUrl_))}})),t.resolve(e),o.forEach((t=>{this._hasSameServerInstance(this._getServerInstanceRoot(n),t.resUrl_)?t.resolve(e):this._soReqs.push(t)})),this._busy=t.resUrl_=t.sinfo_=t.refresh_=null,r||this.emit("credential-create",{credential:e}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},i=e=>{t.reject(e),this._busy=t.resUrl_=t.sinfo_=t.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},n=(s,r,o,a)=>{const l=t.sinfo_,u=!t.options_||!1!==t.options_.prompt,c=l.hasPortal&&this._findOAuthInfo(t.resUrl_);let h,d;if(s)e(new Kjt({userId:s,server:l.server,token:o||null,expires:null!=a?Number(a):null,ssl:!!r}));else if(window!==window.parent&&this._appUrlObj.query?.["arcgis-auth-origin"]&&this._appUrlObj.query?.["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),t.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);const n=Mi(window,"message",(t=>{t.source===window.parent&&t.data&&("arcgis:auth:credential"===t.data.type?(n.remove(),t.data.credential.expires<Date.now()?i(new Qe("identity-manager:credential-request-failed","Parent application's token has expired.")):e(new Kjt(t.data.credential))):"arcgis:auth:error"===t.data.type&&(n.remove(),"tokenExpiredError"===t.data.error.name?i(new Qe("identity-manager:credential-request-failed","Parent application's token has expired.")):i(Qe.fromJSON(t.data.error))))}));Li(t.options_?.signal,(()=>{n.remove()}))}else if(c){let s=c._oAuthCred;if(!s){const t=new Djt(c,Wjt),e=new Djt(c,Zjt);t.isValid()&&e.isValid()?t.expires>e.expires?(s=t,e.destroy()):(s=e,t.destroy()):s=t.isValid()?t:e,c._oAuthCred=s}if(s.isValid()){h=new Kjt({userId:s.userId,server:l.server,token:s.token,expires:s.expires,ssl:s.ssl,_oAuthCred:s});const i=c.appId!==s.appId&&this._doPortalSignIn(t.resUrl_);i||s.refreshToken?(t._pendingDfd=s.refreshToken?this._getOAuthToken(l.server,s.refreshToken,s.appId).then((t=>(h.expires=Date.now()+1e3*t.expires_in,h.token=t.access_token,h))):Promise.resolve(h),t._pendingDfd.then((t=>i?this._exchangeToken(t.server,c.appId,t.token).then((e=>(t.token=e,t))).catch((()=>t)):t)).then((t=>{e(t)})).catch((()=>{s?.destroy(),n()}))):e(h)}else if(this._oAuthLocationParams&&this._hasSameServerInstance(c.portalUrl,this._oAuthLocationParams.state.portalUrl)&&(this._oAuthLocationParams.access_token||this._oAuthLocationParams.code&&this._oAuthLocationParams.state.uid===s.stateUID&&s.codeVerifier)){const n=this._oAuthLocationParams;this._oAuthLocationParams=null,t._pendingDfd=this._processOAuthResponseParams(n,c,l).then((t=>{e(t)})).catch(i)}else{const n=()=>{u?t._pendingDfd=this.oAuthSignIn(t.resUrl_,l,c,t.options_).then(e,i):(d=new Qe("identity-manager:not-authenticated","User is not signed in."),i(d))};this._doPortalSignIn(t.resUrl_)?t._pendingDfd=this._getPlatformSelf(l.server,c.appId).then((t=>{eu(t.portalUrl,this._appOrigin,!0)?(h=new Kjt({userId:t.username,server:l.server,expires:Date.now()+1e3*t.expires_in,token:t.token}),e(h)):n()})).catch(n):n()}}else if(u){if(this._checkProtocol(t.resUrl_,l,i,t.admin_)){let n=t.options_;t.admin_&&(n=n||{},n.isAdmin=!0),t._pendingDfd=this.signIn(t.resUrl_,l,n).then(e,i)}}else d=new Qe("identity-manager:not-authenticated","User is not signed in."),i(d)},s=()=>{const n=t.sinfo_,s=n.owningSystemUrl,r=t.options_;let o,a,l,u;if(r&&(o=r.token,a=r.error,l=r.prompt),u=this._findCredential(s,{token:o,resource:t.resUrl_}),!u)for(const t of this.credentials)if(this._isIdProvider(s,t.server)){u=t;break}if(u){const s=this.findCredential(t.resUrl_,u.userId);if(s)e(s);else if(Hjt(n,this._legacyFed)){const t=u.toJSON();t.server=n.server,t.resources=null,e(new Kjt(t))}else{(t._pendingDfd=this.generateToken(this.findServerInfo(u.server),null,{serverUrl:t.resUrl_,token:u.token,signal:t.options_.signal,ssl:u.ssl})).then((i=>{e(new Kjt({userId:u?.userId,server:n.server,token:i.token,expires:null!=i.expires?Number(i.expires):null,ssl:!!i.ssl,isAdmin:t.admin_,validity:i.validity}))}),i)}}else{this._busy=null,o&&(t.options_.token=null);(t._pendingDfd=this.getCredential(s.replace(/\/?$/,"/sharing"),{resource:t.resUrl_,owningTenant:n.owningTenant,signal:t.options_.signal,token:o,error:a,prompt:l})).then((()=>{this._enqueue(t.resUrl_,t.sinfo_,t.options_,t,t.admin_)}),(e=>{t.resUrl_=t.sinfo_=t.refresh_=null,t.reject(e)}))}};this._errbackFunc=i;const r=t.sinfo_.owningSystemUrl,o=this._isServerRsrc(t.resUrl_),a=t.sinfo_._restInfoPms;a?a.promise.then((e=>{const i=t.sinfo_;if(i._restInfoPms){i.adminTokenServiceUrl=i._restInfoPms.adminUrl,i._restInfoPms=null,i.tokenServiceUrl=(Mt("authInfo.tokenServicesUrl",e)||Mt("authInfo.tokenServiceUrl",e)||Mt("tokenServiceUrl",e))??null,i.shortLivedTokenValidity=Mt("authInfo.shortLivedTokenValidity",e)??null,i.currentVersion=e.currentVersion,i.owningTenant=e.owningTenant;const t=i.owningSystemUrl=e.owningSystemUrl;t&&this._portals.push(t)}o&&i.owningSystemUrl?s():n()}),(()=>{t.sinfo_._restInfoPms=null;const e=new Qe("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");i(e)})):o&&r?s():t.sinfo_._selfReq?t.sinfo_._selfReq.selfDfd.then((e=>{const i={};let n,s,r,o;return e&&(n=e.user?.username,i.username=n,i.allSSL=e.allSSL,s=e.supportsOAuth,o=parseFloat(e.currentVersion),"multitenant"===e.portalMode&&(r=e.customBaseUrl),t.sinfo_.currentVersion=o),t.sinfo_.webTierAuth=!!n,n&&this.normalizeWebTierAuth?this.generateToken(t.sinfo_,null,{ssl:i.allSSL}).catch((()=>null)).then((t=>(i.portalToken=t&&t.token,i.tokenExpiration=t&&t.expires,i))):!n&&s&&o>=4.4&&!this._findOAuthInfo(t.resUrl_)?this._generateOAuthInfo({portalUrl:t.sinfo_.server,customBaseUrl:r,owningTenant:t.sinfo_._selfReq.owningTenant}).catch((()=>null)).then((()=>i)):i})).catch((()=>null)).then((e=>{t.sinfo_._selfReq=null,e?n(e.username,e.allSSL,e.portalToken,e.tokenExpiration):n()})):n()}_generateOAuthInfo(t){let e,i=null,n=t.portalUrl;const s=t.customBaseUrl,r=t.owningTenant,o=!this._defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(o){i=window.location.href;let t=i.indexOf("?");t>-1&&(i=i.slice(0,t)),t=i.search(/\/(apps|home)\//),i=t>-1?i.slice(0,t):null}return o&&i?(this._hasTestedIfAppIsOnPortal=!0,e=hc(i+"/sharing/rest",{query:{f:"json"}}).then((()=>{this._defaultOAuthInfo=new Ujt({appId:"arcgisonline",popupCallbackUrl:i+"/home/oauth-callback.html"})}))):e=Promise.resolve(),e.then((()=>{if(this._defaultOAuthInfo)return n=n.replace(/^http:/i,"https:"),hc(n+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:r,client_id:this._defaultOAuthInfo.appId,redirect_uri:su(this._defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then((t=>{if(t.data.valid){const e=this._defaultOAuthInfo.clone();t.data.urlKey&&s?e.portalUrl="https://"+t.data.urlKey.toLowerCase()+"."+s:e.portalUrl=n,e.popup=window!==window.top||!(eu(n,this._appOrigin)||this._gwDomains.some((t=>t.regex.test(n)&&t.regex.test(this._appOrigin)))),this.oAuthInfos.push(e)}}))}))}_doOAuthSignIn(t,e,i,n){const s=i._oAuthCred,r={portalUrl:i.portalUrl};!i.popup&&i.preserveUrlHash&&window.location.hash&&(r.hash=window.location.hash),s.stateUID&&(r.uid=s.stateUID);const o={client_id:i.appId,response_type:s.codeVerifier?"code":"token",state:JSON.stringify(r),expiration:i.expiration,locale:i.locale,redirect_uri:this._getRedirectURI(i,!!s.codeVerifier)};i.forceLogin&&(o.force_login=!0),i.forceUserId&&i.userId&&(o.prepopulatedusername=i.userId),!i.popup&&this._doPortalSignIn(t)&&(o.redirectToUserOrgUrl=!0),s.codeVerifier&&(o.code_challenge=n||s.codeVerifier,o.code_challenge_method=n?"S256":"plain");const a=i.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",l=a+"?"+Gl(o);if(i.popup){const t=window.open(l,"esriJSAPIOAuth",i.popupWindowFeatures);if(t)t.focus(),this._oAuthDfd.oAuthWin_=t,this._oAuthIntervalId=setInterval((()=>{if(t.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle.remove();const t=this._oAuthDfd;if(t){const e=new Qe("identity-manager:user-aborted","ABORTED");t.reject(e)}}}),500),this._oAuthOnPopupHandle=Mi(window,["arcgis:auth:hash","arcgis:auth:location:search"],(t=>{"arcgis:auth:hash"===t.type?this.setOAuthResponseHash(t.detail):this._setOAuthResponseQueryString(t.detail)}));else{const t=new Qe("identity-manager:popup-blocked","ABORTED");this._oAuthDfd.reject(t)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:o,authorizeUrl:a,resourceUrl:t,serverInfo:e,oAuthInfo:i}):window.location.href=l}_getRedirectURI(t,e){const i=window.location.href.replace(/#.*$/,"");if(t.popup)return su(t.popupCallbackUrl);if(e){const t=Ul(i);return t.query&&["code","error","error_description","message_code","persist","state"].forEach((e=>{delete t.query[e]})),Gu(t.path,t.query)}return i}}Jjt.prototype.declaredClass="esri.identity.IdentityManagerBase";let Kjt=class extends Pm.EventedAccessor{constructor(t){super(t),this._oAuthCred=null,this.tokenRefreshBuffer=2,t?._oAuthCred&&(this._oAuthCred=t._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const t=Qu.findServerInfo(this.server),e=t?.owningSystemUrl,i=!!e&&"server"===this.scope,n=i&&Hjt(t,Qu._legacyFed),s=t.webTierAuth,r=s&&Qu.normalizeWebTierAuth,o=Bjt[this.server],a=o?.[this.userId];let l,u=this.resources&&this.resources[0],c=i?Qu.findServerInfo(e):null,h={username:this.userId,password:a};if(s&&!r)return;i&&!c&&Qu.serverInfos.some((t=>(Qu._isIdProvider(e,t.server)&&(c=t),!!c)));const d=c?Qu.findCredential(c.server,this.userId):null;if(!i||d){if(!n){if(i)l={serverUrl:u,token:d?.token,ssl:d&&d.ssl};else if(r)h=null,l={ssl:this.ssl};else{if(!a){let e;return u&&(u=Qu._sanitizeUrl(u),this._enqueued=1,e=Qu._enqueue(u,t,null,null,this.isAdmin,this),e.then((()=>{this._enqueued=0,this.refreshServerTokens()})).catch((()=>{this._enqueued=0}))),e}this.isAdmin&&(l={isAdmin:!0})}return Qu.generateToken(i?c:t,i?null:h,l).then((t=>{this.token=t.token,this.expires=null!=t.expires?Number(t.expires):null,this.creationTime=Date.now(),this.validity=t.validity,this.emitTokenChange(),this.refreshServerTokens()})).catch((()=>{}))}d?.refreshToken()}}refreshServerTokens(){"portal"===this.scope&&Qu.credentials.forEach((t=>{const e=Qu.findServerInfo(t.server),i=e?.owningSystemUrl;t!==this&&t.userId===this.userId&&i&&"server"===t.scope&&(Qu._hasSameServerInstance(this.server,i)||Qu._isIdProvider(i,this.server))&&(Hjt(e,Qu._legacyFed)?(t.token=this.token,t.expires=this.expires,t.creationTime=this.creationTime,t.validity=this.validity,t.emitTokenChange()):t.refreshToken())}))}emitTokenChange(t){clearTimeout(this._refreshTimer);const e=this.server?Qu.findServerInfo(this.server):null,i=e?.owningSystemUrl,n=i?Qu.findServerInfo(i):null;!1===t||i&&"portal"!==this.scope&&(!n?.webTierAuth||Qu.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit("token-change")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const t=Qu.credentials.indexOf(this);t>-1&&Qu.credentials.splice(t,1),this.emitTokenChange(),this.emit("destroy")}toJSON(){const t=ct({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),e=this.resources;return e&&e.length>0&&(t.resources=e.slice()),t}_startRefreshTimer(){clearTimeout(this._refreshTimer);const t=6e4*this.tokenRefreshBuffer,e=2**31-1;let i=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();i<0?i=0:i>e&&(i=e),this._refreshTimer=setTimeout(this.refreshToken.bind(this),i>t?i-t:i)}};o([Us()],Kjt.prototype,"creationTime",void 0),o([Us()],Kjt.prototype,"expires",void 0),o([Us()],Kjt.prototype,"isAdmin",void 0),o([Us()],Kjt.prototype,"oAuthState",void 0),o([Us()],Kjt.prototype,"resources",void 0),o([Us()],Kjt.prototype,"scope",void 0),o([Us()],Kjt.prototype,"server",void 0),o([Us()],Kjt.prototype,"ssl",void 0),o([Us()],Kjt.prototype,"token",void 0),o([Us()],Kjt.prototype,"tokenRefreshBuffer",void 0),o([Us()],Kjt.prototype,"userId",void 0),o([Us()],Kjt.prototype,"validity",void 0),Kjt=o([Nr("esri.identity.Credential")],Kjt);class Yjt extends Jjt{}Yjt.prototype.declaredClass="esri.identity.IdentityManager";const Qjt=new Yjt;tc(Qjt);const Xjt=Object.freeze({__proto__:null,default:Qjt});const tCt="#mapDiv{height:100%;width:100%;flex-grow:3}#tableDiv{flex-grow:1}.table{height:100%;min-height:300px}#mapWrapper{display:flex;flex-direction:column;height:100%;width:100%}";const eCt=class{constructor(t){i(this,t);this.mapViewExtentChanged=n(this,"mapViewExtentChanged",7);this.mapSaved=n(this,"mapSaved",7);this.serviceAreaUrl="https://route-api.arcgis.com/arcgis/rest/services/World/ServiceAreas/NAServer/ServiceArea_World";this.mapId=null;this.features=null;this.center=[0,0];this.zoom=10;this.datasetIds=[];this.showLegend=true;this.showTable=true;this.showLayers=false;this.showSearch=true;this.showBasemaps=false;this.showServiceAreas=false;this.serviceAreaBreaks=[.07,.37,.75];this.travelMode=null;this.serviceAreaPoint=null;this.session=null;this.basemap="arcgis-topographic";this._item=null;this.datasetEls={}}async addFeatures(t){if(t){const e=await new Ant({title:t.title,source:t.source,fields:t.fields,objectIdField:t.objectIdField,geometryType:t.geometryType});this.webMap.add(e)}}updateServiceArea(t){this.createServiceAreas(t)}async updateDatasets(t,e){console.debug("hub-compass-map: updateDatasets",{newDatasetIds:t,oldDatasetIds:e});t.forEach((async t=>{if(e.includes(t)){console.debug("hub-compass-map: updateDatasets duplicate",{datasetId:t});return}console.debug("hub-compass-map: updateDatasets adding",{datasetId:t});this.addDatasetToMap(t)}))}async updateCenter(t){this.mapView.goTo({center:t,zoom:this.zoom});const e=this.createGraphic(this.mapView.center);this.mapView.graphics.addMany([e],0)}async updateZoom(t){this.mapView.goTo({center:this.center,zoom:t})}async saveMap(t="New webmap",e="Created by Hub AI assistant"){if(this._item===null){this._item={title:t,snippet:e,tags:["hub-radar-map"]}}console.debug("hub-compass-map: saveMap() start",{item:this._item});const i=await this.webMap.updateFrom(this.mapView);const n=await this.webMap.saveAs(this._item);const s={id:n.id,url:n.url};console.debug("hub-compass-map: saveMap() complete",{result:s,updateResult:i,saveResult:n});this._item.id=n.id;this.mapSaved.emit({item:this._item});return s}async addDatasetToMap(t){var e;const i=await new Ant({portalItem:{id:t}});i.popupEnabled=true;this.webMap.add(i);(e=this.datasetEls)[t]||(e[t]={});this.datasetEls[t].layer=i}componentWillLoad(){if(!!this.session){Qjt.registerToken(this.session)}}async componentDidRender(){console.debug("hub-compass-map: componentDidRender",this.datasetEls);if(this.showTable){Object.keys(this.datasetEls).forEach((t=>{if(!this.datasetEls[t].table){this.addTable(t,this.datasetEls[t].layer)}}))}}componentDidLoad(){this.webMap=new wot({basemap:this.basemap});this.mapView=new UY({map:this.webMap,center:this.center,zoom:this.zoom,container:this.mapEl});this.mapView.popup.dockOptions={buttonEnabled:false,breakpoint:true};this.mapView.popup.defaultPopupTemplateEnabled=true;this.mapView.popup.dockEnabled=true;if(this.showSearch){const t=new But({view:this.mapView});this.mapView.ui.add(t,{position:"top-right"})}if(this.showLegend){const t=new mgt({view:this.mapView,layerInfos:[]});this.mapView.ui.add(new QAt({content:t,view:this.mapView,expanded:true,group:"top-right"}),"bottom-right")}if(this.showLayers){const t=new Kct({view:this.mapView});this.mapView.ui.add(new QAt({content:t,view:this.mapView,group:"top-right"}),{position:"top-right"})}if(this.showBasemaps){this.mapView.ui.add([new QAt({content:new Ejt({view:this.mapView}),view:this.mapView,expandIcon:"basemap",group:"top-right"})],{position:"top-right"})}this.mapView.when((()=>{const t=this.createGraphic(this.mapView.center);this.mapView.graphics.addMany([t],0)}));this.mapView.on("click",(t=>{if(this.showServiceAreas){this.createServiceAreas(t.mapPoint)}}));this.mapView.watch("extent",(()=>{let t=new jd({wkid:4326});const e=wb(this.mapView.extent,t);const i=wb(this.mapView.center,t);const n=this.mapView.zoom;this.mapViewExtentChanged.emit({extent:e,center:i,zoom:n})}));if(!!this.datasetIds&&this.datasetIds.length>0){this.datasetIds.forEach((t=>{this.addDatasetToMap(t)}))}}async filterTables(t){Object.keys(this.datasetEls).forEach((e=>{const i=this.datasetEls[e].table;i.filterGeometry=t}))}async addTable(t,e){console.debug("addTable: ",{datasetId:t,featureLayer:e,datasetEls:this.datasetEls});const i=new HAt({view:this.mapView,layer:e,visibleElements:{menuItems:{clearSelection:true,refreshData:true,toggleColumns:true,selectedRecordsShowAllToggle:true,zoomToSelection:true}},container:this.datasetEls[t].view});this.datasetEls[t].table=i}createServiceAreas(t){this.mapView.graphics.removeAll();const e=this.createGraphic(t);this.findServiceArea(e)}createGraphic(t){let e={type:"simple-marker",color:"white",size:8};const i=new NF({geometry:t,symbol:e});this.mapView.graphics.add(i);return i}async findServiceArea(t){if(!this.travelMode){const t=await uat(this.serviceAreaUrl);console.debug("networkDescription.supportedTravelModes",{modes:t.supportedTravelModes});this.travelMode=t.supportedTravelModes.find((t=>t.name==="Walking Distance"))}console.debug("travelMode",this.travelMode);const e=new Yot({facilities:new H6({features:[t]}),defaultBreaks:this.serviceAreaBreaks,travelMode:this.travelMode,travelDirection:"to-facility",outSpatialReference:this.mapView.spatialReference,trimOuterPolygon:true});const{serviceAreaPolygons:i}=await Iat(this.serviceAreaUrl,e);console.debug("hub-compass-map: findServiceArea",{geom:i.features[0]});this.filterTables(i.features[0].geometry);this.addServiceAreas(i)}addServiceAreas(t){const e=t.features.map((t=>{t.symbol={type:"simple-fill",color:`rgba(${Math.floor(Math.random()*200)}, 0, 0, 0.25)`};return t}));this.mapView.graphics.addMany(e,0)}render(){return s(r,null,s("slot",null),s("div",{id:"mapWrapper"},s("div",{ref:t=>this.mapEl=t,id:"mapDiv"}),s("div",{ref:t=>this.tableEl=t,id:"tableDiv"},this.showTable?this.renderTables(this.datasetIds):"")))}renderTables(t){return s("calcite-tabs",{ref:t=>{this.tableTabsEl=t}},s("calcite-tab-nav",{slot:"title-group",ref:t=>{this.tableTabsNavEl=t}},t.map((t=>this.renderTableNav(t)))),t.map((t=>this.renderTableView(t))))}renderTableNav(t){var e;(e=this.datasetEls)[t]||(e[t]={});console.debug("renderTableNav: ",{datasetId:t,datasetEls:this.datasetEls});const i=s("calcite-tab-title",{selected:true,ref:e=>{this.datasetEls[t].nav=e}},"Table");return i}renderTableView(t){console.debug("renderTableView: ",{datasetId:t,datasetEls:this.datasetEls});const e=s("calcite-tab",null,s("div",{class:"table",ref:e=>{this.datasetEls[t].view=e}}));return e}static get watchers(){return{features:["addFeatures"],serviceAreaPoint:["updateServiceArea"],datasetIds:["updateDatasets"],center:["updateCenter"],zoom:["updateZoom"]}}};eCt.style=tCt;export{Ni as $,B2 as A,e3 as B,Kt as C,Q2 as D,Y2 as E,q2 as F,Mi as G,Tz as H,O2 as I,Oz as J,Ez as K,U2 as L,va as M,Lz as N,Wz as O,$2 as P,k2 as Q,Oi as R,Li as S,V2 as T,hc as U,Ai as V,Ii as W,Pi as X,It as Y,Hi as Z,HG as _,Qe as a,Ztt as a$,Wr as a0,qB as a1,bo as a2,TB as a3,MB as a4,_B as a5,xB as a6,UU as a7,mo as a8,eM as a9,Xz as aA,DV as aB,tU as aC,sG as aD,$U as aE,NV as aF,tG as aG,KV as aH,Qz as aI,rG as aJ,np as aK,ip as aL,Am as aM,pm as aN,pp as aO,Xf as aP,Sm as aQ,Ap as aR,IH as aS,Vp as aT,SV as aU,yh as aV,PI as aW,z0 as aX,F as aY,Fi as aZ,Mm as a_,jW as aa,un as ab,Ut as ac,hW as ad,w as ae,$t as af,Vt as ag,fy as ah,_y as ai,uy as aj,zu as ak,pa as al,Vr as am,o as an,Us as ao,Nr as ap,oM as aq,DT as ar,Oo as as,vo as at,Nm as au,Qd as av,py as aw,lG as ax,$T as ay,Jr as az,T2 as b,Tm as b$,km as b0,Jtt as b1,Wtt as b2,Dt as b3,hd as b4,ul as b5,Xct as b6,OG as b7,mB as b8,SB as b9,cp as bA,lR as bB,Nz as bC,_U as bD,dB as bE,yp as bF,F2 as bG,D2 as bH,C2 as bI,W2 as bJ,ve as bK,hR as bL,wp as bM,Btt as bN,R2 as bO,P2 as bP,oC as bQ,eC as bR,hE as bS,Hg as bT,qg as bU,uE as bV,iv as bW,btt as bX,yj as bY,FN as bZ,BD as b_,Az as ba,aB as bb,Cz as bc,ma as bd,JB as be,YB as bf,a as bg,b as bh,FT as bi,OW as bj,mX as bk,Zi as bl,Ui as bm,mu as bn,wl as bo,Vf as bp,xm as bq,_m as br,Gf as bs,jd as bt,X2 as bu,Gp as bv,Bp as bw,rp as bx,Zf as by,jf as bz,j3 as c,mI as c$,pg as c0,mg as c1,_5 as c2,wT as c3,tIt as c4,Mt as c5,S as c6,K2 as c7,ls as c8,cS as c9,ng as cA,Rf as cB,tl as cC,tV as cD,tp as cE,QU as cF,XU as cG,Zt as cH,Nc as cI,gy as cJ,mrt as cK,YM as cL,xk as cM,lit as cN,rit as cO,oit as cP,$k as cQ,Dk as cR,Q$ as cS,pI as cT,fI as cU,Wd as cV,vrt as cW,brt as cX,Yl as cY,JY as cZ,Ul as c_,BF as ca,yB as cb,Jf as cc,KH as cd,DN as ce,Bd as cf,qd as cg,mh as ch,Vd as ci,_h as cj,bb as ck,Eb as cl,Ch as cm,om as cn,vV as co,Cb as cp,yd as cq,vh as cr,Eh as cs,mf as ct,Cf as cu,nf as cv,sf as cw,fg as cx,L0 as cy,Et as cz,v2 as d,vm as d$,hit as d0,rZ as d1,zi as d2,Di as d3,nc as d4,au as d5,Bu as d6,_ as d7,k as d8,G$ as d9,nV as dA,jD as dB,H6 as dC,Ri as dD,Gr as dE,ST as dF,el as dG,Q8 as dH,J8 as dI,qk as dJ,ty as dK,Gk as dL,gE as dM,nb as dN,V6 as dO,gh as dP,ud as dQ,LJ as dR,qJ as dS,bJ as dT,NZ as dU,PZ as dV,TZ as dW,zZ as dX,NJ as dY,eK as dZ,vZ as d_,cit as da,uit as db,NF as dc,Ob as dd,fd as de,Hu as df,bh as dg,AM as dh,qi as di,k7 as dj,$6 as dk,B8 as dl,q8 as dm,G8 as dn,z8 as dp,Qu as dq,sj as dr,W$ as ds,kt as dt,Ei as du,oZ as dv,m as dw,Ptt as dx,Ftt as dy,Dtt as dz,Lt as e,Ee as e$,Uf as e0,Vpt as e1,Zpt as e2,Pdt as e3,x as e4,as as e5,sd as e6,ol as e7,X9 as e8,Hgt as e9,Jgt as eA,oO as eB,vvt as eC,sv as eD,BW as eE,kvt as eF,Mvt as eG,Ant as eH,BE as eI,NO as eJ,VO as eK,eO as eL,$vt as eM,Yvt as eN,xvt as eO,_vt as eP,Ivt as eQ,pvt as eR,Svt as eS,Cvt as eT,Avt as eU,Fvt as eV,Dvt as eW,Act as eX,Sb as eY,JK as eZ,$m as e_,BK as ea,CK as eb,yy as ec,lK as ed,ZK as ee,zK as ef,Hx as eg,qx as eh,Bx as ei,wK as ej,Byt as ek,Wgt as el,Zgt as em,Tct as en,HO as eo,QE as ep,Ygt as eq,uwt as er,Evt as es,zD as et,i7 as eu,svt as ev,uvt as ew,rvt as ex,evt as ey,tvt as ez,tt as f,xC as f$,eL as f0,sL as f1,aL as f2,eY as f3,uF as f4,wb as f5,zat as f6,xy as f7,Hd as f8,ypt as f9,iV as fA,fF as fB,Rat as fC,wC as fD,rC as fE,RC as fF,vC as fG,kB as fH,Qv as fI,cX as fJ,Yct as fK,X3 as fL,Yit as fM,tit as fN,o9 as fO,xa as fP,d9 as fQ,D9 as fR,SC as fS,rht as fT,qC as fU,IC as fV,OC as fW,CC as fX,LC as fY,bC as fZ,EE as f_,VI as fa,qat as fb,Wut as fc,Hut as fd,Put as fe,p as ff,Ns as fg,RF as fh,BG as fi,XG as fj,oB as fk,Ed as fl,pM as fm,My as fn,Fat as fo,wM as fp,Nat as fq,uht as fr,oht as fs,gj as ft,Cm as fu,ll as fv,Ss as fw,al as fx,bm as fy,sV as fz,ht as g,C as g$,vp as g0,tS as g1,pL as g2,f4 as g3,d5 as g4,mM as g5,ght as g6,pb as g7,vb as g8,Vc as g9,xF as gA,Pot as gB,dat as gC,fat as gD,Not as gE,pat as gF,Cot as gG,Rot as gH,Oot as gI,mat as gJ,Lot as gK,Zot as gL,Uot as gM,yat as gN,Eot as gO,E0 as gP,DG as gQ,st as gR,HB as gS,S5 as gT,f2 as gU,c2 as gV,d2 as gW,Sz as gX,gi as gY,O as gZ,AH as g_,Uc as ga,zc as gb,Hc as gc,Yc as gd,_b as ge,ZU as gf,ZV as gg,Rs as gh,Yu as gi,Vl as gj,Gl as gk,$N as gl,Gu as gm,xN as gn,zN as go,qp as gp,kN as gq,fht as gr,hf as gs,_f as gt,gp as gu,Wo as gv,gB as gw,wB as gx,dy as gy,Fot as gz,c as h,ep as h$,D8 as h0,Eit as h1,A9 as h2,oj as h3,znt as h4,ust as h5,hst as h6,Znt as h7,$nt as h8,ent as h9,gn as hA,Ci as hB,Gi as hC,hD,Yf as hE,wa as hF,Ql as hG,EN as hH,qN as hI,w3 as hJ,jh as hK,JI as hL,e5 as hM,t5 as hN,pE as hO,Ipt as hP,hC as hQ,ZC as hR,yg as hS,WC as hT,PN as hU,aD as hV,dE as hW,fE as hX,cE as hY,u3 as hZ,um as h_,Pk as ha,R0 as hb,N0 as hc,Ot as hd,B$ as he,Ou as hf,prt as hg,kp as hh,Gd as hi,ay as hj,Ip as hk,Kb as hl,Knt as hm,Cnt as hn,Vnt as ho,P as hp,Y6 as hq,Ket as hr,fit as hs,ZY as ht,Gt as hu,pj as hv,E9 as hw,Wi as hx,ot as hy,I as hz,Q as i,d1 as i$,I0 as i0,A0 as i1,NN as i2,MIt as i3,ji as i4,jp as i5,j as i6,No as i7,wo as i8,zo as i9,Dd as iA,OB as iB,VB as iC,NA as iD,ia as iE,no as iF,XT as iG,eA as iH,od as iI,Rh as iJ,Ph as iK,Fh as iL,Dh as iM,kh as iN,Ah as iO,ZT as iP,lw as iQ,zw as iR,Uw as iS,sw as iT,oA as iU,WT as iV,rw as iW,uo as iX,q0 as iY,Z0 as iZ,n1 as i_,Uo as ia,ba as ib,sa as ic,xo as id,$o as ie,So as ig,fa as ih,W0 as ii,nt as ij,oo as ik,ao as il,ro as im,gA as io,Kr as ip,Zr as iq,vA as ir,KT as is,Ho as it,LA as iu,Kw as iv,xh as iw,Th as ix,Ih as iy,fB as iz,B1 as j,Po as j$,f1 as j0,a1 as j1,l1 as j2,h1 as j3,v1 as j4,w1 as j5,ca as j6,ho as j7,b9 as j8,ly as j9,CB as jA,m1 as jB,aw as jC,Mh as jD,A1 as jE,az as jF,jo as jG,ra as jH,Lo as jI,Io as jJ,_o as jK,Co as jL,Uh as jM,cl as jN,RQ as jO,BQ as jP,ib as jQ,bht as jR,h2 as jS,wht as jT,gQ as jU,vQ as jV,vht as jW,La as jX,Ro as jY,eIt as jZ,Vo as j_,xn as ja,kn as jb,Mn as jc,Tn as jd,_n as je,z as jf,B as jg,_p as jh,bE as ji,SE as jj,CE as jk,ja as jl,jn as jm,qh as jn,Qy as jo,x5 as jp,b5 as jq,hi as jr,GH as js,dl as jt,su as ju,W as jv,Zo as jw,Ao as jx,ua as jy,ha as jz,w2 as k,Pa as k$,j1 as k0,lA as k1,Bf as k2,Ea as k3,Y as k4,X as k5,Hs as k6,g as k7,y as k8,_u as k9,K6 as kA,IM as kB,$9 as kC,O9 as kD,L9 as kE,z9 as kF,H$ as kG,q$ as kH,J$ as kI,K$ as kJ,Dit as kK,Rit as kL,yC as kM,P9 as kN,p9 as kO,set as kP,Zit as kQ,C9 as kR,a4 as kS,stt as kT,nit as kU,$it as kV,tnt as kW,ok as kX,ak as kY,Qa as kZ,Br as k_,eu as ka,Tu as kb,V$ as kc,wm as kd,ai as ke,ift as kf,Aht as kg,Zht as kh,Kht as ki,Yht as kj,$ht as kk,rft as kl,m2 as km,Jht as kn,Iht as ko,Z2 as kp,Cit as kq,Jb as kr,N9 as ks,cnt as kt,l4 as ku,j9 as kv,qit as kw,jM as kx,PL as ky,$8 as kz,E2 as l,ps as l$,fs as l0,xb as l1,qet as l2,pC as l3,Sg as l4,I9 as l5,Vit as l6,vL as l7,QL as l8,YP as l9,sg as lA,Sh as lB,$b as lC,sk as lD,Vs as lE,rk as lF,yk as lG,Me as lH,uu as lI,ck as lJ,cu as lK,de as lL,hk as lM,Pet as lN,gu as lO,gk as lP,ks as lQ,Nt as lR,Bt as lS,_N as lT,TN as lU,MN as lV,Yy as lW,lht as lX,O0 as lY,ait as lZ,H7 as l_,HI as la,BI as lb,EI as lc,xe as ld,Xk as le,bnt as lf,Yt as lg,WX as lh,kd as li,Md as lj,Td as lk,PD as ll,Bs as lm,t0 as ln,IQ as lo,iX as lp,Xdt as lq,$X as lr,tft as ls,xX as lt,_0 as lu,m0 as lv,o4 as lw,yQ as lx,O5 as ly,Z$ as lz,T as m,V9 as m$,SF as m0,fD as m1,R7 as m2,Bit as m3,hht as m4,ke as m5,yF as m6,bp as m7,Ep as m8,Op as m9,Mot as mA,Dot as mB,zot as mC,Sot as mD,kot as mE,Aot as mF,m4 as mG,e9 as mH,T7 as mI,D5 as mJ,C7 as mK,ctt as mL,get as mM,kT as mN,Ib as mO,UN as mP,AN as mQ,ru as mR,Eu as mS,$i as mT,wA as mU,so as mV,yA as mW,Do as mX,mA as mY,f as mZ,I7 as m_,vB as ma,bU as mb,TU as mc,ga as md,FI as me,hu as mf,vu as mg,Ti as mh,Ol as mi,Lu as mj,ou as mk,Su as ml,vj as mm,Hot as mn,Mat as mo,oat as mp,lat as mq,uat as mr,aat as ms,le as mt,gat as mu,Bot as mv,Got as mw,Vot as mx,bot as my,xot as mz,N2 as n,wu as n$,U9 as n0,Ks as n1,w7 as n2,F6 as n3,EQ as n4,qtt as n5,Gtt as n6,r7 as n7,a7 as n8,l7 as n9,Ki as nA,ec as nB,unt as nC,l as nD,bet as nE,la as nF,nq as nG,sq as nH,J as nI,sc as nJ,ON as nK,LN as nL,M as nM,PA as nN,RA as nO,tA as nP,JU as nQ,U as nR,RN as nS,bft as nT,lt as nU,at as nV,ut as nW,du as nX,uA as nY,iA as nZ,SH as n_,c7 as na,h7 as nb,d7 as nc,f7 as nd,p7 as ne,m7 as nf,y7 as ng,g7 as nh,v7 as ni,ln as nj,K as nk,Nu as nl,$l as nm,Oh as nn,gl as no,dk as np,yo as nq,ya as nr,Mo as ns,F9 as nt,Y$ as nu,ql as nv,Ka as nw,ah as nx,Vh as ny,Ji as nz,xH as o,Oa as o0,eCt as o1,Yw as o2,Hb as o3,zX as o4,n7 as o5,Int as o6,rt as p,L2 as q,zt as r,Ft as s,CW as t,RT as u,PT as v,z2 as w,G2 as x,Pm as y,J2 as z};
//# sourceMappingURL=p-028496e2.js.map