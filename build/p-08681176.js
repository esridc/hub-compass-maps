import{d as t}from"./p-682c165c.js";import{E as s}from"./p-2ea4a2b9.js";import{cn as n,d8 as i,de as e,c6 as r,c4 as o,fp as a,d3 as c,ch as h,ci as p,da as u}from"./p-aad64c9f.js";import{E as l}from"./p-1c4b55c0.js";import{o as v}from"./p-44881b12.js";class m{constructor(t,s,n,i,e,r,o,a,c){this.createQuery=t,this.deleteQuery=s,this.resultAvailable=n,this.getResult=i,this.disjoint=e,this.beginTimeElapsed=r,this.endTimeElapsed=o,this.createTimestamp=a,this.timestampBits=c}}let w=!1;function _(t,s){if(s.disjointTimerQuery)return null;let n=t.getExtension("EXT_disjoint_timer_query_webgl2");return n?new m((()=>t.createQuery()),(s=>{t.deleteQuery(s),w=!1}),(s=>t.getQueryParameter(s,t.QUERY_RESULT_AVAILABLE)),(s=>t.getQueryParameter(s,t.QUERY_RESULT)),(()=>t.getParameter(n.GPU_DISJOINT_EXT)),(s=>{w||(w=!0,t.beginQuery(n.TIME_ELAPSED_EXT,s))}),(()=>{t.endQuery(n.TIME_ELAPSED_EXT),w=!1}),(t=>n.queryCounterEXT(t,n.TIMESTAMP_EXT)),(()=>t.getQuery(n.TIMESTAMP_EXT,n.QUERY_COUNTER_BITS_EXT))):(n=t.getExtension("EXT_disjoint_timer_query"),n?new m((()=>n.createQueryEXT()),(t=>{n.deleteQueryEXT(t),w=!1}),(t=>n.getQueryObjectEXT(t,n.QUERY_RESULT_AVAILABLE_EXT)),(t=>n.getQueryObjectEXT(t,n.QUERY_RESULT_EXT)),(()=>t.getParameter(n.GPU_DISJOINT_EXT)),(t=>{w||(w=!0,n.beginQueryEXT(n.TIME_ELAPSED_EXT,t))}),(()=>{n.endQueryEXT(n.TIME_ELAPSED_EXT),w=!1}),(t=>n.queryCounterEXT(t,n.TIMESTAMP_EXT)),(()=>n.getQueryEXT(n.TIMESTAMP_EXT,n.QUERY_COUNTER_BITS_EXT))):null)}class g{constructor(){this._result=!1}dispose(){this._program=n(this._program)}get result(){return null!=this._program&&(this._result=this._test(this._program),this.dispose()),this._result}}class d extends g{constructor(t){super(),this._rctx=t;const s="\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",n="\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ";this._program=t.programCache.acquire(s,n,new Map([["a_pos",0]]))}dispose(){super.dispose()}_test(n){const m=this._rctx;if(!m.gl)return n.dispose(),!0;const w=new u(1);w.wrapMode=i.CLAMP_TO_EDGE,w.samplingMode=e.NEAREST;const _=new l(m,w),g=s.createVertex(m,r.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),d=new v(m,new Map([["a_pos",0]]),t,new Map([["geometry",g]])),x=new u;x.samplingMode=e.LINEAR,x.wrapMode=i.CLAMP_TO_EDGE;const y=new o(m,x,f);m.useProgram(n),m.bindTexture(y,0),n.setUniform1i("u_texture",0);const E=m.getBoundFramebufferObject(),{x:j,y:b,width:C,height:F}=m.getViewport();m.bindFramebuffer(_),m.setViewport(0,0,1,1),m.setClearColor(0,0,0,0),m.setBlendingEnabled(!1),m.clear(a.COLOR),m.bindVAO(d),m.drawArrays(c.TRIANGLE_STRIP,0,4);const A=new Uint8Array(4);return _.readPixels(0,0,1,1,h.RGBA,p.UNSIGNED_BYTE,A),d.dispose(),_.dispose(),y.dispose(),m.setViewport(j,b,C,F),m.bindFramebuffer(E),255!==A[0]}}const f=new Image;f.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",f.width=5,f.height=5,f.decode();export{g as a,d as f,_ as t};
//# sourceMappingURL=p-08681176.js.map