import{kZ as t,dE as e,am as s,lS as i,an as n,ao as l,av as r,h2 as a,ap as o,k_ as u,dK as h,g5 as d,ah as c,fn as p,fm as y,lT as f,eY as g,lU as b,lV as v,hr as j,ht as m,fa as w}from"./p-3013819f.js";import{c as O}from"./p-4c1e1ecc.js";import{j as x}from"./p-253c68bc.js";import{i as I}from"./p-01c01bc2.js";import"./p-3b51db5e.js";import"./p-8be499c9.js";import"./p-933bb056.js";function L(t,e){return S(t)===S(e)}function S(t){if(null==t)return null;const e=null!=t.layer?t.layer.id:"";let s=null;return s=null!=t.objectId?t.objectId:null!=t.layer&&"objectIdField"in t.layer&&null!=t.layer.objectIdField&&null!=t.attributes?t.attributes[t.layer.objectIdField]:t.uid,null==s?null:`o-${e}-${s}`}const E={json:{write:{writer:q,target:{"feature.layerId":{type:[Number,String]},"feature.objectId":{type:[Number,String]}}},origins:{"web-scene":{read:R}}}};function q(t,e){null!=t?.layer?.objectIdField&&null!=t.attributes&&(e.feature={layerId:t.layer.id,objectId:t.attributes[t.layer.objectIdField]})}function R(t){if(null!=t.layerId&&null!=t.objectId)return{uid:null,layer:{id:t.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:t.objectId}}}let A=class extends(t(e(s))){constructor(t){super(t),this.position=null,this.elevationInfo=null,this.feature=null}equals(t){return i(this.position,t.position)&&i(this.elevationInfo,t.elevationInfo)&&L(this.feature,t.feature)}};n([l({type:r,json:{write:{isRequired:!0}}})],A.prototype,"position",void 0),n([l({type:a}),x()],A.prototype,"elevationInfo",void 0),n([l(E)],A.prototype,"feature",void 0),A=n([o("esri.analysis.LineOfSightAnalysisObserver")],A);const F=A;let N=class extends(t(u)){constructor(t){super(t),this.position=null,this.elevationInfo=null,this.feature=null}equals(t){return i(this.position,t.position)&&i(this.elevationInfo,t.elevationInfo)&&L(this.feature,t.feature)}};n([l({type:r}),x()],N.prototype,"position",void 0),n([l({type:a}),x()],N.prototype,"elevationInfo",void 0),n([l(E)],N.prototype,"feature",void 0),N=n([o("esri.analysis.LineOfSightAnalysisTarget")],N);const z=N;const P=h.ofType(z);let T=class extends O{constructor(t){super(t),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(c((()=>this._computeExtent()),(t=>{null==t?.pending&&this._set("extent",null!=t?t.extent:null)}),p))}get targets(){return this._get("targets")||new P}set targets(t){this._set("targets",y(t,this.targets,P))}get spatialReference(){return null!=this.observer?.position?this.observer.position.spatialReference:null}get requiredPropertiesForEditing(){return[this.observer?.position]}async waitComputeExtent(){const t=this._computeExtent();return null!=t?t.pending:Promise.resolve()}_computeExtent(){const t=this.spatialReference;if(null==this.observer?.position||null==t)return null;const e=t=>"absolute-height"===I(t.position,t.elevationInfo),s=this.observer.position,i=f(s.x,s.y,s.z,s.x,s.y,s.z);for(const e of this.targets)if(null!=e.position){const s=g(e.position,t);if(null!=s.pending)return{pending:s.pending,extent:null};if(null!=s.geometry){const{x:t,y:e,z:n}=s.geometry;b(i,[t,e,n])}}const n=v(i,t);return e(this.observer)&&this.targets.every(e)||(n.zmin=void 0,n.zmax=void 0),{pending:null,extent:n}}clear(){this.observer=null,this.targets.removeAll()}};n([l({type:["line-of-sight"]})],T.prototype,"type",void 0),n([l({type:F,json:{read:!0,write:!0}})],T.prototype,"observer",void 0),n([l({cast:d,type:P,nonNullable:!0,json:{read:!0,write:!0}})],T.prototype,"targets",null),n([l({value:null,readOnly:!0})],T.prototype,"extent",void 0),n([l({readOnly:!0})],T.prototype,"spatialReference",null),n([l({readOnly:!0})],T.prototype,"requiredPropertiesForEditing",null),T=n([o("esri.analysis.LineOfSightAnalysis")],T);const k=T;const $=h.ofType(z);let _=class extends(j(m(w))){constructor(t){super(t),this.type="line-of-sight",this.operationalLayerType="LineOfSightLayer",this.analysis=new k,this.opacity=1}initialize(){this.addHandles(c((()=>this.analysis),((t,e)=>{null!=e&&e.parent===this&&(e.parent=null),null!=t&&(t.parent=this)}),p))}async load(){return null!=this.analysis&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return this.analysis?.observer}set observer(t){const{analysis:e}=this;e&&(e.observer=t)}get targets(){return null!=this.analysis?this.analysis.targets:new h}set targets(t){y(t,this.analysis?.targets)}get fullExtent(){return null!=this.analysis?this.analysis.extent:null}get spatialReference(){return null!=this.analysis?this.analysis.spatialReference:null}releaseAnalysis(t){this.analysis===t&&(this.analysis=new k)}};n([l({json:{read:!1},readOnly:!0})],_.prototype,"type",void 0),n([l({type:["LineOfSightLayer"]})],_.prototype,"operationalLayerType",void 0),n([l({type:F,json:{read:!0,write:{isRequired:!0,ignoreOrigin:!0}}})],_.prototype,"observer",null),n([l({type:$,json:{read:!0,write:{ignoreOrigin:!0}}})],_.prototype,"targets",null),n([l({nonNullable:!0,json:{read:!1,write:!1}})],_.prototype,"analysis",void 0),n([l({readOnly:!0})],_.prototype,"fullExtent",null),n([l({readOnly:!0})],_.prototype,"spatialReference",null),n([l({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],_.prototype,"opacity",void 0),n([l({type:["show","hide"]})],_.prototype,"listMode",void 0),_=n([o("esri.layers.LineOfSightLayer")],_);const C=_;export default C;
//# sourceMappingURL=p-2392b9e1.js.map