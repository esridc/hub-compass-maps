import{cr as t,cn as s,n as i,c7 as e,cs as h}from"./p-aad64c9f.js";const r=()=>i.getLogger("esri.views.webgl.VertexArrayObject");let n=class{constructor(t,s,i,e,h=null){this._context=t,this._locations=s,this._layout=i,this._buffers=e,this._indexBuffer=h,this._glName=null,this._initialized=!1}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get byteSize(){return Array.from(this._buffers.values()).reduce(((t,s)=>t+s.usedMemory),null!=this._indexBuffer?this._indexBuffer.usedMemory:0)}get layout(){return this._layout}get locations(){return this._locations}get usedMemory(){return this.byteSize+(Object.keys(this._buffers).length+(this._indexBuffer?1:0))*t}dispose(){this._context?(this._context.getBoundVAO()===this&&this._context.bindVAO(null),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this._indexBuffer=s(this._indexBuffer),this.disposeVAOOnly()):(this._glName||Object.getOwnPropertyNames(this._buffers).length>0)&&r().warn("Leaked WebGL VAO")}disposeVAOOnly(){this._glName&&(this._context.gl.deleteVertexArray(this._glName),this._glName=null,this._context.instanceCounter.decrement(e.VertexArrayObject,this)),this._context=null}initialize(){if(this._initialized)return;const{gl:t}=this._context,s=t.createVertexArray();t.bindVertexArray(s),this._bindLayout(),t.bindVertexArray(null),this._glName=s,this._context.instanceCounter.increment(e.VertexArrayObject,this),this._initialized=!0}bind(){this.initialize(),this._context.gl.bindVertexArray(this.glName)}_bindLayout(){const{_buffers:t,_layout:s,_indexBuffer:i}=this;t||r().error("Vertex buffer dictionary is empty!");const e=this._context.gl;this._buffers.forEach(((t,i)=>{const e=s.get(i);e?h(this._context,this._locations,t,e):r().error("Vertex element descriptor is empty!")})),null!=i&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.glName)}unbind(){this.initialize(),this._context.gl.bindVertexArray(null)}};export{n as o};
//# sourceMappingURL=p-44881b12.js.map