import{m as n}from"./p-4295487d.js";import{g as t,K as r,E as i,P as e,X as o,a as f,r as a,j as s,B as u}from"./p-63562f76.js";import{l as c}from"./p-448d8eb2.js";import{Z as p,r as m}from"./p-cea3971b.js";import"./p-aad64c9f.js";import"./p-2af77f97.js";import"./p-11492679.js";import"./p-7950bc60.js";import"./p-1bb606f6.js";import"./p-875cbb57.js";import"./p-da522976.js";import"./p-aff89b86.js";import"./p-d492d39b.js";async function j(n,t,e,f){if(1===e.length){if(i(e[0]))return c(n,e[0],s(e[1],-1));if(o(e[0]))return c(n,e[0].toArray(),s(e[1],-1))}else if(2===e.length){if(i(e[0]))return c(n,e[0],s(e[1],-1));if(o(e[0]))return c(n,e[0].toArray(),s(e[1],-1));if(r(e[0])){const r=await e[0].load(),i=await b(p.create(e[1],{fieldsIndex:r.getFieldsIndex(),timeZone:r.dateFieldsTimeZoneDefaultUTC}),f,t);return d(t,await e[0].calculateStatistic(n,i,s(e[2],1e3),t.abortSignal))}}else if(3===e.length&&r(e[0])){const r=await e[0].load(),i=await b(p.create(e[1],{fieldsIndex:r.getFieldsIndex(),timeZone:r.dateFieldsTimeZoneDefaultUTC}),f,t);return d(t,await e[0].calculateStatistic(n,i,s(e[2],1e3),t.abortSignal))}return c(n,e,-1)}function d(t,r){return r instanceof m?n.fromReaderAsTimeStampOffset(r.toStorageFormat()):r instanceof Date?n.dateJSAndZoneToArcadeDate(r,u(t)):r}async function b(n,t,r){const i=n.getVariables();if(i.length>0){const e=[];for(let n=0;n<i.length;n++){const o={name:i[n]};e.push(await t.evaluateIdentifier(r,o))}const o={};for(let n=0;n<i.length;n++)o[i[n]]=e[n];return n.parameters=o,n}return n}function w(n){"async"===n.mode&&(n.functions.stdev=function(t,r){return n.standardFunctionAsync(t,r,((r,i,e)=>j("stdev",t,e,n)))},n.functions.variance=function(t,r){return n.standardFunctionAsync(t,r,((r,i,e)=>j("variance",t,e,n)))},n.functions.average=function(t,r){return n.standardFunctionAsync(t,r,((r,i,e)=>j("mean",t,e,n)))},n.functions.mean=function(t,r){return n.standardFunctionAsync(t,r,((r,i,e)=>j("mean",t,e,n)))},n.functions.sum=function(t,r){return n.standardFunctionAsync(t,r,((r,i,e)=>j("sum",t,e,n)))},n.functions.min=function(t,r){return n.standardFunctionAsync(t,r,((r,i,e)=>j("min",t,e,n)))},n.functions.max=function(t,r){return n.standardFunctionAsync(t,r,((r,i,e)=>j("max",t,e,n)))},n.functions.count=function(s,u){return n.standardFunctionAsync(s,u,(async(n,c,p)=>{if(t(p,1,1,s,u),r(p[0]))return p[0].count(n.abortSignal);if(i(p[0])||e(p[0]))return p[0].length;if(o(p[0]))return p[0].length();throw new f(s,a.InvalidParameter,u)}))})}export{w as registerFunctions};
//# sourceMappingURL=p-d5bd0ae0.js.map