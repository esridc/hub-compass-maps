import{fQ as n}from"./p-aad64c9f.js";import"./p-2af77f97.js";var r,t={},e={},u={};function i(){if(r)return u;r=1,Object.defineProperty(u,"__esModule",{value:!0}),u.loop=u.conditional=u.parse=void 0;var n=function n(r,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;if(Array.isArray(t))t.forEach((function(t){return n(r,t,e,u)}));else if("function"==typeof t)t(r,e,u,n);else{var i=Object.keys(t)[0];Array.isArray(t[i])?(u[i]={},n(r,t[i],e,u[i])):u[i]=t[i](r,e,u,n)}return e};u.parse=n;var t=function(n,r){return function(t,e,u,i){r(t,e,u)&&i(t,n,e,u)}};u.conditional=t;var e=function(n,r){return function(t,e,u,i){for(var o=[],a=t.pos;r(t,e,u);){var c={};if(i(t,n,e,c),t.pos===a)break;a=t.pos,o.push(c)}return o}};return u.loop=e,u}var o,a,c={};function f(){if(o)return c;o=1,Object.defineProperty(c,"__esModule",{value:!0}),c.readBits=c.readArray=c.readUnsigned=c.readString=c.peekBytes=c.readBytes=c.peekByte=c.readByte=c.buildStream=void 0;var n=function(n){return{data:n,pos:0}};c.buildStream=n;var r=function(){return function(n){return n.data[n.pos++]}};c.readByte=r;var t=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(r){return r.data[r.pos+n]}};c.peekByte=t;var e=function(n){return function(r){return r.data.subarray(r.pos,r.pos+=n)}};c.readBytes=e;var u=function(n){return function(r){return r.data.subarray(r.pos,r.pos+n)}};c.peekBytes=u;var i=function(n){return function(r){return Array.from(e(n)(r)).map((function(n){return String.fromCharCode(n)})).join("")}};c.readString=i;var a=function(n){return function(r){var t=e(2)(r);return n?(t[1]<<8)+t[0]:(t[0]<<8)+t[1]}};c.readUnsigned=a;var f=function(n,r){return function(t,u,i){for(var o="function"==typeof r?r(t,u,i):r,a=e(n),c=new Array(o),f=0;f<o;f++)c[f]=a(t);return c}};c.readArray=f;var s=function(n,r,t){for(var e=0,u=0;u<t;u++)e+=n[r+u]&&Math.pow(2,t-u-1);return e},v=function(n){return function(t){for(var e=r()(t),u=new Array(8),i=0;i<8;i++)u[7-i]=!!(e&1<<i);return Object.keys(n).reduce((function(r,t){var e=n[t];return e.length?r[t]=s(u,e.index,e.length):r[t]=u[e.index],r}),{})}};return c.readBits=v,c}function s(){return a||(a=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(),t=f(),e={blocks:function(n){for(var r=0,e=[],u=n.data.length,i=0,o=(0,t.readByte)()(n);o!==r&&o;o=(0,t.readByte)()(n)){if(n.pos+o>=u){var a=u-n.pos;e.push((0,t.readBytes)(a)(n)),i+=a;break}e.push((0,t.readBytes)(o)(n)),i+=o}for(var c=new Uint8Array(i),f=0,s=0;s<e.length;s++)c.set(e[s],f),f+=e[s].length;return c}},u=(0,r.conditional)({gce:[{codes:(0,t.readBytes)(2)},{byteSize:(0,t.readByte)()},{extras:(0,t.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,t.readUnsigned)(!0)},{transparentColorIndex:(0,t.readByte)()},{terminator:(0,t.readByte)()}]},(function(n){var r=(0,t.peekBytes)(2)(n);return 33===r[0]&&249===r[1]})),o=(0,r.conditional)({image:[{code:(0,t.readByte)()},{descriptor:[{left:(0,t.readUnsigned)(!0)},{top:(0,t.readUnsigned)(!0)},{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{lct:(0,t.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,r.conditional)({lct:(0,t.readArray)(3,(function(n,r,t){return Math.pow(2,t.descriptor.lct.size+1)}))},(function(n,r,t){return t.descriptor.lct.exists})),{data:[{minCodeSize:(0,t.readByte)()},e]}]},(function(n){return 44===(0,t.peekByte)()(n)})),a=(0,r.conditional)({text:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{preData:function(n,r,e){return(0,t.readBytes)(e.text.blockSize)(n)}},e]},(function(n){var r=(0,t.peekBytes)(2)(n);return 33===r[0]&&1===r[1]})),c=(0,r.conditional)({application:[{codes:(0,t.readBytes)(2)},{blockSize:(0,t.readByte)()},{id:function(n,r,e){return(0,t.readString)(e.blockSize)(n)}},e]},(function(n){var r=(0,t.peekBytes)(2)(n);return 33===r[0]&&255===r[1]})),s=(0,r.conditional)({comment:[{codes:(0,t.readBytes)(2)},e]},(function(n){var r=(0,t.peekBytes)(2)(n);return 33===r[0]&&254===r[1]})),v=[{header:[{signature:(0,t.readString)(3)},{version:(0,t.readString)(3)}]},{lsd:[{width:(0,t.readUnsigned)(!0)},{height:(0,t.readUnsigned)(!0)},{gct:(0,t.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,t.readByte)()},{pixelAspectRatio:(0,t.readByte)()}]},(0,r.conditional)({gct:(0,t.readArray)(3,(function(n,r){return Math.pow(2,r.lsd.gct.size+1)}))},(function(n,r){return r.lsd.gct.exists})),{frames:(0,r.loop)([u,c,s,o,a],(function(n){var r=(0,t.peekByte)()(n);return 33===r||44===r}))}];n.default=v}(e)),e}var v,d={};function l(){if(v)return d;v=1,Object.defineProperty(d,"__esModule",{value:!0}),d.deinterlace=void 0;var n=function(n,r){for(var t=new Array(n.length),e=n.length/r,u=function(e,u){var i=n.slice(u*r,(u+1)*r);t.splice.apply(t,[e*r,r].concat(i))},i=[0,4,2,1],o=[8,8,4,2],a=0,c=0;c<4;c++)for(var f=i[c];f<e;f+=o[c])u(f,a),a++;return t};return d.deinterlace=n,d}var h,b,p={};function w(){if(h)return p;h=1,Object.defineProperty(p,"__esModule",{value:!0}),p.lzw=void 0;var n=function(n,r,t){var e,u,i,o,a,c,f,s,v,d,l,h,b,p,w,g,x=4096,y=-1,m=t,A=new Array(t),k=new Array(x),_=new Array(x),j=new Array(x+1);for(a=(u=1<<(d=n))+1,e=u+2,f=y,i=(1<<(o=d+1))-1,s=0;s<u;s++)k[s]=0,_[s]=s;for(l=h=b=p=w=g=0,v=0;v<m;){if(0===p){if(h<o){l+=r[g]<<h,h+=8,g++;continue}if(s=l&i,l>>=o,h-=o,s>e||s==a)break;if(s==u){i=(1<<(o=d+1))-1,e=u+2,f=y;continue}if(f==y){j[p++]=_[s],f=s,b=s;continue}for(c=s,s==e&&(j[p++]=b,s=f);s>u;)j[p++]=_[s],s=k[s];b=255&_[s],j[p++]=b,e<x&&(k[e]=f,_[e]=b,!(++e&i)&&e<x&&(o++,i+=e)),f=c}p--,A[w++]=j[p],v++}for(v=w;v<m;v++)A[v]=0;return A};return p.lzw=n,p}function g(){if(b)return t;b=1,Object.defineProperty(t,"__esModule",{value:!0}),t.decompressFrames=t.decompressFrame=t.parseGIF=void 0;var n=a(s()),r=i(),e=f(),u=l(),o=w();function a(n){return n&&n.__esModule?n:{default:n}}var c=function(t){var u=new Uint8Array(t);return(0,r.parse)((0,e.buildStream)(u),n.default)};t.parseGIF=c;var v=function(n){for(var r=n.pixels.length,t=new Uint8ClampedArray(4*r),e=0;e<r;e++){var u=4*e,i=n.pixels[e],o=n.colorTable[i]||[0,0,0];t[u]=o[0],t[u+1]=o[1],t[u+2]=o[2],t[u+3]=i!==n.transparentIndex?255:0}return t},d=function(n,r,t){if(n.image){var e=n.image,i=e.descriptor.width*e.descriptor.height,a=(0,o.lzw)(e.data.minCodeSize,e.data.blocks,i);e.descriptor.lct.interlaced&&(a=(0,u.deinterlace)(a,e.descriptor.width));var c={pixels:a,dims:{top:n.image.descriptor.top,left:n.image.descriptor.left,width:n.image.descriptor.width,height:n.image.descriptor.height}};return e.descriptor.lct&&e.descriptor.lct.exists?c.colorTable=e.lct:c.colorTable=r,n.gce&&(c.delay=10*(n.gce.delay||10),c.disposalType=n.gce.extras.disposal,n.gce.extras.transparentColorGiven&&(c.transparentIndex=n.gce.transparentColorIndex)),t&&(c.patch=v(c)),c}console.warn("gif frame does not have associated image.")};t.decompressFrame=d;var h=function(n,r){return n.frames.filter((function(n){return n.image})).map((function(t){return d(t,n.gct,r)}))};return t.decompressFrames=h,t}var x=g();let y,m,A;function k(n,r){return y??=document.createElement("canvas"),y.width=n,y.height=r,y.getContext("2d",{willReadFrequently:!0})}async function _(r,t){const e=x.parseGIF(r),u=x.decompressFrames(e,!0),{width:i,height:o}=e.lsd,a=k(i,o),c=[],f=[];let s=0;for(const r of u){const t=n(r.delay||100);f.push(t),s+=t;const e=j(new ImageData(r.patch,r.dims.width,r.dims.height)),u=3===r.disposalType?a.getImageData(r.dims.left,r.dims.top,r.dims.width,r.dims.height):void 0;a.drawImage(e,r.dims.left,r.dims.top);const v=a.getImageData(0,0,i,o);c.push(v),1===r.disposalType||(2===r.disposalType?a.clearRect(r.dims.left,r.dims.top,r.dims.width,r.dims.height):3===r.disposalType&&a.putImageData(u,r.dims.left,r.dims.top))}return{frameCount:u.length,duration:s,frameDurations:f,getFrame:n=>c[n],width:i,height:o}}function j(n){return m??=document.createElement("canvas"),A??=m.getContext("2d",{willReadFrequently:!0}),m.width=n.width,m.height=n.height,A.putImageData(n,0,0),m}const M=[71,73,70];function O(n){const r=new Uint8Array(n);return!M.some(((n,t)=>n!==r[t]))}function z(n){if(!O(n))return!1;const r=new DataView(n),t=r.getUint8(10);let e=13+(128&t?3*2**(1+(7&t)):0),u=0,i=!1;for(;!i;){switch(r.getUint8(e++)){case 33:if(!o())return!1;break;case 44:a();break;case 59:i=!0;break;default:return!1}if(u>1)return!0}function o(){switch(r.getUint8(e++)){case 249:c();break;case 1:f();break;case 254:s();break;case 255:v();break;default:return!1}return!0}function a(){u++,e+=8;const n=r.getUint8(e++);e+=128&n?3*2**(1+(7&n)):0,e++,d()}function c(){e++,e+=4,d()}function f(){u++,e++,e+=12,d()}function s(){d()}function v(){e++,e+=8,e+=3,d()}function d(){let n;for(;n=r.getUint8(e++);)e+=n}return!1}export{z as isAnimatedGIF,O as isGIF,_ as parseGif};
//# sourceMappingURL=p-2175a3cb.js.map