import{N as t,r as e,c as i,h as n,H as s}from"./p-2af77f97.js";function r(t,e,i,n){var s,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,i,o):s(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}function o(t,e){return function(i,n){e(i,n,t)}}function a(t,e,i,n){function s(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):s(t.value).then(o,a)}l((n=n.apply(t,e||[])).next())}))}"function"==typeof SuppressedError?SuppressedError:function(t,e,i){var n=new Error(i);return n.name="SuppressedError",n.error=t,n.suppressed=e,n};let l;function u(t){return"function"==typeof l[t]?l[t]=l[t](globalThis):l[t]}l=globalThis.dojoConfig?.has||globalThis.esriConfig?.has?{...globalThis.dojoConfig?.has,...globalThis.esriConfig?.has}:{},u.add=(t,e,i,n)=>{(n||void 0===l[t])&&(l[t]=e),i&&u(t)},u.cache=l,u.add("big-integer-warning-enabled",!0),u.add("esri-deprecation-warnings",!0),u.add("esri-tests-disable-screenshots",!1),u.add("esri-tests-use-full-window",!1),u.add("esri-tests-post-to-influx",!0),u.add("esri-cim-animations-enable-status","enabled"),u.add("esri-cim-animations-spotlight",!1),u.add("esri-cim-animations-freeze-time",!1),u.add("enable-feature:multiple-highlights",!1),(()=>{u.add("host-webworker",void 0!==globalThis.WorkerGlobalScope&&self instanceof globalThis.WorkerGlobalScope);const t="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(u.add("host-browser",t),u.add("host-node","object"==typeof globalThis.process&&globalThis.process.versions?.node&&globalThis.process.versions.v8),u.add("dom",t),u("host-browser")){const t=navigator,e=t.userAgent,i=t.appVersion,n=parseFloat(i);if(u.add("wp",parseFloat(e.split("Windows Phone")[1])||void 0),u.add("msapp",parseFloat(e.split("MSAppHost/")[1])||void 0),u.add("khtml",i.includes("Konqueror")?n:void 0),u.add("edge",parseFloat(e.split("Edge/")[1])||void 0),u.add("opr",parseFloat(e.split("OPR/")[1])||void 0),u.add("webkit",!u("wp")&&!u("edge")&&parseFloat(e.split("WebKit/")[1])||void 0),u.add("chrome",!u("edge")&&!u("opr")&&parseFloat(e.split("Chrome/")[1])||void 0),u.add("android",!u("wp")&&parseFloat(e.split("Android ")[1])||void 0),u.add("safari",!i.includes("Safari")||u("wp")||u("chrome")||u("android")||u("edge")||u("opr")?void 0:parseFloat(i.split("Version/")[1])),u.add("mac",i.includes("Macintosh")),!u("wp")&&/(iPhone|iPod|iPad)/.test(e)){const t=RegExp.$1.replace(/P/,"p"),i=/OS ([\d_]+)/.test(e)?RegExp.$1:"1",n=parseFloat(i.replace(/_/,".").replaceAll("_",""));u.add(t,n),u.add("ios",n)}u("webkit")||(!e.includes("Gecko")||u("wp")||u("khtml")||u("edge")||u.add("mozilla",n),u("mozilla")&&u.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&u.add("esri-mobile",e),i&&u.add("esri-iPhone",i),u.add("esri-geolocation",!!navigator.geolocation)}u.add("esri-wasm","WebAssembly"in globalThis),u.add("esri-performance-mode-frames-between-render",20),u.add("esri-force-performance-mode",!1),u.add("esri-shared-array-buffer",(()=>{const t="SharedArrayBuffer"in globalThis,e=!1===globalThis.crossOriginIsolated;return t&&!e})),u.add("wasm-simd",(()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))})),u.add("esri-atomics","Atomics"in globalThis),u.add("esri-workers","Worker"in globalThis),u.add("web-feat:cache","caches"in globalThis),u.add("esri-workers-arraybuffer-transfer",!u("safari")||Number(u("safari"))>=12),u.add("workers-pool-size",8),u.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),u.add("featurelayer-simplify-payload-size-factors",[1,1,4]),u.add("featurelayer-fast-triangulation-enabled",!0),u.add("featurelayer-animation-enabled",!0),u.add("featurelayer-snapshot-enabled",!0),u.add("featurelayer-snapshot-point-min-threshold",8e4),u.add("featurelayer-snapshot-point-max-threshold",4e5),u.add("featurelayer-snapshot-point-coverage",.1),u.add("featurelayer-query-max-depth",4),u.add("featurelayer-query-pausing-enabled",!1),u.add("featurelayer-advanced-symbols",!1),u.add("featurelayer-pbf",!0),u.add("featurelayer-pbf-statistics",!1),u.add("feature-layers-workers",!0),u.add("feature-polyline-generalization-factor",1),u.add("mapview-transitions-duration",200),u.add("mapview-essential-goto-duration",200),u.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),u.add("mapserver-pbf-version-support",10.81),u.add("mapservice-popup-identify-max-tolerance",20),u("host-webworker")||u("host-browser")&&(u.add("esri-csp-restrictions",(()=>{try{new Function}catch{return!0}return!1})),u.add("esri-image-decode",(()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then((()=>{u.add("esri-image-decode",!0,!0,!0)})).catch((()=>{u.add("esri-image-decode",!1,!0,!0)}))}return!1})),u.add("esri-url-encodes-apostrophe",(()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")})))})();class c{constructor(t=1){this._seed=t}set seed(t){this._seed=t??Math.random()*c._m}getInt(){return this._seed=(c._a*this._seed+c._c)%c._m,this._seed}getFloat(){return this.getInt()/(c._m-1)}getIntRange(t,e){return Math.round(this.getFloatRange(t,e))}getFloatRange(t,e){const i=e-t;return t+this.getInt()/c._m*i}}c._m=2147483647,c._a=48271,c._c=0;const h=1.5,d=1/h,f=.5;function p(t,e){return e?t.filter(((t,i,n)=>n.findIndex(e.bind(null,t))===i)):Array.from(new Set(t))}function m(t,e,i){if(null==t&&null==e)return!0;if(null==t||null==e||t.length!==e.length)return!1;if(i){for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function y(t,e,i){let n,s;return i?(n=e.filter((e=>!t.some((t=>i(t,e))))),s=t.filter((t=>!e.some((e=>i(e,t)))))):(n=e.filter((e=>!t.includes(e))),s=t.filter((t=>!e.includes(t)))),{added:n,removed:s}}function g(t){return t&&"number"==typeof t.length}class v{constructor(){this.last=0}}const w=new v;function b(t,e,i,n){n=n||w;const s=Math.max(0,n.last-10);for(let r=s;r<i;++r)if(t[r]===e)return n.last=r,r;const r=Math.min(s,i);for(let i=0;i<r;++i)if(t[i]===e)return n.last=i,i;return-1}function S(t,e,i,n){const s=i??t.length,r=b(t,e,s,n);if(-1!==r)return t[r]=t[s-1],null==i&&t.pop(),e}const _=new Set;function x(t,e,i=t.length,n=e.length,s,r){if(0===n||0===i)return i;_.clear();for(let t=0;t<n;++t)_.add(e[t]);s=s||w;const o=Math.max(0,s.last-10);for(let e=o;e<i;++e)if(_.has(t[e])&&(r?.push(t[e]),_.delete(t[e]),t[e]=t[i-1],--i,--e,0===_.size||0===i))return _.clear(),i;for(let e=0;e<o;++e)if(_.has(t[e])&&(r?.push(t[e]),_.delete(t[e]),t[e]=t[i-1],--i,--e,0===_.size||0===i))return _.clear(),i;return _.clear(),i}function M(t,e){let i=0;for(let n=0;n<t.length;++n){const s=t[n];e(s,n)&&(t[i]=s,i++)}t.length=i}function T(t){return t?(I.seed=t,()=>I.getFloat()):Math.random}function A(t,e){const i=T(e);for(let e=t.length-1;e>0;e--){const n=Math.floor(i()*(e+1)),s=t[e];t[e]=t[n],t[n]=s}return t}const I=new c;function k(t,e){const i=t.indexOf(e);return-1!==i?(t.splice(i,1),e):null}function C(t,e){return null!=t}function E(t){return 32+t.length}function j(){return 16}function O(t){if(!t)return 0;let e=F;for(const i in t)if(t.hasOwnProperty(i)){const n=t[i];switch(typeof n){case"string":e+=E(n);break;case"number":e+=j();break;case"boolean":e+=4}}return e}function R(t){if(!t)return 0;if(Array.isArray(t))return L(t);let e=F;for(const i in t)t.hasOwnProperty(i)&&(e+=N(t[i]));return e}function L(t){const e=t.length;if(0===e||"number"==typeof t[0])return 32+8*e;let i=D;for(let n=0;n<e;n++)i+=N(t[n]);return i}function N(t){switch(typeof t){case"object":return R(t);case"string":return E(t);case"number":return j();case"boolean":return 4;default:return 8}}function P(t,e){return D+t.length*e}const F=32,D=16;function $(t){return t instanceof ArrayBuffer}function z(t){return"Int8Array"===t?.constructor?.name}function U(t){return"Uint8Array"===t?.constructor?.name}function B(t){return"Uint8ClampedArray"===t?.constructor?.name}function G(t){return"Int16Array"===t?.constructor?.name}function V(t){return"Uint16Array"===t?.constructor?.name}function q(t){return"Int32Array"===t?.constructor?.name}function H(t){return"Uint32Array"===t?.constructor?.name}function W(t){return"Float32Array"===t?.constructor?.name}function Z(t){return"Float64Array"===t?.constructor?.name}function J(t){return!("buffer"in t)}function Y(...t){return t.reduce(((t,e)=>t+(e?J(e)?P(e,j()):e.byteLength+K:0)),0)}const K=145,Q=1024;function X(t){return Z(t)||W(t)||q(t)||G(t)||z(t)}function tt(t){return Z(t)||W(t)}function et(t){return Z(t)?179769e303:W(t)?3402823e32:H(t)?4294967295:V(t)?65535:U(t)||B(t)?255:q(t)?2147483647:G(t)?32767:z(t)?127:256}function it(t,e){let i;if(e)for(i in t)t.hasOwnProperty(i)&&(void 0===t[i]?delete t[i]:t[i]instanceof Object&&it(t[i],!0));else for(i in t)t.hasOwnProperty(i)&&void 0===t[i]&&delete t[i];return t}function nt(t){if(!t||"object"!=typeof t||"function"==typeof t)return t;const e=ut(t);if(null!=e)return e;if(rt(t))return t.clone();if(ot(t))return t.map(nt);if(at(t))return t.clone();const i={};for(const e of Object.getOwnPropertyNames(t))i[e]=nt(t[e]);return i}function st(t){if(!t||"object"!=typeof t||"function"==typeof t||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=ut(t);if(null!=e)return e;if(ot(t)){let e=!0;const i=t.map((t=>{const i=st(t);return null!=t&&null==i&&(e=!1),i}));return e?i:null}if(rt(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(!at(t)){const e=new(Object.getPrototypeOf(t).constructor);for(const i of Object.getOwnPropertyNames(t)){const n=t[i],s=st(n);if(null!=n&&null==s)return null;e[i]=s}return e}return null}function rt(t){return"function"==typeof t.clone}function ot(t){return"function"==typeof t.map&&"function"==typeof t.forEach}function at(t){return"function"==typeof t.notifyChange&&"function"==typeof t.watch}function lt(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function ut(t){if(z(t)||U(t)||B(t)||G(t)||V(t)||q(t)||H(t)||W(t)||Z(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer){return t.slice(0,t.byteLength)}if(t instanceof Map){const e=new Map;for(const[i,n]of t)e.set(i,nt(n));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(nt(i));return e}return null}function ct(t,e){return t===e||"number"==typeof t&&isNaN(t)&&"number"==typeof e&&isNaN(e)||"function"==typeof t?.getTime&&"function"==typeof e?.getTime&&t.getTime()===e.getTime()||!1}function ht(t,e){return t===e||(null==t||"string"==typeof t?t===e:"number"==typeof t?t===e||"number"==typeof e&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&m(t,e):t instanceof Set?e instanceof Set&&ft(t,e):t instanceof Map?e instanceof Map&&pt(t,e):!!lt(t)&&(lt(e)&&dt(t,e)))}function dt(t,e){if(null===t||null===e)return!1;const i=Object.keys(t);if(null===e||Object.keys(e).length!==i.length)return!1;for(const n of i)if(t[n]!==e[n]||!Object.prototype.hasOwnProperty.call(e,n))return!1;return!0}function ft(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function pt(t,e){if(t.size!==e.size)return!1;for(const[i,n]of t){const t=e.get(i);if(t!==n||void 0===t&&!e.has(i))return!1}return!0}function mt(t,e,i=!1){return bt(t,e,i)}function yt(t,e){if(null!=e)return e[t]||wt(t.split("."),!1,e)}function gt(t,e,i){const n=t.split("."),s=n.pop(),r=wt(n,!0,i);r&&s&&(r[s]=e)}function vt(t,e){if(null==t&&null==e)return!1;if(null==t)return!0;if(null==e)return!0;if("object"==typeof t){if(Array.isArray(t)){const i=e;if(t.length!==i.length)return!0;for(let e=0;e<t.length;e++)if(vt(t[e],i[e]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const i in t){if(vt(t[i],e[i]))return!0}return!1}return t!==e}function wt(t,e,i){let n=i;for(const i of t){if(null==n)return;if(!(i in n)){if(!e)return;n[i]={}}n=n[i]}return n}function bt(t,e,i){return e?Object.keys(e).reduce(((t,n)=>{let s=t[n],r=e[n];return s===r?t:void 0===s?(t[n]=nt(r),t):(Array.isArray(r)||Array.isArray(t)?(s=s?Array.isArray(s)?t[n]=s.slice():t[n]=[s]:t[n]=[],r&&(Array.isArray(r)||(r=[r]),i?r.forEach((t=>{s.includes(t)||s.push(t)})):t[n]=r.slice())):r&&"object"==typeof r?t[n]=bt(s,r,i):t.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(t[n]=r),t)}),t||{}):t}const St={apiKey:void 0,applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(mt(St,globalThis.esriConfig,!0),delete St.has),!St.assetsPath){{const t="4.31";St.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}St.defaultAssetsPath=St.assetsPath}const _t=/\{([^}]+)\}/g;function xt(t){return t??""}function Mt(t,e){return e?t.replaceAll(_t,"object"==typeof e?(t,i)=>xt(yt(i,e)):(t,i)=>xt(e(i))):t}function Tt(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,(t=>e?.includes(t)?t:`\\${t}`))}function At(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}let It;function kt(t){It??=new DOMParser;return It.parseFromString(t||"","text/html").body.innerText||""}function Ct(t,e){return new RegExp(`{${e}}`,"ig").test(t)}const Et={info:0,warn:1,error:2,none:3};class jt{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=t.level&&(this.level=t.level),null!=t.writer&&(this.writer=t.writer),this._module=t.module,jt._loggers.set(this.module,this);const e=this.module.lastIndexOf(".");-1!==e&&(this._parent=jt.getLogger(this.module.slice(0,e)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){}static get test(){}static getLogger(t){return t="string"!=typeof t?t.declaredClass:t,jt._loggers.get(t)||new jt({module:t})}_log(t,e,...i){if(!this._matchLevel(t))return;if("always"!==e&&!jt._throttlingDisabled){const n=Rt(i),s=this._loggedMessages[t].get(n);if("once"===e&&null!=s||"oncePerTick"===e&&s&&s>=jt._tickCounter)return;this._loggedMessages[t].set(n,jt._tickCounter),jt._scheduleTickCounterIncrement()}for(const e of St.log.interceptors)if(e(t,this.module,...i))return;this._inheritedWriter()(t,this.module,...i)}_parentWithMember(t,e){let i=this;for(;null!=i;){const e=i[t];if(null!=e)return e;i=i.parent}return e}_inheritedWriter(){return this._parentWithMember("writer",Ot)}_matchLevel(t){const e=St.log.level||"warn";return Et[this._parentWithMember("level",e)]<=Et[t]}static _scheduleTickCounterIncrement(){jt._tickCounterScheduled||(jt._tickCounterScheduled=!0,Promise.resolve().then((()=>{jt._tickCounter++,jt._tickCounterScheduled=!1})))}}function Ot(t,e,...i){console[t](`[${e}]`,...i)}function Rt(...t){const e=(t,e)=>"object"!=typeof e||Array.isArray(e)?e:"[Object]";return At(JSON.stringify(t,e))}jt._loggers=new Map,jt._tickCounter=0,jt._tickCounterScheduled=!1,jt._throttlingDisabled=!1;function Lt(t,e){for(const i of t.values())if(e(i))return!0;return!1}function Nt(t,e,i){const n=t.get(e);if(void 0!==n)return n;const s=i();return t.set(e,s),s}function Pt(t){const e=new Map;return i=>(e.has(i)||e.set(i,t(i)),e.get(i))}const Ft=()=>jt.getLogger("esri.core.accessorSupport.ensureTypes");function Dt(t){return null==t?t:new Date(t)}function $t(t){return null==t?t:!!t}function zt(t){return null==t?t:t.toString()}function Ut(t,e=0){return null==t?t:(t=parseFloat(t),isNaN(t)?e:t)}function Bt(t){return null==t?t:Math.round(parseFloat(t))}function Gt(t){return null}function Vt(t,e){return i=>{let n=t(i);return null!=e.step&&(n=Math.round(n/e.step)*e.step),null!=e.min&&(n=Math.max(e.min,n)),null!=e.max&&(n=Math.min(e.max,n)),n}}function qt(t){return t?.constructor&&void 0!==t.constructor.__accessorMetadata__}function Ht(t,e){return null!=e&&t&&!(e instanceof t)}function Wt(t){return t&&"isCollection"in t}function Zt(t){return t?.Type?"function"==typeof t.Type?t.Type:t.Type.base:null}function Jt(t,e){if(!e?.constructor||!Wt(e.constructor))return Yt(t,e)?e:new t(e);const i=Zt(t.prototype.itemType),n=Zt(e.constructor.prototype.itemType);return i?n?i===n?e:i.prototype.isPrototypeOf(n.prototype)?new t(e):(Yt(t,e),e):new t(e):e}function Yt(t,e){return!!qt(e)&&(Ft().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+Qt(t)+"'"),!0)}function Kt(t,e){return null==e?e:Wt(t)?Jt(t,e):Ht(t,e)?Yt(t,e)?e:new t(e):e}function Qt(t){return t?.prototype?.declaredClass||"unknown"}const Xt=new WeakMap;function te(t){switch(t){case Number:return t=>Ut(t);case ce:return Bt;case Boolean:return $t;case String:return zt;case Date:return Dt;case he:return Gt;default:return Nt(Xt,t,(()=>Kt.bind(null,t)))}}function ee(t,e){const i=te(t);return 1===arguments.length?i:i(e)}function ie(t,e,i){return 1===arguments.length?ie.bind(null,t):e?Array.isArray(e)?e.map((e=>t(e,i))):[t(e,i)]:e}function ne(t,e){return 1===arguments.length?ie((e=>ee(t,e))):ie((e=>ee(t,e)),e)}function se(t,e,i){return 0!==e&&Array.isArray(i)?i.map((i=>se(t,e-1,i))):t(i)}function re(t,e,i){if(2===arguments.length)return i=>re(t,e,i);if(!i)return i;i=se(t,e,i);let n=e,s=i;for(;n>0&&Array.isArray(s);)n--,s=s[0];if(void 0!==s)for(let t=0;t<n;t++)i=[i];return i}function oe(t,e,i){return 2===arguments.length?re((e=>ee(t,e)),e):re((e=>ee(t,e)),e,i)}function ae(t){return!!Array.isArray(t)&&!t.some((e=>{const i=typeof e;return!("string"===i||"number"===i||"function"===i&&t.length>1)}))}function le(t,e){if(2===arguments.length)return le(t).call(null,e);const i=new Set,n=t.filter((t=>"function"!=typeof t)),s=t.filter((t=>"function"==typeof t));for(const e of t)"string"!=typeof e&&"number"!=typeof e||i.add(e);let r=null,o=null;return(t,e)=>{if(null==t)return t;const a=typeof t,l="string"===a||"number"===a;return l&&(i.has(t)||s.some((t=>"string"===a&&t===String||"number"===a&&t===Number)))||"object"===a&&s.some((e=>!Ht(t,e)))?t:(l&&n.length?(r||(r=n.map((t=>"string"==typeof t?`'${t}'`:`${t}`)).join(", ")),Ft().error("Accessor#set",`'${t}' is not a valid value for this property, only the following values are valid: ${r}`)):"object"==typeof t&&s.length?(o||(o=s.map((t=>Qt(t))).join(", ")),Ft().error("Accessor#set",`'${t}' is not a valid value for this property, value must be one of ${o}`)):Ft().error("Accessor#set",`'${t}' is not a valid value for this property`),e&&(e.valid=!1),null)}}function ue(t,e){if(2===arguments.length)return ue(t).call(null,e);const i={},n=[],s=[];for(const e in t.typeMap){const r=t.typeMap[e];i[e]=ee(r),n.push(Qt(r)),s.push(e)}const r=()=>`'${n.join("', '")}'`,o=()=>`'${s.join("', '")}'`,a="string"==typeof t.key?e=>e[t.key]:t.key;return e=>{if(t.base&&!Ht(t.base,e))return e;if(null==e)return e;const n=a(e)||t.defaultKeyValue,s=i[n];if(!s)return Ft().error("Accessor#set",`Invalid property value, value needs to be one of ${r()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!Ht(t.typeMap[n],e))return e;if("string"==typeof t.key&&!qt(e)){const i={};for(const n in e)n!==t.key&&(i[n]=e[n]);return s(i)}return s(e)}}class ce{}class he{}const de={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function fe(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function pe(t){switch(t.type){case"native":return ee(t.value);case"array":return ie(pe(t.value));case"one-of":return me(t);default:return null}}function me(t){let e=null;return(i,n)=>ge(i,t)?i:(null==e&&(e=ye(t)),Ft().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),n&&(n.valid=!1),null)}function ye(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case ce:return"integer";case Date:return"date";case he:return"null";default:return Qt(t.value)}case"array":return`array of ${ye(t.value)}`;case"one-of":{const e=t.values.map((t=>ye(t)));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function ge(t,e){if(null==t)return!0;switch(e.type){case"native":switch(e.value){case Number:case ce:return"number"==typeof t;case Boolean:return"boolean"==typeof t;case String:return"string"==typeof t;case he:return null===t}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some((t=>!ge(t,e.value)));case"one-of":return e.values.some((e=>ge(t,e)))}}const ve={remove:()=>{}};function we(t){return t?{remove(){t&&(t(),t=void 0)}}:ve}function be(t){t.forEach((t=>t?.remove()))}function Se(t){return we((()=>be(t)))}function _e(t){return we((()=>t?.abort()))}function xe(t){return we(null!=t?()=>t.destroy():void 0)}function Me(t){return t.__accessor__??null}function Te(t,e){return null!=t?.metadata?.[e]}function Ae(t,e,i){if(i){return Ie(t,e,{policy:i,path:""})}return Ie(t,e,null)}function Ie(t,e,i){return e?Object.keys(e).reduce(((t,n)=>{const s=n;let r=null,o="merge";if(i&&(r=i.path?`${i.path}.${n}`:n,o=i.policy(r)),"replace"===o)return t[s]=e[s],t;if("replace-arrays"===o&&Array.isArray(t[s]))return t[s]=e[s],t;if(void 0===t[s])return t[s]=nt(e[s]),t;let a=t[s],l=e[s];if(a===l)return t;if(Array.isArray(l)||Array.isArray(t))a=a?Array.isArray(a)?t[s]=a.slice():t[s]=[a]:t[s]=[],l&&(Array.isArray(l)||(l=[l]),l.forEach((t=>{a.includes(t)||a.push(t)})));else if(l&&"object"==typeof l)if(i){const e=i.path;i.path=r,t[s]=Ie(a,l,i),i.path=e}else t[s]=Ie(a,l,null);else t.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(t[s]=l);return t}),t||{}):t}function ke(t){return Array.isArray(t)?t:t.split(".")}function Ce(t){return t.includes(",")?t.split(",").map((t=>t.trim())):[t.trim()]}function Ee(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...Ce(i));return e}return Ce(t)}function je(t,e,i,n){const s=Ee(e);if(1!==s.length){const e=s.map((e=>n(t,e,i)));return Se(e)}return n(t,s[0],i)}function Oe(t,e){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.at(t)}const n=Me(e);return Te(n,i)?n.get(i):e[i]}function Re(t,e,i){if(null==t)return t;const n=Oe(e[i],t);return!n&&i<e.length-1?void 0:i===e.length-1?n:Re(n,e,i+1)}function Le(t,e,i=0){return"string"!=typeof e||e.includes(".")?Re(t,ke(e),i):Oe(e,t)}function Ne(t,e){return Le(t,e)}function Pe(t,e){return void 0!==Le(e,t)}function Fe(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const t in e)e[t]=nt(e[t]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function De(t,e){const i=Fe(t);let n=i[e];return n||(n=i[e]={}),n}function $e(t,e){return Ae(t,e,Ue)}const ze=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Ue(t){return ze.test(t)?"replace":"merge"}function Be(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,((t,i)=>{if(""===i)return"$";const n=yt(i,e);return(n??"").toString()}))}class Ge{constructor(t,e,i=void 0){this.name=t,this.details=i,this.message=(e&&Be(e,i))??""}toString(){return"["+this.name+"]: "+this.message}}class Ve extends Ge{constructor(t,e,i){super(t,e,i)}toJSON(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((t,e)=>{if(e&&"object"==typeof e&&"function"==typeof e.toJSON)return e;try{return nt(e)}catch(t){return"[object]"}})))}}catch(t){throw jt.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new Ve(t.name,t.message,t.details)}}Ve.prototype.type="error";function qe(t,e,i){if(t&&e)if("object"==typeof e)for(const i of Object.getOwnPropertyNames(e))qe(t,i,e[i]);else{if(e.includes(".")){const n=e.split("."),s=n.splice(-1,1)[0];return void qe(Ne(t,n),s,i)}const n=t.__accessor__;null!=n&&He(e,n),t[e]=i}}function He(t,e){if(u("esri-unknown-property-errors")&&!We(t,e))throw new Ve("set:unknown-property",Ze(t,e))}function We(t,e){return null!=e.metadata[t]}function Ze(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}function Je(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const n=Object.getOwnPropertyDescriptor(e,i),s=De(e,i);n&&(n.get||n.set?(s.get=n.get||s.get,s.set=n.set||s.set):"value"in n&&("value"in t&&jt.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),s.value=t.value=n.value)),null!=t.readOnly&&(s.readOnly=t.readOnly);const r=t.aliasOf;if(r){const t="string"==typeof r?r:r.source,e="string"==typeof r?null:!0===r.overridable;let n;s.dependsOn=[t],s.get=function(){let e=Ne(this,t);if("function"==typeof e){n||(n=t.split(".").slice(0,-1).join("."));const i=Ne(this,n);i&&(e=e.bind(i))}return e},s.readOnly||(s.set=e?function(t){this._override(i,t)}:function(e){qe(this,t,e)})}const o=t.type,a=t.types;if(!s.cast){let e;o?e=Ke(o):a&&(e=Array.isArray(a)?ie(ue(a[0])):ue(a)),t.cast=Qe(t.cast,e)}$e(s,t),t.range&&(s.cast=Vt(s.cast,t.range))}}function Ye(t,e,i){const n=De(t,i);n.json||(n.json={});let s=n.json;return void 0!==e&&(s.origins||(s.origins={}),s.origins[e]||(s.origins[e]={}),s=s.origins[e]),s}function Ke(t){let e=0,i=t;if(fe(t))return pe(t);for(;Array.isArray(i)&&1===i.length&&"string"!=typeof i[0]&&"number"!=typeof i[0];)i=i[0],e++;const n=i;if(ae(n))return 0===e?le(n):re(le(n),e);if(1===e)return ne(n);if(e>1)return oe(n,e);const s=t;return s.from?s.from:ee(s)}function Qe(t,e){if(t||e)return t?e?(i,n)=>e(t(i,n),n):t:e}const Xe=Symbol("Accessor-beforeDestroy");var ti;!function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED",t[t.DESTROYED=3]="DESTROYED"}(ti||(ti={}));var ei;!function(t){t[t.Dirty=1]="Dirty",t[t.Overridden=2]="Overridden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"}(ei||(ei={}));class ii{constructor(t){this.accessed=void 0,this._handles=void 0,this._observer=t}destroy(){this.accessed?.clear(),this.clear()}onAccessed(t){null!=this._observer&&t!==this._observer&&(null==this.accessed&&(this.accessed=new Set),this.accessed.add(t))}onTrackingEnd(){null!=this._observer&&(this.clear(),null!=this.accessed&&(null==this._handles&&(this._handles=[]),this.accessed.forEach((t=>{this._handles.push(t.observe(this._observer))})),this.accessed.clear()))}clear(){if(null!=this._handles){for(let t=0;t<this._handles.length;++t)this._handles[t].remove();this._handles.length=0}}}const ni=new ii,si=[];let ri=ni;function oi(t){ri.onAccessed(t)}let ai=!1,li=!1;function ui(t,e,i){if(ai)return hi(t,e,i);let n=null;return di(t),n=e.call(i),fi(),n}function ci(t,e){return ui(ni,t,e)}function hi(t,e,i){const n=ai;ai=!0,di(t);let s=null;try{s=e.call(i)}catch(t){li&&jt.getLogger("esri.core.accessorSupport.tracking").error(t)}return fi(),ai=n,s}function di(t){ri=t,si.push(t)}function fi(){const t=si.length;if(t>1){const e=si.pop();ri=si[t-2],e.onTrackingEnd()}else if(1===t){const t=si.pop();ri=ni,t.onTrackingEnd()}else ri=ni}function pi(t,e){if(e.flags&ei.DepTrackingInitialized)return;e.flags|=ei.DepTrackingInitialized;const i=li;li=!1,e.flags&ei.AutoTracked?hi(e.trackingTarget,e.metadata.get,t):yi(t,e),li=i}const mi=[];function yi(t,e){e.flags&ei.ExplicitlyTracking||(e.flags|=ei.ExplicitlyTracking,hi(e.trackingTarget,(()=>{const i=e.metadata.dependsOn||mi;for(const e of i)if("string"!=typeof e||e.includes(".")){const i=ke(e);for(let e=0,n=t;e<i.length&&null!=n&&"object"==typeof n;++e)n=gi(n,i[e],e!==i.length-1)}else gi(t,e,!1)})),e.flags&=~ei.ExplicitlyTracking)}function gi(t,e,i){const n="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(n,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.at(e)}const s=Me(t);if(s){const e=s.propertiesByName.get(n);e&&(oi(e),pi(t,e))}return i?t[n]:void 0}function vi(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const t in i)if(e[t]){const n=e[t];i[t].forEach((t=>{e[t]=n})),delete e[t]}}}class wi extends Ge{constructor(t,e,i){super(t,e,i)}}wi.prototype.type="warning";function bi(t){return!!t&&t.prototype?.declaredClass&&0===t.prototype.declaredClass.indexOf("esri.core.Collection")}const Si=()=>jt.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function _i(t,e,i){t&&(!i&&!e.read||e.read?.reader||!1===e.read?.enabled||Ei(t)&&gt("read.reader",xi(t),e))}function xi(t){const e=t.ndimArray??0;if(e>1)return Ii(t);if(1===e)return ki(t);if("type"in t&&Ci(t.type)){const e=t.type.prototype?.itemType?.Type,i=ki("function"==typeof e?{type:e}:{types:e});return(e,n,s)=>{const r=i(e,n,s);return r?new t.type(r):r}}return Mi(t)}function Mi(t){return"type"in t?Ti(t.type):Ri(t.types)}function Ti(t){return t.prototype.read?(e,i,n)=>{if(null==e)return e;const s=typeof e;if("object"!==s)return void Si().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${s}'`);const r=new t;return r.read(e,n),r}:t.fromJSON}function Ai(t,e,i,n){return 0!==n&&Array.isArray(e)?e.map((e=>Ai(t,e,i,n-1))):t(e,void 0,i)}function Ii(t){const e=Mi(t),i=Ai.bind(null,e),n=t.ndimArray??0;return(t,e,s)=>{if(null==t)return t;t=i(t,s,n);let r=n,o=t;for(;r>0&&Array.isArray(o);)r--,o=o[0];if(void 0!==o)for(let e=0;e<r;e++)t=[t];return t}}function ki(t){const e=Mi(t);return(t,i,n)=>{if(null==t)return t;if(Array.isArray(t)){const i=[];for(const s of t){const t=e(s,void 0,n);void 0!==t&&i.push(t)}return i}const s=e(t,void 0,n);return void 0!==s?[s]:void 0}}function Ci(t){if(!bi(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&("function"==typeof e.Type?ji(e.Type):Oi(e.Type))}function Ei(t){return"types"in t?Oi(t.types):ji(t.type)}function ji(t){return!Array.isArray(t)&&(!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||Ci(t)))}function Oi(t){for(const e in t.typeMap){if(!ji(t.typeMap[e]))return!1}return!0}function Ri(t){let e=null;const i=t.errorContext??"type",n=t.validate;return(s,r,o)=>{if(null==s)return s;const a=typeof s;if("object"!==a)return void Si().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=Li(t));const l=t.key;if("string"!=typeof l)return;const u=s[l],c=u?e[u]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!c){const t=`Type '${u||"unknown"}' is not supported`;return o?.messages&&s&&o.messages.push(new wi(`${i}:unsupported`,t,{definition:s,context:o})),void Si().error(t)}const h=new c;return h.read(s,o),n?n(h):h}}function Li(t){const e={};for(const i in t.typeMap){const n=t.typeMap[i],s=Fe(n.prototype);if("function"==typeof t.key)continue;const r=s[t.key];if(!r)continue;if(r.json?.type&&Array.isArray(r.json.type)&&1===r.json.type.length&&"string"==typeof r.json.type[0]){e[r.json.type[0]]=n;continue}const o=r.json?.write;if(!o?.writer){e[i]=n;continue}const a=o.target,l="string"==typeof a?a:t.key,u={};o.writer(i,u,l),u[l]&&(e[u[l]]=n)}return e}function Ni(t){if(t.json||(t.json={}),Fi(t.json),Di(t.json),Pi(t.json),t.json.origins)for(const e in t.json.origins)Fi(t.json.origins[e]),Di(t.json.origins[e]),Pi(t.json.origins[e]);return!0}function Pi(t){t.name&&(t.read&&"object"==typeof t.read?void 0===t.read.source&&(t.read.source=t.name):t.read={source:t.name},t.write&&"object"==typeof t.write?void 0===t.write.target&&(t.write.target=t.name):t.write={target:t.name})}function Fi(t){"boolean"==typeof t.read?t.read={enabled:t.read}:"function"==typeof t.read?t.read={enabled:!0,reader:t.read}:t.read&&"object"==typeof t.read&&void 0===t.read.enabled&&(t.read.enabled=!0)}function Di(t){"boolean"==typeof t.write?t.write={enabled:t.write}:"function"==typeof t.write?t.write={enabled:!0,writer:t.write}:t.write&&"object"==typeof t.write&&void 0===t.write.enabled&&(t.write.enabled=!0)}function $i(t,e){if(!e.write||e.write.writer||!1===e.write.enabled&&!e.write.overridePolicy)return;const i=t?.ndimArray??0;t&&(1===i||"type"in t&&bi(t.type))?e.write.writer=Hi:i>1?e.write.writer=Zi(i):e.types?Array.isArray(e.types)?e.write.writer=Bi(e.types[0]):e.write.writer=zi(e.types):e.write.writer=Gi}function zi(t){return(e,i,n,s)=>e?Ui(e,t,s)?Gi(e,i,n,s):void 0:Gi(e,i,n,s)}function Ui(t,e,i){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(i?.messages){const n=e.errorContext??"type",s=`Values of type '${("function"!=typeof e.key?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new Ve(`${n}:unsupported`,s,{definition:t,context:i})),jt.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(s)}return!1}function Bi(t){return(e,i,n,s)=>{if(!e||!Array.isArray(e))return Gi(e,i,n,s);return Gi(e.filter((e=>Ui(e,t,s))),i,n,s)}}function Gi(t,e,i,n){gt(i,Vi(t,n),e)}function Vi(t,e){return t&&"function"==typeof t.write?t.write({},e):t&&"function"==typeof t.toJSON?t.toJSON():"number"==typeof t?qi(t):t}function qi(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function Hi(t,e,i,n){let s;null===t?s=null:t&&"function"==typeof t.map?(s=t.map((t=>Vi(t,n))),"function"==typeof s.toArray&&(s=s.toArray())):s=[Vi(t,n)],gt(i,s,e)}function Wi(t,e,i){return 0!==i&&Array.isArray(t)?t.map((t=>Wi(t,e,i-1))):Vi(t,e)}function Zi(t){return(e,i,n,s)=>{let r;if(null===e)r=null;else{r=Wi(e,s,t);let i=t,n=r;for(;i>0&&Array.isArray(n);)i--,n=n[0];if(void 0!==n)for(let t=0;t<i;t++)r=[r]}gt(n,r,i)}}function Ji(t,e){return Qi(t,"any",e?.origin)}function Yi(t,e){return Qi(t,"read",e?.origin)}function Ki(t,e){return Qi(t,"write",e?.origin)}function Qi(t,e,i){let n=t?.json;if(n?.origins&&i){let t;t="link-chart"===i?n.origins[i]&&("any"===e||e in n.origins[i])?n.origins[i]:n.origins["web-map"]:n.origins[i],t&&("any"===e||e in t)&&(n=t)}return n}function Xi(t){const e=tn(t);if(t.json.origins)for(const i in t.json.origins){const n=t.json.origins[i],s=n.types?en(n):e;_i(s,n,!1),n.types&&!n.write&&t.json.write?.enabled&&(n.write={...t.json.write}),$i(s,n)}_i(e,t.json,!0),$i(e,t.json)}function tn(t){return t.json.types?sn(t.json):t.type?nn(t):sn(t)}function en(t){return t.type?nn(t):sn(t)}function nn(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!ae(i);)i=i[0],e++;return{type:i,ndimArray:e}}function sn(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function rn(t){Ni(t)&&(vi(t),Xi(t))}const on=new Set,an=new Set;function ln(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,cn(e);const i=[],n=[];let s=e.prototype;for(;s;)s.hasOwnProperty("initialize")&&!on.has(s.initialize)&&(on.add(s.initialize),i.push(s.initialize)),s.hasOwnProperty("destroy")&&!an.has(s.destroy)&&(an.add(s.destroy),n.push(s.destroy)),s=Object.getPrototypeOf(s);on.clear(),an.clear();const r=class extends e{constructor(...t){if(super(...t),this.constructor===r&&"function"==typeof this.postscript){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let t=i.length-1;t>=0;t--)i[t].call(this)}}),n.length){let t=!1;const e=this[Xe];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!t){t=!0,e.call(this);for(let t=0;t<n.length;t++)n[t].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};r.__accessorMetadata__=Fe(e.prototype),r.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(r,"name",{value:o,configurable:!0}),r}}function un(t,e){return null==e.get?function(){const e=this.__accessor__,i=e.propertiesByName.get(t);if(void 0===i)return;e.mutable&&oi(i);const n=e.store;return n.has(t)?n.get(t):i.metadata.value}:function(){const e=this.__accessor__,i=e.propertiesByName.get(t);if(void 0!==i)return i.getComputed(e)}}function cn(t){const e=t.prototype,i=Fe(e),n={};for(const t of Object.getOwnPropertyNames(i)){const e=i[t];rn(e),n[t]={enumerable:!0,configurable:!0,get:un(t,e),set(i){const n=this.__accessor__;if(void 0!==n){if(n.mutable)return n.initialized&&e.readOnly?hn("read-only",t):n.lifecycle===ti.CONSTRUCTED&&e.constructOnly?hn("construct-only",t):void n.set(t,i)}else Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:i})}}}Object.defineProperties(t.prototype,n)}const hn=(t,e)=>{jt.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};const dn=new WeakMap;function fn(t,e,i=!1){const n=`🛑 DEPRECATED - ${e}`;if(!i)return void t.warn(n);let s=dn.get(t);s||(s=new Set,dn.set(t,s)),s.has(e)||(s.add(e),t.warn(n))}function pn(t,e,i={}){if(u("esri-deprecation-warnings")){const{moduleName:n}=i;gn(t,`Function: ${(n?n+"::":"")+e+"()"}`,i)}}function mn(t,e,i={}){if(u("esri-deprecation-warnings")){const{moduleName:n}=i;gn(t,`Property: ${(n?n+"::":"")+e}`,i)}}function yn(t,e,i={}){u("esri-deprecation-warnings")&&gn(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...i})}function gn(t,e,i={}){if(u("esri-deprecation-warnings")){const{replacement:n,version:s,see:r,warnOnce:o}=i;let a=e;n&&(a+=`\n\t🛠️ Replacement: ${n}`),s&&(a+=`\n\t⚙️ Version: ${s}`),r&&(a+=`\n\t🔗 See ${r} for more details.`),fn(t,a,o)}}function vn(t){const e=[];return function*(){yield*e;for(const i of t)e.push(i),yield i}}function wn(t,e){for(const i of t)if(null!=i&&e(i))return i}function bn(t){return null!=t&&"function"==typeof t[Symbol.iterator]}class Sn{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach((e=>{t+=e.length})),t}add(t,e){if(bn(t)){const i=this._getOrCreateGroup(e);for(const e of t)Mn(e)&&i.push(e)}else if(Mn(t)){this._getOrCreateGroup(e).push(t)}return this}forEach(t,e){if("function"==typeof t)this._groups.forEach((e=>e.forEach(t)));else{const i=this._getGroup(t);i&&e&&i.forEach(e)}}has(t){return this._groups.has(_n(t))}remove(t){if("string"!=typeof t&&bn(t)){for(const e of t)this.remove(e);return this}return this.has(t)?(xn(this._getGroup(t)),this._groups.delete(_n(t)),this):this}removeAll(){return this._groups.forEach(xn),this._groups.clear(),this}removeReference(t){return this._groups.delete(t),this}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const e=[];return this._groups.set(_n(t),e),e}_getGroup(t){return this._groups.get(_n(t))}}function _n(t){return t||"_default_"}function xn(t){for(const e of t)e instanceof Sn?e.removeAll():e.remove()}function Mn(t){return null!=t&&(!!t.remove||t instanceof Sn)}function Tn(t,e){if(null==t)throw new Error(e??"value is None")}function An(t){return t?.destroy(),null}function In(t){return t?.dispose(),null}function kn(t){return t?.remove(),null}function Cn(t){return t?.abort(),null}function En(t){return t?.release(),null}function jn(t,e,i){return null!=t&&null!=e?null!=i?i(t,e):t.equals(e):t===e}function On(t,e){let i;return t.some(((t,n)=>(i=e(t,n),null!=i))),i??void 0}function Rn(t){return t?.release&&"function"==typeof t.release}function Ln(t){return t?.acquire&&"function"==typeof t.acquire}class Nn{constructor(t,e,i,n=1,s=0){this._ctor=t,this._acquireFunction=e,this._releaseFunction=i,this.allocationSize=n,this._pool=new Array(s),this._initialSize=s;for(let t=0;t<s;t++)this._pool[t]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...t){let e;if(Nn.test.disabled)e=new this._ctor;else{if(0===this._pool.length){const t=this.allocationSize;for(let e=0;e<t;e++)this._pool[e]=new this._ctor}e=this._pool.pop()}return this._acquireFunction?this._acquireFunction(e,...t):Ln(e)&&e.acquire(...t),e}release(t){t&&!Nn.test.disabled&&(this._releaseFunction?this._releaseFunction(t):Rn(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let e=t;e<this._pool.length;++e){const t=this._pool[e];this._dispose(t)}this._pool.length=t}}_dispose(t){t.dispose&&"function"==typeof t.dispose&&t.dispose()}}Nn.test={disabled:!1};class Pn{constructor(t,e){this._observers=t,this._observer=e}remove(){k(this._observers,this._observer)}}class Fn{constructor(){this._observers=null,this.destroyed=!1}observe(t){if(this.destroyed||t.destroyed)return Dn;null==this._observers&&(this._observers=[]);const e=this._observers;let i=!1,n=!1;const s=e.length;for(let r=0;r<s;++r){const s=e[r];if(s.destroyed)n=!0;else if(s===t){i=!0;break}}return i||(e.push(t),n&&this._removeDestroyedObservers()),new Pn(e,t)}_removeDestroyedObservers(){const t=this._observers;if(!t||0===t.length)return;const e=t.length;let i=0;for(let n=0;n<e;++n){for(;n+i<e;){if(!t[n+i].destroyed)break;++i}if(i>0){if(!(n+i<e))break;t[n]=t[n+i]}}t.length=e-i}destroy(){if(this.destroyed)return;this.destroyed=!0;const t=this._observers;if(null!=t){for(const e of t)e.onCommitted();this._observers=null}}}const Dn=we();var $n;!function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"}($n||($n={}));const zn=$n.USER+1;function Un(t){switch(t){case"defaults":return $n.DEFAULTS;case"service":return $n.SERVICE;case"portal-item":return $n.PORTAL_ITEM;case"web-scene":return $n.WEB_SCENE;case"web-map":return $n.WEB_MAP;case"link-chart":return $n.LINK_CHART;case"user":return $n.USER;default:return null}}function Bn(t){switch(t){case $n.DEFAULTS:return"defaults";case $n.SERVICE:return"service";case $n.PORTAL_ITEM:return"portal-item";case $n.WEB_SCENE:return"web-scene";case $n.WEB_MAP:return"web-map";case $n.LINK_CHART:return"link-chart";case $n.USER:return"user"}}function Gn(t){return Bn(t)}class Vn extends Fn{constructor(t,e){super(),this.propertyName=t,this.metadata=e,this.trackingTarget=new ii(this),this.flags=0,this.flags=ei.Dirty|(e.nonNullable?ei.NonNullable:0)|(e.hasOwnProperty("value")?ei.HasDefaultValue:0)|(void 0===e.get?ei.DepTrackingInitialized:0)|(void 0===e.dependsOn?ei.AutoTracked:0)}destroy(){this.flags&ei.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(t){t.mutable&&oi(this);const e=t.store,i=this.propertyName,n=this.flags,s=e.get(i);if(n&ei.Computing)return s;if(~n&ei.Dirty&&e.has(i))return s;this.flags|=ei.Computing;const r=t.host;let o;n&ei.AutoTracked?o=ui(this.trackingTarget,this.metadata.get,r):(yi(r,this),o=this.metadata.get.call(r)),this.flags|=ei.DepTrackingInitialized,e.set(i,o,$n.COMPUTED);const a=e.get(i);return a===s?this.flags&=~ei.Dirty:ci(this.commit,this),this.flags&=~ei.Computing,a}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~ei.Dirty,this.onCommitted()}onInvalidated(){~this.flags&ei.Overridden&&(this.flags|=ei.Dirty);const t=this._observers;if(t&&t.length>0)for(const e of t)e.onInvalidated()}onCommitted(){const t=this._observers;if(t&&t.length>0){const e=t.slice();for(const t of e)t.onCommitted()}}}class qn{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const e=new qn;return this._values.forEach(((i,n)=>{t&&t.has(n)||e.set(n,nt(i))})),e}get(t){return this._values.get(t)}originOf(){return $n.USER}keys(){return[...this._values.keys()]}set(t,e){this._values.set(t,e)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}}function Hn(t,e,i){return void 0!==t}function Wn(t,e,i,n){return void 0!==t&&(!(null==i&&t.flags&ei.NonNullable)||!1)}class Zn{constructor(t){this.host=t,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=ti.INITIALIZING,this.store=new qn,this.mutable=!0,this._origin=$n.USER;const e=this.host.constructor.__accessorMetadata__;for(const t in e){const i=new Vn(t,e[t]);this.propertiesByName.set(t,i)}this.metadata=e}initialize(){this.lifecycle=ti.CONSTRUCTING}constructed(){this.lifecycle=ti.CONSTRUCTED}destroy(){this.lifecycle=ti.DESTROYED,this.propertiesByName.forEach((t=>t.destroy()))}get initialized(){return this.lifecycle!==ti.INITIALIZING}get(t){const e=this.propertiesByName.get(t);if(e.metadata.get)return e.getComputed(this);this.mutable&&oi(e);const i=this.store;return i.has(t)?i.get(t):e.metadata.value}originOf(t){const e=this.store.originOf(t);if(void 0===e){const e=this.propertiesByName.get(t);if(void 0!==e&&e.flags&ei.HasDefaultValue)return"defaults"}return Bn(e)}has(t){return this.propertiesByName.has(t)&&this.store.has(t)}keys(){return[...this.propertiesByName.keys()]}internalGet(t){const e=this.propertiesByName.get(t);if(Hn(e))return this.store.has(t)?this.store.get(t):e.metadata.value}internalSet(t,e){const i=this.propertiesByName.get(t);Hn(i)&&this._internalSet(i,e)}getDependsInfo(t,e,i){const n=this.propertiesByName.get(e);if(!Hn(n))return"";const s=new ii,r=ui(s,(()=>n.metadata.get?.call(t)));let o=`${i}${t.declaredClass.split(".").pop()}.${e}: ${r}\n`;const a=s.accessed??new Set;if(0===a.size)return o;i+="  ";for(const t of a){if(!(t instanceof Vn))continue;o+=`${i}${t.propertyName}: undefined\n`}return o}setAtOrigin(t,e,i){const n=this.propertiesByName.get(t);if(Hn(n))return this._setAtOrigin(n,e,i)}isOverridden(t){const e=this.propertiesByName.get(t);return void 0!==e&&!!(e.flags&ei.Overridden)}clearOverride(t){const e=this.propertiesByName.get(t);e&&e.flags&ei.Overridden&&(e.flags&=~ei.Overridden,e.notifyChange())}override(t,e){const i=this.propertiesByName.get(t);if(!Wn(i,t,e))return;const n=i.metadata.cast;if(n){const t=this._cast(n,e),{valid:i,value:s}=t;if(Yn.release(t),!i)return;e=s}i.flags|=ei.Overridden,this._internalSet(i,e)}set(t,e){const i=this.propertiesByName.get(t);if(!Wn(i,t,e))return;const n=i.metadata.cast;if(n){const t=this._cast(n,e),{valid:i,value:s}=t;if(Yn.release(t),!i)return;e=s}const s=i.metadata.set;s?s.call(this.host,e):this._internalSet(i,e)}setDefaultOrigin(t){this._origin=Un(t)}getDefaultOrigin(){return Bn(this._origin)}notifyChange(t){const e=this.propertiesByName.get(t);void 0!==e&&e.notifyChange()}invalidate(t){const e=this.propertiesByName.get(t);void 0!==e&&e.invalidate()}commit(t){const e=this.propertiesByName.get(t);void 0!==e&&e.commit()}_internalSet(t,e){const i=this.lifecycle!==ti.INITIALIZING?this._origin:$n.DEFAULTS;this._setAtOrigin(t,e,i)}_setAtOrigin(t,e,i){const n=this.store,s=t.propertyName;n.has(s,i)&&ct(e,n.get(s))&&~t.flags&ei.Overridden&&i===n.originOf(s)||(t.invalidate(),n.set(s,e,i),t.commit(),pi(this.host,t))}_cast(t,e){const i=Yn.acquire();return i.valid=!0,i.value=e,t&&(i.value=t.call(this.host,e,i)),i}}class Jn{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}}const Yn=new Nn(Jn);let Kn;function Qn(){return Kn}var Xn;!function(t){t[t.Ignore=0]="Ignore",t[t.Destroy=1]="Destroy",t[t.ThrowError=2]="ThrowError"}(Xn||(Xn={}));function ts(t){t.length=0}class es{constructor(t=50,e=50){this._pool=new Nn(Array,void 0,ts,e,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return is.acquire()}static release(t){return is.release(t)}static prune(){is.prune()}}const is=new es(100);class ns extends Nn{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const e=super.acquire(...t);return this._set.delete(e),e}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}}const ss=[];function rs(t){ss.push(t),1===ss.length&&queueMicrotask((()=>{const t=ss.slice();ss.length=0;for(const e of t)e()}))}class os{constructor(t,e=30){this.name=t,this._counter=0,this._samples=new Array(e)}push(t){null!=t&&(this._samples[++this._counter%this._samples.length]=t)}set(t){null!=t&&(this._samples[this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort(((t,e)=>t-e))[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce(((t,e)=>t+e),0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}}var as;!function(t){const e=(t,e,i,n)=>{let s=e,r=e;const o=i>>>1,a=t[s-1];for(;r<=o;){r=s<<1,r<i&&n(t[r-1],t[r])<0&&++r;const e=t[r-1];if(n(e,a)<=0)break;t[s-1]=e,s=r}t[s-1]=a},i=(t,e)=>t<e?-1:t>e?1:0;function n(t,n,s,r){void 0===n&&(n=0),void 0===s&&(s=t.length),void 0===r&&(r=i);for(let i=s>>>1;i>n;i--)e(t,i,s,r);const o=n+1;for(let i=s-1;i>n;i--){const s=t[n];t[n]=t[i],t[i]=s,e(t,o,i,r)}}function*s(t,n,s,r){void 0===n&&(n=0),void 0===s&&(s=t.length),void 0===r&&(r=i);for(let i=s>>>1;i>n;i--)e(t,i,s,r),yield;const o=n+1;for(let i=s-1;i>n;i--){const s=t[n];t[n]=t[i],t[i]=s,e(t,o,i,r),yield}}t.sort=n,t.iterableSort=s}(as||(as={}));const ls=as;const us=1.5,cs=1.1;class hs{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new v,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),void 0!==t.deallocator&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>ds(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const e=new Array;for(let i=0;i<this._length;i++){const n=this.data[i];t(n)&&e.push(n)}return e}at(t){if((t=Math.trunc(t)||0)<0&&(t+=this._length),!(t<0||t>=this._length))return this.data[t]}includes(t,e){const i=this.data.indexOf(t,e);return-1!==i&&i<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let e=t;e<this._length;++e)this.data[e]=this._deallocator(this.data[e]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,e=t.length){for(let i=0;i<e;i++)this.data[this._length++]=t[i]}fill(t,e){for(let i=0;i<e;i++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,ds(this)}pop(){if(0===this.length)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const e=b(this.data,t,this.length,this._hint);if(-1!==e)return this.data.splice(e,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(b(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,e=t.length,i){this.length=x(this.data,t,this.length,e,this._hint,i),this._shrink()}front(){if(0!==this.length)return this.data[0]}back(){if(0!==this.length)return this.data[this.length-1]}swapElements(t,e){if(t>=this.length||e>=this.length||t===e)return;const i=this.data[t];this.data[t]=this.data[e],this.data[e]=i}sort(t){ls.sort(this.data,0,this.length,t)}iterableSort(t){return ls.iterableSort(this.data,0,this.length,t)}some(t,e){for(let i=0;i<this.length;++i)if(t.call(e,this.data[i],i,this.data))return!0;return!1}find(t,e){const{data:i,length:n}=this;for(let s=0;s<n;++s)if(t.call(e,i[s]))return i[s]}filterInPlace(t,e){let i=0;for(let n=0;n<this._length;++n){const s=this.data[n];t.call(e,s,n,this.data)&&(this.data[n]=this.data[i],this.data[i]=s,i++)}if(this._deallocator)for(let t=i;t<this._length;t++)this.data[t]=this._deallocator(this.data[t]);return this._length=i,this._shrink(),this}forAll(t,e){const{data:i,length:n}=this;for(let s=0;s<n;++s)t.call(e,i[s],s,i)}forEach(t,e){this.data.slice(0,this.length).forEach(t,e)}map(t,e){const i=new Array(this.length);for(let n=0;n<this.length;++n)i[n]=t.call(e,this.data[n],n,this.data);return i}reduce(t,e){let i=e;for(let e=0;e<this.length;++e)i=t(i,this.data[e],e,this.data);return i}has(t){const e=this.length,i=this.data;for(let n=0;n<e;++n)if(i[n]===t)return!0;return!1}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.data[t]}}function ds(t){t.data.length>us*t.length&&(t.data.length=Math.floor(t.length*cs))}function fs(t){return{setTimeout:(e,i)=>{const n=t.setTimeout(e,i);return we((()=>t.clearTimeout(n)))}}}const ps=fs(globalThis);function ms(t){return ys(t)||gs(t)}function ys(t){return null!=t&&"object"==typeof t&&"on"in t&&"function"==typeof t.on}function gs(t){return null!=t&&"object"==typeof t&&"addEventListener"in t&&"function"==typeof t.addEventListener}function vs(t,e,i){if(!ms(t))throw new TypeError("target is not a Evented or EventTarget object");return gs(t)?ws(t,e,i):t.on(e,i)}function ws(t,e,i,n){if(Array.isArray(e)){const s=e.slice();for(const e of s)t.addEventListener(e,i,n);return we((()=>{for(const e of s)t.removeEventListener(e,i,n)}))}return t.addEventListener(e,i,n),we((()=>t.removeEventListener(e,i,n)))}function bs(t,e,i){if(!ms(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const n=vs(t,e,(e=>{n.remove(),i.call(t,e)}));return n}function Ss(t="Aborted"){return new Ve("AbortError",t)}function _s(t,e="Aborted"){if(Ms(t))throw Ss(e)}function xs(t){return t instanceof AbortSignal?t:t?.signal??void 0}function Ms(t){const e=xs(t);return null!=e&&e.aborted}function Ts(t){if(Es(t))throw t}function As(t){if(!Es(t))throw t}function Is(t,e){const i=xs(t);if(null!=i){if(!i.aborted)return bs(i,"abort",(()=>e()));e()}}function ks(t,e){const i=xs(t);if(null!=i)return _s(i),bs(i,"abort",(()=>e(Ss())))}function Cs(t,e){return null==xs(e)?t:new Promise(((i,n)=>{let s=Is(e,(()=>n(Ss())));const r=()=>{s=kn(s)};t.then(r,r),t.then(i,n)}))}function Es(t){return"AbortError"===t?.name}async function js(t){try{return await t}catch(t){if(!Es(t))throw t;return}}async function Os(t){if(!t)return;if("function"!=typeof t.forEach){const e=Object.keys(t),i=e.map((e=>t[e])),n=await Os(i),s={};return e.map(((t,e)=>s[t]=n[e])),s}const e=t;return Promise.allSettled(e).then((t=>Array.from(e,((e,i)=>{const n=t[i];return"fulfilled"===n.status?{promise:e,value:n.value}:{promise:e,error:n.reason}}))))}async function Rs(t){return(await Promise.allSettled(t)).filter((t=>"fulfilled"===t.status)).map((t=>t.value))}async function Ls(t){return(await Promise.allSettled(t)).filter((t=>"rejected"===t.status)).map((t=>t.reason))}function Ns(t,e=void 0,i){const n=new AbortController;return Is(i,(()=>n.abort())),new Promise(((i,s)=>{let r=setTimeout((()=>{r=0,i(e)}),t);Is(n,(()=>{r&&(clearTimeout(r),s(Ss()))}))}))}function Ps(t,e){const i=new AbortController,n=setTimeout((()=>i.abort()),e);return Is(t,(()=>{i.abort(),clearTimeout(n)})),{...t,signal:i.signal}}function Fs(t){return t&&"function"==typeof t.then}function Ds(t){return Fs(t)?t:Promise.resolve(t)}function $s(t,e=-1){let i,n,s,r,o=null;const a=(...l)=>{if(i){n=l,r&&r.reject(Ss()),r=zs();const t=r.promise;if(o){const t=o;o=null,t.abort()}return t}if(s=r||zs(),r=null,e>0){const n=new AbortController;i=Ds(t(...l,n.signal));const s=i;Ns(e).then((()=>{i===s&&(r?n.abort():o=n)}))}else i=1,i=Ds(t(...l));const u=()=>{const t=n;n=s=i=o=null,null!=t&&a(...t)},c=i,h=s;return c.then(u,u),c.then(h.resolve,h.reject),h.promise};return a}function zs(){let t,e;const i=new Promise(((i,n)=>{t=i,e=n})),n=e=>{t(e)};return n.resolve=e=>t(e),n.reject=t=>e(t),n.timeout=(t,e)=>ps.setTimeout((()=>n.reject(e)),t),n.promise=i,n}async function Us(t){await Promise.resolve(),_s(t)}function Bs(t){return t}function Gs(t){return Bs(1e3*t)}function Vs(t){return t}class qs{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}}class Hs{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}}let Ws=0;const Zs={time:Bs(0),deltaTime:Bs(0),elapsedFrameTime:Bs(0),frameDuration:Bs(0)},Js=["prepare","preRender","render","postRender","update","finish"],Ys=[],Ks=new hs;class Qs{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}}function Xs(){null!=nr&&(cancelAnimationFrame(nr),nr=requestAnimationFrame(rr))}const tr={frameTasks:Ks,willDispatch:!1,clearFrameTasks:sr,dispatch:ur,executeFrameTasks:or,reschedule:Xs};function er(t){const e=new Hs(t);return Ys.push(e),tr.willDispatch||(tr.willDispatch=!0,rs(ur)),e}function ir(t){const e=new qs(t);return Ks.push(e),null==nr&&(Ws=performance.now(),nr=requestAnimationFrame(rr)),new Qs(e)}let nr=null;function sr(t=!1){Ks.forAll((t=>{t.removed=!0})),t&&lr()}function rr(){const t=performance.now();nr=null,nr=Ks.length>0?requestAnimationFrame(rr):null,tr.executeFrameTasks(t)}function or(t){const e=Bs(t-Ws);Ws=t;const i=1e3/60,n=Math.max(0,e-i);Zs.time=t,Zs.frameDuration=Bs(i-n);for(let i=0;i<Js.length;i++){const n=performance.now(),s=Js[i];Ks.forAll((n=>{if(n.paused||n.removed)return;0===i&&n.ticks++;n.phases[s]&&(Zs.elapsedFrameTime=Bs(performance.now()-t),Zs.deltaTime=0===n.ticks?Bs(0):e,n.phases[s]?.call(n,Zs))})),fr[i].push(performance.now()-n)}lr(),pr.push(performance.now()-t)}const ar=new hs;function lr(){Ks.forAll((t=>{t.removed&&ar.push(t)})),Ks.removeUnorderedMany(ar.data,ar.length),ar.clear()}function ur(){for(;Ys.length;){const t=Ys.shift();t.isActive&&t.callback()}tr.willDispatch=!1}function cr(t=1,e){const i=zs(),n=()=>{Ms(e)?i.reject(Ss()):0===t?i():(--t,rs((()=>n())))};return n(),i.promise}function hr(t){return cr(1,t)}async function dr(t){await hr(t),await new Promise((e=>requestAnimationFrame((()=>{t?.aborted||e()}))))}const fr=Js.map((t=>new os(t))),pr=new os("total");function mr(t,e){for(const i of t.values())if(e(i))return!0;return!1}function yr(t,e){if(!e)return t;for(const i of e)null!=i&&t.add(i);return t}function gr(t,e){return null!=e&&t.add(e),t}function vr(t,e){const i=new Set;return yr(i,t),yr(i,e),i}function wr(t,e){const i=new Set;for(const n of e)t.has(n)&&i.add(n);return i}function br(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const i of t)if(!e.has(i))return!1;return!0}function Sr(t,e){if(null==t&&null==e)return!0;if(null==t||null==e||t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function _r(t,e){const i=new Set(t);for(const t of e)i.delete(t);return i}function xr(t,e){return _r(vr(t,e),wr(t,e))}let Mr=0;function Tr(){return++Mr}class Ar extends ii{constructor(t){super(new Ir(t)),this._observer&&kr.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&kr.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}}class Ir{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(1===t)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=Cr}}const kr=new FinalizationRegistry((t=>{t.deref()?.destroy()}));function Cr(){}let Er=!1;const jr=[];function Or(t,e){let i=new Ar(r),n=null,s=!1;function r(){if(!i||s)return;if(Er)return void Nr(r);const o=n;i.clear(),Er=!0,s=!0,n=ui(i,t),s=!1,Er=!1,e(n,o),Pr()}function o(){i&&(i.destroy(),i=null,n=null)}return s=!0,n=ui(i,t),s=!1,we(o)}function Rr(t,e){let i=new Ar(s),n=null;function s(){e(n,o)}function r(){i&&(i.destroy(),i=null),n=null}function o(){return i?(i.clear(),n=ui(i,t),n):null}return o(),we(r)}function Lr(t,e){let i=!1,n=!1;const s=!!e?.sync;let r=new Ar((()=>{i||n||(n=!0,s?o():queueMicrotask(o))}));function o(){n=!1,r&&!i&&(Er?Nr(o):(r.clear(),Er=!0,i=!0,ui(r,t),i=!1,Er=!1,Pr()))}function a(){r&&(r.destroy(),r=null)}return i=!0,ui(r,t),i=!1,we(a)}function Nr(t){jr.includes(t)||jr.unshift(t)}function Pr(){for(;jr.length;)jr.pop()()}var Fr;!function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"}(Fr||(Fr={}));class Dr{constructor(){this.uid=Tr(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,e,i,n,s){return this.pool.acquire(Fr.Untracked,t,e,i,n,s,ct)}static acquireTracked(t,e,i,n){return this.pool.acquire(Fr.Tracked,t,e,i,null,null,n)}notify(t,e){this.type===Fr.Untracked?this.callback.call(this.target,t,e,this.path,this.target):this.callback.call(null,t,e,void 0,void 0)}acquire(t,e,i,n,s,r,o){this.uid=Tr(),this.removed=!1,this.type=t,this.oldValue=e,this.callback=i,this.getValue=n,this.target=s,this.path=r,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=Tr(),this.removed=!0}}Dr.pool=new ns(Dr);const $r=new es,zr=new Set;let Ur;function Br(t){zr.delete(t),zr.add(t),Ur||(Ur=er(qr))}function Gr(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function Vr(t){for(const e of zr.values())e.target===t&&(e.removed=!0)}function qr(){let t=10;for(;Ur&&t--;){Ur=null;const t=Hr(),e=$r.acquire();for(const i of t){const t=i.uid;Gr(i),t===i.uid&&i.removed&&e.push(i)}for(const t of zr)t.removed&&(e.push(t),zr.delete(t));for(const t of e)Dr.pool.release(t);$r.release(e),$r.release(t),Wr.forEach((t=>t()))}}function Hr(){const t=$r.acquire();t.length=zr.size;let e=0;for(const i of zr)t[e]=i,++e;return zr.clear(),t}const Wr=new Set;function Zr(t){return Wr.add(t),we((()=>Wr.delete(t)))}function Jr(t,e,i){let n=je(t,e,i,((t,e,i)=>{let s,r,o=Rr((()=>Le(t,e)),((o,a)=>{t.__accessor__?.lifecycle===ti.DESTROYED||s&&s.uid!==r?n.remove():(s||(s=Dr.acquireUntracked(o,i,a,t,e),r=s.uid),Br(s))}));return we((()=>{o.remove(),s&&(s.uid!==r||s.removed||(s.removed=!0,Br(s)),s=null),n=o=null}))}));return n}function Yr(t,e,i){const n=je(t,e,i,((t,e,i)=>{let s=!1;return Or((()=>Le(t,e)),((r,o)=>{t.__accessor__.lifecycle!==ti.DESTROYED?s||(s=!0,ct(o,r)||i.call(t,r,o,e,t),s=!1):n.remove()}))}));return n}function Kr(t,e,i,n=!1){return t.__accessor__&&t.__accessor__.lifecycle!==ti.DESTROYED?n?Yr(t,e,i):Jr(t,e,i):we()}function Qr(t,e,i){let n,s,r=Rr(t,((t,o)=>{n&&n.uid!==s?r.remove():(n||(n=Dr.acquireTracked(t,e,o,i),s=n.uid),Br(n))}));return we((()=>{r.remove(),n&&(n.uid!==s||n.removed||(n.removed=!0,Br(n)),n=null),r=null}))}function Xr(t,e,i){let n=!1;return Or(t,((t,s)=>{n||(n=!0,i(s,t)||e(t,s),n=!1)}))}function to(t,e,i=!1,n=ht){return i?Xr(t,e,n):Qr(t,e,n)}function eo(t){return mr(zr,(e=>e.oldValue===t))}var io,no;function so(t){if(null==t)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const ro=Symbol("Accessor-Handles"),oo=Symbol("Accessor-Initialized");class ao{static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:e,declaredClass:i,constructor:n}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const s=this;class r extends s{constructor(...t){super(...t),this.inherited=null,n&&n.apply(this,t)}}Fe(r.prototype);for(const e in t){const i=t[e];r.prototype[e]="function"==typeof i?function(...t){const n=this.inherited;let r;this.inherited=function(...t){if(s.prototype[e])return s.prototype[e].apply(this,t)};try{r=i.apply(this,t)}catch(t){throw this.inherited=n,t}return this.inherited=n,r}:t[e]}for(const t in e){const i=so(e[t]);Je(i)(r.prototype,t)}return ln(i)(r)}static freeze(t){return t instanceof ao?t.__accessor__.mutable=!1:Object.freeze(t),t}static isFrozen(t){return t instanceof ao?!t.__accessor__.mutable:Object.isFrozen(t)}constructor(...t){if(this[io]=null,this[no]=!1,this.constructor===ao)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const e=new Zn(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:e}),t.length>0&&(e.ctorArgs=this.normalizeCtorArgs?.apply(this,t)??t[0]),Qn()?.onInstanceConstruct(this)}postscript(){const t=this.__accessor__,e=t.ctorArgs;t.initialize(),e&&(this.set(e),t.ctorArgs=null),t.constructed(),this.initialize(),this[oo]=!0}initialize(){}[Xe](){this[ro]=An(this[ro])}destroy(){this.destroyed||(Vr(this),this.__accessor__.destroy(),Qn()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[oo]}get destroyed(){return this.__accessor__?.lifecycle===ti.DESTROYED||!1}commitProperty(t){Ne(this,t)}get(t){return pn(jt.getLogger(this),"`Accessor.get` is deprecated in favor of using optional chaining",{version:"4.28",see:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining"}),Ne(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,e){return qe(this,t,e),this}watch(t,e,i){return Kr(this,t,e,i)}addHandles(t,e){if(this.destroyed){const e=Array.isArray(t)?t:[t];for(const t of e)t.remove();return}(this[ro]??=new Sn).add(t,e)}removeHandles(t){this[ro]?.remove(t)}removeAllHandles(){this[ro]?.removeAll()}removeHandlesReference(t){this[ro]?.removeReference(t)}hasHandles(t){return!0===this[ro]?.has(t)}_override(t,e){void 0===e?this.__accessor__.clearOverride(t):this.__accessor__.override(t,e)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,e){null==e?this.__accessor__.clearOverride(t):this.__accessor__.override(t,e)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,e){return this.__accessor__.internalSet(t,e),this}}io=ro,no=oo;class lo{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const e=new lo;return this._values.forEach(((i,n)=>{t&&t.has(n)||e.set(n,nt(i.value),i.origin)})),e}get(t,e){e=this._normalizeOrigin(e);const i=this._values.get(t);return null==e||i?.origin===e?i?.value:void 0}originOf(t){return this._values.get(t)?.origin??$n.USER}keys(t){t=this._normalizeOrigin(t);const e=[...this._values.keys()];return null==t?e:e.filter((e=>this._values.get(e)?.origin===t))}set(t,e,i){if((i=this._normalizeOrigin(i))===$n.DEFAULTS){const e=this._values.get(t);if(null!=e?.origin&&e.origin>i)return}this._values.set(t,new uo(e,i))}delete(t,e){null!=(e=this._normalizeOrigin(e))&&this._values.get(t)?.origin!==e||this._values.delete(t)}has(t,e){return null!=(e=this._normalizeOrigin(e))?this._values.get(t)?.origin===e:this._values.has(t)}forEach(t){this._values.forEach((({value:e},i)=>t(e,i)))}_normalizeOrigin(t){if(null!=t)return t===$n.DEFAULTS?t:$n.USER}}class uo{constructor(t,e){this.value=t,this.origin=e}}function co(t,e,i){e.keys().forEach((t=>{i.set(t,e.get(t),$n.DEFAULTS)}));const n=t.metadata;Object.keys(n).forEach((e=>{t.internalGet(e)&&i.set(e,t.internalGet(e),$n.DEFAULTS)}))}function ho(t,e,i){if(!t?.read||!1===t.read.enabled||!t.read.source)return!1;const n=t.read.source;if("string"==typeof n){if(n===e)return!0;if(n.includes(".")&&0===n.indexOf(e)&&Pe(n,i))return!0}else for(const t of n){if(t===e)return!0;if(t.includes(".")&&0===t.indexOf(e)&&Pe(t,i))return!0}return!1}function fo(t){return t&&(!t.read||!1!==t.read.enabled&&!t.read.source)}function po(t,e,i,n,s){let r=Yi(e[i],s);fo(r)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))r=Yi(e[o],s),ho(r,i,n)&&(t[o]=!0)}function mo(t,e,i,n){const s=i.metadata,r=Ji(s[e],n),o=r?.default;if(void 0===o)return;const a="function"==typeof o?o.call(t,e,n):o;void 0!==a&&i.set(e,a)}const yo={origin:"service"};function go(t,e,i=yo){if(!e||"object"!=typeof e)return;const n=Me(t),s=n.metadata,r={};for(const t of Object.getOwnPropertyNames(e))po(r,s,t,e,i);n.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(r)){const r=Yi(s[o],i).read,a=r?.source;let l;l=a&&"string"==typeof a?Le(e,a):e[o],r?.reader&&(l=r.reader.call(t,l,e,i)),void 0!==l&&n.set(o,l)}if(!i||!i.ignoreDefaults){n.setDefaultOrigin("defaults");for(const e of Object.getOwnPropertyNames(s))r[e]||mo(t,e,n,i)}n.setDefaultOrigin("user")}function vo(t,e,i,n=yo){const s={...n,messages:[]};i(s),s.messages?.forEach((e=>{"warning"!==e.type||t.loaded?n?.messages&&n.messages.push(e):t.loadWarnings.push(e)}))}function wo(t,e,i,n,s){const r={};return e.write?.writer?.call(t,n,r,i,s),r}function bo(t,e,i,n,s,r){if(!n?.write)return!1;const o=Ne(t,i);if(!s&&n.write.overridePolicy){const e=n.write.overridePolicy.call(t,o,i,r??void 0);void 0!==e&&(s=e)}if(s||(s=n.write),!s||!1===s.enabled)return!1;if(s.layerContainerTypes&&r?.layerContainerType&&!s.layerContainerTypes.includes(r.layerContainerType))return!1;if((null===o&&!s.allowNull&&!s.writerEnsuresNonNull||void 0===o)&&s.isRequired){const e=new Ve("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return e&&r?.messages?r.messages.push(e):e&&!r&&jt.getLogger("esri.core.accessorSupport.write").error(e.name,e.message),!1}if(void 0===o)return!1;if(null===o&&!s.allowNull&&!s.writerEnsuresNonNull)return!1;if(!s.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===$n.DEFAULTS)&&So(t,i,r,n,o))return!1;if(!s.ignoreOrigin&&r?.origin&&e.store.multipleOriginsSupported){if(e.store.originOf(i)<Un(r.origin))return!1}return!0}function So(t,e,i,n,s){const r=n.default;if(void 0===r)return!1;if(null!=n.defaultEquals)return n.defaultEquals(s);if("function"==typeof r){if(Array.isArray(s)){const n=r.call(t,e,i??void 0);return m(n,s)}return!1}return r===s}function _o(t,e,i,n){const s=Me(t),r=s.metadata,o=Ki(r[e],n);return!!o&&bo(t,s,e,o,i,n)}function xo(t,e,i){if(t&&"function"==typeof t.toJSON&&(!t.toJSON.isDefaultToJSON||!t.write))return Ae(e,t.toJSON(i));const n=Me(t),s=n.metadata;for(const r in s){const o=Ki(s[r],i);if(!bo(t,n,r,o,void 0,i))continue;const a=Ne(t,r),l=wo(t,o,o.write&&"string"==typeof o.write.target?o.write.target:r,a,i);Object.keys(l).length>0&&(e=Ae(e,l),i?.resources?.pendingOperations?.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then((()=>Ae(e,l,(()=>"replace-arrays"))))),i?.writtenProperties&&i.writtenProperties.push({target:t,propName:r,oldOrigin:Gn(n.store.originOf(r)),newOrigin:i.origin}))}return e}const Mo=t=>{let e=class extends t{constructor(...t){super(...t);const e=Me(this),i=e.store,n=new lo;e.store=n,co(e,i,n)}read(t,e){go(this,t,e)}write(t,e){return xo(this,t??{},e)}toJSON(t){return this.write({},t)}static fromJSON(t,e){return To.call(this,t,e)}};return e=r([ln("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function To(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}function Ao(t){return t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}let Io=class extends(Mo(ao)){};Io=r([ln("esri.core.JSONSupport")],Io);function ko(t,e,i){let n,s;return void 0===e||Array.isArray(e)?(s=t,i=e,n=[void 0]):(s=e,n=Array.isArray(t)?t:[t]),(t,e)=>{const r=t.constructor.prototype;n.forEach((n=>{const o=Ye(t,n,s);o.read&&"object"==typeof o.read||(o.read={}),o.read.reader=r[e],i&&(o.read.source=(o.read.source||[]).concat(i))}))}}class Co{constructor(t,e={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=t,this._options=e,this.apiValues=[],this.jsonValues=[],this._apiToJSON=Eo(t),this.apiValues=jo(this._apiToJSON),this.jsonValues=jo(this._jsonToAPI),this.read=t=>this.fromJSON(t),this.write=(t,e,i)=>{const n=this.toJSON(t);void 0!==n&&gt(i,n,e)},this.write.isJSONMapWriter=!0}toJSON(t){if(null==t)return null;if(this._apiToJSON.hasOwnProperty(t)){const e=this._apiToJSON[t];return this._options.useNumericKeys?+e:e}return this._options.ignoreUnknown?void 0:t}fromJSON(t){return null!=t&&this._jsonToAPI.hasOwnProperty(t)?this._jsonToAPI[t]:this._options.ignoreUnknown?void 0:t}}function Eo(t){const e={};for(const i in t)e[t[i]]=i;return e}function jo(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}function Oo(){return function(t,e){return new Co(t,{ignoreUnknown:!0,...e})}}class Ro{constructor(t,e,i,n,s,r){this.semiMajorAxis=t,this.flattening=e,this.outerAtmosphereRimWidth=i,this.atmosphereHeight=n,this.scaleHeight=s;const o=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*o,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=r||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}}const Lo=new Ro(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),No=new Ro(3396190,1/169.8944472236118,23e4,6e4,.111),Po=new Ro(1737400,0,0,0,0);const Fo=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,Do={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function $o(t){const e=t?.match(Fo);if(!e)return null;const[,i,n,s]=e;if(!i)return null;let r=null,o=null,a=null;const{devext:l,qaext:u,www:c}=Do;if(n)if(r=i,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}else({customBaseUrl:o,portalHostname:a}=c);else switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=u);break;case"www":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:r}}function zo(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function Uo(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,n=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):i.test(t)?t=t.replace(i,"https://devext.arcgis.com"):n.test(t)&&(t=t.replace(n,"https://qaext.arcgis.com")),t}function Bo(t){const e=atob(t),i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return i.buffer}function Go(t){const e=new Uint8Array(t);let i="";for(let t=0;t<e.length;t++)i+=String.fromCharCode(e[t]);return btoa(i)}const Vo=()=>jt.getLogger("esri.core.urlUtils"),qo=St.request,Ho="esri/config: esriConfig.request.proxyUrl is not set.",Wo=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,Zo=/^\s*http:/i,Jo=/^\s*https:/i,Yo=/^\s*file:/i,Ko=/:\d+$/,Qo=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Xo=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),ta=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");class ea{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let e=this.uri.match(Xo);this.scheme=e[2]||(e[1]?"":null),this.authority=e[4]||(e[3]?"":null),this.path=e[5],this.query=e[7]||(e[6]?"":null),this.fragment=e[9]||(e[8]?"":null),null!=this.authority&&(e=this.authority.match(ta),this.user=e[3]||null,this.password=e[4]||null,this.host=e[6]||e[7],this.port=e[9]||null)}toString(){return this.uri}}const ia={},na=new ea(St.applicationUrl);let sa=na;const ra=ua();let oa=ra;const aa=()=>sa,la=()=>oa;function ua(){const t=sa.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${sa.scheme}://${sa.host}${null!=sa.port?`:${sa.port}`:""}`}${e}`}function ca(t){if(!t)return null;const e={path:null,query:null},i=new ea(t),n=t.indexOf("?");return null===i.query?e.path=t:(e.path=t.slice(0,n),e.query=ha(i.query)),i.fragment&&(e.hash=i.fragment,null===i.query&&(e.path=e.path.slice(0,e.path.length-(i.fragment.length+1)))),e}function ha(t){const e=t.split("&"),i={};for(const t of e){if(!t)continue;const e=t.indexOf("=");let n,s;e<0?(n=decodeURIComponent(t),s=""):(n=decodeURIComponent(t.slice(0,e)),s=decodeURIComponent(t.slice(e+1)));let r=i[n];"string"==typeof r&&(r=i[n]=[r]),Array.isArray(r)?r.push(s):i[n]=s}return i}function da(t,e){return t?e&&"function"==typeof e?Object.keys(t).map((i=>encodeURIComponent(i)+"="+encodeURIComponent(e(i,t[i])))).join("&"):Object.keys(t).map((i=>{const n=t[i];if(null==n)return"";const s=encodeURIComponent(i)+"=",r=e?.[i];return r?s+encodeURIComponent(r(n)):Array.isArray(n)?n.map((t=>Ao(t)?s+encodeURIComponent(JSON.stringify(t)):s+encodeURIComponent(t))).join("&"):Ao(n)?s+encodeURIComponent(JSON.stringify(n)):s+encodeURIComponent(n)})).filter((t=>t)).join("&"):""}function fa(t=!1){let e,i=qo.proxyUrl;if("string"==typeof t){e=Ha(t);const n=wa(t);n&&(i=n.proxyUrl)}else e=!!t;if(!i)throw Vo().warn(Ho),new Ve("urlUtils:proxy-not-set",Ho);e&&Ka()&&(i=Ja(i));return ca(i)}function pa(t,e=!1){const i=wa(t);let n,s;if(i){const t=ya(i.proxyUrl);n=t.path,s=t.query?ha(t.query):null}else if(e){const e=fa(t);n=e.path,s=e.query}if(n){const e=ca(t);t=n+"?"+e.path;const i=da({...s,...e.query});i&&(t=`${t}?${i}`)}return t}const ma={path:"",query:""};function ya(t){const e=t.indexOf("?");return-1!==e?(ma.path=t.slice(0,e),ma.query=t.slice(e+1)):(ma.path=t,ma.query=null),ma}function ga(t){return t=(t=Qa(t=il(t=ya(t).path),!0)).toLowerCase()}function va(t){const e={proxyUrl:t.proxyUrl,urlPrefix:ga(t.urlPrefix)},i=qo.proxyRules,n=e.urlPrefix;let s=i.length;for(let t=0;t<i.length;t++){const e=i[t].urlPrefix;if(0===n.indexOf(e)){if(n.length===e.length)return-1;s=t;break}0===e.indexOf(n)&&(s=t+1)}return i.splice(s,0,e),s}function wa(t){const e=qo.proxyRules,i=ga(t);for(let t=0;t<e.length;t++)if(0===i.indexOf(e[t].urlPrefix))return e[t]}function ba(t,e){if(!t||!e)return!1;t=_a(t),e=_a(e);const i=$o(t),n=$o(e);return null!=i&&null!=n?i.portalHostname===n.portalHostname:null==i&&null==n&&Ma(t,e,!0)}function Sa(t,e){return t=_a(t),e=_a(e),Qa(t)===Qa(e)}function _a(t){const e=(t=Ca(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function xa(t,e=qo.interceptors){const i=e=>null==e||e instanceof RegExp&&e.test(t)||"string"==typeof e&&t.startsWith(e);if(e)for(const t of e)if(Array.isArray(t.urls)){if(t.urls.some(i))return t}else if(i(t.urls))return t;return null}function Ma(t,e,i=!1){if(!t||!e)return!1;const n=ll(t),s=ll(e);return!(!i&&n.scheme!==s.scheme)&&(null!=n.host&&null!=s.host&&(n.host.toLowerCase()===s.host.toLowerCase()&&n.port===s.port))}function Ta(t){if("string"==typeof t){if(!Oa(t))return!0;t=ll(t)}if(Ma(t,sa))return!0;const e=qo.trustedServers||[];for(let i=0;i<e.length;i++){const n=Aa(e[i]);for(let e=0;e<n.length;e++)if(Ma(t,n[e]))return!0}return!1}function Aa(t){return ia[t]||(qa(t)||Va(t)?ia[t]=[new ea(Ia(t))]:ia[t]=[new ea(`http://${t}`),new ea(`https://${t}`)]),ia[t]}function Ia(t,e=oa,i){return Va(t)?i?.preserveProtocolRelative?t:"http"===sa.scheme&&sa.authority===ja(t).slice(2)?`http:${t}`:`https:${t}`:qa(t)?t:Ea("/"===t[0]?Xa(e):e,t)}function ka(t,e=oa,i){if(null==t||!Oa(t))return t;const n=Ca(t),s=n.toLowerCase(),r=Ca(e).toLowerCase().replace(/\/+$/,""),o=i?Ca(i).toLowerCase().replace(/\/+$/,""):null;if(o&&0!==r.indexOf(o))return t;const a=(t,e,i)=>-1===(i=t.indexOf(e,i))?t.length:i;let l=a(s,"/",s.indexOf("//")+2),u=-1;for(;s.slice(0,l+1)===r.slice(0,l)+"/"&&(u=l+1,l!==s.length);)l=a(s,"/",l+1);if(-1===u)return t;if(o&&u<o.length)return t;t=n.slice(u);const c=r.slice(u-1).replaceAll(/[^/]+/g,"").length;if(c>0)for(let e=0;e<c;e++)t=`../${t}`;else t=`./${t}`;return t}function Ca(t){return t=ol(t=rl(t=sl(t=Ia(t=t.trim()))))}function Ea(...t){const e=t.filter(C);if(!e?.length)return;const i=[];if(Oa(e[0])){const t=e[0],n=t.indexOf("//");-1!==n&&(i.push(t.slice(0,n+1)),Za(e[0])&&(i[0]+="/"),e[0]=t.slice(n+2))}else"/"===e[0][0]&&i.push("");const n=e.reduce(((t,e)=>e?t.concat(e.split("/")):t),[]);for(let t=0;t<n.length;t++){const e=n[t];".."===e&&i.length>0&&".."!==i[i.length-1]?i.pop():(!e&&t===n.length-1||e&&("."!==e||0===i.length))&&i.push(e)}return i.join("/")}function ja(t,e=!1){if(null==t||Ra(t)||La(t))return null;let i=t.indexOf("://");if(-1===i&&Va(t))i=2;else{if(-1===i)return null;i+=3}const n=t.indexOf("/",i);return-1!==n&&(t=t.slice(0,n)),e&&(t=Qa(t,!0)),t}function Oa(t){return Va(t)||qa(t)}function Ra(t){return null!=t&&"blob:"===t.slice(0,5)}function La(t){return null!=t&&"data:"===t.slice(0,5)}function Na(t){const e=Da(t);return e?.isBase64?Bo(e.data):null}function Pa(t){return Go(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const Fa=/^data:(.*?)(;base64)?,(.*)$/;function Da(t){const e=t.match(Fa);if(!e)return null;const[,i,n,s]=e;return{mediaType:i,isBase64:!!n,data:s}}function $a(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function za(t){return(await fetch(t)).blob()}function Ua(t){const e=Na(t);if(!e)return null;const i=Da(t);return new Blob([e],{type:i.mediaType})}function Ba(t,e){Ga(t,e)}function Ga(t,e){if(!t)return!1;const i=document.createElement("a");if(!("download"in i))return!1;const n=URL.createObjectURL(t);return i.download=e,i.href=n,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),!0}function Va(t){return null!=t&&"/"===t[0]&&"/"===t[1]}function qa(t){return null!=t&&Wo.test(t)}function Ha(t){return null!=t&&Jo.test(t)||"https"===sa.scheme&&Va(t)}function Wa(t){return null!=t&&Zo.test(t)||"http"===sa.scheme&&Va(t)}function Za(t){return null!=t&&Yo.test(t)}function Ja(t){return Va(t)?`https:${t}`:t.replace(Zo,"https:")}function Ya(){return"http"===sa.scheme}function Ka(){return"https"===sa.scheme}function Qa(t,e=!1){return Va(t)?t.slice(2):(t=t.replace(Wo,""),e&&t.length>1&&"/"===t[0]&&"/"===t[1]&&(t=t.slice(2)),t)}function Xa(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return-1===i?t:t.slice(0,i)}function tl(t){let e=0;if(Oa(t)){const i=t.indexOf("//");-1!==i&&(e=i+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function el(t,e){if(!t)return"";const i=ca(t).path.replace(/\/+$/,""),n=i.slice(i.lastIndexOf("/")+1);if(!e?.length)return n;const s=new RegExp(`\\.(${e.join("|")})$`,"i");return n.replace(s,"")}function il(t){return t.endsWith("/")?t:`${t}/`}function nl(t){return t.replace(/\/+$/,"")}function sl(t){if(/^https?:\/\//i.test(t)){const e=ya(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function rl(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function ol(t){const e=qo.httpsDomains;if(!Wa(t))return t;const i=t.indexOf("/",7);let n;if(n=-1===i?t:t.slice(0,i),n=n.toLowerCase().slice(7),Ko.test(n)){if(!n.endsWith(":80"))return t;n=n.slice(0,-3),t=t.replace(":80","")}return Ya()&&n===sa.authority&&!Qo.test(t)||(Ka()&&n===sa.authority||e&&e.some((t=>n===t||n.endsWith(`.${t}`)))||Ka()&&!wa(t))&&(t=Ja(t)),t}function al(t,e,i){if(!(e&&i&&t&&Oa(t)))return t;const n=t.indexOf("//"),s=t.indexOf("/",n+2),r=t.indexOf(":",n+2),o=Math.min(s<0?t.length:s,r<0?t.length:r);if(t.slice(n+2,o).toLowerCase()!==e.toLowerCase())return t;return`${t.slice(0,n+2)}${i}${t.slice(o)}`}function ll(t){return"string"==typeof t?new ea(Ia(t)):(t.scheme||(t.scheme=sa.scheme),t)}function ul(t){return gl.test(t)}function cl(t,e){const i=ca(t),n=Object.keys(i.query||{});return n.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${n.join(", ")}.`),i.path}function hl(t,e,i){const n=ca(t),s=n.query||{};return s[e]=String(i),`${n.path}?${da(s)}`}function dl(t,e){if(!e)return t;const i=ca(t),n=i.query||{};for(const[t,i]of Object.entries(e))null!=i&&(n[t]=i);const s=da(n);return s?`${i.path}?${s}`:i.path}function fl(t){if(null==t)return null;const e=t.match(yl);return e?e[2]:null}function pl(t){if(null==t)return null;const e=t.match(yl);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function ml(t){if("string"==typeof t){return Da(t)??{data:t}}return new Promise(((e,i)=>{const n=new FileReader;n.readAsDataURL(t),n.onload=()=>e(Da(n.result)),n.onerror=t=>i(t)}))}const yl=/([^.]*)\.([^/]*)$/,gl=/(^data:image\/svg|\.svg$)/i;const vl="20241106",wl="4a32008d0254ea616a8e5f1a7b7dd5baf6852418";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const bl="4.31";let Sl,_l=bl;_l="4.31.0";function xl(t){Sl=t}function Ml(t){const e=Sl?.findCredential(t);return e?.token?hl(t,"token",e.token):t}u("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),u("host-webworker");const Tl=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function Al(t){const e=ja(t,!0);return!!e&&(e.endsWith(".arcgis.com")&&!Tl.has(e)&&!t.endsWith("/sharing/rest/generateToken"))}function Il(t,e){return!(!e&&!St.apiKey||!Al(t))}function kl(t,e,i=!1,n){return new Promise(((s,r)=>{if(Ms(n))return void r(Cl());let o=()=>{c(),r(new Error(`Unable to load ${e}`))},a=()=>{const e=t;c(),s(e)},l=()=>{if(!t)return;const e=t;c(),e.src="",r(Cl())};const c=()=>{u("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,null!=n&&n.removeEventListener("abort",l),l=null,i&&URL.revokeObjectURL(e)};null!=n&&n.addEventListener("abort",l),u("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))}))}function Cl(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const El="Timeout exceeded";function jl(){return new Error(El)}function Ol(t){return"object"==typeof t&&!!t&&"message"in t&&t.message===El}function Rl(t){St.request.crossOriginNoCorsDomains||(St.request.crossOriginNoCorsDomains={});const e=St.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[ja(i)??""]=0:(e[ja("http://"+i)??""]=0,e[ja("https://"+i)??""]=0)}function Ll(t){const e=St.request.crossOriginNoCorsDomains;if(e){let i=ja(t);if(i)return i=i.toLowerCase(),!Ma(i,aa())&&e[i]<Date.now()-36e5}return!1}async function Nl(t){const e=ca(t);t=e.path,"json"===e.query?.f&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const i=St.request.crossOriginNoCorsDomains,n=ja(t);i&&n&&(i[n.toLowerCase()]=Date.now())}async function Pl(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=ha(e.query.toString().replaceAll("+"," ")));const i=La(t),n=Ra(t);n||i||(t=Ca(t));const s={url:t,requestOptions:{...e}},r=t=>({data:t,getAllHeaders:Gl,getHeader:Gl,httpStatus:200,requestOptions:s.requestOptions,url:s.url}),o=xa(t,Dl.internalInterceptors);if(o){const t=await Xl(o,s);if(null!=t)return r(t)}let a=xa(t);if(a){const t=await Xl(a,s);if(null!=t)return r(t);a.after||a.error||(a=null)}if(t=s.url,"image"===(e=s.requestOptions).responseType&&(u("host-webworker")||u("host-node")))throw Wl("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if("head"===e.method){if(e.body)throw Wl("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(i||n)throw Wl("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(await Zl(),Fl)return Fl.execute(t,e);const l=new AbortController,c=Is(e,(()=>l.abort())),h={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:s,redoRequest:!1,useIdentity:Dl.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},d=await iu(h).finally((()=>c?.remove()));return a?.after?.(d),d}let Fl;const Dl=St.request,$l="FormData"in globalThis,zl=new Set([499,498,403,401]),Ul=new Set(["COM_0056","COM_0057","SB_0008"]),Bl=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],Gl=()=>null,Vl=Symbol();function ql(t){const e=ja(t);e&&!Pl._corsServers.includes(e)&&Pl._corsServers.push(e)}function Hl(t){const e=ja(t);return!e||e.endsWith(".arcgis.com")||Pl._corsServers.includes(e)||Ta(e)}function Wl(t,e,i,n){let s="Error";const r={url:i.url,requestOptions:i.requestOptions,getAllHeaders:Gl,getHeader:Gl,ssl:!1};if(e instanceof Ve)return e.details?(e.details=nt(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=r,e;if(e){const t=n&&(()=>Array.from(n.headers)),i=n&&(t=>n.headers.get(t)),o=n?.status,a=e.message;a&&(s=a),t&&i&&(r.getAllHeaders=t,r.getHeader=i),r.httpStatus=(null!=e.httpCode?e.httpCode:e.code)||o||0,r.subCode=e.subcode,r.messageCode=e.messageCode,"string"==typeof e.details?r.messages=[e.details]:r.messages=e.details,r.raw=Vl in e?e[Vl]:e}return Es(e)?Ss():new Ve(t,s,r)}async function Zl(){u("host-webworker")&&!Fl&&(Fl=await import("./p-82b038c6.js"))}async function Jl(){Sl||await Promise.resolve().then((function(){return OUt}))}async function Yl(t){const e=t.params.url,i=t.params.requestOptions,n=t.controller.signal,s=i.body;let r=null,o=null;if($l&&"HTMLFormElement"in globalThis&&(s instanceof FormData?r=s:s instanceof HTMLFormElement&&(r=new FormData(s))),"string"==typeof s&&(o=s),t.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:"head"===i.method?"HEAD":"GET",mode:"cors",priority:Dl.priority,redirect:"follow",signal:n},(r||o)&&(t.fetchOptions.body=r||o),"anonymous"===i.authMode&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||i.query?.token||r?.get("token")),!t.hasToken&&Il(e)&&(i.query||(i.query={}),i.query.token=St.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!Kl(e)&&!Ms(n)){let s;"immediate"===i.authMode?(await Jl(),s=await Sl.getCredential(e,{signal:n}),t.credential=s):"no-prompt"===i.authMode?(await Jl(),s=await Sl.getCredential(e,{prompt:!1,signal:n}).catch((()=>{})),t.credential=s):Sl&&(s=Sl.findCredential(e)),s&&(t.credentialToken=s.token,t.useSSL=!!s.ssl)}}function Kl(t){return Bl.some((e=>e.test(t)))}async function Ql(t){let e=t.params.url;const i=t.params.requestOptions,n=t.fetchOptions??{},s=Ra(e)||La(e),r=i.responseType||"json",o=s?0:null!=i.timeout?i.timeout:Dl.timeout;let a=!1;if(!s){t.useSSL&&(e=Ja(e));let s={...i.query};t.credentialToken&&(s.token=t.credentialToken);let r=da(s);u("esri-url-encodes-apostrophe")&&(r=r.replaceAll("'","%27"));const o=e.length+1+r.length;let l;a="delete"===i.method||"post"===i.method||"put"===i.method||!!i.body||o>Dl.maxUrlLength;const c=i.useProxy||!!wa(e);if(c){const t=fa(e);l=t.path,!a&&l.length+1+o>Dl.maxUrlLength&&(a=!0),t.query&&(s={...t.query,...s})}if("HEAD"===n.method&&(a||c)){if(a){if(o>Dl.maxUrlLength)throw Wl("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params);throw Wl("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params)}if(c)throw Wl("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(a?(n.method="delete"===i.method?"DELETE":"put"===i.method?"PUT":"POST",i.body?e=dl(e,s):(n.body=da(s),n.headers||(n.headers={}),n.headers["Content-Type"]="application/x-www-form-urlencoded")):e=dl(e,s),c&&(t.useProxy=!0,e=`${l}?${e}`),s.token&&$l&&n.body instanceof FormData&&!zo(e)&&n.body.set("token",s.token),i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!Ma(e,aa()))if(Ta(e))t.withCredentials=!0;else if(Sl){const i=Sl.findServerInfo(e);i?.webTierAuth&&(t.withCredentials=!0)}t.withCredentials&&(n.credentials="include",Ll(e)&&await Nl(a?dl(e,s):e))}let l,c,h=0,d=!1;o>0&&(h=setTimeout((()=>{d=!0,t.controller.abort()}),o));try{if("native-request-init"===i.responseType)c=n,c.url=e,i.signal?c.signal=i.signal:delete c.signal;else if("image"!==i.responseType||"default"!==n.cache||"GET"!==n.method||a||tu(i.headers)||!s&&!t.useProxy&&Dl.proxyUrl&&!Hl(e)){if(Pl._beforeFetch&&await Pl._beforeFetch(e,n),l=await fetch(e,n),Pl._afterFetch&&await Pl._afterFetch(l),t.useProxy||ql(e),"native"===i.responseType)c=l;else if("HEAD"!==n.method)if(l.ok){switch(r){case"array-buffer":c=await l.arrayBuffer();break;case"blob":case"image":c=await l.blob();break;default:c=await l.text()}if(h&&(clearTimeout(h),h=0),"json"===r||"xml"===r||"document"===r)if(c)switch(r){case"json":c=JSON.parse(c);break;case"xml":c=eu(c,"application/xml");break;case"document":c=eu(c,"text/html")}else c=null;if(c){if("array-buffer"===r||"blob"===r){const t=l.headers.get("Content-Type");if(t&&/application\/json|text\/plain/i.test(t)&&c["blob"===r?"size":"byteLength"]<=750)try{const t=await new Response(c).json();t.error&&(c=t)}catch{}}"image"===r&&c instanceof Blob&&(c=await su(URL.createObjectURL(c),t,!0))}}else{c=await l.text();try{c=JSON.parse(c)}catch{}}}else c=await su(e,t)}catch(n){if("AbortError"===n.name){if(d)throw jl();throw Ss("Request canceled")}if(!(!l&&n instanceof TypeError&&Dl.proxyUrl)||i.body||"delete"===i.method||"head"===i.method||"post"===i.method||"put"===i.method||t.useProxy||Hl(e))throw n;t.redoRequest=!0,va({proxyUrl:Dl.proxyUrl,urlPrefix:ja(e)??""})}finally{h&&clearTimeout(h)}return[l,c]}async function Xl(t,e){if(null!=t.responseData)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,n;try{n=await t.before(e)}catch(t){i=Wl("request:interceptor",t,e)}if((n instanceof Error||n instanceof Ve)&&(i=Wl("request:interceptor",n,e)),i)throw t.error&&t.error(i),i;return n}}function tu(t){if(t)for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0;return!1}function eu(t,e){let i;try{i=(new DOMParser).parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function iu(t){let e,i;await Yl(t);try{do{[e,i]=await Ql(t)}while(!await nu(t,e,i))}catch(i){const n=Wl("request:server",i,t.params,e);throw n.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(n),n}const n=t.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(n)){if(!t.hasToken&&!t.credentialToken&&i.user?.username&&!Ta(n)){const t=ja(n,!0);t&&Dl.trustedServers.push(t)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&Rl(i.authorizedCrossOriginNoCorsDomains)}const s=t.credential;if(s&&Sl){const t=Sl.findServerInfo(s.server);let e=t?.owningSystemUrl;if(e){e=e.replace(/\/?$/,"/sharing");const t=Sl.findCredential(e,s.userId);t&&-1===Sl._getIdenticalSvcIdx(e,t)&&t.resources.unshift(e)}}return{data:i,getAllHeaders:e?()=>Array.from(e.headers):Gl,getHeader:e?t=>e.headers.get(t):Gl,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function nu(t,e,i){if(t.redoRequest)return t.redoRequest=!1,!1;const n=t.params.requestOptions;if(!e||"native"===n.responseType||"native-request-init"===n.responseType)return!0;let s,r;if(i&&(i.error&&"object"==typeof i.error?s=i.error:"error"===i.status&&Array.isArray(i.messages)&&(s={...i},s[Vl]=i,s.details=i.messages)),!s&&!e.ok)throw s=new Error(`Unable to load ${e.url} status: ${e.status}`),s[Vl]=i,s;let o,a=null;s&&(r=Number(s.code),a=s.hasOwnProperty("subcode")?Number(s.subcode):null,o=s.messageCode,o=o?.toUpperCase());const l=n.authMode;if(403===r&&(4===a||s.message?.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&("no-prompt"!==l||498===r)&&void 0!==r&&zl.has(r)&&!Kl(t.params.url)&&(403!==r||(!o||!Ul.has(o))&&(null==a||2===a&&t.credentialToken))){await Jl();try{const e=await Sl.getCredential(t.params.url,{error:Wl("request:server",s,t.params),prompt:"no-prompt"!==l,signal:t.controller.signal,token:t.credentialToken});return t.credential=e,t.credentialToken=e.token,t.useSSL=t.useSSL||e.ssl,!1}catch(e){if("no-prompt"===l)return t.credential=void 0,t.credentialToken=void 0,!1;s=e}}if(s)throw s;return!0}function su(t,e,i=!1){const n=e.controller.signal,s=new Image;return e.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=Dl.priority,s.src=t,kl(s,t,i,n)}Pl._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],Pl._beforeFetch=void 0,Pl._afterFetch=void 0;function ru(t){if(!St.assetsPath)throw jt.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Ve("assets:path-not-set","config.assetsPath is not set");return Ea(St.assetsPath,t)}let ou,au=null;function lu(){return!!au}function uu(){return!!u("esri-wasm")}function cu(){return ou||(ou=import("./p-4175e3f1.js").then((t=>t.p)).then((({default:t})=>t({locateFile:t=>ru(`esri/geometry/support/${t}`)}))).then((t=>{Iu(t)})),ou)}var hu,du;!function(t){function e(t,e,i){au.ensureCache.prepare();const n=Eu(i),s=i===n,r=au.ensureFloat64(n),o=au._pe_geog_to_proj(au.getPointer(t),e,r);return o&&ju(i,e,r,s),o}function i(t,i,s,r){switch(r){case du.PE_TRANSFORM_P_TO_G:return n(t,i,s);case du.PE_TRANSFORM_G_TO_P:return e(t,i,s)}return 0}function n(t,e,i){return s(t,e,i,0)}function s(t,e,i,n){au.ensureCache.prepare();const s=Eu(i),r=i===s,o=au.ensureFloat64(s),a=au._pe_proj_to_geog_center(au.getPointer(t),e,o,n);return a&&ju(i,e,o,r),a}t.geogToProj=e,t.projGeog=i,t.projToGeog=n,t.projToGeogCenter=s}(hu||(hu={})),function(t){function e(){t.PE_BUFFER_MAX=au.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=au.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=au.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=au.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=au.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=au.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=au.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=au.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=au.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=au.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=au.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=au.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=au.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=au.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=au.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=au.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=au.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=au.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=au.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=au.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_STR_FMT_WKT=au.PeDefs.prototype.PE_STR_FMT_WKT,t.PE_STR_FMT_WKT2=au.PeDefs.prototype.PE_STR_FMT_WKT2,t.PE_PARM_X0=au.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=au.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=au.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=au.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=au.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=au.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=au.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=au.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=au.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=au.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e}(du||(du={}));let fu=null;var pu;!function(t){const e={},i={},n=t=>{const e=t.getType();switch(e){case du.PE_TYPE_GEOGCS:t=au.castObject(t,au.PeGeogcs);break;case du.PE_TYPE_PROJCS:t=au.castObject(t,au.PeProjcs);break;case du.PE_TYPE_GEOGTRAN:t=au.castObject(t,au.PeGeogtran);break;default:e&du.PE_TYPE_UNIT&&(t=au.castObject(t,au.PeUnit))}return t};function s(){au.PeFactory.prototype.initialize(null)}function r(t){return o(du.PE_TYPE_COORDSYS,t)}function o(t,i){let s=null,r=e[t];if(r||(r={},e[t]=r),r.hasOwnProperty(String(i))&&(s=r[i],au.compare(s,au.NULL)&&(s=null)),!s){const e=au.PeFactory.prototype.factoryByType(t,i);au.compare(e,au.NULL)||(s=n(e),r[i]=s)}return s}function a(t,e){let s=null,r=i[t];if(r||(r={},i[t]=r),r.hasOwnProperty(e)&&(s=r[e],au.compare(s,au.NULL)&&(s=null)),!s){const i=au.PeFactory.prototype.fromString(t,e);au.compare(i,au.NULL)||(s=n(i),r[e]=s)}return s}function l(t){return o(du.PE_TYPE_GEOGCS,t)}function u(t){return o(du.PE_TYPE_GEOGTRAN,t)}function c(t){return au.PeFactory.prototype.getCode(t)}function h(t){return o(du.PE_TYPE_PROJCS,t)}function d(t){return o(du.PE_TYPE_UNIT,t)}t.initialize=s,t.coordsys=r,t.factoryByType=o,t.fromString=a,t.geogcs=l,t.geogtran=u,t.getCode=c,t.projcs=h,t.unit=d}(pu||(pu={}));let mu=null;var yu,gu,vu,wu,bu,Su,_u,xu,Mu,Tu,Au;function Iu(t){function e(t,e,i){t[e]=i(t[e])}au=t,du.init(),yu.init(),_u.init(),Mu.init(),Tu.init(),fu=class extends au.PeDouble{constructor(t=NaN){super(t)}destroy(){au.destroy(this)}[Symbol.dispose](){this.destroy()}},mu=class extends au.PeGCSExtent{destroy(){au.destroy(this)}[Symbol.dispose](){this.destroy()}};const i=[au.PeAngunit,au.PeDatum,au.PeGeogcs,au.PeGeogtran,au.PeObject,au.PeParameter,au.PePrimem,au.PeProjcs,au.PeSpheroid,au.PeUnit];for(const t of i)e(t.prototype,"getName",(t=>function(){return t.call(this,new Array(du.PE_NAME_MAX))}));for(const t of[au.PeGeogtran,au.PeProjcs])e(t.prototype,"getParameters",(t=>function(){const e=new Array(du.PE_PARM_MAX);let i=t.call(this);for(let t=0;t<e.length;t++){const n=au.getValue(i,"*");e[t]=n?au.wrapPointer(n,au.PeParameter):null,i+=Int32Array.BYTES_PER_ELEMENT}return e}));e(au.PeHorizon.prototype,"getCoord",(t=>function(e=!1){const i=this.getSize();if(!i)return null;const n=[];return ju(n,i,t.call(this),e),n})),e(au.PeGTlistExtendedEntry.prototype,"getEntries",(t=>{const e=au._pe_getPeGTlistExtendedGTsSize();return function(){let i=null;const n=t.call(this);if(!au.compare(n,au.NULL)){i=[n];const t=this.getSteps();if(t>1){const s=au.getPointer(n);for(let n=1;n<t;n++)i.push(au.wrapPointer(s+e*n,au.PeGTlistExtendedGTs))}}return i}}));const n=au._pe_getPeHorizonSize(),s=t=>function(){let e=this._cache;if(e||(e=new Map,this._cache=e),e.has(t))return e.get(t);let i=null;const s=t.call(this);if(!au.compare(s,au.NULL)){i=[s];const t=s.getNump();if(t>1){const e=au.getPointer(s);for(let s=1;s<t;s++)i.push(au.wrapPointer(e+n*s,au.PeHorizon))}}return e.set(t,i),i};e(au.PeProjcs.prototype,"horizonGcsGenerate",s),e(au.PeProjcs.prototype,"horizonPcsGenerate",s),au.PeObject.prototype.toString=function(t=du.PE_STR_OPTS_NONE){au.ensureCache.prepare();const e=au.getPointer(this),i=au.ensureInt8(new Array(du.PE_BUFFER_MAX));return au.UTF8ToString(au._pe_object_to_string_ext(e,t,i))},au.PeGeogcs.prototype.destroy=function(){this.Delete(),ku(this),this.ptr=0},au.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},au.PeProjcs.prototype.destroy=function(){this.Delete(),ku(this),this.ptr=0},au.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function ku(t){if(!t)return;const e=au.getClass(t);if(!e)return;const i=au.getCache(e);if(!i)return;const n=au.getPointer(t);n&&delete i[n]}function Cu(t,e){const i=[],n=new Array(e);for(let e=0;e<t;e++)i.push(au.ensureInt8(n));return i}function Eu(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function ju(t,e,i,n=!1){if(n)for(let n=0;n<2*e;n++)t[n]=au.getValue(i+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=0===t.length;for(let s=0;s<e;s++)n&&(t[s]=new Array(2)),t[s][0]=au.getValue(i,"double"),t[s][1]=au.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}!function(t){let e;function i(){t.PE_GTLIST_OPTS_COMMON=au.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=au._pe_getPeGTlistExtendedEntrySize()}function n(t,i,n,s,r,o){let a=null;const l=new au.PeInteger(o);try{const u=au.PeGTlistExtended.prototype.getGTlist(t,i,n,s,r,l);if((o=l.val)&&(a=[u],o>1)){const t=au.getPointer(u);for(let i=1;i<o;i++)a.push(au.wrapPointer(t+e*i,au.PeGTlistExtendedEntry))}}finally{au.destroy(l)}return a}t.init=i,t.getGTlist=n}(yu||(yu={})),function(t){function e(t){if(t?.length){for(const e of t)ku(e),e.getEntries().forEach((t=>{ku(t);const e=t.getGeogtran();ku(e),e.getParameters().forEach(ku),[e.getGeogcs1(),e.getGeogcs2()].forEach((t=>{ku(t);const e=t.getDatum();ku(e),ku(e.getSpheroid()),ku(t.getPrimem()),ku(t.getUnit())}))}));au.PeGTlistExtendedEntry.prototype.Delete(t[0])}}t.destroy=e}(gu||(gu={})),function(t){function e(t,e,i,n,s){au.ensureCache.prepare();const r=Eu(i),o=i===r,a=au.ensureFloat64(r);let l=0;n&&(l=au.ensureFloat64(n));const u=au._pe_geog_to_geog(au.getPointer(t),e,a,l,s);return u&&ju(i,e,a,o),u}t.geogToGeog=e}(vu||(vu={})),function(t){function e(t,e,i,n,s,r,o,a){au.PeLineType.prototype.geodesic_coordinate(t,e,i,n,s,r,o,a)}function i(t,e,i,n,s,r,o,a,l){au.PeLineType.prototype.geodetic_coordinate(t,e,i,n,s,r,o,a,l)}function n(t,e,i,n,s,r,o,a,l,u){au.PeLineType.prototype.geodetic_distance(t,e,i,n,s,r,o,a,l,u)}function s(t,e,i,n,s,r,o,a,l){au.PeLineType.prototype.great_elliptic_distance(t,e,i,n,s,r,o,a,l)}t.geodesicCoordinate=e,t.geodeticCoordinate=i,t.geodeticDistance=n,t.greatEllipticDistance=s}(wu||(wu={})),function(t){function e(t,e){return au.PeMath.prototype.phi_to_eta(t,e)}function i(t,e){return au.PeMath.prototype.eta_to_phi(t,e)}function n(t,e){return au.PeMath.prototype.phi_to_phig(t,e)}function s(t,e,i){return au.PeMath.prototype.q(t,e,i)}function r(t,e){return au.PeMath.prototype.q90(t,e)}t.phiToEta=e,t.etaToPhi=i,t.phiToPhig=n,t.q=s,t.q90=r}(bu||(bu={})),function(t){const e=(t,e,i,n,s,r)=>{let o,a;switch(au.ensureCache.prepare(),t){case"dd":o=au._pe_geog_to_dd,a=du.PE_DD_MAX;break;case"ddm":o=au._pe_geog_to_ddm,a=du.PE_DDM_MAX;break;case"dms":o=au._pe_geog_to_dms,a=du.PE_DMS_MAX}let l=0;e&&(l=au.getPointer(e));const u=Eu(n),c=au.ensureFloat64(u),h=Cu(i,a),d=o(l,i,c,s,au.ensureInt32(h));if(d)for(let t=0;t<i;t++)r[t]=au.UTF8ToString(h[t]);return d},i=(t,e,i,n,s)=>{let r;switch(au.ensureCache.prepare(),t){case"dd":r=au._pe_dd_to_geog;break;case"ddm":r=au._pe_ddm_to_geog;break;case"dms":r=au._pe_dms_to_geog}let o=0;e&&(o=au.getPointer(e));const a=n.map((t=>au.ensureString(t))),l=au.ensureInt32(a),u=au.ensureFloat64(new Array(2*i)),c=r(o,i,l,u);return c&&ju(s,i,u),c};function n(t,i,n,s,r){return e("dms",t,i,n,s,r)}function s(t,e,n,s){return i("dms",t,e,n,s)}function r(t,i,n,s,r){return e("ddm",t,i,n,s,r)}function o(t,e,n,s){return i("ddm",t,e,n,s)}function a(t,i,n,s,r){return e("dd",t,i,n,s,r)}function l(t,e,n,s){return i("dd",t,e,n,s)}t.geogToDms=n,t.dmsToGeog=s,t.geogToDdm=r,t.ddmToGeog=o,t.geogToDd=a,t.ddToGeog=l}(Su||(Su={})),function(t){function e(){t.PE_MGRS_STYLE_NEW=au.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=au.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=au.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=au.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=au.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(t,e,i,n,s,r,o){au.ensureCache.prepare();let a=0;t&&(a=au.getPointer(t));const l=Eu(i),u=au.ensureFloat64(l),c=Cu(e,du.PE_MGRS_MAX),h=au.ensureInt32(c),d=au._pe_geog_to_mgrs_extended(a,e,u,n,s,r,h);if(d)for(let t=0;t<e;t++)o[t]=au.UTF8ToString(c[t]);return d}function n(t,e,i,n,s){au.ensureCache.prepare();let r=0;t&&(r=au.getPointer(t));const o=i.map((t=>au.ensureString(t))),a=au.ensureInt32(o),l=au.ensureFloat64(new Array(2*e)),u=au._pe_mgrs_to_geog_extended(r,e,a,n,l);return u&&ju(s,e,l),u}t.init=e,t.geogToMgrsExtended=i,t.mgrsToGeogExtended=n}(_u||(_u={})),function(t){function e(t,e,i,n,s,r,o){au.ensureCache.prepare();let a=0;t&&(a=au.getPointer(t));const l=Eu(i),u=au.ensureFloat64(l),c=Cu(e,du.PE_MGRS_MAX),h=au.ensureInt32(c),d=au._pe_geog_to_usng(a,e,u,n,s,r,h);if(d)for(let t=0;t<e;t++)o[t]=au.UTF8ToString(c[t]);return d}function i(t,e,i,n){au.ensureCache.prepare();let s=0;t&&(s=au.getPointer(t));const r=i.map((t=>au.ensureString(t))),o=au.ensureInt32(r),a=au.ensureFloat64(new Array(2*e)),l=au._pe_usng_to_geog(s,e,o,a);return l&&ju(n,e,a),l}t.geogToUsng=e,t.usngToGeog=i}(xu||(xu={})),function(t){function e(){t.PE_UTM_OPTS_NONE=au.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=au.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=au.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(t,e,i,n,s){au.ensureCache.prepare();let r=0;t&&(r=au.getPointer(t));const o=Eu(i),a=au.ensureFloat64(o),l=Cu(e,du.PE_UTM_MAX),u=au.ensureInt32(l),c=au._pe_geog_to_utm(r,e,a,n,u);if(c)for(let t=0;t<e;t++)s[t]=au.UTF8ToString(l[t]);return c}function n(t,e,i,n,s){au.ensureCache.prepare();let r=0;t&&(r=au.getPointer(t));const o=i.map((t=>au.ensureString(t))),a=au.ensureInt32(o),l=au.ensureFloat64(new Array(2*e)),u=au._pe_utm_to_geog(r,e,a,n,l);return u&&ju(s,e,l),u}t.init=e,t.geogToUtm=i,t.utmToGeog=n}(Mu||(Mu={})),function(t){const e=new Map;function i(){t.PE_PCSINFO_OPTION_NONE=au.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=au.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=au.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=au.PePCSInfo.prototype.PE_POLE_POINT}function n(i,n=t.PE_PCSINFO_OPTION_DOMAIN){let s=null,r=null;return e.has(i)&&(r=e.get(i),r[n]&&(s=r[n])),s||(s=au.PePCSInfo.prototype.generate(i,n),r||(r=[],e.set(i,r)),r[n]=s),s}t.init=i,t.generate=n}(Tu||(Tu={})),function(t){function e(){return au.PeVersion.prototype.version_string()}t.versionString=e}(Au||(Au={}));const Ou=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return hu},get PeDefs(){return du},get PeDouble(){return fu},get PeFactory(){return pu},get PeGCSExtent(){return mu},get PeGTTransformations(){return vu},get PeGTlistExtended(){return yu},get PeGTlistExtendedEntry(){return gu},get PeLineType(){return wu},get PeMath(){return bu},get PeNotationDms(){return Su},get PeNotationMgrs(){return _u},get PeNotationUsng(){return xu},get PeNotationUtm(){return Mu},get PePCSInfo(){return Tu},get PeVersion(){return Au},_init:Iu,get _pe(){return au},isLoaded:lu,isSupported:uu,load:cu},Symbol.toStringTag,{value:"Module"}));var Ru;!function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"}(Ru||(Ru={}));let Lu;const Nu={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1};for(Lu=2e3;Lu<=2045;Lu++)Nu[Lu]=0;for(Lu=2056;Lu<=2065;Lu++)Nu[Lu]=0;for(Lu=2067;Lu<=2135;Lu++)Nu[Lu]=0;for(Lu=2137;Lu<=2154;Lu++)Nu[Lu]=0;for(Lu=2161;Lu<=2170;Lu++)Nu[Lu]=0;for(Lu=2172;Lu<=2193;Lu++)Nu[Lu]=0;for(Lu=2195;Lu<=2198;Lu++)Nu[Lu]=0;for(Lu=2200;Lu<=2203;Lu++)Nu[Lu]=0;for(Lu=2205;Lu<=2217;Lu++)Nu[Lu]=0;for(Lu=2222;Lu<=2224;Lu++)Nu[Lu]=1;for(Lu=2225;Lu<=2250;Lu++)Nu[Lu]=2;for(Lu=2251;Lu<=2253;Lu++)Nu[Lu]=1;for(Lu=2257;Lu<=2264;Lu++)Nu[Lu]=2;for(Lu=2274;Lu<=2279;Lu++)Nu[Lu]=2;for(Lu=2280;Lu<=2282;Lu++)Nu[Lu]=1;for(Lu=2283;Lu<=2289;Lu++)Nu[Lu]=2;for(Lu=2290;Lu<=2292;Lu++)Nu[Lu]=0;for(Lu=2308;Lu<=2313;Lu++)Nu[Lu]=0;for(Lu=2315;Lu<=2491;Lu++)Nu[Lu]=0;for(Lu=2494;Lu<=2866;Lu++)Nu[Lu]=0;for(Lu=2867;Lu<=2869;Lu++)Nu[Lu]=1;for(Lu=2870;Lu<=2888;Lu++)Nu[Lu]=2;for(Lu=2891;Lu<=2895;Lu++)Nu[Lu]=2;for(Lu=2896;Lu<=2898;Lu++)Nu[Lu]=1;for(Lu=2902;Lu<=2908;Lu++)Nu[Lu]=2;for(Lu=2915;Lu<=2920;Lu++)Nu[Lu]=2;for(Lu=2921;Lu<=2923;Lu++)Nu[Lu]=1;for(Lu=2924;Lu<=2930;Lu++)Nu[Lu]=2;for(Lu=2931;Lu<=2962;Lu++)Nu[Lu]=0;for(Lu=2964;Lu<=2968;Lu++)Nu[Lu]=2;for(Lu=2969;Lu<=2973;Lu++)Nu[Lu]=0;for(Lu=2975;Lu<=2991;Lu++)Nu[Lu]=0;for(Lu=2995;Lu<=3051;Lu++)Nu[Lu]=0;for(Lu=3054;Lu<=3079;Lu++)Nu[Lu]=0;for(Lu=3081;Lu<=3088;Lu++)Nu[Lu]=0;for(Lu=3092;Lu<=3101;Lu++)Nu[Lu]=0;for(Lu=3106;Lu<=3138;Lu++)Nu[Lu]=0;for(Lu=3146;Lu<=3151;Lu++)Nu[Lu]=0;for(Lu=3153;Lu<=3166;Lu++)Nu[Lu]=0;for(Lu=3168;Lu<=3172;Lu++)Nu[Lu]=0;for(Lu=3174;Lu<=3203;Lu++)Nu[Lu]=0;for(Lu=3294;Lu<=3358;Lu++)Nu[Lu]=0;for(Lu=3367;Lu<=3403;Lu++)Nu[Lu]=0;for(Lu=3408;Lu<=3416;Lu++)Nu[Lu]=0;for(Lu=3417;Lu<=3438;Lu++)Nu[Lu]=2;for(Lu=3441;Lu<=3446;Lu++)Nu[Lu]=2;for(Lu=3447;Lu<=3450;Lu++)Nu[Lu]=0;for(Lu=3451;Lu<=3459;Lu++)Nu[Lu]=2;for(Lu=3460;Lu<=3478;Lu++)Nu[Lu]=0;for(Lu=3554;Lu<=3559;Lu++)Nu[Lu]=0;for(Lu=3560;Lu<=3570;Lu++)Nu[Lu]=2;for(Lu=3571;Lu<=3581;Lu++)Nu[Lu]=0;for(Lu=3594;Lu<=3597;Lu++)Nu[Lu]=0;for(Lu=3601;Lu<=3604;Lu++)Nu[Lu]=0;for(Lu=3637;Lu<=3639;Lu++)Nu[Lu]=0;for(Lu=3665;Lu<=3667;Lu++)Nu[Lu]=0;for(Lu=3693;Lu<=3695;Lu++)Nu[Lu]=0;for(Lu=3701;Lu<=3727;Lu++)Nu[Lu]=0;for(Lu=3728;Lu<=3739;Lu++)Nu[Lu]=2;for(Lu=3740;Lu<=3751;Lu++)Nu[Lu]=0;for(Lu=3753;Lu<=3760;Lu++)Nu[Lu]=2;for(Lu=3761;Lu<=3773;Lu++)Nu[Lu]=0;for(Lu=3775;Lu<=3777;Lu++)Nu[Lu]=0;for(Lu=3779;Lu<=3781;Lu++)Nu[Lu]=0;for(Lu=3783;Lu<=3785;Lu++)Nu[Lu]=0;for(Lu=3788;Lu<=3791;Lu++)Nu[Lu]=0;for(Lu=3797;Lu<=3802;Lu++)Nu[Lu]=0;for(Lu=3814;Lu<=3816;Lu++)Nu[Lu]=0;for(Lu=3825;Lu<=3829;Lu++)Nu[Lu]=0;for(Lu=3832;Lu<=3841;Lu++)Nu[Lu]=0;for(Lu=3844;Lu<=3852;Lu++)Nu[Lu]=0;for(Lu=3873;Lu<=3885;Lu++)Nu[Lu]=0;for(Lu=3890;Lu<=3893;Lu++)Nu[Lu]=0;for(Lu=3907;Lu<=3912;Lu++)Nu[Lu]=0;for(Lu=3942;Lu<=3950;Lu++)Nu[Lu]=0;for(Lu=3968;Lu<=3970;Lu++)Nu[Lu]=0;for(Lu=3973;Lu<=3976;Lu++)Nu[Lu]=0;for(Lu=3986;Lu<=3989;Lu++)Nu[Lu]=0;for(Lu=3994;Lu<=3997;Lu++)Nu[Lu]=0;for(Lu=4048;Lu<=4051;Lu++)Nu[Lu]=0;for(Lu=4056;Lu<=4063;Lu++)Nu[Lu]=0;for(Lu=4093;Lu<=4096;Lu++)Nu[Lu]=0;for(Lu=4390;Lu<=4398;Lu++)Nu[Lu]=0;for(Lu=4399;Lu<=4413;Lu++)Nu[Lu]=2;for(Lu=4418;Lu<=4433;Lu++)Nu[Lu]=2;for(Lu=4455;Lu<=4457;Lu++)Nu[Lu]=2;for(Lu=4484;Lu<=4489;Lu++)Nu[Lu]=0;for(Lu=4491;Lu<=4554;Lu++)Nu[Lu]=0;for(Lu=4568;Lu<=4589;Lu++)Nu[Lu]=0;for(Lu=4652;Lu<=4656;Lu++)Nu[Lu]=0;for(Lu=4766;Lu<=4800;Lu++)Nu[Lu]=0;for(Lu=5014;Lu<=5016;Lu++)Nu[Lu]=0;for(Lu=5069;Lu<=5072;Lu++)Nu[Lu]=0;for(Lu=5105;Lu<=5130;Lu++)Nu[Lu]=0;for(Lu=5167;Lu<=5188;Lu++)Nu[Lu]=0;for(Lu=5253;Lu<=5259;Lu++)Nu[Lu]=0;for(Lu=5269;Lu<=5275;Lu++)Nu[Lu]=0;for(Lu=5292;Lu<=5311;Lu++)Nu[Lu]=0;for(Lu=5329;Lu<=5331;Lu++)Nu[Lu]=0;for(Lu=5343;Lu<=5349;Lu++)Nu[Lu]=0;for(Lu=5355;Lu<=5357;Lu++)Nu[Lu]=0;for(Lu=5387;Lu<=5389;Lu++)Nu[Lu]=0;for(Lu=5459;Lu<=5463;Lu++)Nu[Lu]=0;for(Lu=5479;Lu<=5482;Lu++)Nu[Lu]=0;for(Lu=5518;Lu<=5520;Lu++)Nu[Lu]=0;for(Lu=5530;Lu<=5539;Lu++)Nu[Lu]=0;for(Lu=5550;Lu<=5552;Lu++)Nu[Lu]=0;for(Lu=5562;Lu<=5583;Lu++)Nu[Lu]=0;for(Lu=5623;Lu<=5625;Lu++)Nu[Lu]=2;for(Lu=5631;Lu<=5639;Lu++)Nu[Lu]=0;for(Lu=5649;Lu<=5653;Lu++)Nu[Lu]=0;for(Lu=5663;Lu<=5680;Lu++)Nu[Lu]=0;for(Lu=5682;Lu<=5685;Lu++)Nu[Lu]=0;for(Lu=5875;Lu<=5877;Lu++)Nu[Lu]=0;for(Lu=5896;Lu<=5899;Lu++)Nu[Lu]=0;for(Lu=5921;Lu<=5940;Lu++)Nu[Lu]=0;for(Lu=6050;Lu<=6125;Lu++)Nu[Lu]=0;for(Lu=6244;Lu<=6275;Lu++)Nu[Lu]=0;for(Lu=6328;Lu<=6348;Lu++)Nu[Lu]=0;for(Lu=6350;Lu<=6356;Lu++)Nu[Lu]=0;for(Lu=6366;Lu<=6372;Lu++)Nu[Lu]=0;for(Lu=6381;Lu<=6387;Lu++)Nu[Lu]=0;for(Lu=6393;Lu<=6404;Lu++)Nu[Lu]=0;for(Lu=6480;Lu<=6483;Lu++)Nu[Lu]=0;for(Lu=6511;Lu<=6514;Lu++)Nu[Lu]=0;for(Lu=6579;Lu<=6581;Lu++)Nu[Lu]=0;for(Lu=6619;Lu<=6624;Lu++)Nu[Lu]=0;for(Lu=6625;Lu<=6627;Lu++)Nu[Lu]=2;for(Lu=6628;Lu<=6632;Lu++)Nu[Lu]=0;for(Lu=6634;Lu<=6637;Lu++)Nu[Lu]=0;for(Lu=6669;Lu<=6692;Lu++)Nu[Lu]=0;for(Lu=6707;Lu<=6709;Lu++)Nu[Lu]=0;for(Lu=6720;Lu<=6723;Lu++)Nu[Lu]=0;for(Lu=6732;Lu<=6738;Lu++)Nu[Lu]=0;for(Lu=6931;Lu<=6933;Lu++)Nu[Lu]=0;for(Lu=6956;Lu<=6959;Lu++)Nu[Lu]=0;for(Lu=7005;Lu<=7007;Lu++)Nu[Lu]=0;for(Lu=7057;Lu<=7070;Lu++)Nu[Lu]=2;for(Lu=7074;Lu<=7082;Lu++)Nu[Lu]=0;for(Lu=7109;Lu<=7118;Lu++)Nu[Lu]=0;for(Lu=7119;Lu<=7127;Lu++)Nu[Lu]=1;for(Lu=7374;Lu<=7376;Lu++)Nu[Lu]=0;for(Lu=7528;Lu<=7586;Lu++)Nu[Lu]=0;for(Lu=7587;Lu<=7645;Lu++)Nu[Lu]=2;for(Lu=7692;Lu<=7696;Lu++)Nu[Lu]=0;for(Lu=7755;Lu<=7787;Lu++)Nu[Lu]=0;for(Lu=7791;Lu<=7795;Lu++)Nu[Lu]=0;for(Lu=7799;Lu<=7801;Lu++)Nu[Lu]=0;for(Lu=7803;Lu<=7805;Lu++)Nu[Lu]=0;for(Lu=7825;Lu<=7831;Lu++)Nu[Lu]=0;for(Lu=7845;Lu<=7859;Lu++)Nu[Lu]=0;for(Lu=8013;Lu<=8032;Lu++)Nu[Lu]=0;for(Lu=8065;Lu<=8068;Lu++)Nu[Lu]=1;for(Lu=8518;Lu<=8529;Lu++)Nu[Lu]=2;for(Lu=8533;Lu<=8536;Lu++)Nu[Lu]=2;for(Lu=8538;Lu<=8540;Lu++)Nu[Lu]=2;for(Lu=8677;Lu<=8679;Lu++)Nu[Lu]=0;for(Lu=8836;Lu<=8840;Lu++)Nu[Lu]=0;for(Lu=8857;Lu<=8859;Lu++)Nu[Lu]=0;for(Lu=8908;Lu<=8910;Lu++)Nu[Lu]=0;for(Lu=9154;Lu<=9159;Lu++)Nu[Lu]=0;for(Lu=9205;Lu<=9218;Lu++)Nu[Lu]=0;for(Lu=9271;Lu<=9273;Lu++)Nu[Lu]=0;for(Lu=9295;Lu<=9297;Lu++)Nu[Lu]=0;for(Lu=9356;Lu<=9360;Lu++)Nu[Lu]=0;for(Lu=9404;Lu<=9407;Lu++)Nu[Lu]=0;for(Lu=9476;Lu<=9482;Lu++)Nu[Lu]=0;for(Lu=9487;Lu<=9494;Lu++)Nu[Lu]=0;for(Lu=9697;Lu<=9699;Lu++)Nu[Lu]=0;for(Lu=9821;Lu<=9865;Lu++)Nu[Lu]=0;for(Lu=10285;Lu<=10291;Lu++)Nu[Lu]=0;for(Lu=10314;Lu<=10317;Lu++)Nu[Lu]=0;for(Lu=10448;Lu<=10465;Lu++)Nu[Lu]=0;for(Lu=10731;Lu<=10733;Lu++)Nu[Lu]=0;for(Lu=11114;Lu<=11118;Lu++)Nu[Lu]=0;for(Lu=20004;Lu<=20032;Lu++)Nu[Lu]=0;for(Lu=20047;Lu<=20049;Lu++)Nu[Lu]=0;for(Lu=20062;Lu<=20092;Lu++)Nu[Lu]=0;for(Lu=20135;Lu<=20138;Lu++)Nu[Lu]=0;for(Lu=20248;Lu<=20258;Lu++)Nu[Lu]=0;for(Lu=20348;Lu<=20358;Lu++)Nu[Lu]=0;for(Lu=20436;Lu<=20440;Lu++)Nu[Lu]=0;for(Lu=20822;Lu<=20824;Lu++)Nu[Lu]=0;for(Lu=20904;Lu<=20932;Lu++)Nu[Lu]=0;for(Lu=20934;Lu<=20936;Lu++)Nu[Lu]=0;for(Lu=21004;Lu<=21032;Lu++)Nu[Lu]=0;for(Lu=21035;Lu<=21037;Lu++)Nu[Lu]=0;for(Lu=21095;Lu<=21097;Lu++)Nu[Lu]=0;for(Lu=21148;Lu<=21150;Lu++)Nu[Lu]=0;for(Lu=21207;Lu<=21264;Lu++)Nu[Lu]=0;for(Lu=21307;Lu<=21364;Lu++)Nu[Lu]=0;for(Lu=21413;Lu<=21423;Lu++)Nu[Lu]=0;for(Lu=21453;Lu<=21463;Lu++)Nu[Lu]=0;for(Lu=21473;Lu<=21483;Lu++)Nu[Lu]=0;for(Lu=21780;Lu<=21782;Lu++)Nu[Lu]=0;for(Lu=21891;Lu<=21894;Lu++)Nu[Lu]=0;for(Lu=21896;Lu<=21899;Lu++)Nu[Lu]=0;for(Lu=22171;Lu<=22177;Lu++)Nu[Lu]=0;for(Lu=22181;Lu<=22187;Lu++)Nu[Lu]=0;for(Lu=22191;Lu<=22197;Lu++)Nu[Lu]=0;for(Lu=22207;Lu<=22222;Lu++)Nu[Lu]=0;for(Lu=22229;Lu<=22232;Lu++)Nu[Lu]=0;for(Lu=22234;Lu<=22236;Lu++)Nu[Lu]=0;for(Lu=22243;Lu<=22250;Lu++)Nu[Lu]=0;for(Lu=22262;Lu<=22265;Lu++)Nu[Lu]=0;for(Lu=22307;Lu<=22322;Lu++)Nu[Lu]=0;for(Lu=22348;Lu<=22357;Lu++)Nu[Lu]=0;for(Lu=22407;Lu<=22422;Lu++)Nu[Lu]=0;for(Lu=22462;Lu<=22465;Lu++)Nu[Lu]=0;for(Lu=22521;Lu<=22525;Lu++)Nu[Lu]=0;for(Lu=22607;Lu<=22622;Lu++)Nu[Lu]=0;for(Lu=22641;Lu<=22646;Lu++)Nu[Lu]=0;for(Lu=22648;Lu<=22657;Lu++)Nu[Lu]=0;for(Lu=22707;Lu<=22722;Lu++)Nu[Lu]=0;for(Lu=22762;Lu<=22765;Lu++)Nu[Lu]=0;for(Lu=22807;Lu<=22822;Lu++)Nu[Lu]=0;for(Lu=22991;Lu<=22994;Lu++)Nu[Lu]=0;for(Lu=23028;Lu<=23038;Lu++)Nu[Lu]=0;for(Lu=23301;Lu<=23333;Lu++)Nu[Lu]=2;for(Lu=23830;Lu<=23853;Lu++)Nu[Lu]=0;for(Lu=23866;Lu<=23872;Lu++)Nu[Lu]=0;for(Lu=23877;Lu<=23884;Lu++)Nu[Lu]=0;for(Lu=23886;Lu<=23894;Lu++)Nu[Lu]=0;for(Lu=23946;Lu<=23948;Lu++)Nu[Lu]=0;for(Lu=24311;Lu<=24313;Lu++)Nu[Lu]=0;for(Lu=24342;Lu<=24347;Lu++)Nu[Lu]=0;for(Lu=24370;Lu<=24374;Lu++)Nu[Lu]=10;for(Lu=24375;Lu<=24381;Lu++)Nu[Lu]=0;for(Lu=24718;Lu<=24721;Lu++)Nu[Lu]=0;for(Lu=24817;Lu<=24821;Lu++)Nu[Lu]=0;for(Lu=24877;Lu<=24882;Lu++)Nu[Lu]=0;for(Lu=24891;Lu<=24893;Lu++)Nu[Lu]=0;for(Lu=25391;Lu<=25395;Lu++)Nu[Lu]=0;for(Lu=25828;Lu<=25838;Lu++)Nu[Lu]=0;for(Lu=26191;Lu<=26195;Lu++)Nu[Lu]=0;for(Lu=26391;Lu<=26393;Lu++)Nu[Lu]=0;for(Lu=26701;Lu<=26722;Lu++)Nu[Lu]=0;for(Lu=26729;Lu<=26799;Lu++)Nu[Lu]=2;for(Lu=26801;Lu<=26803;Lu++)Nu[Lu]=2;for(Lu=26811;Lu<=26813;Lu++)Nu[Lu]=2;for(Lu=26847;Lu<=26870;Lu++)Nu[Lu]=2;for(Lu=26891;Lu<=26899;Lu++)Nu[Lu]=0;for(Lu=26901;Lu<=26923;Lu++)Nu[Lu]=0;for(Lu=26929;Lu<=26946;Lu++)Nu[Lu]=0;for(Lu=26948;Lu<=26998;Lu++)Nu[Lu]=0;for(Lu=27037;Lu<=27040;Lu++)Nu[Lu]=0;for(Lu=27205;Lu<=27232;Lu++)Nu[Lu]=0;for(Lu=27258;Lu<=27260;Lu++)Nu[Lu]=0;for(Lu=27391;Lu<=27398;Lu++)Nu[Lu]=0;for(Lu=27561;Lu<=27564;Lu++)Nu[Lu]=0;for(Lu=27571;Lu<=27574;Lu++)Nu[Lu]=0;for(Lu=27581;Lu<=27584;Lu++)Nu[Lu]=0;for(Lu=27591;Lu<=27594;Lu++)Nu[Lu]=0;for(Lu=27700;Lu<=27707;Lu++)Nu[Lu]=0;for(Lu=28191;Lu<=28193;Lu++)Nu[Lu]=0;for(Lu=28348;Lu<=28358;Lu++)Nu[Lu]=0;for(Lu=28402;Lu<=28432;Lu++)Nu[Lu]=0;for(Lu=28462;Lu<=28492;Lu++)Nu[Lu]=0;for(Lu=29118;Lu<=29122;Lu++)Nu[Lu]=0;for(Lu=29168;Lu<=29172;Lu++)Nu[Lu]=0;for(Lu=29177;Lu<=29185;Lu++)Nu[Lu]=0;for(Lu=29187;Lu<=29195;Lu++)Nu[Lu]=0;for(Lu=29900;Lu<=29903;Lu++)Nu[Lu]=0;for(Lu=30161;Lu<=30179;Lu++)Nu[Lu]=0;for(Lu=30491;Lu<=30494;Lu++)Nu[Lu]=0;for(Lu=30729;Lu<=30732;Lu++)Nu[Lu]=0;for(Lu=31251;Lu<=31259;Lu++)Nu[Lu]=0;for(Lu=31265;Lu<=31268;Lu++)Nu[Lu]=0;for(Lu=31275;Lu<=31279;Lu++)Nu[Lu]=0;for(Lu=31281;Lu<=31297;Lu++)Nu[Lu]=0;for(Lu=31461;Lu<=31469;Lu++)Nu[Lu]=0;for(Lu=31491;Lu<=31495;Lu++)Nu[Lu]=0;for(Lu=31917;Lu<=31922;Lu++)Nu[Lu]=0;for(Lu=31965;Lu<=32e3;Lu++)Nu[Lu]=0;for(Lu=32001;Lu<=32003;Lu++)Nu[Lu]=2;for(Lu=32005;Lu<=32031;Lu++)Nu[Lu]=2;for(Lu=32033;Lu<=32060;Lu++)Nu[Lu]=2;for(Lu=32064;Lu<=32067;Lu++)Nu[Lu]=2;for(Lu=32074;Lu<=32077;Lu++)Nu[Lu]=2;for(Lu=32081;Lu<=32086;Lu++)Nu[Lu]=0;for(Lu=32107;Lu<=32130;Lu++)Nu[Lu]=0;for(Lu=32133;Lu<=32159;Lu++)Nu[Lu]=0;for(Lu=32164;Lu<=32167;Lu++)Nu[Lu]=2;for(Lu=32180;Lu<=32199;Lu++)Nu[Lu]=0;for(Lu=32201;Lu<=32260;Lu++)Nu[Lu]=0;for(Lu=32301;Lu<=32360;Lu++)Nu[Lu]=0;for(Lu=32401;Lu<=32460;Lu++)Nu[Lu]=0;for(Lu=32501;Lu<=32560;Lu++)Nu[Lu]=0;for(Lu=32601;Lu<=32662;Lu++)Nu[Lu]=0;for(Lu=32664;Lu<=32667;Lu++)Nu[Lu]=2;for(Lu=32701;Lu<=32761;Lu++)Nu[Lu]=0;for(Lu=53001;Lu<=53004;Lu++)Nu[Lu]=0;for(Lu=53008;Lu<=53019;Lu++)Nu[Lu]=0;for(Lu=53021;Lu<=53032;Lu++)Nu[Lu]=0;for(Lu=53034;Lu<=53037;Lu++)Nu[Lu]=0;for(Lu=53042;Lu<=53046;Lu++)Nu[Lu]=0;for(Lu=53074;Lu<=53080;Lu++)Nu[Lu]=0;for(Lu=54001;Lu<=54004;Lu++)Nu[Lu]=0;for(Lu=54008;Lu<=54019;Lu++)Nu[Lu]=0;for(Lu=54021;Lu<=54032;Lu++)Nu[Lu]=0;for(Lu=54034;Lu<=54037;Lu++)Nu[Lu]=0;for(Lu=54042;Lu<=54046;Lu++)Nu[Lu]=0;for(Lu=54048;Lu<=54053;Lu++)Nu[Lu]=0;for(Lu=54074;Lu<=54080;Lu++)Nu[Lu]=0;for(Lu=54098;Lu<=54101;Lu++)Nu[Lu]=0;for(Lu=102001;Lu<=102040;Lu++)Nu[Lu]=0;for(Lu=102042;Lu<=102063;Lu++)Nu[Lu]=0;for(Lu=102065;Lu<=102067;Lu++)Nu[Lu]=0;for(Lu=102070;Lu<=102117;Lu++)Nu[Lu]=0;for(Lu=102122;Lu<=102216;Lu++)Nu[Lu]=0;for(Lu=102221;Lu<=102377;Lu++)Nu[Lu]=0;for(Lu=102382;Lu<=102388;Lu++)Nu[Lu]=0;for(Lu=102389;Lu<=102398;Lu++)Nu[Lu]=2;for(Lu=102399;Lu<=102444;Lu++)Nu[Lu]=0;for(Lu=102445;Lu<=102447;Lu++)Nu[Lu]=2;for(Lu=102448;Lu<=102458;Lu++)Nu[Lu]=0;for(Lu=102459;Lu<=102468;Lu++)Nu[Lu]=2;for(Lu=102469;Lu<=102499;Lu++)Nu[Lu]=0;for(Lu=102500;Lu<=102519;Lu++)Nu[Lu]=1;for(Lu=102520;Lu<=102524;Lu++)Nu[Lu]=0;for(Lu=102525;Lu<=102529;Lu++)Nu[Lu]=2;for(Lu=102530;Lu<=102588;Lu++)Nu[Lu]=0;for(Lu=102590;Lu<=102598;Lu++)Nu[Lu]=0;for(Lu=102601;Lu<=102603;Lu++)Nu[Lu]=0;for(Lu=102605;Lu<=102628;Lu++)Nu[Lu]=0;for(Lu=102629;Lu<=102646;Lu++)Nu[Lu]=2;for(Lu=102648;Lu<=102700;Lu++)Nu[Lu]=2;for(Lu=102701;Lu<=102703;Lu++)Nu[Lu]=0;for(Lu=102707;Lu<=102730;Lu++)Nu[Lu]=2;for(Lu=102733;Lu<=102758;Lu++)Nu[Lu]=2;for(Lu=102767;Lu<=102900;Lu++)Nu[Lu]=0;for(Lu=102901;Lu<=102933;Lu++)Nu[Lu]=2;for(Lu=102934;Lu<=102950;Lu++)Nu[Lu]=13;for(Lu=102951;Lu<=102963;Lu++)Nu[Lu]=0;for(Lu=102965;Lu<=102969;Lu++)Nu[Lu]=0;for(Lu=102971;Lu<=102973;Lu++)Nu[Lu]=0;for(Lu=102975;Lu<=102989;Lu++)Nu[Lu]=0;for(Lu=102990;Lu<=102992;Lu++)Nu[Lu]=1;for(Lu=102997;Lu<=103002;Lu++)Nu[Lu]=0;for(Lu=103003;Lu<=103008;Lu++)Nu[Lu]=2;for(Lu=103009;Lu<=103011;Lu++)Nu[Lu]=0;for(Lu=103012;Lu<=103014;Lu++)Nu[Lu]=2;for(Lu=103019;Lu<=103021;Lu++)Nu[Lu]=0;for(Lu=103022;Lu<=103024;Lu++)Nu[Lu]=2;for(Lu=103029;Lu<=103031;Lu++)Nu[Lu]=0;for(Lu=103032;Lu<=103034;Lu++)Nu[Lu]=2;for(Lu=103065;Lu<=103068;Lu++)Nu[Lu]=0;for(Lu=103074;Lu<=103076;Lu++)Nu[Lu]=0;for(Lu=103077;Lu<=103079;Lu++)Nu[Lu]=1;for(Lu=103080;Lu<=103082;Lu++)Nu[Lu]=0;for(Lu=103083;Lu<=103085;Lu++)Nu[Lu]=2;for(Lu=103090;Lu<=103093;Lu++)Nu[Lu]=0;for(Lu=103097;Lu<=103099;Lu++)Nu[Lu]=0;for(Lu=103100;Lu<=103102;Lu++)Nu[Lu]=2;for(Lu=103107;Lu<=103109;Lu++)Nu[Lu]=0;for(Lu=103110;Lu<=103112;Lu++)Nu[Lu]=2;for(Lu=103113;Lu<=103116;Lu++)Nu[Lu]=0;for(Lu=103117;Lu<=103120;Lu++)Nu[Lu]=2;for(Lu=103153;Lu<=103157;Lu++)Nu[Lu]=0;for(Lu=103158;Lu<=103162;Lu++)Nu[Lu]=2;for(Lu=103163;Lu<=103165;Lu++)Nu[Lu]=0;for(Lu=103166;Lu<=103168;Lu++)Nu[Lu]=1;for(Lu=103169;Lu<=103171;Lu++)Nu[Lu]=2;for(Lu=103186;Lu<=103188;Lu++)Nu[Lu]=0;for(Lu=103189;Lu<=103191;Lu++)Nu[Lu]=2;for(Lu=103192;Lu<=103195;Lu++)Nu[Lu]=0;for(Lu=103196;Lu<=103199;Lu++)Nu[Lu]=2;for(Lu=103200;Lu<=103224;Lu++)Nu[Lu]=0;for(Lu=103225;Lu<=103227;Lu++)Nu[Lu]=1;for(Lu=103232;Lu<=103237;Lu++)Nu[Lu]=0;for(Lu=103238;Lu<=103243;Lu++)Nu[Lu]=2;for(Lu=103244;Lu<=103246;Lu++)Nu[Lu]=0;for(Lu=103247;Lu<=103249;Lu++)Nu[Lu]=2;for(Lu=103254;Lu<=103256;Lu++)Nu[Lu]=0;for(Lu=103257;Lu<=103259;Lu++)Nu[Lu]=2;for(Lu=103264;Lu<=103266;Lu++)Nu[Lu]=0;for(Lu=103267;Lu<=103269;Lu++)Nu[Lu]=2;for(Lu=103300;Lu<=103375;Lu++)Nu[Lu]=0;for(Lu=103381;Lu<=103383;Lu++)Nu[Lu]=0;for(Lu=103384;Lu<=103386;Lu++)Nu[Lu]=1;for(Lu=103387;Lu<=103389;Lu++)Nu[Lu]=0;for(Lu=103390;Lu<=103392;Lu++)Nu[Lu]=2;for(Lu=103397;Lu<=103399;Lu++)Nu[Lu]=0;for(Lu=103400;Lu<=103471;Lu++)Nu[Lu]=2;for(Lu=103476;Lu<=103478;Lu++)Nu[Lu]=0;for(Lu=103479;Lu<=103481;Lu++)Nu[Lu]=2;for(Lu=103486;Lu<=103488;Lu++)Nu[Lu]=0;for(Lu=103489;Lu<=103491;Lu++)Nu[Lu]=2;for(Lu=103492;Lu<=103495;Lu++)Nu[Lu]=0;for(Lu=103496;Lu<=103499;Lu++)Nu[Lu]=2;for(Lu=103528;Lu<=103543;Lu++)Nu[Lu]=0;for(Lu=103544;Lu<=103548;Lu++)Nu[Lu]=2;for(Lu=103549;Lu<=103551;Lu++)Nu[Lu]=0;for(Lu=103552;Lu<=103554;Lu++)Nu[Lu]=1;for(Lu=103555;Lu<=103557;Lu++)Nu[Lu]=2;for(Lu=103558;Lu<=103560;Lu++)Nu[Lu]=0;for(Lu=103571;Lu<=103573;Lu++)Nu[Lu]=0;for(Lu=103574;Lu<=103576;Lu++)Nu[Lu]=2;for(Lu=103577;Lu<=103580;Lu++)Nu[Lu]=0;for(Lu=103581;Lu<=103583;Lu++)Nu[Lu]=2;for(Lu=103595;Lu<=103694;Lu++)Nu[Lu]=0;for(Lu=103696;Lu<=103699;Lu++)Nu[Lu]=0;for(Lu=103700;Lu<=103793;Lu++)Nu[Lu]=2;for(Lu=103794;Lu<=103890;Lu++)Nu[Lu]=0;for(Lu=103891;Lu<=103896;Lu++)Nu[Lu]=2;for(Lu=103900;Lu<=103971;Lu++)Nu[Lu]=2;for(Lu=103972;Lu<=103977;Lu++)Nu[Lu]=0;for(Lu=112e3;Lu<=112101;Lu++)Nu[Lu]=0;const Pu=[102100,102113,3857,3785,900913],Fu=[104905,104971],Du=[4326,...Pu,...Fu],$u=[-20037508.342788905,20037508.342788905],zu=[-20037508.342787,20037508.342787],Uu={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:$u,origin:zu,dx:1e-5},Bu={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:$u,origin:zu,dx:1e-5},102100:Uu,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:$u,origin:zu,dx:1e-5},3857:Uu,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:Uu};function Gu(t,e){if(t===e)return!0;if(null==t||null==e)return!1;const i=t.wkid,n=e.wkid;if(null!=i||null!=n){if(i===n)return!0;if(Ku(t)&&Ku(e))return!0;const s=t.latestWkid;if(null!=s&&n===s)return!0;const r=e.latestWkid;return null!=r&&i===r}let s,r;return t.wkt2&&e.wkt2?(s=t.wkt2,r=e.wkt2):t.wkt&&e.wkt&&(s=t.wkt,r=e.wkt),!(!s||!r)&&s.toUpperCase()===r.toUpperCase()}function Vu(t){const e=t?.wkid;return null!=e&&e>=2e3&&Bu[e]||null}function qu(t){if(!t)return;const{wkid:e,vcsWkid:i}=t;if(e)return i?JSON.stringify({wkid:e,vcsWkid:i}):String(e);const n=t.wkt||t.wkt2;return JSON.stringify(n?i?{wkt:n,vcsWkid:i}:{wkt:n}:{})}function Hu(t){if(!sc(t))return!1;const{wkid:e}=t;if(e)return null==Nu[e];const i=t.wkt2||t.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function Wu(t){return!(tc(t)||ic(t))}function Zu(t){return 4326===t?.wkid}function Ju(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function Yu(t){return t?.wkid===Ru.CGCS2000}function Ku(t){const e=t?.wkid;return null!=e&&e>=2e3&&Pu.includes(e)}function Qu(t){return 32662===t?.wkid}function Xu(t){return t===Ru.GCSMARS2000||t===Ru.GCSMARS2000_SPHERE}function tc(t){return Xu(t?.wkid)}function ec(t){return t===Ru.GCSMOON2000}function ic(t){return ec(t?.wkid)}function nc(t){const e=t?.wkid;return null!=e&&e>=2e3&&Du.includes(e)}function sc(t){if(null==t)return!1;const e=t.wkid;return null!=e&&e>=2e3||(null!=t.wkt2||null!=t.wkt)}const rc={wkid:4326,wkt:Mt(Bu[4326].wkTemplate,{Central_Meridian:"0.0"})},oc={wkid:102100,latestWkid:3857},ac={wkid:32662};function lc(t){return{wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${t.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`}}const uc=lc(Lo),cc=lc(No),hc=lc(Po),dc={wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${Lo.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`},fc=cc.wkt.toUpperCase(),pc=hc.wkt.toUpperCase();function mc(t){if(null!=t&&sc(t)){const e=t.wkid,i=t.wkt2??t.wkt;if(Xu(e))return No;const n=i?.toUpperCase();if(i&&n===fc)return No;if(ec(e)||n&&n===pc)return Po}return Lo}function yc(t){return Xu(t)?No:ec(t)?Po:Lo}function gc(t){return Gu(t,uc)}function vc(t){return gc(t)||Gu(t,cc)||Gu(t,hc)}const wc=39.37,bc=Lo.radius*Math.PI/200,Sc=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,_c=Nu,xc=/UNIT\[([^\]]+)]/i,Mc=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),Tc=Oo()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain:"chains",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),Ac=t=>t*t,Ic=t=>t*t*t,kc={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937},"clarke-feet":{inBaseUnits:.3047972654},"clarke-yards":{inBaseUnits:.9143917962},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"gold-coast-feet":{inBaseUnits:.3047997101815088},chains:{inBaseUnits:20.1168},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Ac(.001)},"square-centimeters":{inBaseUnits:Ac(.01)},"square-decimeters":{inBaseUnits:Ac(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Ac(1e3)},"square-inches":{inBaseUnits:Ac(.0254)},"square-feet":{inBaseUnits:Ac(.3048)},"square-yards":{inBaseUnits:Ac(.9144)},"square-miles":{inBaseUnits:Ac(1609.344)},"square-us-feet":{inBaseUnits:Ac(1200/3937)},acres:{inBaseUnits:.0015625*Ac(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Ic(.001)},"cubic-centimeters":{inBaseUnits:1e3*Ic(.01)},"cubic-decimeters":{inBaseUnits:1e3*Ic(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Ic(1e3)},"cubic-inches":{inBaseUnits:1e3*Ic(.0254)},"cubic-feet":{inBaseUnits:1e3*Ic(.3048)},"cubic-yards":{inBaseUnits:1e3*Ic(.9144)},"cubic-miles":{inBaseUnits:1e3*Ic(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},Cc=(()=>{const t={};for(const e in kc)for(const i in kc[e].units)t[i]=e;return t})();function Ec(t,e,i){return t*kc[i].units[e].inBaseUnits}function jc(t,e,i){return t/kc[i].units[e].inBaseUnits}const Oc=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],Rc=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function Lc(t){const e=Cc[t];if(!e)throw new Error("unknown type");return e}function Nc(t,e=null){return e=e||Lc(t),kc[e].baseUnit===t}function Pc(t,e,i){if(e===i)return t;const n=Lc(e);if(n!==Lc(i))throw new Error("incompatible units");const s=Nc(e,n)?t:Ec(t,e,n);return Nc(i,n)?s:jc(s,i,n)}function Fc(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function Dc(t){return Fc(t)}function $c(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function zc(t,e){const i=Pc(t,e,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function Uc(t,e){const i=Pc(t,e,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function Bc(t,e){const i=Pc(t,e,"feet");return Math.abs(i)<1e3?"feet":"miles"}function Gc(t,e){const i=Pc(t,e,"feet");return Math.abs(i)<1e5?"feet":"miles"}function Vc(t,e){const i=Pc(t,e,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function qc(t,e){const i=Pc(t,e,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function Hc(t,e,i){return Pc(t,e,"meters")/(i*Math.PI/180)}function Wc(t){return Tc.fromJSON(t.toLowerCase())||null}function Zc(t){if(null!=t&&!Wu(t))return 1;const e=Yc(t);return e>1e5?1:e}function Jc(t){return Yc(t)>=mc(t).metersPerDegree?"meters":eh(t)}function Yc(t,e=Lo.metersPerDegree){return Kc(t,!0)??e}function Kc(t,e=!1){const i=t?.wkid??null,n=t?.wkt2??t?.wkt??null;let s=null;if(i){if(Xu(i))return No.metersPerDegree;if(ec(i))return Po.metersPerDegree;s=_c.values[_c[i]],!s&&e&&Mc.has(i)&&(s=bc)}else n&&(oh(n)?s=Xc(Sc.exec(n),s):rh(n)&&(s=Xc(xc.exec(n),s)));return s}function Qc(t){return Hu(t)?1:Yc(t)}function Xc(t,e){return t?.[1]?th(t[1]):e}function th(t){return parseFloat(t.split(",")[1])}function eh(t){const e=t?.wkid??null,i=t?.wkt2??t?.wkt??null;let n=null;if(e)n=_c.units[_c[e]];else if(i){const t=oh(i)?Sc:rh(i)?xc:null;if(t){const e=t.exec(i);e?.[1]&&(n=lh(e[1]))}}return null!=n?Wc(n):null}function ih(t){const e=eh(t);return null!=e&&Oc.includes(e)?e:null}function nh(t){const e=Jc(t);return null!=e&&Oc.includes(e)?e:null}function sh(t){const e=eh(t);return null==e?null:Rc.get(e)}function rh(t){return/^GEOCCS/i.test(t)}function oh(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const ah=1e-7;function lh(t){const e=/[\\"']{1}([^\\"']+)/.exec(t);let i=e?.[1];if(!i||!_c.units.includes(i)){const e=th(t);i=null;const n=_c.values;for(let t=0;t<n.length;++t)if(Math.abs(e-n[t])<ah){i=_c.units[t];break}}return i}function uh(t){const e=eh(t);if(null==e)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"chains":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}const ch={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},hh={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},dh={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},fh=Oo()(ch),ph=Oo()(hh),mh=Oo()(dh);function yh(t,e,i){let n,s;return void 0===e?(s=t,n=[void 0]):"string"!=typeof e?(s=t,n=[void 0],i=e):(s=e,n=Array.isArray(t)?t:[t]),(t,e)=>{const r=t.constructor.prototype;for(const o of n){const n=Ye(t,o,s);n.write&&"object"==typeof n.write||(n.write={}),i&&(n.write.target=i),n.write.writer=r[e]}}}var gh;let vh=gh=class extends Io{static fromJSON(t){if(!t)return null;if(102100===t?.wkid)return gh.WebMercator;if(4326===t?.wkid)return gh.WGS84;const e=new gh;return e.read(t),e}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){if(t&&"object"==typeof t)return t;const e="string"==typeof t?"wkt":"wkid";return{[e]:t}}get isWGS84(){return Zu(this)}get isWebMercator(){return Ku(this)}get isGeographic(){return Hu(this)}get isWrappable(){return nc(this)}get metersPerUnit(){return Yc(this)}get unit(){return eh(this)||(this.isGeographic?"degrees":null)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===gh.WGS84)return new gh(rc);if(this===gh.WebMercator)return new gh(oc);const t=new gh;return null!=this.wkid?(t.wkid=this.wkid,null!=this.latestWkid&&(t.latestWkid=this.latestWkid),null!=this.vcsWkid&&(t.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(t.latestVcsWkid=this.latestVcsWkid)):(null!=this.wkt&&(t.wkt=this.wkt),null!=this.wkt2&&(t.wkt2=this.wkt2)),this.imageCoordinateSystem&&(t.imageCoordinateSystem=nt(this.imageCoordinateSystem)),t}equals(t){if(null==t)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==t.imageCoordinateSystem)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:n}=t.imageCoordinateSystem,s=this.imageCoordinateSystem;return null==e||n?JSON.stringify(s)===JSON.stringify(t.imageCoordinateSystem):i?s.id===e&&s.referenceServiceName===i:s.id===e}return Gu(this,t)}toJSON(t){return this.write(void 0,t)}};vh.GCS_NAD_1927=null,vh.WGS84=null,vh.WebMercator=null,vh.PlateCarree=null,r([Je({readOnly:!0})],vh.prototype,"isWGS84",null),r([Je({readOnly:!0})],vh.prototype,"isWebMercator",null),r([Je({readOnly:!0})],vh.prototype,"isGeographic",null),r([Je({readOnly:!0})],vh.prototype,"isWrappable",null),r([Je({type:ce,json:{write:!0}})],vh.prototype,"latestWkid",void 0),r([Je({readOnly:!0})],vh.prototype,"metersPerUnit",null),r([Je({readOnly:!0})],vh.prototype,"unit",null),r([Je({type:ce,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null==this.wkt}}}}}}})],vh.prototype,"wkid",void 0),r([Je({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null==this.wkid}}}}}}})],vh.prototype,"wkt",void 0),r([yh("wkt"),yh("web-scene","wkt")],vh.prototype,"writeWkt",null),r([Je({type:String,json:{write:!1}})],vh.prototype,"wkt2",void 0),r([Je({type:ce,json:{write:!0}})],vh.prototype,"vcsWkid",void 0),r([Je({type:ce,json:{write:!0}})],vh.prototype,"latestVcsWkid",void 0),r([Je()],vh.prototype,"imageCoordinateSystem",void 0),vh=gh=r([ln("esri.geometry.SpatialReference")],vh),vh.prototype.toJSON.isDefaultToJSON=!0,vh.GCS_NAD_1927=ao.freeze(new vh({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),vh.WGS84=ao.freeze(new vh(rc)),vh.WebMercator=ao.freeze(new vh(oc)),vh.PlateCarree=ao.freeze(new vh(ac));const wh=vh;let bh=class extends Io{constructor(...t){super(...t),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=wh.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(t,e){if(t instanceof wh)return t;if(null!=t){const i=new wh;return i.read(t,e),i}return t}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(t){return this.cache[t]}setCacheValue(t,e){this.cache[t]=e}};r([Je()],bh.prototype,"type",void 0),r([Je({readOnly:!0})],bh.prototype,"cache",null),r([Je({readOnly:!0})],bh.prototype,"extent",null),r([Je({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],bh.prototype,"hasM",void 0),r([Je({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],bh.prototype,"hasZ",void 0),r([Je({type:wh,json:{write:!0},value:wh.WGS84})],bh.prototype,"spatialReference",void 0),r([ko("spatialReference")],bh.prototype,"readSpatialReference",null),bh=r([ln("esri.geometry.Geometry")],bh);const Sh=bh;const _h=Object.prototype.toString;function xh(t){const e="__accessorMetadata__"in t?ee(t):t;return function(...t){if(t.push(e),"number"==typeof t[2])throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Mh.apply(this,t)}}function Mh(t,e,i,n){De(t,e).cast=n}function Th(t){return(e,i)=>{De(e,t).cast=e[i]}}function Ah(...t){if(3!==t.length||"string"!=typeof t[1])return 1===t.length&&"[object Function]"===_h.call(t[0])?xh(t[0]):1===t.length&&"string"==typeof t[0]?Th(t[0]):void 0}const Ih=57.29577951308232,kh=.017453292519943;function Ch(t){return t*Ih}function Eh(t){return t*kh}function jh(t){return t/Lo.radius}function Oh(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Lo.radius))}function Rh(t){return null!=t.wkid||null!=t.wkt}const Lh=[0,0];function Nh(t,e,i,n,s){const r=t,o=s;if(o.spatialReference=i,"x"in r&&"x"in o)[o.x,o.y]=e(r.x,r.y,Lh,n);else if("xmin"in r&&"xmin"in o)[o.xmin,o.ymin]=e(r.xmin,r.ymin,Lh,n),[o.xmax,o.ymax]=e(r.xmax,r.ymax,Lh,n);else if("paths"in r&&"paths"in o||"rings"in r&&"rings"in o){const t="paths"in r?r.paths:r.rings,i=[];let s;for(let r=0;r<t.length;r++){const o=t[r];s=[],i.push(s);for(let t=0;t<o.length;t++)s.push(e(o[t][0],o[t][1],[0,0],n)),o[t].length>2&&s[t].push(o[t][2]),o[t].length>3&&s[t].push(o[t][3])}"paths"in o?o.paths=i:o.rings=i}else if("points"in r&&"points"in o){const t=r.points,i=[];for(let s=0;s<t.length;s++)i[s]=e(t[s][0],t[s][1],[0,0],n),t[s].length>2&&i[s].push(t[s][2]),t[s].length>3&&i[s].push(t[s][3]);o.points=i}return s}function Ph(t,e){const i=t&&(Rh(t)?t:t.spatialReference),n=e&&(Rh(e)?e:e.spatialReference);return!(t&&"type"in t&&"mesh"===t.type||e&&"type"in e&&"mesh"===e.type||!i||!n)&&(!!Gu(n,i)||(Ku(n)&&Zu(i)||Ku(i)&&Zu(n)))}function Fh(t,e){if(null==t)return null;const i=t.spatialReference,n=e&&(Rh(e)?e:e.spatialReference);return Ph(i,n)?Gu(i,n)?nt(t):Ku(n)?Nh(t,Dh,wh.WebMercator,!1,nt(t)):Zu(n)?Nh(t,$h,wh.WGS84,!1,nt(t)):null:null}function Dh(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const n=Eh(e);return i[0]=Eh(t)*Lo.radius,i[1]=Lo.halfSemiMajorAxis*Math.log((1+Math.sin(n))/(1-Math.sin(n))),i}function $h(t,e,i=[0,0],n=!1){if(t===$u[0])i[0]=-180;else if(t===$u[1])i[0]=180;else{const e=Ch(t/Lo.radius);i[0]=n?e:e-360*Math.floor((e+180)/360)}return i[1]=Ch(Math.PI/2-2*Math.atan(Math.exp(-e/Lo.radius))),i}function zh(t,e=!1,i=nt(t)){return Nh(t,Dh,wh.WebMercator,e,i)}function Uh(t,e=!1,i=nt(t)){return Nh(t,$h,wh.WGS84,e,i)}function Bh(t,e){const i=t.x-e.x,n=t.y-e.y,s=null!=t.z&&null!=e.z?t.z-e.z:0;return Math.sqrt(i*i+n*n+s*s)}function Gh(t){return qh(t,Hh)?.[0]??null}function Vh(t){return qh(t,Hh)?.[1]??null}function qh({x:t,y:e,spatialReference:i},n=[0,0]){if(i){if(Ku(i))return $h(t,e,n);if(Hu(i))return n[0]=t,n[1]=e,n}return null}const Hh=[0,0];var Wh;const Zh=[0,0];function Jh(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}let Yh=Wh=class extends Sh{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",ao.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,n,s){let r;if(Array.isArray(t))r=t,s=e,t=r[0],e=r[1],i=r[2],n=r[3];else if(t&&"object"==typeof t){if(r=t,t=null!=r.x?r.x:r.longitude,e=null!=r.y?r.y:r.latitude,i=r.z,n=r.m,(s=r.spatialReference)&&"esri.geometry.SpatialReference"!==s.declaredClass&&(s=new wh(s)),null!=r.longitude||null!=r.latitude)if(null==r.longitude)jt.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(null==r.latitude)jt.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!r.declaredClass&&s?.isWebMercator){const i=Dh(r.longitude,r.latitude,Zh);t=i[0],e=i[1]}}else Jh(i)?(s=i,i=null):Jh(n)&&(s=n,n=null);const o={x:t,y:e};return null==o.x&&null!=o.y?jt.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):null==o.y&&null!=o.x&&jt.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),null!=s&&(o.spatialReference=s),null!=i&&(o.z=i),null!=n&&(o.m=n),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return void 0!==this.m}set hasM(t){t!==(void 0!==this._get("m"))&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return void 0!==this.z}set hasZ(t){t!==(void 0!==this._get("z"))&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return Vh(this)}set latitude(t){const{spatialReference:e,x:i}=this;null!=t&&e&&(e.isWebMercator?this._set("y",Dh(i,t,Zh)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return Gh(this)}set longitude(t){const{y:e,spatialReference:i}=this;null!=t&&i&&(i.isWebMercator?this._set("x",Dh(t,e,Zh)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return"string"==typeof t?NaN:t}clone(){const t=new Wh;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return Wh.copy(t,this),this}equals(t){if(null==t)return!1;const{x:e,y:i,z:n,m:s,spatialReference:r}=this,{z:o,m:a}=t;let{x:l,y:u,spatialReference:c}=t;if(!r.equals(c))if(r.isWebMercator&&c.isWGS84)[l,u]=Dh(l,u),c=r;else{if(!r.isWGS84||!c.isWebMercator)return!1;[l,u]=$h(l,u),c=r}return e===l&&i===u&&n===o&&s===a&&r.wkid===c.wkid}offset(t,e,i){return this.x+=t,this.y+=e,null!=i&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=Vu(this.spatialReference);if(!t)return this;let e=this.x;const[i,n]=t.valid,s=2*n;let r;return e>n?(r=Math.ceil(Math.abs(e-n)/s),e-=r*s):e<i&&(r=Math.ceil(Math.abs(e-i)/s),e+=r*s),this._set("x",e),this}distance(t){return Bh(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};r([Je({readOnly:!0})],Yh.prototype,"cache",null),r([Je({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Yh.prototype,"hasM",null),r([Je({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Yh.prototype,"hasZ",null),r([Je({type:Number})],Yh.prototype,"latitude",null),r([Je({type:Number})],Yh.prototype,"longitude",null),r([Je({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Ah((t=>isNaN(t)?t:Ut(t)))],Yh.prototype,"x",void 0),r([yh("x")],Yh.prototype,"writeX",null),r([ko("x")],Yh.prototype,"readX",null),r([Je({type:Number,json:{write:!0}})],Yh.prototype,"y",void 0),r([Je({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Yh.prototype,"z",void 0),r([Je({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Yh.prototype,"m",void 0),Yh=Wh=r([ln("esri.geometry.Point")],Yh),Yh.prototype.toJSON.isDefaultToJSON=!0;const Kh=Yh;const Qh=[0,0];function Xh(t,e){return null!=e&&sd(t,e.x,e.y,e.z)}function td(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!id(t,i))return!1;return!0}function ed(t,e){const{xmin:i,ymin:n,zmin:s,xmax:r,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?sd(t,i,n,s)&&sd(t,i,o,s)&&sd(t,r,o,s)&&sd(t,r,n,s)&&sd(t,i,n,a)&&sd(t,i,o,a)&&sd(t,r,o,a)&&sd(t,r,n,a):sd(t,i,n)&&sd(t,i,o)&&sd(t,r,o)&&sd(t,r,n)}function id(t,e){return sd(t,e[0],e[1])}function nd(t,e){return sd(t,e[0],e[1],e[2])}function sd(t,e,i,n){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(null==n||!t.hasZ||n>=t.zmin&&n<=t.zmax)}function rd(t,e){return Qh[1]=e.y,Qh[0]=e.x,od(t,Qh)}function od(t,e){return ad(t.rings,e)}function ad(t,e){if(!t)return!1;if(ld(t))return ud(!1,t,e);let i=!1;for(let n=0,s=t.length;n<s;n++)i=ud(i,t[n],e);return i}function ld(t){return!Array.isArray(t[0][0])}function ud(t,e,i){const[n,s]=i;let r=t,o=0;for(let t=0,i=e.length;t<i;t++){o++,o===i&&(o=0);const[a,l]=e[t],[u,c]=e[o];(l<s&&c>=s||c<s&&l>=s)&&a+(s-l)/(c-l)*(u-a)<n&&(r=!r)}return r}function cd(t,e){return Xh(t,e)}function hd(t,e){const i=t.hasZ&&e.hasZ;let n,s,r;if(t.xmin<=e.xmin){if(n=e.xmin,t.xmax<n)return!1}else if(n=t.xmin,e.xmax<n)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(i&&e.hasZ)if(t.zmin<=e.zmin){if(r=e.zmin,t.zmax<r)return!1}else if(r=t.zmin,e.zmax<r)return!1;return!0}function dd(t,e){const{points:i,hasZ:n}=e,s=n?nd:id;for(const e of i)if(s(t,e))return!0;return!1}const fd=[0,0],pd=[0,0],md=[0,0],yd=[0,0],gd=[fd,pd,md,yd],vd=[[md,fd],[fd,pd],[pd,yd],[yd,md]];function wd(t,e){return bd(t,e.rings)}function bd(t,e){fd[0]=t.xmin,fd[1]=t.ymax,pd[0]=t.xmax,pd[1]=t.ymax,md[0]=t.xmin,md[1]=t.ymin,yd[0]=t.xmax,yd[1]=t.ymin;for(const t of gd)if(ad(e,t))return!0;for(const i of e){if(!i.length)continue;let e=i[0];if(id(t,e))return!0;for(let n=1;n<i.length;n++){const s=i[n];if(id(t,s)||Md(e,s,vd))return!0;e=s}}return!1}function Sd(t,e){fd[0]=t.xmin,fd[1]=t.ymax,pd[0]=t.xmax,pd[1]=t.ymax,md[0]=t.xmin,md[1]=t.ymin,yd[0]=t.xmax,yd[1]=t.ymin;const i=e.paths;for(const e of i){if(!i.length)continue;let n=e[0];if(id(t,n))return!0;for(let i=1;i<e.length;i++){const s=e[i];if(id(t,s)||Md(n,s,vd))return!0;n=s}}return!1}const _d=[0,0];function xd(t){for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<i.length-1;n++){const s=i[n],r=i[n+1];for(let i=e+1;i<t.length;i++)for(let e=0;e<t[i].length-1;e++){const n=t[i][e],o=t[i][e+1];if(Td(s,r,n,o,_d)&&!(_d[0]===s[0]&&_d[1]===s[1]||_d[0]===n[0]&&_d[1]===n[1]||_d[0]===r[0]&&_d[1]===r[1]||_d[0]===o[0]&&_d[1]===o[1]))return!0}}const n=i.length;if(!(n<=4))for(let t=0;t<n-3;t++){let e=n-1;0===t&&(e=n-2);const s=i[t],r=i[t+1];for(let n=t+2;n<e;n++){const t=i[n],e=i[n+1];if(Td(s,r,t,e,_d)&&!(_d[0]===s[0]&&_d[1]===s[1]||_d[0]===t[0]&&_d[1]===t[1]||_d[0]===r[0]&&_d[1]===r[1]||_d[0]===e[0]&&_d[1]===e[1]))return!0}}}return!1}function Md(t,e,i){for(let n=0;n<i.length;n++)if(Td(t,e,i[n][0],i[n][1]))return!0;return!1}function Td(t,e,i,n,s){const[r,o]=t,[a,l]=e,[u,c]=i,[h,d]=n,f=h-u,p=r-u,m=a-r,y=d-c,g=o-c,v=l-o,w=y*m-f*v;if(0===w)return!1;const b=(f*g-y*p)/w,S=(m*g-v*p)/w;return b>=0&&b<=1&&S>=0&&S<=1&&(s&&(s[0]=r+b*(a-r),s[1]=o+b*(l-o)),!0)}function Ad(t){switch(t){case"esriGeometryEnvelope":case"extent":return hd;case"esriGeometryMultipoint":case"multipoint":return dd;case"esriGeometryPoint":case"point":return cd;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return wd;case"esriGeometryPolyline":case"polyline":return Sd}}var Id;function kd(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}function Cd(t,e,i){return null==e?i:null==i?e:t(e,i)}let Ed=Id=class extends Sh{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,n,s){return kd(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:"object"==typeof t?(t.spatialReference=null==t.spatialReference?wh.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:n,spatialReference:s??wh.WGS84}}static fromBounds(t,e){return new Id({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}static fromPoint(t){return new Id({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new Kh({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return null!=this.mmin&&null!=this.mmax}get hasZ(){return null!=this.zmin&&null!=this.zmax}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return null!=t.z&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Id;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,null!=this.zmin&&(t.zmin=this.zmin,t.zmax=this.zmax),null!=this.mmin&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Ph(e,i)&&(t=e.isWebMercator?zh(t):Uh(t,!0)),"point"===t.type?Xh(this,t):"extent"===t.type&&ed(this,t)}equals(t){if(this===t)return!0;if(null==t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Ph(e,i)&&(t=e.isWebMercator?zh(t):Uh(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,n=this.height*e;if(this.xmin+=i,this.ymin+=n,this.xmax-=i,this.ymax-=n,this.hasZ){const t=(this.zmax-this.zmin)*e;this.zmin+=t,this.zmax-=t}if(this.hasM){const t=(this.mmax-this.mmin)*e;this.mmin+=t,this.mmax-=t}return this}intersects(t){if(null==t)return!1;"mesh"===t.type&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;e&&i&&!Gu(e,i)&&Ph(e,i)&&(t=e.isWebMercator?zh(t):Uh(t,!0));return Ad(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,null!=i&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Cd(Math.min,this.zmin,t.zmin),this.zmax=Cd(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Cd(Math.min,this.mmin,t.mmin),this.mmax=Cd(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:null!=t&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Cd(Math.max,this.zmin,t.zmin),this.zmax=Cd(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Cd(Math.max,this.mmin,t.mmin),this.mmax=Cd(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=Vu(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const n=e.isWebMercator?Uh(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(n.x=jd(n.x,t).x),this.spatialReference=new wh(Mt((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:n.x}))}return this}_getCM(t){let e=null;const[i,n]=t.valid,s=this.xmin,r=this.xmax;return s>=i&&s<=n&&(r>=i&&r<=n)||(e=this.center),e}_normalize(t,e,i){const n=this.spatialReference;if(!n)return this;const s=i??Vu(n);if(null==s)return this;const r=this._getParts(s).map((t=>t.extent));if(r.length<2)return r[0]||this;if(r.length>2)return t?this._shiftCM(s):this.set({xmin:s.valid[0],xmax:s.valid[1]});if(t)return this._shiftCM(s);if(e)return r;let o=!0,a=!0;return r.forEach((t=>{t.hasZ||(o=!1),t.hasM||(a=!1)})),{rings:r.map((t=>{const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(o){const i=(t.zmax-t.zmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}if(a){const i=(t.mmax-t.mmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}return e})),hasZ:o,hasM:a,spatialReference:n}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:n,spatialReference:s}=this,r=this.width,o=this.xmin,a=this.xmax;let l;t=t||Vu(s);const[u,c]=t.valid;l=jd(this.xmin,t);const h=l.x,d=l.frameId;l=jd(this.xmax,t);const f=l.x,p=l.frameId,m=h===f&&r>0;if(r>2*c){const t=new Id(o<a?h:f,i,c,n,s),r=new Id(u,i,o<a?f:h,n,s),l=new Id(0,i,c,n,s),m=new Id(u,i,0,n,s),y=[],g=[];t.contains(l)&&y.push(d),t.contains(m)&&g.push(d),r.contains(l)&&y.push(p),r.contains(m)&&g.push(p);for(let t=d+1;t<p;t++)y.push(t),g.push(t);e.push({extent:t,frameIds:[d]},{extent:r,frameIds:[p]},{extent:l,frameIds:y},{extent:m,frameIds:g})}else h>f||m?e.push({extent:new Id(h,i,c,n,s),frameIds:[d]},{extent:new Id(u,i,f,n,s),frameIds:[p]}):e.push({extent:new Id(h,i,f,n,s),frameIds:[d]});this.cache._parts=e}const i=this.hasZ,n=this.hasM;if(i||n){const t={};i&&(t.zmin=this.zmin,t.zmax=this.zmax),n&&(t.mmin=this.mmin,t.mmax=this.mmax);for(let i=0;i<e.length;i++)e[i].extent.set(t)}return e}};function jd(t,e){const[i,n]=e.valid,s=2*n;let r,o=0;return t>n?(r=Math.ceil(Math.abs(t-n)/s),t-=r*s,o=r):t<i&&(r=Math.ceil(Math.abs(t-i)/s),t+=r*s,o=-r),{x:t,frameId:o}}r([Je({readOnly:!0})],Ed.prototype,"cache",null),r([Je({readOnly:!0})],Ed.prototype,"center",null),r([Je({readOnly:!0})],Ed.prototype,"extent",null),r([Je({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Ed.prototype,"hasM",null),r([Je({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Ed.prototype,"hasZ",null),r([Je({readOnly:!0})],Ed.prototype,"height",null),r([Je({readOnly:!0})],Ed.prototype,"width",null),r([Je({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Ed.prototype,"xmin",void 0),r([Je({type:Number,json:{write:!0}})],Ed.prototype,"ymin",void 0),r([Je({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Ed.prototype,"mmin",void 0),r([Je({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Ed.prototype,"zmin",void 0),r([Je({type:Number,json:{write:!0}})],Ed.prototype,"xmax",void 0),r([Je({type:Number,json:{write:!0}})],Ed.prototype,"ymax",void 0),r([Je({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Ed.prototype,"mmax",void 0),r([Je({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Ed.prototype,"zmax",void 0),Ed=Id=r([ln("esri.geometry.Extent")],Ed),Ed.prototype.toJSON.isDefaultToJSON=!0;const Od=Ed;function Rd(t,e,i=!1){let{hasM:n,hasZ:s}=t;Array.isArray(e)?4!==e.length||n||s?3===e.length&&i&&!n?(s=!0,n=!1):3===e.length&&n&&s&&(n=!1,s=!1):(n=!0,s=!0):(s=!s&&e.hasZ&&(!n||e.hasM),n=!n&&e.hasM&&(!s||e.hasZ)),t.hasZ=s,t.hasM=n}var Ld;function Nd(t){return(e,i)=>null==e?i:null==i?e:t(e,i)}function Pd(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}let Fd=Ld=class extends Sh{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){if(!t&&!e)return{};const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):Pd(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const n=i.points?.[0];return n&&(void 0===i.hasZ&&void 0===i.hasM?(i.hasZ=n.length>2,i.hasM=!1):void 0===i.hasZ?i.hasZ=n.length>3:void 0===i.hasM&&(i.hasM=n.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new Od,i=this.hasZ,n=this.hasM,s=i?3:2,r=t[0],o=Nd(Math.min),a=Nd(Math.max);let l,u,c,h,[d,f]=r,[p,m]=r;for(let e=0,r=t.length;e<r;e++){const r=t[e],[y,g]=r;if(d=o(d,y),f=o(f,g),p=a(p,y),m=a(m,g),i&&r.length>2){const t=r[2];l=o(l,t),c=a(c,t)}if(n&&r.length>s){const t=r[s];u=o(u,t),h=a(h,t)}}return e.xmin=d,e.ymin=f,e.xmax=p,e.ymax=m,e.spatialReference=this.spatialReference,i?(e.zmin=l,e.zmax=c):(e.zmin=void 0,e.zmax=void 0),n?(e.mmin=u,e.mmax=h):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=nt(this.points)}addPoint(t){return Rd(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:nt(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new Ld(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let n=2;return this.hasZ&&(i.z=e[2],n=3),this.hasM&&(i.m=e[n]),new Kh(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new Kh(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(Rd(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return null!=t&&t>=0&&t<this.points.length}};r([Je({readOnly:!0})],Fd.prototype,"cache",null),r([Je()],Fd.prototype,"extent",null),r([Je({type:[[Number]],json:{write:{isRequired:!0}}})],Fd.prototype,"points",void 0),r([yh("points")],Fd.prototype,"writePoints",null),Fd=Ld=r([ln("esri.geometry.Multipoint")],Fd),Fd.prototype.toJSON.isDefaultToJSON=!0;const Dd=Fd;function $d(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function zd(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}var Ud;!function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"}(Ud||(Ud={}));function Bd(t,e){const i=e[0]-t[0],n=e[1]-t[1];if(t.length>2&&e.length>2){const s=t[2]-e[2];return Math.sqrt(i*i+n*n+s*s)}return Math.sqrt(i*i+n*n)}function Gd(t,e,i){const n=t[0]+i*(e[0]-t[0]),s=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[n,s,t[2]+i*(e[2]-t[2])]:[n,s]}function Vd(t,e,i,n){return qd(t,e,i[n],i[n+1])}function qd(t,e,i,n){const[s,r]=e,[o,a]=i,[l,u]=n,c=l-o,h=u-a,d=c*c+h*h,f=(s-o)*c+(r-a)*h,p=Math.min(1,Math.max(0,f/d));return t[0]=o+c*p,t[1]=a+h*p,t}function Hd(t,e,i,n,s,r){let o=i,a=n,l=s-o,u=r-a;if(0!==l||0!==u){const i=((t-o)*l+(e-a)*u)/(l*l+u*u);i>1?(o=s,a=r):i>0&&(o+=l*i,a+=u*i)}return l=t-o,u=e-a,l*l+u*u}function Wd(t,e){return Gd(t,e,.5)}function Zd(t){const e=t.length;let i=0;for(let n=0;n<e-1;++n)i+=Bd(t[n],t[n+1]);return i}function Jd(t,e=Ud.X,i=Ud.Y){let n=0;const s=t.length;let r=t[0];for(let o=1;o<s;o++){const s=t[o];n+=(s[e]-r[e])*(s[i]+r[i]),r=s}if(!Yd(t)){const s=t[0];n+=(s[e]-r[e])*(s[i]+r[i])}return n>=0}function Yd(t){const e=t.length;return e<3||m(t[0],t[e-1])}function Kd(t){"rings"in t&&(Qd(t),Xd(t))}function Qd(t){if(!("rings"in t))return!1;let e=!1;for(const i of t.rings)Yd(i)||(i.push(i[0].slice()),e=!0);return e}function Xd(t){if(!("rings"in t))return!1;if(0===t.rings.length||Jd(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function tf(t){if("polygon"!==t.type&&"polyline"!==t.type)return t;return ef("polygon"===t.type?t.rings:t.paths,t.spatialReference),t}function ef(t,e){const i=Vu(e);if(!i)return;const n=i.valid[0],s=i.valid[1],r=s-n;for(const e of t){let t=1/0,i=-1/0;for(const r of e){const e=nf(r[0],n,s);t=Math.min(t,e),i=Math.max(i,e),r[0]=e}const o=i-t;r-o<o&&e.forEach((t=>{t[0]<0&&(t[0]+=r)}))}}function nf(t,e,i){const n=i-e;return t<e?i-(e-t)%n:t>i?e+(t-e)%n:t}function sf(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if("point"===t.type||"mesh"===t.type||"extent"===t.type)return!0;if("multipoint"===t.type)return t.points.length===e.points.length;const[i,n]="polyline"===t.type?[t.paths,e.paths]:[t.rings,e.rings];return i.length===n.length&&i.every(((t,e)=>t.length===n[e].length))}function rf(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function of(t){return t?af(t.rings,t.hasZ??!1):null}function af(t,e){if(!t?.length)return null;const i=[],n=[],s=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let i=0,r=t.length;i<r;i++){const r=lf(t[i],e,s);r&&n.push(r)}if(n.sort(((t,i)=>{let n=t[2]-i[2];return 0===n&&e&&(n=t[4]-i[4]),n})),n.length&&(i[0]=n[0][0],i[1]=n[0][1],e&&(i[2]=n[0][3]),(i[0]<s[0]||i[0]>s[1]||i[1]<s[2]||i[1]>s[3]||e&&(i[2]<s[4]||i[2]>s[5]))&&(i.length=0)),!i.length){const n=t[0]&&t[0].length?cf(t[0],e):null;if(!n)return null;i[0]=n[0],i[1]=n[1],e&&n.length>2&&(i[2]=n[2])}return i}function lf(t,e,i){let n=0,s=0,r=0,o=0,a=0;const l=t.length?t[0][0]:0,u=t.length?t[0][1]:0,c=t.length&&e?t[0][2]:0;for(let h=0;h<t.length;h++){const d=t[h],f=t[(h+1)%t.length],[p,m,y]=d,g=p-l,v=m-u,[w,b,S]=f,_=w-l,x=b-u,M=g*x-_*v;if(o+=M,n+=(g+_)*M,s+=(v+x)*M,e&&d.length>2&&f.length>2){const t=y-c,e=S-c,i=g*e-_*t;r+=(t+e)*i,a+=i}p<i[0]&&(i[0]=p),p>i[1]&&(i[1]=p),m<i[2]&&(i[2]=m),m>i[3]&&(i[3]=m),e&&(y<i[4]&&(i[4]=y),y>i[5]&&(i[5]=y))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[n/(6*o)+l,s/(6*o)+u,o];return e&&(i[4]===i[5]||0===a?(h[3]=(i[4]+i[5])/2,h[4]=0):(h[3]=r/(6*a)+c,h[4]=a)),h}function uf(t,e){let i=0,n=0,s=0;t.nextPoint();const r=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const u=[t.x,t.y],[c,h]=l,d=c-r,f=h-o,[p,m]=u,y=p-r,g=m-o,v=d*g-y*f;s+=v,i+=(d+y)*v,n+=(f+g)*v,c<e[0]&&(e[0]=c),c>e[1]&&(e[1]=c),h<e[2]&&(e[2]=h),h>e[3]&&(e[3]=h)}if(s>0&&(s*=-1),!s)return null;s*=.5;return[i/(6*s)+r,n/(6*s)+o,s]}function cf(t,e){const i=e?[0,0,0]:[0,0],n=e?[0,0,0]:[0,0];let s=0,r=0,o=0,a=0;for(let l=0,u=t.length;l<u-1;l++){const u=t[l],c=t[l+1];if(u&&c){i[0]=u[0],i[1]=u[1],n[0]=c[0],n[1]=c[1],e&&u.length>2&&c.length>2&&(i[2]=u[2],n[2]=c[2]);const t=Bd(i,n);if(t){s+=t;const i=Wd(u,c);r+=t*i[0],o+=t*i[1],e&&i.length>2&&(a+=t*i[2])}}}return s>0?e?[r/s,o/s,a/s]:[r/s,o/s]:t.length?t[0]:null}function hf(t){const{hasZ:e,totalSize:i}=t;if(0===i)return null;const n=[],s=[],r=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const e=lf(zd(t),t.hasZ,r);e&&s.push(e)}if(s.sort(((t,i)=>{let n=t[2]-i[2];return 0===n&&e&&(n=t[4]-i[4]),n})),s.length&&(n[0]=s[0][0],n[1]=s[0][1],e&&(n[2]=s[0][3]),(n[0]<r[0]||n[0]>r[1]||n[1]<r[2]||n[1]>r[3]||e&&(n[2]<r[4]||n[2]>r[5]))&&(n.length=0)),!n.length){t.reset(),t.nextPath();const i=t.pathSize?df(t):null;if(!i)return null;n[0]=i[0],n[1]=i[1],e&&i.length>2&&(n[2]=i[2])}return n}function df(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],n=e?[0,0,0]:[0,0];let s=0,r=0,o=0,a=0;if(t.nextPoint()){let l=t.x,u=t.y,c=t.z;for(;t.nextPoint();){const h=t.x,d=t.y,f=t.z;i[0]=l,i[1]=u,n[0]=h,n[1]=d,e&&(i[2]=c,n[2]=f);const p=Bd(i,n);if(p){s+=p;const t=Wd(i,n);r+=p*t[0],o+=p*t[1],e&&t.length>2&&(a+=p*t[2])}l=h,u=d,c=f}}return s>0?e?[r/s,o/s,a/s]:[r/s,o/s]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const ff=1e-6;function pf(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<ff){const e=hf(t);return e?[e[0],e[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const n=[t.x,t.y];for(t.reset();t.nextPath();)yf(i,n,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=n[0],i[1]+=n[1],i}const mf=1/3;function yf(t,e,i){if(!t||!i||i.pathSize<3)return null;i.nextPoint();const n=i.x,s=i.y;i.nextPoint();let r,o=i.x-n,a=i.y-s,l=0,u=0;for(;i.nextPoint();)l=i.x-n,u=i.y-s,r=.5*mf*(l*a-u*o),t[0]+=r*(o+l),t[1]+=r*(a+u),o=l,a=u;const c=i.getCurrentRingArea(),h=[n,s];return h[0]-=e[0],h[1]-=e[1],h[0]*=c,h[1]*=c,t[0]+=h[0],t[1]+=h[1],t}const gf=new Float32Array(1);function vf(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function wf(t,e,i){return Math.min(Math.max(t,e),i)}function bf(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function Sf(t,e,i){return t+(e-t)*i}function _f(t,e,i,n,s){return Sf(n,s,(t-e)/(i-e))}function xf(t){return t*Math.PI/180}function Mf(t){return 180*t/Math.PI}function Tf(t){return Math.acos(wf(t,-1,1))}function Af(t){return Math.asin(wf(t,-1,1))}function If(t,e,i=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;return(t>e?t-e:e-t)<=i}const kf=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function Cf(t){return kf.setFloat64(0,t),kf.getBigInt64(0)}function Ef(t){return kf.setBigInt64(0,t),kf.getFloat64(0)}const jf=BigInt("1000000"),Of=Rf(1);function Rf(t){const e=Cf(t=Math.abs(t)),i=Ef(e<=jf?jf:e-jf);return Math.abs(t-i)}function Lf(t,e,i=Of){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(null!=i){if(Rf(Math.min(Math.abs(t),Math.abs(e)))<i)return Math.abs(t-e)<=i}const n=Cf(t),s=Cf(e);if(n<0!=s<0)return!1;return!((n<s?s-n:n-s)>jf)}function Nf(t,e,i=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const n=Math.abs(t-e),s=Math.abs(t),r=Math.abs(e);if(0===t||0===e||s<1e-12&&r<1e-12){if(n>.01*i)return!1}else if(n/(s+r)>i)return!1;return!0}function Pf(t){return Ff(Math.max(-$f,Math.min(t,$f)))}function Ff(t){return gf[0]=t,gf[0]}function Df(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],n=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(If(e,1)&&If(i,1)&&If(n,1))}const $f=Ff(34028234663852886e22);function zf(t,e,i){if(void 0===i||0==+i)return Math[t](e);if(e=+e,i=+i,isNaN(e)||"number"!=typeof i||i%1!=0)return NaN;let n=e.toString().split("e");return n=(e=Math[t](+(n[0]+"e"+(n[1]?+n[1]-i:-i)))).toString().split("e"),+(n[0]+"e"+(n[1]?+n[1]+i:i))}function Uf(t){return t}function Bf(t=lp){return Uf([t[0],t[1],t[2],t[3]])}function Gf(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function Vf(t,e,i,n,s=Bf()){return s[0]=t,s[1]=e,s[2]=i,s[3]=n,s}function qf(t,e=Bf()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function Hf(t,e){return new Od({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function Wf(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Zf(t,e,i){if(null!=e)if("length"in e)rp(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):2!==e.length&&3!==e.length||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else Gf(i,t)}function Jf(t){return null==t||t[0]>=t[2]?0:t[2]-t[0]}function Yf(t){return null==t||t[1]>=t[3]?0:t[3]-t[1]}function Kf(t){return Jf(t)*Yf(t)}function Qf(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function Xf(t,e){return tp(t,e[0],e[1])}function tp(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function ep(t,e,i){return e[0]>=t[0]-i&&e[1]>=t[1]-i&&e[0]<=t[2]+i&&e[1]<=t[3]+i}function ip(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function np(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function sp(t){return t?Gf(t,ap):Bf(ap)}function rp(t){return null!=t&&4===t.length}function op(t,e){return rp(t)&&rp(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const ap=Uf([1/0,1/0,-1/0,-1/0]),lp=Uf([0,0,0,0]);function up(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function cp(t){return void 0!==t.points}function hp(t){return void 0!==t.x&&void 0!==t.y}function dp(t){return void 0!==t.paths}function fp(t){return void 0!==t.rings}function pp(t){function e(e,i){return null==e?i:null==i?e:t(e,i)}return e}const mp=pp(Math.min),yp=pp(Math.max);function gp(t,e){return dp(e)?Sp(t,e.paths,!1,!1):fp(e)?Sp(t,e.rings,!1,!1):cp(e)?xp(t,e.points,!1,!1,!1,!1):up(e)?_p(t,e):(hp(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function vp(t){let e,i,n,s;for(t.reset(),e=n=1/0,i=s=-1/0;t.nextPath();){const r=wp(t);e=Math.min(r[0],e),n=Math.min(r[1],n),i=Math.max(r[2],i),s=Math.max(r[3],s)}return Bf([e,n,i,s])}function wp(t){let e,i,n,s;for(e=n=1/0,i=s=-1/0;t.nextPoint();)e=Math.min(t.x,e),n=Math.min(t.y,n),i=Math.max(t.x,i),s=Math.max(t.y,s);return Bf([e,n,i,s])}function bp(t,e){return dp(e)?Sp(t,e.paths,!0,!1):fp(e)?Sp(t,e.rings,!0,!1):cp(e)?xp(t,e.points,!0,!1,!0,!1):up(e)?_p(t,e,!0,!1,!0,!1):(hp(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function Sp(t,e,i,n){const s=i?3:2;if(!e.length||!e[0].length)return null;let r,o,a,l,[u,c]=e[0][0],[h,d]=e[0][0];for(let t=0;t<e.length;t++){const f=e[t];for(let t=0;t<f.length;t++){const e=f[t],[p,m]=e;if(u=mp(u,p),c=mp(c,m),h=yp(h,p),d=yp(d,m),i&&e.length>2){const t=e[2];r=mp(r,t),o=yp(o,t)}if(n&&e.length>s){const t=e[s];a=mp(r,t),l=yp(o,t)}}}return i?n?(t[0]=u,t[1]=c,t[2]=r,t[3]=a,t[4]=h,t[5]=d,t[6]=o,t[7]=l,t.length=8,t):(t[0]=u,t[1]=c,t[2]=r,t[3]=h,t[4]=d,t[5]=o,t.length=6,t):n?(t[0]=u,t[1]=c,t[2]=a,t[3]=h,t[4]=d,t[5]=l,t.length=6,t):(t[0]=u,t[1]=c,t[2]=h,t[3]=d,t.length=4,t)}function _p(t,e,i,n,s,r){const o=e.xmin,a=e.xmax,l=e.ymin,u=e.ymax;let c=e.zmin,h=e.zmax,d=e.mmin,f=e.mmax;return s?(c=c||0,h=h||0,r?(d=d||0,f=f||0,t[0]=o,t[1]=l,t[2]=c,t[3]=d,t[4]=a,t[5]=u,t[6]=h,t[7]=f,t):(t[0]=o,t[1]=l,t[2]=c,t[3]=a,t[4]=u,t[5]=h,t)):r?(d=d||0,f=f||0,t[0]=o,t[1]=l,t[2]=d,t[3]=a,t[4]=u,t[5]=f,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=u,t)}function xp(t,e,i,n,s,r){const o=i?3:2,a=n&&r,l=i&&s;if(!e.length||!e[0].length)return null;let u,c,h,d,[f,p]=e[0],[m,y]=e[0];for(let t=0;t<e.length;t++){const i=e[t],[n,s]=i;if(f=mp(f,n),p=mp(p,s),m=yp(m,n),y=yp(y,s),l&&i.length>2){const t=i[2];u=mp(u,t),c=yp(c,t)}if(a&&i.length>o){const t=i[o];h=mp(u,t),d=yp(c,t)}}return s?(u=u||0,c=c||0,r?(h=h||0,d=d||0,t[0]=f,t[1]=p,t[2]=u,t[3]=h,t[4]=m,t[5]=y,t[6]=c,t[7]=d,t):(t[0]=f,t[1]=p,t[2]=u,t[3]=m,t[4]=y,t[5]=c,t)):r?(h=h||0,d=d||0,t[0]=f,t[1]=p,t[2]=h,t[3]=m,t[4]=y,t[5]=d,t):(t[0]=f,t[1]=p,t[2]=m,t[3]=y,t)}function Mp(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function Tp(t){return void 0!==t.points}function Ap(t){return void 0!==t.x&&void 0!==t.y}function Ip(t){return void 0!==t.paths}function kp(t){return void 0!==t.rings}const Cp=[];function Ep(t,e,i,n){return{xmin:t,ymin:e,xmax:i,ymax:n}}function jp(t,e,i,n,s,r){return{xmin:t,ymin:e,zmin:i,xmax:n,ymax:s,zmax:r}}function Op(t,e,i,n,s,r){return{xmin:t,ymin:e,mmin:i,xmax:n,ymax:s,mmax:r}}function Rp(t,e,i,n,s,r,o,a){return{xmin:t,ymin:e,zmin:i,mmin:n,xmax:s,ymax:r,zmax:o,mmax:a}}function Lp(t,e=!1,i=!1){return e?i?Rp(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):jp(t[0],t[1],t[2],t[3],t[4],t[5]):i?Op(t[0],t[1],t[2],t[3],t[4],t[5]):Ep(t[0],t[1],t[2],t[3])}function Np(t){return t?Mp(t)?t:Ap(t)?Fp(t):kp(t)?Dp(t):Ip(t)?$p(t):Tp(t)?Pp(t):null:null}function Pp(t){const{hasZ:e,hasM:i,points:n}=t;return Lp(xp(Cp,n,e??!1,i??!1),e,i)}function Fp(t){const{x:e,y:i,z:n,m:s}=t,r=null!=s;return null!=n?r?Rp(e,i,n,s,e,i,n,s):jp(e,i,n,e,i,n):r?Op(e,i,s,e,i,s):Ep(e,i,e,i)}function Dp(t){const{hasZ:e,hasM:i,rings:n}=t,s=Sp(Cp,n,e??!1,i??!1);return s?Lp(s,e,i):null}function $p(t){const{hasZ:e,hasM:i,paths:n}=t,s=Sp(Cp,n,e??!1,i??!1);return s?Lp(s,e,i):null}var zp;function Up(t){return!Array.isArray(t[0])}function Bp(t){return"number"==typeof t[0]?.[0]}function Gp(t){if(!t)return;let{rings:e,hasM:i,hasZ:n,spatialReference:s}=t;switch(e??=[],Bp(e)&&(e=[e]),e[0]?.[0]?.length){case 4:n??=!0,i??=!0;break;case 3:n??=!0!==i,i??=!n;break;default:n??=!1,i??=!1}return s??=wh.WGS84,{...t,hasM:i,hasZ:n,rings:e,spatialReference:s}}let Vp=zp=class extends Sh{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:i}=t;let n=!1,s=!1;for(const t of e)t.hasZ&&(n=!0),t.hasM&&(s=!0);const r={rings:e.map((t=>{const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(n&&t.hasZ){const i=t.zmin+.5*(t.zmax-t.zmin);for(let t=0;t<e.length;t++)e[t].push(i)}if(s&&t.hasM){const i=t.mmin+.5*(t.mmax-t.mmin);for(let t=0;t<e.length;t++)e[t].push(i)}return e})),spatialReference:i};return n&&(r.hasZ=!0),s&&(r.hasM=!0),new zp(r)}constructor(t){super(Gp(t)),this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const t=of(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new Kh;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=Dp(this);if(!e)return null;const i=new Od(e);return i.spatialReference=t,i}get isSelfIntersecting(){return xd(this.rings)}writeRings(t,e){e.rings=nt(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(Up(t)){const n=[];for(let e=0,i=t.length;e<i;e++)n[e]=t[e].toArray();e[i]=n}else e[i]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new zp;return t.spatialReference=this.spatialReference,t.rings=nt(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(null==t)return!1;const e=this.spatialReference,i=t.spatialReference;if(null!=e!=(null!=i))return!1;if(null!=e&&null!=i&&!e.equals(i))return!1;if(this.rings.length!==t.rings.length)return!1;const n=([t,e,i,n],[s,r,o,a])=>t===s&&e===r&&(null==i&&null==o||i===o)&&(null==n&&null==a||n===a);for(let e=0;e<this.rings.length;e++){const i=this.rings[e],s=t.rings[e];if(!m(i,s,n))return!1}return!0}contains(t){if(!t)return!1;const e=Fh(t,this.spatialReference);return rd(this,null!=e?e:t)}isClockwise(t){const e=Up(t)?t.map((t=>this.hasZ?this.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])):t;return Jd(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],n=this.hasZ,s=this.hasM;return n&&!s?new Kh(i[0],i[1],i[2],void 0,this.spatialReference):s&&!n?new Kh(i[0],i[1],void 0,i[2],this.spatialReference):n&&s?new Kh(i[0],i[1],i[2],i[3],this.spatialReference):new Kh(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(Rd(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new Kh(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,n=e.map((t=>new Kh(t,i)));return this.notifyChange("rings"),n}setPoint(t,e,i){return this._validateInputs(t,e)?(Rd(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.rings.length)return!1;if(null!=e){const n=this.rings[t];if(i&&(e<0||e>n.length))return!1;if(!i&&(e<0||e>=n.length))return!1}return!0}toJSON(t){return this.write({},t)}};r([Je({readOnly:!0})],Vp.prototype,"cache",null),r([Je({readOnly:!0})],Vp.prototype,"centroid",null),r([Je({readOnly:!0})],Vp.prototype,"extent",null),r([Je({readOnly:!0})],Vp.prototype,"isSelfIntersecting",null),r([Je({type:[[[Number]]],json:{write:{isRequired:!0}}})],Vp.prototype,"rings",void 0),r([yh("rings")],Vp.prototype,"writeRings",null),Vp=zp=r([ln("esri.geometry.Polygon")],Vp);const qp=Vp;Vp.prototype.toJSON.isDefaultToJSON=!0;var Hp;function Wp(t){return!Array.isArray(t[0])}function Zp(t){return"number"==typeof t[0]?.[0]}function Jp(t){if(!t)return;let{paths:e,hasM:i,hasZ:n,spatialReference:s}=t;switch(e??=[],Zp(e)&&(e=[e]),e[0]?.[0]?.length){case 4:n??=!0,i??=!0;break;case 3:n??=!0!==i,i??=!n;break;default:n??=!1,i??=!1}return s??=wh.WGS84,{...t,hasM:i,hasZ:n,paths:e,spatialReference:s}}let Yp=Hp=class extends Sh{constructor(t){super(Jp(t)),this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=$p(this);if(!e)return null;const i=new Od(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=nt(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(Wp(t)){const n=[];for(let e=0,i=t.length;e<i;e++)n[e]=t[e].toArray();e[i]=n}else e[i]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new Hp;return t.spatialReference=this.spatialReference,t.paths=nt(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],n=this.hasZ,s=this.hasM;return n&&!s?new Kh(i[0],i[1],i[2],void 0,this.spatialReference):s&&!n?new Kh(i[0],i[1],void 0,i[2],this.spatialReference):n&&s?new Kh(i[0],i[1],i[2],i[3],this.spatialReference):new Kh(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(Rd(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,n=e.map((t=>new Kh(t,i)));return this.notifyChange("paths"),n}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new Kh(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(Rd(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.paths.length)return!1;if(null!=e){const n=this.paths[t];if(i&&(e<0||e>n.length))return!1;if(!i&&(e<0||e>=n.length))return!1}return!0}toJSON(t){return this.write({},t)}};r([Je({readOnly:!0})],Yp.prototype,"cache",null),r([Je({readOnly:!0})],Yp.prototype,"extent",null),r([Je({type:[[[Number]]],json:{write:{isRequired:!0}}})],Yp.prototype,"paths",void 0),r([yh("paths")],Yp.prototype,"writePaths",null),Yp=Hp=r([ln("esri.geometry.Polyline")],Yp);const Kp=Yp;Yp.prototype.toJSON.isDefaultToJSON=!0;const Qp=Oo()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),Xp=Oo()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function tm(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function em(t){return void 0!==t.points}function im(t){return void 0!==t.x&&void 0!==t.y}function nm(t){return void 0!==t.paths}function sm(t){return void 0!==t.rings}function rm(t){return null==t?null:t instanceof Sh?t:im(t)?Kh.fromJSON(t):nm(t)?Kp.fromJSON(t):sm(t)?qp.fromJSON(t):em(t)?Dd.fromJSON(t):tm(t)?Od.fromJSON(t):null}function om(t){return t?im(t)?"esriGeometryPoint":nm(t)?"esriGeometryPolyline":sm(t)?"esriGeometryPolygon":tm(t)?"esriGeometryEnvelope":em(t)?"esriGeometryMultipoint":null:null}const am={esriGeometryPoint:Kh,esriGeometryPolyline:Kp,esriGeometryPolygon:qp,esriGeometryEnvelope:Od,esriGeometryMultipoint:Dd,esriGeometryMultiPatch:qp};function lm(t){return t&&am[t]||null}const um={base:Sh,key:"type",typeMap:{extent:Od,multipoint:Dd,point:Kh,polyline:Kp,polygon:qp}};ue(um);const cm=t=>{let e=class extends t{clone(){const t=Me(this);Tn(t,"unable to clone instance of non-accessor class");const e=t.metadata,i=t.store,n={},s=new Map;for(const t in e){const r=e[t],o=i?.originOf(t),a=r.clonable;if(r.readOnly||!1===a||o!==$n.USER&&o!==$n.DEFAULTS&&o!==$n.WEB_MAP&&o!==$n.WEB_SCENE)continue;const l=this[t];let u=null;u="function"==typeof a?a(l):"reference"===a?l:st(l),null!=l&&null==u||(o===$n.DEFAULTS?s.set(t,u):n[t]=u)}const r=new(Object.getPrototypeOf(this).constructor)(n);if(s.size){const t=Me(r)?.store;if(t)for(const[e,i]of s)t.set(e,i,$n.DEFAULTS)}return r}};return e=r([ln("esri.core.Clonable")],e),e};let hm=class extends(cm(ao)){};hm=r([ln("esri.core.Clonable")],hm);let dm=class extends hm{constructor(t){super(t),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(t){return null!=t&&(this.row===t.row&&this.rows===t.rows&&this.column===t.column&&this.columns===t.columns)}};r([Je({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],dm.prototype,"row",void 0),r([Je({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],dm.prototype,"column",void 0),r([Je({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],dm.prototype,"rows",void 0),r([Je({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],dm.prototype,"columns",void 0),dm=r([ln("esri.CameraLayout")],dm);const fm=dm;class pm{constructor(t,e){this.min=t,this.max=e,this.range=e-t}normalize(t,e=0,i=!1){return mm(this.range,this.min,this.max,t,e,i)}clamp(t,e=0){return wf(t-e,this.min,this.max)+e}monotonic(t,e,i){return t<e?e:e+ym(this.range,t-e,i)}minimalMonotonic(t,e,i){return mm(this.range,t,t+this.range,e,i)}center(t,e,i){return e=this.monotonic(t,e,i),this.normalize((t+e)/2,i)}diff(t,e,i){return this.monotonic(t,e,i)-t}shortestSignedDiff(t,e){t=this.normalize(t);const i=(e=this.normalize(e))-t,n=e<t?this.minimalMonotonic(t,e)-t:e-this.minimalMonotonic(e,t);return Math.abs(i)<Math.abs(n)?i:n}contains(t,e,i){return e=this.minimalMonotonic(t,e),(i=this.minimalMonotonic(t,i))>t&&i<e}}function mm(t,e,i,n,s=0,r=!1){return(n-=s)<e?n+=ym(t,e-n):n>i&&(n-=ym(t,n-i)),r&&n===i&&(n=e),n+s}function ym(t,e,i=0){return Math.ceil((e-i)/t)*t+i}const gm=new pm(0,360);let vm=class extends(cm(Io)){constructor(...t){super(...t),this.position=new Kh([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new fm}normalizeCtorArgs(t,e,i,n){if(t&&"object"==typeof t&&("x"in t||Array.isArray(t))){const s={position:t};return null!=e&&(s.heading=e),null!=i&&(s.tilt=i),null!=n&&(s.fov=n),s}return t}writePosition(t,e,i,n){const s=t.clone();s.x=Ut(t.x||0),s.y=Ut(t.y||0),s.z=t.hasZ?Ut(t.z||0):t.z,e[i]=s.write({},n)}readPosition(t,e){const i=new Kh;return i.read(t,e),i.x=Ut(i.x||0),i.y=Ut(i.y||0),i.z=i.hasZ?Ut(i.z||0):i.z,i}equals(t){return null!=t&&(this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)&&this.layout.equals(t.layout))}};r([Je({type:Kh,json:{write:{isRequired:!0}}})],vm.prototype,"position",void 0),r([yh("position")],vm.prototype,"writePosition",null),r([ko("position")],vm.prototype,"readPosition",null),r([Je({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ah((t=>gm.normalize(Ut(t))))],vm.prototype,"heading",void 0),r([Je({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ah((t=>wf(Ut(t),-180,180)))],vm.prototype,"tilt",void 0),r([Je({type:Number,nonNullable:!0,json:{default:55,write:!0}}),Ah((t=>wf(Ut(t,55),1,170)))],vm.prototype,"fov",void 0),r([Je({type:fm,nonNullable:!0,json:{read:!1,write:!1}})],vm.prototype,"layout",void 0),vm=r([ln("esri.Camera")],vm);const wm=vm;var bm;let Sm=bm=class extends Io{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new bm({rotation:this.rotation,scale:this.scale,targetGeometry:null!=this.targetGeometry?this.targetGeometry.clone():null,camera:null!=this.camera?this.camera.clone():null})}};r([Je({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:xm}}}}})],Sm.prototype,"rotation",void 0),r([Ah("rotation")],Sm.prototype,"castRotation",null),r([Je({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:xm}}}}})],Sm.prototype,"scale",void 0),r([Je({types:um,json:{read:rm,write:!0,origins:{"web-scene":{read:rm,write:{overridePolicy:xm}}}}})],Sm.prototype,"targetGeometry",void 0),r([Je({type:wm,json:{write:!0}})],Sm.prototype,"camera",void 0),Sm=bm=r([ln("esri.Viewpoint")],Sm);const _m=Sm;function xm(){return{enabled:!this.camera}}class Mm{constructor(){this._emitter=new Mm.EventEmitter(this)}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(t){class e{constructor(t=null){this._target=t,this._listenersMap=null}clear(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clear()}emit(t,e){let i=this._listenersMap?.get(t);if(!i)return!1;const n=this._target||this;let s=!1;for(const t of i.slice()){const i="deref"in t?t.deref():t;i?i?.call(n,e):s=!0}return s&&(i=i.filter((t=>!("deref"in t)||null!=t.deref())),this._listenersMap.set(t,i)),i.length>0}on(t,e){if(Array.isArray(t)){const i=t.map((t=>this.on(t,e)));return Se(i)}if(t.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const i=this._listenersMap.get(t)||[];return i.push(e),this._listenersMap.set(t,i),we((()=>{const i=this._listenersMap?.get(t),n=i?.indexOf(e)??-1;n>=0&&i.splice(n,1)}))}once(t,e){const i=this.on(t,(t=>{i.remove();const n="deref"in e?e.deref():e;n?.call(null,t)}));return i}hasEventListener(t){const e=this._listenersMap?.get(t);return null!=e&&e.length>0}}t.EventEmitter=e,t.EventedMixin=t=>{let i=class extends t{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return i=r([ln("esri.core.Evented")],i),i};let i=class extends ao{constructor(){super(...arguments),this._emitter=new Mm.EventEmitter(this)}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};i=r([ln("esri.core.Evented.EventedAccessor")],i),t.EventedAccessor=i}(Mm||(Mm={}));const Tm=Mm;var Am;!function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"}(Am||(Am={}));function Im(t){return(e,i)=>{e[i]=t}}class km extends Fn{notify(){const t=this._observers;if(t&&t.length>0){const e=t.slice();for(const t of e)t.onInvalidated(),t.onCommitted()}}}var Cm;class Em{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}}class jm{constructor(t,e,i,n,s){this.target=t,this.added=e,this.removed=i,this.start=n,this.deleteCount=s}}const Om=new Nn(Em,void 0,(t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1}));function Rm(t){t&&"object"==typeof t&&"destroy"in t&&"function"==typeof t.destroy&&t.destroy()}function Lm(t){return t?t instanceof Gm?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function Nm(t){if(t?.length)return t[0]}function Pm(t,e,i,n){const s=Math.min(t.length-i,e.length-n);let r=0;for(;r<s&&t[i+r]===e[n+r];)r++;return r}function Fm(t,e,i,n){e&&e.forEach(((e,s,r)=>{t.push(e),Fm(t,i.call(n,e,s,r),i,n)}))}const Dm=new Set,$m=new Set,zm=new Set,Um=new Map;let Bm=0,Gm=Cm=class extends Tm.EventedAccessor{static isCollection(t){return null!=t&&t instanceof Cm}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new km,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Bm++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Cm?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),this._emitter.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return oi(this._observable),this._items}set items(t){this._emitBeforeChanges(Am.ADD)||(this._splice(0,this.length,Lm(t)),this._emitAfterChanges(Am.ADD))}hasEventListener(t){return!this.destroyed&&("change"===t?this._chgListeners.length>0:this._emitter.hasEventListener(t))}on(t,e){if(this.destroyed)return we();if("change"===t){const t=this._chgListeners,i={removed:!1,callback:e};return t.push(i),this._notifications&&this._notifications.push({listeners:t.slice(),items:this._items.slice(),changes:[]}),we((()=>{i.removed=!0,t.splice(t.indexOf(i),1)}))}return this._emitter.on(t,e)}once(t,e){const i="deref"in e?()=>e.deref():()=>e,n=this.on(t,(t=>{i()?.call(null,t),n.remove()}));return n}add(t,e){if(oi(this._observable),this._emitBeforeChanges(Am.ADD))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(Am.ADD),this}addMany(t,e=this._items.length){if(oi(this._observable),!t?.length)return this;if(this._emitBeforeChanges(Am.ADD))return this;const i=this.getNextIndex(e);return this._splice(i,0,Lm(t)),this._emitAfterChanges(Am.ADD),this}at(t){if(oi(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(oi(this._observable),!this.length||this._emitBeforeChanges(Am.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(Am.REMOVE),t}_removeAllRaw(){return 0===this.length?[]:this._splice(0,this.length)||[]}clone(){return oi(this._observable),this._createNewInstance({items:this._items.map(nt)})}concat(...t){oi(this._observable);const e=t.map(Lm);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(oi(this._observable),!this.length||this._emitBeforeChanges(Am.REMOVE))return;const i=this._splice(0,this.length),n=i.length;for(let s=0;s<n;s++)t.call(e,i[s],s,i);this._emitAfterChanges(Am.REMOVE)}destroyAll(){this.drain(Rm)}destroyMany(t){const e=this.removeMany(t);return e.forEach(Rm),e}every(t,e){return oi(this._observable),this._items.every(t,e)}filter(t,e){let i;return oi(this._observable),i=2===arguments.length?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return oi(this._observable),this._items.find(t,e)}findIndex(t,e){return oi(this._observable),this._items.findIndex(t,e)}flatten(t,e){oi(this._observable);const i=[];return Fm(i,this,t,e),new Cm(i)}forEach(t,e){return oi(this._observable),this._items.forEach(t,e)}getItemAt(t){return oi(this._observable),this._items[t]}getNextIndex(t){oi(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return oi(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return oi(this._observable),this._items.indexOf(t,e)}join(t=","){return oi(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return oi(this._observable),this._items.lastIndexOf(t,e)}map(t,e){oi(this._observable);const i=this._items.map(t,e);return new Cm({items:i})}reorder(t,e=this.length-1){oi(this._observable);const i=this.indexOf(t);if(-1!==i){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(Am.MOVE))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(Am.MOVE)}return t}}pop(){if(oi(this._observable),!this.length||this._emitBeforeChanges(Am.REMOVE))return;const t=Nm(this._splice(this.length-1,1));return this._emitAfterChanges(Am.REMOVE),t}push(...t){return oi(this._observable),this._emitBeforeChanges(Am.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(Am.ADD)),this.length}reduce(t,e){oi(this._observable);const i=this._items;return 2===arguments.length?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){oi(this._observable);const i=this._items;return 2===arguments.length?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return oi(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(oi(this._observable),t<0||t>=this.length||this._emitBeforeChanges(Am.REMOVE))return;const e=Nm(this._splice(t,1));return this._emitAfterChanges(Am.REMOVE),e}removeMany(t){if(oi(this._observable),!t?.length||this._emitBeforeChanges(Am.REMOVE))return[];const e=t instanceof Cm?t.toArray():t,i=this._items,n=[],s=e.length;for(let t=0;t<s;t++){const s=e[t],r=i.indexOf(s);if(r>-1){const s=1+Pm(e,i,t+1,r+1),o=this._splice(r,s);o&&o.length>0&&n.push.apply(n,o),t+=s-1}}return this._emitAfterChanges(Am.REMOVE),n}reverse(){if(oi(this._observable),this._emitBeforeChanges(Am.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(Am.MOVE),this}shift(){if(oi(this._observable),!this.length||this._emitBeforeChanges(Am.REMOVE))return;const t=Nm(this._splice(0,1));return this._emitAfterChanges(Am.REMOVE),t}slice(t=0,e=this.length){return oi(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return oi(this._observable),this._items.some(t,e)}sort(t){if(oi(this._observable),!this.length||this._emitBeforeChanges(Am.MOVE))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(Am.MOVE),this}splice(t,e,...i){oi(this._observable);const n=(e?Am.REMOVE:0)|(i.length?Am.ADD:0);if(this._emitBeforeChanges(n))return[];const s=this._splice(t,e,i)||[];return this._emitAfterChanges(n),s}toArray(){return oi(this._observable),this._items.slice()}toJSON(){return oi(this._observable),this.toArray()}toLocaleString(){return oi(this._observable),this._items.toLocaleString()}toString(){return oi(this._observable),this._items.toString()}unshift(...t){return oi(this._observable),!t.length||this._emitBeforeChanges(Am.ADD)||(this._splice(0,0,t),this._emitAfterChanges(Am.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const n=this._items,s=this.itemType;let r,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=er((()=>this._dispatchChange()))),t<0&&(t+=this.length),e){if(o=n.splice(t,e),this.hasEventListener("before-remove")){const e=Om.acquire();e.target=this,e.cancellable=!0;for(let i=0,s=o.length;i<s;i++)r=o[i],e.reset(r),this.emit("before-remove",e),e.defaultPrevented&&(o.splice(i,1),n.splice(t,0,r),t+=1,i-=1,s-=1);Om.release(e)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const t=Om.acquire();t.target=this,t.cancellable=!1;const e=o.length;for(let i=0;i<e;i++)t.reset(o[i]),this.emit("after-remove",t);Om.release(t)}}if(i?.length){if(s){const t=[];for(const e of i){const i=s.ensureType(e);null==i&&null!=e||t.push(i)}i=t}const e=this.hasEventListener("before-add"),r=this.hasEventListener("after-add"),o=t===this.length;if(e||r){const s=Om.acquire();s.target=this,s.cancellable=!0;const a=Om.acquire();a.target=this,a.cancellable=!1;for(const l of i)e?(s.reset(l),this.emit("before-add",s),s.defaultPrevented||(o?n.push(l):n.splice(t++,0,l),this._set("length",n.length),r&&(a.reset(l),this.emit("after-add",a)))):(o?n.push(l):n.splice(t++,0,l),this._set("length",n.length),a.reset(l),this.emit("after-add",a));Om.release(a),Om.release(s)}else{if(o)for(const t of i)n.push(t);else n.splice(t,0,...i);this._set("length",n.length)}}if((i?.length||o?.length)&&this._notifyChangeEvent(i,o),this.hasEventListener("after-splice")){const n=new jm(this,i,o,t,e);this.emit("after-splice",n)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Om.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Om.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Om.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Om.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const t=e.changes;Dm.clear(),$m.clear(),zm.clear();for(const{added:e,removed:i}of t){if(e)if(0===zm.size&&0===$m.size)for(const t of e)Dm.add(t);else for(const t of e)$m.has(t)?(zm.add(t),$m.delete(t)):zm.has(t)||Dm.add(t);if(i)if(0===zm.size&&0===Dm.size)for(const t of i)$m.add(t);else for(const t of i)Dm.has(t)?Dm.delete(t):(zm.delete(t),$m.add(t))}const i=es.acquire();Dm.forEach((t=>{i.push(t)}));const n=es.acquire();$m.forEach((t=>{n.push(t)}));const s=this._items,r=e.items,o=es.acquire();if(zm.forEach((t=>{r.indexOf(t)!==s.indexOf(t)&&o.push(t)})),e.listeners&&(i.length||n.length||o.length)){const t={target:this,added:i,removed:n,moved:o},s=e.listeners.length;for(let i=0;i<s;i++){const n=e.listeners[i];n.removed||n.callback.call(this,t)}}es.release(i),es.release(n),es.release(o)}Dm.clear(),$m.clear(),zm.clear()}};Gm.ofType=t=>{if(!t)return Cm;if(Um.has(t))return Um.get(t);let e=null;if("function"==typeof t)e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const i in t.typeMap){const n=t.typeMap[i].prototype.declaredClass;e?e+=` | ${n}`:e=n}let i=class extends Cm{};return r([Im({Type:t,ensureType:"function"==typeof t?ee(t):ue(t)})],i.prototype,"itemType",void 0),i=r([ln(`esri.core.Collection<${e}>`)],i),Um.set(t,i),i},r([Je()],Gm.prototype,"_updating",void 0),r([Je()],Gm.prototype,"length",void 0),r([Je()],Gm.prototype,"items",null),r([Je({readOnly:!0})],Gm.prototype,"updating",null),Gm=Cm=r([ln("esri.core.Collection")],Gm);const Vm=Gm;function qm(t,e,i){return Os(t.map(((t,n)=>e.apply(i,[t,n]))))}async function Hm(t,e,i){return(await Os(t.map(((t,n)=>e.apply(i,[t,n]))))).map((t=>t.value))}function Wm(t){return{ok:!0,value:t}}function Zm(t){return{ok:!1,error:t}}function Jm(t){return null!=t&&!0===t.ok?t.value:null}function Ym(t){return null!=t&&!1===t.ok?t.error:null}async function Km(t){if(null==t)return{ok:!1,error:new Error("no promise provided")};try{return Wm(await t)}catch(t){return Zm(t)}}async function Qm(t){try{return Wm(await t)}catch(t){return Ts(t),Zm(t)}}function Xm(t,e){return new ty(t,e)}let ty=class extends ao{get value(){return Jm(this._result)}get error(){return Ym(this._result)}get finished(){return null!=this._result}constructor(t,e){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=Cn(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=t(i),this.promise.then((t=>{this._result=Wm(t),this._cleanup()}),(t=>{this._result=Zm(t),this._cleanup()})),this._abortHandle=Is(e,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=kn(this._abortHandle),this._abortController=null}};r([Je()],ty.prototype,"value",null),r([Je()],ty.prototype,"error",null),r([Je()],ty.prototype,"finished",null),r([Je()],ty.prototype,"promise",void 0),r([Je()],ty.prototype,"_result",void 0),ty=r([ln("esri.core.asyncUtils.ReactiveTask")],ty);function ey(t,e,i={}){return ny(t,e,i,ly)}function iy(t,e,i={}){return ny(t,e,i,uy)}function ny(t,e,i={},n){let s=null;const r=i.once?(t,i)=>{n(t)&&(kn(s),e(t,i))}:(t,i)=>{n(t)&&e(t,i)};if(s=to(t,r,i.sync,i.equals),i.initial){const e=t();r(e,e)}return s}function sy(t,e,i,n={}){let s=null,r=null,o=null;function a(){s&&r&&(r.remove(),n.onListenerRemove?.(s),s=null,r=null)}function l(t){n.once&&n.once&&kn(o),i(t)}const u=ey(t,((t,i)=>{a(),ms(t)&&(s=t,r=vs(t,e,l),n.onListenerAdd?.(t))}),{sync:n.sync,initial:!0});return o=we((()=>{u.remove(),a()})),o}function ry(t,e){return ay(t,null,e)}function oy(t,e){return ay(t,uy,e)}function ay(t,e,i){if(Ms(i))return Promise.reject(Ss());const n=t();if(e?.(n))return Promise.resolve(n);let s=null;function r(){s=kn(s)}return new Promise(((n,o)=>{s=Se([Is(i,(()=>{r(),o(Ss())})),ny(t,(t=>{r(),n(t)}),{sync:!1,once:!0},e??ly)])}))}function ly(t){return!0}function uy(t){return!!t}function cy(t,e,i={}){let n=!1;const s=ey(t,((t,i)=>{n||e(t,i)}),i);return{remove(){s.remove()},pause(){n=!0},resume(){n=!1}}}const hy={sync:!0},dy={initial:!0},fy={sync:!0,initial:!0};let py=class extends Vm{constructor(t){super(t),this.getCollections=null}initialize(){this.addHandles(Lr((()=>this._refresh()),hy))}destroy(){this.getCollections=null}_refresh(){const t=null!=this.getCollections?this.getCollections():null;if(null==t)return void this.removeAll();let e=0;for(const i of t)null!=i&&(e=this._processCollection(e,i));this.splice(e,this.length)}_createNewInstance(t){return new Vm(t)}_processCollection(t,e){if(!e)return t;const i=this.itemFilterFunction??(t=>!!t);for(const n of e)if(n){if(i(n)){const e=this.indexOf(n,t);e>=0?e!==t&&this.reorder(n,t):this.add(n,t),++t}if(this.getChildrenFunction){const e=this.getChildrenFunction(n);if(Array.isArray(e))for(const i of e)t=this._processCollection(t,i);else t=this._processCollection(t,e)}}return t}};r([Je()],py.prototype,"getCollections",void 0),r([Je()],py.prototype,"getChildrenFunction",void 0),r([Je()],py.prototype,"itemFilterFunction",void 0),py=r([ln("esri.core.CollectionFlattener")],py);const my=py;class yy{constructor(t=(t=>t.values().next().value)){this._peeker=t,this._observable=new km,this._items=new Set}get length(){return oi(this._observable),this._items.size}clear(){0!==this.length&&(this._items.clear(),this._observable.notify())}last(){if(0===this.length)return;let t;for(t of this._items);return t}peek(){if(0!==this.length)return this._peeker(this._items)}push(t){this.contains(t)||(this._items.add(t),this._observable.notify())}contains(t){return oi(this._observable),this._items.has(t)}pop(){if(0===this.length)return;const t=this.peek();return this._items.delete(t),this._observable.notify(),t}popLast(){if(0===this.length)return;const t=this.last();return this._items.delete(t),this._observable.notify(),t}remove(t){this.contains(t)&&(this._items.delete(t),this._observable.notify())}filter(t){const e=this.length;return this._items.forEach((e=>{t(e)||this._items.delete(e)})),e!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){oi(this._observable),yield*this._items}}const gy=new FinalizationRegistry((t=>{t.close()}));function vy(t,e){gy.register(t,e,e)}function wy(t){gy.unregister(t)}function by(t,e){return new Proxy({},{get:(i,n,s)=>(...i)=>{let s,r;const o=i[i.length-1];Sy(o)&&(s=o.signal,r=o.transferList,i.pop());return t.apply(e?`${e}.${n.toString()}`:n.toString(),i,{transferList:r,signal:s})}})}function Sy(t){return"object"==typeof t&&!Array.isArray(t)&&null!=t&&("signal"in t||"transferList"in t||0===Object.keys(t).length)}const _y={statsWorker:()=>import("./p-411ae67a.js"),geometryEngineWorker:()=>import("./p-e3aae29b.js"),CSVSourceWorker:()=>import("./p-46766110.js"),EdgeProcessingWorker:()=>import("./p-fe650af8.js"),ElevationSamplerWorker:()=>import("./p-9d576fdd.js"),FeatureServiceSnappingSourceWorker:()=>import("./p-e0972aae.js"),GeoJSONSourceWorker:()=>import("./p-2ce565e9.js"),LercWorker:()=>import("./p-13cc870f.js"),MemorySourceWorker:()=>import("./p-743dfcb6.js"),PBFDecoderWorker:()=>import("./p-16d618e1.js"),FeaturePipelineWorker:()=>import("./p-33c9703c.js"),PointCloudWorker:()=>import("./p-85de89af.js"),RasterWorker:()=>import("./p-0750aae7.js"),SceneLayerSnappingSourceWorker:()=>import("./p-7c2df0b1.js"),SceneLayerWorker:()=>import("./p-475c370a.js"),WFSSourceWorker:()=>import("./p-d34ba535.js"),WorkerTileHandler:()=>import("./p-364d63db.js"),Lyr3DWorker:()=>import("./p-6f654afb.js"),Feature3DPipelineWorker:()=>import("./p-4f0eb56b.js").then((function(t){return t.F}))};const xy="worker:port-closed";var My;!function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"}(My||(My={}));let Ty=0;function Ay(){return Ty++}function Iy(t){return t&&"object"==typeof t&&("result"in t||"transferList"in t)}function ky(t){return t?"string"==typeof t?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function Cy(t,e,i,n){if(e.type===My.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==My.INVOKE&&e.type!==My.RESPONSE)return void t.postMessage(e);let s;if(Iy(i)?(s=jy(i.transferList),e.data=i.result):(s=jy(n),e.data=i),s){if(u("ff"))for(const i of s)if("byteLength"in i&&i.byteLength>267386880){const i="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case My.INVOKE:throw i;case My.RESPONSE:return void Cy(t,{type:My.RESPONSE,jobId:e.jobId,error:ky(i)})}}t.postMessage(e,s)}else t.postMessage(e)}function Ey(t){if(!t)return null;const e=t.data;return e?"string"==typeof e?JSON.parse(e):e:null}function jy(t){if(!t?.length)return null;if(u("esri-workers-arraybuffer-transfer"))return t;const e=t.filter((t=>!Oy(t)));return e.length?e:null}function Oy(t){return t instanceof ArrayBuffer||"ArrayBuffer"===t?.constructor?.name}async function Ry(t){try{return await t}catch(t){const e=t?.name===xy;if(!(Es(t)||e))throw t;return}}const{CLOSE:Ly,ABORT:Ny,INVOKE:Py,RESPONSE:Fy,OPEN_PORT:Dy,ON:$y}=My,zy=2;class Uy{constructor(t){this._invoke=t,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(t){t.type===My.ABORT?this._cancelledJobIds.add(t.jobId):(this._invokeMessages.push(t),null===this._timer&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const t of this._invokeMessages)this._cancelledJobIds.has(t.jobId)||this._invoke(t);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class By{static connect(t,e){const i=new MessageChannel;let n;n="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t;const s=new By(i.port1,{channel:i,client:n,schedule:e});return"object"==typeof n&&"remoteClient"in n&&(n.remoteClient=s),By.clients.set(s,n),i.port2}static loadWorker(t){const e=_y[t];return e?e():Promise.resolve(null)}constructor(t,e,i){this._port=t,this._jobQueue=i,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new Uy((t=>this._onInvokeMessage(t))),this._client=e.client,this._onMessage=this._onMessage.bind(this),this._channel=e.channel,this._schedule=e.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:Ly}),this._close()}isBusy(){return this._outJobs.size>0}invoke(t,e,i){return this.apply(t,[e],i)}apply(t,e,i){const n=i?.signal,s=i?.transferList;if(!this._port)return Promise.reject(new Ve(xy,`Cannot call invoke('${t}'), port is closed`,{methodName:t,data:e}));const r=Ay();return new Promise(((i,o)=>{if(Ms(n))return this._processWork(),void o(Ss());const a=Is(n,(()=>{const t=this._outJobs.get(r);t&&(this._outJobs.delete(r),this._processWork(),kn(t.abortHandle),this._post({type:Ny,jobId:r}),o(Ss()))})),l={resolve:i,reject:o,abortHandle:a,debugInfo:t};this._outJobs.set(r,l),this._post({type:Py,jobId:r,methodName:t,abortable:null!=n},e,s)}))}createInvokeProxy(t){return by(this,t)}on(t,e){const i=new MessageChannel;function n(t){e(t.data)}return this._port.postMessage({type:My.ON,eventType:t,port:i.port2},[i.port2]),i.port1.addEventListener("message",n),i.port1.start(),we((()=>{i.port1.postMessage({type:My.CLOSE}),i.port1.close(),i.port1.removeEventListener("message",n)}))}jobAdded(){this._processWork()}openPort(){const t=new MessageChannel;return this._post({type:Dy,port:t.port2}),t.port1}_processWork(){if(this._outJobs.size>=zy)return;const t=this._jobQueue?.pop();if(!t)return;const{methodName:e,data:i,invokeOptions:n,resolver:s}=t;this.apply(e,i,n).then((t=>s.resolve(t))).catch((t=>s.reject(t)))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((t=>{kn(t.abortHandle),t.reject(Ss(`Worker closing, aborting job calling '${t.debugInfo}'`))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(t){null!=this._schedule?this._schedule((()=>this._processMessage(t,!0))):this._processMessage(t,!1)}_processMessage(t,e){const i=Ey(t);if(i)switch(i.type){case Fy:this._onResponseMessage(i);break;case Py:e?this._onInvokeMessage(i):this._invokeQueue.push(i);break;case Ny:this._onAbortMessage(i);break;case Ly:this._onCloseMessage();break;case Dy:this._onOpenPortMessage(i);break;case $y:this._onOnMessage(i)}}_onAbortMessage(t){const e=this._inJobs,i=t.jobId,n=e.get(i);this._invokeQueue.push(t),n&&(n.controller&&n.controller.abort(),e.delete(i))}_onCloseMessage(){const t=this._client;this._close(),t&&"destroy"in t&&By.clients.get(this)===t&&t.destroy(),By.clients.delete(this),t?.remoteClient&&(t.remoteClient=null)}_onInvokeMessage(t){const{methodName:e,jobId:i,data:n=[],abortable:s}=t,r=s?new AbortController:null,o=this._inJobs;let a,l=this._client,u=l[e];try{if(!u&&e&&e.includes(".")){const t=e.split(".");for(let e=0;e<t.length-1;e++)l=l[t[e]],u=l[t[e+1]]}if("function"!=typeof u)throw new TypeError(`${e} is not a function`);n.push({client:this,signal:r?r.signal:null}),a=u.apply(l,n)}catch(t){return void this._post({type:Fy,jobId:i,error:ky(t)})}Fs(a)?(o.set(i,{controller:r,promise:a}),a.then((t=>{o.has(i)&&(o.delete(i),this._post({type:Fy,jobId:i},t))}),(t=>{o.has(i)&&(o.delete(i),Es(t)||this._post({type:Fy,jobId:i,error:ky(t||{message:`Error encountered at method ${e}`})}))}))):this._post({type:Fy,jobId:i},a)}_onOpenPortMessage(t){new By(t.port,{client:this._client})}_onOnMessage(t){const{port:e}=t,i=this._client.on(t.eventType,(t=>{e.postMessage(t)})),n=vs(t.port,"message",(t=>{const s=Ey(t);s?.type===My.CLOSE&&(n.remove(),i.remove(),e.close())}))}_onResponseMessage(t){const{jobId:e,error:i,data:n}=t,s=this._outJobs;if(!s.has(e))return;const r=s.get(e);s.delete(e),this._processWork(),kn(r.abortHandle),i?r.reject(Ve.fromJSON(JSON.parse(i))):r.resolve(n)}_post(t,e,i){return Cy(this._port,t,e,i)}}By.kernelInfo={buildDate:vl,fullVersion:_l,revision:wl},By.clients=new Map;class Gy{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new yy}destroy(){this.close()}get closed(){return!this._clients?.length}open(t,e){return new Promise(((i,n)=>{let s=!0;const r=t=>{_s(e.signal),s&&(s=!1,t())};this._clients.length=t.length,this._clientPromises.length=t.length,this._inUseClients.length=t.length;for(let s=0;s<t.length;++s){const o=t[s];Fs(o)?this._clientPromises[s]=o.then((t=>(this._clients[s]=new By(t,e,this._ongoingJobsQueue),r(i),this._clients[s])),(()=>(r(n),null))):(this._clients[s]=new By(o,e,this._ongoingJobsQueue),this._clientPromises[s]=Promise.resolve(this._clients[s]),r(i))}}))}broadcast(t,e,i){const n=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const r=this._clientPromises[s];n[s]=r.then((n=>n?.invoke(t,e,i)))}return n}close(){let t;for(;t=this._ongoingJobsQueue.pop();)t.resolver.reject(Ss(`Worker closing, aborting job calling '${t.methodName}'`));for(const t of this._clientPromises)t.then((t=>t?.close()));this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,wy(this)}invoke(t,e,i){return this.apply(t,[e],i)}apply(t,e,i){const n=zs();this._ongoingJobsQueue.push({methodName:t,data:e,invokeOptions:i,resolver:n});for(let t=0;t<this._clientPromises.length;t++){const e=this._clients[t];e?e.jobAdded():this._clientPromises[t].then((t=>t?.jobAdded()))}return n.promise}createInvokeProxy(t){return by(this,t)}on(t,e){return Promise.all(this._clientPromises).then((()=>Se(this._clients.map((i=>i.on(t,e))))))}openPorts(){return new Promise((t=>{const e=new Array(this._clientPromises.length);let i=e.length;for(let n=0;n<this._clientPromises.length;++n){this._clientPromises[n].then((s=>{s&&(e[n]=s.openPort()),0==--i&&t(e)}))}}))}get test(){}}const Vy={async request(t,e){const i=t.options,n=i.responseType;i.signal=e?.signal,i.responseType="native"===n||"native-request-init"===n?"native-request-init":n&&["blob","json","text"].includes(n)&&xa(t.url)?.after?n:"array-buffer";const s=await Pl(t.url,i),r={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch(s.requestOptions?.responseType){case"native-request-init":return delete r.data.signal,r;case"blob":r.data=await r.data.arrayBuffer();break;case"json":r.data=(new TextEncoder).encode(JSON.stringify(r.data)).buffer;break;case"text":r.data=(new TextEncoder).encode(r.data).buffer}return{result:r,transferList:[r.data]}}};let qy;const Hy=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,Wy=globalThis.document?.documentElement;function Zy(){const t=Wy?.getAttribute("lang"),e=globalThis.navigator?.language;return Hy??t??e??"en"}function Jy(){return void 0===qy&&(qy=Zy()),qy}function Yy(t=Jy()){const e=/^([a-zA-Z]{2,3})(?:[_-][a-zA-Z0-9]+)*$/.exec(t);return e?.[1].toLowerCase()}const Ky=[];function Qy(t){return Ky.push(t),we((()=>Ky.splice(Ky.indexOf(t),1)))}const Xy=[];function tg(t){return Xy.push(t),we((()=>Xy.splice(Xy.indexOf(t),1)))}function eg(){const t=Zy();qy!==t&&([...Xy].forEach((e=>e(t))),qy=t,[...Ky].forEach((e=>e(t))))}if(globalThis.addEventListener?.("languagechange",eg),Wy){new MutationObserver((()=>{eg()})).observe(Wy,{attributeFilter:["lang"]})}const ig=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);function ng(t,e,i){return i={path:e,exports:{},require:function(t,e){return sg()}},t(i,i.exports),i.exports}function sg(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var rg=ng((function(t,e){Object.defineProperty(e,"__esModule",{value:true});function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,g(n.key),n)}}function n(t,e,n){if(e)i(t.prototype,e);if(n)i(t,n);Object.defineProperty(t,"prototype",{writable:false});return t}function s(){s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i){if(Object.prototype.hasOwnProperty.call(i,n)){t[n]=i[n]}}}return t};return s.apply(this,arguments)}function r(t,e){t.prototype=Object.create(e.prototype);t.prototype.constructor=t;a(t,e)}function o(t){o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function t(e){return e.__proto__||Object.getPrototypeOf(e)};return o(t)}function a(t,e){a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,i){e.__proto__=i;return e};return a(t,e)}function l(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(t){return false}}function u(t,e,i){if(l()){u=Reflect.construct.bind()}else{u=function t(e,i,n){var s=[null];s.push.apply(s,i);var r=Function.bind.apply(e,s);var o=new r;if(n)a(o,n.prototype);return o}}return u.apply(null,arguments)}function c(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function h(t){var e=typeof Map==="function"?new Map:undefined;h=function t(i){if(i===null||!c(i))return i;if(typeof i!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof e!=="undefined"){if(e.has(i))return e.get(i);e.set(i,n)}function n(){return u(i,arguments,o(this).constructor)}n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:false,writable:true,configurable:true}});return a(n,i)};return h(t)}function d(t,e){if(t==null)return{};var i={};var n=Object.keys(t);var s,r;for(r=0;r<n.length;r++){s=n[r];if(e.indexOf(s)>=0)continue;i[s]=t[s]}return i}function f(t,e){if(!t)return;if(typeof t==="string")return p(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor)i=t.constructor.name;if(i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(t,e)}function p(t,e){if(e==null||e>t.length)e=t.length;for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function m(t,e){var i=typeof Symbol!=="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=f(t))||e&&t&&typeof t.length==="number"){if(i)t=i;var n=0;return function(){if(n>=t.length)return{done:true};return{done:false,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(t,e){if(typeof t!=="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==undefined){var n=i.call(t,e||"default");if(typeof n!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g(t){var e=y(t,"string");return typeof e==="symbol"?e:String(e)}var v=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}return e}(h(Error));var w=function(t){r(e,t);function e(e){return t.call(this,"Invalid DateTime: "+e.toMessage())||this}return e}(v);var b=function(t){r(e,t);function e(e){return t.call(this,"Invalid Interval: "+e.toMessage())||this}return e}(v);var S=function(t){r(e,t);function e(e){return t.call(this,"Invalid Duration: "+e.toMessage())||this}return e}(v);var _=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}return e}(v);var x=function(t){r(e,t);function e(e){return t.call(this,"Invalid unit "+e)||this}return e}(v);var M=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}return e}(v);var T=function(t){r(e,t);function e(){return t.call(this,"Zone is an abstract class")||this}return e}(v);var A="numeric",I="short",k="long";var C={year:A,month:A,day:A};var E={year:A,month:I,day:A};var j={year:A,month:I,day:A,weekday:I};var O={year:A,month:k,day:A};var R={year:A,month:k,day:A,weekday:k};var L={hour:A,minute:A};var N={hour:A,minute:A,second:A};var P={hour:A,minute:A,second:A,timeZoneName:I};var F={hour:A,minute:A,second:A,timeZoneName:k};var D={hour:A,minute:A,hourCycle:"h23"};var $={hour:A,minute:A,second:A,hourCycle:"h23"};var z={hour:A,minute:A,second:A,hourCycle:"h23",timeZoneName:I};var U={hour:A,minute:A,second:A,hourCycle:"h23",timeZoneName:k};var B={year:A,month:A,day:A,hour:A,minute:A};var G={year:A,month:A,day:A,hour:A,minute:A,second:A};var V={year:A,month:I,day:A,hour:A,minute:A};var q={year:A,month:I,day:A,hour:A,minute:A,second:A};var H={year:A,month:I,day:A,weekday:I,hour:A,minute:A};var W={year:A,month:k,day:A,hour:A,minute:A,timeZoneName:I};var Z={year:A,month:k,day:A,hour:A,minute:A,second:A,timeZoneName:I};var J={year:A,month:k,day:A,weekday:k,hour:A,minute:A,timeZoneName:k};var Y={year:A,month:k,day:A,weekday:k,hour:A,minute:A,second:A,timeZoneName:k};var K=function(){function t(){}var e=t.prototype;e.offsetName=function t(e,i){throw new T};e.formatOffset=function t(e,i){throw new T};e.offset=function t(e){throw new T};e.equals=function t(e){throw new T};n(t,[{key:"type",get:function t(){throw new T}},{key:"name",get:function t(){throw new T}},{key:"ianaName",get:function t(){return this.name}},{key:"isUniversal",get:function t(){throw new T}},{key:"isValid",get:function t(){throw new T}}]);return t}();var Q=null;var X=function(t){r(e,t);function e(){return t.apply(this,arguments)||this}var i=e.prototype;i.offsetName=function t(e,i){var n=i.format,s=i.locale;return Ue(e,n,s)};i.formatOffset=function t(e,i){return qe(this.offset(e),i)};i.offset=function t(e){return-new Date(e).getTimezoneOffset()};i.equals=function t(e){return e.type==="system"};n(e,[{key:"type",get:function t(){return"system"}},{key:"name",get:function t(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}},{key:"isUniversal",get:function t(){return false}},{key:"isValid",get:function t(){return true}}],[{key:"instance",get:function t(){if(Q===null){Q=new e}return Q}}]);return e}(K);var tt={};function et(t){if(!tt[t]){tt[t]=new Intl.DateTimeFormat("en-US",{hour12:false,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})}return tt[t]}var it={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function nt(t,e){var i=t.format(e).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),s=n[1],r=n[2],o=n[3],a=n[4],l=n[5],u=n[6],c=n[7];return[o,s,r,a,l,u,c]}function st(t,e){var i=t.formatToParts(e);var n=[];for(var s=0;s<i.length;s++){var r=i[s],o=r.type,a=r.value;var l=it[o];if(o==="era"){n[l]=a}else if(!me(l)){n[l]=parseInt(a,10)}}return n}var rt={};var ot=function(t){r(e,t);e.create=function t(i){if(!rt[i]){rt[i]=new e(i)}return rt[i]};e.resetCache=function t(){rt={};tt={}};e.isValidSpecifier=function t(e){return this.isValidZone(e)};e.isValidZone=function t(e){if(!e){return false}try{new Intl.DateTimeFormat("en-US",{timeZone:e}).format();return true}catch(t){return false}};function e(i){var n;n=t.call(this)||this;n.zoneName=i;n.valid=e.isValidZone(i);return n}var i=e.prototype;i.offsetName=function t(e,i){var n=i.format,s=i.locale;return Ue(e,n,s,this.name)};i.formatOffset=function t(e,i){return qe(this.offset(e),i)};i.offset=function t(e){var i=new Date(e);if(isNaN(i))return NaN;var n=et(this.name);var s=n.formatToParts?st(n,i):nt(n,i),r=s[0],o=s[1],a=s[2],l=s[3],u=s[4],c=s[5],h=s[6];if(l==="BC"){r=-Math.abs(r)+1}var d=u===24?0:u;var f=Fe({year:r,month:o,day:a,hour:d,minute:c,second:h,millisecond:0});var p=+i;var m=p%1e3;p-=m>=0?m:1e3+m;return(f-p)/(60*1e3)};i.equals=function t(e){return e.type==="iana"&&e.name===this.name};n(e,[{key:"type",get:function t(){return"iana"}},{key:"name",get:function t(){return this.zoneName}},{key:"isUniversal",get:function t(){return false}},{key:"isValid",get:function t(){return this.valid}}]);return e}(K);var at=["base"],lt=["padTo","floor"];var ut={};function ct(t,e){if(e===void 0){e={}}var i=JSON.stringify([t,e]);var n=ut[i];if(!n){n=new Intl.ListFormat(t,e);ut[i]=n}return n}var ht={};function dt(t,e){if(e===void 0){e={}}var i=JSON.stringify([t,e]);var n=ht[i];if(!n){n=new Intl.DateTimeFormat(t,e);ht[i]=n}return n}var ft={};function pt(t,e){if(e===void 0){e={}}var i=JSON.stringify([t,e]);var n=ft[i];if(!n){n=new Intl.NumberFormat(t,e);ft[i]=n}return n}var mt={};function yt(t,e){if(e===void 0){e={}}var i=e;var n=d(i,at);var s=JSON.stringify([t,n]);var r=mt[s];if(!r){r=new Intl.RelativeTimeFormat(t,e);mt[s]=r}return r}var gt=null;function vt(){if(gt){return gt}else{gt=(new Intl.DateTimeFormat).resolvedOptions().locale;return gt}}var wt={};function bt(t){var e=wt[t];if(!e){var i=new Intl.Locale(t);e="getWeekInfo"in i?i.getWeekInfo():i.weekInfo;wt[t]=e}return e}function St(t){var e=t.indexOf("-x-");if(e!==-1){t=t.substring(0,e)}var i=t.indexOf("-u-");if(i===-1){return[t]}else{var n;var s;try{n=dt(t).resolvedOptions();s=t}catch(e){var r=t.substring(0,i);n=dt(r).resolvedOptions();s=r}var o=n,a=o.numberingSystem,l=o.calendar;return[s,a,l]}}function _t(t,e,i){if(i||e){if(!t.includes("-u-")){t+="-u"}if(i){t+="-ca-"+i}if(e){t+="-nu-"+e}return t}else{return t}}function xt(t){var e=[];for(var i=1;i<=12;i++){var n=Ls.utc(2009,i,1);e.push(t(n))}return e}function Mt(t){var e=[];for(var i=1;i<=7;i++){var n=Ls.utc(2016,11,13+i);e.push(t(n))}return e}function Tt(t,e,i,n){var s=t.listingMode();if(s==="error"){return null}else if(s==="en"){return i(e)}else{return n(e)}}function At(t){if(t.numberingSystem&&t.numberingSystem!=="latn"){return false}else{return t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}}var It=function(){function t(t,e,i){this.padTo=i.padTo||0;this.floor=i.floor||false;var n=d(i,lt);if(!e||Object.keys(n).length>0){var r=s({useGrouping:false},i);if(i.padTo>0)r.minimumIntegerDigits=i.padTo;this.inf=pt(t,r)}}var e=t.prototype;e.format=function t(e){if(this.inf){var i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{var n=this.floor?Math.floor(e):Re(e,3);return Ce(n,this.padTo)}};return t}();var kt=function(){function t(t,e,i){this.opts=i;this.originalZone=undefined;var n=undefined;if(this.opts.timeZone){this.dt=t}else if(t.zone.type==="fixed"){var r=-1*(t.offset/60);var o=r>=0?"Etc/GMT+"+r:"Etc/GMT"+r;if(t.offset!==0&&ot.create(o).valid){n=o;this.dt=t}else{n="UTC";this.dt=t.offset===0?t:t.setZone("UTC").plus({minutes:t.offset});this.originalZone=t.zone}}else if(t.zone.type==="system"){this.dt=t}else if(t.zone.type==="iana"){this.dt=t;n=t.zone.name}else{n="UTC";this.dt=t.setZone("UTC").plus({minutes:t.offset});this.originalZone=t.zone}var a=s({},this.opts);a.timeZone=a.timeZone||n;this.dtf=dt(e,a)}var e=t.prototype;e.format=function t(){if(this.originalZone){return this.formatToParts().map((function(t){var e=t.value;return e})).join("")}return this.dtf.format(this.dt.toJSDate())};e.formatToParts=function t(){var e=this;var i=this.dtf.formatToParts(this.dt.toJSDate());if(this.originalZone){return i.map((function(t){if(t.type==="timeZoneName"){var i=e.originalZone.offsetName(e.dt.ts,{locale:e.dt.locale,format:e.opts.timeZoneName});return s({},t,{value:i})}else{return t}}))}return i};e.resolvedOptions=function t(){return this.dtf.resolvedOptions()};return t}();var Ct=function(){function t(t,e,i){this.opts=s({style:"long"},i);if(!e&&be()){this.rtf=yt(t,i)}}var e=t.prototype;e.format=function t(e,i){if(this.rtf){return this.rtf.format(e,i)}else{return ci(i,e,this.opts.numeric,this.opts.style!=="long")}};e.formatToParts=function t(e,i){if(this.rtf){return this.rtf.formatToParts(e,i)}else{return[]}};return t}();var Et={firstDay:1,minimalDays:4,weekend:[6,7]};var jt=function(){t.fromOpts=function e(i){return t.create(i.locale,i.numberingSystem,i.outputCalendar,i.weekSettings,i.defaultToEN)};t.create=function e(i,n,s,r,o){if(o===void 0){o=false}var a=i||Kt.defaultLocale;var l=a||(o?"en-US":vt());var u=n||Kt.defaultNumberingSystem;var c=s||Kt.defaultOutputCalendar;var h=Ae(r)||Kt.defaultWeekSettings;return new t(l,u,c,h,a)};t.resetCache=function t(){gt=null;ht={};ft={};mt={}};t.fromObject=function e(i){var n=i===void 0?{}:i,s=n.locale,r=n.numberingSystem,o=n.outputCalendar,a=n.weekSettings;return t.create(s,r,o,a)};function t(t,e,i,n,s){var r=St(t),o=r[0],a=r[1],l=r[2];this.locale=o;this.numberingSystem=e||a||null;this.outputCalendar=i||l||null;this.weekSettings=n;this.intl=_t(this.locale,this.numberingSystem,this.outputCalendar);this.weekdaysCache={format:{},standalone:{}};this.monthsCache={format:{},standalone:{}};this.meridiemCache=null;this.eraCache={};this.specifiedLocale=s;this.fastNumbersCached=null}var e=t.prototype;e.listingMode=function t(){var e=this.isEnglish();var i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"};e.clone=function e(i){if(!i||Object.getOwnPropertyNames(i).length===0){return this}else{return t.create(i.locale||this.specifiedLocale,i.numberingSystem||this.numberingSystem,i.outputCalendar||this.outputCalendar,Ae(i.weekSettings)||this.weekSettings,i.defaultToEN||false)}};e.redefaultToEN=function t(e){if(e===void 0){e={}}return this.clone(s({},e,{defaultToEN:true}))};e.redefaultToSystem=function t(e){if(e===void 0){e={}}return this.clone(s({},e,{defaultToEN:false}))};e.months=function t(e,i){var n=this;if(i===void 0){i=false}return Tt(this,e,Ye,(function(){var t=i?{month:e,day:"numeric"}:{month:e},s=i?"format":"standalone";if(!n.monthsCache[s][e]){n.monthsCache[s][e]=xt((function(e){return n.extract(e,t,"month")}))}return n.monthsCache[s][e]}))};e.weekdays=function t(e,i){var n=this;if(i===void 0){i=false}return Tt(this,e,ti,(function(){var t=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=i?"format":"standalone";if(!n.weekdaysCache[s][e]){n.weekdaysCache[s][e]=Mt((function(e){return n.extract(e,t,"weekday")}))}return n.weekdaysCache[s][e]}))};e.meridiems=function t(){var e=this;return Tt(this,undefined,(function(){return ei}),(function(){if(!e.meridiemCache){var t={hour:"numeric",hourCycle:"h12"};e.meridiemCache=[Ls.utc(2016,11,13,9),Ls.utc(2016,11,13,19)].map((function(i){return e.extract(i,t,"dayperiod")}))}return e.meridiemCache}))};e.eras=function t(e){var i=this;return Tt(this,e,ri,(function(){var t={era:e};if(!i.eraCache[e]){i.eraCache[e]=[Ls.utc(-40,1,1),Ls.utc(2017,1,1)].map((function(e){return i.extract(e,t,"era")}))}return i.eraCache[e]}))};e.extract=function t(e,i,n){var s=this.dtFormatter(e,i),r=s.formatToParts(),o=r.find((function(t){return t.type.toLowerCase()===n}));return o?o.value:null};e.numberFormatter=function t(e){if(e===void 0){e={}}return new It(this.intl,e.forceSimple||this.fastNumbers,e)};e.dtFormatter=function t(e,i){if(i===void 0){i={}}return new kt(e,this.intl,i)};e.relFormatter=function t(e){if(e===void 0){e={}}return new Ct(this.intl,this.isEnglish(),e)};e.listFormatter=function t(e){if(e===void 0){e={}}return ct(this.intl,e)};e.isEnglish=function t(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")};e.getWeekSettings=function t(){if(this.weekSettings){return this.weekSettings}else if(!Se()){return Et}else{return bt(this.locale)}};e.getStartOfWeek=function t(){return this.getWeekSettings().firstDay};e.getMinDaysInFirstWeek=function t(){return this.getWeekSettings().minimalDays};e.getWeekendDays=function t(){return this.getWeekSettings().weekend};e.equals=function t(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar};e.toString=function t(){return"Locale("+this.locale+", "+this.numberingSystem+", "+this.outputCalendar+")"};n(t,[{key:"fastNumbers",get:function t(){if(this.fastNumbersCached==null){this.fastNumbersCached=At(this)}return this.fastNumbersCached}}]);return t}();var Ot=null;var Rt=function(t){r(e,t);e.instance=function t(i){return i===0?e.utcInstance:new e(i)};e.parseSpecifier=function t(i){if(i){var n=i.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n){return new e(Be(n[1],n[2]))}}return null};function e(e){var i;i=t.call(this)||this;i.fixed=e;return i}var i=e.prototype;i.offsetName=function t(){return this.name};i.formatOffset=function t(e,i){return qe(this.fixed,i)};i.offset=function t(){return this.fixed};i.equals=function t(e){return e.type==="fixed"&&e.fixed===this.fixed};n(e,[{key:"type",get:function t(){return"fixed"}},{key:"name",get:function t(){return this.fixed===0?"UTC":"UTC"+qe(this.fixed,"narrow")}},{key:"ianaName",get:function t(){if(this.fixed===0){return"Etc/UTC"}else{return"Etc/GMT"+qe(-this.fixed,"narrow")}}},{key:"isUniversal",get:function t(){return true}},{key:"isValid",get:function t(){return true}}],[{key:"utcInstance",get:function t(){if(Ot===null){Ot=new e(0)}return Ot}}]);return e}(K);var Lt=function(t){r(e,t);function e(e){var i;i=t.call(this)||this;i.zoneName=e;return i}var i=e.prototype;i.offsetName=function t(){return null};i.formatOffset=function t(){return""};i.offset=function t(){return NaN};i.equals=function t(){return false};n(e,[{key:"type",get:function t(){return"invalid"}},{key:"name",get:function t(){return this.zoneName}},{key:"isUniversal",get:function t(){return false}},{key:"isValid",get:function t(){return false}}]);return e}(K);function Nt(t,e){if(me(t)||t===null){return e}else if(t instanceof K){return t}else if(ve(t)){var i=t.toLowerCase();if(i==="default")return e;else if(i==="local"||i==="system")return X.instance;else if(i==="utc"||i==="gmt")return Rt.utcInstance;else return Rt.parseSpecifier(i)||ot.create(t)}else if(ye(t)){return Rt.instance(t)}else if(typeof t==="object"&&"offset"in t&&typeof t.offset==="function"){return t}else{return new Lt(t)}}var Pt={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"};var Ft={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]};var Dt=Pt.hanidec.replace(/[\[|\]]/g,"").split("");function $t(t){var e=parseInt(t,10);if(isNaN(e)){e="";for(var i=0;i<t.length;i++){var n=t.charCodeAt(i);if(t[i].search(Pt.hanidec)!==-1){e+=Dt.indexOf(t[i])}else{for(var s in Ft){var r=Ft[s],o=r[0],a=r[1];if(n>=o&&n<=a){e+=n-o}}}}return parseInt(e,10)}else{return e}}var zt={};function Ut(){zt={}}function Bt(t,e){var i=t.numberingSystem;if(e===void 0){e=""}var n=i||"latn";if(!zt[n]){zt[n]={}}if(!zt[n][e]){zt[n][e]=new RegExp(""+Pt[n]+e)}return zt[n][e]}var Gt=function t(){return Date.now()},Vt="system",qt=null,Ht=null,Wt=null,Zt=60,Jt,Yt=null;var Kt=function(){function t(){}t.resetCaches=function t(){jt.resetCache();ot.resetCache();Ls.resetCache();Ut()};n(t,null,[{key:"now",get:function t(){return Gt},set:function t(e){Gt=e}},{key:"defaultZone",get:function t(){return Nt(Vt,X.instance)},set:function t(e){Vt=e}},{key:"defaultLocale",get:function t(){return qt},set:function t(e){qt=e}},{key:"defaultNumberingSystem",get:function t(){return Ht},set:function t(e){Ht=e}},{key:"defaultOutputCalendar",get:function t(){return Wt},set:function t(e){Wt=e}},{key:"defaultWeekSettings",get:function t(){return Yt},set:function t(e){Yt=Ae(e)}},{key:"twoDigitCutoffYear",get:function t(){return Zt},set:function t(e){Zt=e%100}},{key:"throwOnInvalid",get:function t(){return Jt},set:function t(e){Jt=e}}]);return t}();var Qt=function(){function t(t,e){this.reason=t;this.explanation=e}var e=t.prototype;e.toMessage=function t(){if(this.explanation){return this.reason+": "+this.explanation}else{return this.reason}};return t}();var Xt=[0,31,59,90,120,151,181,212,243,273,304,334],te=[0,31,60,91,121,152,182,213,244,274,305,335];function ee(t,e){return new Qt("unit out of range","you specified "+e+" (of type "+typeof e+") as a "+t+", which is invalid")}function ie(t,e,i){var n=new Date(Date.UTC(t,e-1,i));if(t<100&&t>=0){n.setUTCFullYear(n.getUTCFullYear()-1900)}var s=n.getUTCDay();return s===0?7:s}function ne(t,e,i){return i+(Le(t)?te:Xt)[e-1]}function se(t,e){var i=Le(t)?te:Xt,n=i.findIndex((function(t){return t<e})),s=e-i[n];return{month:n+1,day:s}}function re(t,e){return(t-e+7)%7+1}function oe(t,e,i){if(e===void 0){e=4}if(i===void 0){i=1}var n=t.year,r=t.month,o=t.day,a=ne(n,r,o),l=re(ie(n,r,o),i);var u=Math.floor((a-l+14-e)/7),c;if(u<1){c=n-1;u=$e(c,e,i)}else if(u>$e(n,e,i)){c=n+1;u=1}else{c=n}return s({weekYear:c,weekNumber:u,weekday:l},He(t))}function ae(t,e,i){if(e===void 0){e=4}if(i===void 0){i=1}var n=t.weekYear,r=t.weekNumber,o=t.weekday,a=re(ie(n,1,e),i),l=Ne(n);var u=r*7+o-a-7+e,c;if(u<1){c=n-1;u+=Ne(c)}else if(u>l){c=n+1;u-=Ne(n)}else{c=n}var h=se(c,u),d=h.month,f=h.day;return s({year:c,month:d,day:f},He(t))}function le(t){var e=t.year,i=t.month,n=t.day;var r=ne(e,i,n);return s({year:e,ordinal:r},He(t))}function ue(t){var e=t.year,i=t.ordinal;var n=se(e,i),r=n.month,o=n.day;return s({year:e,month:r,day:o},He(t))}function ce(t,e){var i=!me(t.localWeekday)||!me(t.localWeekNumber)||!me(t.localWeekYear);if(i){var n=!me(t.weekday)||!me(t.weekNumber)||!me(t.weekYear);if(n){throw new _("Cannot mix locale-based week fields with ISO-based week fields")}if(!me(t.localWeekday))t.weekday=t.localWeekday;if(!me(t.localWeekNumber))t.weekNumber=t.localWeekNumber;if(!me(t.localWeekYear))t.weekYear=t.localWeekYear;delete t.localWeekday;delete t.localWeekNumber;delete t.localWeekYear;return{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else{return{minDaysInFirstWeek:4,startOfWeek:1}}}function he(t,e,i){if(e===void 0){e=4}if(i===void 0){i=1}var n=ge(t.weekYear),s=Ie(t.weekNumber,1,$e(t.weekYear,e,i)),r=Ie(t.weekday,1,7);if(!n){return ee("weekYear",t.weekYear)}else if(!s){return ee("week",t.weekNumber)}else if(!r){return ee("weekday",t.weekday)}else return false}function de(t){var e=ge(t.year),i=Ie(t.ordinal,1,Ne(t.year));if(!e){return ee("year",t.year)}else if(!i){return ee("ordinal",t.ordinal)}else return false}function fe(t){var e=ge(t.year),i=Ie(t.month,1,12),n=Ie(t.day,1,Pe(t.year,t.month));if(!e){return ee("year",t.year)}else if(!i){return ee("month",t.month)}else if(!n){return ee("day",t.day)}else return false}function pe(t){var e=t.hour,i=t.minute,n=t.second,s=t.millisecond;var r=Ie(e,0,23)||e===24&&i===0&&n===0&&s===0,o=Ie(i,0,59),a=Ie(n,0,59),l=Ie(s,0,999);if(!r){return ee("hour",e)}else if(!o){return ee("minute",i)}else if(!a){return ee("second",n)}else if(!l){return ee("millisecond",s)}else return false}function me(t){return typeof t==="undefined"}function ye(t){return typeof t==="number"}function ge(t){return typeof t==="number"&&t%1===0}function ve(t){return typeof t==="string"}function we(t){return Object.prototype.toString.call(t)==="[object Date]"}function be(){try{return typeof Intl!=="undefined"&&!!Intl.RelativeTimeFormat}catch(t){return false}}function Se(){try{return typeof Intl!=="undefined"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch(t){return false}}function _e(t){return Array.isArray(t)?t:[t]}function xe(t,e,i){if(t.length===0){return undefined}return t.reduce((function(t,n){var s=[e(n),n];if(!t){return s}else if(i(t[0],s[0])===t[0]){return t}else{return s}}),null)[1]}function Me(t,e){return e.reduce((function(e,i){e[i]=t[i];return e}),{})}function Te(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ae(t){if(t==null){return null}else if(typeof t!=="object"){throw new M("Week settings must be an object")}else{if(!Ie(t.firstDay,1,7)||!Ie(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some((function(t){return!Ie(t,1,7)}))){throw new M("Invalid week settings")}return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}}function Ie(t,e,i){return ge(t)&&t>=e&&t<=i}function ke(t,e){return t-e*Math.floor(t/e)}function Ce(t,e){if(e===void 0){e=2}var i=t<0;var n;if(i){n="-"+(""+-t).padStart(e,"0")}else{n=(""+t).padStart(e,"0")}return n}function Ee(t){if(me(t)||t===null||t===""){return undefined}else{return parseInt(t,10)}}function je(t){if(me(t)||t===null||t===""){return undefined}else{return parseFloat(t)}}function Oe(t){if(me(t)||t===null||t===""){return undefined}else{var e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function Re(t,e,i){if(i===void 0){i=false}var n=Math.pow(10,e),s=i?Math.trunc:Math.round;return s(t*n)/n}function Le(t){return t%4===0&&(t%100!==0||t%400===0)}function Ne(t){return Le(t)?366:365}function Pe(t,e){var i=ke(e-1,12)+1,n=t+(e-i)/12;if(i===2){return Le(n)?29:28}else{return[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}}function Fe(t){var e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);if(t.year<100&&t.year>=0){e=new Date(e);e.setUTCFullYear(t.year,t.month-1,t.day)}return+e}function De(t,e,i){var n=re(ie(t,1,e),i);return-n+e-1}function $e(t,e,i){if(e===void 0){e=4}if(i===void 0){i=1}var n=De(t,e,i);var s=De(t+1,e,i);return(Ne(t)-n+s)/7}function ze(t){if(t>99){return t}else return t>Kt.twoDigitCutoffYear?1900+t:2e3+t}function Ue(t,e,i,n){if(n===void 0){n=null}var r=new Date(t),o={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};if(n){o.timeZone=n}var a=s({timeZoneName:e},o);var l=new Intl.DateTimeFormat(i,a).formatToParts(r).find((function(t){return t.type.toLowerCase()==="timezonename"}));return l?l.value:null}function Be(t,e){var i=parseInt(t,10);if(Number.isNaN(i)){i=0}var n=parseInt(e,10)||0,s=i<0||Object.is(i,-0)?-n:n;return i*60+s}function Ge(t){var e=Number(t);if(typeof t==="boolean"||t===""||Number.isNaN(e))throw new M("Invalid unit value "+t);return e}function Ve(t,e){var i={};for(var n in t){if(Te(t,n)){var s=t[n];if(s===undefined||s===null)continue;i[e(n)]=Ge(s)}}return i}function qe(t,e){var i=Math.trunc(Math.abs(t/60)),n=Math.trunc(Math.abs(t%60)),s=t>=0?"+":"-";switch(e){case"short":return""+s+Ce(i,2)+":"+Ce(n,2);case"narrow":return""+s+i+(n>0?":"+n:"");case"techie":return""+s+Ce(i,2)+Ce(n,2);default:throw new RangeError("Value format "+e+" is out of range for property format")}}function He(t){return Me(t,["hour","minute","second","millisecond"])}var We=["January","February","March","April","May","June","July","August","September","October","November","December"];var Ze=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var Je=["J","F","M","A","M","J","J","A","S","O","N","D"];function Ye(t){switch(t){case"narrow":return[].concat(Je);case"short":return[].concat(Ze);case"long":return[].concat(We);case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var Ke=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];var Qe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];var Xe=["M","T","W","T","F","S","S"];function ti(t){switch(t){case"narrow":return[].concat(Xe);case"short":return[].concat(Qe);case"long":return[].concat(Ke);case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var ei=["AM","PM"];var ii=["Before Christ","Anno Domini"];var ni=["BC","AD"];var si=["B","A"];function ri(t){switch(t){case"narrow":return[].concat(si);case"short":return[].concat(ni);case"long":return[].concat(ii);default:return null}}function oi(t){return ei[t.hour<12?0:1]}function ai(t,e){return ti(e)[t.weekday-1]}function li(t,e){return Ye(e)[t.month-1]}function ui(t,e){return ri(e)[t.year<0?0:1]}function ci(t,e,i,n){if(i===void 0){i="always"}if(n===void 0){n=false}var s={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]};var r=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&r){var o=t==="days";switch(e){case 1:return o?"tomorrow":"next "+s[t][0];case-1:return o?"yesterday":"last "+s[t][0];case 0:return o?"today":"this "+s[t][0]}}var a=Object.is(e,-0)||e<0,l=Math.abs(e),u=l===1,c=s[t],h=n?u?c[1]:c[2]||c[1]:u?s[t][0]:t;return a?l+" "+h+" ago":"in "+l+" "+h}function hi(t,e){var i="";for(var n=m(t),s;!(s=n()).done;){var r=s.value;if(r.literal){i+=r.val}else{i+=e(r.val)}}return i}var di={D:C,DD:E,DDD:O,DDDD:R,t:L,tt:N,ttt:P,tttt:F,T:D,TT:$,TTT:z,TTTT:U,f:B,ff:V,fff:W,ffff:J,F:G,FF:q,FFF:Z,FFFF:Y};var fi=function(){t.create=function e(i,n){if(n===void 0){n={}}return new t(i,n)};t.parseFormat=function t(e){var i=null,n="",s=false;var r=[];for(var o=0;o<e.length;o++){var a=e.charAt(o);if(a==="'"){if(n.length>0){r.push({literal:s||/^\s+$/.test(n),val:n})}i=null;n="";s=!s}else if(s){n+=a}else if(a===i){n+=a}else{if(n.length>0){r.push({literal:/^\s+$/.test(n),val:n})}n=a;i=a}}if(n.length>0){r.push({literal:s||/^\s+$/.test(n),val:n})}return r};t.macroTokenToFormatOpts=function t(e){return di[e]};function t(t,e){this.opts=e;this.loc=t;this.systemLoc=null}var e=t.prototype;e.formatWithSystemDefault=function t(e,i){if(this.systemLoc===null){this.systemLoc=this.loc.redefaultToSystem()}var n=this.systemLoc.dtFormatter(e,s({},this.opts,i));return n.format()};e.dtFormatter=function t(e,i){if(i===void 0){i={}}return this.loc.dtFormatter(e,s({},this.opts,i))};e.formatDateTime=function t(e,i){return this.dtFormatter(e,i).format()};e.formatDateTimeParts=function t(e,i){return this.dtFormatter(e,i).formatToParts()};e.formatInterval=function t(e,i){var n=this.dtFormatter(e.start,i);return n.dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())};e.resolvedOptions=function t(e,i){return this.dtFormatter(e,i).resolvedOptions()};e.num=function t(e,i){if(i===void 0){i=0}if(this.opts.forceSimple){return Ce(e,i)}var n=s({},this.opts);if(i>0){n.padTo=i}return this.loc.numberFormatter(n).format(e)};e.formatDateTimeFromString=function e(i,n){var s=this;var r=this.loc.listingMode()==="en",o=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",a=function t(e,n){return s.loc.extract(i,e,n)},l=function t(e){if(i.isOffsetFixed&&i.offset===0&&e.allowZ){return"Z"}return i.isValid?i.zone.formatOffset(i.ts,e.format):""},u=function t(){return r?oi(i):a({hour:"numeric",hourCycle:"h12"},"dayperiod")},c=function t(e,n){return r?li(i,e):a(n?{month:e}:{month:e,day:"numeric"},"month")},h=function t(e,n){return r?ai(i,e):a(n?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday")},d=function e(n){var r=t.macroTokenToFormatOpts(n);if(r){return s.formatWithSystemDefault(i,r)}else{return n}},f=function t(e){return r?ui(i,e):a({era:e},"era")},p=function t(e){switch(e){case"S":return s.num(i.millisecond);case"u":case"SSS":return s.num(i.millisecond,3);case"s":return s.num(i.second);case"ss":return s.num(i.second,2);case"uu":return s.num(Math.floor(i.millisecond/10),2);case"uuu":return s.num(Math.floor(i.millisecond/100));case"m":return s.num(i.minute);case"mm":return s.num(i.minute,2);case"h":return s.num(i.hour%12===0?12:i.hour%12);case"hh":return s.num(i.hour%12===0?12:i.hour%12,2);case"H":return s.num(i.hour);case"HH":return s.num(i.hour,2);case"Z":return l({format:"narrow",allowZ:s.opts.allowZ});case"ZZ":return l({format:"short",allowZ:s.opts.allowZ});case"ZZZ":return l({format:"techie",allowZ:s.opts.allowZ});case"ZZZZ":return i.zone.offsetName(i.ts,{format:"short",locale:s.loc.locale});case"ZZZZZ":return i.zone.offsetName(i.ts,{format:"long",locale:s.loc.locale});case"z":return i.zoneName;case"a":return u();case"d":return o?a({day:"numeric"},"day"):s.num(i.day);case"dd":return o?a({day:"2-digit"},"day"):s.num(i.day,2);case"c":return s.num(i.weekday);case"ccc":return h("short",true);case"cccc":return h("long",true);case"ccccc":return h("narrow",true);case"E":return s.num(i.weekday);case"EEE":return h("short",false);case"EEEE":return h("long",false);case"EEEEE":return h("narrow",false);case"L":return o?a({month:"numeric",day:"numeric"},"month"):s.num(i.month);case"LL":return o?a({month:"2-digit",day:"numeric"},"month"):s.num(i.month,2);case"LLL":return c("short",true);case"LLLL":return c("long",true);case"LLLLL":return c("narrow",true);case"M":return o?a({month:"numeric"},"month"):s.num(i.month);case"MM":return o?a({month:"2-digit"},"month"):s.num(i.month,2);case"MMM":return c("short",false);case"MMMM":return c("long",false);case"MMMMM":return c("narrow",false);case"y":return o?a({year:"numeric"},"year"):s.num(i.year);case"yy":return o?a({year:"2-digit"},"year"):s.num(i.year.toString().slice(-2),2);case"yyyy":return o?a({year:"numeric"},"year"):s.num(i.year,4);case"yyyyyy":return o?a({year:"numeric"},"year"):s.num(i.year,6);case"G":return f("short");case"GG":return f("long");case"GGGGG":return f("narrow");case"kk":return s.num(i.weekYear.toString().slice(-2),2);case"kkkk":return s.num(i.weekYear,4);case"W":return s.num(i.weekNumber);case"WW":return s.num(i.weekNumber,2);case"n":return s.num(i.localWeekNumber);case"nn":return s.num(i.localWeekNumber,2);case"ii":return s.num(i.localWeekYear.toString().slice(-2),2);case"iiii":return s.num(i.localWeekYear,4);case"o":return s.num(i.ordinal);case"ooo":return s.num(i.ordinal,3);case"q":return s.num(i.quarter);case"qq":return s.num(i.quarter,2);case"X":return s.num(Math.floor(i.ts/1e3));case"x":return s.num(i.ts);default:return d(e)}};return hi(t.parseFormat(n),p)};e.formatDurationFromString=function e(i,n){var s=this;var r=function t(e){switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},o=function t(e){return function(t){var i=r(t);if(i){return s.num(e.get(i),t.length)}else{return t}}},a=t.parseFormat(n),l=a.reduce((function(t,e){var i=e.literal,n=e.val;return i?t:t.concat(n)}),[]),u=i.shiftTo.apply(i,l.map(r).filter((function(t){return t})));return hi(a,o(u))};return t}();var pi=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function mi(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++){e[i]=arguments[i]}var n=e.reduce((function(t,e){return t+e.source}),"");return RegExp("^"+n+"$")}function yi(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++){e[i]=arguments[i]}return function(t){return e.reduce((function(e,i){var n=e[0],r=e[1],o=e[2];var a=i(t,o),l=a[0],u=a[1],c=a[2];return[s({},n,l),u||r,c]}),[{},null,1]).slice(0,2)}}function gi(t){if(t==null){return[null,null]}for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++){i[n-1]=arguments[n]}for(var s=0,r=i;s<r.length;s++){var o=r[s],a=o[0],l=o[1];var u=a.exec(t);if(u){return l(u)}}return[null,null]}function vi(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++){e[i]=arguments[i]}return function(t,i){var n={};var s;for(s=0;s<e.length;s++){n[e[s]]=Ee(t[i+s])}return[n,null,i+s]}}var wi=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/;var bi="(?:"+wi.source+"?(?:\\[("+pi.source+")\\])?)?";var Si=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/;var _i=RegExp(""+Si.source+bi);var xi=RegExp("(?:T"+_i.source+")?");var Mi=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/;var Ti=/(\d{4})-?W(\d\d)(?:-?(\d))?/;var Ai=/(\d{4})-?(\d{3})/;var Ii=vi("weekYear","weekNumber","weekDay");var ki=vi("year","ordinal");var Ci=/(\d{4})-(\d\d)-(\d\d)/;var Ei=RegExp(Si.source+" ?(?:"+wi.source+"|("+pi.source+"))?");var ji=RegExp("(?: "+Ei.source+")?");function Oi(t,e,i){var n=t[e];return me(n)?i:Ee(n)}function Ri(t,e){var i={year:Oi(t,e),month:Oi(t,e+1,1),day:Oi(t,e+2,1)};return[i,null,e+3]}function Li(t,e){var i={hours:Oi(t,e,0),minutes:Oi(t,e+1,0),seconds:Oi(t,e+2,0),milliseconds:Oe(t[e+3])};return[i,null,e+4]}function Ni(t,e){var i=!t[e]&&!t[e+1],n=Be(t[e+1],t[e+2]),s=i?null:Rt.instance(n);return[{},s,e+3]}function Pi(t,e){var i=t[e]?ot.create(t[e]):null;return[{},i,e+1]}var Fi=RegExp("^T?"+Si.source+"$");var Di=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function $i(t){var e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8];var c=e[0]==="-";var h=l&&l[0]==="-";var d=function t(e,i){if(i===void 0){i=false}return e!==undefined&&(i||e&&c)?-e:e};return[{years:d(je(i)),months:d(je(n)),weeks:d(je(s)),days:d(je(r)),hours:d(je(o)),minutes:d(je(a)),seconds:d(je(l),l==="-0"),milliseconds:d(Oe(u),h)}]}var zi={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Ui(t,e,i,n,s,r,o){var a={year:e.length===2?ze(Ee(e)):Ee(e),month:Ze.indexOf(i)+1,day:Ee(n),hour:Ee(s),minute:Ee(r)};if(o)a.second=Ee(o);if(t){a.weekday=t.length>3?Ke.indexOf(t)+1:Qe.indexOf(t)+1}return a}var Bi=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Gi(t){var e=t[1],i=t[2],n=t[3],s=t[4],r=t[5],o=t[6],a=t[7],l=t[8],u=t[9],c=t[10],h=t[11],d=Ui(e,s,n,i,r,o,a);var f;if(l){f=zi[l]}else if(u){f=0}else{f=Be(c,h)}return[d,new Rt(f)]}function Vi(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var qi=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Hi=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Wi=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Zi(t){var e=t[1],i=t[2],n=t[3],s=t[4],r=t[5],o=t[6],a=t[7],l=Ui(e,s,n,i,r,o,a);return[l,Rt.utcInstance]}function Ji(t){var e=t[1],i=t[2],n=t[3],s=t[4],r=t[5],o=t[6],a=t[7],l=Ui(e,a,i,n,s,r,o);return[l,Rt.utcInstance]}var Yi=mi(Mi,xi);var Ki=mi(Ti,xi);var Qi=mi(Ai,xi);var Xi=mi(_i);var tn=yi(Ri,Li,Ni,Pi);var en=yi(Ii,Li,Ni,Pi);var nn=yi(ki,Li,Ni,Pi);var sn=yi(Li,Ni,Pi);function rn(t){return gi(t,[Yi,tn],[Ki,en],[Qi,nn],[Xi,sn])}function on(t){return gi(Vi(t),[Bi,Gi])}function an(t){return gi(t,[qi,Zi],[Hi,Zi],[Wi,Ji])}function ln(t){return gi(t,[Di,$i])}var un=yi(Li);function cn(t){return gi(t,[Fi,un])}var hn=mi(Ci,ji);var dn=mi(Ei);var fn=yi(Li,Ni,Pi);function pn(t){return gi(t,[hn,tn],[dn,fn])}var mn="Invalid Duration";var yn={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},gn=s({years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3}},yn),vn=146097/400,wn=146097/4800,bn=s({years:{quarters:4,months:12,weeks:vn/7,days:vn,hours:vn*24,minutes:vn*24*60,seconds:vn*24*60*60,milliseconds:vn*24*60*60*1e3},quarters:{months:3,weeks:vn/28,days:vn/4,hours:vn*24/4,minutes:vn*24*60/4,seconds:vn*24*60*60/4,milliseconds:vn*24*60*60*1e3/4},months:{weeks:wn/7,days:wn,hours:wn*24,minutes:wn*24*60,seconds:wn*24*60*60,milliseconds:wn*24*60*60*1e3}},yn);var Sn=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"];var _n=Sn.slice(0).reverse();function xn(t,e,i){if(i===void 0){i=false}var n={values:i?e.values:s({},t.values,e.values||{}),loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new In(n)}function Mn(t,e){var i;var n=(i=e.milliseconds)!=null?i:0;for(var s=m(_n.slice(1)),r;!(r=s()).done;){var o=r.value;if(e[o]){n+=e[o]*t[o]["milliseconds"]}}return n}function Tn(t,e){var i=Mn(t,e)<0?-1:1;Sn.reduceRight((function(n,s){if(!me(e[s])){if(n){var r=e[n]*i;var o=t[s][n];var a=Math.floor(r/o);e[s]+=a*i;e[n]-=a*o*i}return s}else{return n}}),null);Sn.reduce((function(i,n){if(!me(e[n])){if(i){var s=e[i]%1;e[i]-=s;e[n]+=s*t[i][n]}return n}else{return i}}),null)}function An(t){var e={};for(var i=0,n=Object.entries(t);i<n.length;i++){var s=n[i],r=s[0],o=s[1];if(o!==0){e[r]=o}}return e}var In=function(t){function e(t){var e=t.conversionAccuracy==="longterm"||false;var i=e?bn:gn;if(t.matrix){i=t.matrix}this.values=t.values;this.loc=t.loc||jt.create();this.conversionAccuracy=e?"longterm":"casual";this.invalid=t.invalid||null;this.matrix=i;this.isLuxonDuration=true}e.fromMillis=function t(i,n){return e.fromObject({milliseconds:i},n)};e.fromObject=function t(i,n){if(n===void 0){n={}}if(i==null||typeof i!=="object"){throw new M("Duration.fromObject: argument expected to be an object, got "+(i===null?"null":typeof i))}return new e({values:Ve(i,e.normalizeUnit),loc:jt.fromObject(n),conversionAccuracy:n.conversionAccuracy,matrix:n.matrix})};e.fromDurationLike=function t(i){if(ye(i)){return e.fromMillis(i)}else if(e.isDuration(i)){return i}else if(typeof i==="object"){return e.fromObject(i)}else{throw new M("Unknown duration argument "+i+" of type "+typeof i)}};e.fromISO=function t(i,n){var s=ln(i),r=s[0];if(r){return e.fromObject(r,n)}else{return e.invalid("unparsable",'the input "'+i+"\" can't be parsed as ISO 8601")}};e.fromISOTime=function t(i,n){var s=cn(i),r=s[0];if(r){return e.fromObject(r,n)}else{return e.invalid("unparsable",'the input "'+i+"\" can't be parsed as ISO 8601")}};e.invalid=function t(i,n){if(n===void 0){n=null}if(!i){throw new M("need to specify a reason the Duration is invalid")}var t=i instanceof Qt?i:new Qt(i,n);if(Kt.throwOnInvalid){throw new S(t)}else{return new e({invalid:t})}};e.normalizeUnit=function t(e){var i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!i)throw new x(e);return i};e.isDuration=function t(e){return e&&e.isLuxonDuration||false};var i=e.prototype;i.toFormat=function t(e,i){if(i===void 0){i={}}var n=s({},i,{floor:i.round!==false&&i.floor!==false});return this.isValid?fi.create(this.loc,n).formatDurationFromString(this,e):mn};i.toHuman=function t(e){var i=this;if(e===void 0){e={}}if(!this.isValid)return mn;var n=Sn.map((function(t){var n=i.values[t];if(me(n)){return null}return i.loc.numberFormatter(s({style:"unit",unitDisplay:"long"},e,{unit:t.slice(0,-1)})).format(n)})).filter((function(t){return t}));return this.loc.listFormatter(s({type:"conjunction",style:e.listStyle||"narrow"},e)).format(n)};i.toObject=function t(){if(!this.isValid)return{};return s({},this.values)};i.toISO=function t(){if(!this.isValid)return null;var e="P";if(this.years!==0)e+=this.years+"Y";if(this.months!==0||this.quarters!==0)e+=this.months+this.quarters*3+"M";if(this.weeks!==0)e+=this.weeks+"W";if(this.days!==0)e+=this.days+"D";if(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)e+="T";if(this.hours!==0)e+=this.hours+"H";if(this.minutes!==0)e+=this.minutes+"M";if(this.seconds!==0||this.milliseconds!==0)e+=Re(this.seconds+this.milliseconds/1e3,3)+"S";if(e==="P")e+="T0S";return e};i.toISOTime=function t(e){if(e===void 0){e={}}if(!this.isValid)return null;var i=this.toMillis();if(i<0||i>=864e5)return null;e=s({suppressMilliseconds:false,suppressSeconds:false,includePrefix:false,format:"extended"},e,{includeOffset:false});var n=Ls.fromMillis(i,{zone:"UTC"});return n.toISOTime(e)};i.toJSON=function t(){return this.toISO()};i.toString=function t(){return this.toISO()};i[t]=function(){if(this.isValid){return"Duration { values: "+JSON.stringify(this.values)+" }"}else{return"Duration { Invalid, reason: "+this.invalidReason+" }"}};i.toMillis=function t(){if(!this.isValid)return NaN;return Mn(this.matrix,this.values)};i.valueOf=function t(){return this.toMillis()};i.plus=function t(i){if(!this.isValid)return this;var n=e.fromDurationLike(i),s={};for(var r=0,o=Sn;r<o.length;r++){var a=o[r];if(Te(n.values,a)||Te(this.values,a)){s[a]=n.get(a)+this.get(a)}}return xn(this,{values:s},true)};i.minus=function t(i){if(!this.isValid)return this;var n=e.fromDurationLike(i);return this.plus(n.negate())};i.mapUnits=function t(e){if(!this.isValid)return this;var i={};for(var n=0,s=Object.keys(this.values);n<s.length;n++){var r=s[n];i[r]=Ge(e(this.values[r],r))}return xn(this,{values:i},true)};i.get=function t(i){return this[e.normalizeUnit(i)]};i.set=function t(i){if(!this.isValid)return this;var n=s({},this.values,Ve(i,e.normalizeUnit));return xn(this,{values:n})};i.reconfigure=function t(e){var i=e===void 0?{}:e,n=i.locale,s=i.numberingSystem,r=i.conversionAccuracy,o=i.matrix;var a=this.loc.clone({locale:n,numberingSystem:s});var l={loc:a,matrix:o,conversionAccuracy:r};return xn(this,l)};i.as=function t(e){return this.isValid?this.shiftTo(e).get(e):NaN};i.normalize=function t(){if(!this.isValid)return this;var e=this.toObject();Tn(this.matrix,e);return xn(this,{values:e},true)};i.rescale=function t(){if(!this.isValid)return this;var e=An(this.normalize().shiftToAll().toObject());return xn(this,{values:e},true)};i.shiftTo=function t(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++){n[s]=arguments[s]}if(!this.isValid)return this;if(n.length===0){return this}n=n.map((function(t){return e.normalizeUnit(t)}));var r={},o={},a=this.toObject();var l;for(var u=0,c=Sn;u<c.length;u++){var h=c[u];if(n.indexOf(h)>=0){l=h;var d=0;for(var f in o){d+=this.matrix[f][h]*o[f];o[f]=0}if(ye(a[h])){d+=a[h]}var p=Math.trunc(d);r[h]=p;o[h]=(d*1e3-p*1e3)/1e3}else if(ye(a[h])){o[h]=a[h]}}for(var m in o){if(o[m]!==0){r[l]+=m===l?o[m]:o[m]/this.matrix[l][m]}}Tn(this.matrix,r);return xn(this,{values:r},true)};i.shiftToAll=function t(){if(!this.isValid)return this;return this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds")};i.negate=function t(){if(!this.isValid)return this;var e={};for(var i=0,n=Object.keys(this.values);i<n.length;i++){var s=n[i];e[s]=this.values[s]===0?0:-this.values[s]}return xn(this,{values:e},true)};i.equals=function t(e){if(!this.isValid||!e.isValid){return false}if(!this.loc.equals(e.loc)){return false}function i(t,e){if(t===undefined||t===0)return e===undefined||e===0;return t===e}for(var n=0,s=Sn;n<s.length;n++){var r=s[n];if(!i(this.values[r],e.values[r])){return false}}return true};n(e,[{key:"locale",get:function t(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function t(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function t(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function t(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function t(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function t(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function t(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function t(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function t(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function t(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function t(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function t(){return this.invalid===null}},{key:"invalidReason",get:function t(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function t(){return this.invalid?this.invalid.explanation:null}}]);return e}(Symbol.for("nodejs.util.inspect.custom"));var kn="Invalid Interval";function Cn(t,e){if(!t||!t.isValid){return En.invalid("missing or invalid start")}else if(!e||!e.isValid){return En.invalid("missing or invalid end")}else if(e<t){return En.invalid("end before start","The end of an interval must be after its start, but you had start="+t.toISO()+" and end="+e.toISO())}else{return null}}var En=function(t){function e(t){this.s=t.start;this.e=t.end;this.invalid=t.invalid||null;this.isLuxonInterval=true}e.invalid=function t(i,n){if(n===void 0){n=null}if(!i){throw new M("need to specify a reason the Interval is invalid")}var t=i instanceof Qt?i:new Qt(i,n);if(Kt.throwOnInvalid){throw new b(t)}else{return new e({invalid:t})}};e.fromDateTimes=function t(i,n){var s=Ns(i),r=Ns(n);var o=Cn(s,r);if(o==null){return new e({start:s,end:r})}else{return o}};e.after=function t(i,n){var s=In.fromDurationLike(n),r=Ns(i);return e.fromDateTimes(r,r.plus(s))};e.before=function t(i,n){var s=In.fromDurationLike(n),r=Ns(i);return e.fromDateTimes(r.minus(s),r)};e.fromISO=function t(i,n){var s=(i||"").split("/",2),r=s[0],o=s[1];if(r&&o){var a,l;try{a=Ls.fromISO(r,n);l=a.isValid}catch(o){l=false}var u,c;try{u=Ls.fromISO(o,n);c=u.isValid}catch(o){c=false}if(l&&c){return e.fromDateTimes(a,u)}if(l){var h=In.fromISO(o,n);if(h.isValid){return e.after(a,h)}}else if(c){var d=In.fromISO(r,n);if(d.isValid){return e.before(u,d)}}}return e.invalid("unparsable",'the input "'+i+"\" can't be parsed as ISO 8601")};e.isInterval=function t(e){return e&&e.isLuxonInterval||false};var i=e.prototype;i.length=function t(e){if(e===void 0){e="milliseconds"}return this.isValid?this.toDuration.apply(this,[e]).get(e):NaN};i.count=function t(e,i){if(e===void 0){e="milliseconds"}if(!this.isValid)return NaN;var n=this.start.startOf(e,i);var s;if(i!=null&&i.useLocaleWeeks){s=this.end.reconfigure({locale:n.locale})}else{s=this.end}s=s.startOf(e,i);return Math.floor(s.diff(n,e).get(e))+(s.valueOf()!==this.end.valueOf())};i.hasSame=function t(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):false};i.isEmpty=function t(){return this.s.valueOf()===this.e.valueOf()};i.isAfter=function t(e){if(!this.isValid)return false;return this.s>e};i.isBefore=function t(e){if(!this.isValid)return false;return this.e<=e};i.contains=function t(e){if(!this.isValid)return false;return this.s<=e&&this.e>e};i.set=function t(i){var n=i===void 0?{}:i,s=n.start,r=n.end;if(!this.isValid)return this;return e.fromDateTimes(s||this.s,r||this.e)};i.splitAt=function t(){var i=this;if(!this.isValid)return[];for(var n=arguments.length,s=new Array(n),r=0;r<n;r++){s[r]=arguments[r]}var o=s.map(Ns).filter((function(t){return i.contains(t)})).sort((function(t,e){return t.toMillis()-e.toMillis()})),a=[];var l=this.s,u=0;while(l<this.e){var c=o[u]||this.e,h=+c>+this.e?this.e:c;a.push(e.fromDateTimes(l,h));l=h;u+=1}return a};i.splitBy=function t(i){var n=In.fromDurationLike(i);if(!this.isValid||!n.isValid||n.as("milliseconds")===0){return[]}var s=this.s,r=1,o;var a=[];while(s<this.e){var l=this.start.plus(n.mapUnits((function(t){return t*r})));o=+l>+this.e?this.e:l;a.push(e.fromDateTimes(s,o));s=o;r+=1}return a};i.divideEqually=function t(e){if(!this.isValid)return[];return this.splitBy(this.length()/e).slice(0,e)};i.overlaps=function t(e){return this.e>e.s&&this.s<e.e};i.abutsStart=function t(e){if(!this.isValid)return false;return+this.e===+e.s};i.abutsEnd=function t(e){if(!this.isValid)return false;return+e.e===+this.s};i.engulfs=function t(e){if(!this.isValid)return false;return this.s<=e.s&&this.e>=e.e};i.equals=function t(e){if(!this.isValid||!e.isValid){return false}return this.s.equals(e.s)&&this.e.equals(e.e)};i.intersection=function t(i){if(!this.isValid)return this;var n=this.s>i.s?this.s:i.s,s=this.e<i.e?this.e:i.e;if(n>=s){return null}else{return e.fromDateTimes(n,s)}};i.union=function t(i){if(!this.isValid)return this;var n=this.s<i.s?this.s:i.s,s=this.e>i.e?this.e:i.e;return e.fromDateTimes(n,s)};e.merge=function t(e){var i=e.sort((function(t,e){return t.s-e.s})).reduce((function(t,e){var i=t[0],n=t[1];if(!n){return[i,e]}else if(n.overlaps(e)||n.abutsStart(e)){return[i,n.union(e)]}else{return[i.concat([n]),e]}}),[[],null]),n=i[0],s=i[1];if(s){n.push(s)}return n};e.xor=function t(i){var n;var s=null,r=0;var o=[],a=i.map((function(t){return[{time:t.s,type:"s"},{time:t.e,type:"e"}]})),l=(n=Array.prototype).concat.apply(n,a),u=l.sort((function(t,e){return t.time-e.time}));for(var c=m(u),h;!(h=c()).done;){var d=h.value;r+=d.type==="s"?1:-1;if(r===1){s=d.time}else{if(s&&+s!==+d.time){o.push(e.fromDateTimes(s,d.time))}s=null}}return e.merge(o)};i.difference=function t(){var i=this;for(var n=arguments.length,s=new Array(n),r=0;r<n;r++){s[r]=arguments[r]}return e.xor([this].concat(s)).map((function(t){return i.intersection(t)})).filter((function(t){return t&&!t.isEmpty()}))};i.toString=function t(){if(!this.isValid)return kn;return"["+this.s.toISO()+" – "+this.e.toISO()+")"};i[t]=function(){if(this.isValid){return"Interval { start: "+this.s.toISO()+", end: "+this.e.toISO()+" }"}else{return"Interval { Invalid, reason: "+this.invalidReason+" }"}};i.toLocaleString=function t(e,i){if(e===void 0){e=C}if(i===void 0){i={}}return this.isValid?fi.create(this.s.loc.clone(i),e).formatInterval(this):kn};i.toISO=function t(e){if(!this.isValid)return kn;return this.s.toISO(e)+"/"+this.e.toISO(e)};i.toISODate=function t(){if(!this.isValid)return kn;return this.s.toISODate()+"/"+this.e.toISODate()};i.toISOTime=function t(e){if(!this.isValid)return kn;return this.s.toISOTime(e)+"/"+this.e.toISOTime(e)};i.toFormat=function t(e,i){var n=i===void 0?{}:i,s=n.separator,r=s===void 0?" – ":s;if(!this.isValid)return kn;return""+this.s.toFormat(e)+r+this.e.toFormat(e)};i.toDuration=function t(e,i){if(!this.isValid){return In.invalid(this.invalidReason)}return this.e.diff(this.s,e,i)};i.mapEndpoints=function t(i){return e.fromDateTimes(i(this.s),i(this.e))};n(e,[{key:"start",get:function t(){return this.isValid?this.s:null}},{key:"end",get:function t(){return this.isValid?this.e:null}},{key:"isValid",get:function t(){return this.invalidReason===null}},{key:"invalidReason",get:function t(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function t(){return this.invalid?this.invalid.explanation:null}}]);return e}(Symbol.for("nodejs.util.inspect.custom"));var jn=function(){function t(){}t.hasDST=function t(e){if(e===void 0){e=Kt.defaultZone}var i=Ls.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset};t.isValidIANAZone=function t(e){return ot.isValidZone(e)};t.normalizeZone=function t(e){return Nt(e,Kt.defaultZone)};t.getStartOfWeek=function t(e){var i=e===void 0?{}:e,n=i.locale,s=n===void 0?null:n,r=i.locObj,o=r===void 0?null:r;return(o||jt.create(s)).getStartOfWeek()};t.getMinimumDaysInFirstWeek=function t(e){var i=e===void 0?{}:e,n=i.locale,s=n===void 0?null:n,r=i.locObj,o=r===void 0?null:r;return(o||jt.create(s)).getMinDaysInFirstWeek()};t.getWeekendWeekdays=function t(e){var i=e===void 0?{}:e,n=i.locale,s=n===void 0?null:n,r=i.locObj,o=r===void 0?null:r;return(o||jt.create(s)).getWeekendDays().slice()};t.months=function t(e,i){if(e===void 0){e="long"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=n.locObj,u=l===void 0?null:l,c=n.outputCalendar,h=c===void 0?"gregory":c;return(u||jt.create(r,a,h)).months(e)};t.monthsFormat=function t(e,i){if(e===void 0){e="long"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=n.locObj,u=l===void 0?null:l,c=n.outputCalendar,h=c===void 0?"gregory":c;return(u||jt.create(r,a,h)).months(e,true)};t.weekdays=function t(e,i){if(e===void 0){e="long"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=n.locObj,u=l===void 0?null:l;return(u||jt.create(r,a,null)).weekdays(e)};t.weekdaysFormat=function t(e,i){if(e===void 0){e="long"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=n.locObj,u=l===void 0?null:l;return(u||jt.create(r,a,null)).weekdays(e,true)};t.meridiems=function t(e){var i=e===void 0?{}:e,n=i.locale,s=n===void 0?null:n;return jt.create(s).meridiems()};t.eras=function t(e,i){if(e===void 0){e="short"}var n=i===void 0?{}:i,s=n.locale,r=s===void 0?null:s;return jt.create(r,null,"gregory").eras(e)};t.features=function t(){return{relative:be(),localeWeek:Se()}};return t}();function On(t,e){var i=function t(e){return e.toUTC(0,{keepLocalTime:true}).startOf("day").valueOf()},n=i(e)-i(t);return Math.floor(In.fromMillis(n).as("days"))}function Rn(t,e,i){var n=[["years",function(t,e){return e.year-t.year}],["quarters",function(t,e){return e.quarter-t.quarter+(e.year-t.year)*4}],["months",function(t,e){return e.month-t.month+(e.year-t.year)*12}],["weeks",function(t,e){var i=On(t,e);return(i-i%7)/7}],["days",On]];var s={};var r=t;var o,a;for(var l=0,u=n;l<u.length;l++){var c=u[l],h=c[0],d=c[1];if(i.indexOf(h)>=0){o=h;s[h]=d(t,e);a=r.plus(s);if(a>e){s[h]--;t=r.plus(s);if(t>e){a=t;s[h]--;t=r.plus(s)}}else{t=a}}}return[t,s,a,o]}function Ln(t,e,i,n){var s=Rn(t,e,i),r=s[0],o=s[1],a=s[2],l=s[3];var u=e-r;var c=i.filter((function(t){return["hours","minutes","seconds","milliseconds"].indexOf(t)>=0}));if(c.length===0){if(a<e){var h;a=r.plus((h={},h[l]=1,h))}if(a!==r){o[l]=(o[l]||0)+u/(a-r)}}var d=In.fromObject(o,n);if(c.length>0){var f;return(f=In.fromMillis(u,n)).shiftTo.apply(f,c).plus(d)}else{return d}}var Nn="missing Intl.DateTimeFormat.formatToParts support";function Pn(t,e){if(e===void 0){e=function t(e){return e}}return{regex:t,deser:function t(i){var n=i[0];return e($t(n))}}}var Fn=String.fromCharCode(160);var Dn="[ "+Fn+"]";var $n=new RegExp(Dn,"g");function zn(t){return t.replace(/\./g,"\\.?").replace($n,Dn)}function Un(t){return t.replace(/\./g,"").replace($n," ").toLowerCase()}function Bn(t,e){if(t===null){return null}else{return{regex:RegExp(t.map(zn).join("|")),deser:function i(n){var s=n[0];return t.findIndex((function(t){return Un(s)===Un(t)}))+e}}}}function Gn(t,e){return{regex:t,deser:function t(e){var i=e[1],n=e[2];return Be(i,n)},groups:e}}function Vn(t){return{regex:t,deser:function t(e){var i=e[0];return i}}}function qn(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Hn(t,e){var i=Bt(e),n=Bt(e,"{2}"),s=Bt(e,"{3}"),r=Bt(e,"{4}"),o=Bt(e,"{6}"),a=Bt(e,"{1,2}"),l=Bt(e,"{1,3}"),u=Bt(e,"{1,6}"),c=Bt(e,"{1,9}"),h=Bt(e,"{2,4}"),d=Bt(e,"{4,6}"),f=function t(e){return{regex:RegExp(qn(e.val)),deser:function t(e){var i=e[0];return i},literal:true}},p=function p(m){if(t.literal){return f(m)}switch(m.val){case"G":return Bn(e.eras("short"),0);case"GG":return Bn(e.eras("long"),0);case"y":return Pn(u);case"yy":return Pn(h,ze);case"yyyy":return Pn(r);case"yyyyy":return Pn(d);case"yyyyyy":return Pn(o);case"M":return Pn(a);case"MM":return Pn(n);case"MMM":return Bn(e.months("short",true),1);case"MMMM":return Bn(e.months("long",true),1);case"L":return Pn(a);case"LL":return Pn(n);case"LLL":return Bn(e.months("short",false),1);case"LLLL":return Bn(e.months("long",false),1);case"d":return Pn(a);case"dd":return Pn(n);case"o":return Pn(l);case"ooo":return Pn(s);case"HH":return Pn(n);case"H":return Pn(a);case"hh":return Pn(n);case"h":return Pn(a);case"mm":return Pn(n);case"m":return Pn(a);case"q":return Pn(a);case"qq":return Pn(n);case"s":return Pn(a);case"ss":return Pn(n);case"S":return Pn(l);case"SSS":return Pn(s);case"u":return Vn(c);case"uu":return Vn(a);case"uuu":return Pn(i);case"a":return Bn(e.meridiems(),0);case"kkkk":return Pn(r);case"kk":return Pn(h,ze);case"W":return Pn(a);case"WW":return Pn(n);case"E":case"c":return Pn(i);case"EEE":return Bn(e.weekdays("short",false),1);case"EEEE":return Bn(e.weekdays("long",false),1);case"ccc":return Bn(e.weekdays("short",true),1);case"cccc":return Bn(e.weekdays("long",true),1);case"Z":case"ZZ":return Gn(new RegExp("([+-]"+a.source+")(?::("+n.source+"))?"),2);case"ZZZ":return Gn(new RegExp("([+-]"+a.source+")("+n.source+")?"),2);case"z":return Vn(/[a-z_+-/]{1,256}?/i);case" ":return Vn(/[^\S\n\r]/);default:return f(m)}};var m=p(t)||{invalidReason:Nn};m.token=t;return m}var Wn={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function Zn(t,e,i){var n=t.type,s=t.value;if(n==="literal"){var r=/^\s+$/.test(s);return{literal:!r,val:r?" ":s}}var o=e[n];var a=n;if(n==="hour"){if(e.hour12!=null){a=e.hour12?"hour12":"hour24"}else if(e.hourCycle!=null){if(e.hourCycle==="h11"||e.hourCycle==="h12"){a="hour12"}else{a="hour24"}}else{a=i.hour12?"hour12":"hour24"}}var l=Wn[a];if(typeof l==="object"){l=l[o]}if(l){return{literal:false,val:l}}return undefined}function Jn(t){var e=t.map((function(t){return t.regex})).reduce((function(t,e){return t+"("+e.source+")"}),"");return["^"+e+"$",t]}function Yn(t,e,i){var n=t.match(e);if(n){var s={};var r=1;for(var o in i){if(Te(i,o)){var a=i[o],l=a.groups?a.groups+1:1;if(!a.literal&&a.token){s[a.token.val[0]]=a.deser(n.slice(r,r+l))}r+=l}}return[n,s]}else{return[n,{}]}}function Kn(t){var e=function t(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};var i=null;var n;if(!me(t.z)){i=ot.create(t.z)}if(!me(t.Z)){if(!i){i=new Rt(t.Z)}n=t.Z}if(!me(t.q)){t.M=(t.q-1)*3+1}if(!me(t.h)){if(t.h<12&&t.a===1){t.h+=12}else if(t.h===12&&t.a===0){t.h=0}}if(t.G===0&&t.y){t.y=-t.y}if(!me(t.u)){t.S=Oe(t.u)}var s=Object.keys(t).reduce((function(i,n){var s=e(n);if(s){i[s]=t[n]}return i}),{});return[s,i,n]}var Qn=null;function Xn(){if(!Qn){Qn=Ls.fromMillis(1555555555555)}return Qn}function ts(t,e){if(t.literal){return t}var i=fi.macroTokenToFormatOpts(t.val);var n=rs(i,e);if(n==null||n.includes(undefined)){return t}return n}function es(t,e){var i;return(i=Array.prototype).concat.apply(i,t.map((function(t){return ts(t,e)})))}var is=function(){function t(t,e){this.locale=t;this.format=e;this.tokens=es(fi.parseFormat(e),t);this.units=this.tokens.map((function(e){return Hn(e,t)}));this.disqualifyingUnit=this.units.find((function(t){return t.invalidReason}));if(!this.disqualifyingUnit){var i=Jn(this.units),n=i[0],s=i[1];this.regex=RegExp(n,"i");this.handlers=s}}var e=t.prototype;e.explainFromTokens=function t(e){if(!this.isValid){return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}else{var i=Yn(e,this.regex,this.handlers),n=i[0],s=i[1],r=s?Kn(s):[null,null,undefined],o=r[0],a=r[1],l=r[2];if(Te(s,"a")&&Te(s,"H")){throw new _("Can't include meridiem when specifying 24-hour format")}return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:n,matches:s,result:o,zone:a,specificOffset:l}}};n(t,[{key:"isValid",get:function t(){return!this.disqualifyingUnit}},{key:"invalidReason",get:function t(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}]);return t}();function ns(t,e,i){var n=new is(t,i);return n.explainFromTokens(e)}function ss(t,e,i){var n=ns(t,e,i),s=n.result,r=n.zone,o=n.specificOffset,a=n.invalidReason;return[s,r,o,a]}function rs(t,e){if(!t){return null}var i=fi.create(e,t);var n=i.dtFormatter(Xn());var s=n.formatToParts();var r=n.resolvedOptions();return s.map((function(e){return Zn(e,t,r)}))}var os="Invalid DateTime";var as=864e13;function ls(t){return new Qt("unsupported zone",'the zone "'+t.name+'" is not supported')}function us(t){if(t.weekData===null){t.weekData=oe(t.c)}return t.weekData}function cs(t){if(t.localWeekData===null){t.localWeekData=oe(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())}return t.localWeekData}function hs(t,e){var i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Ls(s({},i,e,{old:i}))}function ds(t,e,i){var n=t-e*60*1e3;var s=i.offset(n);if(e===s){return[n,e]}n-=(s-e)*60*1e3;var r=i.offset(n);if(s===r){return[n,s]}return[t-Math.min(s,r)*60*1e3,Math.max(s,r)]}function fs(t,e){t+=e*60*1e3;var i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function ps(t,e,i){return ds(Fe(t),e,i)}function ms(t,e){var i=t.o,n=t.c.year+Math.trunc(e.years),r=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,o=s({},t.c,{year:n,month:r,day:Math.min(t.c.day,Pe(n,r))+Math.trunc(e.days)+Math.trunc(e.weeks)*7}),a=In.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),l=Fe(o);var u=ds(l,i,t.zone),c=u[0],h=u[1];if(a!==0){c+=a;h=t.zone.offset(c)}return{ts:c,o:h}}function ys(t,e,i,n,r,o){var a=i.setZone,l=i.zone;if(t&&Object.keys(t).length!==0||e){var u=e||l,c=Ls.fromObject(t,s({},i,{zone:u,specificOffset:o}));return a?c:c.setZone(l)}else{return Ls.invalid(new Qt("unparsable",'the input "'+r+"\" can't be parsed as "+n))}}function gs(t,e,i){if(i===void 0){i=true}return t.isValid?fi.create(jt.create("en-US"),{allowZ:i,forceSimple:true}).formatDateTimeFromString(t,e):null}function vs(t,e){var i=t.c.year>9999||t.c.year<0;var n="";if(i&&t.c.year>=0)n+="+";n+=Ce(t.c.year,i?6:4);if(e){n+="-";n+=Ce(t.c.month);n+="-";n+=Ce(t.c.day)}else{n+=Ce(t.c.month);n+=Ce(t.c.day)}return n}function ws(t,e,i,n,s,r){var o=Ce(t.c.hour);if(e){o+=":";o+=Ce(t.c.minute);if(t.c.millisecond!==0||t.c.second!==0||!i){o+=":"}}else{o+=Ce(t.c.minute)}if(t.c.millisecond!==0||t.c.second!==0||!i){o+=Ce(t.c.second);if(t.c.millisecond!==0||!n){o+=".";o+=Ce(t.c.millisecond,3)}}if(s){if(t.isOffsetFixed&&t.offset===0&&!r){o+="Z"}else if(t.o<0){o+="-";o+=Ce(Math.trunc(-t.o/60));o+=":";o+=Ce(Math.trunc(-t.o%60))}else{o+="+";o+=Ce(Math.trunc(t.o/60));o+=":";o+=Ce(Math.trunc(t.o%60))}}if(r){o+="["+t.zone.ianaName+"]"}return o}var bs={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Ss={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},_s={ordinal:1,hour:0,minute:0,second:0,millisecond:0};var xs=["year","month","day","hour","minute","second","millisecond"],Ms=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Ts=["year","ordinal","hour","minute","second","millisecond"];function As(t){var e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new x(t);return e}function Is(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return As(t)}}function ks(t){if(!Rs[t]){if(Os===undefined){Os=Kt.now()}Rs[t]=t.offset(Os)}return Rs[t]}function Cs(t,e){var i=Nt(e.zone,Kt.defaultZone);if(!i.isValid){return Ls.invalid(ls(i))}var n=jt.fromObject(e);var s,r;if(!me(t.year)){for(var o=0,a=xs;o<a.length;o++){var l=a[o];if(me(t[l])){t[l]=bs[l]}}var u=fe(t)||pe(t);if(u){return Ls.invalid(u)}var c=ks(i);var h=ps(t,c,i);s=h[0];r=h[1]}else{s=Kt.now()}return new Ls({ts:s,zone:i,loc:n,o:r})}function Es(t,e,i){var n=me(i.round)?true:i.round,s=function t(s,r){s=Re(s,n||i.calendary?0:2,true);var o=e.loc.clone(i).relFormatter(i);return o.format(s,r)},r=function n(s){if(i.calendary){if(!e.hasSame(t,s)){return e.startOf(s).diff(t.startOf(s),s).get(s)}else return 0}else{return e.diff(t,s).get(s)}};if(i.unit){return s(r(i.unit),i.unit)}for(var o=m(i.units),a;!(a=o()).done;){var l=a.value;var u=r(l);if(Math.abs(u)>=1){return s(u,l)}}return s(t>e?-0:0,i.units[i.units.length-1])}function js(t){var e={},i;if(t.length>0&&typeof t[t.length-1]==="object"){e=t[t.length-1];i=Array.from(t).slice(0,t.length-1)}else{i=Array.from(t)}return[e,i]}var Os;var Rs={};var Ls=function(t){function e(t){var e=t.zone||Kt.defaultZone;var i=t.invalid||(Number.isNaN(t.ts)?new Qt("invalid input"):null)||(!e.isValid?ls(e):null);this.ts=me(t.ts)?Kt.now():t.ts;var n=null,s=null;if(!i){var r=t.old&&t.old.ts===this.ts&&t.old.zone.equals(e);if(r){var o=[t.old.c,t.old.o];n=o[0];s=o[1]}else{var a=ye(t.o)&&!t.old?t.o:e.offset(this.ts);n=fs(this.ts,a);i=Number.isNaN(n.year)?new Qt("invalid input"):null;n=i?null:n;s=i?null:a}}this._zone=e;this.loc=t.loc||jt.create();this.invalid=i;this.weekData=null;this.localWeekData=null;this.c=n;this.o=s;this.isLuxonDateTime=true}e.now=function t(){return new e({})};e.local=function t(){var e=js(arguments),i=e[0],n=e[1],s=n[0],r=n[1],o=n[2],a=n[3],l=n[4],u=n[5],c=n[6];return Cs({year:s,month:r,day:o,hour:a,minute:l,second:u,millisecond:c},i)};e.utc=function t(){var e=js(arguments),i=e[0],n=e[1],s=n[0],r=n[1],o=n[2],a=n[3],l=n[4],u=n[5],c=n[6];i.zone=Rt.utcInstance;return Cs({year:s,month:r,day:o,hour:a,minute:l,second:u,millisecond:c},i)};e.fromJSDate=function t(i,n){if(n===void 0){n={}}var s=we(i)?i.valueOf():NaN;if(Number.isNaN(s)){return e.invalid("invalid input")}var r=Nt(n.zone,Kt.defaultZone);if(!r.isValid){return e.invalid(ls(r))}return new e({ts:s,zone:r,loc:jt.fromObject(n)})};e.fromMillis=function t(i,n){if(n===void 0){n={}}if(!ye(i)){throw new M("fromMillis requires a numerical input, but received a "+typeof i+" with value "+i)}else if(i<-as||i>as){return e.invalid("Timestamp out of range")}else{return new e({ts:i,zone:Nt(n.zone,Kt.defaultZone),loc:jt.fromObject(n)})}};e.fromSeconds=function t(i,n){if(n===void 0){n={}}if(!ye(i)){throw new M("fromSeconds requires a numerical input")}else{return new e({ts:i*1e3,zone:Nt(n.zone,Kt.defaultZone),loc:jt.fromObject(n)})}};e.fromObject=function t(i,n){if(n===void 0){n={}}i=i||{};var s=Nt(n.zone,Kt.defaultZone);if(!s.isValid){return e.invalid(ls(s))}var r=jt.fromObject(n);var o=Ve(i,Is);var a=ce(o,r),l=a.minDaysInFirstWeek,u=a.startOfWeek;var c=Kt.now(),h=!me(n.specificOffset)?n.specificOffset:s.offset(c),d=!me(o.ordinal),f=!me(o.year),p=!me(o.month)||!me(o.day),y=f||p,g=o.weekYear||o.weekNumber;if((y||d)&&g){throw new _("Can't mix weekYear/weekNumber units with year/month/day or ordinals")}if(p&&d){throw new _("Can't mix ordinal dates with month/day")}var v=g||o.weekday&&!y;var w,b,S=fs(c,h);if(v){w=Ms;b=Ss;S=oe(S,l,u)}else if(d){w=Ts;b=_s;S=le(S)}else{w=xs;b=bs}var x=false;for(var M=m(w),T;!(T=M()).done;){var A=T.value;var I=o[A];if(!me(I)){x=true}else if(x){o[A]=b[A]}else{o[A]=S[A]}}var k=v?he(o,l,u):d?de(o):fe(o),C=k||pe(o);if(C){return e.invalid(C)}var E=v?ae(o,l,u):d?ue(o):o,j=ps(E,h,s),O=j[0],R=j[1],L=new e({ts:O,zone:s,o:R,loc:r});if(o.weekday&&y&&i.weekday!==L.weekday){return e.invalid("mismatched weekday","you can't specify both a weekday of "+o.weekday+" and a date of "+L.toISO())}if(!L.isValid){return e.invalid(L.invalid)}return L};e.fromISO=function t(e,i){if(i===void 0){i={}}var n=rn(e),s=n[0],r=n[1];return ys(s,r,i,"ISO 8601",e)};e.fromRFC2822=function t(e,i){if(i===void 0){i={}}var n=on(e),s=n[0],r=n[1];return ys(s,r,i,"RFC 2822",e)};e.fromHTTP=function t(e,i){if(i===void 0){i={}}var n=an(e),s=n[0],r=n[1];return ys(s,r,i,"HTTP",i)};e.fromFormat=function t(i,n,s){if(s===void 0){s={}}if(me(i)||me(n)){throw new M("fromFormat requires an input string and a format")}var r=s,o=r.locale,a=o===void 0?null:o,l=r.numberingSystem,u=l===void 0?null:l,c=jt.fromOpts({locale:a,numberingSystem:u,defaultToEN:true}),h=ss(c,i,n),d=h[0],f=h[1],p=h[2],m=h[3];if(m){return e.invalid(m)}else{return ys(d,f,s,"format "+n,i,p)}};e.fromString=function t(i,n,s){if(s===void 0){s={}}return e.fromFormat(i,n,s)};e.fromSQL=function t(e,i){if(i===void 0){i={}}var n=pn(e),s=n[0],r=n[1];return ys(s,r,i,"SQL",e)};e.invalid=function t(i,n){if(n===void 0){n=null}if(!i){throw new M("need to specify a reason the DateTime is invalid")}var t=i instanceof Qt?i:new Qt(i,n);if(Kt.throwOnInvalid){throw new w(t)}else{return new e({invalid:t})}};e.isDateTime=function t(e){return e&&e.isLuxonDateTime||false};e.parseFormatForOpts=function t(e,i){if(i===void 0){i={}}var n=rs(e,jt.fromObject(i));return!n?null:n.map((function(t){return t?t.val:null})).join("")};e.expandFormat=function t(e,i){if(i===void 0){i={}}var n=es(fi.parseFormat(e),jt.fromObject(i));return n.map((function(t){return t.val})).join("")};e.resetCache=function t(){Os=undefined;Rs={}};var i=e.prototype;i.get=function t(e){return this[e]};i.getPossibleOffsets=function t(){if(!this.isValid||this.isOffsetFixed){return[this]}var e=864e5;var i=6e4;var n=Fe(this.c);var s=this.zone.offset(n-e);var r=this.zone.offset(n+e);var o=this.zone.offset(n-s*i);var a=this.zone.offset(n-r*i);if(o===a){return[this]}var l=n-o*i;var u=n-a*i;var c=fs(l,o);var h=fs(u,a);if(c.hour===h.hour&&c.minute===h.minute&&c.second===h.second&&c.millisecond===h.millisecond){return[hs(this,{ts:l}),hs(this,{ts:u})]}return[this]};i.resolvedLocaleOptions=function t(e){if(e===void 0){e={}}var i=fi.create(this.loc.clone(e),e).resolvedOptions(this),n=i.locale,s=i.numberingSystem,r=i.calendar;return{locale:n,numberingSystem:s,outputCalendar:r}};i.toUTC=function t(e,i){if(e===void 0){e=0}if(i===void 0){i={}}return this.setZone(Rt.instance(e),i)};i.toLocal=function t(){return this.setZone(Kt.defaultZone)};i.setZone=function t(i,n){var s=n===void 0?{}:n,r=s.keepLocalTime,o=r===void 0?false:r,a=s.keepCalendarTime,l=a===void 0?false:a;i=Nt(i,Kt.defaultZone);if(i.equals(this.zone)){return this}else if(!i.isValid){return e.invalid(ls(i))}else{var u=this.ts;if(o||l){var c=i.offset(this.ts);var h=this.toObject();var d=ps(h,c,i);u=d[0]}return hs(this,{ts:u,zone:i})}};i.reconfigure=function t(e){var i=e===void 0?{}:e,n=i.locale,s=i.numberingSystem,r=i.outputCalendar;var o=this.loc.clone({locale:n,numberingSystem:s,outputCalendar:r});return hs(this,{loc:o})};i.setLocale=function t(e){return this.reconfigure({locale:e})};i.set=function t(e){if(!this.isValid)return this;var i=Ve(e,Is);var n=ce(i,this.loc),r=n.minDaysInFirstWeek,o=n.startOfWeek;var a=!me(i.weekYear)||!me(i.weekNumber)||!me(i.weekday),l=!me(i.ordinal),u=!me(i.year),c=!me(i.month)||!me(i.day),h=u||c,d=i.weekYear||i.weekNumber;if((h||l)&&d){throw new _("Can't mix weekYear/weekNumber units with year/month/day or ordinals")}if(c&&l){throw new _("Can't mix ordinal dates with month/day")}var f;if(a){f=ae(s({},oe(this.c,r,o),i),r,o)}else if(!me(i.ordinal)){f=ue(s({},le(this.c),i))}else{f=s({},this.toObject(),i);if(me(i.day)){f.day=Math.min(Pe(f.year,f.month),f.day)}}var p=ps(f,this.o,this.zone),m=p[0],y=p[1];return hs(this,{ts:m,o:y})};i.plus=function t(e){if(!this.isValid)return this;var i=In.fromDurationLike(e);return hs(this,ms(this,i))};i.minus=function t(e){if(!this.isValid)return this;var i=In.fromDurationLike(e).negate();return hs(this,ms(this,i))};i.startOf=function t(e,i){var n=i===void 0?{}:i,s=n.useLocaleWeeks,r=s===void 0?false:s;if(!this.isValid)return this;var o={},a=In.normalizeUnit(e);switch(a){case"years":o.month=1;case"quarters":case"months":o.day=1;case"weeks":case"days":o.hour=0;case"hours":o.minute=0;case"minutes":o.second=0;case"seconds":o.millisecond=0;break}if(a==="weeks"){if(r){var l=this.loc.getStartOfWeek();var u=this.weekday;if(u<l){o.weekNumber=this.weekNumber-1}o.weekday=l}else{o.weekday=1}}if(a==="quarters"){var c=Math.ceil(this.month/3);o.month=(c-1)*3+1}return this.set(o)};i.endOf=function t(e,i){var n;return this.isValid?this.plus((n={},n[e]=1,n)).startOf(e,i).minus(1):this};i.toFormat=function t(e,i){if(i===void 0){i={}}return this.isValid?fi.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):os};i.toLocaleString=function t(e,i){if(e===void 0){e=C}if(i===void 0){i={}}return this.isValid?fi.create(this.loc.clone(i),e).formatDateTime(this):os};i.toLocaleParts=function t(e){if(e===void 0){e={}}return this.isValid?fi.create(this.loc.clone(e),e).formatDateTimeParts(this):[]};i.toISO=function t(e){var i=e===void 0?{}:e,n=i.format,s=n===void 0?"extended":n,r=i.suppressSeconds,o=r===void 0?false:r,a=i.suppressMilliseconds,l=a===void 0?false:a,u=i.includeOffset,c=u===void 0?true:u,h=i.extendedZone,d=h===void 0?false:h;if(!this.isValid){return null}var f=s==="extended";var p=vs(this,f);p+="T";p+=ws(this,f,o,l,c,d);return p};i.toISODate=function t(e){var i=e===void 0?{}:e,n=i.format,s=n===void 0?"extended":n;if(!this.isValid){return null}return vs(this,s==="extended")};i.toISOWeekDate=function t(){return gs(this,"kkkk-'W'WW-c")};i.toISOTime=function t(e){var i=e===void 0?{}:e,n=i.suppressMilliseconds,s=n===void 0?false:n,r=i.suppressSeconds,o=r===void 0?false:r,a=i.includeOffset,l=a===void 0?true:a,u=i.includePrefix,c=u===void 0?false:u,h=i.extendedZone,d=h===void 0?false:h,f=i.format,p=f===void 0?"extended":f;if(!this.isValid){return null}var m=c?"T":"";return m+ws(this,p==="extended",o,s,l,d)};i.toRFC2822=function t(){return gs(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",false)};i.toHTTP=function t(){return gs(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")};i.toSQLDate=function t(){if(!this.isValid){return null}return vs(this,true)};i.toSQLTime=function t(e){var i=e===void 0?{}:e,n=i.includeOffset,s=n===void 0?true:n,r=i.includeZone,o=r===void 0?false:r,a=i.includeOffsetSpace,l=a===void 0?true:a;var u="HH:mm:ss.SSS";if(o||s){if(l){u+=" "}if(o){u+="z"}else if(s){u+="ZZ"}}return gs(this,u,true)};i.toSQL=function t(e){if(e===void 0){e={}}if(!this.isValid){return null}return this.toSQLDate()+" "+this.toSQLTime(e)};i.toString=function t(){return this.isValid?this.toISO():os};i[t]=function(){if(this.isValid){return"DateTime { ts: "+this.toISO()+", zone: "+this.zone.name+", locale: "+this.locale+" }"}else{return"DateTime { Invalid, reason: "+this.invalidReason+" }"}};i.valueOf=function t(){return this.toMillis()};i.toMillis=function t(){return this.isValid?this.ts:NaN};i.toSeconds=function t(){return this.isValid?this.ts/1e3:NaN};i.toUnixInteger=function t(){return this.isValid?Math.floor(this.ts/1e3):NaN};i.toJSON=function t(){return this.toISO()};i.toBSON=function t(){return this.toJSDate()};i.toObject=function t(e){if(e===void 0){e={}}if(!this.isValid)return{};var i=s({},this.c);if(e.includeConfig){i.outputCalendar=this.outputCalendar;i.numberingSystem=this.loc.numberingSystem;i.locale=this.loc.locale}return i};i.toJSDate=function t(){return new Date(this.isValid?this.ts:NaN)};i.diff=function t(e,i,n){if(i===void 0){i="milliseconds"}if(n===void 0){n={}}if(!this.isValid||!e.isValid){return In.invalid("created by diffing an invalid DateTime")}var r=s({locale:this.locale,numberingSystem:this.numberingSystem},n);var o=_e(i).map(In.normalizeUnit),a=e.valueOf()>this.valueOf(),l=a?this:e,u=a?e:this,c=Ln(l,u,o,r);return a?c.negate():c};i.diffNow=function t(i,n){if(i===void 0){i="milliseconds"}if(n===void 0){n={}}return this.diff(e.now(),i,n)};i.until=function t(e){return this.isValid?En.fromDateTimes(this,e):this};i.hasSame=function t(e,i,n){if(!this.isValid)return false;var s=e.valueOf();var r=this.setZone(e.zone,{keepLocalTime:true});return r.startOf(i,n)<=s&&s<=r.endOf(i,n)};i.equals=function t(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)};i.toRelative=function t(i){if(i===void 0){i={}}if(!this.isValid)return null;var n=i.base||e.fromObject({},{zone:this.zone}),r=i.padding?this<n?-i.padding:i.padding:0;var o=["years","months","days","hours","minutes","seconds"];var a=i.unit;if(Array.isArray(i.unit)){o=i.unit;a=undefined}return Es(n,this.plus(r),s({},i,{numeric:"always",units:o,unit:a}))};i.toRelativeCalendar=function t(i){if(i===void 0){i={}}if(!this.isValid)return null;return Es(i.base||e.fromObject({},{zone:this.zone}),this,s({},i,{numeric:"auto",units:["years","months","days"],calendary:true}))};e.min=function t(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++){n[s]=arguments[s]}if(!n.every(e.isDateTime)){throw new M("min requires all arguments be DateTimes")}return xe(n,(function(t){return t.valueOf()}),Math.min)};e.max=function t(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++){n[s]=arguments[s]}if(!n.every(e.isDateTime)){throw new M("max requires all arguments be DateTimes")}return xe(n,(function(t){return t.valueOf()}),Math.max)};e.fromFormatExplain=function t(e,i,n){if(n===void 0){n={}}var s=n,r=s.locale,o=r===void 0?null:r,a=s.numberingSystem,l=a===void 0?null:a,u=jt.fromOpts({locale:o,numberingSystem:l,defaultToEN:true});return ns(u,e,i)};e.fromStringExplain=function t(i,n,s){if(s===void 0){s={}}return e.fromFormatExplain(i,n,s)};e.buildFormatParser=function t(e,i){if(i===void 0){i={}}var n=i,s=n.locale,r=s===void 0?null:s,o=n.numberingSystem,a=o===void 0?null:o,l=jt.fromOpts({locale:r,numberingSystem:a,defaultToEN:true});return new is(l,e)};e.fromFormatParser=function t(i,n,s){if(s===void 0){s={}}if(me(i)||me(n)){throw new M("fromFormatParser requires an input string and a format parser")}var r=s,o=r.locale,a=o===void 0?null:o,l=r.numberingSystem,u=l===void 0?null:l,c=jt.fromOpts({locale:a,numberingSystem:u,defaultToEN:true});if(!c.equals(n.locale)){throw new M("fromFormatParser called with a locale of "+c+", "+("but the format parser was created for "+n.locale))}var h=n.explainFromTokens(i),d=h.result,f=h.zone,p=h.specificOffset,m=h.invalidReason;if(m){return e.invalid(m)}else{return ys(d,f,s,"format "+n.format,i,p)}};n(e,[{key:"isValid",get:function t(){return this.invalid===null}},{key:"invalidReason",get:function t(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function t(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function t(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function t(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function t(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function t(){return this._zone}},{key:"zoneName",get:function t(){return this.isValid?this.zone.name:null}},{key:"year",get:function t(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function t(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function t(){return this.isValid?this.c.month:NaN}},{key:"day",get:function t(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function t(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function t(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function t(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function t(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function t(){return this.isValid?us(this).weekYear:NaN}},{key:"weekNumber",get:function t(){return this.isValid?us(this).weekNumber:NaN}},{key:"weekday",get:function t(){return this.isValid?us(this).weekday:NaN}},{key:"isWeekend",get:function t(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}},{key:"localWeekday",get:function t(){return this.isValid?cs(this).weekday:NaN}},{key:"localWeekNumber",get:function t(){return this.isValid?cs(this).weekNumber:NaN}},{key:"localWeekYear",get:function t(){return this.isValid?cs(this).weekYear:NaN}},{key:"ordinal",get:function t(){return this.isValid?le(this.c).ordinal:NaN}},{key:"monthShort",get:function t(){return this.isValid?jn.months("short",{locObj:this.loc})[this.month-1]:null}},{key:"monthLong",get:function t(){return this.isValid?jn.months("long",{locObj:this.loc})[this.month-1]:null}},{key:"weekdayShort",get:function t(){return this.isValid?jn.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}},{key:"weekdayLong",get:function t(){return this.isValid?jn.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}},{key:"offset",get:function t(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function t(){if(this.isValid){return this.zone.offsetName(this.ts,{format:"short",locale:this.locale})}else{return null}}},{key:"offsetNameLong",get:function t(){if(this.isValid){return this.zone.offsetName(this.ts,{format:"long",locale:this.locale})}else{return null}}},{key:"isOffsetFixed",get:function t(){return this.isValid?this.zone.isUniversal:null}},{key:"isInDST",get:function t(){if(this.isOffsetFixed){return false}else{return this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}}},{key:"isInLeapYear",get:function t(){return Le(this.year)}},{key:"daysInMonth",get:function t(){return Pe(this.year,this.month)}},{key:"daysInYear",get:function t(){return this.isValid?Ne(this.year):NaN}},{key:"weeksInWeekYear",get:function t(){return this.isValid?$e(this.weekYear):NaN}},{key:"weeksInLocalWeekYear",get:function t(){return this.isValid?$e(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}}],[{key:"DATE_SHORT",get:function t(){return C}},{key:"DATE_MED",get:function t(){return E}},{key:"DATE_MED_WITH_WEEKDAY",get:function t(){return j}},{key:"DATE_FULL",get:function t(){return O}},{key:"DATE_HUGE",get:function t(){return R}},{key:"TIME_SIMPLE",get:function t(){return L}},{key:"TIME_WITH_SECONDS",get:function t(){return N}},{key:"TIME_WITH_SHORT_OFFSET",get:function t(){return P}},{key:"TIME_WITH_LONG_OFFSET",get:function t(){return F}},{key:"TIME_24_SIMPLE",get:function t(){return D}},{key:"TIME_24_WITH_SECONDS",get:function t(){return $}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function t(){return z}},{key:"TIME_24_WITH_LONG_OFFSET",get:function t(){return U}},{key:"DATETIME_SHORT",get:function t(){return B}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function t(){return G}},{key:"DATETIME_MED",get:function t(){return V}},{key:"DATETIME_MED_WITH_SECONDS",get:function t(){return q}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function t(){return H}},{key:"DATETIME_FULL",get:function t(){return W}},{key:"DATETIME_FULL_WITH_SECONDS",get:function t(){return Z}},{key:"DATETIME_HUGE",get:function t(){return J}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function t(){return Y}}]);return e}(Symbol.for("nodejs.util.inspect.custom"));function Ns(t){if(Ls.isDateTime(t)){return t}else if(t&&t.valueOf&&ye(t.valueOf())){return Ls.fromJSDate(t)}else if(t&&typeof t==="object"){return Ls.fromObject(t)}else{throw new M("Unknown datetime argument: "+t+", of type "+typeof t)}}var Ps="3.5.0";e.DateTime=Ls;e.Duration=In;e.FixedOffsetZone=Rt;e.IANAZone=ot;e.Info=jn;e.Interval=En;e.InvalidZone=Lt;e.Settings=Kt;e.SystemZone=X;e.VERSION=Ps;e.Zone=K}));const og="system",ag="unknown",lg="UTC",ug=Intl.DateTimeFormat().resolvedOptions().timeZone,cg="shortOffset";function hg(t){return"timeZoneIANA"in t}function dg(t){return t.startsWith("UTC")}function fg(t,e=!1){return{json:{read:{source:t,reader:(e,i)=>i[t]?pg(i[t]):null},write:!!e&&{allowNull:!0,writer(e,i){i[t]=e?mg(e):null}}}}}function pg(t,e=og){return t?hg(t)?t.timeZoneIANA:yg(t,e):e}function mg(t){return{timeZoneIANA:t}}function yg(t,e=og){if(!t||!ig.has(t.timeZone))return e;const i=ig.get(t.timeZone);return dg(t.timeZone)||t.respectsDaylightSaving?i:gg(i)}function gg(t){const e=rg.DateTime.local().setZone(t),i=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);if(0===i)return"Etc/UTC";return`Etc/GMT${rg.FixedOffsetZone.instance(-i).formatOffset(0,"narrow")}`}function vg(t,e,i,n,s){if(e&&"date"===s)return{timeZone:lg,timeZoneName:void 0};const r=n.timeStyle||n.hour,o=i===ag;return{timeZone:o?"timestamp-offset"===s?void 0:t??lg:i,timeZoneName:o&&r?cg:void 0}}function wg(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map((t=>t.toLowerCase())));return t===og||t===ag||e.has(t.toLowerCase())||i.has(t.toLowerCase())}const bg={year:void 0,month:void 0,day:void 0,weekday:void 0},Sg={hour:void 0,minute:void 0,second:void 0},_g={timeZone:lg},xg={year:"numeric",month:"numeric",day:"numeric"},Mg={year:"numeric",month:"long",day:"numeric"},Tg={year:"numeric",month:"short",day:"numeric"},Ag={year:"numeric",month:"long",weekday:"long",day:"numeric"},Ig={hour:"numeric",minute:"numeric"},kg={...Ig,second:"numeric"},Cg={hourCycle:"h23"},Eg={...Ig,...Cg},jg={...kg,...Cg},Og={"short-date":xg,"short-date-short-time":{...xg,...Ig},"short-date-short-time-24":{...xg,...Eg},"short-date-long-time":{...xg,...kg},"short-date-long-time-24":{...xg,...jg},"short-date-le":xg,"short-date-le-short-time":{...xg,...Ig},"short-date-le-short-time-24":{...xg,...Eg},"short-date-le-long-time":{...xg,...kg},"short-date-le-long-time-24":{...xg,...jg},"long-month-day-year":Mg,"long-month-day-year-short-time":{...Mg,...Ig},"long-month-day-year-short-time-24":{...Mg,...Eg},"long-month-day-year-long-time":{...Mg,...kg},"long-month-day-year-long-time-24":{...Mg,...jg},"day-short-month-year":Tg,"day-short-month-year-short-time":{...Tg,...Ig},"day-short-month-year-short-time-24":{...Tg,...Eg},"day-short-month-year-long-time":{...Tg,...kg},"day-short-month-year-long-time-24":{...Tg,...jg},"long-date":Ag,"long-date-short-time":{...Ag,...Ig},"long-date-short-time-24":{...Ag,...Eg},"long-date-long-time":{...Ag,...kg},"long-date-long-time-24":{...Ag,...jg},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Ig,"long-time":kg},Rg=Oo()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),Lg={ar:"ar-u-nu-latn-ca-gregory"};let Ng=new WeakMap;const Pg=Og["short-date-short-time"];function Fg(t){let e=Ng.get(t);if(!e){const i=Jy(),n=Lg[i]||i,s=Gg(t.timeZone??og),r={...t,timeZone:s};e=new Intl.DateTimeFormat(n,r),Ng.set(t,e)}return e}function Dg(t){return Og[t]}function $g(t,e=Pg){return Fg(e).format(t)}function zg(t,e=Pg){return $g(new Date(t),{...e,..._g,...Sg})}function Ug(t,e=Pg){return $g(new Date(`1970-01-01T${t}Z`),{...e,..._g,...bg})}function Bg(t,e=Pg){if(e.timeZone)return $g(new Date(t),e);const i=rg.DateTime.fromISO(t,{setZone:!0}),n=Jy(),s=Lg[n]??n,r=0===i.offset?lg:e.timeZone,o={...e,timeZone:r};return i.toLocaleString(o,{locale:s})}function Gg(t){switch(t){case og:return ug;case ag:return lg;default:return t}}tg((()=>{Ng=new WeakMap}));const Vg={ar:"ar-u-nu-latn"};let qg=new WeakMap,Hg={};function Wg(t){const e=t||Hg;if(!qg.has(e)){const i=Jy(),n=Vg[Jy()]||i;qg.set(e,new Intl.NumberFormat(n,t))}return qg.get(e)}function Zg(t={}){const e={};return null!=t.digitSeparator&&(e.useGrouping=t.digitSeparator),null!=t.places&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function Jg(t,e){return Object.is(t,-0)&&(t=0),Wg(e).format(t)}function Yg(t,e=Jy()){if(!t)return null;let i=Kg.get(e);if(!i){const t=Wg().formatToParts(12345.6),n=[...Wg({useGrouping:!1}).format(9876543210)].reverse(),s=new Map(n.map(((t,e)=>[t,e]))),r=new RegExp(`[${t.find((t=>"group"===t.type))?.value}]`,"g"),o=new RegExp(`[${t.find((t=>"decimal"===t.type))?.value}]`),a=new RegExp(`[${n.join("")}]`,"g"),l=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,u=/[-\u2212\u2013\u2014\u2015]/g;i=t=>{if(""===(t=t.trim().replaceAll(r,"").replace(o,".").replace(a,(t=>String(s.get(t)))).replaceAll(l,"").replaceAll(u,"-")))return null;const e=Number(t);return isNaN(e)?null:e},Kg.set(e,i)}return i(t)}tg((()=>{qg=new WeakMap,Hg={}}));const Kg=new Map;const Qg=()=>jt.getLogger("esri.intl.substitute");function Xg(t,e,i={}){const{format:n={}}=i;return Mt(t,(t=>tv(t,e,n)))}function tv(t,e,i){let n,s;const r=t.indexOf(":");if(-1===r?n=t.trim():(n=t.slice(0,r).trim(),s=t.slice(r+1).trim()),!n)return"";const o=yt(n,e);if(null==o)return"";const a=(s?i?.[s]:null)??i?.[n];return a?ev(o,a):s?iv(o,s):nv(o)}function ev(t,e){switch(e.type){case"date":return $g(t,e.intlOptions);case"number":return Jg(t,e.intlOptions);default:return Qg().warn("missing format descriptor for key {key}"),nv(t)}}function iv(t,e){switch(e.toLowerCase()){case"dateformat":return $g(t);case"numberformat":return Jg(t);default:return Qg().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?$g(t):/^numberformat/i.test(e)?Jg(t):nv(t)}}function nv(t){switch(typeof t){case"string":return t;case"number":return Jg(t);case"boolean":return""+t;default:return t instanceof Date?$g(t):""}}const sv=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,rv={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function ov(t){return t in rv}const av=[],lv=new Map;function uv(t){for(const e of lv.keys())pv(t.pattern,e)&&lv.delete(e)}function cv(t){return av.includes(t)||(uv(t),av.unshift(t)),we((()=>{const e=av.indexOf(t);e>-1&&(av.splice(e,1),uv(t))}))}async function hv(t){const e=Jy();lv.has(t)||lv.set(t,fv(t,e));const i=lv.get(t);return i&&await mv.add(i),i}function dv(t){if(!sv.test(t))return null;const e=sv.exec(t);if(null===e)return null;const[,i,n]=e,s=i+(n?"-"+n.toUpperCase():"");return ov(s)?s:ov(i)?i:null}async function fv(t,e){const i=[];for(const n of av)if(pv(n.pattern,t))try{return await n.fetchMessageBundle(t,e)}catch(t){i.push(t)}if(i.length)throw new Ve("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i});throw new Ve("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function pv(t,e){return"string"==typeof t?e.startsWith(t):t.test(e)}tg((()=>{lv.clear()}));const mv=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=zs())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}};async function yv(t,e,i,n){const s=e.exec(i);if(!s)throw new Ve("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const r=s[1]?`${s[1]}/`:"",o=s[2],a=dv(n),l=`${r}${o}.json`,u=a?`${r}${o}_${a}.json`:l;let c;try{c=await gv(t(u))}catch(e){if(u===l)throw new Ve("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:e});try{c=await gv(t(l))}catch(t){throw new Ve("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:t})}}return c}async function gv(t){if(null!=bv.fetchBundleAsset)return bv.fetchBundleAsset(t);const e=await Pl(t,{responseType:"text"});return JSON.parse(e.data)}class vv{constructor({base:t="",pattern:e,location:i=new URL(window.location.href)}){let n;n="string"==typeof i?t=>new URL(t,new URL(i,window.location.href)).href:i instanceof URL?t=>new URL(t,i).href:i,this.pattern="string"==typeof e?new RegExp(`^${e}`):e,this.getAssetUrl=n,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=new RegExp(`^${t}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(t,e){return yv(this.getAssetUrl,this.matcher,t,e)}}function wv(t){return new vv(t)}const bv={};cv(wv({pattern:"esri/",location:ru}));const Sv={};function _v(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.slice()||[],paths:{...Sv.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=Sv.baseUrl),e}class xv{constructor(){const t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((e=>{this[e]=(...i)=>t[e](...i)}))}}class Mv{constructor(){this._dispatcher=new xv,this._workerPostMessage({type:My.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(t){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=t,t&&this.addEventListener("message",t)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(t){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=t,t&&this.addEventListener("messageerror",t)}get onerror(){return this._onerrorHandler}set onerror(t){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=t,t&&this.addEventListener("error",t)}postMessage(t){rs((()=>{this._workerMessageHandler(new MessageEvent("message",{data:t}))}))}dispatchEvent(t){return this._dispatcher.dispatchEvent(t)}addEventListener(t,e,i){this._dispatcher.addEventListener(t,e,i)}removeEventListener(t,e,i){this._dispatcher.removeEventListener(t,e,i)}_workerPostMessage(t){rs((()=>{this.dispatchEvent(new MessageEvent("message",{data:t}))}))}async _workerMessageHandler(t){const e=Ey(t);if(e&&e.type===My.OPEN){const{modulePath:t,jobId:i}=e;let n=await By.loadWorker(t);n||(n=await import(t));const s=By.connect(n);this._workerPostMessage({type:My.OPENED,jobId:i,data:s})}}}const Tv=()=>jt.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:Av}=My,Iv='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let kv,Cv;const Ev="Failed to create Worker. Fallback to execute module in main thread";async function jv(){if(!u("esri-workers"))return Ov(new Mv);if(!kv&&!Cv)try{const t=Iv.split("{CONFIGURATION}").join(Rv());kv=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(t){Cv=t||{}}let t;if(kv)try{t=new Worker(kv,{name:"esri-worker-"+Lv++})}catch(e){Tv().warn(Ev,Cv),t=new Mv}else Tv().warn(Ev,Cv),t=new Mv;return Ov(t)}async function Ov(t){return new Promise((e=>{function i(s){const r=Ey(s);r&&r.type===Av&&(t.removeEventListener("message",i),t.removeEventListener("error",n),e(t))}function n(e){e.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",n),Tv().warn("Failed to create Worker. Fallback to execute module in main thread",e),(t=new Mv).addEventListener("message",i),t.addEventListener("error",n)}t.addEventListener("message",i),t.addEventListener("error",n)}))}function Rv(){let t;if(null!=St.default){const e={...St};delete e.default,t=JSON.parse(JSON.stringify(e))}else t=JSON.parse(JSON.stringify(St));t.assetsPath=Ia(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?Ia(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=Jy(),t.has={"esri-csp-restrictions":u("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":u("esri-2d-update-debug"),"esri-2d-log-updating":u("esri-2d-log-updating"),"featurelayer-pbf":u("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":u("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":u("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":u("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":u("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":u("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":u("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":u("featurelayer-snapshot-enabled"),"esri-atomics":u("esri-atomics"),"esri-shared-array-buffer":u("esri-shared-array-buffer"),"esri-tiles-debug":u("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":u("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":u("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=Ia(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=Ia(t.workers.workerPath):t.workers.workerPath=Ia(ru("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=St.workers.loaderConfig,i=_v({baseUrl:e?.baseUrl,locale:Jy(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]}),n={buildDate:vl,fullVersion:_l,revision:wl};return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:n})}let Lv=0;const{ABORT:Nv,INVOKE:Pv,OPEN:Fv,OPENED:Dv,RESPONSE:$v}=My;class zv{static async create(t){const e=await jv();return new zv(e,t)}constructor(t,e){this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=e,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",(t=>{t.preventDefault(),jt.getLogger("esri.core.workers.WorkerOwner").error(t)}))}terminate(){this.worker.terminate()}async open(t,e={}){const{signal:i}=e,n=Ay();return new Promise(((e,s)=>{const r={resolve:e,reject:s,abortHandle:ks(i,(()=>{this._outJobs.delete(n),this._post({type:Nv,jobId:n})}))};this._outJobs.set(n,r),this._post({type:Fv,jobId:n,modulePath:t})}))}_onMessage(t){const e=Ey(t);if(e)switch(e.type){case Dv:this._onOpenedMessage(e);break;case $v:this._onResponseMessage(e);break;case Nv:this._onAbortMessage(e);break;case Pv:this._onInvokeMessage(e)}}_onAbortMessage(t){const e=this._inJobs,i=t.jobId,n=e.get(i);n&&(n.controller&&n.controller.abort(),e.delete(i))}_onInvokeMessage(t){const{methodName:e,jobId:i,data:n,abortable:s}=t,r=s?new AbortController:null,o=this._inJobs,a=Vy[e];let l;try{if("function"!=typeof a)throw new TypeError(`${e} is not a function`);l=a.call(null,n,{signal:r?r.signal:null})}catch(t){return void this._post({type:$v,jobId:i,error:ky(t)})}Fs(l)?(o.set(i,{controller:r,promise:l}),l.then((t=>{o.has(i)&&(o.delete(i),this._post({type:$v,jobId:i},t))}),(t=>{o.has(i)&&(o.delete(i),t||(t={message:"Error encountered at method"+e}),Es(t)||this._post({type:$v,jobId:i,error:ky(t||{message:`Error encountered at method ${e}`})}))}))):this._post({type:$v,jobId:i},l)}_onOpenedMessage(t){const{jobId:e,data:i}=t,n=this._outJobs.get(e);n&&(this._outJobs.delete(e),kn(n.abortHandle),n.resolve(i))}_onResponseMessage(t){const{jobId:e,error:i,data:n}=t,s=this._outJobs.get(e);s&&(this._outJobs.delete(e),kn(s.abortHandle),i?s.reject(Ve.fromJSON(JSON.parse(i))):s.resolve(n))}_post(t,e,i){return Cy(this.worker,t,e,i)}}const Uv=u("host-browser")?Math.min(navigator.hardwareConcurrency-1,u("workers-pool-size")??8):0;let Bv=u("esri-mobile")?Math.min(Uv,3):Uv;Bv||(Bv=u("safari")&&u("mac")?7:2);let Gv=0;const Vv=[];function qv(){Jv()}async function Hv(t,e){const i=new Gy,{registryTarget:n,...s}=e;return await i.open(t,s),n&&vy(n,i),i}async function Wv(t,e={}){if("string"!=typeof t)throw new Ve("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(u("host-webworker")&&!u("esri-workers")&&(i="local"),"local"===i){let i=await By.loadWorker(t);i||(i=await import(t)),_s(e.signal);const n=e.client||i;return Hv([By.connect(i,e.schedule)],{...e,client:n})}if(await Jv(),_s(e.signal),"dedicated"===i){const i=Gv++%Bv;return Hv([await Vv[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,Bv);if(i<Bv){const n=new Array(i);for(let s=0;s<i;++s){const i=Gv++%Bv;n[s]=Vv[i].open(t,e)}return Hv(n,e)}}return Hv(Vv.map((i=>i.open(t,e))),e)}let Zv=null;async function Jv(){if(Zv)return Zv;new AbortController;const t=[];for(let e=0;e<Bv;e++){const i=zv.create(e).then((t=>(Vv[e]=t,t)));t.push(i)}return Zv=Promise.all(t),Zv}function Yv(){return[0,0,0]}function Kv(t){return[t[0],t[1],t[2]]}function Qv(t,e,i){return[t,e,i]}function Xv(t,e,i){return[t,e,i]}function tw(t,e=Yv()){const i=Math.min(3,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function ew(t,e){return new Float64Array(t,e,3)}function iw(){return Yv()}function nw(){return Qv(1,1,1)}function sw(){return Qv(1,0,0)}function rw(){return Qv(0,1,0)}function ow(){return Qv(0,0,1)}const aw=iw(),lw=nw(),uw=sw(),cw=rw(),hw=ow();Object.freeze(Object.defineProperty({__proto__:null,ONES:lw,UNIT_X:uw,UNIT_Y:cw,UNIT_Z:hw,ZEROS:aw,clone:Kv,create:Yv,createView:ew,freeze:Xv,fromArray:tw,fromValues:Qv,ones:nw,unitX:sw,unitY:rw,unitZ:ow,zeros:iw},Symbol.toStringTag,{value:"Module"}));const dw=Math.PI/180,fw=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,pw=Lo.radius,mw=Lo.eccentricitySquared,yw={a1:pw*mw,a2:pw*mw*pw*mw,a3:pw*mw*mw/2,a4:pw*mw*pw*mw*2.5,a5:pw*mw+pw*mw*mw/2,a6:1-mw},gw={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:Lo.radius,f:Lo.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Po.radius,f:Po.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:No.radius,f:No.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:No.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};var vw;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.SPHERICAL_MARS_PCPF=6]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=7]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=8]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=9]="GCSMOON2000",t[t.LON_LAT=10]="LON_LAT",t[t.PLATE_CARREE=11]="PLATE_CARREE"}(vw||(vw={}));const ww={[vw.WGS84]:{[vw.CGCS2000]:_w,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:null,[vw.LON_LAT]:_w,[vw.SPHERICAL_ECEF]:$w,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:Iw,[vw.PLATE_CARREE]:kw,[vw.WGS84]:_w,[vw.WGS84_ECEF]:Ww},[vw.CGCS2000]:{[vw.CGCS2000]:_w,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:null,[vw.LON_LAT]:_w,[vw.SPHERICAL_ECEF]:$w,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:Iw,[vw.PLATE_CARREE]:kw,[vw.WGS84]:_w,[vw.WGS84_ECEF]:Ww},[vw.GCSMARS2000]:{[vw.CGCS2000]:null,[vw.GCSMARS2000]:_w,[vw.GCSMOON2000]:null,[vw.LON_LAT]:_w,[vw.SPHERICAL_ECEF]:null,[vw.SPHERICAL_MARS_PCPF]:Dw,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:null,[vw.PLATE_CARREE]:null,[vw.WGS84]:null,[vw.WGS84_ECEF]:null},[vw.GCSMOON2000]:{[vw.CGCS2000]:null,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:_w,[vw.LON_LAT]:_w,[vw.SPHERICAL_ECEF]:null,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:Fw,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:null,[vw.PLATE_CARREE]:null,[vw.WGS84]:null,[vw.WGS84_ECEF]:null},[vw.WEB_MERCATOR]:{[vw.CGCS2000]:xw,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:null,[vw.LON_LAT]:xw,[vw.SPHERICAL_ECEF]:Mw,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:_w,[vw.PLATE_CARREE]:Ew,[vw.WGS84]:xw,[vw.WGS84_ECEF]:Tw},[vw.WGS84_ECEF]:{[vw.CGCS2000]:Zw,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:null,[vw.LON_LAT]:Zw,[vw.SPHERICAL_ECEF]:Jw,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:Yw,[vw.PLATE_CARREE]:jw,[vw.WGS84]:Zw,[vw.WGS84_ECEF]:_w},[vw.SPHERICAL_ECEF]:{[vw.CGCS2000]:Gw,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:null,[vw.LON_LAT]:Gw,[vw.SPHERICAL_ECEF]:_w,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:Vw,[vw.PLATE_CARREE]:Ow,[vw.WGS84]:Gw,[vw.WGS84_ECEF]:qw},[vw.SPHERICAL_MARS_PCPF]:{[vw.CGCS2000]:null,[vw.GCSMARS2000]:Bw,[vw.GCSMOON2000]:null,[vw.LON_LAT]:Bw,[vw.SPHERICAL_ECEF]:null,[vw.SPHERICAL_MARS_PCPF]:_w,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:null,[vw.PLATE_CARREE]:null,[vw.WGS84]:null,[vw.WGS84_ECEF]:null},[vw.SPHERICAL_MOON_PCPF]:{[vw.CGCS2000]:null,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:Uw,[vw.LON_LAT]:Uw,[vw.SPHERICAL_ECEF]:null,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:_w,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:null,[vw.PLATE_CARREE]:null,[vw.WGS84]:null,[vw.WGS84_ECEF]:null},[vw.UNKNOWN]:{[vw.CGCS2000]:null,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:null,[vw.LON_LAT]:null,[vw.SPHERICAL_ECEF]:null,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:_w,[vw.WEB_MERCATOR]:null,[vw.PLATE_CARREE]:null,[vw.WGS84]:null,[vw.WGS84_ECEF]:null},[vw.LON_LAT]:{[vw.CGCS2000]:_w,[vw.GCSMARS2000]:_w,[vw.GCSMOON2000]:_w,[vw.LON_LAT]:_w,[vw.SPHERICAL_ECEF]:$w,[vw.SPHERICAL_MARS_PCPF]:Dw,[vw.SPHERICAL_MOON_PCPF]:Fw,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:Iw,[vw.PLATE_CARREE]:kw,[vw.WGS84]:_w,[vw.WGS84_ECEF]:Ww},[vw.PLATE_CARREE]:{[vw.CGCS2000]:Cw,[vw.GCSMARS2000]:null,[vw.GCSMOON2000]:null,[vw.LON_LAT]:Cw,[vw.SPHERICAL_ECEF]:Rw,[vw.SPHERICAL_MARS_PCPF]:null,[vw.SPHERICAL_MOON_PCPF]:null,[vw.UNKNOWN]:null,[vw.WEB_MERCATOR]:Lw,[vw.PLATE_CARREE]:_w,[vw.WGS84]:Cw,[vw.WGS84_ECEF]:Nw}};function bw(t,e,i=Qw()){return null==t||null==e?null:Kw(t,e,i).projector}function Sw(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Yc(t,1)),gc(t)?e.spatialReferenceId=vw.SPHERICAL_ECEF:Zu(t)?e.spatialReferenceId=vw.WGS84:Ku(t)?e.spatialReferenceId=vw.WEB_MERCATOR:Qu(t)?e.spatialReferenceId=vw.PLATE_CARREE:t.wkt===dc.wkt?e.spatialReferenceId=vw.WGS84_ECEF:t.wkid===Ru.CGCS2000?e.spatialReferenceId=vw.CGCS2000:t.wkt===cc.wkt?e.spatialReferenceId=vw.SPHERICAL_MARS_PCPF:t.wkt===hc.wkt?e.spatialReferenceId=vw.SPHERICAL_MOON_PCPF:tc(t)?e.spatialReferenceId=vw.GCSMARS2000:ic(t)?e.spatialReferenceId=vw.GCSMOON2000:e.spatialReferenceId=vw.UNKNOWN):vw.UNKNOWN}function _w(t,e,i,n){t!==i&&(i[n++]=t[e++],i[n++]=t[e++],i[n]=t[e])}function xw(t,e,i,n){i[n]=nb*(t[e]/ob),i[n+1]=nb*(rb-2*Math.atan(Math.exp(-t[e+1]/ob))),i[n+2]=t[e+2]}function Mw(t,e,i,n){const s=t[e]/ob,r=rb-2*Math.atan(Math.exp(-t[e+1]/ob)),o=ob+t[e+2],a=Math.cos(r)*o;i[n]=Math.cos(s)*a,i[n+1]=Math.sin(s)*a,i[n+2]=Math.sin(r)*o}function Tw(t,e,i,n){xw(t,e,i,n),Ww(i,n,i,n)}function Aw(t,e,i,n,s){const r=.4999999*sb,o=wf(ib*t[e+1],-r,r),a=Math.sin(o);i[n++]=ib*t[e]*s.radius,i[n++]=s.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[n]=t[e+2]}function Iw(t,e,i,n){Aw(t,e,i,n,Lo)}function kw(t,e,i,n){i[n]=t[e]*ab,i[n+1]=t[e+1]*ab,i[n+2]=t[e+2]}function Cw(t,e,i,n){i[n]=t[e]*lb,i[n+1]=t[e+1]*lb,i[n+2]=t[e+2]}function Ew(t,e,i,n){xw(t,e,i,n),kw(i,n,i,n)}function jw(t,e,i,n){Zw(t,e,i,n),kw(i,n,i,n)}function Ow(t,e,i,n){Gw(t,e,i,n),kw(i,n,i,n)}function Rw(t,e,i,n){Cw(t,e,i,n),$w(i,n,i,n)}function Lw(t,e,i,n){Cw(t,e,i,n),Iw(i,n,i,n)}function Nw(t,e,i,n){Cw(t,e,i,n),Ww(i,n,i,n)}function Pw(t,e,i,n,s){const r=s+t[e+2],o=ib*t[e+1],a=ib*t[e],l=Math.cos(o)*r;i[n]=Math.cos(a)*l,i[n+1]=Math.sin(a)*l,i[n+2]=Math.sin(o)*r}function Fw(t,e,i,n){Pw(t,e,i,n,Po.radius)}function Dw(t,e,i,n){Pw(t,e,i,n,No.radius)}function $w(t,e,i,n){Pw(t,e,i,n,Lo.radius)}function zw(t,e,i,n,s){const r=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(r*r+o*o+a*a),u=Af(a/(0===l?1:l)),c=Math.atan2(o,r);i[n++]=nb*c,i[n++]=nb*u,i[n]=l-s}function Uw(t,e,i,n){zw(t,e,i,n,Po.radius)}function Bw(t,e,i,n){zw(t,e,i,n,No.radius)}function Gw(t,e,i,n){zw(t,e,i,n,Lo.radius)}function Vw(t,e,i,n){Gw(t,e,i,n),Iw(i,n,i,n)}function qw(t,e,i,n){Gw(t,e,i,n),Ww(i,n,i,n)}function Hw(t,e,i,n,s){const r=ib*t[e],o=ib*t[e+1],a=t[e+2],l=Math.sin(o),u=Math.cos(o),c=s.radius/Math.sqrt(1-s.eccentricitySquared*l*l);i[n++]=(c+a)*u*Math.cos(r),i[n++]=(c+a)*u*Math.sin(r),i[n++]=(c*(1-s.eccentricitySquared)+a)*l}function Ww(t,e,i,n){Hw(t,e,i,n,Lo)}function Zw(t,e,i,n){const s=yw,r=t[e],o=t[e+1],a=t[e+2];let l,u,c,h,d,f,p,m,y,g,v,w,b,S,_,x,M,T,A,I,k;l=Math.abs(a),u=r*r+o*o,c=Math.sqrt(u),h=u+a*a,d=Math.sqrt(h),I=Math.atan2(o,r),f=a*a/h,p=u/h,S=s.a2/d,_=s.a3-s.a4/d,p>.3?(m=l/d*(1+p*(s.a1+S+f*_)/d),A=Math.asin(m),g=m*m,y=Math.sqrt(1-g)):(y=c/d*(1-f*(s.a5-S-p*_)/d),A=Math.acos(y),g=1-y*y,m=Math.sqrt(g)),v=1-Lo.eccentricitySquared*g,w=Lo.radius/Math.sqrt(v),b=s.a6*w,S=c-w*y,_=l-b*m,M=y*S+m*_,x=y*_-m*S,T=x/(b/v+M),A+=T,k=M+x*T/2,a<0&&(A=-A),i[n++]=nb*I,i[n++]=nb*A,i[n]=k}function Jw(t,e,i,n){Zw(t,e,i,n),$w(i,n,i,n)}function Yw(t,e,i,n){Zw(t,e,i,n),Iw(i,n,i,n)}function Kw(t,e,i){if(null==t||null==e||i.source.spatialReference===t&&i.dest.spatialReference===e)return i;const n=Sw(t,i.source),s=Sw(e,i.dest);return n===vw.UNKNOWN&&s===vw.UNKNOWN?Gu(t,e)?i.projector=_w:i.projector=null:i.projector=ww[n][s],i}function Qw(){return{source:{spatialReference:null,spatialReferenceId:vw.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:vw.UNKNOWN,metersPerUnit:1},projector:_w}}const Xw={spatialReference:null,spatialReferenceId:vw.UNKNOWN},tb={spatialReference:null,spatialReferenceId:vw.UNKNOWN},eb=Qw(),ib=xf(1),nb=Mf(1),sb=Math.PI,rb=.5*sb,ob=Lo.radius,ab=ob*sb/180,lb=180/(ob*sb);function ub(t,e,i,n,s,r,o=Math.floor(t.length/3)){const a=bw(e,s,eb);if(null==a)return!1;if(a===_w){if(t===n&&i===r)return!0;const e=i+3*o;for(let s=i,o=r;s<e;s++,o++)n[o]=t[s];return!0}const l=i+3*o;for(let e=i,s=r;e<l;e+=3,s+=3)a(t,e,n,s);return!0}const cb=Object.freeze({__proto__:null,projectBuffer:ub});function hb(t,e,i,n,s,r){return db[0]=t,db[1]=e,db[2]=i,ub(db,n,0,s,r,0)}const db=Yv();let fb=0;class pb{static fromGE(t){const e=new pb;return e._wkt=t.wkt,e._wkid=t.wkid,e._isInverse=t.isInverse,e}constructor(t){this.uid=fb++,t?(this._wkt=null!=t.wkt?t.wkt:null,this._wkid=null!=t.wkid?t.wkid:-1,this._isInverse=null!=t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=fb++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=fb++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=fb++}getInverse(){const t=new pb;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}class mb{static cacheKey(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}static fromGE(t){const e=new mb;let i="";for(const n of t.steps){const t=pb.fromGE(n);e.steps.push(t),i+=t.uid.toString()+","}return e._cachedProjection={},e._gtlistentry=null,e._chain=i,e}constructor(t){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,t?.steps)for(const e of t.steps)e instanceof pb?this.steps.push(e):this.steps.push(new pb({wkid:e.wkid,wkt:e.wkt,isInverse:e.isInverse}))}getInverse(){const t=new mb;t.steps=[];for(let e=this.steps.length-1;e>=0;e--){const i=this.steps[e];t.steps.push(i.getInverse())}return t}getGTListEntry(){let t="";for(const e of this.steps)t+=e.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=t),this._gtlistentry}assignCachedGe(t,e,i){this._cachedProjection[mb.cacheKey(t,e)]=i}getCachedGeTransformation(t,e){let i="";for(const t of this.steps)i+=t.uid.toString()+",";i!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=i);const n=this._cachedProjection[mb.cacheKey(t,e)];return void 0===n?null:n}}function yb(t,e,i){if(null==e||null==i||i.vcsWkid||Gu(e,i)||vc(e)||vc(i))return null;const n=Zc(e)/Zc(i);if(1===n)return null;switch(t){case"point":case"esriGeometryPoint":return t=>gb(t,n);case"polyline":case"esriGeometryPolyline":return t=>wb(t,n);case"polygon":case"esriGeometryPolygon":return t=>vb(t,n);case"multipoint":case"esriGeometryMultipoint":return t=>bb(t,n);case"extent":case"esriGeometryEnvelope":return t=>Sb(t,n);default:return null}}function gb(t,e){null!=t?.z&&(t.z*=e)}function vb(t,e){if(t)for(const i of t.rings)for(const t of i)t.length>2&&(t[2]*=e)}function wb(t,e){if(t)for(const i of t.paths)for(const t of i)t.length>2&&(t[2]*=e)}function bb(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}function Sb(t,e){t&&null!=t.zmin&&null!=t.zmax&&(t.zmin*=e,t.zmax*=e)}let _b=null,xb=null,Mb=null,Tb={};const Ab=new km;function Ib(){return!!_b&&lu()}function kb(){return!!Ib()||(oi(Ab),jb(),!1)}function Cb(t,e){return!t||!e||(Gb(t,e)||kb())}function Eb(t,e){return!Gb(t,e)&&!Ib()}function jb(t){return null==Mb&&(Mb=Promise.all([cu(),import("./p-c438d144.js").then((t=>t.g)),import("./p-3a837971.js")])),Mb.then((([,e,{hydratedAdapter:i}])=>{_s(t),xb=i,_b=e.default,_b._enableProjection(Ou),Ab.notify()}))}function Ob(t,e,i=null,n=null){return Array.isArray(t)?0===t.length?[]:Rb(xb,t,t[0].spatialReference,e,i,n):Rb(xb,[t],t.spatialReference,e,i,n)[0]}function Rb(t,e,i,n,s=null,r=null){if(null==i||null==n)return e;if(Gb(i,n,s))return e.map((t=>Hb(t,i,n)));if(null==s&&gc(i)){return e.map((t=>Hb(t,i,wh.WGS84))).map((t=>Ub(t,n)))}if(null==s&&gc(n)){return e.map((t=>Ub(t,wh.WGS84))).map((t=>Hb(t,wh.WGS84,n)))}if(null==s){const t=mb.cacheKey(i,n);void 0!==Tb[t]?s=Tb[t]:(null==(s=Pb(i,n,void 0))&&(s=new mb),Tb[t]=s)}if(null==_b||null==t)throw new Db;return null!=r?_b._project(t,e,i,n,s,r):_b._project(t,e,i,n,s)}function Lb(t,e){const i=Nb([t],e);return null!=i.pending?{pending:i.pending,geometry:null}:null!=i.geometries?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function Nb(t,e){if(!Ib())for(const i of t)if(null!=i&&!Gu(i.spatialReference,e)&&sc(i.spatialReference)&&sc(e)&&!Gb(i.spatialReference,e))return oi(Ab),{pending:jb(),geometries:null};return{pending:null,geometries:t.map((t=>null==t?null:Gu(t.spatialReference,e)?t:sc(t.spatialReference)&&sc(e)?Ub(t,e):null))}}function Pb(t,e,i=null){if(null==t||null==e)return null;if(null==_b||null==xb)throw new Db;const n=_b._getTransformation(xb,t,e,i,i?.spatialReference);return null!==n?mb.fromGE(n):null}function Fb(t,e,i=null){if(null==_b||null==xb)throw new Db;const n=_b._getTransformationBySuitability(xb,t,e,i,i?.spatialReference);if(null!==n){const t=[];for(const e of n)t.push(mb.fromGE(e));return t}return[]}class Db extends Ve{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}}function $b(){_b=null,xb=null,Mb=null,Tb={}}const zb={get loadPromise(){return Mb}};function Ub(t,e){try{const i=Ob(t,e);if(null==i)return null;"xmin"in t&&"xmin"in i&&(i.zmin=t.zmin,i.zmax=t.zmax);const n=yb(i.type,t.spatialReference,e);return null!=n&&n(i),i}catch(t){if(!(t instanceof Db))throw t;return null}}async function Bb(t,e,i){const n=t.spatialReference;return null!=n&&null!=e&&await qb(n,e,null,i),Ub(t,e)}function Gb(t,e,i){return!i&&(!!Gu(t,e)||sc(t)&&sc(e)&&!!bw(t,e,eb))}function Vb(t,e){if(Gu(t,e))return!0;if(!sc(t)||!sc(e))return!1;const i=Zu(t)||Ku(t)||Yu(t),n=Zu(e)||Ku(e)||Yu(e);return i&&n}async function qb(t,e,i,n){if(Ib())return Us(n);if(Array.isArray(t)){for(const{source:e,dest:i,geographicTransformation:s}of t)if(e&&i&&!Gb(e,i,s))return jb(n)}else if(t&&e&&!Gb(t,e,i))return jb(n);return Us(n)}function Hb(t,e,i){return t?"x"in t?Zb(t,e,new Kh,i,0):"xmin"in t?iS(t,e,new Od,i,0):"rings"in t?tS(t,e,new qp,i,0):"paths"in t?Qb(t,e,new Kp,i,0):"points"in t?Yb(t,e,new Dd,i,0):null:null}function Wb(t,e,i=e.spatialReference,n=0){return null!=i&&null!=t.spatialReference&&null!=Zb(t,t.spatialReference,e,i,n)}function Zb(t,e,i,n,s){sS[0]=t.x,sS[1]=t.y;const r=t.z;return sS[2]=void 0!==r?r:s,ub(sS,e,0,sS,n,0)?(i.x=sS[0],i.y=sS[1],i.spatialReference=n,void 0!==r||vc(n)?(i.z=sS[2],i.hasZ=!0):(i.z=void 0,i.hasZ=!1),void 0===t.m?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}function Jb(t,e,i=e.spatialReference,n=0){return null!=t.spatialReference&&null!=i&&null!=Yb(t,t.spatialReference,e,i,n)}function Yb(t,e,i,n,s){const{points:r,hasZ:o,hasM:a}=t,l=[],u=r.length,c=[];for(const t of r)c.push(t[0],t[1],o?t[2]:s);if(!ub(c,e,0,c,n,0,u))return null;const h=o||vc(n);for(let t=0;t<u;++t){const e=3*t,i=c[e],n=c[e+1];h&&a?l.push([i,n,c[e+2],r[t][3]]):h?l.push([i,n,c[e+2]]):a?l.push([i,n,r[t][2]]):l.push([i,n])}return i.points=l,i.spatialReference=n,i.hasZ=o,i.hasM=a,i}function Kb(t,e,i=e.spatialReference,n=0){return null!=t.spatialReference&&null!=i&&null!=Qb(t,t.spatialReference,e,i,n)}function Qb(t,e,i,n,s){const{paths:r,hasZ:o,hasM:a}=t,l=[];if(!nS(r,o??!1,a??!1,e,l,n,s))return null;const u=o||vc(n);return i.paths=l,i.spatialReference=n,i.hasZ=u,i.hasM=a,i}function Xb(t,e,i=e.spatialReference,n=0){return null!=t.spatialReference&&null!=i&&null!=tS(t,t.spatialReference,e,i,n)}function tS(t,e,i,n,s){const{rings:r,hasZ:o,hasM:a}=t,l=[];if(!nS(r,o??!1,a??!1,e,l,n,s))return null;const u=o||vc(n);return i.rings=l,i.spatialReference=n,i.hasZ=u,i.hasM=a,i}function eS(t,e,i=e.spatialReference,n=0){return null!=t.spatialReference&&null!=i&&null!=iS(t,t.spatialReference,e,i,n)}function iS(t,e,i,n,s){const{xmin:r,ymin:o,xmax:a,ymax:l,hasZ:u,hasM:c}=t,h=u?t.zmin:s;if(!hb(r,o,h,e,sS,n))return null;const d=u||vc(n);i.xmin=sS[0],i.ymin=sS[1],d&&(i.zmin=sS[2]);const f=u?t.zmax:s;return hb(a,l,f,e,sS,n)?(i.xmax=sS[0],i.ymax=sS[1],d&&(i.zmax=sS[2]),c&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=n,i):null}function nS(t,e,i,n,s,r,o=0){const a=new Array;for(const i of t)for(const t of i)a.push(t[0],t[1],e?t[2]:o);if(!ub(a,n,0,a,r,0))return!1;let l=0;s.length=0;const u=e||vc(r);for(const e of t){const t=new Array;for(const n of e)u&&i?t.push([a[l++],a[l++],a[l++],n[3]]):u?t.push([a[l++],a[l++],a[l++]]):i?(t.push([a[l++],a[l++],n[2]]),l++):(t.push([a[l++],a[l++]]),l++);s.push(t)}return!0}const sS=Yv();const rS=Object.freeze({__proto__:null,canProjectWithoutEngine:Gb,getTransformation:Pb,getTransformations:Fb,initializeProjection:qb,isEqualBaseGCS:Vb,isLoaded:Ib,isLoadedOrLoad:kb,isLoadedOrLoadFor:Cb,load:jb,project:Ob,projectExtent:eS,projectMany:Rb,projectMultipoint:Jb,projectOrLoad:Lb,projectOrLoadMany:Nb,projectPoint:Wb,projectPolygon:Xb,projectPolyline:Kb,projectWithZConversion:Bb,projectWithoutEngine:Hb,requiresLoad:Eb,test:zb,tryProjectWithZConversion:Ub,unload:$b});var oS;let aS=oS=class extends Io{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new oS({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};r([Je({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],aS.prototype,"cols",void 0),r([Je({type:ce,json:{write:!0}})],aS.prototype,"level",void 0),r([Je({type:String,json:{write:!0}})],aS.prototype,"levelValue",void 0),r([Je({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],aS.prototype,"origin",void 0),r([Je({type:Number,json:{write:!0}})],aS.prototype,"resolution",void 0),r([Je({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],aS.prototype,"rows",void 0),r([Je({type:Number,json:{write:!0}})],aS.prototype,"scale",void 0),aS=oS=r([ln("esri.layers.support.LOD")],aS);const lS=aS;class uS{constructor(t,e,i,n,s=void 0){this.id=t,this.level=e,this.row=i,this.col=n,this.extent=s}}var cS;const hS=new Co({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let dS=cS=class extends Io{static create(t={}){const{resolutionFactor:e=1,scales:i,size:n=256,spatialReference:s=wh.WebMercator,numLODs:r=24}=t;if(!sc(s)){const t=[];if(i)for(let e=0;e<i.length;e++){const n=i[e];t.push(new lS({level:e,scale:n,resolution:n}))}else{let e=5e-4;for(let i=r-1;i>=0;i--)t.unshift(new lS({level:i,scale:e,resolution:e})),e*=2}return new cS({dpi:96,lods:t,origin:new Kh(0,0,s),size:[n,n],spatialReference:s})}const o=Vu(s),a=t.origin?new Kh({x:t.origin.x,y:t.origin.y,spatialReference:s}):new Kh(o?{x:o.origin[0],y:o.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),l=96,u=1/(Yc(s)*39.37*l),c=[];if(i)for(let t=0;t<i.length;t++){const e=i[t],n=e*u;c.push(new lS({level:t,scale:e,resolution:n}))}else{let t=Hu(s)?512/n*591657527.5917094:256/n*591657527.591555;const i=Math.ceil(r/e);c.push(new lS({level:0,scale:t,resolution:t*u}));for(let n=1;n<i;n++){const i=t/2**e,s=i*u;c.push(new lS({level:n,scale:i,resolution:s})),t=i}}return new cS({dpi:l,lods:c,origin:a,size:[n,n],spatialReference:s})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=Vu(t);return t.isWrappable&&!!i&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return Kh.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){const e=[],i=this._levelToLOD={};t&&t.forEach((t=>{e.push(t.scale),i[t.level]=t})),this._set("scales",e),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];const i=Math.floor(t),n=i+1;return e[i]/(e[i]/e[n])**(t-i)}scaleToZoom(t){const e=this.scales,i=e.length-1;let n=0;for(;n<i;n++){const i=e[n],s=e[n+1];if(i<=t)return n;if(s===t)return n+1;if(i>t&&s<t)return n+Math.log(i/t)/Math.log(i/s)}return n}tileAt(t,e,i,n){const s=this.lodAt(t);if(!s)return null;let r,o;if("number"==typeof e)r=e,o=i;else if(Gu(e.spatialReference,this.spatialReference))r=e.x,o=e.y,n=i;else{const t=Fh(e,this.spatialReference);if(null==t)return null;r=t.x,o=t.y,n=i}const a=s.resolution*this.size[0],l=s.resolution*this.size[1];return n||(n=new uS(null,0,0,0,Bf())),n.level=t,n.row=Math.floor((this.origin.y-o)/l+.001),n.col=Math.floor((r-this.origin.x)/a+.001),this.updateTileInfo(n),n}updateTileInfo(t,e=cS.ExtrapolateOptions.NONE){let i=this.lodAt(t.level);if(!i&&e===cS.ExtrapolateOptions.POWER_OF_TWO){const e=this.lods[this.lods.length-1];e.level<t.level&&(i=e)}if(!i)return;const n=t.level-i.level,s=i.resolution*this.size[0]/2**n,r=i.resolution*this.size[1]/2**n;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=Bf()),t.extent[0]=this.origin.x+t.col*s,t.extent[1]=this.origin.y-(t.row+1)*r,t.extent[2]=t.extent[0]+s,t.extent[3]=t.extent[1]+r}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||-1===e.parentLevel)&&(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,e){const i=this.lodAt(e.level);if(null==i)return null;const{resolution:n}=i,s=n*this.size[0],r=n*this.size[1];return t[0]=this.origin.x+e.col*s,t[1]=this.origin.y-(e.row+1)*r,t[2]=t[0]+s,t[3]=t[1]+r,t}lodAt(t){return this._levelToLOD?.[t]??null}clone(){return cS.fromJSON(this.write({}))}getCompatibleForVTL(t){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===t)return null;const e=(512===this.size[0]&&256===t?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===t&&0===e)return this;const i=[],n=this.lods.length-e;for(let t=0;t<n;t++){const n=t+e,{scale:s,resolution:r}=n>=0?this.lods[n]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new lS({level:t,scale:s,resolution:r}))}return new cS({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const n=t[i];this._upsampleLevels[n.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/n.resolution:0},e=n}}};r([Je({type:Number,json:{write:!0}})],dS.prototype,"compressionQuality",void 0),r([Je({type:Number,json:{write:!0}})],dS.prototype,"dpi",void 0),r([Je({type:String,json:{read:hS.read,write:hS.write,origins:{"web-scene":{read:!1,write:!1}}}})],dS.prototype,"format",void 0),r([Je({readOnly:!0})],dS.prototype,"isWrappable",null),r([Je({type:Kh,json:{write:!0}})],dS.prototype,"origin",void 0),r([ko("origin")],dS.prototype,"readOrigin",null),r([Je({type:[lS],value:null,json:{write:!0}})],dS.prototype,"lods",null),r([Je({readOnly:!0})],dS.prototype,"scales",void 0),r([Je({cast:t=>Array.isArray(t)?t:"number"==typeof t?[t,t]:[256,256]})],dS.prototype,"size",void 0),r([ko("size",["rows","cols"])],dS.prototype,"readSize",null),r([yh("size",{cols:{type:ce},rows:{type:ce}})],dS.prototype,"writeSize",null),r([Je({type:wh,json:{write:!0}})],dS.prototype,"spatialReference",void 0),dS=cS=r([ln("esri.layers.support.TileInfo")],dS),function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"}(dS||(dS={}));const fS=dS;const pS={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],n=e[1],s=this.values;return n>=i?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},mS={xsmall:544,small:768,medium:992,large:1200};function yS(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function gS(t,e){return e?pS[t].valueToClassName[e].split(" "):[]}const vS=t=>{let e=class extends t{constructor(...t){super(...t),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=mS}initialize(){this.addHandles(ey((()=>[this.breakpoints,this.size]),(()=>this._updateClassNames()),dy))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(t){if(t===this._get("breakpoints"))return;if(!yS(t)){const e=JSON.stringify(mS,null,2);console.warn("provided breakpoints are not valid, using defaults:"+e),t=mS}this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=es.acquire(),e=es.acquire();let i,n=!1;for(i in pS){const s=this[i],r=pS[i].getValue({viewSize:this.size,breakpoints:this.breakpoints});s!==r&&(n=!0,this[i]=r,gS(i,s).forEach((t=>e.push(t))),gS(i,r).forEach((e=>t.push(e))))}n&&(this._applyClassNameChanges(t,e),es.release(t),es.release(e))}_applyClassNameChanges(t,e){const i=this.container;i&&(e.forEach((t=>i.classList.remove(t))),t.forEach((t=>i.classList.add(t))))}_removeActiveClassNames(){const t=this.container;if(!t)return;let e;for(e in pS)gS(e,this[e]).forEach((e=>t.classList.remove(e)))}};return r([Je()],e.prototype,"breakpoints",null),r([Je()],e.prototype,"orientation",void 0),r([Je()],e.prototype,"widthBreakpoint",void 0),r([Je()],e.prototype,"heightBreakpoint",void 0),e=r([ln("esri.views.BreakpointsOwner")],e),e};function wS(t){return"string"==typeof t?document.getElementById(t):t??null}function bS(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}let SS=class extends ao{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(t,e,i={}){return this._installWatch(t,e,i,ey)}addWhen(t,e,i={}){return this._installWatch(t,e,i,iy)}addOnCollectionChange(t,e,{initial:i=!1,final:n=!1}={}){const s=++this._handleId;return this.addHandles([sy(t,"after-changes",this._createSyncUpdatingCallback(),hy),sy(t,"change",e,{onListenerAdd:i?t=>e({added:t.toArray(),removed:[]}):void 0,onListenerRemove:n?t=>e({added:[],removed:t.toArray()}):void 0})],s),we((()=>this.removeHandles(s)))}addPromise(t){if(null==t)return t;const e=++this._handleId;this.addHandles(we((()=>{this._pendingPromises.delete(t)&&(0!==this._pendingPromises.size||this.hasHandles(_S)||this._set("updating",!1))})),e),this._pendingPromises.add(t),this._set("updating",!0);const i=()=>this.removeHandles(e);return t.then(i,i),t}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(t,e,i={},n){const s=++this._handleId;i.sync||this._installSyncUpdatingWatch(t,s);const r=n(t,e,i);return this.addHandles(r,s),we((()=>this.removeHandles(s)))}_installSyncUpdatingWatch(t,e){const i=this._createSyncUpdatingCallback(),n=ey(t,i,{sync:!0,equals:()=>!1});return this.addHandles(n,e),n}_createSyncUpdatingCallback(){return()=>{this.removeHandles(_S),++this._scheduleHandleId;const t=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(er((()=>{t===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(_S))})),_S)}}};r([Je({readOnly:!0})],SS.prototype,"updating",void 0),SS=r([ln("esri.core.support.UpdatingHandles")],SS);const _S=-42;
/*!
 * @esri/arcgis-html-sanitizer - v4.1.0-next.3 - Wed Sep 25 2024 10:04:57 GMT-0400 (Eastern Daylight Time)
 * Copyright (c) 2024 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var xS=function(){xS=Object.assign||function t(e){for(var i,n=1,s=arguments.length;n<s;n++){i=arguments[n];for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r))e[r]=i[r]}return e};return xS.apply(this,arguments)};var MS={exports:{}};var TS={};var AS={exports:{}};var IS={};function kS(){var t={};t["align-content"]=false;t["align-items"]=false;t["align-self"]=false;t["alignment-adjust"]=false;t["alignment-baseline"]=false;t["all"]=false;t["anchor-point"]=false;t["animation"]=false;t["animation-delay"]=false;t["animation-direction"]=false;t["animation-duration"]=false;t["animation-fill-mode"]=false;t["animation-iteration-count"]=false;t["animation-name"]=false;t["animation-play-state"]=false;t["animation-timing-function"]=false;t["azimuth"]=false;t["backface-visibility"]=false;t["background"]=true;t["background-attachment"]=true;t["background-clip"]=true;t["background-color"]=true;t["background-image"]=true;t["background-origin"]=true;t["background-position"]=true;t["background-repeat"]=true;t["background-size"]=true;t["baseline-shift"]=false;t["binding"]=false;t["bleed"]=false;t["bookmark-label"]=false;t["bookmark-level"]=false;t["bookmark-state"]=false;t["border"]=true;t["border-bottom"]=true;t["border-bottom-color"]=true;t["border-bottom-left-radius"]=true;t["border-bottom-right-radius"]=true;t["border-bottom-style"]=true;t["border-bottom-width"]=true;t["border-collapse"]=true;t["border-color"]=true;t["border-image"]=true;t["border-image-outset"]=true;t["border-image-repeat"]=true;t["border-image-slice"]=true;t["border-image-source"]=true;t["border-image-width"]=true;t["border-left"]=true;t["border-left-color"]=true;t["border-left-style"]=true;t["border-left-width"]=true;t["border-radius"]=true;t["border-right"]=true;t["border-right-color"]=true;t["border-right-style"]=true;t["border-right-width"]=true;t["border-spacing"]=true;t["border-style"]=true;t["border-top"]=true;t["border-top-color"]=true;t["border-top-left-radius"]=true;t["border-top-right-radius"]=true;t["border-top-style"]=true;t["border-top-width"]=true;t["border-width"]=true;t["bottom"]=false;t["box-decoration-break"]=true;t["box-shadow"]=true;t["box-sizing"]=true;t["box-snap"]=true;t["box-suppress"]=true;t["break-after"]=true;t["break-before"]=true;t["break-inside"]=true;t["caption-side"]=false;t["chains"]=false;t["clear"]=true;t["clip"]=false;t["clip-path"]=false;t["clip-rule"]=false;t["color"]=true;t["color-interpolation-filters"]=true;t["column-count"]=false;t["column-fill"]=false;t["column-gap"]=false;t["column-rule"]=false;t["column-rule-color"]=false;t["column-rule-style"]=false;t["column-rule-width"]=false;t["column-span"]=false;t["column-width"]=false;t["columns"]=false;t["contain"]=false;t["content"]=false;t["counter-increment"]=false;t["counter-reset"]=false;t["counter-set"]=false;t["crop"]=false;t["cue"]=false;t["cue-after"]=false;t["cue-before"]=false;t["cursor"]=false;t["direction"]=false;t["display"]=true;t["display-inside"]=true;t["display-list"]=true;t["display-outside"]=true;t["dominant-baseline"]=false;t["elevation"]=false;t["empty-cells"]=false;t["filter"]=false;t["flex"]=false;t["flex-basis"]=false;t["flex-direction"]=false;t["flex-flow"]=false;t["flex-grow"]=false;t["flex-shrink"]=false;t["flex-wrap"]=false;t["float"]=false;t["float-offset"]=false;t["flood-color"]=false;t["flood-opacity"]=false;t["flow-from"]=false;t["flow-into"]=false;t["font"]=true;t["font-family"]=true;t["font-feature-settings"]=true;t["font-kerning"]=true;t["font-language-override"]=true;t["font-size"]=true;t["font-size-adjust"]=true;t["font-stretch"]=true;t["font-style"]=true;t["font-synthesis"]=true;t["font-variant"]=true;t["font-variant-alternates"]=true;t["font-variant-caps"]=true;t["font-variant-east-asian"]=true;t["font-variant-ligatures"]=true;t["font-variant-numeric"]=true;t["font-variant-position"]=true;t["font-weight"]=true;t["grid"]=false;t["grid-area"]=false;t["grid-auto-columns"]=false;t["grid-auto-flow"]=false;t["grid-auto-rows"]=false;t["grid-column"]=false;t["grid-column-end"]=false;t["grid-column-start"]=false;t["grid-row"]=false;t["grid-row-end"]=false;t["grid-row-start"]=false;t["grid-template"]=false;t["grid-template-areas"]=false;t["grid-template-columns"]=false;t["grid-template-rows"]=false;t["hanging-punctuation"]=false;t["height"]=true;t["hyphens"]=false;t["icon"]=false;t["image-orientation"]=false;t["image-resolution"]=false;t["ime-mode"]=false;t["initial-letters"]=false;t["inline-box-align"]=false;t["justify-content"]=false;t["justify-items"]=false;t["justify-self"]=false;t["left"]=false;t["letter-spacing"]=true;t["lighting-color"]=true;t["line-box-contain"]=false;t["line-break"]=false;t["line-grid"]=false;t["line-height"]=false;t["line-snap"]=false;t["line-stacking"]=false;t["line-stacking-ruby"]=false;t["line-stacking-shift"]=false;t["line-stacking-strategy"]=false;t["list-style"]=true;t["list-style-image"]=true;t["list-style-position"]=true;t["list-style-type"]=true;t["margin"]=true;t["margin-bottom"]=true;t["margin-left"]=true;t["margin-right"]=true;t["margin-top"]=true;t["marker-offset"]=false;t["marker-side"]=false;t["marks"]=false;t["mask"]=false;t["mask-box"]=false;t["mask-box-outset"]=false;t["mask-box-repeat"]=false;t["mask-box-slice"]=false;t["mask-box-source"]=false;t["mask-box-width"]=false;t["mask-clip"]=false;t["mask-image"]=false;t["mask-origin"]=false;t["mask-position"]=false;t["mask-repeat"]=false;t["mask-size"]=false;t["mask-source-type"]=false;t["mask-type"]=false;t["max-height"]=true;t["max-lines"]=false;t["max-width"]=true;t["min-height"]=true;t["min-width"]=true;t["move-to"]=false;t["nav-down"]=false;t["nav-index"]=false;t["nav-left"]=false;t["nav-right"]=false;t["nav-up"]=false;t["object-fit"]=false;t["object-position"]=false;t["opacity"]=false;t["order"]=false;t["orphans"]=false;t["outline"]=false;t["outline-color"]=false;t["outline-offset"]=false;t["outline-style"]=false;t["outline-width"]=false;t["overflow"]=false;t["overflow-wrap"]=false;t["overflow-x"]=false;t["overflow-y"]=false;t["padding"]=true;t["padding-bottom"]=true;t["padding-left"]=true;t["padding-right"]=true;t["padding-top"]=true;t["page"]=false;t["page-break-after"]=false;t["page-break-before"]=false;t["page-break-inside"]=false;t["page-policy"]=false;t["pause"]=false;t["pause-after"]=false;t["pause-before"]=false;t["perspective"]=false;t["perspective-origin"]=false;t["pitch"]=false;t["pitch-range"]=false;t["play-during"]=false;t["position"]=false;t["presentation-level"]=false;t["quotes"]=false;t["region-fragment"]=false;t["resize"]=false;t["rest"]=false;t["rest-after"]=false;t["rest-before"]=false;t["richness"]=false;t["right"]=false;t["rotation"]=false;t["rotation-point"]=false;t["ruby-align"]=false;t["ruby-merge"]=false;t["ruby-position"]=false;t["shape-image-threshold"]=false;t["shape-outside"]=false;t["shape-margin"]=false;t["size"]=false;t["speak"]=false;t["speak-as"]=false;t["speak-header"]=false;t["speak-numeral"]=false;t["speak-punctuation"]=false;t["speech-rate"]=false;t["stress"]=false;t["string-set"]=false;t["tab-size"]=false;t["table-layout"]=false;t["text-align"]=true;t["text-align-last"]=true;t["text-combine-upright"]=true;t["text-decoration"]=true;t["text-decoration-color"]=true;t["text-decoration-line"]=true;t["text-decoration-skip"]=true;t["text-decoration-style"]=true;t["text-emphasis"]=true;t["text-emphasis-color"]=true;t["text-emphasis-position"]=true;t["text-emphasis-style"]=true;t["text-height"]=true;t["text-indent"]=true;t["text-justify"]=true;t["text-orientation"]=true;t["text-overflow"]=true;t["text-shadow"]=true;t["text-space-collapse"]=true;t["text-transform"]=true;t["text-underline-position"]=true;t["text-wrap"]=true;t["top"]=false;t["transform"]=false;t["transform-origin"]=false;t["transform-style"]=false;t["transition"]=false;t["transition-delay"]=false;t["transition-duration"]=false;t["transition-property"]=false;t["transition-timing-function"]=false;t["unicode-bidi"]=false;t["vertical-align"]=false;t["visibility"]=false;t["voice-balance"]=false;t["voice-duration"]=false;t["voice-family"]=false;t["voice-pitch"]=false;t["voice-range"]=false;t["voice-rate"]=false;t["voice-stress"]=false;t["voice-volume"]=false;t["volume"]=false;t["white-space"]=false;t["widows"]=false;t["width"]=true;t["will-change"]=false;t["word-break"]=true;t["word-spacing"]=true;t["word-wrap"]=true;t["wrap-flow"]=false;t["wrap-through"]=false;t["writing-mode"]=false;t["z-index"]=false;return t}function CS(t,e,i){}function ES(t,e,i){}var jS=/javascript\s*\:/gim;function OS(t,e){if(jS.test(e))return"";return e}IS.whiteList=kS();IS.getDefaultWhiteList=kS;IS.onAttr=CS;IS.onIgnoreAttr=ES;IS.safeAttrValue=OS;var RS={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf){return t.indexOf(e)}for(i=0,n=t.length;i<n;i++){if(t[i]===e){return i}}return-1},forEach:function(t,e,i){var n,s;if(Array.prototype.forEach){return t.forEach(e,i)}for(n=0,s=t.length;n<s;n++){e.call(i,t[n],n,t)}},trim:function(t){if(String.prototype.trim){return t.trim()}return t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){if(String.prototype.trimRight){return t.trimRight()}return t.replace(/(\s*$)/g,"")}};var LS=RS;function NS(t,e){t=LS.trimRight(t);if(t[t.length-1]!==";")t+=";";var i=t.length;var n=false;var s=0;var r=0;var o="";function a(){if(!n){var i=LS.trim(t.slice(s,r));var a=i.indexOf(":");if(a!==-1){var l=LS.trim(i.slice(0,a));var u=LS.trim(i.slice(a+1));if(l){var c=e(s,o.length,l,u,i);if(c)o+=c+"; "}}}s=r+1}for(;r<i;r++){var l=t[r];if(l==="/"&&t[r+1]==="*"){var u=t.indexOf("*/",r+2);if(u===-1)break;r=u+1;s=r+1;n=false}else if(l==="("){n=true}else if(l===")"){n=false}else if(l===";"){if(n);else{a()}}else if(l==="\n"){a()}}return LS.trim(o)}var PS=NS;var FS=IS;var DS=PS;function $S(t){return t===undefined||t===null}function zS(t){var e={};for(var i in t){e[i]=t[i]}return e}function US(t){t=zS(t||{});t.whiteList=t.whiteList||FS.whiteList;t.onAttr=t.onAttr||FS.onAttr;t.onIgnoreAttr=t.onIgnoreAttr||FS.onIgnoreAttr;t.safeAttrValue=t.safeAttrValue||FS.safeAttrValue;this.options=t}US.prototype.process=function(t){t=t||"";t=t.toString();if(!t)return"";var e=this;var i=e.options;var n=i.whiteList;var s=i.onAttr;var r=i.onIgnoreAttr;var o=i.safeAttrValue;var a=DS(t,(function(t,e,i,a,l){var u=n[i];var c=false;if(u===true)c=u;else if(typeof u==="function")c=u(a);else if(u instanceof RegExp)c=u.test(a);if(c!==true)c=false;a=o(i,a);if(!a)return;var h={position:e,sourcePosition:t,source:l,isWhite:c};if(c){var d=s(i,a,h);if($S(d)){return i+":"+a}else{return d}}else{var d=r(i,a,h);if(!$S(d)){return d}}}));return a};var BS=US;(function(t,e){var i=IS;var n=BS;function s(t,e){var i=new n(e);return i.process(t)}e=t.exports=s;e.FilterCSS=n;for(var r in i)e[r]=i[r]})(AS,AS.exports);var GS=AS.exports;var VS={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf){return t.indexOf(e)}for(i=0,n=t.length;i<n;i++){if(t[i]===e){return i}}return-1},forEach:function(t,e,i){var n,s;if(Array.prototype.forEach){return t.forEach(e,i)}for(n=0,s=t.length;n<s;n++){e.call(i,t[n],n,t)}},trim:function(t){if(String.prototype.trim){return t.trim()}return t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/;var i=e.exec(t);return i?i.index:-1}};var qS=GS.FilterCSS;var HS=GS.getDefaultWhiteList;var WS=VS;function ZS(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var JS=new qS;function YS(t,e,i){}function KS(t,e,i){}function QS(t,e,i){}function XS(t,e,i){}function t_(t){return t.replace(i_,"&lt;").replace(n_,"&gt;")}function e_(t,e,i,n){i=g_(i);if(e==="href"||e==="src"){i=WS.trim(i);if(i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/")){return""}}else if(e==="background"){u_.lastIndex=0;if(u_.test(i)){return""}}else if(e==="style"){c_.lastIndex=0;if(c_.test(i)){return""}h_.lastIndex=0;if(h_.test(i)){u_.lastIndex=0;if(u_.test(i)){return""}}if(n!==false){n=n||JS;i=n.process(i)}}i=v_(i);return i}var i_=/</g;var n_=/>/g;var s_=/"/g;var r_=/&quot;/g;var o_=/&#([a-zA-Z0-9]*);?/gim;var a_=/&colon;?/gim;var l_=/&newline;?/gim;var u_=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi;var c_=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi;var h_=/u\s*r\s*l\s*\(.*/gi;function d_(t){return t.replace(s_,"&quot;")}function f_(t){return t.replace(r_,'"')}function p_(t){return t.replace(o_,(function t(e,i){return i[0]==="x"||i[0]==="X"?String.fromCharCode(parseInt(i.substr(1),16)):String.fromCharCode(parseInt(i,10))}))}function m_(t){return t.replace(a_,":").replace(l_," ")}function y_(t){var e="";for(var i=0,n=t.length;i<n;i++){e+=t.charCodeAt(i)<32?" ":t.charAt(i)}return WS.trim(e)}function g_(t){t=f_(t);t=p_(t);t=m_(t);t=y_(t);return t}function v_(t){t=d_(t);t=t_(t);return t}function w_(){return""}function b_(t,e){if(typeof e!=="function"){e=function(){}}var i=!Array.isArray(t);function n(e){if(i)return true;return WS.indexOf(t,e)!==-1}var s=[];var r=false;return{onIgnoreTag:function(t,i,o){if(n(t)){if(o.isClosing){var a="[/removed]";var l=o.position+a.length;s.push([r!==false?r:o.position,l]);r=false;return a}else{if(!r){r=o.position}return"[removed]"}}else{return e(t,i,o)}},remove:function(t){var e="";var i=0;WS.forEach(s,(function(n){e+=t.slice(i,n[0]);i=n[1]}));e+=t.slice(i);return e}}}function S_(t){var e="";var i=0;while(i<t.length){var n=t.indexOf("\x3c!--",i);if(n===-1){e+=t.slice(i);break}e+=t.slice(i,n);var s=t.indexOf("--\x3e",n);if(s===-1){break}i=s+3}return e}function __(t){var e=t.split("");e=e.filter((function(t){var e=t.charCodeAt(0);if(e===127)return false;if(e<=31){if(e===10||e===13)return true;return false}return true}));return e.join("")}TS.whiteList=ZS();TS.getDefaultWhiteList=ZS;TS.onTag=YS;TS.onIgnoreTag=KS;TS.onTagAttr=QS;TS.onIgnoreTagAttr=XS;TS.safeAttrValue=e_;TS.escapeHtml=t_;TS.escapeQuote=d_;TS.unescapeQuote=f_;TS.escapeHtmlEntities=p_;TS.escapeDangerHtml5Entities=m_;TS.clearNonPrintableCharacter=y_;TS.friendlyAttrValue=g_;TS.escapeAttrValue=v_;TS.onIgnoreTagStripAll=w_;TS.StripTagBody=b_;TS.stripCommentTag=S_;TS.stripBlankChar=__;TS.cssFilter=JS;TS.getDefaultCSSWhiteList=HS;var x_={};var M_=VS;function T_(t){var e=M_.spaceIndex(t);var i;if(e===-1){i=t.slice(1,-1)}else{i=t.slice(1,e+1)}i=M_.trim(i).toLowerCase();if(i.slice(0,1)==="/")i=i.slice(1);if(i.slice(-1)==="/")i=i.slice(0,-1);return i}function A_(t){return t.slice(0,2)==="</"}function I_(t,e,i){var n="";var s=0;var r=false;var o=false;var a=0;var l=t.length;var u="";var c="";t:for(a=0;a<l;a++){var h=t.charAt(a);if(r===false){if(h==="<"){r=a;continue}}else{if(o===false){if(h==="<"){n+=i(t.slice(s,a));r=a;s=a;continue}if(h===">"){n+=i(t.slice(s,r));c=t.slice(r,a+1);u=T_(c);n+=e(r,n.length,u,c,A_(c));s=a+1;r=false;continue}if(h==='"'||h==="'"){var d=1;var f=t.charAt(a-d);while(f.trim()===""||f==="="){if(f==="="){o=h;continue t}f=t.charAt(a-++d)}}}else{if(h===o){o=false;continue}}}}if(s<t.length){n+=i(t.substr(s))}return n}var k_=/[^a-zA-Z0-9\\_:.-]/gim;function C_(t,e){var i=0;var n=0;var s=[];var r=false;var o=t.length;function a(t,i){t=M_.trim(t);t=t.replace(k_,"").toLowerCase();if(t.length<1)return;var n=e(t,i||"");if(n)s.push(n)}for(var l=0;l<o;l++){var u=t.charAt(l);var c,h;if(r===false&&u==="="){r=t.slice(i,l);i=l+1;n=t.charAt(i)==='"'||t.charAt(i)==="'"?i:j_(t,l+1);continue}if(r!==false){if(l===n){h=t.indexOf(u,l+1);if(h===-1){break}else{c=M_.trim(t.slice(n+1,h));a(r,c);r=false;l=h;i=l+1;continue}}}if(/\s|\n|\t/.test(u)){t=t.replace(/\s|\n|\t/g," ");if(r===false){h=E_(t,l);if(h===-1){c=M_.trim(t.slice(i,l));a(c);r=false;i=l+1;continue}else{l=h-1;continue}}else{h=O_(t,l-1);if(h===-1){c=M_.trim(t.slice(i,l));c=L_(c);a(r,c);r=false;i=l+1;continue}else{continue}}}}if(i<t.length){if(r===false){a(t.slice(i))}else{a(r,L_(M_.trim(t.slice(i))))}}return M_.trim(s.join(" "))}function E_(t,e){for(;e<t.length;e++){var i=t[e];if(i===" ")continue;if(i==="=")return e;return-1}}function j_(t,e){for(;e<t.length;e++){var i=t[e];if(i===" ")continue;if(i==="'"||i==='"')return e;return-1}}function O_(t,e){for(;e>0;e--){var i=t[e];if(i===" ")continue;if(i==="=")return e;return-1}}function R_(t){if(t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"){return true}else{return false}}function L_(t){if(R_(t)){return t.substr(1,t.length-2)}else{return t}}x_.parseTag=I_;x_.parseAttr=C_;var N_=GS.FilterCSS;var P_=TS;var F_=x_;var D_=F_.parseTag;var $_=F_.parseAttr;var z_=VS;function U_(t){return t===undefined||t===null}function B_(t){var e=z_.spaceIndex(t);if(e===-1){return{html:"",closing:t[t.length-2]==="/"}}t=z_.trim(t.slice(e+1,-1));var i=t[t.length-1]==="/";if(i)t=z_.trim(t.slice(0,-1));return{html:t,closing:i}}function G_(t){var e={};for(var i in t){e[i]=t[i]}return e}function V_(t){var e={};for(var i in t){if(Array.isArray(t[i])){e[i.toLowerCase()]=t[i].map((function(t){return t.toLowerCase()}))}else{e[i.toLowerCase()]=t[i]}}return e}function q_(t){t=G_(t||{});if(t.stripIgnoreTag){if(t.onIgnoreTag){console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time')}t.onIgnoreTag=P_.onIgnoreTagStripAll}if(t.whiteList||t.allowList){t.whiteList=V_(t.whiteList||t.allowList)}else{t.whiteList=P_.whiteList}t.onTag=t.onTag||P_.onTag;t.onTagAttr=t.onTagAttr||P_.onTagAttr;t.onIgnoreTag=t.onIgnoreTag||P_.onIgnoreTag;t.onIgnoreTagAttr=t.onIgnoreTagAttr||P_.onIgnoreTagAttr;t.safeAttrValue=t.safeAttrValue||P_.safeAttrValue;t.escapeHtml=t.escapeHtml||P_.escapeHtml;this.options=t;if(t.css===false){this.cssFilter=false}else{t.css=t.css||{};this.cssFilter=new N_(t.css)}}q_.prototype.process=function(t){t=t||"";t=t.toString();if(!t)return"";var e=this;var i=e.options;var n=i.whiteList;var s=i.onTag;var r=i.onIgnoreTag;var o=i.onTagAttr;var a=i.onIgnoreTagAttr;var l=i.safeAttrValue;var u=i.escapeHtml;var c=e.cssFilter;if(i.stripBlankChar){t=P_.stripBlankChar(t)}if(!i.allowCommentTag){t=P_.stripCommentTag(t)}var h=false;if(i.stripIgnoreTagBody){h=P_.StripTagBody(i.stripIgnoreTagBody,r);r=h.onIgnoreTag}var d=D_(t,(function(t,e,i,h,d){var f={sourcePosition:t,position:e,isClosing:d,isWhite:Object.prototype.hasOwnProperty.call(n,i)};var p=s(i,h,f);if(!U_(p))return p;if(f.isWhite){if(f.isClosing){return"</"+i+">"}var m=B_(h);var y=n[i];var g=$_(m.html,(function(t,e){var n=z_.indexOf(y,t)!==-1;var s=o(i,t,e,n);if(!U_(s))return s;if(n){e=l(i,t,e,c);if(e){return t+'="'+e+'"'}else{return t}}else{s=a(i,t,e,n);if(!U_(s))return s;return}}));h="<"+i;if(g)h+=" "+g;if(m.closing)h+=" /";h+=">";return h}else{p=r(i,h,f);if(!U_(p))return p;return u(h)}}),u);if(h){d=h.remove(d)}return d};var H_=q_;(function(t,e){var i=TS;var n=x_;var s=H_;function r(t,e){var i=new s(e);return i.process(t)}e=t.exports=r;e.filterXSS=r;e.FilterXSS=s;(function(){for(var t in i){e[t]=i[t]}for(var s in n){e[s]=n[s]}})();function o(){return typeof self!=="undefined"&&typeof DedicatedWorkerGlobalScope!=="undefined"&&self instanceof DedicatedWorkerGlobalScope}if(o()){self.filterXSS=t.exports}})(MS,MS.exports);var W_=MS.exports;var Z_=function(t){if(typeof t!=="object"||t===null){return false}if(Object.prototype.toString.call(t)!=="[object Object]"){return false}var e=Object.getPrototypeOf(t);if(e===null){return true}while(Object.getPrototypeOf(e)!==null){e=Object.getPrototypeOf(e)}return Object.getPrototypeOf(t)===e};var J_=function(){function t(t,e){var i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]};this.arcgisCSSWhiteList=xS(xS({},W_.getDefaultCSSWhiteList()),{"align-items":true,"align-self":true,flex:true,"flex-basis":true,"flex-direction":true,"flex-flow":true,"flex-grow":true,"flex-shrink":true,"flex-wrap":true,float:true,gap:true,grid:true,"grid-area":true,"grid-auto-columns":true,"grid-auto-flow":true,"grid-auto-rows":true,"grid-column":true,"grid-column-end":true,"grid-column-start":true,"grid-row":true,"grid-row-end":true,"grid-row-start":true,"grid-template":true,"grid-template-areas":true,"grid-template-columns":true,"grid-template-rows":true,"justify-content":true,"justify-items":true,"justify-self":true,"line-height":true,overflow:true});this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"];this.arcgisFilterOptions={allowCommentTag:true,safeAttrValue:function(t,e,n,s){if(t==="a"&&e==="href"||(t==="img"||t==="source")&&e==="src"){return i.sanitizeUrl(n)}return W_.safeAttrValue(t,e,n,s)}};this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var n;if(t&&!e){n=t}else if(t&&e){n=Object.create(this.arcgisFilterOptions);n.css={whiteList:this.arcgisCSSWhiteList};Object.keys(t).forEach((function(e){if(e==="whiteList"){n.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,t.whiteList||{}])}else if(e==="css"){var s=t.css.whiteList;if(s!=null&&t.css instanceof Object){Object.keys(s).forEach((function(t){return n.css.whiteList[t]=s[t]}))}}else{n[e]=t[e]}}))}else{n=Object.create(this.arcgisFilterOptions);n.whiteList=this.arcgisWhiteList;n.css={whiteList:this.arcgisCSSWhiteList}}this.xssFilterOptions=n;this._xssFilter=new W_.FilterXSS(n)}t.prototype.sanitize=function(t,e){if(e===void 0){e={}}switch(typeof t){case"number":if(isNaN(t)||!isFinite(t)){return null}return t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,e);default:if(e.allowUndefined&&typeof t==="undefined"){return}return null}};t.prototype.sanitizeUrl=function(t,e){var i=(e!==null&&e!==void 0?e:{}).isProtocolRequired,n=i===void 0?true:i;var s=this._trim(t.substring(0,t.indexOf(":")));var r=t==="/";var o=/^#/.test(t);var a=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;if(r||o||a){return W_.escapeAttrValue(t)}if(!s&&!n){return W_.escapeAttrValue("https://".concat(t))}return""};t.prototype.sanitizeHTMLAttribute=function(t,e,i,n){if(typeof this.xssFilterOptions.safeAttrValue==="function"){return this.xssFilterOptions.safeAttrValue(t,e,i,n)}return W_.safeAttrValue(t,e,i,n)};t.prototype.validate=function(t,e){if(e===void 0){e={}}var i=this.sanitize(t,e);return{isValid:t===i,sanitized:i}};t.prototype.encodeHTML=function(t){var e=this;return String(t).replace(/[&<>"'\/]/g,(function(t){return e._entityMap[t]}))};t.prototype.encodeAttrValue=function(t){var e=/^[a-zA-Z0-9]$/;return String(t).replace(/[\x00-\xFF]/g,(function(i,n){return!e.test(i)?"&#x".concat(Number(t.charCodeAt(n)).toString(16),";"):i}))};t.prototype._extendObjectOfArrays=function(t){var e={};t.forEach((function(t){Object.keys(t).forEach((function(i){if(Array.isArray(t[i])&&Array.isArray(e[i])){e[i]=e[i].concat(t[i])}else{e[i]=t[i]}}))}));return e};t.prototype._iterateOverObject=function(t,e){var i=this;if(e===void 0){e={}}try{var n=false;var s=void 0;if(Array.isArray(t)){s=t.reduce((function(t,s){var r=i.validate(s,e);if(r.isValid){return t.concat([s])}else{n=true;return t.concat([r.sanitized])}}),[])}else if(!Z_(t)){if(e.allowUndefined&&typeof t==="undefined"){return}return null}else{var r=Object.keys(t);s=r.reduce((function(s,r){var o=t[r];var a=i.validate(o,e);if(a.isValid){s[r]=o}else{n=true;s[r]=a.sanitized}return s}),{})}if(n){return s}return t}catch(t){return null}};t.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")};return t}();const Y_=new Map;function K_(){Y_.clear()}function Q_(t){return Y_.get(t)}function X_(t,e){Y_.set(t,e)}function tx(t){Y_.delete(t)}function ex(...t){const e=es.acquire();for(let i=0;i<t.length;i++){const n=t[i],s=typeof n;if("string"===s)e.push(n);else if(Array.isArray(n))e.push.apply(e,n);else if("object"===s)for(const t in n)n[t]&&e.push(t)}const i=e.join(" ");return es.release(e),i}const ix=(()=>{const t=new Map,e=new ResizeObserver((e=>{K_();for(const i of e)t.get(i.target)?.(i)})),i=(i,n,s)=>(t.set(i,n),e.observe(i,s),we((()=>{e.unobserve(i),t.delete(i)})));return(t,e,n)=>{let s=null;return Se([ey((()=>"function"==typeof t?t():t),(t=>{s?.remove(),t&&(s=i(t,e,n))}),fy),we((()=>s?.remove()))])}})();function nx(t){const e=t?.closest("[dir]");return null!==e&&e instanceof HTMLElement&&"rtl"===e.dir||"rtl"===document.dir}function sx(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function rx(t){const e="data-node-ref";this[t.getAttribute(e)]=t}const ox=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup",...["animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"]],ax=ox.reduce(((t,e)=>(t[e]=[],t)),{}),lx=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],ux=new J_({whiteList:ax,onTagAttr:(t,e,i)=>{const n=`${e}="${i}"`;if(lx.includes(e))return n},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function cx(t){return"Enter"===t||" "===t}async function hx(t,e){await dr(xs(e));const i="function"==typeof t?t():t;i&&("setFocus"in i&&"function"==typeof i.setFocus?await i.setFocus():i instanceof HTMLElement&&i.focus())}const dx="http://www.w3.org/",fx=`${dx}2000/svg`,px=`${dx}1999/xlink`;let mx=[],yx=(t,e)=>{let i={};return Object.keys(t).forEach((e=>{i[e]=t[e]})),e&&Object.keys(e).forEach((t=>{i[t]=e[t]})),i},gx=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),vx=t=>{if("string"!=typeof t)throw new Error("Style values must be strings")},wx=(t,e,i)=>{if(""!==e.vnodeSelector)for(let n=i;n<t.length;n++)if(gx(t[n],e))return n;return-1},bx=(t,e,i,n)=>{let s=t[e];if(""===s.vnodeSelector)return;let r=s.properties;if(!(r?void 0===r.key?r.bind:r.key:void 0))for(let r=0;r<t.length;r++)if(r!==e){let e=t[r];if(gx(e,s))throw new Error(`${i.vnodeSelector} had a ${s.vnodeSelector} child ${"added"===n?n:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},Sx=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},_x=[],xx=!1,Mx=t=>{(t.children||[]).forEach(Mx),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},Tx=()=>{xx=!1,_x.forEach(Mx),_x.length=0},Ax=t=>{_x.push(t),xx||(xx=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(Tx,{timeout:16}):setTimeout(Tx,16))},Ix=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i){e.style.pointerEvents="none";let n=()=>{e.parentNode&&(e.parentNode.removeChild(e),Ax(t))};return void i(e,n,t.properties)}}e.parentNode&&(e.parentNode.removeChild(e),Ax(t))},kx=(t,e,i)=>{if(!e)return;let n=i.eventHandlerInterceptor,s=Object.keys(e),r=s.length;for(let o=0;o<r;o++){let r=s[o],a=e[r];if("className"===r)throw new Error('Property "className" is not supported, use "class".');if("class"===r)Lx(t,a,!0);else if("classes"===r){let e=Object.keys(a),i=e.length;for(let n=0;n<i;n++){let i=e[n];a[i]&&t.classList.add(i)}}else if("styles"===r){let e=Object.keys(a),n=e.length;for(let s=0;s<n;s++){let n=e[s],r=a[n];r&&(vx(r),i.styleApplyer(t,n,r))}}else if("key"!==r&&null!=a){let s=typeof a;"function"===s?(0===r.lastIndexOf("on",0)&&(n&&(a=n(r,a,t,e)),"oninput"===r&&function(){let t=a;a=function(e){t.apply(this,[e]),e.target["oninput-value"]=e.target.value}}()),t[r]=a):i.namespace===fx?"href"===r?t.setAttributeNS(px,r,a):t.setAttribute(r,a):"string"===s&&"value"!==r?"innerHTML"===r?t[r]=ux.sanitize(a):Cx(t)&&r in t?t[r]=a:t.setAttribute(r,a):t[r]=a}}};function Cx(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let Ex,jx=(t,e,i)=>{if(e)for(let n of e)Rx(n,t,void 0,i)},Ox=(t,e,i)=>{jx(t,e.children,i),e.text&&(t.textContent=e.text),kx(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},Rx=(t,e,i,n)=>{let s,r=0,o=t.vnodeSelector,a=e.ownerDocument;if(""===o)s=t.domNode=a.createTextNode(t.text),void 0!==i?e.insertBefore(s,i):e.appendChild(s);else{for(let l=0;l<=o.length;++l){let u=o.charAt(l);if(l===o.length||"."===u||"#"===u){let u=o.charAt(r-1),c=o.slice(r,l);"."===u?s.classList.add(c):"#"===u?s.id=c:("svg"===c&&(n=yx(n,{namespace:fx})),void 0!==n.namespace?s=t.domNode=a.createElementNS(n.namespace,c):(s=t.domNode=t.domNode||a.createElement(c),"input"===c&&t.properties&&void 0!==t.properties.type&&s.setAttribute("type",t.properties.type)),void 0!==i?e.insertBefore(s,i):s.parentNode!==e&&e.appendChild(s)),r=l+1}}Ox(s,t,n)}},Lx=(t,e,i)=>{e&&e.split(" ").forEach((e=>{e&&t.classList.toggle(e,i)}))},Nx=(t,e,i,n)=>{if(!i)return;let s=!1,r=Object.keys(i),o=r.length;for(let a=0;a<o;a++){let o=r[a],l=i[o],u=e[o];if("class"===o)u!==l&&(Lx(t,u,!1),Lx(t,l,!0));else if("classes"===o){let e=t.classList,i=Object.keys(l),n=i.length;for(let t=0;t<n;t++){let n=i[t],r=!!l[n];r!==!!u[n]&&(s=!0,r?e.add(n):e.remove(n))}}else if("styles"===o){let e=Object.keys(l),i=e.length;for(let r=0;r<i;r++){let i=e[r],o=l[i];o!==u[i]&&(s=!0,o?(vx(o),n.styleApplyer(t,i,o)):n.styleApplyer(t,i,""))}}else if(l||"string"!=typeof u||(l=""),"value"!==o||Cx(t)){if(l!==u){let e=typeof l;"function"===e&&n.eventHandlerInterceptor||(n.namespace===fx?"href"===o?t.setAttributeNS(px,o,l):t.setAttribute(o,l):"string"===e?"innerHTML"===o?t[o]=ux.sanitize(l):"role"===o&&""===l?t.removeAttribute(o):Cx(t)&&o in t?t[o]=l:t.setAttribute(o,l):t[o]!==l&&(t[o]=l),s=!0)}}else{let e=t[o];e!==l&&(t["oninput-value"]?e===t["oninput-value"]:l!==u)&&(t[o]=l,t["oninput-value"]=void 0),l!==u&&(s=!0)}}return s},Px=(t,e,i,n,s)=>{if(i===n)return!1;n=n||mx;let r,o=(i=i||mx).length,a=n.length,l=0,u=0,c=!1;for(;u<a;){let a=l<o?i[l]:void 0,h=n[u];if(void 0!==a&&gx(a,h))c=Ex(a,h,s)||c,l++;else{let a=wx(i,h,l+1);if(a>=0){for(r=l;r<a;r++)Ix(i[r]),bx(i,r,t,"removed");c=Ex(i[a],h,s)||c,l=a+1}else Rx(h,e,l<o?i[l].domNode:void 0,s),Sx(h),bx(n,u,t,"added")}u++}if(o>l)for(r=l;r<o;r++)Ix(i[r]),bx(i,r,t,"removed");return c};Ex=(t,e,i)=>{let n=t.domNode,s=!1;if(t===e)return!1;let r=!1;if(""===e.vnodeSelector){if(e.text!==t.text){let t=n.ownerDocument.createTextNode(e.text);return n.parentNode.replaceChild(t,n),e.domNode=t,s=!0,s}e.domNode=n}else 0===e.vnodeSelector.lastIndexOf("svg",0)&&(i=yx(i,{namespace:fx})),t.text!==e.text&&(r=!0,void 0===e.text?n.removeChild(n.firstChild):n.textContent=e.text),e.domNode=n,r=Px(e,n,t.children,e.children,i)||r,r=Nx(n,t.properties,e.properties,i)||r,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[n,i,e.vnodeSelector,e.properties,e.children]);return r&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(n,e.properties,t.properties),s};let Fx=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let n=t;t=i,Ex(n,i,e)},domNode:t.domNode});const Dx={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}};let $x=t=>yx(Dx,t),zx={create:(t,e)=>(e=$x(e),Rx(t,document.createElement("div"),void 0,e),Fx(t,e)),append:(t,e,i)=>(i=$x(i),Rx(e,t,void 0,i),Fx(e,i)),insertBefore:(t,e,i)=>(i=$x(i),Rx(e,t.parentNode,t,i),Fx(e,i)),merge:(t,e,i)=>(i=$x(i),e.domNode=t,Ox(t,e,i),Fx(e,i)),replace:(t,e,i)=>(i=$x(i),Rx(e,t.parentNode,t,i),t.parentNode.removeChild(t),Fx(e,i))};let Ux,Bx=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};Ux=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let Gx=(t,e)=>{let i=t;return e.forEach((t=>{i=i&&i.children?Ux(i.children,(e=>e.domNode===t)):void 0})),i},Vx=(t,e,i)=>{let n=function(n){i("domEvent",n);let s=e(),r=Bx(n.currentTarget,s.domNode);r.reverse();let o,a=Gx(s.getLastRender(),r);return t.scheduleRender(),a&&(o=a.properties[`on${n.type}`].apply(a.properties.bind||this,arguments)),i("domEventProcessed",n),o};return(t,e,i,s)=>n},qx=t=>{let e,i,n=$x(t),s=n.performanceLogger,r=!0,o=!1,a=[],l=[],u=(t,i,r)=>{let o,u=()=>o;n.eventHandlerInterceptor=Vx(e,u,s),o=t(i,r(),n),a.push(o),l.push(r)},c=()=>{if(i=void 0,r){r=!1,s("renderStart",void 0);for(let t=0;t<a.length;t++){let e=l[t]();s("rendered",void 0),a[t].update(e),s("patched",void 0)}s("renderDone",void 0),r=!0}};return e={renderNow:c,scheduleRender:()=>{i||o||(i=requestAnimationFrame(c))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,r=!0,e.scheduleRender()},append:(t,e)=>{u(zx.append,t,e)},insertBefore:(t,e)=>{u(zx.insertBefore,t,e)},merge:(t,e)=>{u(zx.merge,t,e)},replace:(t,e)=>{u(zx.replace,t,e)},detach:t=>{for(let e=0;e<l.length;e++)if(l[e]===t)return l.splice(e,1),a.splice(e,1)[0];throw new Error("renderFunction was not found")}},e};let Hx=class extends ao{constructor(){super(...arguments),this.items=new Vm,this._watchUpdatingTracking=new SS,this._callbacks=new Map,this._projector=qx(),this._hiddenProjector=qx()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange((()=>this.items),(t=>{for(const e of t.added){const t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t)}for(const e of t.removed){const t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e)}}))}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const e=this._hiddenSurface,i=this._hiddenProjector;let n;const s=()=>(n=t.render(),n);i.append(e,s),i.renderNow();const r={left:0,top:0,right:0,bottom:0};if(n?.domNode){const t=n.domNode.getBoundingClientRect();r.left=t.left,r.top=t.top,r.right=t.right,r.bottom=t.bottom}for(i.detach(s);e.firstChild;)e.removeChild(e.firstChild);return r}overlaps(t,e){const i=this.computeBoundingRect(t),n=this.computeBoundingRect(e);return Math.max(i.left,n.left)<=Math.min(i.right,n.right)&&Math.max(i.top,n.top)<=Math.min(i.bottom,n.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}async prepare(){await document.fonts.load(this._fontString()).catch((()=>{}))}renderCanvas(t,e){const i=!!e?.disableDecorations;if(!this.items.some((t=>t.visible&&!(i&&t.isDecoration))))return;const n=t.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach((t=>{i&&t.isDecoration||(n.save(),t.renderCanvas(n),n.restore())})),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};r([Je({readOnly:!0})],Hx.prototype,"surface",void 0),r([Je({readOnly:!0})],Hx.prototype,"items",void 0),r([Je({readOnly:!0})],Hx.prototype,"needsRender",null),r([Je({readOnly:!0})],Hx.prototype,"_watchUpdatingTracking",void 0),r([Je({readOnly:!0})],Hx.prototype,"updating",null),Hx=r([ln("esri.views.overlay.ViewOverlay")],Hx);const Wx=Hx;const Zx=[0,0];function Jx(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return Zx[0]=i.left+(e?.pageXOffset??0),Zx[1]=i.top+(e?.pageYOffset??0),Zx}function Yx(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function Kx(t){const e=document.createElement("div");return t.appendChild(e),e}const Qx=16,Xx=750,tM=512,eM=2,iM=t=>{let e=class extends t{constructor(...t){super(...t),this._freqInfo={freq:Qx,time:Xx},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([ey((()=>this.cursor),(t=>{const{surface:e}=this;e&&e.setAttribute("data-cursor",t)})),ey((()=>this.navigating),(t=>{const{surface:e}=this;e&&e.setAttribute("data-navigating",t.toString())}))])}initialize(){this.addHandles([ey((()=>this.ui),((t,e)=>this._handleUIChange(t,e)),dy),this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui=An(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(t){const e=this._get("container"),i=wS(t);if(i||"string"!=typeof t||jt.getLogger(this).error("#container",`element with id '${t}' not found`),e===i)return;if(this._stopMeasuring(),e&&(e.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Yx(this.root),this._set("root",null)),this.userContent&&(bS(this.userContent,e),Yx(this.userContent),this._set("userContent",null))),!i)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);i.classList.add("esri-view");const n=document.createElement("div");n.className="esri-view-user-storage",bS(i,n),i.appendChild(n),this._set("userContent",n);const s=document.createElement("div");s.className="esri-view-root",i.insertBefore(s,i.firstChild),this._set("root",s);const r=document.createElement("div");r.className="esri-view-surface",r.setAttribute("role","application"),r.tabIndex=0,s.appendChild(r),this._set("surface",r);const o=new Wx;s.appendChild(o.surface),this._set("overlay",o),this.addHandles(ey((()=>o.needsRender),(t=>{t&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=ir({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=kn(this._overlayRenderTaskHandle)}))),this.forceDOMReadyCycle(),this._set("container",i),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}get size(){return[this.width,this.height]}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(t,e,i){const n=this.position;return t-=n?n[0]:0,e-=n?n[1]:0,i?(i[0]=t,i[1]=e):i=[t,e],i}containerToPage(t,e,i){const n=this.position;return t+=n?n[0]:0,e+=n?n[1]:0,i?(i[0]=t,i[1]=e):i=[t,e],i}_handleUIChange(t,e){this.removeHandles("ui"),e&&e!==t&&e.destroy(),t&&(t.view=this,this.addHandles(ey((()=>this.root),(e=>{t.container=e?Kx(e):null}),dy),"ui")),this._set("ui",t)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=Qx,t.time=Xx,this.addHandles([vs(window,"resize",(()=>{t.freq=Qx,t.time=Xx})),ir({prepare:t=>{const e=this._measure(),i=this._freqInfo;if(i.time+=t.deltaTime,e&&(i.freq=Qx,this._get("resizing")||this._set("resizing",!0)),i.time<i.freq)return;i.time=0;const n=this._position();i.freq=n||e?Qx:Math.min(Xx,i.freq*eM),!e&&i.freq>=tM&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,e=t?t.clientWidth:0,i=t?t.clientHeight:0;if(0===e||0===i)return this.suspended||this._set("suspended",!0),!1;const n=this.width,s=this.height;return e===n&&i===s?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",e),this._set("height",i),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:n,oldHeight:s,width:e,height:i}),!0)}_position(){const t=this.container,e=this.position,i=t&&Jx(t);return!!i&&((!e||i[0]!==e[0]||i[1]!==e[1])&&(this._set("position",[i[0],i[1]]),!0))}forceDOMReadyCycle(){}};return r([Je()],e.prototype,"container",null),r([Je({readOnly:!0})],e.prototype,"focused",null),r([Je({readOnly:!0})],e.prototype,"height",void 0),r([Je()],e.prototype,"messagesCommon",void 0),r([Je({type:Wx})],e.prototype,"overlay",void 0),r([Je({readOnly:!0})],e.prototype,"position",void 0),r([Je({readOnly:!0})],e.prototype,"resizing",void 0),r([Je({readOnly:!0})],e.prototype,"root",void 0),r([Je({value:null,readOnly:!0})],e.prototype,"size",null),r([Je({readOnly:!0})],e.prototype,"surface",void 0),r([Je({readOnly:!0})],e.prototype,"suspended",void 0),r([Je()],e.prototype,"ui",void 0),r([Je({readOnly:!0})],e.prototype,"userContent",void 0),r([Je({readOnly:!0})],e.prototype,"width",void 0),r([Je()],e.prototype,"widthBreakpoint",void 0),e=r([ln("esri.views.DOMContainer")],e),e};const nM=u("mac")?"Meta":"Control",sM=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),rM=t=>sM.has(t);class oM{constructor(t,e=[]){this.eventType=t,this.keyModifiers=e}matches(t){if(t.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;const e=t.modifiers;for(const t of this.keyModifiers)if(!e.has(t))return!1;return!0}}class aM{constructor(t){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const t in this._incoming){const e=this._incoming[t];for(const t of e)this._incomingEventMatches.push(t.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((t=>t.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(t){this._manager||(t.setEventCallback((t=>this._handleEvent(t))),t.setUninstallCallback((()=>this._onUninstall())),this._manager=t)}onUninstall(){}registerIncoming(t,e,i){let n;"function"==typeof e?(i=e,n=[]):n=e||[];const s="string"==typeof t?new oM(t,n):t,r=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},o=t=>{const e=this._incoming[t.match.eventType];if(e){const i=e.indexOf(t);e.splice(i,1),r(),this._manager&&this._manager.updateDependencies()}},a=new lM(s,i,{onPause:o,onRemove:o,onResume:t=>{const e=this._incoming[t.match.eventType];e&&!e.includes(t)&&(e.push(t),r(),this._manager&&this._manager.updateDependencies())}});let l=this._incoming[s.eventType];return l||(l=[],this._incoming[s.eventType]=l),l.push(a),r(),this._manager&&this._manager.updateDependencies(),a}registerOutgoing(t){if(this._outgoing[t])throw new Error("There is already a callback registered for this outgoing InputEvent: "+t);const e=new uM(t,{onEmit:(t,e,i,n)=>{this._manager?.emit(t.eventType,e,i,n)},onRemove:t=>{delete this._outgoing[t.eventType],this._manager?.updateDependencies()}});return this._outgoing[t]=e,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),e}startCapturingPointer(t){this._manager?.setPointerCapture(t,!0)}stopCapturingPointer(t){this._manager?.setPointerCapture(t,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(t){const e=this._incoming[t.type];if(e)for(const i of e)if(i.match.matches(t)&&(i.callback?.(t),t.shouldStopPropagation()))break}}class lM{constructor(t,e,i){this.match=t,this._callback=e,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}}class uM{constructor(t,e){this.eventType=t,this._removed=!1,this._handler=e}emit(t,e,i){this._removed||this._handler.onEmit(this,t,e,i)}remove(){this._removed=!0,this._handler.onRemove(this)}}class cM extends aM{constructor(t){super(!0),this._onChange=t,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",(t=>this._update(t.data)))}_update(t){const e="touch"===t.native.pointerType?"touch":"mouse",{x:i,y:n}=t;e===this._value&&this._x===i&&this._y===n||(this._value=e,this._x=i,this._y=n,this._onChange(e,i,n))}}class hM{constructor(t,e){this._observable=new km,this._value=t,this._equalityFunction=e}get value(){return oi(this._observable),this._value}set value(t){this._equalityFunction(t,this._value)||(this._value=t,this._observable.notify())}mutate(t){t(this._value),this._observable.notify()}}function dM(t,e=ht){return new hM(t,e)}class fM extends aM{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=dM(!1),this._onPointerAdd=({data:t})=>{"touch"===t.pointerType&&(this._activeTouchPointerIds.add(t.native.pointerId),this._update())},this._onPointerRemove=({data:t})=>{"touch"===t.pointerType&&(this._activeTouchPointerIds.delete(t.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}}class pM{constructor(t,e){this._owner=e,this._properties={},this._afterDispatchHandle=null;for(const e in t){const i=t[e],n=new ns(i,void 0,void 0,2,2);this._properties[e]={pool:n,acquired:[]}}this._afterDispatchHandle=Zr((()=>this._release()))}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const t in this._properties){const e=this._properties[t];for(const t of e.acquired)eo(t)||e.pool.release(t);e.pool.destroy(),e.pool=null,e.acquired=null}this._properties=null,this._owner=null}get(t){const e=this._owner._get(t),i=this._properties[t];let n=i.pool.acquire();for(i.acquired.push(n);n===e;)i.acquired.push(n),n=i.pool.acquire();return n}_release(){for(const t in this._properties){const e=this._properties[t];let i=0;for(const t of e.acquired)eo(t)?e.acquired[i++]=t:e.pool.release(t);e.acquired.length=i}}}let mM=class extends ao{constructor(t){super(t),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=nM,this._latestPointerType="mouse",this._propertiesPool=new pM({latestPointerLocation:bM},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const t=Object.keys(this._nameToGroup);for(const e of t)this.uninstallHandlers(e);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some((t=>t.handler.hasPendingInputs))}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(t,e,i=vM.INTERNAL){if(this._nameToGroup[t])return;if(0===e.length)return;const n={name:t,handlers:e.map((t=>({handler:t,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[t]=n;for(let t=n.handlers.length-1;t>=0;t--){const e=n.handlers[t];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(t,i,n,s,r)=>{this._emitInputEvent(e.priorityIndex+1,t,i,n,r,s)},setPointerCapture:(t,i)=>{this._setPointerCapture(n,e,t,i)},setEventCallback:t=>{e.eventCallback=t},setUninstallCallback:t=>{e.uninstallCallback=t},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(t){const e=this._nameToGroup[t];e?(e.handlers.forEach((t=>{t.removed=!0,t.uninstallCallback?.()})),delete this._nameToGroup[t],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):jt.getLogger(this).error("There is no InputHandler group registered under the name `"+t+"`")}hasHandlers(t){return void 0!==this._nameToGroup[t]}isModifierKeyDown(t){return this._activeKeyModifiers.has(t)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const t=new Set,e=new Set;this._handlersPriority=[];for(let t=this._handlers.length-1;t>=0;t--){const e=this._handlers[t];e.priorityIndex=t,this._handlersPriority.push(e)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const n=this._handlersPriority[i];n.priorityIndex=i;let s=n.handler.hasSideEffects;if(!s)for(const e of n.handler.outgoingEventTypes)if(t.has(e)){s=!0;break}if(s)for(const i of n.handler.incomingEventMatches){t.add(i.eventType);for(const t of i.keyModifiers)rM(t)||e.add(t)}n.active=s}this._sourceEvents=t,this._keyModifiers=e,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(t,e,i){this._latestPointerType=t;const n=this._get("latestPointerLocation");if(null==n||n.x!==e||n.y!==i){const t=this._propertiesPool.get("latestPointerLocation");t.x=e,t.y=i,this._set("latestPointerLocation",t)}}_onEventReceived(t,e){if("pointer-capture-lost"===t){const t=e;this._pointerCaptures.delete(t.native.pointerId)}this._updateKeyModifiers(t,e);const i=null!=this.test.timestamp?this.test.timestamp:e.native?e.native.timestamp:void 0,n=e.native?e.native.cancelable:void 0;this._emitInputEventFromSource(t,e,i,n)}_updateKeyModifiers(t,e){if(!e)return;let i=!1;const n=()=>{i||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),i=!0)},s=(t,e)=>{e&&!this._activeKeyModifiers.has(t)?(n(),this._activeKeyModifiers.add(t)):!e&&this._activeKeyModifiers.has(t)&&(n(),this._activeKeyModifiers.delete(t))};if("key-down"===t||"key-up"===t){const i=e.key;this._keyModifiers.has(i)&&s(i,"key-down"===t)}const r=e.native;s("Alt",!!r?.altKey),s("Control",!!r?.ctrlKey),s("Ctrl",!!r?.ctrlKey),s("Shift",!!r?.shiftKey),s("Meta",!!r?.metaKey),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new cM(((t,e,i)=>this._setLatestPointer(t,e,i))),this._multiTouchHandler=new fM,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],vM.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,vM.INTERNAL)}_setPointerCapture(t,e,i,n){const s=t.name+"-"+e.priorityIndex,r=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,r),n?(r.add(s),1===r.size&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):r.has(s)&&(r.delete(s),0===r.size&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((t=>!t.removed)),this.updateDependencies()}_emitInputEventFromSource(t,e,i,n){this._emitInputEvent(0,t,e,i,n)}_emitInputEvent(t,e,i,n,s,r){const o=void 0!==n?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==s&&s,l={event:new yM(e,i,o,r||this._activeKeyModifiers,a),priorityIndex:t};this._currentPropagation?this._currentPropagation.events.push(l):this._doNewPropagation(l)}_doNewPropagation(t){this._currentPropagation={events:new yy,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:t.event.timestamp},this._currentPropagation.events.push(t),this._continuePropagation()}_continuePropagation(){this._paused=!1;const t=this._currentPropagation;if(t){for(;t.events.length>0;){const{event:e,priorityIndex:i}=t.events.pop(),n=e.data?.eventId;if(!(null!=n&&this._stoppedPropagationEventIds.has(n)))for(t.currentHandler=this._handlersPriority[i];t.currentHandler;){if(t.currentHandler.removed)t.needsHandlerGarbageCollect=!0;else{if(t.currentHandler.active&&!e.shouldStopPropagation()&&t.currentHandler.eventCallback?.(e),e.shouldStopPropagation()){null!=n&&this._stoppedPropagationEventIds.add(n);break}if(e.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:e,priorityIndex:t.currentHandler.priorityIndex+1})}t.currentHandler=this._handlersPriority[t.currentHandler.priorityIndex+1]}}t.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(t){const e=new yy;e.push(t);const i=this._currentPropagation;if(i){for(;i.events.length;)e.push(i.events.pop());i.events=e,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(t,e){if(t.handler.hasSideEffects!==e.handler.hasSideEffects)return t.handler.hasSideEffects?1:-1;if(t.groupPriority!==e.groupPriority)return t.groupPriority>e.groupPriority?-1:1;for(const i of t.handler.incomingEventMatches)for(const t of e.handler.incomingEventMatches){if(i.eventType!==t.eventType)continue;const e=i.keyModifiers.filter((e=>t.keyModifiers.includes(e)));if(e.length===i.keyModifiers.length!==(e.length===t.keyModifiers.length))return i.keyModifiers.length>t.keyModifiers.length?-1:1}return t.priorityIndex>e.priorityIndex?-1:1}_sortHandlersPriority(t){const e=[];for(const i of t){let t=0;for(;t<e.length&&this._compareHandlerPriority(i,e[t])>=0;)t++;e.splice(t,0,i)}return e}get debug(){const t=t=>{const e=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=e};return{injectEvent:(e,i)=>{t((()=>this._onEventReceived(e,i)))},disablePointerCapture:t}}};r([Je({readOnly:!0})],mM.prototype,"hasPendingInputs",null),r([Je({constructOnly:!0})],mM.prototype,"eventSource",void 0),r([Je({constructOnly:!0})],mM.prototype,"recognizers",void 0),r([Je()],mM.prototype,"_latestPointerType",void 0),r([Je()],mM.prototype,"latestPointerType",null),r([Je()],mM.prototype,"multiTouchActive",null),r([Je({readOnly:!0})],mM.prototype,"latestPointerLocation",void 0),r([Je()],mM.prototype,"_paused",void 0),r([Je({readOnly:!0})],mM.prototype,"updating",null),mM=r([ln("esri.views.input.InputManager")],mM);class yM{constructor(t,e,i,n,s){this.type=t,this.data=e,this.timestamp=i,this.modifiers=n,this.cancelable=s,this._propagationState=gM.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=gM.STOPPED}shouldStopPropagation(){return!!(this._propagationState&gM.STOPPED)}async(t){this._propagationState|=gM.PAUSED;const e=(t,e)=>{this._propagationState&=~gM.PAUSED;const i=this._resumeCallback;if(this._resumeCallback=null,i&&i(),e)throw t;return t};return("function"==typeof t?t():t).then((t=>e(t,!1)),(t=>e(t,!0)))}shouldPausePropagation(t){return!!(this._propagationState&gM.PAUSED)&&(this._resumeCallback=t,!0)}preventDefault(){this.data.native.preventDefault()}}var gM;!function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"}(gM||(gM={}));const vM={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};class wM{}const bM=wM;function SM(t){return null!=t&&"open"in t&&"declaredClass"in t}function _M(t){return null!=t&&"declaredClass"in t&&"dockOptions"in t}const xM=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([ey((()=>[this.ui,this.popup]),(([t,e],i)=>{const n="popup",s="manual";if(i){const[t,e]=i;t&&SM(e)&&(e.view=null,_M(e)&&t.remove(e,n))}t&&SM(e)&&(e.view=this,_M(e)&&t.add(e,{key:n,position:s,internal:!0}))}),dy),this.on("click",(t=>{this.popup&&this.popupEnabled&&("mouse"!==t.pointerType||0===t.button)&&(SM(this.popup)?this.popup.viewModel.handleViewClick(t):t.async((async()=>{await this.setupPopup(),SM(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(t)})))}),vM.WIDGET)]),oy((()=>this.ready&&this.popupEnabled&&!this.updating)).then((()=>{import("./p-e03db14b.js")}))}destroy(){this.destroyed||this.closePopup()}async openPopup(t){if(SM(this.popup))return this.popup.open(t);try{if(await this.setupPopup(),!this.popup)return void jt.getLogger(this).error(new Ve("view:null-popup","Popup is null and can't be opened"));this.popup.open(t)}catch{}}closePopup(){this._popupSetupTask?.abort(),SM(this.popup)&&this.popup.close()}async fetchPopupFeatures(t,e){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(t,e),e)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!SM(this.popup))return this._popupSetupTask=Xm((async t=>{const{default:e}=await import("./p-e03db14b.js");if(_s(t),!this.popup||SM(this.popup))return;const i=this.popup;delete i.open,delete i.close,this.popup=new e(i)})),this._popupSetupTask.promise}async _popupHitsToFeatures({location:t,hits:e},i){const n=[],s=[];let r=!1;const o=Ps(i,u("popup-view-fetch-timeout")??TM),a=t=>{const e=new MM(t);return s.push(e),n.push(e.promise),e},l=t=>{const e=s.at(-1);return e&&e.layerView===t&&!r?e:a(t)};for(const t of e)if("graphic"in t){l(t.layerView).graphics.push(t.graphic),r=!1}else n.push(t.layerView.fetchPopupFeaturesAtLocation(t.mapPoint,o)),r=!0;s.map((t=>t.resolve(o)));const c=Rs(n).then((t=>t.filter((t=>!!t)).flat()));return{pendingFeatures:n,allGraphicsPromise:c,location:t}}async _getPopupHits(t,e){const{hits:i,location:n}=await this.popupHitTest(t);_s(e);const s=[];for(const t of i)if("graphic"in t){if(this._isValidPopupGraphic(t.graphic,e)){const e=this._isValidPopupGraphicsLayerView(t.layerView)?t.layerView:void 0;s.push({graphic:t.graphic,layerView:e})}}else this._isValidPopupLocationLayerView(t.layerView)&&s.push({mapPoint:t.mapPoint,layerView:t.layerView});return{hits:s,location:n}}_isValidPopupGraphic(t,e){return t&&!!t.getEffectivePopupTemplate(e?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(t){return!t||(!("layer"in t)||!t.suspended)&&"fetchPopupFeaturesFromGraphics"in t}_isValidPopupLocationLayerView(t){return(!("layer"in t)||!t.suspended)&&"fetchPopupFeaturesAtLocation"in t}};return r([Je()],e.prototype,"popup",void 0),r([Je()],e.prototype,"popupEnabled",void 0),e=r([ln("esri.views.PopupView")],e),e};class MM{constructor(t){this.layerView=t,this._resolver=zs(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(t){const{layerView:e,graphics:i,_resolver:n}=this;if(!e)return n.resolve(i),n.promise;let s;return e.fetchPopupFeaturesFromGraphics(i,t).catch((t=>(s=t,null))).then((t=>{t?n.resolve(t):n.reject(s)})),n.promise}}const TM=5e3;function AM(t,e,i=Vm){return e||(e=new i),e===t||(e.removeAll(),kM(t)?e.addMany(t):t&&e.add(t)),e}function IM(t){return t}function kM(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}var CM;!function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(CM||(CM={}));class EM{constructor(){this._resolver=zs(),this._status=CM.PENDING,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=CM.RESOLVED,this._cleanUp()}),(()=>{this._status=CM.REJECTED,this._cleanUp()})),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return this._status===CM.RESOLVED}isRejected(){return this._status===CM.REJECTED}isFulfilled(){return this._status!==CM.PENDING}abort(){this._resolver.reject(Ss())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const t=zs(),e=[...this._resolvingPromises,t.promise],i=this._allPromise=Promise.all(e);i.then((()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()}),(t=>{this.isFulfilled()||this._allPromise!==i||Es(t)||this._resolver.reject(t)})),t.resolve()}}const jM=t=>{let e=class extends t{constructor(...t){super(...t),this._promiseProps=new EM,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(t,e){return this._promiseProps.promise.then((()=>this)).then(t,e)}catch(t){return this.when(null,t)}addResolvingPromise(t){t&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in t?t.when():t)}};return e=r([ln("esri.core.Promise")],e),e};let OM=class extends(jM(ao)){};OM=r([ln("esri.core.Promise")],OM);const RM="not-loaded",LM="loading",NM="failed",PM="loaded",FM=t=>{let e=class extends t{constructor(...t){super(...t),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((t=>{const e=this.load.bind(this);this.load=i=>{const n=new Promise(((t,e)=>{const n=ks(i,e);this.destroyed&&e(new Ve("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(t,e).finally((()=>{n&&n.remove()}))}));if(this.loadStatus===RM){this._set("loadStatus",LM);const t=this._loadController=new AbortController;e({signal:t.signal})}return t(),n}}))),this.when((()=>{this._set("loadStatus",PM),this._loadController=null}),(t=>{this._set("loadStatus",NM),this._set("loadError",t),this._loadController=null}))}destroy(){this._loadController&&(this._loadController=Cn(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===PM}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new Ve("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return r([Je({readOnly:!0})],e.prototype,"loaded",null),r([Je({readOnly:!0})],e.prototype,"loadError",void 0),r([Je({clonable:!1})],e.prototype,"loadStatus",void 0),r([Je({type:[wi],readOnly:!0})],e.prototype,"loadWarnings",null),e=r([ln("esri.core.Loadable")],e),e};let DM=class extends(FM(OM)){};DM=r([ln("esri.core.Loadable")],DM),function(t){function e(t){return!(!t||!t.load)}t.LoadableMixin=FM,t.isLoadable=e}(DM||(DM={}));const $M=DM;async function zM(t,e){return await t.load(),UM(t,e)}async function UM(t,e){const i=[],n=(...t)=>{for(const e of t)null!=e&&(Array.isArray(e)?n(...e):Vm.isCollection(e)?e.forEach((t=>n(t))):$M.isLoadable(e)&&i.push(e))};e(n);let s=null;if(await Hm(i,(async t=>{const e=await Km(BM(t)?t.loadAll():t.load());!1!==e.ok||s||(s=e)})),s)throw s.error;return t}function BM(t){return"loadAll"in t&&"function"==typeof t.loadAll}let GM;function VM(t){return GM&&!GM.destroyed||(GM=t()),GM}var qM;const HM=new Co({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let WM=qM=class extends ao{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){"asc"!==t&&"desc"!==t||this._set("sortOrder",t)}clone(){return new qM({categories:this.categories?nt(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map((t=>Array.isArray(t)?JSON.stringify(t):t)));let n="";if(this.extent){const t=Fh(this.extent,wh.WGS84);null!=t&&(n=`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`)}let s=this.query;!this.disableExtraQuery&&t.extraQuery&&(s="("+s+")"+t.extraQuery);const r={categories:i,bbox:n,q:s,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(r.sortField=this.sortField.split(",").map((t=>HM.toJSON(t.trim()))).join(","),r.sortOrder=this.sortOrder),{query:{...e,...r}}}};r([Je()],WM.prototype,"categories",void 0),r([Je()],WM.prototype,"disableExtraQuery",void 0),r([Je({type:Od})],WM.prototype,"extent",void 0),r([Je()],WM.prototype,"filter",void 0),r([Je()],WM.prototype,"num",void 0),r([Je()],WM.prototype,"query",void 0),r([Je()],WM.prototype,"sortField",void 0),r([Je()],WM.prototype,"sortOrder",null),r([Je()],WM.prototype,"start",void 0),WM=qM=r([ln("esri.portal.PortalQueryParams")],WM);const ZM=WM;var JM;let YM=JM=class extends Io{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then((e=>{const i=e.categorySchema||[];return i.some((t=>"contentCategorySetsGroupQuery.LivingAtlas"===t.source))?this._fetchCategorySchemaSet("LivingAtlas",t):i}))}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new Ve("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new JM({sourceJSON:t});return e.read(t),e}queryItems(t,e){let i=ee(ZM,t);const n=this.portal;return parseFloat(n.currentVersion)>5?(i=i||new ZM,n.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new ZM,i.query="group:"+this.id+(i.query?" "+i.query:""),n.queryItems(i,e))}_fetchCategorySchemaSet(t,e){const i=this.portal;return i.fetchSelf(i.authMode,!0,e).then((t=>{const n=t.contentCategorySetsGroupQuery;if(n){const t=new ZM({disableExtraQuery:!0,num:1,query:n});return i.queryGroups(t,e)}throw new Ve("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((i=>{if(i.total){const n=i.results[0],s=new ZM({num:1,query:`typekeywords:"${t}"`});return n.queryItems(s,e)}throw new Ve("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((t=>{if(t.total){return t.results[0].fetchData("json",e).then((t=>{const e=t?.categorySchema;return e?.length?e:[]}))}return[]}))}};r([Je()],YM.prototype,"access",void 0),r([Je({type:Date})],YM.prototype,"created",void 0),r([Je()],YM.prototype,"description",void 0),r([Je()],YM.prototype,"id",void 0),r([Je()],YM.prototype,"isInvitationOnly",void 0),r([Je({type:Date})],YM.prototype,"modified",void 0),r([Je()],YM.prototype,"owner",void 0),r([Je()],YM.prototype,"portal",void 0),r([Je()],YM.prototype,"snippet",void 0),r([Je()],YM.prototype,"sortField",void 0),r([Je()],YM.prototype,"sortOrder",void 0),r([Je()],YM.prototype,"sourceJSON",void 0),r([Je()],YM.prototype,"tags",void 0),r([Je()],YM.prototype,"thumbnail",void 0),r([Je({readOnly:!0})],YM.prototype,"thumbnailUrl",null),r([Je()],YM.prototype,"title",void 0),r([Je({readOnly:!0})],YM.prototype,"url",null),YM=JM=r([ln("esri.portal.PortalGroup")],YM);const KM=YM;let QM=class extends ao{constructor(t){super(t),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};r([Je()],QM.prototype,"nextQueryParams",void 0),r([Je()],QM.prototype,"queryParams",void 0),r([Je()],QM.prototype,"results",void 0),r([Je()],QM.prototype,"total",void 0),QM=r([ln("esri.portal.PortalQueryResult")],QM);const XM=QM;let tT=class extends Io{constructor(t){super(t),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Ve("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};r([Je({type:Date})],tT.prototype,"created",void 0),r([Je()],tT.prototype,"id",void 0),r([Je()],tT.prototype,"portal",void 0),r([Je()],tT.prototype,"title",void 0),r([Je({readOnly:!0})],tT.prototype,"url",null),r([Je()],tT.prototype,"username",void 0),tT=r([ln("esri.portal.PortalFolder")],tT);const eT=tT;var iT;let nT=iT=class extends Io{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.username}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t?.data,n=t?.folder,s={method:"post"};e&&(s.query=e.createPostQuery(),null!=i&&("string"==typeof i?s.query.text=i:"object"==typeof i&&(s.query.text=JSON.stringify(i))));let r=this.userContentUrl;return n&&(r+="/"+("string"==typeof n?n:n.id)),this.portal.request(r+"/addItem",s).then((t=>(e.id=t.id,e.portal=this.portal,e.loaded?e.reload():e.load())))}async deleteItem(t,e=!1){let i=this.userContentUrl;t.ownerFolder&&(i+="/"+t.ownerFolder);const n=e?{permanentDelete:!0}:{};await this.portal.request(i+`/items/${t.id}/delete`,{method:"post",query:n}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const i=this.userContentUrl+"/deleteItems",n=[],s=t.map((t=>t.id));if(s.length){const r={method:"post",query:{items:s.join(","),permanentDelete:e}},o=await this.portal.request(i,r);for(const e of o.results){const i=t.find((t=>e.itemId===t.id)),s=e.success;let r=null;s?(i.id=null,i.portal=null):e.error&&(r=new Ve("portal:delete-item-failed",e.error.message,e.error)),n.push({item:i,success:s,error:r})}}return n}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then((t=>{let e;return e=t&&t.folders?t.folders.map((t=>{const e=eT.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchGroups(){return this.portal.request(this.url??"").then((t=>{let e;return e=t&&t.groups?t.groups.map((t=>{const e=KM.fromJSON(t);return e.portal=this.portal,e})):[],e}))}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:i}=await Promise.resolve().then((function(){return PT})),n={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},s=await this.portal.request(e,{query:n});let r;return s?.items?(r=s.items.map((t=>{const e=i.fromJSON(t);return e.portal=this.portal,e})),await Promise.all(r.map((t=>t.load()))),{items:r,nextStart:s.nextStart,total:s.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then((t=>t.tags))}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new KM({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Ve("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const i=this.userContentUrl,n=e?{folderID:"string"==typeof e?e:e.id}:null;await this.portal.request(i+`/items/${t.id}/restore`,{method:"post",query:n})}toJSON(){throw new Ve("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new iT({sourceJSON:t});return e.read(t),e}};r([Je()],nT.prototype,"access",void 0),r([Je({type:Date})],nT.prototype,"created",void 0),r([Je()],nT.prototype,"culture",void 0),r([Je()],nT.prototype,"description",void 0),r([Je()],nT.prototype,"email",void 0),r([Je()],nT.prototype,"favGroupId",void 0),r([Je()],nT.prototype,"fullName",void 0),r([Je({type:Date})],nT.prototype,"modified",void 0),r([Je()],nT.prototype,"orgId",void 0),r([Je()],nT.prototype,"portal",void 0),r([Je()],nT.prototype,"preferredView",void 0),r([Je()],nT.prototype,"privileges",void 0),r([Je()],nT.prototype,"region",void 0),r([Je()],nT.prototype,"role",void 0),r([Je()],nT.prototype,"roleId",void 0),r([Je()],nT.prototype,"sourceJSON",void 0),r([Je()],nT.prototype,"thumbnail",void 0),r([Je({readOnly:!0})],nT.prototype,"thumbnailUrl",null),r([Je()],nT.prototype,"units",void 0),r([Je({readOnly:!0})],nT.prototype,"userContentUrl",null),r([Je({readOnly:!0})],nT.prototype,"url",null),r([Je()],nT.prototype,"username",void 0),r([Je()],nT.prototype,"userLicenseTypeId",void 0),r([Je()],nT.prototype,"userType",void 0),nT=iT=r([ln("esri.portal.PortalUser")],nT);const sT=nT;var rT;let oT;const aT={PortalGroup:()=>Promise.resolve({default:KM}),PortalItem:()=>Promise.resolve().then((function(){return PT})),PortalUser:()=>Promise.resolve({default:sT})};let lT=rT=class extends(Mo($M)){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=St.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return"string"==typeof t?{url:t}:t}destroy(){cT.unregister(this),this.defaultBasemap=An(this.defaultBasemap),this.defaultDevBasemap=An(this.defaultDevBasemap),this.defaultVectorBasemap=An(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=kn(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)St.request.trustedServers.includes(e)||St.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){const t=this.user?.orgId,e=!t||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get hasAPIKey(){return Il(this.url)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.slice(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t?t.toLowerCase():t}readUser(t){let e=null;return t&&(e=sT.fromJSON(t),e.portal=this),e}load(t){const e=Promise.resolve().then((function(){return SA})).then((({default:e})=>{_s(t),oT=e})).then((()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t))).then((t=>{if(!this.hasAPIKey&&Sl){const t=Sl;this.credential=t.findCredential(this.restUrl),this.credential||this.authMode!==rT.AUTH_MODE_AUTO&&this.authMode!==rT.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=t.on("credential-create",hT(new WeakRef(this))),cT.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(e),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await import("./p-93f8d3a8.js")).default;return t?t.map((t=>new e({id:t.id,url:t.url}))):[]}async fetchBasemaps(t,e){const i=await this._fetchBasemaps(t,e);if(!0===e?.include3d&&!1!==this.use3dBasemaps){const n=await this._fetchBasemaps3D(t,e);i.unshift(...n)}return i}async fetchDefault3DBasemap(t){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||"none"===this.default3DBasemapQuery)return null;const e=new ZM;e.query=this.default3DBasemapQuery,e.disableExtraQuery=!0;const i=(await this.queryItems(e,t)).results.find((t=>"Web Scene"===t.type));return i?new oT({portalItem:i}):null}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then((t=>t.categorySchema)):Ms(t)?Promise.reject(Ss()):Promise.resolve([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new ZM({num:100,sortField:"title"});if(e?.length){const n=[];for(const t of e)n.push(`(title:"${t.title}" AND owner:${t.owner})`);return i.query=n.join(" OR "),this.queryGroups(i,t).then((t=>t.results))}return Ms(t)?Promise.reject(Ss()):Promise.resolve([])}fetchRegions(t){const e=this.user?.culture||this.culture||Jy();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}fetchSettings(t){const e=this.user?.culture||this.culture||Jy();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:e}})}static getDefault(){return VM((()=>new rT))}queryGroups(t,e){return this.queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this.queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",e)}fetchSelf(t=this.authMode,e=!1,i){const n=this.restUrl+"/portals/self",s={authMode:t,query:{culture:Jy().toLowerCase()},withCredentials:!0,...i};return"auto"===s.authMode&&(s.authMode="no-prompt"),e&&(s.query.default=!0),this.request(n,s)}queryPortal(t,e,i,n){const s=ee(ZM,e),r=e=>this.request(this.restUrl+t,{...s.toRequestOptions(this),...n}).then((t=>{const i=s.clone();return i.start=t.nextStart,new XM({nextQueryParams:i,queryParams:s,total:t.total,results:rT._resultsToTypedArray(e,{portal:this},t,n)})})).then((t=>Promise.all(t.results.map((e=>"function"==typeof e.when?e.when():t))).then((()=>t),(e=>(Ts(e),t)))));return i&&aT[i]?aT[i]().then((({default:t})=>(_s(n),r(t)))):r()}signIn(){if(this.hasAPIKey)return this.load().then((()=>{if(!this.user)throw new Ve("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")}));if(this.authMode===rT.AUTH_MODE_ANONYMOUS||this.authMode===rT.AUTH_MODE_NO_PROMPT&&!Sl)return Promise.reject(new Ve("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const t=t=>Promise.resolve().then((()=>"not-loaded"===this.loadStatus?(t||(this.authMode="immediate"),this.load().then((()=>null))):"loading"===this.loadStatus?this.load().then((()=>this.credential?null:(this.credential=t,this.fetchSelf("immediate")))):this.user&&this.credential===t?null:(this.credential=t,this.fetchSelf("immediate")))).then((t=>{t&&(this.sourceJSON=t,this.read(t))}));return Sl?Sl.getCredential(this.restUrl,{prompt:this.authMode!==rT.AUTH_MODE_NO_PROMPT}).then((e=>t(e))):t(this.credential)}normalizeUrl(t){const e=this.credential?.token;return this._normalizeSSL(e?t+(t.includes("?")?"&":"?")+"token="+e:t)}requestToTypedArray(t,e,i){return this.request(t,e).then((t=>{const e=rT._resultsToTypedArray(i,{portal:this},t);return Promise.all(e.map((e=>"function"==typeof e.when?e.when():t))).then((()=>e),(()=>e))}))}request(t,e={}){const i={f:"json",...e.query},{authMode:n=(this.authMode===rT.AUTH_MODE_ANONYMOUS||this.authMode===rT.AUTH_MODE_NO_PROMPT?this.authMode:"auto"),body:s=null,cacheBust:r=!1,method:o="auto",responseType:a="json",signal:l}=e,u={authMode:n,body:s,cacheBust:r,method:o,query:i,responseType:a,timeout:0,signal:l};return e.withCredentials&&(u.withCredentials=!0),Pl(this._normalizeSSL(t),u).then((t=>t.data))}toJSON(){throw new Ve("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new rT({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new Ve("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}async _fetchBasemaps(t,e){const i=new ZM;i.query=t||(this.hasAPIKey?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const n=await this.queryGroups(i,e);if(!n.total)return[];const s=n.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=s.sortField||"name",i.sortOrder=s.sortOrder||"desc";const r=await s.queryItems(i,e);if(!r.total)return[];return r.results.filter((t=>"Web Map"===t.type)).map((t=>new oT({portalItem:t})))}async _fetchBasemaps3D(t,e){const i=t||this.basemapGalleryGroupQuery3D;if(!i)return[];const n=new ZM({query:i,disableExtraQuery:!0}),s=await this.queryGroups(n,e);if(!s.total)return[];const r=s.results[0];n.num=100,n.query='type:"Web Scene"',n.sortField=r.sortField||"name",n.sortOrder=r.sortOrder||"desc";const o=await r.queryItems(n,e);if(!o.total)return[];return o.results.filter((t=>"Web Scene"===t.type)).map((t=>new oT({portalItem:t})))}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const e=oT.fromJSON(t);return e.portalItem={portal:this},e}return null}static _resultsToTypedArray(t,e,i,n){let s;if(i){const r=null!=n?n.signal:null;s=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(s=s.map((i=>{const n=Object.assign(t?t.fromJSON(i):i,e);return"function"==typeof n.load&&n.load(r),n})))}else s=[];return s}};lT.AUTH_MODE_ANONYMOUS="anonymous",lT.AUTH_MODE_AUTO="auto",lT.AUTH_MODE_IMMEDIATE="immediate",lT.AUTH_MODE_NO_PROMPT="no-prompt",r([Je()],lT.prototype,"access",void 0),r([Je()],lT.prototype,"allSSL",void 0),r([Je()],lT.prototype,"authMode",void 0),r([Je()],lT.prototype,"authorizedCrossOriginDomains",void 0),r([ko("authorizedCrossOriginDomains")],lT.prototype,"readAuthorizedCrossOriginDomains",null),r([Je()],lT.prototype,"basemapGalleryGroupQuery",void 0),r([Je({json:{name:"3DBasemapGalleryGroupQuery"}})],lT.prototype,"basemapGalleryGroupQuery3D",void 0),r([Je()],lT.prototype,"bingKey",void 0),r([Je()],lT.prototype,"canListApps",void 0),r([Je()],lT.prototype,"canListData",void 0),r([Je()],lT.prototype,"canListPreProvisionedItems",void 0),r([Je()],lT.prototype,"canProvisionDirectPurchase",void 0),r([Je()],lT.prototype,"canSearchPublic",void 0),r([Je()],lT.prototype,"canShareBingPublic",void 0),r([Je()],lT.prototype,"canSharePublic",void 0),r([Je()],lT.prototype,"canSignInArcGIS",void 0),r([Je()],lT.prototype,"canSignInIDP",void 0),r([Je()],lT.prototype,"colorSetsGroupQuery",void 0),r([Je()],lT.prototype,"commentsEnabled",void 0),r([Je({type:Date})],lT.prototype,"created",void 0),r([Je()],lT.prototype,"credential",void 0),r([Je()],lT.prototype,"culture",void 0),r([Je()],lT.prototype,"currentVersion",void 0),r([Je()],lT.prototype,"customBaseUrl",void 0),r([Je()],lT.prototype,"default3DBasemapQuery",void 0),r([Je()],lT.prototype,"defaultBasemap",void 0),r([ko("defaultBasemap")],lT.prototype,"readDefaultBasemap",null),r([Je()],lT.prototype,"defaultDevBasemap",void 0),r([ko("defaultDevBasemap")],lT.prototype,"readDefaultDevBasemap",null),r([Je({type:Od})],lT.prototype,"defaultExtent",void 0),r([Je()],lT.prototype,"defaultVectorBasemap",void 0),r([ko("defaultVectorBasemap")],lT.prototype,"readDefaultVectorBasemap",null),r([Je()],lT.prototype,"description",void 0),r([Je()],lT.prototype,"devBasemapGalleryGroupQuery",void 0),r([Je()],lT.prototype,"eueiEnabled",void 0),r([Je({readOnly:!0})],lT.prototype,"extraQuery",null),r([Je()],lT.prototype,"featuredGroups",void 0),r([Je()],lT.prototype,"featuredItemsGroupQuery",void 0),r([Je()],lT.prototype,"galleryTemplatesGroupQuery",void 0),r([Je()],lT.prototype,"layoutGroupQuery",void 0),r([Je()],lT.prototype,"livingAtlasGroupQuery",void 0),r([Je({readOnly:!0})],lT.prototype,"hasAPIKey",null),r([Je()],lT.prototype,"hasCategorySchema",void 0),r([Je()],lT.prototype,"hasClassificationSchema",void 0),r([Je()],lT.prototype,"helpBase",void 0),r([Je()],lT.prototype,"helperServices",void 0),r([Je()],lT.prototype,"helpMap",void 0),r([Je()],lT.prototype,"homePageFeaturedContent",void 0),r([Je()],lT.prototype,"homePageFeaturedContentCount",void 0),r([Je()],lT.prototype,"httpPort",void 0),r([Je()],lT.prototype,"httpsPort",void 0),r([Je()],lT.prototype,"id",void 0),r([Je()],lT.prototype,"ipCntryCode",void 0),r([Je({readOnly:!0})],lT.prototype,"isOrganization",null),r([Je()],lT.prototype,"isPortal",void 0),r([Je()],lT.prototype,"isReadOnly",void 0),r([Je({readOnly:!0})],lT.prototype,"itemPageUrl",null),r([Je()],lT.prototype,"layerTemplatesGroupQuery",void 0),r([Je()],lT.prototype,"maxTokenExpirationMinutes",void 0),r([Je({type:Date})],lT.prototype,"modified",void 0),r([Je()],lT.prototype,"name",void 0),r([Je()],lT.prototype,"portalHostname",void 0),r([Je()],lT.prototype,"portalMode",void 0),r([Je()],lT.prototype,"portalProperties",void 0),r([Je()],lT.prototype,"region",void 0),r([Je()],lT.prototype,"recycleBinEnabled",void 0),r([Je({readOnly:!0})],lT.prototype,"restUrl",null),r([Je()],lT.prototype,"rotatorPanels",void 0),r([Je()],lT.prototype,"showHomePageDescription",void 0),r([Je()],lT.prototype,"sourceJSON",void 0),r([Je()],lT.prototype,"staticImagesUrl",void 0),r([Je({json:{name:"2DStylesGroupQuery"}})],lT.prototype,"stylesGroupQuery2d",void 0),r([Je({json:{name:"stylesGroupQuery"}})],lT.prototype,"stylesGroupQuery3d",void 0),r([Je()],lT.prototype,"supportsHostedServices",void 0),r([Je()],lT.prototype,"symbolSetsGroupQuery",void 0),r([Je()],lT.prototype,"templatesGroupQuery",void 0),r([Je()],lT.prototype,"thumbnail",void 0),r([Je({readOnly:!0})],lT.prototype,"thumbnailUrl",null),r([Je()],lT.prototype,"units",void 0),r([Je()],lT.prototype,"url",void 0),r([Je()],lT.prototype,"urlKey",void 0),r([ko("urlKey")],lT.prototype,"readUrlKey",null),r([Je()],lT.prototype,"user",void 0),r([ko("user")],lT.prototype,"readUser",null),r([Je()],lT.prototype,"use3dBasemaps",void 0),r([Je()],lT.prototype,"useDefault3dBasemap",void 0),r([Je()],lT.prototype,"useStandardizedQuery",void 0),r([Je()],lT.prototype,"useVectorBasemaps",void 0),r([Je()],lT.prototype,"vectorBasemapGalleryGroupQuery",void 0),lT=rT=r([ln("esri.portal.Portal")],lT);const uT=lT,cT=new FinalizationRegistry((t=>{t.remove()}));function hT(t){const e=Sl;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch((()=>{}))}}let dT=class extends ao{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t?.portalItem&&t.path?{...t,path:fT(t.path,t.portalItem)}:t}set path(t){null!=t&&Oa(t)?jt.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return fT(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",e){const i=this.cdnUrl;if(null==i)throw new Ve("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(i,{responseType:t,query:{token:this.portalItem.apiKey,_ts:e?.cacheBust?Date.now():null},signal:e?.signal})}async update(t,e){const{addOrUpdateResources:i}=await import("./p-11802a1b.js");return await i(this.portalItem,[{resource:this,content:t,compress:e?.compress,access:e?.access}],"update",e),this}hasPath(){return null!=this.path}};function fT(t,e){return null==t?t:(t=t.replace(/^\/+/,""),null!=e&&Oa(t)&&(t=ka(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}r([Je()],dT.prototype,"portalItem",void 0),r([Je({type:String,value:null})],dT.prototype,"path",null),r([Ah("path")],dT.prototype,"_castPath",null),r([Je({type:String,readOnly:!0})],dT.prototype,"url",null),r([Je({type:String,readOnly:!0})],dT.prototype,"cdnUrl",null),r([Je({type:String,readOnly:!0})],dT.prototype,"itemRelativeUrl",null),dT=r([ln("esri.portal.PortalItemResource")],dT);const pT=dT;let mT=class extends ao{constructor(t){super(t),this.created=null,this.rating=null}};r([Je()],mT.prototype,"created",void 0),r([Je()],mT.prototype,"rating",void 0),mT=r([ln("esri.portal.PortalRating")],mT);const yT=mT;function gT(t,e){const i=e?.url?.path;if(t&&i&&(t=Ia(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=ka(t,e.portalItem.itemUrl);null!=i&&_T.test(i)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return(t=AT(t,e?.portal))&&ST.test(t)?IT(t):t}function vT(t,e,i=CT.YES){if(null==(t=t&&ST.test(t)?kT(t):t))return t;!Oa(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let n=Ia(t);if(e){const i=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(i){const s=AT(i,e.portal),r=AT(n,e.portal);n=ka(r,s,s);null!=n&&n!==r&&n!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(n)}}return n=TT(n,e?.portal),Oa(n)&&(n=Ca(n)),e?.resources&&e?.portalItem&&!Oa(n)&&!La(n)&&i===CT.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(n),compress:!1}),n}function wT(t,e,i){return gT(t,i)}function bT(t,e,i,n){const s=vT(t,n);void 0!==s&&(e[i]=s)}const ST=/\/items\/([^/]+)\/resources\/(.*)/,_T=/^\.\/resources\//;function xT(t){const e=t?.match(ST)??null;return e?.[1]??null}function MT(t){const e=t?.match(ST)??null;if(null==e)return null;const i=e[2],n=i.lastIndexOf("/");if(-1===n){const{path:t,extension:e}=pl(i);return{prefix:null,filename:t,extension:e}}const{path:s,extension:r}=pl(i.slice(n+1));return{prefix:i.slice(0,n),filename:s,extension:r}}function TT(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?al(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function AT(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,n=aa();return Ma(n,`${n.scheme}://${i}`)?al(t,e.portalHostname,i):al(t,i,e.portalHostname)}function IT(t){if(!t)return t||null;let e=t;return e&&Sl&&!Sl.findCredential(e)&&(e=Uo(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function kT(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Sl&&!Sl.findCredential(e)&&(e=Uo(e)),e}var CT;!function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"}(CT||(CT={}));const ET=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return CT},ensureMainOnlineDomain:TT,fromCDNUrl:kT,fromJSON:gT,itemIdFromResourceUrl:xT,prefixAndFilenameFromResourceUrl:MT,read:wT,toCDNUrl:IT,toJSON:vT,write:bT},Symbol.toStringTag,{value:"Module"}));var jT;const OT=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Map Service","Media Layer","Scene Service","Stream Service","Vector Tile Service","WFS","WMS","WMTS"]),RT=new Set(["KML","GeoJson","CSV"]);let LT=jT=class extends(Mo($M)){static from(t){return Kt(jT,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return"Feature Service"===t||"Feature Collection"===t?i=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":"Image Service"===t?i=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===t?i="Scene Layer":"Video Service"===t?i="Video Layer":"Scene Package"===t?i="Scene Layer Package":"Stream Service"===t?i="Feature Layer":"Geoprocessing Service"===t?i=e.includes("Web Tool")?"Tool":"Geoprocessing Service":"Geoenrichment Service"===t?i="GeoEnrichment Service":"Geocoding Service"===t?i="Locator":"Microsoft Powerpoint"===t?i="Microsoft PowerPoint":"GeoJson"===t?i="GeoJSON":"Globe Service"===t?i="Globe Layer":"Vector Tile Service"===t?i="Tile Layer":"netCDF"===t?i="NetCDF":"Map Service"===t?i=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t?.toLowerCase().includes("add in")?i=t.replaceAll(/(add in)/gi,"Add-In"):"datastore catalog service"===t?i="Big Data File Share":"Compact Tile Package"===t?i="Tile Package (tpkx)":"Raster function template"===t?i="Raster Function Template":"OGCFeatureServer"===t?i="OGC Feature Layer":"web mapping application"===t&&e.includes("configurableApp")?i="Instant App":"Insights Page"===t?i="Insights Report":"Excalibur Imagery Project"===t?i="Excalibur Project":"3DTiles Service"===t?i="3D tiles layer":"3DTiles Package"===t&&(i="3D tiles package"),i}readExtent(t){return t&&t.length?new Od(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],i="esri/images/portal/",n="16";let s,r=!1,o=!1,a=!1,l=!1,u=!1,c=!1,h=!1,d=!1;return t.indexOf("service")>0||"feature collection"===t||"kml"===t||"wms"===t||"wmts"===t||"wfs"===t?(r=e.includes("Hosted Service"),"feature service"===t||"feature collection"===t||"kml"===t||"wfs"===t?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),u=e.includes("Spatiotemporal"),c=e.includes("UtilityNetwork"),s=u&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":u?"spatiotemporal":c?"utilitynetwork":r?"featureshosted":"features"):"map service"===t||"wms"===t||"wmts"===t?(u=e.includes("Spatiotemporal"),h=e.includes("Relational"),s=u||h?"mapimages":r||e.includes("Tiled")||"wmts"===t?"maptiles":"mapimages"):s="scene service"===t?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===t?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===t?"streamlayer":"vector tile service"===t?"vectortile":"datastore catalog service"===t?"datastorecollection":"geocoding service"===t?"geocodeservice":"video service"===t?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":"geoprocessing service"===t?e.includes("Web Tool")?"tool":"layers":"geodata service"===t?"geodataservice":"3dtiles service"===t?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):"web map"===t||"cityengine web scene"===t?s="maps":"web scene"===t?s=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===t&&e.includes("configurableApp")?s="instantapps":"web mapping application"===t||"mobile application"===t||"application"===t||"operation view"===t||"desktop application"===t?s="apps":"map document"===t||"map package"===t||"published map"===t||"scene document"===t||"globe document"===t||"basemap package"===t||"mobile basemap package"===t||"mobile map package"===t||"project package"===t||"project template"===t||"pro map"===t||"layout"===t||"layer"===t&&e.includes("ArcGIS Pro")||"explorer map"===t&&e.indexOf("Explorer Document")?s="mapsgray":"service definition"===t||"shapefile"===t||"cad drawing"===t||"geojson"===t||"netcdf"===t||"administrative report"===t?s="datafiles":"360 vr experience"===t?s="360vr":"explorer add in"===t||"desktop add in"===t||"windows viewer add in"===t||"windows viewer configuration"===t?s="appsgray":"arcgis pro add in"===t||"arcgis pro configuration"===t?s="addindesktop":"pdf"===t?s="pdf":"microsoft word"===t?s="word":"microsoft excel"===t?s="excel":"microsoft powerpoint"===t?s="ppt":"rule package"===t||"file geodatabase"===t||"sqlite geodatabase"===t||"csv collection"===t||"kml collection"===t||"windows mobile package"===t||"map template"===t||"desktop application template"===t||"gml"===t||"arcpad package"===t||"code sample"===t||"document link"===t||"earth configuration"===t||"operations dashboard add in"===t||"rules package"===t||"workflow manager package"===t||"explorer map"===t&&e.includes("Explorer Mapping Application")||e.includes("Document")?s="datafilesgray":"network analysis service"===t||"geoprocessing service"===t||"geodata service"===t||"geometry service"===t||"geoprocessing package"===t||"locator package"===t||"geoprocessing sample"===t||"workflow manager service"===t?s="toolsgray":"layer"===t||"layer package"===t||"explorer layer"===t?s="layersgray":"analysis model"===t?s="analysismodel":"scene package"===t?s="scenepackage":"3dtiles package"===t?s="3dtileslayerpackage":"3dtiles service"===t?s="3dtileslayer":"mobile scene package"===t?s="mobilescenepackage":"tile package"===t||"compact tile package"===t?s="tilepackage":"task file"===t?s="taskfile":"report template"===t?s="report-template":"statistical data collection"===t?s="statisticaldatacollection":"insights workbook"===t?s="workbook":"insights model"===t?s="insightsmodel":"insights page"===t?s="insightspage":"insights theme"===t?s="insightstheme":"hub initiative"===t?s="hubinitiative":"hub page"===t?s="hubpage":"hub site application"===t?s="hubsite":"hub event"===t?s="hubevent":"hub project"===t?s="hubproject":"relational database connection"===t?s="relationaldatabaseconnection":"big data file share"===t?s="datastorecollection":"image collection"===t?s="imagecollection":"desktop style"===t?s="desktopstyle":"style"===t?s=e.includes("Dictionary")?"dictionarystyle":"style":"dashboard"===t?s="dashboard":"raster function template"===t?s="rasterprocessingtemplate":"vector tile package"===t?s="vectortilepackage":"ortho mapping project"===t?s="orthomappingproject":"ortho mapping template"===t?s="orthomappingtemplate":"solution"===t?s="solutions":"geopackage"===t?s="geopackage":"deep learning package"===t?s="deeplearningpackage":"real time analytic"===t?s="realtimeanalytics":"reality mapping project"===t?s="realitymappingproject":"big data analytic"===t?s="bigdataanalytics":"feed"===t?s="feed":"excalibur imagery project"===t?s="excaliburimageryproject":"notebook"===t?s="notebook":"storymap"===t?s="storymap":"survey123 add in"===t?s="survey123addin":"mission"===t?s="mission":"mission report"===t?s="missionreport":"mission template"===t?s="missiontemplate":"quickcapture project"===t?s="quickcaptureproject":"pro report"===t?s="proreport":"pro report template"===t?s="proreporttemplate":"urban model"===t?s="urbanmodel":"urban project"===t?s="urbanproject":"web experience"===t?s="experiencebuilder":"web experience template"===t?s="webexperiencetemplate":"experience builder widget"===t?s="experiencebuilderwidget":"experience builder widget package"===t?s="experiencebuilderwidgetpackage":"workflow"===t?s="workflow":"kernel gateway connection"===t?s="kernelgatewayconnection":"insights script"===t?s="insightsscript":"hub initiative template"===t?s="hubinitiativetemplate":"storymap theme"===t?s="storymaptheme":"knowledge graph"===t?s="knowledgegraph":"knowledge graph layer"===t?s="knowledgegraphlayer":"knowledge studio project"===t?s="knowledgestudio":"native application"===t?s="nativeapp":"native application installer"===t?s="nativeappinstaller":"web link chart"===t?s="linkchart":"knowledge graph web investigation"===t?s="investigation":"ogcfeatureserver"===t?s="features":"pro presentation"===t?s="propresentation":"pro project"===t?s="proproject":"insights workbook package"===t?s="insightsworkbookpackage":"apache parquet"===t?s="apacheparquet":"notebook code snippet library"===t?s="notebookcodesnippets":"suitability model"===t?s="suitabilitymodel":"esri classifier definition"===t?s="classifierdefinition":"esri classification schema"===t?s="classificationschema":"insights data engineering workbook"===t?s="dataengineeringworkbook":"insights data engineering model"===t?s="dataengineeringmodel":"deep learning studio project"===t?s="deeplearningproject":"discussion"===t?s="discussion":"allsource project"===t?s="allsourceproject":"api key"===t?s="apikey":"data pipeline"===t?s="datapipelines":"group layer"===t?(d=e.includes("Map"),s=d?"layergroup2d":"layergroup"):s="media layer"===t?"onlinemedialayer":"form"===t?e.includes("Survey123")?"survey":"datafilesgray":"csv"===t?"csv":"image"===t?"image":"maps",s?ru(i+s+n+".png"):null}get isLayer(){return null!=this.type&&OT.has(this.type)}get itemCdnUrl(){return IT(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.username;if(!e)return null;return`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`}load(t){const e=this.portal??(this.portal=uT.getDefault()),i=e.load(t).then((()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:null!=t?t.signal:null,query:{token:this.apiKey}}):{})).then((t=>{this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}};return t instanceof yT&&(t=t.rating),null==t||isNaN(t)||"number"!=typeof t||(e.query.rating=t),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new yT({rating:t,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:nt(this.applicationProxies),avgRating:this.avgRating,categories:nt(this.categories),classification:nt(this.classification),created:nt(this.created),culture:this.culture,description:this.description,extent:nt(this.extent),groupCategories:nt(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:nt(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:nt(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:nt(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:nt(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new jT({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");for(const e of["extent","classification"]){const i=t[e];i&&(t[e]=JSON.stringify(i))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return null!=e.rating?(e.created=new Date(e.created),new yT(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},jT)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then((t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this)))}update(t){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const e=t?.data,i={method:"post"};i.query=this.createPostQuery();for(const t in i.query)null===i.query[t]&&(i.query[t]="");return i.query.clearEmptyFields=!0,null!=e&&("string"==typeof e?i.query.text=e:"object"==typeof e&&(i.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,i).then((()=>this.reload()))})):Promise.reject(new Ve("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new Ve("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:i}=this;await e.signIn();const{copyResources:n,folder:s,tags:r,title:o}=t||{},a={method:"post",query:{copyPrivateResources:"all"===n,folder:"string"==typeof s?s:s?.id,includeResources:!!n,tags:r?.join(","),title:o}},{itemId:l}=await e.request(`${i}/copy`,a);return new jT({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const e=t.thumbnail,i=t.filename,n={method:"post"};if("string"==typeof e)La(e)?n.query={data:e}:n.query={url:Ia(e)},null!=i&&(n.query.filename=i);else{const t=new FormData;null!=i?t.append("file",e,i):t.append("file",e),n.body=t}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,n).then((()=>this.reload()))})):Promise.reject(new Ve("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:i}=await import("./p-11802a1b.js");return i(this,t,e)}async addResource(t,e,i){const{addOrUpdateResources:n}=await import("./p-11802a1b.js");return t.portalItem=this,await n(this,[{resource:t,content:e,compress:i?.compress,access:i?.access}],"add",i),t}async removeResource(t,e){const{removeResource:i}=await import("./p-11802a1b.js");if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new Ve("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await import("./p-11802a1b.js");return e(this,t)}resourceFromPath(t){return new pT({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:nt(this.categories),classification:nt(this.classification),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:nt(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:nt(this.typeKeywords),url:this.url};return it(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new jT({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)"tags"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"typeKeywords"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"extent"===e&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};r([Je({type:["private","shared","org","public"]})],LT.prototype,"access",void 0),r([Je()],LT.prototype,"accessInformation",void 0),r([Je({type:String})],LT.prototype,"apiKey",void 0),r([Je({json:{read:{source:"appProxies"}}})],LT.prototype,"applicationProxies",void 0),r([Je()],LT.prototype,"avgRating",void 0),r([Je()],LT.prototype,"categories",void 0),r([Je()],LT.prototype,"classification",void 0),r([Je({type:Date})],LT.prototype,"created",void 0),r([Je()],LT.prototype,"culture",void 0),r([Je()],LT.prototype,"description",void 0),r([Je({readOnly:!0})],LT.prototype,"displayName",null),r([Je({type:Od})],LT.prototype,"extent",void 0),r([ko("extent")],LT.prototype,"readExtent",null),r([Je()],LT.prototype,"groupCategories",void 0),r([Je({readOnly:!0})],LT.prototype,"iconUrl",null),r([Je()],LT.prototype,"id",void 0),r([Je({readOnly:!0})],LT.prototype,"isLayer",null),r([Je({type:Boolean,readOnly:!0})],LT.prototype,"isOrgItem",void 0),r([Je()],LT.prototype,"itemControl",void 0),r([Je({readOnly:!0})],LT.prototype,"itemPageUrl",null),r([Je({readOnly:!0})],LT.prototype,"itemUrl",null),r([Je()],LT.prototype,"licenseInfo",void 0),r([Je({type:Date})],LT.prototype,"modified",void 0),r([Je()],LT.prototype,"name",void 0),r([Je()],LT.prototype,"numComments",void 0),r([Je()],LT.prototype,"numRatings",void 0),r([Je()],LT.prototype,"numViews",void 0),r([Je()],LT.prototype,"owner",void 0),r([Je()],LT.prototype,"ownerFolder",void 0),r([Je({type:uT})],LT.prototype,"portal",void 0),r([Je()],LT.prototype,"screenshots",void 0),r([Je()],LT.prototype,"size",void 0),r([Je()],LT.prototype,"snippet",void 0),r([Je()],LT.prototype,"sourceJSON",void 0),r([Je({type:String})],LT.prototype,"sourceUrl",void 0),r([Je({type:String})],LT.prototype,"spatialReference",void 0),r([Je()],LT.prototype,"tags",void 0),r([Je()],LT.prototype,"thumbnail",void 0),r([Je({readOnly:!0})],LT.prototype,"thumbnailUrl",null),r([Je()],LT.prototype,"title",void 0),r([Je()],LT.prototype,"type",void 0),r([Je()],LT.prototype,"typeKeywords",void 0),r([Je({type:String,json:{read(t,e){if(RT.has(e.type)){const e=this.portal?.restUrl;t||=e&&this.id?`${e}/content/items/${this.id}/data`:null}return t}}})],LT.prototype,"url",void 0),r([Je({readOnly:!0})],LT.prototype,"userItemUrl",null),LT=jT=r([ln("esri.portal.PortalItem")],LT);const NT=LT;const PT=Object.freeze({__proto__:null,default:NT});async function FT(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,i=await hv("esri/t9n/basemaps");return i[t]||i[e]}const DT={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return ru("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return ru("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return ru("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return ru("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return ru("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return ru("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return ru("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return ru("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return ru("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return ru("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return ru("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return ru("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return ru("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return ru("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return ru("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return ru("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};const $T=new Set(["ar","bs","ca","hr","cs","da","nl","en","et","fi","fr","de","el","he","hu","id","it","ja","ko","lv","lt","nb","pl","ro","ru","sr","es","sv","th","tr","uk","vi"]);let zT=class extends ao{constructor(t){super(t),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps",this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;const t=Jy().toLowerCase();switch(t){case"pt-br":return"pt-BR";case"pt-pt":return"pt-PT";case"zh-cn":return"zh-CN";case"zh-hk":return"zh-HK";case"zh-tw":return"zh-TW"}const e=Yy(t);return"pt"===e?"pt-BR":e&&$T.has(e)?e:"global"}};r([Je()],zT.prototype,"apiKey",void 0),r([Je()],zT.prototype,"id",void 0),r([Je()],zT.prototype,"language",void 0),r([Je()],zT.prototype,"places",void 0),r([Je()],zT.prototype,"serviceUrl",void 0),r([Je()],zT.prototype,"worldview",void 0),zT=r([ln("esri.support.BasemapStyle")],zT);const UT=zT;function BT(t){return ZT(t)||qT(t)}function GT(t){return null!=t&&"object"==typeof t&&"type"in t&&"feature"===t.type}function VT(t){return null!=t&&"object"==typeof t&&"type"in t&&"knowledge-graph"===t.type&&"layers"in t}function qT(t){return"scene"===t?.type}function HT(t){return null!=t&&"object"==typeof t&&"type"in t&&"subtype-group"===t.type&&"sublayers"in t}function WT(t){return"subtype-sublayer"===t?.type}function ZT(t){const e=t?.type;return"imagery-tile"===e||"tile"===e||"open-street-map"===e||"vector-tile"===e||"web-tile"===e||"wmts"===e}function JT(t){const e=t?.type;return"base-tile"===e||"tile"===e||"elevation"===e||"imagery-tile"===e||"base-elevation"===e||"open-street-map"===e||"wcs"===e||"web-tile"===e||"wmts"===e||"vector-tile"===e}const YT={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function KT(t){const e=t?.type;return"building-scene"===e||"integrated-mesh"===e||"point-cloud"===e||"scene"===e}function QT(t){return"feature"===t?.type&&!t.url&&"memory"===t.source?.type}function XT(t){const e=t?.type;return("feature"===e||"subtype-group"===e||"oriented-imagery"===e)&&"feature-layer"===t.source?.type}function tA(t){if(t.activeLayer){const e=t.activeLayer.tileMatrixSet;if(e)return e;const i=t.activeLayer.tileMatrixSets;if(i)return i}return null}async function eA(t,e){const i=Sl?.findServerInfo(t);if(null!=i?.currentVersion)return i.owningSystemUrl||null;const n=t.toLowerCase().indexOf("/rest/services");if(-1===n)return null;const s=`${t.slice(0,n)}/rest/info`,r=null!=e?e.signal:null,{data:o}=await Pl(s,{query:{f:"json"},responseType:"json",signal:r});return o?.owningSystemUrl||null}function iA(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function nA(t){return iA(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function sA(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function rA(t){return!!sA(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function oA(t){if(!t)return[];return("subtypes"in t?t.subtypes:HT(t.parent)?t.parent.subtypes:[])??[]}const aA=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),lA=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function uA(t){return"basemap"===t.layerContainerType?aA:"operational-layers"===t.layerContainerType?lA:null}function cA(t,e){if(e.restrictedWebMapWriting){const i=uA(e);return null==i||i.has(t.type)&&!QT(t)}return!0}function hA(t,e){if(e)if(QT(t)){const i=yt("featureCollection.layers",e),n=i?.[0]?.layerDefinition;n&&dA(t,n)}else"group"!==t.type&&dA(t,e)}function dA(t,e){"maxScale"in t&&(e.maxScale=qi(t.maxScale)??void 0),"minScale"in t&&(e.minScale=qi(t.minScale)??void 0)}function fA(t,e){if(hA(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,"normal"===e.blendMode&&delete e.blendMode),e.opacity=qi(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&"wmts"!==t.type))if(QT(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function pA(t,e,i){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return i?.messages&&i.messages.push(new Ve("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(QT(t)&&!t.isTable)e=t.resourceInfo;else if(cA(t,i)){const e={};return t.write(e,i)?e:null}return null!=e&&fA(t,e=nt(e)),e}var mA;let yA=0,gA=mA=class extends(Mo($M)){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+yA++,this.baseLayers=new Vm,this.referenceLayers=new Vm;const e=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,"elevation"===t.type&&jt.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=t=>{t.parent=null};this.addHandles([this.baseLayers.on("after-add",(t=>e(t.item))),this.referenceLayers.on("after-add",(t=>e(t.item))),this.baseLayers.on("after-remove",(t=>i(t.item))),this.referenceLayers.on("after-remove",(t=>i(t.item)))])}initialize(){this.when().catch((t=>{jt.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.baseLayers.toArray();for(const e of t)e.destroy();const e=this.referenceLayers.toArray();for(const t of e)t.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=An(this.portalItem)}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",AM(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const n=[];t?(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach((t=>{const e=pA(t,i.webmap?i.webmap.getLayerJSONFromResourceInfo(t):null,i);null!=e&&n.push(e)})),this.referenceLayers.forEach((t=>{const e=pA(t,i.webmap?i.webmap.getLayerJSONFromResourceInfo(t):null,i);null!=e&&("scene"!==t.type&&(e.isReference=!0),n.push(e))})),e.baseMapLayers=n):e.baseMapLayers=n}set referenceLayers(t){this._set("referenceLayers",AM(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return zM(this,(t=>{t(this.baseLayers,this.referenceLayers)}))}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map((t=>rt(t)?t.clone():t)),referenceLayers:this.referenceLayers.map((t=>rt(t)?t.clone():t))};return this.loaded&&(t.loadStatus="loaded"),new mA({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){return t=t||{},e?.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((t=>{const e=nt(t);return e.url&&Va(e.url)&&(e.url=`https:${e.url}`),e.templateUrl&&Va(e.templateUrl)&&(e.templateUrl=`https:${e.templateUrl}`),e}))),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i,style:n}=this;_s(t);const s=[];if(e){const i=e.context?e.context.url:null;if(s.push(this._loadLayersFromJSON(e.data,i,t)),e.data.id&&!e.data.title){const t=e.data.id;s.push(FT(t).then((t=>{t&&this.read({title:t},e.context)})))}}else i?s.push(this._loadFromItem(i,t)):n&&s.push(this._loadFromStylesService(n,t));await Promise.all(s)}async _loadLayersFromJSON(t,e,i){const n=this.resourceInfo?.context,s=this.portalItem?.portal||n?.portal||null,r=wA[n?.origin||""]??"web-map",{populateOperationalLayers:o}=await import("./p-517201ef.js"),a=[];if(_s(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const i={context:{...n,origin:r,url:e,portal:s,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},l=t=>"web-scene"===r&&"ArcGISSceneServiceLayer"===t.layerType||t.isReference,u=o(this.baseLayers,t.baseMapLayers.filter((t=>!l(t))),i);a.push(u);const c=o(this.referenceLayers,t.baseMapLayers.filter(l),i);a.push(c)}await Promise.allSettled(a)}async _loadFromItem(t,e){const i=await t.load(e),n=await i.fetchData("json",e),s=ca(t.itemUrl??"");return this._set("resourceInfo",{data:n.baseMap??{},context:{origin:vA[t.type||""]??"web-map",portal:t.portal||uT.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||uT.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,e)}async _loadFromStylesService(t,e){const i=`${t.serviceUrl}/${t.id}`,n=(await Pl(i,{query:{language:t.getLanguageParamValue(),places:t.places,worldview:t.worldview,token:t.apiKey},signal:e?.signal})).data,s=ca(i);if(this._set("resourceInfo",{data:n.baseMap??{},context:{origin:"web-map",url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,s,e),t.apiKey)for(const e of[...this.baseLayers,...this.referenceLayers])"apiKey"in e&&(e.apiKey=t.apiKey)}static fromId(t){const e=DT[t];return e?e.itemId?new mA({portalItem:{id:e.itemId,portal:{url:"https://www.arcgis.com"}}}):mA.fromJSON(e,{origin:e.is3d?"web-scene":"web-map"}):null}};r([Je({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,n){this._writeBaseLayers(t,e,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Vm}},writer(t,e,i,n){this._writeBaseLayers(t,e,n)}}}}}})],gA.prototype,"baseLayers",null),r([Je({type:String,json:{origins:{"web-scene":{write:!0}}}})],gA.prototype,"id",void 0),r([Je({type:NT})],gA.prototype,"portalItem",void 0),r([Je()],gA.prototype,"referenceLayers",null),r([Je({readOnly:!0})],gA.prototype,"resourceInfo",void 0),r([Je({type:wh})],gA.prototype,"spatialReference",void 0),r([Je({type:UT})],gA.prototype,"style",void 0),r([Je()],gA.prototype,"thumbnailUrl",void 0),r([Je({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],gA.prototype,"title",void 0),r([yh("title")],gA.prototype,"writeTitle",null),gA=mA=r([ln("esri.Basemap")],gA);const vA={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},wA={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},bA=gA;const SA=Object.freeze({__proto__:null,default:bA});const _A={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function xA(t){return!!_A[t]||!!_A[t.toLowerCase()]}function MA(t){return _A[t]??_A[t.toLowerCase()]}function TA(t){return[...MA(t)]}function AA(t,e,i){i<0&&++i,i>1&&--i;const n=6*i;return n<1?t+(e-t)*n:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function IA(t,e,i,n=1){const s=(t%360+360)%360/360,r=i<=.5?i*(e+1):i+e-i*e,o=2*i-r;return[Math.round(255*AA(o,r,s+1/3)),Math.round(255*AA(o,r,s)),Math.round(255*AA(o,r,s-1/3)),n]}function kA(t){const e=t.length>5,i=e?8:4,n=(1<<i)-1,s=e?1:17,r=e?9===t.length:5===t.length;let o=Number("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return r&&(l=o&n,o>>=i,a[3]=s*l/255),l=o&n,o>>=i,a[2]=s*l,l=o&n,o>>=i,a[1]=s*l,l=o&n,o>>=i,a[0]=s*l,a}function CA(t){return wf(Bt(t),0,255)}function EA(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}function jA(t,e){const i=t.toString(16).padStart(2,"0");return e?i.slice(0,1):i}class OA{static blendColors(t,e,i,n=new OA){return n.r=Math.round(t.r+(e.r-t.r)*i),n.g=Math.round(t.g+(e.g-t.g)*i),n.b=Math.round(t.b+(e.b-t.b)*i),n.a=t.a+(e.a-t.a)*i,n._sanitize()}static fromRgb(t,e){const i=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(i){const t=i[2].split(/\s*,\s*/),n=i[1];if("rgb"===n&&3===t.length||"rgba"===n&&4===t.length){const i=t[0];if("%"===i.charAt(i.length-1)){const i=t.map((t=>2.56*parseFloat(t)));return 4===t.length&&(i[3]=parseFloat(t[3])),OA.fromArray(i,e)}return OA.fromArray(t.map((t=>parseFloat(t))),e)}if("hsl"===n&&3===t.length||"hsla"===n&&4===t.length)return OA.fromArray(IA(parseFloat(t[0]),parseFloat(t[1])/100,parseFloat(t[2])/100,parseFloat(t[3])),e)}return null}static fromHex(t,e=new OA){if("#"!==t[0]||isNaN(Number(`0x${t.slice(1)}`)))return null;switch(t.length){case 4:case 5:{const i=parseInt(t.slice(1,2),16),n=parseInt(t.slice(2,3),16),s=parseInt(t.slice(3,4),16),r=5===t.length?15:parseInt(t.slice(4),16);return OA.fromArray([i+16*i,n+16*n,s+16*s,(r+16*r)/255],e)}case 7:case 9:{const i=parseInt(t.slice(1,3),16),n=parseInt(t.slice(3,5),16),s=parseInt(t.slice(5,7),16),r=7===t.length?255:parseInt(t.slice(7),16);return OA.fromArray([i,n,s,r/255],e)}default:return null}}static fromArray(t,e=new OA){return e._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(e.a)&&(e.a=1),e._sanitize()}static fromString(t,e){const i=xA(t)?MA(t):null;return i&&OA.fromArray(i,e)||OA.fromRgb(t,e)||OA.fromHex(t,e)}static fromJSON(t){return null!=t?new OA([t[0],t[1],t[2],(t[3]??255)/255]):void 0}static toUnitRGB(t){return null!=t?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return null!=t?[t.r/255,t.g/255,t.b/255,null!=t.a?t.a:1]:null}constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}get isBright(){return.299*this.r+.587*this.g+.114*this.b>=127}setColor(t){return"string"==typeof t?OA.fromString(t,this):Array.isArray(t)?OA.fromArray(t,this):(this._set(t.r??0,t.g??0,t.b??0,t.a??1),t instanceof OA||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(t){const e=t?.capitalize??!1,i=t?.digits??6,n=3===i||4===i,s=4===i||8===i,r=`#${jA(this.r,n)}${jA(this.g,n)}${jA(this.b,n)}${s?jA(Math.round(255*this.a),n):""}`;return e?r.toUpperCase():r}toCss(t=!1){const e=this.r+", "+this.g+", "+this.b;return t?`rgba(${e}, ${this.a})`:`rgb(${e})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=OA.AlphaMode.ALWAYS){const e=CA(this.r),i=CA(this.g),n=CA(this.b);return t===OA.AlphaMode.ALWAYS||1!==this.a?[e,i,n,CA(255*this.a)]:[e,i,n]}clone(){return new OA(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(t){return null!=t&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a}_sanitize(){return this.r=Math.round(EA(this.r,0,255)),this.g=Math.round(EA(this.g,0,255)),this.b=Math.round(EA(this.b,0,255)),this.a=EA(this.a,0,1),this}_set(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n}}OA.prototype.declaredClass="esri.Color",function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(OA||(OA={}));const RA=OA;function LA(t){return()=>t}function NA(t,e={}){const i=t instanceof Co?t:new Co(t,e),{alwaysWriteDefaults:n,default:s,ignoreUnknown:r=!0,name:o,nonNullable:a,readOnly:l=!1}=e;return Je({type:r?i.apiValues:String,json:{type:i.jsonValues,default:s,name:o,read:!l&&{reader:i.read},write:{writer:i.write,alwaysWriteDefaults:n}},nonNullable:a,readOnly:l})}var PA;let FA=PA=class extends Io{constructor(t){super(t),this.type="none"}clone(){return new PA({type:this.type})}};r([NA({none:"none",stayAbove:"stay-above"})],FA.prototype,"type",void 0),FA=PA=r([ln("esri.ground.NavigationConstraint")],FA);function DA(t){const e=Bt(100*(1-t));return Math.max(0,Math.min(e,100))}function $A(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var zA;let UA=zA=class extends(Mo($M)){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Vm;const e=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,"elevation"!==t.type&&"base-elevation"!==t.type&&jt.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=t=>{t.parent=null};this.addHandles([this.layers.on("after-add",(t=>e(t.item))),this.layers.on("after-remove",(t=>i(t.item)))])}initialize(){this.when().catch((t=>{Es(t)||jt.getLogger(this).error("#load()","Failed to load ground",t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)An(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",AM(t,this._get("layers")))}writeLayers(t,e,i,n){const s=[];t?(n={...n,layerContainerType:"ground"},t.forEach((t=>{if("write"in t){const e={};LA(t)().write(e,n)&&s.push(e)}else n?.messages&&n.messages.push(new Ve("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted in the ground`,{layer:t}))})),e.layers=s):e.layers=s}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return zM(this,(t=>{t(this.layers)}))}async queryElevation(t,e){await this.load({signal:e?.signal});const{ElevationQuery:i}=await import("./p-347cd3c5.js");_s(e);const n=new i,s=this.layers.filter(GA).toArray();return n.queryAll(s,t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{ElevationQuery:i}=await import("./p-347cd3c5.js");_s(e);const n=new i,s=this.layers.filter(GA).toArray();return n.createSamplerAll(s,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:nt(this.surfaceColor),navigationConstraint:nt(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new zA({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,i){const n=e?.origin||"web-scene",s=e?.portal||null,r=e?.url||null,{populateOperationalLayers:o}=await import("./p-517201ef.js");_s(i);const a=[];if(t.layers&&Array.isArray(t.layers)){const e={context:{origin:n,url:r,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,e))}await Promise.allSettled(a)}};function BA(t){return t&&"createElevationSampler"in t}function GA(t){return"elevation"===t.type||BA(t)}r([Je({json:{read:!1}})],UA.prototype,"layers",null),r([yh("layers")],UA.prototype,"writeLayers",null),r([Je({readOnly:!0})],UA.prototype,"resourceInfo",void 0),r([Je({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:ce,read:{reader:$A,source:"transparency"},write:{writer:(t,e)=>{e.transparency=DA(t)},target:"transparency"}}})],UA.prototype,"opacity",void 0),r([Je({type:RA,json:{type:[ce],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],UA.prototype,"surfaceColor",void 0),r([Je({type:FA,json:{write:!0}})],UA.prototype,"navigationConstraint",void 0),UA=zA=r([ln("esri.Ground")],UA);const VA=UA;const qA=new WeakMap;function HA(t){return!t.destroyed&&(qA.has(t)||t.addHandles([ey((()=>{const e=t.parent;return!(!e||!("type"in e))&&("catalog-dynamic-group"===e.type||HA(e))}),(e=>qA.set(t,e)),fy),we((()=>qA.delete(t)))]),qA.get(t))}function WA(t){return"object"==typeof t&&null!=t&&"loaded"in t&&!0===t.loaded&&"type"in t}function ZA(t){return!(!WA(t)||!nA(t)?.operations?.supportsEditing||"editingEnabled"in t&&!rA(t)||HA(t))}const JA=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,YA="screenUtils.toPt: input not recognized!",KA=96;function QA(t){return t?t/72*KA:0}function XA(t){return t?72*t/KA:0}function tI(t){if("string"==typeof t){const e=t.match(JA);if(e){const i=Number(e[1]),n=e[3]&&e[3].toLowerCase(),s="-"===t.charAt(0),r="px"===n?XA(i):i;return s?-r:r}return console.warn(YA),null}return t}function eI(t=0,e=0){return{x:t,y:e}}function iI(t){return t?eI(t.x,t.y):null}function nI(t=0,e=0){return[t,e]}function sI(t=0,e=0,i=0){return rI([t,e,i])}function rI(t){return t}function oI(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function aI(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function lI(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function uI(t,e,i,n,s,r,o,a,l,u,c,h,d,f,p,m){const y=new Float32Array(16);return y[0]=t,y[1]=e,y[2]=i,y[3]=n,y[4]=s,y[5]=r,y[6]=o,y[7]=a,y[8]=l,y[9]=u,y[10]=c,y[11]=h,y[12]=d,y[13]=f,y[14]=p,y[15]=m,y}function cI(t,e){return new Float32Array(t,e,16)}const hI=aI();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:hI,clone:lI,create:aI,createView:cI,fromValues:uI},Symbol.toStringTag,{value:"Module"}));let dI=1e-6;function fI(){return dI}function pI(t){dI=t}const mI=Math.random,yI=Math.PI/180,gI=180/Math.PI;function vI(t){return t*yI}function wI(t){return t*gI}function bI(t,e){return Math.abs(t-e)<=dI*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:mI,equals:bI,getEpsilon:fI,setEpsilon:pI,toDegree:wI,toRadian:vI},Symbol.toStringTag,{value:"Module"}));function SI(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function _I(t,e,i,n,s,r,o,a,l,u,c,h,d,f,p,m,y){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=f,t[13]=p,t[14]=m,t[15]=y,t}function xI(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function MI(t,e){if(t===e){const i=e[1],n=e[2],s=e[3],r=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=r,t[11]=e[14],t[12]=s,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function TI(t,e){return AI(t,e)||xI(t),t}function AI(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],y=e[14],g=e[15],v=i*a-n*o,w=i*l-s*o,b=i*u-r*o,S=n*l-s*a,_=n*u-r*a,x=s*u-r*l,M=c*m-h*p,T=c*y-d*p,A=c*g-f*p,I=h*y-d*m,k=h*g-f*m,C=d*g-f*y;let E=v*C-w*k+b*I+S*A-_*T+x*M;return E?(E=1/E,t[0]=(a*C-l*k+u*I)*E,t[1]=(s*k-n*C-r*I)*E,t[2]=(m*x-y*_+g*S)*E,t[3]=(d*_-h*x-f*S)*E,t[4]=(l*A-o*C-u*T)*E,t[5]=(i*C-s*A+r*T)*E,t[6]=(y*b-p*x-g*w)*E,t[7]=(c*x-d*b+f*w)*E,t[8]=(o*k-a*A+u*M)*E,t[9]=(n*A-i*k-r*M)*E,t[10]=(p*_-m*b+g*v)*E,t[11]=(h*b-c*_-f*v)*E,t[12]=(a*T-o*I-l*M)*E,t[13]=(i*I-n*T+s*M)*E,t[14]=(m*w-p*S-y*v)*E,t[15]=(c*S-h*w+d*v)*E,t):null}function II(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],y=e[14],g=e[15];return t[0]=a*(d*g-f*y)-h*(l*g-u*y)+m*(l*f-u*d),t[1]=-(n*(d*g-f*y)-h*(s*g-r*y)+m*(s*f-r*d)),t[2]=n*(l*g-u*y)-a*(s*g-r*y)+m*(s*u-r*l),t[3]=-(n*(l*f-u*d)-a*(s*f-r*d)+h*(s*u-r*l)),t[4]=-(o*(d*g-f*y)-c*(l*g-u*y)+p*(l*f-u*d)),t[5]=i*(d*g-f*y)-c*(s*g-r*y)+p*(s*f-r*d),t[6]=-(i*(l*g-u*y)-o*(s*g-r*y)+p*(s*u-r*l)),t[7]=i*(l*f-u*d)-o*(s*f-r*d)+c*(s*u-r*l),t[8]=o*(h*g-f*m)-c*(a*g-u*m)+p*(a*f-u*h),t[9]=-(i*(h*g-f*m)-c*(n*g-r*m)+p*(n*f-r*h)),t[10]=i*(a*g-u*m)-o*(n*g-r*m)+p*(n*u-r*a),t[11]=-(i*(a*f-u*h)-o*(n*f-r*h)+c*(n*u-r*a)),t[12]=-(o*(h*y-d*m)-c*(a*y-l*m)+p*(a*d-l*h)),t[13]=i*(h*y-d*m)-c*(n*y-s*m)+p*(n*d-s*h),t[14]=-(i*(a*y-l*m)-o*(n*y-s*m)+p*(n*l-s*a)),t[15]=i*(a*d-l*h)-o*(n*d-s*h)+c*(n*l-s*a),t}function kI(t){const e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],y=t[15];return(e*o-i*r)*(h*y-d*m)-(e*a-n*r)*(c*y-d*p)+(e*l-s*r)*(c*m-h*p)+(i*a-n*o)*(u*y-d*f)-(i*l-s*o)*(u*m-h*f)+(n*l-s*a)*(u*p-c*f)}function CI(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],m=e[12],y=e[13],g=e[14],v=e[15];let w=i[0],b=i[1],S=i[2],_=i[3];return t[0]=w*n+b*a+S*h+_*m,t[1]=w*s+b*l+S*d+_*y,t[2]=w*r+b*u+S*f+_*g,t[3]=w*o+b*c+S*p+_*v,w=i[4],b=i[5],S=i[6],_=i[7],t[4]=w*n+b*a+S*h+_*m,t[5]=w*s+b*l+S*d+_*y,t[6]=w*r+b*u+S*f+_*g,t[7]=w*o+b*c+S*p+_*v,w=i[8],b=i[9],S=i[10],_=i[11],t[8]=w*n+b*a+S*h+_*m,t[9]=w*s+b*l+S*d+_*y,t[10]=w*r+b*u+S*f+_*g,t[11]=w*o+b*c+S*p+_*v,w=i[12],b=i[13],S=i[14],_=i[15],t[12]=w*n+b*a+S*h+_*m,t[13]=w*s+b*l+S*d+_*y,t[14]=w*r+b*u+S*f+_*g,t[15]=w*o+b*c+S*p+_*v,t}function EI(t,e,i){const n=i[0],s=i[1],r=i[2];if(e===t)t[12]=e[0]*n+e[4]*s+e[8]*r+e[12],t[13]=e[1]*n+e[5]*s+e[9]*r+e[13],t[14]=e[2]*n+e[6]*s+e[10]*r+e[14],t[15]=e[3]*n+e[7]*s+e[11]*r+e[15];else{const i=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7],f=e[8],p=e[9],m=e[10],y=e[11];t[0]=i,t[1]=o,t[2]=a,t[3]=l,t[4]=u,t[5]=c,t[6]=h,t[7]=d,t[8]=f,t[9]=p,t[10]=m,t[11]=y,t[12]=i*n+u*s+f*r+e[12],t[13]=o*n+c*s+p*r+e[13],t[14]=a*n+h*s+m*r+e[14],t[15]=l*n+d*s+y*r+e[15]}return t}function jI(t,e,i){const n=i[0],s=i[1],r=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function OI(t,e,i,n){let s=n[0],r=n[1],o=n[2],a=Math.sqrt(s*s+r*r+o*o);if(a<=fI())return void SI(t,e);a=1/a,s*=a,r*=a,o*=a;const l=Math.sin(i),u=Math.cos(i),c=1-u,h=e[0],d=e[1],f=e[2],p=e[3],m=e[4],y=e[5],g=e[6],v=e[7],w=e[8],b=e[9],S=e[10],_=e[11],x=s*s*c+u,M=r*s*c+o*l,T=o*s*c-r*l,A=s*r*c-o*l,I=r*r*c+u,k=o*r*c+s*l,C=s*o*c+r*l,E=r*o*c-s*l,j=o*o*c+u;t[0]=h*x+m*M+w*T,t[1]=d*x+y*M+b*T,t[2]=f*x+g*M+S*T,t[3]=p*x+v*M+_*T,t[4]=h*A+m*I+w*k,t[5]=d*A+y*I+b*k,t[6]=f*A+g*I+S*k,t[7]=p*A+v*I+_*k,t[8]=h*C+m*E+w*j,t[9]=d*C+y*E+b*j,t[10]=f*C+g*E+S*j,t[11]=p*C+v*E+_*j,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function RI(t,e,i){const n=Math.sin(i),s=Math.cos(i),r=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*s+u*n,t[5]=o*s+c*n,t[6]=a*s+h*n,t[7]=l*s+d*n,t[8]=u*s-r*n,t[9]=c*s-o*n,t[10]=h*s-a*n,t[11]=d*s-l*n,t}function LI(t,e,i){const n=Math.sin(i),s=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*s-u*n,t[1]=o*s-c*n,t[2]=a*s-h*n,t[3]=l*s-d*n,t[8]=r*n+u*s,t[9]=o*n+c*s,t[10]=a*n+h*s,t[11]=l*n+d*s,t}function NI(t,e,i){const n=Math.sin(i),s=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*s+u*n,t[1]=o*s+c*n,t[2]=a*s+h*n,t[3]=l*s+d*n,t[4]=u*s-r*n,t[5]=c*s-o*n,t[6]=h*s-a*n,t[7]=d*s-l*n,t}function PI(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function FI(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function DI(t,e,i){if(0===e)return xI(t);let n=i[0],s=i[1],r=i[2],o=Math.sqrt(n*n+s*s+r*r);if(o<=fI())return null;o=1/o,n*=o,s*=o,r*=o;const a=Math.sin(e),l=Math.cos(e),u=1-l;return t[0]=n*n*u+l,t[1]=s*n*u+r*a,t[2]=r*n*u-s*a,t[3]=0,t[4]=n*s*u-r*a,t[5]=s*s*u+l,t[6]=r*s*u+n*a,t[7]=0,t[8]=n*r*u+s*a,t[9]=s*r*u-n*a,t[10]=r*r*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function $I(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zI(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function UI(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function BI(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=n+n,l=s+s,u=r+r,c=n*a,h=n*l,d=n*u,f=s*l,p=s*u,m=r*u,y=o*a,g=o*l,v=o*u;return t[0]=1-(f+m),t[1]=h+v,t[2]=d-g,t[3]=0,t[4]=h-v,t[5]=1-(c+m),t[6]=p+y,t[7]=0,t[8]=d+g,t[9]=p-y,t[10]=1-(c+f),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function GI(t,e){const i=VI,n=-e[0],s=-e[1],r=-e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=n*n+s*s+r*r+o*o;return h>0?(i[0]=2*(a*o+c*n+l*r-u*s)/h,i[1]=2*(l*o+c*s+u*n-a*r)/h,i[2]=2*(u*o+c*r+a*s-l*n)/h):(i[0]=2*(a*o+c*n+l*r-u*s),i[1]=2*(l*o+c*s+u*n-a*r),i[2]=2*(u*o+c*r+a*s-l*n)),BI(t,e,i),t}const VI=Yv();function qI(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function HI(t,e){const i=e[0],n=e[1],s=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(i*i+n*n+s*s),t[1]=Math.sqrt(r*r+o*o+a*a),t[2]=Math.sqrt(l*l+u*u+c*c),t}function WI(t,e){const i=e[0]+e[5]+e[10];let n=0;return i>0?(n=2*Math.sqrt(i+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t}function ZI(t,e,i,n){const s=e[0],r=e[1],o=e[2],a=e[3],l=s+s,u=r+r,c=o+o,h=s*l,d=s*u,f=s*c,p=r*u,m=r*c,y=o*c,g=a*l,v=a*u,w=a*c,b=n[0],S=n[1],_=n[2];return t[0]=(1-(p+y))*b,t[1]=(d+w)*b,t[2]=(f-v)*b,t[3]=0,t[4]=(d-w)*S,t[5]=(1-(h+y))*S,t[6]=(m+g)*S,t[7]=0,t[8]=(f+v)*_,t[9]=(m-g)*_,t[10]=(1-(h+p))*_,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function JI(t,e,i,n,s){const r=e[0],o=e[1],a=e[2],l=e[3],u=r+r,c=o+o,h=a+a,d=r*u,f=r*c,p=r*h,m=o*c,y=o*h,g=a*h,v=l*u,w=l*c,b=l*h,S=n[0],_=n[1],x=n[2],M=s[0],T=s[1],A=s[2],I=(1-(m+g))*S,k=(f+b)*S,C=(p-w)*S,E=(f-b)*_,j=(1-(d+g))*_,O=(y+v)*_,R=(p+w)*x,L=(y-v)*x,N=(1-(d+m))*x;return t[0]=I,t[1]=k,t[2]=C,t[3]=0,t[4]=E,t[5]=j,t[6]=O,t[7]=0,t[8]=R,t[9]=L,t[10]=N,t[11]=0,t[12]=i[0]+M-(I*M+E*T+R*A),t[13]=i[1]+T-(k*M+j*T+L*A),t[14]=i[2]+A-(C*M+O*T+N*A),t[15]=1,t}function YI(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=i+i,a=n+n,l=s+s,u=i*o,c=n*o,h=n*a,d=s*o,f=s*a,p=s*l,m=r*o,y=r*a,g=r*l;return t[0]=1-h-p,t[1]=c+g,t[2]=d-y,t[3]=0,t[4]=c-g,t[5]=1-u-p,t[6]=f+m,t[7]=0,t[8]=d+y,t[9]=f-m,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function KI(t,e,i,n,s,r,o){const a=1/(i-e),l=1/(s-n),u=1/(r-o);return t[0]=2*r*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*l,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(s+n)*l,t[10]=(o+r)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*r*2*u,t[15]=0,t}function QI(t,e,i,n,s){const r=1/Math.tan(e/2);let o;return t[0]=r/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=s&&s!==1/0?(o=1/(n-s),t[10]=(s+n)*o,t[14]=2*s*n*o):(t[10]=-1,t[14]=-2*n),t}function XI(t,e,i,n){const s=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(s+r);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(s-r)*u*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t}function tk(t,e,i,n,s,r,o){const a=1/(e-i),l=1/(n-s),u=1/(r-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*a,t[13]=(s+n)*l,t[14]=(o+r)*u,t[15]=1,t}function ek(t,e,i,n){const s=e[0],r=e[1],o=e[2];let a=s-i[0],l=r-i[1],u=o-i[2];const c=fI();if(Math.abs(a)<c&&Math.abs(l)<c&&Math.abs(u)<c)return void xI(t);let h=1/Math.sqrt(a*a+l*l+u*u);a*=h,l*=h,u*=h;const d=n[0],f=n[1],p=n[2];let m=f*u-p*l,y=p*a-d*u,g=d*l-f*a;h=Math.sqrt(m*m+y*y+g*g),h?(h=1/h,m*=h,y*=h,g*=h):(m=0,y=0,g=0);let v=l*g-u*y,w=u*m-a*g,b=a*y-l*m;h=Math.sqrt(v*v+w*w+b*b),h?(h=1/h,v*=h,w*=h,b*=h):(v=0,w=0,b=0),t[0]=m,t[1]=v,t[2]=a,t[3]=0,t[4]=y,t[5]=w,t[6]=l,t[7]=0,t[8]=g,t[9]=b,t[10]=u,t[11]=0,t[12]=-(m*s+y*r+g*o),t[13]=-(v*s+w*r+b*o),t[14]=-(a*s+l*r+u*o),t[15]=1}function ik(t,e,i,n){const s=e[0],r=e[1],o=e[2],a=n[0],l=n[1],u=n[2];let c=s-i[0],h=r-i[1],d=o-i[2],f=c*c+h*h+d*d;f>0&&(f=1/Math.sqrt(f),c*=f,h*=f,d*=f);let p=l*d-u*h,m=u*c-a*d,y=a*h-l*c;return f=p*p+m*m+y*y,f>0&&(f=1/Math.sqrt(f),p*=f,m*=f,y*=f),t[0]=p,t[1]=m,t[2]=y,t[3]=0,t[4]=h*y-d*m,t[5]=d*p-c*y,t[6]=c*m-h*p,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=s,t[13]=r,t[14]=o,t[15]=1,t}function nk(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function sk(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function rk(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function ok(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function ak(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}function lk(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t[9]=e[9]+i[9]*n,t[10]=e[10]+i[10]*n,t[11]=e[11]+i[11]*n,t[12]=e[12]+i[12]*n,t[13]=e[13]+i[13]*n,t[14]=e[14]+i[14]*n,t[15]=e[15]+i[15]*n,t}function uk(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ck(t,e){if(t===e)return!0;const i=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],y=t[14],g=t[15],v=e[0],w=e[1],b=e[2],S=e[3],_=e[4],x=e[5],M=e[6],T=e[7],A=e[8],I=e[9],k=e[10],C=e[11],E=e[12],j=e[13],O=e[14],R=e[15],L=fI();return Math.abs(i-v)<=L*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(n-w)<=L*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(s-b)<=L*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(r-S)<=L*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(o-_)<=L*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-x)<=L*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(l-M)<=L*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-T)<=L*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(c-A)<=L*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(h-I)<=L*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(d-k)<=L*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(f-C)<=L*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(p-E)<=L*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(m-j)<=L*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(y-O)<=L*Math.max(1,Math.abs(y),Math.abs(O))&&Math.abs(g-R)<=L*Math.max(1,Math.abs(g),Math.abs(R))}function hk(t){const e=fI(),i=t[0],n=t[1],s=t[2],r=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(n*n+o*o+u*u))<=e&&Math.abs(1-(s*s+a*a+c*c))<=e}function dk(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[8]&&0===t[9]&&1===t[10]}const fk=CI,pk=ok;Object.freeze(Object.defineProperty({__proto__:null,add:rk,adjoint:II,copy:SI,determinant:kI,equals:ck,exactEquals:uk,frob:sk,fromQuat:YI,fromQuat2:GI,fromRotation:DI,fromRotationTranslation:BI,fromRotationTranslationScale:ZI,fromRotationTranslationScaleOrigin:JI,fromScaling:FI,fromTranslation:PI,fromXRotation:$I,fromYRotation:zI,fromZRotation:UI,frustum:KI,getRotation:WI,getScaling:HI,getTranslation:qI,hasIdentityRotation:dk,identity:xI,invert:AI,invertOrIdentity:TI,isOrthoNormal:hk,lookAt:ek,mul:fk,multiply:CI,multiplyScalar:ak,multiplyScalarAndAdd:lk,ortho:tk,perspective:QI,perspectiveFromFieldOfView:XI,rotate:OI,rotateX:RI,rotateY:LI,rotateZ:NI,scale:jI,set:_I,str:nk,sub:pk,subtract:ok,targetTo:ik,translate:EI,transpose:MI},Symbol.toStringTag,{value:"Module"}));const mk=(t,e)=>{const i=_I(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return MI(i,i)},yk=(t,e)=>{const i=_I(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return MI(i,i)},gk=(t,e)=>{const i=1-e,n=_I(t,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return MI(n,n)},vk=(t,e)=>{const i=Math.sin(e*Math.PI/180),n=Math.cos(e*Math.PI/180),s=_I(t,.213+.787*n-.213*i,.715-.715*n-.715*i,.072-.072*n+.928*i,0,.213-.213*n+.143*i,.715+.285*n+.14*i,.072-.072*n-.283*i,0,.213-.213*n-.787*i,.715-.715*n+.715*i,.072+.928*n+.072*i,0,0,0,0,1);return MI(s,s)},wk=(t,e)=>{const i=1-2*e,n=_I(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return MI(n,n)},bk=(t,e)=>{const i=_I(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return MI(i,i)},Sk=(t,e)=>{const i=1-e,n=_I(t,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return MI(n,n)};class _k{constructor(t,e,i){this.strength=t,this.radius=e,this.threshold=i,this.type="bloom"}interpolate(t,e,i){this.strength=kk(t.strength,e.strength,i),this.radius=kk(t.radius,e.radius,i),this.threshold=kk(t.threshold,e.threshold,i)}clone(){return new _k(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:Ck(this.radius),strength:this.strength,threshold:this.threshold}}}class xk{constructor(t){this.radius=t,this.type="blur"}interpolate(t,e,i){this.radius=Math.round(kk(t.radius,e.radius,i))}clone(){return new xk(this.radius)}toJSON(){return{type:"blur",radius:Ck(this.radius)}}}class Mk{constructor(t,e){this.type=t,this.amount=e,"invert"!==this.type&&"grayscale"!==this.type&&"sepia"!==this.type||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,e,i){this.amount=kk(t.amount,e.amount,i),this._updateMatrix()}clone(){return new Mk(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||aI();switch(this.type){case"brightness":this._colorMatrix=mk(t,this.amount);break;case"contrast":this._colorMatrix=yk(t,this.amount);break;case"grayscale":this._colorMatrix=gk(t,this.amount);break;case"invert":this._colorMatrix=wk(t,this.amount);break;case"saturate":this._colorMatrix=bk(t,this.amount);break;case"sepia":this._colorMatrix=Sk(t,this.amount)}}}class Tk{constructor(t,e,i,n){this.offsetX=t,this.offsetY=e,this.blurRadius=i,this.color=n,this.type="drop-shadow"}interpolate(t,e,i){this.offsetX=kk(t.offsetX,e.offsetX,i),this.offsetY=kk(t.offsetY,e.offsetY,i),this.blurRadius=kk(t.blurRadius,e.blurRadius,i),this.color[0]=Math.round(kk(t.color[0],e.color[0],i)),this.color[1]=Math.round(kk(t.color[1],e.color[1],i)),this.color[2]=Math.round(kk(t.color[2],e.color[2],i)),this.color[3]=kk(t.color[3],e.color[3],i)}clone(){return new Tk(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:Ck(this.offsetX),yoffset:Ck(this.offsetY),blurRadius:Ck(this.blurRadius),color:t}}}class Ak{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,e,i){this.angle=kk(t.angle,e.angle,i),this._updateMatrix()}clone(){return new Ak(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||aI();this._colorMatrix=vk(t,this.angle)}}class Ik{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,e,i){this.amount=kk(t.amount,e.amount,i)}clone(){return new Ik(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function kk(t,e,i){return t+(e-t)*i}function Ck(t){return Math.round(1e3*XA(t))/1e3}function Ek(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new Mk(t.type,0);case"saturate":case"brightness":case"contrast":return new Mk(t.type,1);case"opacity":return new Ik(1);case"hue-rotate":return new Ak(0);case"blur":return new xk(0);case"drop-shadow":return new Tk(0,0,0,[...MA("transparent")]);case"bloom":return new _k(0,0,1)}}function jk(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every(((t,e)=>t.type===i[e].type))}function Ok(t,e){const i=t.length>e.length?t:e,n=t.length>e.length?e:t;for(let t=n.length;t<i.length;t++)n.push(Ek(i[t]))}function Rk(t){const e=t[0];return!!e&&"type"in e}function Lk(t,e){return JSON.stringify(t??null)===JSON.stringify(e??null)}const Nk=()=>jt.getLogger("esri.support.basemapUtils");function Pk(){return{}}function Fk(t){for(const e in t){const i=t[e];An(i),delete t[e]}}function Dk(t,e){let i;if("string"==typeof t){const n=t in DT,s=!n&&t.includes("/");if(!n&&!s){if(St.apiKey)Nk().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const e=Object.entries(DT).filter((([t,e])=>e.classic||e.is3d)).map((([t])=>`"${t}"`)).sort().join(", ");Nk().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${e}`)}return null}e&&(i=e[t]),i||(i=n?bA.fromId(t):new bA({style:{id:t}}),e&&(e[t]=i))}else i=ee(bA,t);return i?.destroyed&&(Nk().warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function $k(t){return"Web Scene"===t.portalItem?.type||t.referenceLayers.some((t=>"scene"===t.type))}function zk(t){return!!t?.portalItem?.tags?.some((t=>"beta"===t.toLowerCase()))}function Uk(t){let e=null;const i=Zk(t),n=!i?.baseLayers.length;for(const t in DT){const s=eC(i,Qk(DT[t]),{mustMatchReferences:n});if("equal"===s){e=t;break}"base-layers-equal"===s&&(e=t)}return e}function Bk(t,e){if(t===e)return!0;if(null!=t?.portalItem?.id&&t.portalItem.id===e?.portalItem?.id)return!0;return"equal"===eC(Zk(t),Zk(e),{mustMatchReferences:!0})}function Gk(t){return!!t?.baseLayers.concat(t.referenceLayers).some(Vk)}function Vk(t){if(Wk(t.url))return!0;if("vector-tile"===t.type)for(const e in t.sourceNameToSource){const i=t.sourceNameToSource[e];if(Wk(i?.sourceUrl))return!0}return!1}function qk(t,e){if(null==e||null==t)return{spatialReference:null,updating:!1};if("not-loaded"===e.loadStatus)return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(0===e.baseLayers.length)return{spatialReference:null,updating:!1};const i=e.baseLayers.at(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const n=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?i.tileInfo?.spatialReference:i.spatialReference]).filter(Boolean),s=t.spatialReference;return s?{spatialReference:n.find((t=>s.equals(t)))??n[0]??null,updating:!1}:{spatialReference:n[0],updating:!1}}const Hk=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function Wk(t){if(!t)return!1;const e=new ea(Ia(t));return!!e.authority&&Hk.test(e.authority)}function Zk(t){return t?!t.loaded&&t.resourceInfo?Qk(t.resourceInfo.data):{baseLayers:Jk(t.baseLayers),referenceLayers:Jk(t.referenceLayers)}:null}function Jk(t){return(Vm.isCollection(t)?t.toArray():t).map(Yk)}function Yk(t){return{type:t.type,effect:"effect"in t?t.effect:void 0,url:sC("urlTemplate"in t&&t.urlTemplate||t.url||"styleUrl"in t&&t.styleUrl||""),minScale:"minScale"in t&&null!=t.minScale?t.minScale:0,maxScale:"maxScale"in t&&null!=t.maxScale?t.maxScale:0,opacity:null!=t.opacity?t.opacity:1,visible:null==t.visible||!!t.visible,sublayers:"map-image"!==t.type&&"wms"!==t.type||null==t.sublayers?void 0:t.sublayers?.map((t=>({id:t.id,visible:t.visible}))),activeLayerId:"wmts"===t.type?t.activeLayer?.id:void 0}}function Kk(t){return t.isReference||"ArcGISSceneServiceLayer"===t.layerType}function Qk(t){return t?{baseLayers:Xk((t.baseMapLayers??[]).filter((t=>!Kk(t)))),referenceLayers:Xk((t.baseMapLayers??[]).filter((t=>Kk(t))))}:null}function Xk(t){return t.map((t=>tC(t)))}function tC(t){let e;switch(t.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;case"ArcGISSceneServiceLayer":e="scene";break;default:e="unknown"}return{type:e,effect:t.effect,url:sC(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:t.minScale??0,maxScale:t.maxScale??0,opacity:t.opacity??1,visible:null==t.visibility||!!t.visibility,sublayers:void 0,activeLayerId:void 0}}function eC(t,e,i){if(null!=t!=(null!=e))return"not-equal";if(!t||!e)return"equal";if(!iC(t.baseLayers,e.baseLayers))return"not-equal";return iC(t.referenceLayers,e.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal"}function iC(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!nC(t[i],e[i]))return!1;return!0}function nC(t,e){if(t.type!==e.type||t.url!==e.url||t.minScale!==e.minScale||t.maxScale!==e.maxScale||t.visible!==e.visible||t.opacity!==e.opacity)return!1;if(!Lk(t.effect,e.effect))return!1;if(null!=t.activeLayerId||null!=e.activeLayerId)return t.activeLayerId===e.activeLayerId;if(null!=t.sublayers||null!=e.sublayers){if(null==t.sublayers||null==e.sublayers||t.sublayers.length!==e.sublayers.length)return!1;for(let i=0;i<t.sublayers.length;i++){const n=t.sublayers.at(i),s=e.sublayers.at(i);if(n?.id!==s?.id||n?.visible!==s?.visible)return!1}}return!0}function sC(t){return t?Ca(t).replace(/^\s*https?:/i,"").toLowerCase():""}function rC(t){if(!t)return null;const{thumbnailUrl:e}=t;if(e)return e;const i=Uk(t);return i?DT[i].thumbnailUrl:On(t.baseLayers,oC)}function oC(t){return"portalItem"in t?t.portalItem?.thumbnailUrl:void 0}function aC(t){return new my({getCollections:()=>[t.tables,t.layers],getChildrenFunction:t=>{const e=[];return"tables"in t&&e.push(t.tables),"layers"in t&&e.push(t.layers),e},itemFilterFunction:t=>{const e=t.parent;return!!e&&"tables"in e&&e.tables.includes(t)}})}function lC(t){for(const e of t.values())e?.destroy();t.clear()}const uC={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function cC(t){let e=null;if("string"==typeof t)if(t in uC){const i=uC[t];e=new VA({resourceInfo:{data:{layers:[i]}}})}else jt.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=ee(VA,t);return e}let hC=0;const dC=t=>{let e=class extends t{constructor(...t){super(...t),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+hC++})}};return e=r([ln("esri.core.Identifiable")],e),e},fC=t=>{let e=class extends t{constructor(...t){super(...t),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:hC++})}};return e=r([ln("esri.core.Identifiable.NumericIdentifiable")],e),e};let pC=class extends(dC(class{})){};pC=r([ln("esri.core.Identifiable")],pC);async function mC(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await import("./p-014b10d8.js").then((function(t){return t.p}));try{return await i(e)}catch(t){const i=e?.portalItem,n=i?.id||"unset",s=i?.portal?.url||St.portalUrl;throw jt.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+s+"', id: '"+n+"')",t),t}}const yC={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function gC(t,e,i,n=og){const s=new rg.IANAZone(Gg(n)),r=rg.DateTime.fromJSDate(t,{zone:s}),o="decades"===i||"centuries"===i?"year":SC(i);return"decades"===i&&(e*=10),"centuries"===i&&(e*=100),r.plus({[o]:e}).toJSDate()}function vC(t,e,i="milliseconds"){const n=t.getTime(),s=bC(e,i,"milliseconds");return new Date(n+s)}function wC(t,e,i=og){const n=new rg.IANAZone(Gg(i)),s=rg.DateTime.fromJSDate(t,{zone:n});if("decades"===e||"centuries"===e){const t=s.startOf("year"),{year:i}=t,n=i-i%("decades"===e?10:100);return t.set({year:n}).toJSDate()}const r=SC(e);return s.startOf(r).toJSDate()}function bC(t,e,i){if(0===t)return 0;return t*yC[e]/yC[i]}function SC(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var _C;let xC=_C=class extends Io{static get allTime(){return TC}static get empty(){return AC}static fromArray(t){return new _C({start:null!=t[0]?new Date(t[0]):t[0],end:null!=t[1]?new Date(t[1]):t[1]})}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,e){return null!=e.end?new Date(e.end):null}writeEnd(t,e){e.end=t?.getTime()??null}get isAllTime(){return this.equals(_C.allTime)}get isEmpty(){return this.equals(_C.empty)}readStart(t,e){return null!=e.start?new Date(e.start):null}writeStart(t,e){e.start=t?.getTime()??null}clone(){return new _C({end:this.end,start:this.start})}equals(t){if(!t)return!1;const e=this.start?.getTime()??this.start,i=this.end?.getTime()??this.end,n=t.start?.getTime()??t.start,s=t.end?.getTime()??t.end;return e===n&&i===s}expandTo(t,e=og){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=wC(i,t,e));let n=this.end;if(n){const i=wC(n,t,e);n=n.getTime()===i.getTime()?i:gC(i,1,t,e)}return new _C({start:i,end:n})}intersection(t){if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return _C.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=this.start?.getTime()??-1/0,i=this.end?.getTime()??1/0,n=t.start?.getTime()??-1/0,s=t.end?.getTime()??1/0;let r,o;return n>=e&&n<=i?r=n:e>=n&&e<=s&&(r=e),i>=n&&i<=s?o=i:s>=e&&s<=i&&(o=s),null==r||null==o||isNaN(r)||isNaN(o)?_C.empty:new _C({start:r===-1/0?null:new Date(r),end:o===1/0?null:new Date(o)})}offset(t,e,i=og){if(this.isEmpty||this.isAllTime)return this.clone();const n=new _C,{start:s,end:r}=this;return null!=s&&(n.start=gC(s,t,e,i)),null!=r&&(n.end=gC(r,t,e,i)),n}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return TC.clone();const e=null!=this.start&&null!=t.start?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=null!=this.end&&null!=t.end?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new _C({start:e,end:i})}};r([Je({type:Date,json:{write:{allowNull:!0}}})],xC.prototype,"end",void 0),r([ko("end")],xC.prototype,"readEnd",null),r([yh("end")],xC.prototype,"writeEnd",null),r([Je({readOnly:!0,json:{read:!1}})],xC.prototype,"isAllTime",null),r([Je({readOnly:!0,json:{read:!1}})],xC.prototype,"isEmpty",null),r([Je({type:Date,json:{write:{allowNull:!0}}})],xC.prototype,"start",void 0),r([ko("start")],xC.prototype,"readStart",null),r([yh("start")],xC.prototype,"writeStart",null),xC=_C=r([ln("esri.time.TimeExtent")],xC);const MC=xC,TC=new xC,AC=new xC({start:void 0,end:void 0});let IC=0,kC=class extends(Tm.EventedMixin(dC($M))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Od(-180,-90,180,90,wh.WGS84),this.id=Date.now().toString(16)+"-layer-"+IC++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=wh.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(t){const e="string"==typeof t?{url:t}:t;return(await import("./p-318eb6a8.js")).fromUrl(e)}static fromPortalItem(t){return mC(t)}initialize(){this.when().catch((t=>{Es(t)||jt.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})}))}destroy(){const t=this.parent;if(t){const e=this;"layers"in t&&t.layers.includes(e)?t.layers.remove(e):"tables"in t&&t.tables.includes(e)?t.tables.remove(e):"baseLayers"in t&&t.baseLayers.includes(e)?t.baseLayers.remove(e):"referenceLayers"in t&&t.referenceLayers.includes(e)&&t.referenceLayers.remove(e),this._set("parent",null)}}get effectiveVisible(){let t=this.visible;const e=this.parent;return t&&e&&"effectiveVisible"in e&&(t&&=e.effectiveVisible),t}get hasAttributionData(){return null!=this.attributionDataUrl}get parsedUrl(){return ca(this.url)}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t){return(await Pl(t,{query:{f:"json"},responseType:"json"})).data}throw new Ve("layer:no-attribution-data","Layer does not have attribution data")}};r([Je({type:String})],kC.prototype,"attributionDataUrl",void 0),r([Je({readOnly:!0})],kC.prototype,"effectiveVisible",null),r([Je({type:Od})],kC.prototype,"fullExtent",void 0),r([Je({readOnly:!0})],kC.prototype,"hasAttributionData",null),r([Je({type:String,clonable:!1})],kC.prototype,"id",void 0),r([Je({type:Boolean,nonNullable:!0})],kC.prototype,"legendEnabled",void 0),r([Je({type:["show","hide","hide-children"]})],kC.prototype,"listMode",void 0),r([Je({type:Number,range:{min:0,max:1},nonNullable:!0})],kC.prototype,"opacity",void 0),r([Je({clonable:!1})],kC.prototype,"parent",void 0),r([Je({readOnly:!0})],kC.prototype,"parsedUrl",null),r([Je({type:Boolean,readOnly:!0})],kC.prototype,"persistenceEnabled",void 0),r([Je({type:Boolean})],kC.prototype,"popupEnabled",void 0),r([Je({type:Boolean})],kC.prototype,"attributionVisible",void 0),r([Je({type:wh})],kC.prototype,"spatialReference",void 0),r([Je({type:String})],kC.prototype,"title",void 0),r([Je({readOnly:!0,json:{read:!1}})],kC.prototype,"type",void 0),r([Je()],kC.prototype,"url",void 0),r([Je({type:MC})],kC.prototype,"visibilityTimeExtent",void 0),r([Je({type:Boolean,nonNullable:!0})],kC.prototype,"visible",void 0),kC=r([ln("esri.layers.Layer")],kC);const CC=kC;function EC(t,e,i){let n,s;if(t)for(let r=0,o=t.length;r<o;r++){if(n=t.at(r),n?.[e]===i)return n;if("group"===n?.type&&(s=EC(n.layers,e,i),s))return s}}const jC=t=>{let e=class extends t{constructor(...t){super(...t),this.layers=new Vm;const e=t=>{t.parent&&"remove"in t.parent&&t.parent.remove(t)},i=t=>{t.parent=this,this.layerAdded(t),"elevation"!==t.type&&"base-elevation"!==t.type||jt.getLogger(this).error(`Layer 'title:${t.title}, id:${t.id}' of type '${t.type}' is not supported as an operational layer and will therefore be ignored.`)},n=t=>{t.parent=null,this.layerRemoved(t)};this.addHandles([this.layers.on("before-add",(t=>{if(t.item===this)return t.preventDefault(),void jt.getLogger(this).error("#add()","Cannot add layer to itself.");e(t.item)})),this.layers.on("after-add",(t=>i(t.item))),this.layers.on("after-remove",(t=>n(t.item)))])}destroy(){const t=this.layers.toArray();for(const e of t)e.destroy();this.layers.destroy()}set layers(t){this._set("layers",AM(t,this._get("layers")))}add(t,e){const i=this.layers;if(e=i.getNextIndex(e),t instanceof CC){const n=t;n.parent===this?this.reorder(n,e):i.add(n,e)}else Fs(t)?t.then((t=>{this.destroyed||this.add(t,e)})):jt.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(t,e){const i=this.layers;let n=i.getNextIndex(e);t.slice().forEach((t=>{t.parent!==this?(i.add(t,n),n+=1):this.reorder(t,n)}))}findLayerById(t){return EC(this.layers,"id",t)}findLayerByUid(t){return EC(this.layers,"uid",t)}remove(t){return this.layers.remove(t)}removeMany(t){return this.layers.removeMany(t)}removeAll(){return this.layers.removeAll()}reorder(t,e){return this.layers.reorder(t,e)}layerAdded(t){}layerRemoved(t){}};return r([Je()],e.prototype,"layers",null),e=r([ln("esri.support.LayersMixin")],e),e};function OC(t,e,i){if(t)for(let n=0,s=t.length;n<s;n++){const s=t.at(n);if(s[e]===i)return s;if("group"===s?.type){const t=OC(s.tables,e,i);if(t)return t}}}const RC=t=>{let e=class extends t{constructor(...t){super(...t),this.tables=new Vm,this.addHandles([this.tables.on("after-add",(t=>{const e=t.item;e.parent&&e.parent!==this&&"tables"in e.parent&&e.parent.tables.remove(e),e.parent=this,"feature"!==e.type&&jt.getLogger(this).error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as a table and will therefore be ignored.`)})),this.tables.on("after-remove",(t=>{t.item.parent=null}))])}destroy(){const t=this.tables.toArray();for(const e of t)e.destroy();this.tables.destroy()}set tables(t){this._set("tables",AM(t,this._get("tables")))}findTableById(t){return OC(this.tables,"id",t)}findTableByUid(t){return OC(this.tables,"uid",t)}};return r([Je()],e.prototype,"tables",null),e=r([ln("esri.support.TablesMixin")],e),e};let LC=class extends(RC(jC(Tm.EventedMixin(ao)))){constructor(t){super(t),this.allLayers=new my({getCollections:()=>[this.basemap?.baseLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=aC(this),this.basemap=null,this.editableLayers=new my({getCollections:()=>[this.allLayers],itemFilterFunction:ZA}),this.ground=new VA,this._basemapCache=Pk()}destroy(){Fk(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=An(this.basemap),An(this.ground),this._set("ground",null)}castBasemap(t){return Dk(t,this._basemapCache)}castGround(t){const e=cC(t);return e??this._get("ground")}findLayerById(t){return this.allLayers.find((e=>e.id===t))}findTableById(t){return this.allTables.find((e=>e.id===t))}};r([Je({readOnly:!0,dependsOn:[]})],LC.prototype,"allLayers",void 0),r([Je({readOnly:!0})],LC.prototype,"allTables",void 0),r([Je({type:bA,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],LC.prototype,"basemap",void 0),r([Ah("basemap")],LC.prototype,"castBasemap",null),r([Je({readOnly:!0})],LC.prototype,"editableLayers",void 0),r([Je({type:VA,nonNullable:!0})],LC.prototype,"ground",void 0),r([Ah("ground")],LC.prototype,"castGround",null),r([Je()],LC.prototype,"undoRedo",void 0),LC=r([ln("esri.Map")],LC);const NC=LC;let PC=class extends Vm{constructor(t){super(t),this.addHandles([this.on("before-add",(t=>{null==t.item&&t.preventDefault()})),this.on("after-add",(t=>this._own(t.item))),this.on("after-remove",(t=>this._release(t.item)))])}get owner(){return this._get("owner")}set owner(t){t!==this._get("owner")&&(this._releaseAll(),this._set("owner",t),this._ownAll())}_ownAll(){for(const t of this.items)this._own(t)}_releaseAll(){for(const t of this.items)this._release(t)}_createNewInstance(t){return this.itemType?new(Vm.ofType(this.itemType.Type))(t):new Vm(t)}};function FC(t,e){return{type:t,cast:IM,set(i){const n=AM(i,this._get(e),t);n.owner=this,this._set(e,n)}}}r([Je()],PC.prototype,"owner",null),PC=r([ln("esri.core.support.OwningCollection")],PC);var DC;const $C=Oo()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),zC=$C.jsonValues.slice();S(zC,"orthometric");const UC=Oo()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let BC=DC=class extends Io{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return $C.write(t,e,i)}readHeightModel(t,e,i){const n=$C.read(t);return n||(i?.messages&&i.messages.push(VC(t,{context:i})),null)}readHeightUnit(t,e,i){const n=UC.read(t);return n||(i?.messages&&i.messages.push(GC(t,{context:i})),null)}readHeightUnitService(t,e,i){const n=Wc(t)||UC.read(t);return n||(i?.messages&&i.messages.push(GC(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new DC({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=Jc(e);return new DC({heightModel:t.heightModel,heightUnit:i??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new DC;return e.read(t,{origin:"web-scene"}),e}};function GC(t,e){return new wi("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function VC(t,e){return new wi("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}r([Je({type:$C.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:zC,default:"ellipsoidal"}}}})],BC.prototype,"heightModel",void 0),r([yh("web-scene","heightModel")],BC.prototype,"writeHeightModel",null),r([ko(["web-scene","service"],"heightModel")],BC.prototype,"readHeightModel",null),r([Je({type:UC.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:UC.jsonValues,write:UC.write}}}})],BC.prototype,"heightUnit",void 0),r([ko("web-scene","heightUnit")],BC.prototype,"readHeightUnit",null),r([ko("service","heightUnit")],BC.prototype,"readHeightUnitService",null),r([Je({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],BC.prototype,"vertCRS",void 0),r([ko("service","vertCRS",["vertCRS","ellipsoid","geoid"])],BC.prototype,"readVertCRS",null),BC=DC=r([ln("esri.geometry.HeightModelInfo")],BC);const qC=BC;let HC=class extends PC{constructor(t){super(t),this.addHandles(this.on("before-add",(t=>{null!=t.item&&t.item.parent===this.owner&&(jt.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())})))}_own(t){t.parent=this.owner}_release(t){t.parent=null}};HC=r([ln("esri.support.AnalysesCollection")],HC);async function WC(t,e){const{WhereClause:i}=await import("./p-cea3971b.js").then((function(t){return t.W}));return i.create(t,{fieldsIndex:e})}function ZC(t,e){return"1=1"===t?e??t:"1=1"===e?t??e:null!=t&&""!==t?null!=e&&""!==e?`(${t}) AND (${e})`:t:e}function JC(t){return"number"==typeof t}function YC(t){return"string"==typeof t||t instanceof String}const KC=lg,QC={date:null,time:null,timeZoneOffset:null},XC=new Map([["hours",3600],["minutes",60],["seconds",1],["deciseconds",.1],["centiseconds",.01],["milliseconds",.001]]);var tE;!function(t){t.HM="HH:mm",t.HMS="HH:mm:ss",t.HMS_MS="HH:mm:ss.SSS"}(tE||(tE={}));const eE=[tE.HMS_MS,tE.HMS,tE.HM,"TT"],iE="yyyy-MM-dd",nE=tE.HMS,sE="latn",rE=new Set(["date-only","time-only","timestamp-offset"]),oE=t=>"valueAsDate"in t;function aE(t){return{locale:Jy(),numberingSystem:sE,zone:t??KC}}function lE(t,e){return null===t?null:rg.DateTime.fromMillis(t,aE(e))}function uE(t,e){if(null==t||!YC(t)||""===t){if(e){const t=rg.DateTime.local({zone:e});return{date:null,time:null,timeZoneOffset:t.isValid?t.offset.toString():null}}return QC}const i=rg.DateTime.fromISO(t,{setZone:!0});return{date:i.toFormat(iE,aE()),time:i.toFormat(tE.HMS_MS,aE()),timeZoneOffset:i.offset.toString()}}function cE(t,e){if(null==t||!JC(t)||isNaN(t))return QC;const i=lE(t,e);return i?{date:i.toFormat(iE,aE(e)),time:i.toFormat(nE,aE(e))}:QC}function hE(t){switch(t.type){case"date":default:return Dg("short-date-short-time");case"date-only":return Dg("short-date");case"time-only":return Dg("short-time");case"timestamp-offset":return{...Dg("short-date-short-time"),timeZone:void 0,timeZoneName:"short"}}}function dE(t,e,i){if(!t||null==e)return null;switch(t.type){case"date":return $g(e,i);case"date-only":return zg(e,i);case"time-only":return Ug(e,i);case"timestamp-offset":return Bg(e,i);default:return null}}function fE(t){const{dateComponent:e,defaultTimeZone:i,timeComponent:n,timeZoneComponent:s,oldValue:r}=t;if(!e?.value)return null;const{year:o,month:a,day:l}=rg.DateTime.fromFormat(e.value,iE),{hour:u,minute:c,second:h,millisecond:d}=mE(n,lg)??rg.DateTime.now(),f=uE(r,i),p=s?.value?parseInt(s.value,10):null!=f.timeZoneOffset?parseInt(f.timeZoneOffset,10):(new Date).getTimezoneOffset(),m=rg.FixedOffsetZone.instance(p),y=rg.DateTime.fromObject({year:o,month:a,day:l,hour:u,minute:c,second:h,millisecond:d},{zone:m});return y.isValid?y.toISO({includeOffset:!0}):null}function pE(t){const{dateComponent:e,timeComponent:i,timeZone:n,max:s,min:r,oldValue:o}=t,a=mE(e,n);let l=!!t.applyRange;if(!a)return null;let u=null;if(null!=i?.value){const t=mE(i,n),e=Date.now(),r=null!=s&&s<e?s:e,o=rg.DateTime.fromMillis(r,aE(n)),l=a||o,{year:c,month:h,day:d}=l,{hour:f,minute:p,second:m,millisecond:y}=t||o;u=l.set({year:c,month:h,day:d,hour:f,minute:p,second:m,millisecond:y})}else{const t=lE(gE({value:o??Date.now(),max:s,min:r}),n),{year:e,month:i,day:c}=a,{hour:h,minute:d,second:f,millisecond:p}=t;l=!0,u=a.set({year:e,month:i,day:c,hour:h,minute:d,second:f,millisecond:p})}if(!u.isValid)return null;const c=u.toMillis();return l?gE({value:c,max:s,min:r}):c}function mE(t,e){if(null==t?.value||Array.isArray(t.value))return null;let i=null;return i=oE(t)?rg.DateTime.fromFormat(t.value,iE,aE(e)):_E(t.value),i?.isValid?i:null}function yE(t){const{max:e,min:i,value:n}=t;return!isNaN(n)&&(!(null!=e&&n>e)&&!(null!=i&&n<i))}function gE(t){const{max:e,min:i,value:n}=t;return null!=e&&null!=i?wf(n,i,e):null!=e&&n>e?e:null!=i&&n<i?i:n}function vE(t){if(!t)return"";const e=t.split(".").at(0);if(!e||e.length<1)throw new Ve("invalid time-only field",`Cannot parse valid time-only field value from ${t}`);const i=e.split(":"),n=new Array(3);for(let t=0;t<3;t++){const e=i.at(t)??"";n[t]=e.padStart(2,"0")}return n.join(":")}function wE(t,e){switch(e){case"date":return t.getTime();case"date-only":return t.toISODate();case"time-only":return vE(t.toISOTime(!0,!1));case"timestamp-offset":return t.toISOString(!1);default:return null}}function bE(t){return!!t&&"object"==typeof t&&"getTime"in t&&"toISOString"in t&&"timeZone"in t}function SE(t){if(!t||!YC(t))return null;const e=rg.DateTime.fromFormat(t,iE);return e.isValid?e:null}function _E(t){return t&&YC(t)?On(eE,(e=>{const i=rg.DateTime.fromFormat(t,e);return i.isValid?i:null}))??null:null}function xE(t){if(!t||!YC(t))return null;const e=rg.DateTime.fromISO(t);return e.isValid?e:null}function ME(t){const{type:e,range:i,value:n}=t;if(null==n||!i||n===i.min||n===i.max)return!0;if("date"===e)return yE({value:n,min:i.min,max:i.max});const{rawMax:s,rawMin:r}=i;let o=null,a=null,l=null;switch(e){case"date-only":o=SE(s),a=SE(r),l=SE(n);break;case"time-only":o=_E(s),a=_E(r),l=_E(n);break;case"timestamp-offset":o=xE(s),a=xE(r),l=xE(n)}return!l||yE({value:l.valueOf(),min:a?.valueOf(),max:o?.valueOf()})}var TE;!function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"}(TE||(TE={}));const AE=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function IE(t){return null!=t&&AE.has(t.type)}function kE(t){return null!=t&&("date-only"===t.type||"esriFieldTypeDateOnly"===t.type)}function CE(t){return null!=t&&("timestamp-offset"===t.type||"esriFieldTypeTimestampOffset"===t.type)}function EE(t){return null!=t&&("time-only"===t.type||"esriFieldTypeTimeOnly"===t.type)}function jE(t,e,i){const n=i??t?.domain;if(!n)return null;switch(n.type){case"range":{const{min:n,max:s}=OE(t,i);if(null!=n&&+e<n||null!=s&&+e>s)return TE.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(null==n.codedValues||n.codedValues.every((t=>null==t||t.code!==e)))return TE.INVALID_CODED_VALUE}return null}function OE(t,e){const i=e??t?.domain;if(!i||"range"!==i.type)return;const n="range"in i?i.range[0]:i.minValue,s="range"in i?i.range[1]:i.maxValue,r=IE(t);return kE(t)||EE(t)||CE(t)?{...RE(t,s,n),isInteger:r}:{min:null!=n&&"number"==typeof n?n:null,max:null!=s&&"number"==typeof s?s:null,rawMin:n,rawMax:s,isInteger:r}}function RE(t,e,i){return kE(t)?{min:SE(i)?.toMillis(),max:SE(e)?.toMillis(),rawMin:i,rawMax:e}:EE(t)?{min:_E(i)?.toMillis(),max:_E(e)?.toMillis(),rawMin:i,rawMax:e}:CE(t)?{min:xE(i)?.toMillis(),max:xE(e)?.toMillis(),rawMin:i,rawMax:e}:{max:null,min:null}}const LE=()=>jt.getLogger("esri.support.arcadeOnDemand");let NE;function PE(){return NE||(NE=(async()=>{const t=await import("./p-448d8eb2.js").then((function(t){return t.i}));return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),NE}const FE=(t,e,i)=>$E.create(t,e,i,null,["$feature","$view"],[]),DE=(t,e,i,n)=>$E.create(t,e,i,n,["$feature","$view"],[]);class $E{constructor(t,e,i,n,s,r,o){this.services=null,this.script=t,this.evaluate=n;const a=Array.isArray(r)?r:r?.fields;this.fields=a??[],this._syntaxTree=i,this._arcade=e,this._arcadeFeature=s,this._spatialReference=o,this._referencesGeometry=e.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(t,e,i,n,s,r){const{arcade:o,Feature:a,Dictionary:l}=await PE(),u=e instanceof wh?e:wh.fromJSON(e);let c;try{c=o.parseScript(t,r)}catch(e){return LE().error(new Ve("arcade-bad-expression","Failed to parse arcade script",{script:t,error:e})),null}const h=s.reduce(((t,e)=>({...t,[e]:null})),{});let d=null;null!=n&&(d=new l(n),d.immutable=!0,h.$config=null);const f=o.scriptUsesGeometryEngine(c),p=f&&o.enableGeometrySupport(),m=o.scriptUsesFeatureSet(c)&&o.enableFeatureSetSupport(),y=o.scriptIsAsync(c),g=y&&o.enableAsyncSupport(),v={vars:h,spatialReference:u,useAsync:!!g};await Promise.all([p,m,g]);const w=new Set;await o.loadDependentModules(w,c,null,y,f);const b=new l;b.immutable=!1,b.setField("scale",0);const S=o.compileScript(c,v),_=(t,e)=>{const i=t.$view?.timeZone;return"$view"in t&&t.$view&&(b.setField("scale","object"==typeof t.$view&&"scale"in t.$view?t.$view.scale:void 0),t.$view=b),d&&(t.$config=d),S({vars:t,spatialReference:u,services:e,timeZone:i})};return new $E(t,o,c,_,new a,i,u)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}}const zE=/^([0-9_])/,UE=/[^a-z0-9_\u0080-\uffff]+/gi;function BE(t){if(null==t)return null;return t.trim().replaceAll(UE,"_").replace(zE,"F$1")||null}const GE=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],VE=["field","normalizationField"];function qE(t,e){if(null!=t&&null!=e)for(const i of Array.isArray(t)?t:[t])if(HE(GE,i,e),"visualVariables"in i&&i.visualVariables)for(const t of i.visualVariables)HE(VE,t,e)}function HE(t,e,i){if(t)for(const n of t){const t=yt(n,e),s=t&&"function"!=typeof t&&i.get(t);s&&gt(n,s.name,e)}}function WE(t,e){if(null!=t&&e?.fields?.length)if("startField"in t){const i=e.get(t.startField),n=e.get(t.endField);t.startField=i?.name??null,t.endField=n?.name??null}else{const i=e.get(t.startTimeField),n=e.get(t.endTimeField);t.startTimeField=i?.name??null,t.endTimeField=n?.name??null}}const ZE=new Set;function JE(t,e){return t&&e?(ZE.clear(),YE(ZE,t,e),Array.from(ZE).sort()):[]}function YE(t,e,i){if(i)if(e?.fields?.length)if(i.includes("*"))for(const{name:i}of e.fields)t.add(i);else for(const n of i)KE(t,e,n);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const e of i)null!=e&&t.add(e)}}function KE(t,e,i){if("string"==typeof i)if(e){const n=e.get(i);n&&t.add(n.name)}else t.add(i)}function QE(t,e){return null==e||null==t?[]:e.includes("*")?(t.fields??[]).map((t=>t.name)):e}function XE(t,e,i=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const n=JE(t,e);return n.length/t.fields.length>=i?["*"]:n}async function tj(t,e,i){if(!i)return;const{arcadeUtils:n}=await PE(),s=n.extractFieldNames(i,e?.fields?.map((t=>t.name)));for(const i of s)KE(t,e,i)}async function ej(t,e,i){if(i&&"1=1"!==i){const n=await WC(i,e);if(!n.isStandardized)throw new Ve("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});YE(t,e,n.fieldNames)}}function ij({displayField:t,fields:e}){return t||(e?.length?sj(e,"name-or-title")||sj(e,"unique-identifier")||sj(e,"type-or-category")||nj(e):null)}function nj(t){for(const e of t){if(!e?.name)continue;const t=e.name.toLowerCase();if(t.includes("name")||t.includes("title"))return e.name}return null}function sj(t,e){for(const i of t)if(i?.valueType&&i.valueType===e)return i.name;return null}async function rj(t,e){if(!e)return;const i=e.elevationInfo?.featureExpressionInfo;return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}function oj(t,e,i){i.onStatisticExpression?tj(t,e,i.onStatisticExpression.expression):t.add(i.onStatisticField)}async function aj(t,e,i){if(!e||!i||!("fields"in i))return;const n=[],s=i.popupTemplate;n.push(lj(t,e,s)),i.fields&&n.push(...i.fields.map((async i=>oj(t,e.fieldsIndex,i)))),await Promise.all(n)}async function lj(t,e,i){const n=[];i?.expressionInfos&&n.push(...i.expressionInfos.map((i=>tj(t,e.fieldsIndex,i.expression))));const s=i?.content;if(Array.isArray(s))for(const i of s)"expression"===i.type&&i.expressionInfo&&n.push(tj(t,e.fieldsIndex,i.expressionInfo.expression));await Promise.all(n)}async function uj(t,e,i){e&&(e.timeInfo&&i?.timeExtent&&YE(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&YE(t,e.fieldsIndex,[e.floorInfo.floorField]),null!=i?.where&&await ej(t,e.fieldsIndex,i.where))}async function cj(t,e,i){e&&i&&await Promise.all(i.map((i=>hj(t,e,i))))}async function hj(t,e,i){e&&i&&(i.valueExpression?await tj(t,e.fieldsIndex,i.valueExpression):i.field&&KE(t,e.fieldsIndex,i.field))}function dj(t){return t?JE(t.fieldsIndex,vj(t)):[]}function fj(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?JE(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}const pj=new Set(["oid","global-id","guid"]),mj=new Set(["oid","global-id"]),yj=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function gj(t){const e=new Set;wj(t).forEach((t=>e.add(t))),fj(t).forEach((t=>e.add(t.toLowerCase())));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach((t=>e.add(t.toLowerCase()))),Object.values(i.transformFieldRoles).forEach((t=>e.add(t.toLowerCase())))),Array.from(e)}function vj(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:n,editDateField:s,editorField:r}=e;return[i,n,s,r].filter(Boolean)}function wj(t){return vj(t).map((t=>t.toLowerCase()))}function bj(t,e){return t.editable&&!pj.has(t.type)&&!wj(e).includes(t.name?.toLowerCase()??"")}function Sj(t,e){const i=t.name?.toLowerCase()??"";return!(null!=e?.objectIdField&&i===e.objectIdField.toLowerCase()||null!=e?.globalIdField&&i===e.globalIdField.toLowerCase()||gj(e).includes(i)||mj.has(t.type)||yj.some((t=>t.test(i))))}async function _j(t,e){const{labelingInfo:i,fieldsIndex:n}=e;i?.length&&await Promise.all(i.map((e=>xj(t,n,e))))}async function xj(t,e,i){if(!i)return;const n=i.getLabelExpression(),s=i.where;if("arcade"===n.type)await tj(t,e,n.expression);else{const i=n.expression.match(/{[^}]*}/g);i&&i.forEach((i=>{KE(t,e,i.slice(1,-1))}))}await ej(t,e,s)}function Mj(t){const e=t.defaultValue;return void 0!==e&&Oj(t,e)?e:t.nullable?null:void 0}function Tj(t){const e="string"==typeof t?{type:t}:t;return Bj(e)?255:"esriFieldTypeDate"===e.type||"date"===e.type?8:void 0}function Aj(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function Ij(t){return null===t||Aj(t)}function kj(t){return null===t||Number.isInteger(t)}function Cj(t){return null!=t&&"string"==typeof t}function Ej(t){return null===t||Cj(t)}function jj(){return!0}function Oj(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=t.nullable?kj:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?Ij:Aj;break;case"string":case"esriFieldTypeString":i=t.nullable?Ej:Cj;break;default:i=jj}return 1===arguments.length?i:i(e)}const Rj=["integer","small-integer","big-integer"],Lj=["single","double"],Nj=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],Pj=["esriFieldTypeSingle","esriFieldTypeDouble"],Fj=new Set([...Rj,...Nj]),Dj=new Set([...Lj,...Pj]),$j=vr(Fj,Dj);function zj(t){return null!=t&&Fj.has(t.type)}function Uj(t){return null!=t&&$j.has(t.type)}function Bj(t){return null!=t&&("string"===t.type||"esriFieldTypeString"===t.type)}function Gj(t){return null!=t&&("date"===t.type||"esriFieldTypeDate"===t.type)}function Vj(t){return null!=t&&("date-only"===t.type||"esriFieldTypeDateOnly"===t.type)}function qj(t){return null!=t&&("timestamp-offset"===t.type||"esriFieldTypeTimestampOffset"===t.type)}function Hj(t){return null!=t&&("time-only"===t.type||"esriFieldTypeTimeOnly"===t.type)}function Wj(t){return null!=t&&("oid"===t.type||"esriFieldTypeOID"===t.type)}function Zj(t){return null!=t&&("global-id"===t.type||"esriFieldTypeGlobalID"===t.type)}function Jj(t,e){return null===Xj(t,e)}var Yj,Kj;function Qj(t){return null==t||"number"==typeof t&&isNaN(t)?null:t}function Xj(t,e){return null==t||t.nullable&&null===e?null:Uj(t)&&!tO(t.type,Number(e))?Yj.OUT_OF_RANGE:Oj(t,e)?t.domain?jE(t,e):null:Kj.INVALID_TYPE}function tO(t,e){const i="string"==typeof t?iO(t):t;if(!i)return!1;const n=i.min,s=i.max;return i.isInteger?Number.isInteger(e)&&e>=n&&e<=s:e>=n&&e<=s}function eO(t,e){const i=OE(t,e);return i||(Uj(t)?iO(t.type):void 0)}function iO(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return nO;case"esriFieldTypeInteger":case"integer":return sO;case"esriFieldTypeBigInteger":case"big-integer":return rO;case"esriFieldTypeSingle":case"single":return oO;case"esriFieldTypeDouble":case"double":return aO}}!function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"}(Yj||(Yj={})),function(t){t.INVALID_TYPE="type-validation-error::invalid-type"}(Kj||(Kj={}));const nO={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},sO={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},rO={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},oO={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},aO={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function lO(t,e,i){switch(t){case TE.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case TE.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case Kj.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case Yj.OUT_OF_RANGE:{const{min:t,max:n}=iO(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${t} to ${n}`}}}function uO(t,e){return!cO(t,e,null)}function cO(t,e,i){if(!e?.attributes||!t){if(null!=i)for(const e of t??[])i.add(e);return!0}const n=new Set(Object.keys(e.attributes));let s=!1;for(const e of t)if(!n.has(e)){if(s=!0,null==i)break;i.add(e)}return s}function hO(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some((e=>t.toLowerCase().startsWith(e)))}async function dO(t,e){const i=new Set;return t?.collectRequiredFields&&await t.collectRequiredFields(i,e),Array.from(i).sort()}function fO(t){const e=t?.match(/{[^}]+}/g);return e?e.map((t=>t.slice(1,-1).split(":")[0].trim())):[]}let pO=class extends Io{constructor(t){super(t),this.type=null}};r([Je({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],pO.prototype,"type",void 0),pO=r([ln("esri.popup.content.Content")],pO);const mO=pO;var yO;let gO=yO=class extends mO{constructor(t){super(t),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new yO({description:this.description,displayType:this.displayType,title:this.title})}};r([Je({type:String,json:{write:!0}})],gO.prototype,"description",void 0),r([Je({type:["auto","preview","list"],json:{write:!0}})],gO.prototype,"displayType",void 0),r([Je({type:String,json:{write:!0}})],gO.prototype,"title",void 0),r([Je({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],gO.prototype,"type",void 0),gO=yO=r([ln("esri.popup.content.AttachmentsContent")],gO);const vO=gO;var wO;let bO=wO=class extends mO{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new wO({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?nt(this.outFields):null})}};r([Je()],bO.prototype,"creator",void 0),r([Je()],bO.prototype,"destroyer",void 0),r([Je()],bO.prototype,"outFields",void 0),r([Je({type:["custom"],readOnly:!0})],bO.prototype,"type",void 0),bO=wO=r([ln("esri.popup.content.CustomContent")],bO);const SO=bO;var _O;let xO=_O=class extends Io{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new _O({title:this.title,expression:this.expression})}};r([Je({type:String,json:{write:!0}})],xO.prototype,"title",void 0),r([Je({type:String,json:{write:!0}})],xO.prototype,"expression",void 0),r([Je({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],xO.prototype,"returnType",void 0),xO=_O=r([ln("esri.popup.ElementExpressionInfo")],xO);const MO=xO;var TO;let AO=TO=class extends mO{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new TO({expressionInfo:this.expressionInfo?.clone()})}};r([Je({type:MO,json:{write:!0}})],AO.prototype,"expressionInfo",void 0),r([Je({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],AO.prototype,"type",void 0),AO=TO=r([ln("esri.popup.content.ExpressionContent")],AO);const IO=AO;let kO=class extends(cm(Io)){constructor(t){super(t),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};r([NA(Rg)],kO.prototype,"dateFormat",void 0),r([Je({type:Boolean,json:{write:!0}})],kO.prototype,"digitSeparator",void 0),r([Je({type:ce,json:{write:!0}})],kO.prototype,"places",void 0),kO=r([ln("esri.popup.support.FieldInfoFormat")],kO);const CO=kO;var EO;let jO=EO=class extends Io{constructor(t){super(t),this.fieldName=null,this.format=void 0,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new EO({fieldName:this.fieldName,format:this.format?.clone(),isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};r([Je({type:String,json:{write:!0}})],jO.prototype,"fieldName",void 0),r([Je({type:CO,json:{write:!0}})],jO.prototype,"format",void 0),r([Je({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],jO.prototype,"isEditable",void 0),r([Je({type:String,json:{write:!0}})],jO.prototype,"label",void 0),r([NA(new Co({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],jO.prototype,"stringFieldOption",void 0),r([Je({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],jO.prototype,"statisticType",void 0),r([Je({type:String,json:{write:!0}})],jO.prototype,"tooltip",void 0),r([Je({type:Boolean,json:{write:!0}})],jO.prototype,"visible",void 0),jO=EO=r([ln("esri.popup.FieldInfo")],jO);const OO=jO;var RO;let LO=RO=class extends mO{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map((t=>t.toJSON()))}clone(){return new RO(nt({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};r([Je({type:Object,json:{write:!0}})],LO.prototype,"attributes",void 0),r([Je({type:String,json:{write:!0}})],LO.prototype,"description",void 0),r([Je({type:[OO]})],LO.prototype,"fieldInfos",void 0),r([yh("fieldInfos")],LO.prototype,"writeFieldInfos",null),r([Je({type:String,json:{write:!0}})],LO.prototype,"title",void 0),r([Je({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],LO.prototype,"type",void 0),LO=RO=r([ln("esri.popup.content.FieldsContent")],LO);const NO=LO;let PO=class extends Io{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};r([Je({type:String,json:{write:!0}})],PO.prototype,"altText",void 0),r([Je({type:String,json:{write:!0}})],PO.prototype,"caption",void 0),r([Je({type:String,json:{write:!0}})],PO.prototype,"title",void 0),r([Je({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],PO.prototype,"type",void 0),PO=r([ln("esri.popup.content.mixins.MediaInfo")],PO);const FO=PO;var DO;let $O=DO=class extends ao{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new DO({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};r([Je()],$O.prototype,"color",void 0),r([Je()],$O.prototype,"fieldName",void 0),r([Je()],$O.prototype,"tooltip",void 0),r([Je()],$O.prototype,"value",void 0),$O=DO=r([ln("esri.popup.content.support.ChartMediaInfoValueSeries")],$O);const zO=$O;var UO;let BO=UO=class extends Io{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new UO({colors:nt(this.colors),fields:nt(this.fields),normalizeField:this.normalizeField,series:nt(this.series),tooltipField:this.tooltipField})}};r([Je({type:[RA],json:{type:[[ce]],write:!0}})],BO.prototype,"colors",void 0),r([Je({type:[String],json:{write:!0}})],BO.prototype,"fields",void 0),r([Je({type:String,json:{write:!0}})],BO.prototype,"normalizeField",void 0),r([Je({type:[zO],json:{read:!1}})],BO.prototype,"series",void 0),r([Je({type:String,json:{write:!0}})],BO.prototype,"tooltipField",void 0),BO=UO=r([ln("esri.popup.content.support.ChartMediaInfoValue")],BO);const GO=BO;let VO=class extends FO{constructor(t){super(t),this.type=null,this.value=void 0}};r([Je({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],VO.prototype,"type",void 0),r([Je({type:GO,json:{write:!0}})],VO.prototype,"value",void 0),VO=r([ln("esri.popup.content.mixins.ChartMediaInfo")],VO);const qO=VO;const HO=Oo()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var WO;let ZO=WO=class extends qO{constructor(t){super(t),this.type="bar-chart"}clone(){return new WO({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};r([Je({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:HO.write}})],ZO.prototype,"type",void 0),ZO=WO=r([ln("esri.popup.content.BarChartMediaInfo")],ZO);const JO=ZO;var YO;let KO=YO=class extends qO{constructor(t){super(t),this.type="column-chart"}clone(){return new YO({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};r([Je({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:HO.write}})],KO.prototype,"type",void 0),KO=YO=r([ln("esri.popup.content.ColumnChartMediaInfo")],KO);const QO=KO;var XO;let tR=XO=class extends Io{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new XO({linkURL:this.linkURL,sourceURL:this.sourceURL})}};r([Je({type:String,json:{write:!0}})],tR.prototype,"linkURL",void 0),r([Je({type:String,json:{write:!0}})],tR.prototype,"sourceURL",void 0),tR=XO=r([ln("esri.popup.content.support.ImageMediaInfoValue")],tR);const eR=tR;var iR;let nR=iR=class extends FO{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new iR({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};r([Je({type:Number,json:{write:!0}})],nR.prototype,"refreshInterval",void 0),r([Je({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],nR.prototype,"type",void 0),r([Je({type:eR,json:{write:!0}})],nR.prototype,"value",void 0),nR=iR=r([ln("esri.popup.content.ImageMediaInfo")],nR);const sR=nR;var rR;let oR=rR=class extends qO{constructor(t){super(t),this.type="line-chart"}clone(){return new rR({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};r([Je({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:HO.write}})],oR.prototype,"type",void 0),oR=rR=r([ln("esri.popup.content.LineChartMediaInfo")],oR);const aR=oR;var lR;let uR=lR=class extends qO{constructor(t){super(t),this.type="pie-chart"}clone(){return new lR({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};r([Je({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:HO.write}})],uR.prototype,"type",void 0),uR=lR=r([ln("esri.popup.content.PieChartMediaInfo")],uR);const cR=uR;const hR={base:FO,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":JO,"column-chart":QO,"line-chart":aR,"pie-chart":cR,image:sR}};var dR;let fR=dR=class extends mO{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map((t=>"image"===t.type?sR.fromJSON(t):"barchart"===t.type?JO.fromJSON(t):"columnchart"===t.type?QO.fromJSON(t):"linechart"===t.type?aR.fromJSON(t):"piechart"===t.type?cR.fromJSON(t):void 0)).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map((t=>t.toJSON()))}clone(){return new dR(nt({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};r([Je()],fR.prototype,"activeMediaInfoIndex",void 0),r([Je({type:Object,json:{write:!0}})],fR.prototype,"attributes",void 0),r([Je({type:String,json:{write:!0}})],fR.prototype,"description",void 0),r([Je({types:[hR]})],fR.prototype,"mediaInfos",void 0),r([ko("mediaInfos")],fR.prototype,"readMediaInfos",null),r([yh("mediaInfos")],fR.prototype,"writeMediaInfos",null),r([Je({type:String,json:{write:!0}})],fR.prototype,"title",void 0),r([Je({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],fR.prototype,"type",void 0),fR=dR=r([ln("esri.popup.content.MediaContent")],fR);const pR=fR;var mR;let yR=mR=class extends Io{constructor(t){super(t),this.field=null,this.order=null}clone(){return new mR({field:this.field,order:this.order})}};r([Je({type:String,json:{write:!0}})],yR.prototype,"field",void 0),r([Je({type:["asc","desc"],json:{write:!0}})],yR.prototype,"order",void 0),yR=mR=r([ln("esri.popup.support.RelatedRecordsInfoFieldOrder")],yR);const gR=yR;let vR=class extends(cm(mO)){constructor(t){super(t),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};r([Je({type:String,json:{write:!0}})],vR.prototype,"description",void 0),r([Je({type:Number,json:{type:ce,write:!0}})],vR.prototype,"displayCount",void 0),r([Je({type:["list"],json:{write:!0}})],vR.prototype,"displayType",void 0),r([Je({type:[gR],json:{write:!0}})],vR.prototype,"orderByFields",void 0),r([Je({type:Number,json:{type:ce,write:!0}})],vR.prototype,"relationshipId",void 0),r([Je({type:String,json:{write:!0}})],vR.prototype,"title",void 0),r([Je({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],vR.prototype,"type",void 0),vR=r([ln("esri.popup.content.RelationshipContent")],vR);const wR=vR;var bR;let SR=bR=class extends mO{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new bR({text:this.text})}};r([Je({type:String,json:{write:!0}})],SR.prototype,"text",void 0),r([Je({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],SR.prototype,"type",void 0),SR=bR=r([ln("esri.popup.content.TextContent")],SR);const _R=SR;let xR=class extends(cm(Io)){constructor(t){super(t),this.title=null,this.description=null,this.type=null,this.open=!1,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};r([Je({type:String,json:{write:!0}})],xR.prototype,"title",void 0),r([Je({type:String,json:{write:!0}})],xR.prototype,"description",void 0),r([Je({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],xR.prototype,"type",void 0),r([Je({type:Boolean,json:{read:!1}})],xR.prototype,"open",void 0),r([Je({type:Number,json:{type:ce,write:!0}})],xR.prototype,"associatedNetworkSourceId",void 0),r([Je({type:Number,json:{type:ce,write:!0}})],xR.prototype,"associatedAssetGroup",void 0),r([Je({type:Number,json:{type:ce,write:!0}})],xR.prototype,"associatedAssetType",void 0),xR=r([ln("esri.popup.support.UtilityNetworkAssociationType")],xR);const MR=xR;let TR=class extends(cm(mO)){constructor(t){super(t),this.description=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};r([Je({type:String,json:{write:!0}})],TR.prototype,"description",void 0),r([Je({type:String,json:{write:!0}})],TR.prototype,"title",void 0),r([Je({type:[MR],json:{write:!0}})],TR.prototype,"associationTypes",void 0),r([NA({utilityNetworkAssociations:"utility-network-associations"})],TR.prototype,"type",void 0),TR=r([ln("esri.popup.content.UtilityNetworkAssociationsContent")],TR);const AR=TR;const IR={base:null,key:"type",typeMap:{attachment:vO,media:pR,text:_R,expression:IO,field:NO,relationship:wR,utilityNetworkAssociations:AR}},kR={base:null,key:"type",typeMap:{attachment:vO,media:pR,text:_R,expression:IO,field:NO,relationship:wR}};var CR;let ER=CR=class extends Io{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new CR({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};r([Je({type:String,json:{write:!0}})],ER.prototype,"name",void 0),r([Je({type:String,json:{write:!0}})],ER.prototype,"title",void 0),r([Je({type:String,json:{write:!0}})],ER.prototype,"expression",void 0),r([Je({type:["string","number"],json:{write:!0}})],ER.prototype,"returnType",void 0),ER=CR=r([ln("esri.popup.ExpressionInfo")],ER);const jR=ER;var OR;let RR=OR=class extends Io{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new OR({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};r([Je({type:Boolean,json:{write:!0}})],RR.prototype,"returnTopmostRaster",void 0),r([Je({type:Boolean,json:{write:!0}})],RR.prototype,"showNoDataRecords",void 0),RR=OR=r([ln("esri.popup.LayerOptions")],RR);const LR=RR;var NR;let PR=NR=class extends Io{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new NR({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?nt(this.orderByFields):null})}};r([Je({type:Boolean,json:{write:!0}})],PR.prototype,"showRelatedRecords",void 0),r([Je({type:[gR],json:{write:!0}})],PR.prototype,"orderByFields",void 0),PR=NR=r([ln("esri.popup.RelatedRecordsInfo")],PR);const FR=PR;var DR;let $R=DR=class extends(dC(ao)){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new DR({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};r([Je()],$R.prototype,"active",void 0),r([Je()],$R.prototype,"className",void 0),r([Je()],$R.prototype,"disabled",void 0),r([Je()],$R.prototype,"icon",void 0),r([Je()],$R.prototype,"id",void 0),r([Je()],$R.prototype,"indicator",void 0),r([Je()],$R.prototype,"title",void 0),r([Je()],$R.prototype,"type",void 0),r([Je()],$R.prototype,"visible",void 0),$R=DR=r([ln("esri.support.actions.ActionBase")],$R);const zR=$R;var UR;let BR=UR=class extends zR{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new UR({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};r([Je()],BR.prototype,"image",void 0),BR=UR=r([ln("esri.support.actions.ActionButton")],BR);const GR=BR;var VR;let qR=VR=class extends zR{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new VR({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};r([Je()],qR.prototype,"image",void 0),r([Je()],qR.prototype,"value",void 0),qR=VR=r([ln("esri.support.actions.ActionToggle")],qR);const HR=qR;const WR="relationships/",ZR="expression/",JR=Vm.ofType({key:"type",defaultKeyValue:"button",base:zR,typeMap:{button:GR,toggle:HR}}),YR={base:mO,key:"type",typeMap:{media:pR,custom:SO,text:_R,attachments:vO,fields:NO,expression:IO,relationship:wR,utilityNetworkAssociations:AR}},KR=new Set(["attachments","fields","media","text","expression","relationship"]),QR=new Set([...KR,"utility-network-associations"]);let XR=class extends(cm(Io)){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(t){return Array.isArray(t)?t.map((t=>ue(YR,t))):"string"==typeof t||"function"==typeof t||t instanceof HTMLElement||Fs(t)?t:(jt.getLogger(this).error("content error","unsupported content value",{value:t}),null)}readContent(t,e){const{popupElements:i}=e;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(e.description,e.mediaInfos,i):this._readPopupInfo(e)}writeWebSceneContent(t,e,i,n){this._writePopupTemplateContent(t,e,n)}writeWebMapContent(t,e,i,n){this._writePopupTemplateContent(t,e,n)}writeFieldInfos(t,e,i,n){const{content:s}=this,r=Array.isArray(s)?s:null;if(t){const i=r?r.filter((t=>"fields"===t.type)):[],s=i.length&&i.every((t=>t.fieldInfos?.length));e.fieldInfos=t.filter(Boolean).map((t=>{const e=t.toJSON(n);return s&&(e.visible=!1),e}))}if(r)for(const t of r)"fields"===t.type&&this._writeFieldsContent(t,e)}writeLayerOptions(t,e,i,n){e[i]=!t||null===t.showNoDataRecords&&null===t.returnTopmostRaster?null:t.toJSON(n)}writeTitle(t,e){e.title=t||""}async collectRequiredFields(t,e){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(t,e,[...i,...this._getContentExpressionInfos(this.content,i)]),YE(t,e,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t){const e=new Set;return await this.collectRequiredFields(e,t),[...e].sort()}_writePopupTemplateContent(t,e,i){"string"!=typeof t?Array.isArray(t)&&(e.popupElements=t.filter((t=>"web-scene"===i?.origin?KR.has(t.type):QR.has(t.type))).map((t=>t?.toJSON(i))),e.popupElements.forEach((t=>{"attachments"===t.type?this._writeAttachmentContent(e):"media"===t.type?this._writeMediaContent(t,e):"text"===t.type?this._writeTextContent(t,e):"relationship"===t.type&&this._writeRelationshipContent(t,e)}))):e.description=t}_writeFieldsContent(t,e){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const i=nt(t.fieldInfos);Array.isArray(e.fieldInfos)?i.forEach((t=>{const i=e.fieldInfos.find((e=>e.fieldName?.toLowerCase()===t.fieldName?.toLowerCase()));i?i.visible=!0:e.fieldInfos.push(t)})):e.fieldInfos=i}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeRelationshipContent(t,e){const i=t.orderByFields?.map((e=>this._toFieldOrderJSON(e,t.relationshipId)))||[],n=[...e.relatedRecordsInfo?.orderByFields||[],...i];e.relatedRecordsInfo={showRelatedRecords:!0,...n?.length&&{orderByFields:n}}}_writeTextContent(t,e){!e.description&&t.text&&(e.description=t.text)}_writeMediaContent(t,e){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const i=nt(t.mediaInfos);Array.isArray(e.mediaInfos)?e.mediaInfos=[...e.mediaInfos,...i]:e.mediaInfos=i}_readPopupInfoElements(t,e,i){const n={description:!1,mediaInfos:!1};return i.map((i=>"media"===i.type?(i.mediaInfos||!e||n.mediaInfos||(i.mediaInfos=e,n.mediaInfos=!0),pR.fromJSON(i)):"text"===i.type?(i.text||!t||n.description||(i.text=t,n.description=!0),_R.fromJSON(i)):"attachments"===i.type?vO.fromJSON(i):"fields"===i.type?NO.fromJSON(i):"expression"===i.type?IO.fromJSON(i):"relationship"===i.type?wR.fromJSON(i):"utilityNetworkAssociations"===i.type?AR.fromJSON(i):void 0)).filter(Boolean)}_toRelationshipContent(t){const{field:e,order:i}=t;if(!e?.startsWith(WR))return null;const n=e.replace(WR,"").split("/");if(2!==n.length)return null;const s=parseInt(n[0],10),r=n[1];return"number"==typeof s&&r?wR.fromJSON({relationshipId:s,orderByFields:[{field:r,order:i}]}):null}_toFieldOrderJSON(t,e){const{order:i,field:n}=t;return{field:`${WR}${e}/${n}`,order:i}}_readPopupInfo({description:t,mediaInfos:e,showAttachments:i,relatedRecordsInfo:n={showRelatedRecords:!1}}){const s=[];t?s.push(new _R({text:t})):s.push(new NO),Array.isArray(e)&&e.length&&s.push(pR.fromJSON({mediaInfos:e})),i&&s.push(vO.fromJSON({displayType:"auto"}));const{showRelatedRecords:r,orderByFields:o}=n;return r&&o?.length&&o.forEach((t=>{const e=this._toRelationshipContent(t);e&&s.push(e)})),s.length?s:t}_getContentElementFields(t){const e=t?.type;if("attachments"===e)return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)];if("custom"===e)return t.outFields||[];if("fields"===e)return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...this._getFieldInfoFields(t.fieldInfos??this.fieldInfos)];if("media"===e){const e=t.mediaInfos||[];return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...e.reduce(((t,e)=>[...t,...this._getMediaInfoFields(e)]),[])]}return"text"===e?this._extractFieldNames(t.text):"relationship"===e||"utility-network-associations"===e?[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)]:[]}_getMediaInfoFields(t){const{caption:e,title:i,value:n}=t,s=n||{},{fields:r,normalizeField:o,tooltipField:a,sourceURL:l,linkURL:u}=s,c=[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(l),...this._extractFieldNames(u),...r??[]];return o&&c.push(o),a&&c.push(a),c}_getContentExpressionInfos(t,e){return Array.isArray(t)?t.reduce(((t,e)=>[...t,..."expression"===e.type&&e.expressionInfo?[e.expressionInfo]:[]]),e):[]}_getContentFields(t){return"string"==typeof t?this._extractFieldNames(t):Array.isArray(t)?t.reduce(((t,e)=>[...t,...this._getContentElementFields(e)]),[]):[]}async _collectExpressionInfoFields(t,e,i){i&&await Promise.all(i.map((i=>tj(t,e,i.expression))))}_getFieldInfoFields(t){return t?t.filter((({fieldName:t,visible:e})=>!(void 0!==e&&!e||!t||t.startsWith(WR)||t.startsWith(ZR)))).map((t=>t.fieldName)):[]}_getActionsFields(t){return t?t.toArray().reduce(((t,e)=>[...t,...this._getActionFields(e)]),[]):[]}_getActionFields(t){const{className:e,title:i,type:n}=t,s="button"===n||"toggle"===n?t.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(s)]}_getTitleFields(t){return"string"==typeof t?this._extractFieldNames(t):[]}_extractFieldNames(t){return fO(t).filter((t=>!(0===t.indexOf(WR)||0===t.indexOf(ZR))))}};r([Je({type:JR})],XR.prototype,"actions",void 0),r([Je()],XR.prototype,"content",void 0),r([Ah("content")],XR.prototype,"castContent",null),r([ko("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],XR.prototype,"readContent",null),r([yh("web-scene","content",{popupElements:{type:Vm.ofType(kR)},showAttachments:{type:Boolean},mediaInfos:{type:Vm.ofType(hR)},description:{type:String},relatedRecordsInfo:{type:FR}})],XR.prototype,"writeWebSceneContent",null),r([yh("content",{popupElements:{type:Vm.ofType(IR)},showAttachments:{type:Boolean},mediaInfos:{type:Vm.ofType(hR)},description:{type:String},relatedRecordsInfo:{type:FR}})],XR.prototype,"writeWebMapContent",null),r([Je({type:[jR],json:{write:!0}})],XR.prototype,"expressionInfos",void 0),r([Je({type:[OO]})],XR.prototype,"fieldInfos",void 0),r([yh("fieldInfos")],XR.prototype,"writeFieldInfos",null),r([Je({type:LR})],XR.prototype,"layerOptions",void 0),r([yh("layerOptions")],XR.prototype,"writeLayerOptions",null),r([Je({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],XR.prototype,"lastEditInfoEnabled",void 0),r([Je()],XR.prototype,"outFields",void 0),r([Je()],XR.prototype,"overwriteActions",void 0),r([Je()],XR.prototype,"returnGeometry",void 0),r([Je({json:{type:String}})],XR.prototype,"title",void 0),r([yh("title")],XR.prototype,"writeTitle",null),XR=r([ln("esri.PopupTemplate")],XR);const tL=XR;const eL=new Co({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let iL=0,nL=class extends Io{constructor(t){super(t),this.id="sym"+iL++,this.type=null,this.color=new RA([0,0,0,1])}readColor(t){return null!=t?.[0]?[t[0],t[1],t[2],t[3]/255]:t}async collectRequiredFields(t,e){}hash(){return JSON.stringify(this.toJSON())}clone(){}};r([Je({type:eL.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:eL.write}}})],nL.prototype,"type",void 0),r([Je({type:RA,json:{write:{allowNull:!0}}})],nL.prototype,"color",void 0),r([ko("color")],nL.prototype,"readColor",null),nL=r([ln("esri.symbols.Symbol")],nL);const sL=nL;var rL;let oL=rL=class extends sL{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if("CIMSymbolReference"===this.data?.type){const i=this.data.primitiveOverrides;if(i){const n=i.map((i=>{const n=i.valueExpressionInfo;return n?tj(t,e,n.expression):null}));await Promise.all(n)}}}clone(){return new rL({data:nt(this.data)})}hash(){return At(JSON.stringify(this.data)).toString()}};r([Je({json:{write:!1}})],oL.prototype,"color",void 0),r([Je({json:{write:!0}})],oL.prototype,"data",void 0),r([ko("data",["symbol"])],oL.prototype,"readData",null),r([yh("data",{})],oL.prototype,"writeData",null),r([NA({CIMSymbolReference:"cim"},{readOnly:!0})],oL.prototype,"type",void 0),oL=rL=r([ln("esri.symbols.CIMSymbol")],oL);const aL=oL;let lL=class extends Io{constructor(t){super(t),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(t,e,i){t||(e[i]=t)}};r([Je({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],lL.prototype,"enabled",void 0),r([yh("enabled")],lL.prototype,"writeEnabled",null),r([Je({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],lL.prototype,"type",void 0),lL=r([ln("esri.symbols.Symbol3DLayer")],lL);const uL=lL;function cL(t,e){const i=null!=e.transparency?$A(e.transparency):1,n=e.color;return n&&Array.isArray(n)?new RA([n[0]||0,n[1]||0,n[2]||0,i]):null}function hL(t,e){e.color=t.toJSON().slice(0,3);const i=DA(t.a);0!==i&&(e.transparency=i)}const dL={type:RA,json:{type:[ce],default:null,read:{source:["color","transparency"],reader:cL},write:{target:{color:{type:[ce]},transparency:{type:ce}},writer:hL}}},fL={type:Number,cast:tI,json:{write:!0}};let pL=class extends Io{constructor(t){super(t),this.color=new RA([0,0,0,1]),this.extensionLength=0,this.size=XA(1)}clone(){}cloneProperties(){return{color:nt(this.color),size:this.size,extensionLength:this.extensionLength}}};r([Je({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],pL.prototype,"type",void 0),r([Je(dL)],pL.prototype,"color",void 0),r([Je({...fL,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],pL.prototype,"extensionLength",void 0),r([Je(fL)],pL.prototype,"size",void 0),pL=r([ln("esri.symbols.edges.Edges3D")],pL);const mL=pL;var yL;let gL=yL=class extends mL{constructor(t){super(t),this.type="sketch"}clone(){return new yL(this.cloneProperties())}};r([NA({sketch:"sketch"},{readOnly:!0})],gL.prototype,"type",void 0),gL=yL=r([ln("esri.symbols.edges.SketchEdges3D")],gL);const vL=gL;var wL;let bL=wL=class extends mL{constructor(t){super(t),this.type="solid"}clone(){return new wL(this.cloneProperties())}};r([NA({solid:"solid"},{readOnly:!0})],bL.prototype,"type",void 0),bL=wL=r([ln("esri.symbols.edges.SolidEdges3D")],bL);const SL=bL;const _L={types:{key:"type",base:mL,typeMap:{solid:SL,sketch:vL}},json:{write:!0}};var xL;let ML=xL=class extends Io{constructor(t){super(t),this.color=null,this.emissiveFactor=null}clone(){const t={color:this.color?.clone()??null,emissiveFactor:this.emissiveFactor?Kv(this.emissiveFactor):null};return new xL(t)}};r([Je(dL)],ML.prototype,"color",void 0),r([Je({type:[Number],json:{write:!1}})],ML.prototype,"emissiveFactor",void 0),ML=xL=r([ln("esri.symbols.support.Symbol3DMaterial")],ML);var TL;let AL=TL=class extends uL{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new TL({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}};r([NA({Extrude:"extrude"},{readOnly:!0})],AL.prototype,"type",void 0),r([Je({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],AL.prototype,"size",void 0),r([Je({type:ML,json:{write:!0}})],AL.prototype,"material",void 0),r([Je({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],AL.prototype,"castShadows",void 0),r([Je(_L)],AL.prototype,"edges",void 0),AL=TL=r([ln("esri.symbols.ExtrudeSymbol3DLayer")],AL);const IL=AL;let kL=class extends sL{constructor(t){super(t),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};r([NA({esriSLS:"simple-line"},{readOnly:!0})],kL.prototype,"type",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],kL.prototype,"width",void 0),kL=r([ln("esri.symbols.LineSymbol")],kL);const CL=kL;const EL=["begin","end","begin-end"],jL=["arrow","circle","square","diamond","cross","x"];var OL;let RL=OL=class extends Io{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,n){e[i]="web-map"===n?.origin?"arrow":t}set color(t){this._set("color",t)}readColor(t){return null!=t?.[0]?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,n){"web-map"===n?.origin||(e[i]=t)}clone(){return new OL({color:nt(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};r([Je({type:["begin","end","begin-end"],json:{write:!0}})],RL.prototype,"placement",void 0),r([NA({"line-marker":"line-marker"},{readOnly:!0}),Je({json:{origins:{"web-map":{write:!1}}}})],RL.prototype,"type",void 0),r([Je({type:jL})],RL.prototype,"style",void 0),r([yh("style")],RL.prototype,"writeStyle",null),r([Je({type:RA,value:null,json:{write:{allowNull:!0}}})],RL.prototype,"color",null),r([ko("color")],RL.prototype,"readColor",null),r([yh("color")],RL.prototype,"writeColor",null),RL=OL=r([ln("esri.symbols.LineSymbolMarker")],RL);const LL=RL;var NL;const PL=new Co({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let FL=NL=class extends CL{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,n,s,r){if(t&&"string"!=typeof t)return t;const o={};return null!=t&&(o.style=t),null!=e&&(o.color=e),null!=i&&(o.width=tI(i)),null!=n&&(o.cap=n),null!=s&&(o.join=s),null!=r&&(o.miterLimit=tI(r)),o}clone(){return new NL({color:nt(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};r([NA({esriSLS:"simple-line"},{readOnly:!0})],FL.prototype,"type",void 0),r([Je({type:PL.apiValues,json:{read:PL.read,write:PL.write}})],FL.prototype,"style",void 0),r([Je({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&null==i?.origin})}}})],FL.prototype,"cap",void 0),r([Je({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&null==i?.origin})}}})],FL.prototype,"join",void 0),r([Je({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":LL}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],FL.prototype,"marker",void 0),r([Je({type:Number,json:{read:!1,write:!1}})],FL.prototype,"miterLimit",void 0),FL=NL=r([ln("esri.symbols.SimpleLineSymbol")],FL);const DL=FL;let $L=class extends sL{constructor(t){super(t),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};r([Je({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":DL}},json:{default:null,write:!0}})],$L.prototype,"outline",void 0),r([Je({type:["simple-fill","picture-fill"],readOnly:!0})],$L.prototype,"type",void 0),$L=r([ln("esri.symbols.FillSymbol")],$L);const zL=$L;let UL=class extends Io{constructor(t){super(t)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};r([Je({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],UL.prototype,"type",void 0),UL=r([ln("esri.symbols.patterns.LinePattern3D")],UL);const BL=UL;const GL=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var VL;const qL=Oo()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let HL=VL=class extends BL{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new VL(t)}};r([Je({type:["style"]})],HL.prototype,"type",void 0),r([NA(qL),Je({type:GL})],HL.prototype,"style",void 0),HL=VL=r([ln("esri.symbols.patterns.LineStylePattern3D")],HL);const WL=HL;let ZL=class extends Io{constructor(t){super(t),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};r([Je({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],ZL.prototype,"type",void 0),ZL=r([ln("esri.symbols.patterns.Pattern3D")],ZL);const JL=ZL;const YL=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var KL;let QL=KL=class extends JL{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new KL({style:this.style})}};r([Je({type:["style"]})],QL.prototype,"type",void 0),r([Je({type:YL,json:{read:!0,write:!0}})],QL.prototype,"style",void 0),QL=KL=r([ln("esri.symbols.patterns.StylePattern3D")],QL);const XL=QL;const tN={types:{key:"type",base:JL,typeMap:{style:XL}},json:{write:!0}},eN={types:{key:"type",base:BL,typeMap:{style:WL}},json:{write:!0}};const iN=new RA("white");new RA("black");const nN=new RA([255,255,255,0]);function sN(t){return 0===t.r&&0===t.g&&0===t.b}var rN;let oN=rN=class extends ML{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,emissiveFactor:this.emissiveFactor?Kv(this.emissiveFactor):null,colorMixMode:this.colorMixMode};return new rN(t)}};r([NA({multiply:"multiply",replace:"replace",tint:"tint"})],oN.prototype,"colorMixMode",void 0),oN=rN=r([ln("esri.symbols.support.Symbol3DFillMaterial")],oN);function aN(t,e=!1){return t<=Q?e?new Array(t).fill(0):new Array(t):new Float64Array(t)}function lN(t){return(J(t)?t.length:t.byteLength/8)<=Q?Array.from(t):new Float64Array(t)}function uN(t,e,i){return Array.isArray(t)?t.slice(e,e+i):t.subarray(e,e+i)}function cN(t){return t}function hN(t=NN){return cN([t[0],t[1],t[2],t[3],t[4],t[5]])}function dN(t,e,i,n,s,r,o=hN()){return o[0]=t,o[1]=e,o[2]=i,o[3]=n,o[4]=s,o[5]=r,o}function fN(t,e=hN()){return pN(t,0,t.length/3,e)}function pN(t,e,i,n=hN()){return kN(n,LN),wN(n,t,e,i),n}function mN(t,e=aN(24)){const[i,n,s,r,o,a]=t;return e[0]=i,e[1]=n,e[2]=s,e[3]=i,e[4]=n,e[5]=a,e[6]=i,e[7]=o,e[8]=s,e[9]=i,e[10]=o,e[11]=a,e[12]=r,e[13]=n,e[14]=s,e[15]=r,e[16]=n,e[17]=a,e[18]=r,e[19]=o,e[20]=s,e[21]=r,e[22]=o,e[23]=a,e}function yN(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new Od(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function gN(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function vN(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function wN(t,e,i=0,n=e.length/3){let s=t[0],r=t[1],o=t[2],a=t[3],l=t[4],u=t[5];for(let t=0;t<n;t++)s=Math.min(s,e[i+3*t]),r=Math.min(r,e[i+3*t+1]),o=Math.min(o,e[i+3*t+2]),a=Math.max(a,e[i+3*t]),l=Math.max(l,e[i+3*t+1]),u=Math.max(u,e[i+3*t+2]);t[0]=s,t[1]=r,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function bN(t){return t[0]>=t[3]?0:t[3]-t[0]}function SN(t){return t[1]>=t[4]?0:t[4]-t[1]}function _N(t){return t[2]>=t[5]?0:t[5]-t[2]}function xN(t){const e=bN(t),i=_N(t),n=SN(t);return Math.sqrt(e*e+i*i+n*n)}function MN(t,e=[0,0,0]){return e[0]=t[0]+bN(t)/2,e[1]=t[1]+SN(t)/2,e[2]=t[2]+_N(t)/2,e}function TN(t,e=[0,0,0]){return e[0]=bN(t),e[1]=SN(t),e[2]=_N(t),e}function AN(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function IN(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function kN(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function CN(t){return t?kN(t,LN):hN(LN)}function EN(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function jN(t,e,i,n,s){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=n,t[4]=s,t[5]=Number.POSITIVE_INFINITY,t}function ON(t){return 6===t.length}function RN(t,e,i){if(null==t||null==e)return t===e;if(!ON(t)||!ON(e))return!1;if(i){for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const LN=cN([1/0,1/0,1/0,-1/0,-1/0,-1/0]),NN=cN([0,0,0,0,0,0]);function PN(t,{isPrimitive:e,width:i,depth:n,height:s}){const r=e?10:1;if(null==i&&null==s&&null==n)return[r*t[0],r*t[1],r*t[2]];const o=Qv(i,n,s);let a;for(let e=0;e<3;e++){const i=o[e];if(null!=i){a=i/t[e];break}}for(let e=0;e<3;e++)null==o[e]&&(o[e]=t[e]*a);return o}const FN=dN(-.5,-.5,-.5,.5,.5,.5),DN=dN(-.5,-.5,0,.5,.5,1),$N=dN(-.5,-.5,0,.5,.5,.5);function zN(t){switch(t){case"sphere":case"cube":case"diamond":return FN;case"cylinder":case"cone":case"inverted-cone":return DN;case"tetrahedron":return $N;default:return}}const UN=["butt","square","round"],BN=[...UN,"none"],GN=["miter","bevel","round"];var VN;let qN=VN=class extends Io{constructor(t){super(t),this.color=new RA([0,0,0,1]),this.size=XA(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:null!=this.color?this.color.clone():null,size:this.size,pattern:null!=this.pattern?this.pattern.clone():null,patternCap:this.patternCap};return new VN(t)}};r([Je(dL)],qN.prototype,"color",void 0),r([Je(fL)],qN.prototype,"size",void 0),r([Je(eN)],qN.prototype,"pattern",void 0),r([Je({type:UN,json:{default:"butt",write:{overridePolicy(){return{enabled:null!=this.pattern}}}}})],qN.prototype,"patternCap",void 0),qN=VN=r([ln("esri.symbols.support.Symbol3DOutline")],qN);var HN;let WN=HN=class extends uL{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:null!=this.edges?this.edges.clone():null,enabled:this.enabled,material:null!=this.material?this.material.clone():null,pattern:null!=this.pattern?this.pattern.clone():null,castShadows:this.castShadows,outline:null!=this.outline?this.outline.clone():null};return new HN(t)}static fromSimpleFillSymbol(t){const e=t.outline&&t.outline.style&&"solid"!==t.outline.style?new WL({style:t.outline.style}):null,i={size:t.outline?.width??0,color:(t.outline?.color??iN).clone(),pattern:e};return e&&t.outline?.cap&&(i.patternCap=t.outline.cap),new HN({material:new oN({color:(t.color??nN).clone()}),pattern:t.style&&"solid"!==t.style?new XL({style:t.style}):null,outline:i})}};r([NA({Fill:"fill"},{readOnly:!0})],WN.prototype,"type",void 0),r([Je({type:oN,json:{write:!0}})],WN.prototype,"material",void 0),r([Je(tN)],WN.prototype,"pattern",void 0),r([Je({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],WN.prototype,"castShadows",void 0),r([Je({type:qN,json:{write:!0}})],WN.prototype,"outline",void 0),r([Je(_L)],WN.prototype,"edges",void 0),WN=HN=r([ln("esri.symbols.FillSymbol3DLayer")],WN);const ZN=WN;const JN=["none","underline","line-through"],YN=["normal","italic","oblique"],KN=["normal","lighter","bold","bolder"],QN={type:Number,cast:t=>{const e=Ut(t);return 0===e?1:wf(e,.1,4)},nonNullable:!0},XN=["left","right","center"],tP=["baseline","top","middle","bottom"],eP={type:XN,nonNullable:!0},iP={type:tP,nonNullable:!0},nP=8;var sP;let rP=sP=class extends Io{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return tI(t)}clone(){return new sP({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};r([Je({type:JN,json:{default:"none",write:!0}})],rP.prototype,"decoration",void 0),r([Je({type:String,json:{write:!0}})],rP.prototype,"family",void 0),r([Je({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],rP.prototype,"size",void 0),r([Ah("size")],rP.prototype,"castSize",null),r([Je({type:YN,json:{default:"normal",write:!0}})],rP.prototype,"style",void 0),r([Je({type:KN,json:{default:"normal",write:!0}})],rP.prototype,"weight",void 0),rP=sP=r([ln("esri.symbols.Font")],rP);const oP=rP;var aP;const lP=Oo()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let uP=aP=class extends Io{constructor(t){super(t)}readHref(t,e,i){return t?gT(t,i):e.dataURI}writeHref(t,e,i,n){t&&(La(t)?e.dataURI=t:(e.href=vT(t,n),Oa(e.href)&&(e.href=Ca(e.href))))}clone(){return new aP({href:this.href,primitive:this.primitive})}};r([Je({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],uP.prototype,"href",void 0),r([ko("href")],uP.prototype,"readHref",null),r([yh("href",{href:{type:String},dataURI:{type:String}})],uP.prototype,"writeHref",null),r([NA(lP)],uP.prototype,"primitive",void 0),uP=aP=r([ln("esri.symbols.support.IconSymbol3DLayerResource")],uP);const cP="circle";var hP;let dP=hP=class extends ao{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new hP({x:this.x,y:this.y})}};r([Je({type:Number})],dP.prototype,"x",void 0),r([Je({type:Number})],dP.prototype,"y",void 0),dP=hP=r([ln("esri.symbols.support.Symbol3DAnchorPosition2D")],dP);var fP;let pP=fP=class extends Io{constructor(t){super(t),this.color=new RA([0,0,0,1]),this.size=XA(1)}clone(){const t={color:null!=this.color?this.color.clone():null,size:this.size};return new fP(t)}};r([Je(dL)],pP.prototype,"color",void 0),r([Je(fL)],pP.prototype,"size",void 0),pP=fP=r([ln("esri.symbols.support.Symbol3DIconOutline")],pP);var mP;const yP="esri.symbols.IconSymbol3DLayer";let gP=mP=class extends uL{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0}clone(){return new mP({anchor:this.anchor,anchorPosition:nt(this.anchorPosition),enabled:this.enabled,material:nt(this.material),outline:nt(this.outline),resource:nt(this.resource),angle:this.angle,size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||iN,i=wP(t),n=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||iN).clone()}:null;return new mP({size:t.size,angle:t.angle,resource:{primitive:_P(t.style)},material:{color:e},outline:n,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||sN(t.color)?iN:t.color,i=wP(t);return new mP({size:t.width<=t.height?t.height:t.width,angle:t.angle,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new mP({resource:{href:$a({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};r([Je({type:ML,json:{write:!0}})],gP.prototype,"material",void 0),r([Je({type:uP,json:{write:!0}})],gP.prototype,"resource",void 0),r([NA({Icon:"icon"},{readOnly:!0})],gP.prototype,"type",void 0),r([Je(fL)],gP.prototype,"size",void 0),r([NA({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],gP.prototype,"anchor",void 0),r([Je({type:dP,json:{type:[Number],read:{reader:t=>new dP({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],gP.prototype,"anchorPosition",void 0),r([Je({type:pP,json:{write:!0}})],gP.prototype,"outline",void 0),r([Je({type:Number,json:{write:!0,default:0}})],gP.prototype,"angle",void 0),gP=mP=r([ln(yP)],gP);const vP=gP;function wP(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,n=bP(t.xoffset),s=bP(t.yoffset);return(n||s)&&e&&i?{x:-n/e,y:s/i}:null}function bP(t){return isFinite(t)?t:0}const SP={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function _P(t){const e=SP[t];return e||(jt.getLogger(yP).warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}let xP=class extends(cm(Io)){constructor(t){super(t),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(t){return null!=t&&t.placement===this.placement&&t.style===this.style&&(null==this.color&&null==t.color||null!=this.color&&null!=t.color&&this.color.toJSON()===t.color.toJSON())}};r([Je({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],xP.prototype,"type",void 0),r([Je({type:EL,json:{default:"begin-end",write:!0}})],xP.prototype,"placement",void 0),r([Je({type:jL,json:{default:"arrow",write:!0}})],xP.prototype,"style",void 0),r([Je({type:RA,json:{type:[ce],default:null,write:!0}})],xP.prototype,"color",void 0),xP=r([ln("esri.symbols.LineStyleMarker3D")],xP);const MP=xP;var TP;let AP=TP=class extends uL{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=XA(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:null!=this.material?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:null!=this.pattern?this.pattern.clone():null,marker:null!=this.marker?this.marker.clone():null};return new TP(t)}static fromSimpleLineSymbol(t){const e={enabled:!0,size:t.width??XA(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style?new WL({style:t.style}):null,material:new ML({color:(t.color||iN).clone()}),marker:t.marker?new MP({placement:t.marker.placement,style:t.marker.style,color:t.marker.color?.clone()??null}):null};return new TP(e)}};r([Je({type:ML,json:{write:!0}})],AP.prototype,"material",void 0),r([NA({Line:"line"},{readOnly:!0})],AP.prototype,"type",void 0),r([Je({type:GN,json:{write:!0,default:"miter"}})],AP.prototype,"join",void 0),r([Je({type:UN,json:{write:!0,default:"butt"}})],AP.prototype,"cap",void 0),r([Je(fL)],AP.prototype,"size",void 0),r([Je(eN)],AP.prototype,"pattern",void 0),r([Je({types:{key:"type",base:MP,typeMap:{style:MP}},json:{write:!0}})],AP.prototype,"marker",void 0),AP=TP=r([ln("esri.symbols.LineSymbol3DLayer")],AP);const IP=AP;var kP;const CP=Oo()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let EP=kP=class extends Io{clone(){return new kP({href:this.href,primitive:this.primitive})}};r([Je({type:String,json:{read:wT,write:bT}})],EP.prototype,"href",void 0),r([NA(CP)],EP.prototype,"primitive",void 0),EP=kP=r([ln("esri.symbols.support.ObjectSymbol3DLayerResource")],EP);const jP="sphere";var OP;let RP=OP=class extends ao{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new OP({x:this.x,y:this.y,z:this.z})}};r([Je({type:Number})],RP.prototype,"x",void 0),r([Je({type:Number})],RP.prototype,"y",void 0),r([Je({type:Number})],RP.prototype,"z",void 0),RP=OP=r([ln("esri.symbols.support.Symbol3DAnchorPosition3D")],RP);var LP;let NP=LP=class extends uL{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new LP({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||"string"!=typeof this.resource.href}};r([Je({type:ML,json:{write:!0}})],NP.prototype,"material",void 0),r([Je({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],NP.prototype,"castShadows",void 0),r([Je({type:EP,json:{write:!0}})],NP.prototype,"resource",void 0),r([NA({Object:"object"},{readOnly:!0})],NP.prototype,"type",void 0),r([Je({type:Number,json:{write:!0}})],NP.prototype,"width",void 0),r([Je({type:Number,json:{write:!0}})],NP.prototype,"height",void 0),r([Je({type:Number,json:{write:!0}})],NP.prototype,"depth",void 0),r([NA({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],NP.prototype,"anchor",void 0),r([Je({type:RP,json:{type:[Number],read:{reader:t=>new RP({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],NP.prototype,"anchorPosition",void 0),r([Je({type:Number,json:{write:!0}})],NP.prototype,"heading",void 0),r([Je({type:Number,json:{write:!0}})],NP.prototype,"tilt",void 0),r([Je({type:Number,json:{write:!0}})],NP.prototype,"roll",void 0),r([Je({readOnly:!0})],NP.prototype,"isPrimitive",null),NP=LP=r([ln("esri.symbols.ObjectSymbol3DLayer")],NP);const PP=NP;var FP;let DP=FP=class extends uL{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return null!=t?t:null==e.height&&null!=e.size?e.size:void 0}readHeight(t,e){return null!=t?t:null==e.width&&null!=e.size?e.size:void 0}clone(){return new FP({enabled:this.enabled,material:null!=this.material?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};r([Je({type:ML,json:{write:!0}})],DP.prototype,"material",void 0),r([Je({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],DP.prototype,"castShadows",void 0),r([NA({Path:"path"},{readOnly:!0})],DP.prototype,"type",void 0),r([Je({type:["circle","quad"],json:{write:!0,default:"circle"}})],DP.prototype,"profile",void 0),r([Je({type:GN,json:{write:!0,default:"miter"}})],DP.prototype,"join",void 0),r([Je({type:BN,json:{write:!0,default:"butt"}})],DP.prototype,"cap",void 0),r([Je({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],DP.prototype,"width",void 0),r([ko("width",["width","size","height"])],DP.prototype,"readWidth",null),r([Je({type:Number,json:{write:!0}})],DP.prototype,"height",void 0),r([ko("height",["height","size","width"])],DP.prototype,"readHeight",null),r([Je({type:["center","bottom","top"],json:{write:!0,default:"center"}})],DP.prototype,"anchor",void 0),r([Je({type:["heading","all"],json:{write:!0,default:"all"}})],DP.prototype,"profileRotation",void 0),DP=FP=r([ln("esri.symbols.PathSymbol3DLayer")],DP);const $P=DP;var zP;let UP=zP=class extends Io{constructor(){super(...arguments),this.color=new RA([0,0,0,1]),this.size=0}clone(){const t={color:nt(this.color),size:this.size};return new zP(t)}};r([Je(dL)],UP.prototype,"color",void 0),r([Je(fL)],UP.prototype,"size",void 0),UP=zP=r([ln("esri.symbols.support.Symbol3DHalo")],UP);let BP=class extends(cm(Io)){constructor(t){super(t),this.color=null}};r([Je(dL)],BP.prototype,"color",void 0),BP=r([ln("esri.symbols.support.Symbol3DTextBackground")],BP);var GP;let VP=GP=class extends uL{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){null!=t&&null!=this._userSize&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,n){const s={...n,textSymbol3D:!0};e.font=t.write({},s),delete e.font.size}get size(){return null!=this._userSize?this._userSize:null!=this.font?.size?this.font.size:9}set size(t){this._userSize=t,null!=this.font&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new GP({enabled:this.enabled,font:this.font&&nt(this.font),halo:this.halo&&nt(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:null!=this.material?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:nt(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new GP({font:null!=t.font?t.font.clone():new oP,halo:qP(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new ML({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new BP({color:t.backgroundColor.clone()}):null})}};function qP(t,e){return t&&null!=e&&e>0?new UP({color:nt(t),size:e}):null}r([Je({type:oP,json:{write:!0}})],VP.prototype,"font",null),r([yh("font")],VP.prototype,"writeFont",null),r([Je({type:UP,json:{write:!0}})],VP.prototype,"halo",void 0),r([Je({...eP,json:{default:"center",write:!0}})],VP.prototype,"horizontalAlignment",void 0),r([Je({...QN,json:{default:1,write:!0}})],VP.prototype,"lineHeight",void 0),r([Je({type:ML,json:{write:!0}})],VP.prototype,"material",void 0),r([Je({type:BP,json:{write:!0}})],VP.prototype,"background",void 0),r([Je(fL)],VP.prototype,"size",null),r([Je({type:String,json:{write:!0}})],VP.prototype,"text",void 0),r([NA({Text:"text"},{readOnly:!0})],VP.prototype,"type",void 0),r([Je({...iP,json:{default:"baseline",write:!0}})],VP.prototype,"verticalAlignment",void 0),VP=GP=r([ln("esri.symbols.TextSymbol3DLayer")],VP);const HP=VP;var WP;let ZP=WP=class extends uL{constructor(t){super(t),this.color=YP.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new WP({color:nt(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};r([Je({type:RA,nonNullable:!0,json:{type:[ce],write:(t,e,i)=>e[i]=t.toArray(RA.AlphaMode.UNLESS_OPAQUE),default:()=>YP.clone(),defaultEquals:t=>t.toCss(!0)===YP.toCss(!0)}})],ZP.prototype,"color",void 0),r([NA({Water:"water"},{readOnly:!0})],ZP.prototype,"type",void 0),r([Je({type:["small","medium","large"],json:{write:!0,default:"medium"}})],ZP.prototype,"waterbodySize",void 0),r([Je({type:Number,json:{write:!0,default:null}})],ZP.prototype,"waveDirection",void 0),r([Je({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],ZP.prototype,"waveStrength",void 0),ZP=WP=r([ln("esri.symbols.WaterSymbol3DLayer")],ZP);const JP=ZP,YP=new RA([0,119,190]);var KP;let QP=KP=class extends ao{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new KP({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};r([Je({type:String})],QP.prototype,"name",void 0),r([Je({type:String})],QP.prototype,"styleUrl",void 0),r([Je({type:String})],QP.prototype,"styleName",void 0),r([Je({type:uT})],QP.prototype,"portal",void 0),QP=KP=r([ln("esri.symbols.support.StyleOrigin")],QP);const XP=QP;var tF;let eF=tF=class extends ao{constructor(){super(...arguments),this.url=""}clone(){return new tF({url:this.url})}};r([Je({type:String})],eF.prototype,"url",void 0),eF=tF=r([ln("esri.symbols.support.Thumbnail")],eF);const iF={icon:vP,object:PP,line:IP,path:$P,fill:ZN,extrude:IL,text:HP,water:JP},nF=Vm.ofType({base:uL,key:"type",typeMap:iF,errorContext:"symbol-layer"});let sF=class extends sL{constructor(t){super(t),this.styleOrigin=null,this.thumbnail=null,this.type=null;const e=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,i=e?.type,n=i||Vm;this._set("symbolLayers",new n)}get color(){return null}set color(t){this.constructed&&jt.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(t){AM(t,this._get("symbolLayers"))}readStyleOrigin(t,e,i){if(t.styleUrl&&t.name){const e=gT(t.styleUrl,i);return new XP({styleUrl:e,name:t.name})}if(t.styleName&&t.name)return new XP({portal:i?.portal||uT.getDefault(),styleName:t.styleName,name:t.name});i?.messages&&i.messages.push(new wi("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:t}))}writeStyleOrigin(t,e,i,n){if(t.styleUrl&&t.name){let i=vT(t.styleUrl,n);Oa(i)&&(i=Ca(i)),e.styleOrigin={styleUrl:i,name:t.name}}else t.styleName&&t.name&&(t.portal&&n?.portal&&!Sa(t.portal.restUrl,n.portal.restUrl)?n?.messages&&n.messages.push(new wi("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):e.styleOrigin={styleName:t.styleName,name:t.name})}normalizeCtorArgs(t){return t instanceof uL||t&&iF[t.type]?{symbolLayers:[t]}:Array.isArray(t)?{symbolLayers:t}:t}};r([Je({json:{read:!1,write:!1}})],sF.prototype,"color",null),r([Je({type:nF,nonNullable:!0,json:{write:!0}}),Ah(IM)],sF.prototype,"symbolLayers",null),r([Je({type:XP})],sF.prototype,"styleOrigin",void 0),r([ko("styleOrigin")],sF.prototype,"readStyleOrigin",null),r([yh("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],sF.prototype,"writeStyleOrigin",null),r([Je({type:eF,json:{read:!1}})],sF.prototype,"thumbnail",void 0),r([Je({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],sF.prototype,"type",void 0),sF=r([ln("esri.symbols.Symbol3D")],sF);const rF=sF;let oF=class extends Io{constructor(t){super(t),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};r([Je({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],oF.prototype,"type",void 0),r([Je({readOnly:!0})],oF.prototype,"visible",void 0),oF=r([ln("esri.symbols.callouts.Callout3D")],oF);const aF=oF;var lF;let uF=lF=class extends Io{constructor(t){super(t),this.color=new RA("white")}clone(){return new lF({color:nt(this.color)})}};r([Je(dL)],uF.prototype,"color",void 0),uF=lF=r([ln("esri.symbols.callouts.LineCallout3DBorder")],uF);const cF=uF;var hF;let dF=hF=class extends aF{constructor(t){super(t),this.type="line",this.color=new RA([0,0,0,1]),this.size=XA(1),this.border=null}get visible(){return this.size>0&&null!=this.color&&this.color.a>0}clone(){return new hF({color:nt(this.color),size:this.size,border:nt(this.border)})}};r([NA({line:"line"})],dF.prototype,"type",void 0),r([Je(dL)],dF.prototype,"color",void 0),r([Je(fL)],dF.prototype,"size",void 0),r([Je({type:cF,json:{write:!0}})],dF.prototype,"border",void 0),r([Je({readOnly:!0})],dF.prototype,"visible",null),dF=hF=r([ln("esri.symbols.callouts.LineCallout3D")],dF);const fF=dF;function pF(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||null!=e.maxWorldLength&&e.maxWorldLength<=0)}function mF(t){if(!t)return!1;if(!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&(!!e.visible&&!!pF(t))}const yF={types:{key:"type",base:aF,typeMap:{line:fF}},json:{write:!0}};var gF;let vF=gF=class extends Io{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new gF({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};r([Je(fL)],vF.prototype,"screenLength",void 0),r([Je({type:Number,nonNullable:!0,json:{write:!0,default:0}})],vF.prototype,"minWorldLength",void 0),r([Je({type:Number,json:{write:!0}})],vF.prototype,"maxWorldLength",void 0),vF=gF=r([ln("esri.symbols.support.Symbol3DVerticalOffset")],vF);const wF=vF;var bF;const SF=Vm.ofType({base:null,key:"type",typeMap:{text:HP}});let _F=bF=class extends rF{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new SF,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return mF(this)}hasVisibleVerticalOffset(){return pF(this)}clone(){return new bF({styleOrigin:nt(this.styleOrigin),symbolLayers:nt(this.symbolLayers),thumbnail:nt(this.thumbnail),callout:nt(this.callout),verticalOffset:nt(this.verticalOffset)})}static fromTextSymbol(t){return new bF({symbolLayers:new Vm([HP.fromTextSymbol(t)])})}};r([Je({type:wF,json:{write:!0}})],_F.prototype,"verticalOffset",void 0),r([Je(yF)],_F.prototype,"callout",void 0),r([Je({json:{read:!1,write:!1}})],_F.prototype,"styleOrigin",void 0),r([Je({type:SF})],_F.prototype,"symbolLayers",void 0),r([NA({LabelSymbol3D:"label-3d"},{readOnly:!0})],_F.prototype,"type",void 0),_F=bF=r([ln("esri.symbols.LabelSymbol3D")],_F);const xF=_F;var MF;const TF=Vm.ofType({base:null,key:"type",typeMap:{line:IP,path:$P}}),AF=Vm.ofType({base:null,key:"type",typeMap:{line:IP,path:$P}});let IF=MF=class extends rF{constructor(t){super(t),this.symbolLayers=new TF,this.type="line-3d"}clone(){return new MF({styleOrigin:nt(this.styleOrigin),symbolLayers:nt(this.symbolLayers),thumbnail:nt(this.thumbnail)})}static fromSimpleLineSymbol(t){return new MF({symbolLayers:new Vm([IP.fromSimpleLineSymbol(t)])})}};r([Je({type:TF,json:{type:AF}})],IF.prototype,"symbolLayers",void 0),r([NA({LineSymbol3D:"line-3d"},{readOnly:!0})],IF.prototype,"type",void 0),IF=MF=r([ln("esri.symbols.LineSymbol3D")],IF);const kF=IF;let CF=class extends sL{constructor(t){super(t),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};r([Je({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],CF.prototype,"angle",void 0),r([Je({type:["simple-marker","picture-marker"],readOnly:!0})],CF.prototype,"type",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],CF.prototype,"xoffset",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],CF.prototype,"yoffset",void 0),r([Je({cast:t=>"auto"===t?t:Ut(tI(t)),json:{write:!0}})],CF.prototype,"size",void 0),CF=r([ln("esri.symbols.MarkerSymbol")],CF);const EF=CF;var jF;const OF=Vm.ofType({base:null,key:"type",typeMap:{fill:ZN}});let RF=jF=class extends rF{constructor(t){super(t),this.symbolLayers=new OF,this.type="mesh-3d"}clone(){return new jF({styleOrigin:nt(this.styleOrigin),symbolLayers:nt(this.symbolLayers),thumbnail:nt(this.thumbnail)})}static fromSimpleFillSymbol(t){return new jF({symbolLayers:new Vm([ZN.fromSimpleFillSymbol(t)])})}};r([Je({type:OF})],RF.prototype,"symbolLayers",void 0),r([NA({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],RF.prototype,"type",void 0),RF=jF=r([ln("esri.symbols.MeshSymbol3D")],RF);const LF=RF;function NF(t,e,i){return e.imageData?$a({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):PF(e.url,i)}function PF(t,e){if(!Oa(t)){const i=zF(e);if(i)return Ea(i,"images",t)}return gT(t,e)}function FF(t,e,i,n){if(La(t)){const s=Da(t);if(!s)return;e.contentType=s.mediaType,e.imageData=s.data,i&&i.imageData===e.imageData&&i.url&&bT(i.url,e,"url",n)}else bT(t,e,"url",n)}const DF={json:{read:{source:["imageData","url"],reader:NF},write:{writer(t,e,i,n){FF(t,e,this.source,n)}}}},$F={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const n={};return e.imageData&&(n.imageData=e.imageData),e.contentType&&(n.contentType=e.contentType),e.url&&(n.url=PF(e.url,i)),n}}}};function zF(t){if(!t)return null;const{origin:e,layer:i}=t;if("service"!==e&&"portal-item"!==e)return null;const n=i?.type;return"feature"===n||"stream"===n?i.parsedUrl?.path:"map-image"===n||"tile"===n?t.url?.path:null}var UF;let BF=UF=class extends zL{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,n){if(t&&"string"!=typeof t&&null==t.imageData)return t;const s={};return t&&(s.url=t),e&&(s.outline=e),null!=i&&(s.width=tI(i)),null!=n&&(s.height=tI(n)),s}clone(){const t=new UF({color:nt(this.color),height:this.height,outline:nt(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",nt(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};r([NA({esriPFS:"picture-fill"},{readOnly:!0})],BF.prototype,"type",void 0),r([Je(DF)],BF.prototype,"url",void 0),r([Je({type:Number,json:{write:!0}})],BF.prototype,"xscale",void 0),r([Je({type:Number,json:{write:!0}})],BF.prototype,"yscale",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],BF.prototype,"width",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],BF.prototype,"height",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],BF.prototype,"xoffset",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],BF.prototype,"yoffset",void 0),r([Je($F)],BF.prototype,"source",void 0),BF=UF=r([ln("esri.symbols.PictureFillSymbol")],BF);const GF=BF;var VF;let qF=VF=class extends EF{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t&&null==t.imageData)return t;const n={};return t&&(n.url=t),null!=e&&(n.width=tI(e)),null!=i&&(n.height=tI(i)),n}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new VF({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",nt(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};r([Je({json:{write:!1}})],qF.prototype,"color",void 0),r([NA({esriPMS:"picture-marker"},{readOnly:!0})],qF.prototype,"type",void 0),r([Je(DF)],qF.prototype,"url",void 0),r([Je($F)],qF.prototype,"source",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],qF.prototype,"height",void 0),r([ko("height",["height","size"])],qF.prototype,"readHeight",null),r([Je({type:Number,cast:tI,json:{write:!0}})],qF.prototype,"width",void 0),r([Je({json:{write:!1}})],qF.prototype,"size",void 0),qF=VF=r([ln("esri.symbols.PictureMarkerSymbol")],qF);const HF=qF;var WF;const ZF=Vm.ofType({base:null,key:"type",typeMap:{icon:vP,object:PP,text:HP}});let JF=WF=class extends rF{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new ZF,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return mF(this)}hasVisibleVerticalOffset(){return pF(this)}clone(){return new WF({verticalOffset:nt(this.verticalOffset),callout:nt(this.callout),styleOrigin:nt(this.styleOrigin),symbolLayers:nt(this.symbolLayers),thumbnail:nt(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new WF({symbolLayers:new Vm([vP.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new WF({symbolLayers:new Vm([vP.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){const e=t.data?.symbol?.type;if("CIMPointSymbol"!==e)return null;const i=t.data.symbol;return new WF(i?.callout?{symbolLayers:new Vm([vP.fromCIMSymbol(t)]),callout:new fF({size:.5,color:new RA([0,0,0])}),verticalOffset:new wF({screenLength:40})}:{symbolLayers:new Vm([vP.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new WF({symbolLayers:new Vm([HP.fromTextSymbol(t)])})}};r([Je({type:wF,json:{write:!0}})],JF.prototype,"verticalOffset",void 0),r([Je(yF)],JF.prototype,"callout",void 0),r([Je({type:ZF,json:{origins:{"web-scene":{write:!0}}}})],JF.prototype,"symbolLayers",void 0),r([NA({PointSymbol3D:"point-3d"},{readOnly:!0})],JF.prototype,"type",void 0),JF=WF=r([ln("esri.symbols.PointSymbol3D")],JF);const YF=JF;var KF;const QF=Vm.ofType({base:null,key:"type",typeMap:{extrude:IL,fill:ZN,icon:vP,line:IP,object:PP,text:HP,water:JP}});let XF=KF=class extends rF{constructor(t){super(t),this.symbolLayers=new QF,this.type="polygon-3d"}initialize(){const t=t=>{"line"===t.type&&gn(jt.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),"text"===t.type&&gn(jt.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(sy((()=>this.symbolLayers),"after-add",(({item:e})=>t(e)),hy))}clone(){return new KF({styleOrigin:nt(this.styleOrigin),symbolLayers:nt(this.symbolLayers),thumbnail:nt(this.thumbnail)})}static fromJSON(t){const e=new KF;if(e.read(t),2===e.symbolLayers.length&&"fill"===e.symbolLayers.at(0).type&&"line"===e.symbolLayers.at(1).type){const i=e.symbolLayers.at(0),n=e.symbolLayers.at(1);!n.enabled||t.symbolLayers?.[1]&&!1===t.symbolLayers[1].enable||(i.outline={size:n.size,color:null!=n.material?n.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new KF({symbolLayers:new Vm([ZN.fromSimpleFillSymbol(t)])})}};r([Je({type:QF,json:{write:!0}})],XF.prototype,"symbolLayers",void 0),r([NA({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],XF.prototype,"type",void 0),XF=KF=r([ln("esri.symbols.PolygonSymbol3D")],XF);const tD=XF;var eD;const iD=new Co({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let nD=eD=class extends zL{constructor(...t){super(...t),this.color=new RA([0,0,0,.25]),this.outline=new DL,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const n={};return t&&(n.style=t),e&&(n.outline=e),i&&(n.color=i),n}clone(){return new eD({color:nt(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};r([Je()],nD.prototype,"color",void 0),r([Je()],nD.prototype,"outline",void 0),r([NA({esriSFS:"simple-fill"},{readOnly:!0})],nD.prototype,"type",void 0),r([Je({type:iD.apiValues,json:{read:iD.read,write:iD.write}})],nD.prototype,"style",void 0),nD=eD=r([ln("esri.symbols.SimpleFillSymbol")],nD);const sD=nD;var rD;const oD=new Co({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let aD=rD=class extends EF{constructor(...t){super(...t),this.color=new RA([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new DL}normalizeCtorArgs(t,e,i,n){if(t&&"string"!=typeof t)return t;const s={};return t&&(s.style=t),null!=e&&(s.size=tI(e)),i&&(s.outline=i),n&&(s.color=n),s}writeColor(t,e){t&&"x"!==this.style&&"cross"!==this.style&&(e.color=t.toJSON()),null===t&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new rD({angle:this.angle,color:nt(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};r([Je()],aD.prototype,"color",void 0),r([yh("color")],aD.prototype,"writeColor",null),r([NA({esriSMS:"simple-marker"},{readOnly:!0})],aD.prototype,"type",void 0),r([Je()],aD.prototype,"size",void 0),r([Je({type:oD.apiValues,json:{read:oD.read,write:oD.write}})],aD.prototype,"style",void 0),r([Je({type:String,json:{write:!0}})],aD.prototype,"path",null),r([Je({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":DL}},json:{default:null,write:!0}})],aD.prototype,"outline",void 0),aD=rD=r([ln("esri.symbols.SimpleMarkerSymbol")],aD);const lD=aD;var uD;let cD=uD=class extends sL{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new oP,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const n={};return t&&(n.text=t),e&&(n.font=e),i&&(n.color=i),n}writeLineWidth(t,e,i,n){n&&"string"!=typeof n?n.origin:e[i]=t}castLineWidth(t){return tI(t)}writeLineHeight(t,e,i,n){n&&"string"!=typeof n?n.origin:e[i]=t}clone(){return new uD({angle:this.angle,backgroundColor:nt(this.backgroundColor),borderLineColor:nt(this.borderLineColor),borderLineSize:this.borderLineSize,color:nt(this.color),font:this.font&&this.font.clone(),haloColor:nt(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};r([Je({type:RA,json:{write:!0}})],cD.prototype,"backgroundColor",void 0),r([Je({type:RA,json:{write:!0}})],cD.prototype,"borderLineColor",void 0),r([Je({type:Number,json:{write:!0},cast:tI})],cD.prototype,"borderLineSize",void 0),r([Je({type:oP,json:{write:!0}})],cD.prototype,"font",void 0),r([Je({...eP,json:{write:!0}})],cD.prototype,"horizontalAlignment",void 0),r([Je({type:Boolean,json:{write:!0}})],cD.prototype,"kerning",void 0),r([Je({type:RA,json:{write:!0}})],cD.prototype,"haloColor",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],cD.prototype,"haloSize",void 0),r([Je({type:Boolean,json:{write:!0}})],cD.prototype,"rightToLeft",void 0),r([Je({type:Boolean,json:{write:!0}})],cD.prototype,"rotated",void 0),r([Je({type:String,json:{write:!0}})],cD.prototype,"text",void 0),r([NA({esriTS:"text"},{readOnly:!0})],cD.prototype,"type",void 0),r([Je({...iP,json:{write:!0}})],cD.prototype,"verticalAlignment",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],cD.prototype,"xoffset",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],cD.prototype,"yoffset",void 0),r([Je({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],cD.prototype,"angle",void 0),r([Je({type:Number,json:{write:!0}})],cD.prototype,"width",void 0),r([Je({type:Number})],cD.prototype,"lineWidth",void 0),r([yh("lineWidth")],cD.prototype,"writeLineWidth",null),r([Ah("lineWidth")],cD.prototype,"castLineWidth",null),r([Je(QN)],cD.prototype,"lineHeight",void 0),r([yh("lineHeight")],cD.prototype,"writeLineHeight",null),cD=uD=r([ln("esri.symbols.TextSymbol")],cD);const hD=cD;var dD;let fD=dD=class extends sL{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=null!=this.portal?this.portal:uT.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new dD({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=null!=e?e.cache:null,n=i?this._fetchCacheKey:null;if(null!=i){const t=n&&i.get(n);if(t)return t.clone()}const{resolveWebStyleSymbol:s}=await Promise.resolve().then((function(){return Ext}));_s(e);const r=s(this,{portal:this.portal},t,e);r.catch((t=>{jt.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",t)}));const o=await r;return"webRef"===t&&"point-3d"===o.type||"cimRef"===t&&"cim"===o.type?(null!=i&&i.set(n,o.clone()),o):null}};r([Je({json:{write:!1}})],fD.prototype,"color",void 0),r([Je({type:String,json:{write:!0}})],fD.prototype,"styleName",void 0),r([Je({type:uT,json:{write:!1}})],fD.prototype,"portal",void 0),r([Je({type:String,json:{read:wT,write:bT}})],fD.prototype,"styleUrl",void 0),r([Je({type:eF,json:{read:!1}})],fD.prototype,"thumbnail",void 0),r([Je({type:String,json:{write:!0}})],fD.prototype,"name",void 0),r([NA({styleSymbolReference:"web-style"},{readOnly:!0})],fD.prototype,"type",void 0),r([Je()],fD.prototype,"_fetchCacheKey",null),fD=dD=r([ln("esri.symbols.WebStyleSymbol")],fD);const pD=fD;function mD(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function yD(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const gD={base:sL,key:"type",typeMap:{"simple-fill":sD,"picture-fill":GF,"picture-marker":HF,"simple-line":DL,"simple-marker":lD,text:hD,"label-3d":xF,"line-3d":kF,"mesh-3d":LF,"point-3d":YF,"polygon-3d":tD,"web-style":pD,cim:aL},errorContext:"symbol"},vD={base:sL,key:"type",typeMap:{"picture-marker":HF,"simple-marker":lD,"point-3d":YF,cim:aL},errorContext:"symbol"},wD={base:sL,key:"type",typeMap:{"simple-line":DL,"line-3d":kF,cim:aL},errorContext:"symbol"},bD={base:sL,key:"type",typeMap:{"simple-fill":sD,"picture-fill":GF,"polygon-3d":tD,cim:aL},errorContext:"symbol"},SD={base:sL,key:"type",typeMap:{"picture-marker":HF,"simple-marker":lD,text:hD,"web-style":pD,cim:aL},errorContext:"symbol"},_D=xi({types:gD}),xD={base:sL,key:"type",typeMap:{"simple-fill":sD,"picture-fill":GF,"picture-marker":HF,"simple-line":DL,"simple-marker":lD,text:hD,"line-3d":kF,"mesh-3d":LF,"point-3d":YF,"polygon-3d":tD,"web-style":pD,cim:aL},errorContext:"symbol"},MD={base:sL,key:"type",typeMap:{text:hD,"label-3d":xF},errorContext:"symbol"},TD={base:sL,key:"type",typeMap:{"line-3d":kF,"mesh-3d":LF,"point-3d":YF,"polygon-3d":tD,"web-style":pD,cim:aL},errorContext:"symbol"},AD={base:sL,key:"type",typeMap:{"label-3d":xF},errorContext:"symbol"},ID=ue(gD);var kD;function CD(t){if(!t)return null;const e={};for(const i in t){const n=rm(t[i]);n&&(e[i]=n)}return 0!==Object.keys(e).length?e:null}function ED(t){if(null==t)return null;const e={};for(const i in t){const n=t[i];n&&(e[i]=n.toJSON())}return 0!==Object.keys(e).length?e:null}let jD=kD=class extends(cm(Io)){constructor(t){super(t),this.isAggregate=!1,this.layer=null,this.origin=null,this.popupTemplate=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:Tr(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&yn(jt.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(t){const e=this._get("aggregateGeometries");JSON.stringify(e)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),"mesh"!==t?.type&&this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}get version(){return this._version}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}cloneShallow(){return new kD({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;const e=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[e,this.sourceLayer,this.layer])if(i){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(t&&"defaultPopupTemplate"in i&&null!=i.defaultPopupTemplate)return i.defaultPopupTemplate}return null}getAttribute(t){return this.attributes?.[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{aggregateGeometries:ED(this.aggregateGeometries),geometry:null!=this.geometry?this.geometry.toJSON():null,symbol:null!=this.symbol?this.symbol.toJSON():null,attributes:Ao(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(t={}){const{geometry:e}=this;if("mesh"===e?.type){const i={origin:e.origin,transform:e.transform};this._notifyLayer("origin-transform",i,i,t.action)}}_notifyLayer(t,e,i,n){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:t,oldValue:e,newValue:i};"origin-transform"===t&&(s.action=n),"attributes"===t&&(s.attributeName=n),this.layer.graphicChanged(s)}_watchMeshGeometryChanges(){this.addHandles([iy((()=>"mesh"===this.geometry?.type&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0),(({localMatrix:t,origin:e})=>{this._lastMeshTransform.localMatrix===t&&this._lastMeshTransform.origin===e||(this._lastMeshTransform.localMatrix=t,this._lastMeshTransform.origin=e,this.notifyMeshTransformChanged())})),iy((()=>"mesh"===this.geometry?.type?{vertexAttributes:this.geometry.vertexAttributes}:void 0),(()=>{const t=this.geometry;"mesh"===t?.type&&t.vertexSpace.origin?(this._lastMeshTransform.localMatrix=t.transform?.localMatrix,this._lastMeshTransform.origin=t.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)}),{equals:(t,e)=>t===e,sync:!0})])}};r([Je({value:null,json:{read:CD}})],jD.prototype,"aggregateGeometries",null),r([Je({value:null})],jD.prototype,"attributes",null),r([Je({value:null,types:um,json:{read:rm}})],jD.prototype,"geometry",null),r([Je({type:Boolean})],jD.prototype,"isAggregate",void 0),r([Je({clonable:"reference"})],jD.prototype,"layer",void 0),r([Je({clonable:"reference"})],jD.prototype,"origin",void 0),r([Je({type:tL})],jD.prototype,"popupTemplate",void 0),r([Je({clonable:"reference"})],jD.prototype,"sourceLayer",void 0),r([Je({value:null,types:gD})],jD.prototype,"symbol",null),r([Je({clonable:!1,json:{read:!1,write:!1}})],jD.prototype,"_version",void 0),r([Je({type:Boolean,value:!0})],jD.prototype,"visible",null),jD=kD=r([ln("esri.Graphic")],jD);const OD=jD;let RD=class extends PC{_own(t){t.layer&&"remove"in t.layer&&t.layer!==this.owner&&t.layer.remove(t),t.layer=this.owner}_release(t){t.layer===this.owner&&(t.layer=null)}};r([Im({Type:OD,ensureType:ee(OD)})],RD.prototype,"itemType",void 0),RD=r([ln("esri.support.GraphicsCollection")],RD);let LD=class extends ao{constructor(t){super(t),this.view=null,this.baseLayerViews=new Vm,this.referenceLayerViews=new Vm,this._loadingHandle=ey((()=>this.view?.map?.basemap),(t=>{t&&t.load().catch((()=>{}))}),dy)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const t of this.baseLayerViews)t.destroy();this.baseLayerViews.length=0;for(const t of this.referenceLayerViews)t.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){if(this.view?.suspended)return!1;const t=this.view?.map?.basemap;return!!t&&(!!t.loaded&&(this.baseLayerViews.some((t=>t.updating))||this.referenceLayerViews.some((t=>t.updating))))}};r([Je({constructOnly:!0})],LD.prototype,"view",void 0),r([Je({readOnly:!0})],LD.prototype,"baseLayerViews",void 0),r([Je({readOnly:!0})],LD.prototype,"referenceLayerViews",void 0),r([Je({readOnly:!0})],LD.prototype,"suspended",null),r([Je({type:Boolean,readOnly:!0})],LD.prototype,"updating",null),LD=r([ln("esri.views.BasemapView")],LD);const ND=LD;function PD(t){return"tryRecycleWith"in t}function FD(t){return null!=t&&"object"==typeof t&&"layerViews"in t}class DD{constructor(t,e,i){this.layer=t,this.view=e,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=zs(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,Is(this._controller.signal,(()=>{const e=new Ve("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(e)}))}tryRecycle(t){if(!this.done||!this.layerView||!PD(this.layerView))return null;const e=this.layer.type,i=this._controller.signal;for(let n=0;n<t.length;n++){const s=t[n];if(s.type!==e)continue;const r=this.layerView.tryRecycleWith(s,{signal:i});if(r){t.splice(n,1),this.layer=s;const e=this.layerView,i=e.view;return this.promise=Promise.race([r.then((()=>(_s(this._controller.signal),s.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{view:i,layerView:e}),s.emit("layerview-create",{view:i,layerView:e}),i.emit("layerview-create",{view:i,layerView:e}),e))),new Promise(((t,e)=>Is(this._controller.signal,(()=>e(Ss())))))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:t}=this;if(t){const{layer:e,view:i}=this;e.emit("layerview-destroy",{view:i,layerView:t}),i.emit("layerview-destroy",{layer:e,layerView:t})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:t},layer:e,view:i}=this;this._map=i.map;try{let n,s;if(await e.load({signal:t}),e.prefetchResources&&await e.prefetchResources({signal:t}),UD(e))n=await e.createLayerView(i,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(e))throw new Ve("layer:view-not-supported","No layerview implementation was found");const s=await this.layerViewImporter.importLayerView(e);_s(t),n="default"in s?new s.default({layer:e,view:i}):new s({layer:e,view:i})}const r=()=>{s=kn(s),n.destroyed||n.destroy(),n.layer=null,n.parent=null,n.view=null,this.done=!0};s=Is(t,r),_s(t);try{await n.when()}catch(t){throw r(),t}const o=this._map?.allLayers?.includes(e);if(!o)return r(),void this._deferred.reject(new Ve("view:no-layerview-for-layer","The layer has been removed from the map",{layer:e}));this.layerView=n,e.emit("layerview-create",{view:i,layerView:n}),i.emit("layerview-create",{layer:e,layerView:n}),this.done=!0,this._deferred.resolve(n)}catch(t){e.emit("layerview-create-error",{view:i,error:t}),i.emit("layerview-create-error",{layer:e,error:t}),this.done=!0,this._deferred.reject(new Ve("layerview:create-error","layerview creation failed",{layer:e,error:t}))}}}let $D=class extends ao{constructor(t){super(t),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new SS,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const t=this.view.map?.allLayers;if(t)for(const e of t)this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e)},this._reschedule=()=>this.destroyed?Promise.reject():(null==this._workPromise&&(this._workPromise=zs(),this._workPromise.promise.catch((()=>{}))),this.removeHandles("reschedule"),this.addHandles(er(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),null==this._workPromise)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const e=new Set,i=[],n=this.view.ready,s=t=>{if(null!=t)for(const r of t)if(r){e.add(r);const t=this._layerLayerViewInfoMap.get(r);t&&n?t.start():t||this._recyclingInfoMap.has(r)||i.push(r),"layers"in r&&r.layers&&s(r.layers)}};for(const t of this._rootCollectionNames)s(Ne(this,t));for(const[t,n]of this._layerLayerViewInfoMap)if(!e.has(t)){this._layerLayerViewInfoMap.delete(n.layer);const t=n.tryRecycle(i);t?(this.notifyChange("updating"),this._recyclingInfoMap.set(n.layer,n),t.then((()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(n.layer),this._layerLayerViewInfoMap.set(n.layer,n),this._reschedule()})).catch((()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(n.layer),n.destroy(),this._reschedule()}))):n.destroy()}for(const[t,i]of this._recyclingInfoMap)e.has(t)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(i.layer),i.destroy());for(const t of i)this._createLayerView(t);this._refreshCollections();const r=[t?.ground?.layers,t?.basemap?.baseLayers,t?.basemap?.referenceLayers,t?.layers].filter((t=>!!t));e.forEach((t=>"layers"in t&&r.push(t.layers))),this.addHandles(r.map((t=>this._watchUpdatingTracking.addOnCollectionChange((()=>t),this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([sy((()=>this.view?.map?.allLayers),"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),ey((()=>{const t=this.view,e=t?.map;return[e?.basemap,e?.ground,e?.layers,t?.ready]}),(()=>this._reschedule()),fy)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),lC(this._recyclingInfoMap),lC(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,null!=this._workPromise&&(this._workPromise.reject(Ss()),this._workPromise=null)}get _layersToLayerViews(){const t=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&t.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(t)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return null!=this._workPromise||this._watchUpdatingTracking.updating||Lt(this._layerLayerViewInfoMap,(t=>!t.done))||this._recyclingInfoMap.size>0}get updatingRemaining(){let t=0;for(const e of this._layerLayerViewInfoMap.values())e.done||++t;return t}clear(){this.destroyed||(lC(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(t){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(t)){if(this._recyclingInfoMap.has(t))return this._recyclingInfoMap.get(t).promise;throw new Ve("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t})}return this._layerLayerViewInfoMap.get(t).promise}isCreatingLayerViewsForLayer(t,e){this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(t);if(!i?.done)return!0;const n=i.layerView;return!(!n||!e||n.parent===e)||!!(i.done&&n&&"layers"in t&&t.layers?.length)&&t.layers.some((t=>this.isCreatingLayerViewsForLayer(t,n)))}_refreshCollections(){for(const[t,e]of this._layersToLayerViews)this._populateLayerViewsOwners(Ne(this,t),Ne(this,e),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(t,e,i){if(!t||!e)return void(e&&e.removeAll());let n=0;for(const s of t){const t=this._layerLayerViewInfoMap.get(s);if(!t?.layerView)continue;const r=t.layerView;r.layer=s,r.parent=i,e.at(n)!==r&&e.splice(n,0,r),"layers"in s&&FD(r)&&this._populateLayerViewsOwners(s.layers,r.layerViews,r),n+=1}n<e.length&&e.splice(n,e.length)}_createLayerView(t){t.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t);const e=new DD(t,this.view,this.layerViewImporter);e.promise.then((()=>this._refreshCollections()),(e=>{e&&(Es(e)||"cancelled:layerview-create"===e.name)||jt.getLogger(this).error(`Failed to create layerview for layer title:'${t.title??"no title"}', id:'${t.id??"no id"}' of type '${t.type}'.`,{layer:t,error:e}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(t,e),this.view.ready&&e.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};r([Je()],$D.prototype,"_workPromise",void 0),r([Je({readOnly:!0})],$D.prototype,"_watchUpdatingTracking",void 0),r([Je({readOnly:!0})],$D.prototype,"_layersToLayerViews",null),r([Je({readOnly:!0})],$D.prototype,"_rootCollectionNames",null),r([Je()],$D.prototype,"layerViewImporter",void 0),r([Je()],$D.prototype,"supportsGround",void 0),r([Je({readOnly:!0})],$D.prototype,"updating",null),r([Je({readOnly:!0})],$D.prototype,"updatingRemaining",null),r([Je({constructOnly:!0})],$D.prototype,"view",void 0),$D=r([ln("esri.views.LayerViewManager")],$D);const zD=$D;function UD(t){return"createLayerView"in t&&null!=t.createLayerView}let BD=class extends ao{constructor(t){super(t),this.factor=1.5,this.offset=eI(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};r([Je({type:Number})],BD.prototype,"factor",void 0),r([Je({nonNullable:!0})],BD.prototype,"offset",void 0),r([Je()],BD.prototype,"position",void 0),r([Je({type:Number,range:{min:0}})],BD.prototype,"size",void 0),r([Je()],BD.prototype,"maskUrl",void 0),r([Je()],BD.prototype,"maskEnabled",void 0),r([Je()],BD.prototype,"overlayUrl",void 0),r([Je()],BD.prototype,"overlayEnabled",void 0),r([Je({readOnly:!0})],BD.prototype,"version",null),r([Je({type:Boolean})],BD.prototype,"visible",void 0),BD=r([ln("esri.views.Magnifier")],BD);const GD=BD;class VD{constructor(t){this._observable=new km,this._map=new Map(t)}get size(){return oi(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(t){const e=this._map.delete(t);return e&&this._observable.notify(),e}entries(){return oi(this._observable),this._map.entries()}forEach(t,e){oi(this._observable),this._map.forEach(((i,n)=>t.call(e,i,n,this)),e)}get(t){return oi(this._observable),this._map.get(t)}has(t){return oi(this._observable),this._map.has(t)}keys(){return oi(this._observable),this._map.keys()}set(t,e){return this._map.set(t,e),this._observable.notify(),this}values(){return oi(this._observable),this._map.values()}[Symbol.iterator](){return oi(this._observable),this._map[Symbol.iterator]()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}}var qD;let HD=qD=class extends Io{constructor(t){super(t),this.name=null,this.code=null}clone(){return new qD({name:this.name,code:this.code})}};r([Je({type:String,json:{write:!0}})],HD.prototype,"name",void 0),r([Je({type:[String,Number],json:{write:!0}})],HD.prototype,"code",void 0),HD=qD=r([ln("esri.layers.support.CodedValue")],HD);const WD=new Co({inherited:"inherited",codedValue:"coded-value",range:"range"});let ZD=class extends Io{constructor(t){super(t),this.name=null,this.type=null}};r([Je({type:String,json:{write:!0}})],ZD.prototype,"name",void 0),r([NA(WD)],ZD.prototype,"type",void 0),ZD=r([ln("esri.layers.support.Domain")],ZD);const JD=ZD;var YD;let KD=YD=class extends JD{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=String(t);this.codedValues.some((t=>(String(t.code)===i&&(e=t.name),!!e)))}return e}clone(){return new YD({codedValues:nt(this.codedValues),name:this.name})}};r([Je({type:[HD],json:{write:!0}})],KD.prototype,"codedValues",void 0),r([NA({codedValue:"coded-value"})],KD.prototype,"type",void 0),KD=YD=r([ln("esri.layers.support.CodedValueDomain")],KD);const QD=KD;var XD;let t$=XD=class extends JD{constructor(t){super(t),this.type="inherited"}clone(){return new XD}};r([NA({inherited:"inherited"})],t$.prototype,"type",void 0),t$=XD=r([ln("esri.layers.support.InheritedDomain")],t$);const e$=t$;var i$;let n$=i$=class extends JD{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new i$({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};r([Je({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],n$.prototype,"maxValue",void 0),r([Je({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],n$.prototype,"minValue",void 0),r([NA({range:"range"})],n$.prototype,"type",void 0),n$=i$=r([ln("esri.layers.support.RangeDomain")],n$);const s$=n$;const r$={key:"type",base:JD,typeMap:{range:s$,"coded-value":QD,inherited:e$}};function o$(t){if(!t?.type)return null;switch(t.type){case"range":return s$.fromJSON(t);case"codedValue":return QD.fromJSON(t);case"inherited":return e$.fromJSON(t)}return null}const a$=new Co({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var l$;const u$=new Co({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let c$=l$=class extends Io{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch(t){}return i?.value??null}readValueType(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch(t){}return i?u$.fromJSON(i.fieldValueType):null}clone(){return new l$({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};r([Je({type:String,json:{write:!0}})],c$.prototype,"alias",void 0),r([Je({type:[String,Number],json:{write:{allowNull:!0}}})],c$.prototype,"defaultValue",void 0),r([Je()],c$.prototype,"description",void 0),r([ko("description")],c$.prototype,"readDescription",null),r([Je({types:r$,json:{read:{reader:o$},write:!0}})],c$.prototype,"domain",void 0),r([Je({type:Boolean,json:{write:!0}})],c$.prototype,"editable",void 0),r([Je({type:ce,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],c$.prototype,"length",void 0),r([Je({type:String,json:{write:!0}})],c$.prototype,"name",void 0),r([Je({type:Boolean,json:{write:!0}})],c$.prototype,"nullable",void 0),r([NA(a$)],c$.prototype,"type",void 0),r([Je()],c$.prototype,"valueType",void 0),r([ko("valueType",["description"])],c$.prototype,"readValueType",null),r([Je({type:Boolean,json:{read:!1}})],c$.prototype,"visible",void 0),c$=l$=r([ln("esri.layers.support.Field")],c$);const h$=c$;var d$;let f$=d$=class extends Io{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new d$({mapLayerId:t,gdbVersion:e})}};r([NA({mapLayer:"map-layer"})],f$.prototype,"type",void 0),r([Je({type:ce,json:{write:!0}})],f$.prototype,"mapLayerId",void 0),r([Je({type:String,json:{write:!0}})],f$.prototype,"gdbVersion",void 0),f$=d$=r([ln("esri.layers.support.source.MapLayerSource")],f$);var p$;let m$=p$=class extends Io{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:i,spatialReference:n,geometryType:s}=this,r={workspaceId:t,query:e,oidFields:i,spatialReference:n?.clone()??void 0,geometryType:s};return new p$(r)}};r([NA({queryTable:"query-table"})],m$.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],m$.prototype,"workspaceId",void 0),r([Je({type:String,json:{write:!0}})],m$.prototype,"query",void 0),r([Je({type:String,json:{write:!0}})],m$.prototype,"oidFields",void 0),r([Je({type:wh,json:{write:!0}})],m$.prototype,"spatialReference",void 0),r([NA(Qp)],m$.prototype,"geometryType",void 0),m$=p$=r([ln("esri.layers.support.source.QueryTableDataSource")],m$);var y$;let g$=y$=class extends Io{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new y$({workspaceId:t,dataSourceName:e})}};r([NA({raster:"raster"})],g$.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],g$.prototype,"dataSourceName",void 0),r([Je({type:String,json:{write:!0}})],g$.prototype,"workspaceId",void 0),g$=y$=r([ln("esri.layers.support.source.RasterDataSource")],g$);var v$;let w$=v$=class extends Io{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new v$({workspaceId:t,gdbVersion:e,dataSourceName:i})}};r([NA({table:"table"})],w$.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],w$.prototype,"workspaceId",void 0),r([Je({type:String,json:{write:!0}})],w$.prototype,"gdbVersion",void 0),r([Je({type:String,json:{write:!0}})],w$.prototype,"dataSourceName",void 0),w$=v$=r([ln("esri.layers.support.source.TableDataSource")],w$);var b$,S$;const _$=Oo()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let x$=b$=class extends Io{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return T$()(t,e,i)}castLeftTableSource(t){return ue(I$(),t)}readRightTableSource(t,e,i){return T$()(t,e,i)}castRightTableSource(t){return ue(I$(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:i,rightTableSource:n,joinType:s}=this,r={leftTableKey:t,rightTableKey:e,leftTableSource:i?.clone()??void 0,rightTableSource:n?.clone()??void 0,joinType:s};return new b$(r)}};r([NA({joinTable:"join-table"})],x$.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],x$.prototype,"leftTableKey",void 0),r([Je({type:String,json:{write:!0}})],x$.prototype,"rightTableKey",void 0),r([Je({json:{write:!0}})],x$.prototype,"leftTableSource",void 0),r([ko("leftTableSource")],x$.prototype,"readLeftTableSource",null),r([Ah("leftTableSource")],x$.prototype,"castLeftTableSource",null),r([Je({json:{write:!0}})],x$.prototype,"rightTableSource",void 0),r([ko("rightTableSource")],x$.prototype,"readRightTableSource",null),r([Ah("rightTableSource")],x$.prototype,"castRightTableSource",null),r([NA(_$)],x$.prototype,"joinType",void 0),x$=b$=r([ln("esri.layers.support.source.JoinTableDataSource")],x$);let M$=null;function T$(){return M$||(M$=xi({types:I$()})),M$}let A$=null;function I$(){return A$||(A$={key:"type",base:null,typeMap:{"data-layer":C$,"map-layer":f$}}),A$}const k$={key:"type",base:null,typeMap:{"join-table":x$,"query-table":m$,raster:g$,table:w$}};let C$=S$=class extends Io{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new S$({fields:t,dataSource:e})}};r([NA({dataLayer:"data-layer"})],C$.prototype,"type",void 0),r([Je({type:[h$],json:{write:!0}})],C$.prototype,"fields",void 0),r([Je({types:k$,json:{write:!0}})],C$.prototype,"dataSource",void 0),C$=S$=r([ln("esri.layers.support.source.DataLayerSource")],C$),C$.from=ee(C$);let E$=class extends(cm(Io)){constructor(t){super(t),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};r([Je({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.onFields&&this.onFields.length>0}}}}})],E$.prototype,"onFields",void 0),r([Je({type:String,json:{write:!0}})],E$.prototype,"operator",void 0),r([Je({type:String,json:{write:!0}})],E$.prototype,"searchTerm",void 0),r([Je({type:String,json:{write:!0}})],E$.prototype,"searchType",void 0),E$=r([ln("esri.rest.support.FullTextSearch")],E$);const j$=E$;var O$;const R$=new Co({upperLeft:"upper-left",lowerLeft:"lower-left"});let L$=O$=class extends Io{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new O$(nt({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};r([Je({type:Od,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],L$.prototype,"extent",void 0),r([Je({type:["view","edit"],json:{write:!0}})],L$.prototype,"mode",void 0),r([Je({type:String,json:{read:R$.read,write:R$.write}})],L$.prototype,"originPosition",void 0),r([Je({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],L$.prototype,"tolerance",void 0),L$=O$=r([ln("esri.rest.support.QuantizationParameters")],L$);const N$=L$;const P$=new Co({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var F$;const D$=new Co({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let $$=F$=class extends Io{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(e.statisticParameters=nt(t))}clone(){return new F$({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:nt(this.statisticParameters)})}};r([Je({type:Number,json:{write:!0}})],$$.prototype,"maxPointCount",void 0),r([Je({type:Number,json:{write:!0}})],$$.prototype,"maxRecordCount",void 0),r([Je({type:Number,json:{write:!0}})],$$.prototype,"maxVertexCount",void 0),r([Je({type:String,json:{write:!0}})],$$.prototype,"onStatisticField",void 0),r([Je({type:String,json:{write:!0}})],$$.prototype,"outStatisticFieldName",void 0),r([Je({type:String,json:{read:{source:"statisticType",reader:D$.read},write:{target:"statisticType",writer:D$.write}}})],$$.prototype,"statisticType",void 0),r([Je({type:Object})],$$.prototype,"statisticParameters",void 0),r([yh("statisticParameters")],$$.prototype,"writeStatisticParameters",null),$$=F$=r([ln("esri.rest.support.StatisticDefinition")],$$);const z$=$$;var U$;const B$=new Co({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let G$=U$=class extends Io{static from(t){return Kt(U$,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return"number"==typeof t||"object"==typeof t?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const e in t){const n=t[e];Array.isArray(n)?i[e]=n.map((t=>t instanceof Date?t.getTime():t)):n instanceof Date?i[e]=n.getTime():i[e]=n}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new U$(nt({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:null!=this.historicMoment?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};G$.MAX_MAX_RECORD_COUNT_FACTOR=5,r([Je({json:{write:!0}})],G$.prototype,"aggregateIds",void 0),r([Je({type:Boolean,json:{write:!0}})],G$.prototype,"cacheHint",void 0),r([Je({type:Boolean,json:{default:!1,write:!0}})],G$.prototype,"compactGeometryEnabled",void 0),r([Je({json:{write:!0}})],G$.prototype,"datumTransformation",void 0),r([Ah("datumTransformation")],G$.prototype,"castDatumTransformation",null),r([Je({type:Boolean,json:{default:!1,write:!0}})],G$.prototype,"defaultSpatialReferenceEnabled",void 0),r([Je({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],G$.prototype,"distance",void 0),r([Je({type:C$,json:{write:!0}})],G$.prototype,"dynamicDataSource",void 0),r([Je({type:String,json:{write:!0}})],G$.prototype,"formatOf3DObjects",void 0),r([Je({type:[j$],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.fullText&&this.fullText.length>0}}}}})],G$.prototype,"fullText",void 0),r([Je({type:String,json:{write:!0}})],G$.prototype,"gdbVersion",void 0),r([Je({types:um,json:{read:rm,write:!0}})],G$.prototype,"geometry",void 0),r([Je({type:Number,json:{write:!0}})],G$.prototype,"geometryPrecision",void 0),r([Je({type:[String],json:{write:!0}})],G$.prototype,"groupByFieldsForStatistics",void 0),r([Je({type:String,json:{write:!0}})],G$.prototype,"having",void 0),r([Je({type:Date})],G$.prototype,"historicMoment",void 0),r([yh("historicMoment")],G$.prototype,"writeHistoricMoment",null),r([Je({type:Number,json:{write:!0}})],G$.prototype,"maxAllowableOffset",void 0),r([Je({type:Number,cast:t=>t<1?1:t>G$.MAX_MAX_RECORD_COUNT_FACTOR?G$.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],G$.prototype,"maxRecordCountFactor",void 0),r([Je({type:["xyFootprint"],json:{write:!0}})],G$.prototype,"multipatchOption",void 0),r([Je({type:Number,json:{read:{source:"resultRecordCount"}}})],G$.prototype,"num",void 0),r([Je({json:{write:!0}})],G$.prototype,"objectIds",void 0),r([Je({type:[String],json:{write:!0}})],G$.prototype,"orderByFields",void 0),r([Je({type:[String],json:{write:!0}})],G$.prototype,"outFields",void 0),r([Je({type:wh,json:{name:"outSR",write:!0}})],G$.prototype,"outSpatialReference",void 0),r([Je({type:[z$],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&this.outStatistics.length>0}}}}})],G$.prototype,"outStatistics",void 0),r([Je({json:{write:!0}})],G$.prototype,"parameterValues",void 0),r([yh("parameterValues")],G$.prototype,"writeParameterValues",null),r([Je({type:Kh,json:{write:!0}})],G$.prototype,"pixelSize",void 0),r([Je({type:N$,json:{write:!0}})],G$.prototype,"quantizationParameters",void 0),r([Je({type:[Object],json:{write:!0}})],G$.prototype,"rangeValues",void 0),r([Je({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],G$.prototype,"relationParameter",void 0),r([Je({type:String,json:{write:!0}})],G$.prototype,"resultType",void 0),r([Je({type:Boolean,json:{default:!1,write:!0}})],G$.prototype,"returnCentroid",void 0),r([Je({type:Boolean,json:{default:!1,write:!0}})],G$.prototype,"returnDistinctValues",void 0),r([Je({type:Boolean,json:{default:!0,write:!0}})],G$.prototype,"returnExceededLimitFeatures",void 0),r([Je({type:Boolean,json:{write:!0}})],G$.prototype,"returnGeometry",void 0),r([Je({type:Boolean,json:{default:!1,write:!0}})],G$.prototype,"returnQueryGeometry",void 0),r([Je({type:Boolean,json:{default:!1,write:!0}})],G$.prototype,"returnM",void 0),r([Je({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],G$.prototype,"returnZ",void 0),r([Je({type:wh,json:{write:!0}})],G$.prototype,"sourceSpatialReference",void 0),r([NA(P$,{ignoreUnknown:!1,name:"spatialRel"})],G$.prototype,"spatialRelationship",void 0),r([Je({type:Number,json:{read:{source:"resultOffset"}}})],G$.prototype,"start",void 0),r([yh("start"),yh("num")],G$.prototype,"writeStart",null),r([Je({type:String,json:{write:!0}})],G$.prototype,"sqlFormat",void 0),r([Je({type:String,json:{write:!0}})],G$.prototype,"text",void 0),r([Je({type:MC,json:{write:!0}})],G$.prototype,"timeExtent",void 0),r([Je({type:Boolean,json:{default:!1,write:!0}})],G$.prototype,"timeReferenceUnknownClient",void 0),r([NA(B$,{ignoreUnknown:!1}),Je({json:{write:{overridePolicy(t){return{enabled:!!t&&null!=this.distance&&this.distance>0}}}}})],G$.prototype,"units",void 0),r([Je({type:String,json:{write:{overridePolicy(t){return{enabled:null!=t||null!=this.start&&this.start>0}}}}})],G$.prototype,"where",void 0),r([yh("where")],G$.prototype,"writeWhere",null),G$=U$=r([ln("esri.rest.support.Query")],G$);const V$=G$;function q$(t){return!!(null!=t&&"object"==typeof t&&"createQuery"in t&&t.createQuery&&"on"in t&&t.on)}let H$=class extends Tm.EventedAccessor{constructor(t){super(t),this._selectionMap=new VD,this._sources=new Vm,this._trashCan=[],this._layerEditHandles=new Vm,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([ey((()=>[this.view,this.showHighlight]),(()=>this._refreshVisualization())),sy((()=>this.sources),"change",(t=>{const e=this._selectionMap;for(const i of t.removed)e.delete(i);this._refreshListeners(),this._refreshVisualization()}),{onListenerAdd:()=>this._refreshListeners()})]);const t=new Vm;this.view.when().then((()=>{this.view.map&&(this.view.map.allLayers.flatten((t=>"sublayers"in t&&t.sublayers?t.sublayers:null)).forEach((e=>{(q$(e)&&!HT(e)||WT(e))&&t.add(e)})),this.sources=t)}))}destroy(){this._layerEditHandles.drain(kn)}get selections(){return Array.from(this._selectionMap.entries()).map((t=>{const[e,i]=t;return{layer:e,selection:[...i.selection]}}))}get count(){let t=0;for(const e of this._selectionMap.values())t+=e.selection.length;return t}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(t){AM(t,this._sources)}async getSelectedFeatures(t,e={},i="layerView"){const{view:n,selections:s}=this,r=(void 0!==t?s.filter((e=>t.includes(e.layer))):s).filter((t=>t.selection.length>0)).map((async t=>{const{layer:s,selection:r}=t,o=WT(s)?s.parent:s;if(null==o||!J$(o))return null;if("layer"===i)return K$(o,r,e);if(W$(o))return null;const a=await n.whenLayerView(o).catch((()=>null));return a?K$(a,r,e):null}));return(await Promise.all(r)).filter((t=>null!=t))}updateSelection(t){const e=new Map;for(const[t,i]of this._selectionMap)e.set(t,[...i.selection]);let i=!1;const n=t.current.concat(t.added);for(const t of n){const n=t.sourceLayer,s=t.getObjectId();if(this.sources.includes(n)&&(q$(n)||WT(n))&&null!==s){const t=Nt(e,n,(()=>[]));t.includes(s)||(t.push(s),i=!0)}}for(const n of t.removed){const t=n.sourceLayer,s=n.getObjectId();if(this.sources.includes(t)&&(q$(t)||WT(t))&&null!==s){const n=e.get(t),r=n?.indexOf(s);void 0!==r&&r>=0&&(n?.splice(r,1),i=!0)}}if(i){const{_selectionMap:t,_trashCan:i}=this,n=[];for(const[s,r]of e){const e=t.get(s);void 0!==e&&i.push(e),t.set(s,{selection:r}),n.push({layer:s,selection:r,...y(void 0!==e?e.selection:[],r)})}this._onSelectionChange(n)}}setSelection(t,e){this._setSelection(t,e)}getSelection(t){const e=this._selectionMap.get(t);return e?.selection}appendToSelection(t,e){const i=this._selectionMap.get(t),n=void 0!==i?[...i.selection]:[];for(const t of e)n.includes(t)||n.push(t);this._setSelection(t,n)}removeFromSelection(t,e){const i=this._selectionMap.get(t);if(!i)return;const n=[];for(const t of i.selection)e.includes(t)||n.push(t);this._setSelection(t,n)}toggleInSelection(t,e){const i=this._selectionMap.get(t);if(!i||0===i.selection.length)return void this._setSelection(t,e);const n=new Set(i.selection),s=new Set(e),r=xr(n,s);this._setSelection(t,Array.from(r))}clear(){const t=this._selectionMap.values();this._trashCan.push(...t);const e=[];for(const[t,i]of this._selectionMap.entries())e.push({layer:t,added:[],removed:[...i.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(e)}_onSelectionChange(t){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:t})}_refreshVisualization(){if(null==this.view||null==this.sources)return;for(this._vizTaskId++;this._trashCan.length>0;){const t=this._trashCan.pop();t?.highlightHandle?.remove()}const{sources:t,view:e,_selectionMap:i,showHighlight:n}=this,s=this._vizTaskId;for(const r of t){const t=i.get(r),o=WT(r)?r.parent:r;if(null!=o&&J$(o)){if(W$(o))continue;e.whenLayerView(o).then((e=>{t?.highlightHandle?.remove(),null!=t&&n&&s===this._vizTaskId&&"highlight"in e&&"function"==typeof e.highlight&&t.selection.length>0&&(t.highlightHandle=e.highlight(t.selection,"selection"))})).catch((()=>{t?.highlightHandle?.remove()}))}}}_refreshListeners(){this._layerEditHandles.drain(kn);for(const t of this.sources){const e=WT(t)?t.parent:t;if(null!=e&&q$(e)){const i=e.on("edits",(e=>{this._handleEditChanges(e,t)}));this._layerEditHandles.push(i)}}}_handleEditChanges(t,e){if(void 0!==t.deletedFeatures&&t.deletedFeatures.length>0&&this._selectionMap.has(e)){const i=t.deletedFeatures.filter((t=>null==t.error)).map((t=>t.objectId)).filter(C);this.removeFromSelection(e,i)}}_setSelection(t,e){if(!this.sources.includes(t))throw new Error(`Cannot set selection on layer ${t.title} because it is not in 'sources'`);const i=this._selectionMap.get(t);if(void 0===i||!Y$(i,{selection:e})){void 0!==i&&this._trashCan.push(i),this._selectionMap.set(t,{selection:[...e]});const n={layer:t,selection:[...e],...y(void 0!==i?i.selection:[],e)};this._onSelectionChange([n])}}};r([Je({readOnly:!0,nonNullable:!0})],H$.prototype,"selections",null),r([Je({readOnly:!0,nonNullable:!0})],H$.prototype,"count",null),r([Je({constructOnly:!0,nonNullable:!0})],H$.prototype,"view",void 0),r([Je({readOnly:!0,nonNullable:!0})],H$.prototype,"hasSelection",null),r([Je()],H$.prototype,"showHighlight",void 0),r([Je()],H$.prototype,"sources",null),H$=r([ln("esri.views.SelectionManager")],H$);const W$=t=>WT(t)?!0===t.parent?.isTable:t.isTable,Z$=t=>void 0!==t.layer,J$=t=>void 0!==t?.when,Y$=(t,e)=>{if(null==t&&null==e)return!0;if(null!=t&&null==e||null==t&&null!=e)return!1;if(null!=t&&null!=e&&null!=t.selection&&null!=e.selection){const i=[...t.selection],n=[...e.selection];if(i.length!==n.length)return!1;i.sort(),n.sort();for(let t=0;t<i.length;t++)if(i[t]!==n[t])return!1}return!0},K$=async(t,e,i={})=>{let n;if(Z$(t)){const s=t;n=void 0===s?null:await s.queryFeatures(new V$({...i,objectIds:e})).then((e=>({data:e,layer:t.layer})))}else{const s=t;n=void 0===s?null:await s.queryFeatures(new V$({...i,objectIds:e})).then((t=>({data:t,layer:s})))}return n},Q$=H$;let X$=class extends(cm(ao)){constructor(t){super(t),this.accentColor=new RA([255,127,0]),this.textColor=new RA([255,255,255])}};r([Je({type:RA,nonNullable:!0})],X$.prototype,"accentColor",void 0),r([Je({type:RA,nonNullable:!0})],X$.prototype,"textColor",void 0),X$=r([ln("esri.views.Theme")],X$);const tz=X$;var ez;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(ez||(ez={}));const iz=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],nz={};function sz(t){return!!nz[t]}function rz(t){for(const e of t)if(!sz(e))return!1;return!0}iz.forEach((t=>{nz[t]=!0}));class oz{constructor(t){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this._handlers.forEach((({handler:t,priority:e},i)=>this.inputManager?.installHandlers(i,[t],e)))}disconnect(){this.inputManager&&this._handlers.forEach(((t,e)=>this.inputManager?.uninstallHandlers(e))),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(t,e,i,n){const s=Array.isArray(t)?t:t.split(",");if(!rz(s))return s.some(sz)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let r,o;Array.isArray(e)?o=e:(r=e,o=[]),"function"==typeof i?r=i:n=i,n=null!=n?n:vM.DEFAULT;const a=this._createUniqueGroupName(),l=new az(this.view,s,o,r);this._handlers.set(a,{handler:l,priority:n});for(const t of s){const e=this._handlerCounts.get(t)||0;this._handlerCounts.set(t,e+1)}return this.inputManager&&this.inputManager.installHandlers(a,[l],n),we((()=>this._removeHandler(a,s)))}hasHandler(t){return!!this._handlerCounts.get(t)}_removeHandler(t,e){if(this._handlers.has(t)){this._handlers.delete(t);for(const t of e){const e=this._handlerCounts.get(t);void 0===e||(1===e?this._handlerCounts.delete(t):this._handlerCounts.set(t,e-1))}}this.inputManager&&this.inputManager.uninstallHandlers(t)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}}class az extends aM{constructor(t,e,i,n){super(!0),this._latestDragStart=void 0,this.view=t;for(const s of e)switch(s){case"click":this.registerIncoming("click",i,(e=>n(cz(t,e))));break;case"double-click":this.registerIncoming("double-click",i,(e=>n(hz(t,e))));break;case"immediate-click":this.registerIncoming("immediate-click",i,(e=>n(dz(t,e))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,(e=>n(fz(t,e))));break;case"hold":this.registerIncoming("hold",i,(e=>n(pz(t,e))));break;case"drag":this.registerIncoming("drag",i,(t=>{const e=this._wrapDrag(t);e&&n(e)}));break;case"key-down":this.registerIncoming("key-down",i,(t=>n(yz(t))));break;case"key-up":this.registerIncoming("key-up",i,(t=>n(gz(t))));break;case"pointer-down":this.registerIncoming("pointer-down",i,(t=>n(vz(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",i,(t=>n(vz(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",i,(t=>n(vz(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,(t=>n(wz(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,(t=>n(bz(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,(t=>n(vz(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,(t=>n(vz(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",i,(t=>{n(Sz(t))}));break;case"focus":this.registerIncoming("focus",i,(t=>{n(lz(t))}));break;case"blur":this.registerIncoming("blur",i,(t=>{n(uz(t))}))}}_wrapDrag(t){const e=t.data,{x:i,y:n}=e.center,{action:s,pointerType:r,button:o}=e;if("start"===s&&(this._latestDragStart=e),!this._latestDragStart)return;const a=e.pointer.native,l=e.buttons,{cancelable:u,timestamp:c}=t,h={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return"end"===s&&(this._latestDragStart=void 0),{type:"drag",action:s,x:i,y:n,origin:h,pointerType:r,button:o,buttons:l,radius:e.radius,angle:Mf(e.angle),native:a,timestamp:c,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}function lz(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function uz(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function cz(t,e){const{pointerType:i,button:n,buttons:s,x:r,y:o,native:a,eventId:l}=e.data,{cancelable:u,timestamp:c}=e;return{type:"click",pointerType:i,button:n,buttons:s,x:r,y:o,native:a,timestamp:c,screenPoint:eI(r,o),mapPoint:mz(t,r,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function hz(t,e){const{pointerType:i,button:n,buttons:s,x:r,y:o,native:a,eventId:l}=e.data,{cancelable:u,timestamp:c}=e;return{type:"double-click",pointerType:i,button:n,buttons:s,x:r,y:o,native:a,timestamp:c,mapPoint:mz(t,r,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function dz(t,e){const{pointerType:i,button:n,buttons:s,x:r,y:o,native:a,eventId:l}=e.data,u=a.pointerId,{cancelable:c,timestamp:h}=e;return{type:"immediate-click",pointerId:u,pointerType:i,button:n,buttons:s,x:r,y:o,native:a,timestamp:h,mapPoint:mz(t,r,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function fz(t,e){const{pointerType:i,button:n,buttons:s,x:r,y:o,native:a,eventId:l}=e.data,u=a.pointerId,{cancelable:c,timestamp:h}=e;return{type:"immediate-double-click",pointerId:u,pointerType:i,button:n,buttons:s,x:r,y:o,native:a,timestamp:h,mapPoint:mz(t,r,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function pz(t,e){const{pointerType:i,button:n,buttons:s,x:r,y:o,native:a}=e.data,{cancelable:l,timestamp:u}=e;return{type:"hold",pointerType:i,button:n,buttons:s,x:r,y:o,native:a,timestamp:u,mapPoint:mz(t,r,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}function mz(t,e,i){return t.toMap(eI(e,i),{exclude:[]})}function yz(t){const{key:e,repeat:i,native:n}=t.data,{cancelable:s,timestamp:r}=t;return{type:"key-down",key:e,repeat:i,native:n,timestamp:r,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function gz(t){const{key:e,native:i}=t.data,{cancelable:n,timestamp:s}=t;return{type:"key-up",key:e,native:i,timestamp:s,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function vz(t,e){const{x:i,y:n,button:s,buttons:r,native:o,eventId:a}=t.data,l=o.pointerId,u=o.pointerType,{cancelable:c,timestamp:h}=t;return{type:e,x:i,y:n,pointerId:l,pointerType:u,button:s,buttons:r,native:o,timestamp:h,eventId:a,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function wz(t){const{x:e,y:i,buttons:n,native:s,eventId:r}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,u=t.data.action,c={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:d}=t;return{type:"pointer-drag",x:e,y:i,pointerId:a,pointerType:l,button:o,buttons:n,action:u,origin:c,native:s,timestamp:d,eventId:r,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function bz(t){const{cancelable:e,data:i,timestamp:n}=t,{x:s,y:r,deltaY:o,native:a}=i;return{type:"mouse-wheel",x:s,y:r,deltaY:o,native:a,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function Sz(t){const{action:e,state:i,device:n}=t.data,{cancelable:s,timestamp:r}=t,{buttons:o,axes:a}=i;return{type:"gamepad",device:n,timestamp:r,action:e,buttons:o,axes:a,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}var _z,xz,Mz;!function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"}(_z||(_z={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(xz||(xz={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(Mz||(Mz={}));function Tz(t){return[t.on("before-add",(e=>{const i=e.item;if(null==i||t.includes(i))return jt.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()})),t.on("after-remove",(t=>{const e=t.item;e.active&&(e.view.activeTool=null),e.destroy()}))]}function Az(t){return t.visible&&null!=t.getEditableFlag&&t.getEditableFlag(_z.USER)&&t.getEditableFlag(_z.MANAGER)}function Iz(t){return eI(t.x,t.y)}function kz(t,e){const i=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return i?eI(e.clientX-i.left,e.clientY-i.top):eI(0,0)}function Cz(t,e){return e instanceof Event?kz(t,e):Iz(e)}function Ez(t){if(t instanceof Event)return!0;if("object"==typeof t&&"type"in t){switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}}return!1}class jz{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(t,e){const i=()=>t.stopPropagation();switch(t.type){case"pointer-move":Lz(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:"start"===t.action?this._externallyDragging=!0:"end"===t.action&&(this._externallyDragging=!1),this._stopDrag&&(i(),"end"===t.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!Nz(t))break;const n=Iz(t),s=Rz(n,t.pointerType,e.forEachTool);if(null==s)break;const r=s.manipulator,o=s.tool;null==r||null==o||!r.interactive||r.grabbable&&r.grabbableForEvent(t)||!r.grabbing||r.dragging||this._releaseManipulatorBeforeDragging(r,t,e),null!=r&&null!=o&&r.interactive&&r.grabbable&&r.grabbableForEvent(t)&&!r.grabbing&&(this._grabbedManipulators.set(t.pointerId,{manipulator:r,tool:o,start:n,pointerType:t.pointerType}),1===this._grabbedManipulators.size&&null==e.activeTool&&(this._revertToNullActiveTool=!0,e.setActiveTool(s.tool)),r.grabbing=!0,r.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:n}),i());break}case"pointer-up":this._draggedManipulators.has(t.pointerId)||this._handlePointerEnd(t,e);break;case"pointer-drag":{if(!Nz(t))break;const n=this._grabbedManipulators.get(t.pointerId),s=n?.manipulator,r=n?.tool;if(null==s||null==r)break;const o=Iz(t);o.x=wf(o.x,0,e.view.width),o.y=wf(o.y,0,e.view.height);const a=n.start,l=this._draggedManipulators.get(t.pointerId);switch(t.action){case"start":case"update":"update"!==t.action&&1!==this._grabbedManipulators.size||(s.dragging=!0,l?s.events.emit("drag",{action:"update",start:a,screenPoint:o}):s.events.emit("drag",{action:"start",start:a,screenPoint:o,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{tool:r,manipulator:s,start:a}));break;case"end":s.dragging=!1,l&&s.events.emit("drag",{action:"end",start:a,screenPoint:o}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,e)}i();break}case"immediate-click":{const n=Iz(t),s=Rz(n,t.pointerType,e.forEachTool);if(Pz(t)||e.forEachTool((t=>{if((null==s||s.tool!==t||t.automaticManipulatorSelection)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0)})),e&&t.onManipulatorSelectionChanged&&t.onManipulatorSelectionChanged()}})),null==s)break;const{manipulator:r,tool:o}=s;if(!r.interactive)break;r.selectable&&o.automaticManipulatorSelection&&(r.selected=!r.selected,o.onManipulatorSelectionChanged&&o.onManipulatorSelectionChanged());const a=t.native.shiftKey;r.events.emit("immediate-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:a,stopPropagation:i}),Fz(r,i);break}case"click":{const n=Iz(t),s=Rz(n,t.pointerType,e.forEachTool),r=s?.manipulator;if(null==r||!r.interactive)break;const o=t.native.shiftKey;r.events.emit(t.type,{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:o}),i();break}case"double-click":{const n=Iz(t),s=Rz(n,t.pointerType,e.forEachTool),r=null!=s?s.manipulator:null;if(null==r||!r.interactive)break;const o=t.native.shiftKey;r.events.emit("double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:o,stopPropagation:i}),Fz(r,i);break}case"immediate-double-click":{const n=Iz(t),s=Rz(n,t.pointerType,e.forEachTool),r=null!=s?s.manipulator:null;if(null==r||!r.interactive)break;const o=t.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:o,stopPropagation:i}),"mouse"===t.pointerType&&Fz(r,i);break}}this._onFocusChange(e.forEachTool)}_releaseManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Iz(e)}),this._grabbedManipulators.forEach((({manipulator:e},i)=>{e===t&&this._grabbedManipulators.delete(i)})),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(t,e){const i=this._grabbedManipulators.get(t.pointerId)?.manipulator;null!=i&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:Iz(t)}),this._grabbedManipulators.delete(t.pointerId),this._afterManipulatorRelease(e.setActiveTool))}_onFocusChange(t){this._updateCursor(),this._updateFocusedManipulatorTools(t)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=Oz(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=Oz(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(t){const e=new Set,i=new Set;this._grabbedManipulators.forEach((({tool:t})=>{e.add(t)})),this._hoveredManipulators.forEach((({tool:t})=>{i.add(t)})),t((t=>{t.hasGrabbedManipulators=e.has(t),t.hasHoveredManipulators=i.has(t);const n=this._grabbedManipulators.values(),s=wn(n,(({tool:e})=>e===t));t.firstGrabbedManipulator=null!=s?s.manipulator:null}))}clearPointers(t,{forEachTool:e,setActiveTool:i},n=!0,s){const r=(e,i)=>e===t&&(null==s||s===i);this._grabbedManipulators.forEach((({tool:t,manipulator:e,pointerType:i},n)=>{r(t,e)&&(this._grabbedManipulators.delete(n),e.grabbing=!1,e.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:i}))})),this._draggedManipulators.forEach((({tool:t,manipulator:e},i)=>{r(t,e)&&(this._draggedManipulators.delete(i),e.dragging=!1,e.events.emit("drag",{action:"cancel"}))})),n&&this._hoveredManipulators.forEach((({tool:t,manipulator:e},i)=>{r(t,e)&&(this._hoveredManipulators.delete(i),e.hovering=!1)})),this._afterManipulatorRelease(i),this._onFocusChange(e)}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(eI(e.x,e.y),i,e.pointerType,t)}))}handleHoverEvent(t,e){const i=t.type;"pointer-up"!==i&&"immediate-click"!==i&&"pointer-move"!==i||!Lz(t.pointerType)||("pointer-up"!==i&&this._externallyDragging?this._clearHoveredManipulatorStates(t.pointerId):this._updateHoveredStateForPointerAtScreenPosition(Iz(t),t.pointerId,t.pointerType,e))}_updateHoveredStateForPointerAtScreenPosition(t,e,i,n){let s=Rz(t,i,n);const r=this._hoveredManipulators.get(e)?.manipulator;null==s||s.manipulator.interactive||(s=null),null!=s&&r===s.manipulator||(null!=r&&(r.hovering=!1),null!=s?(s.manipulator.hovering=!0,this._hoveredManipulators.set(e,s)):this._hoveredManipulators.delete(e),this._onFocusChange(n))}_afterManipulatorRelease(t){0===this._grabbedManipulators.size&&this._revertToNullActiveTool&&(t(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(t){this._hoveredManipulators.forEach((({manipulator:e},i)=>{t===i&&(this._hoveredManipulators.delete(t),e.hovering=!1)}))}}function Oz(t){for(const{manipulator:e}of t.values())if(null!=e&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function Rz(t,e,i){let n=null;return i((i=>{if(null==i.manipulators||!Az(i))return!1;const s=i.manipulators.intersect(t,e);return null!=s&&(n={tool:i,manipulator:s},!0)})),n}function Lz(t){return"mouse"===t}function Nz(t){return"mouse"!==t.pointerType||0===t.button}function Pz(t){return!!t.native.shiftKey}function Fz(t,e){t?.consumesClicks&&e()}const Dz="attached",$z="tools",zz=1e3;let Uz=class extends ao{constructor(t){super(t),this._updatingHandles=new SS,this._clock=ps,this._manipulatorState=new jz,this.tools=new Vm,this.cursor=null,this._interacting=!1,this._interactingTimeout=zz,this._interactingTimeoutHandle=null,this._forEachTool=t=>{for(const e of this.tools.items)if(t(e))return}}initialize(){this.addHandles([this.view.on(iz,(t=>{this._handleInputEvent(t)}),vM.TOOL),...Tz(this.tools),this.tools.on("before-add",(({item:t})=>{this._updateToolEditableFlag(t)})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this.activeTool=null,this.tools.drain((t=>t.destroy())),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t},view:this.view}}set activeTool(t){if(null!=t&&!this.view.ready)return void jt.getLogger(this).error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return;const e=this.activeTool;this._set("activeTool",t),null!=e&&e.deactivate(),null!=t&&t.activate(),this._removeIncompleteTools(t);for(const t of this.tools){this._updateToolEditableFlag(t);const e=Az(t);null!=this.activeTool&&e||this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs,!e)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some((t=>t.updating))}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=kn(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout((()=>this._interacting=!1),this._interactingTimeout)}attach(){"3d"===this.view.type?this.addHandles([ey((()=>{const{state:t}=this.view;return"camera"in t&&t.camera}),(()=>this._forEachManipulator((t=>t.onViewChange())))),this.view.elevationProvider?.on("elevation-change",(t=>this._forEachManipulator((e=>e.onElevationChange(t)))))],Dz):this.addHandles(ey((()=>this.view.extent),(()=>this._forEachManipulator((t=>t.onViewChange())))))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Dz),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(t){this._forEachTool((e=>{e.manipulators&&e.manipulators.forEach((({manipulator:i})=>t(i,e)))}))}_handleInputEvent(t){let e=!1;const i={...t,stopPropagation:()=>{e=!0,t.stopPropagation()}};null!=this.activeTool?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((t=>{!e&&t.visible&&t.handleInputEvent(i)})),!e&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),e||null==this.activeTool||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),"pointer-move"===t.type&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles($z),this._forEachTool((t=>{if(t instanceof ao){const e=ey((()=>[t.cursor,t.visible,t.editable]),(()=>{Az(t)||this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()}));this.addHandles(e,$z)}t.manipulators&&this.addHandles([t.manipulators.on("after-remove",(e=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs,!0,e.item.manipulator)})),t.manipulators.on("change",(()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}))],$z)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(t){t.setEditableFlag?.(_z.MANAGER,null==this.activeTool||t===this.activeTool)}_updateCursor(){let t=this._manipulatorState.cursor;null==t&&this._forEachTool((e=>!(null==e.cursor||!e.visible)&&(t=e.cursor,!0))),this._get("cursor")!==t&&this._set("cursor",t)}_removeIncompleteTools(t){this.tools.filter((e=>(null==t||e!==t)&&!e.created&&e.removeIncompleteOnCancel)).forEach((t=>{this.tools.remove(t)}))}get test(){}};r([Je({constructOnly:!0,nonNullable:!0})],Uz.prototype,"view",void 0),r([Je({value:null})],Uz.prototype,"activeTool",null),r([Je({readOnly:!0,type:Vm})],Uz.prototype,"tools",void 0),r([Je({readOnly:!0})],Uz.prototype,"cursor",void 0),r([Je({readOnly:!0})],Uz.prototype,"updating",null),r([Je()],Uz.prototype,"_interacting",void 0),r([Je({readOnly:!0})],Uz.prototype,"interacting",null),Uz=r([ln("esri.views.ToolViewManager")],Uz);let Bz=class extends ao{constructor(t){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===t.mapping?this._detectedDeviceType="standard":Vz.test(t.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=t.index}get native(){const t=navigator.getGamepads?navigator.getGamepads():[];return null!=this.nativeIndex&&this.nativeIndex<t.length?t[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return qz[this.deviceType]}};r([Je({nonNullable:!0,readOnly:!0})],Bz.prototype,"nativeIndex",void 0),r([Je({type:String,readOnly:!0})],Bz.prototype,"deviceType",null),r([Je({type:Number,readOnly:!0})],Bz.prototype,"axisThreshold",null),Bz=r([ln("esri.views.input.gamepad.GamepadInputDevice")],Bz);const Gz=Bz,Vz=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),qz={standard:.15,spacemouse:.025,unknown:0};let Hz=class extends ao{constructor(...t){super(...t),this.devices=new Vm,this.enabledFocusMode="document"}};r([Je({type:Vm.ofType(Gz),readOnly:!0})],Hz.prototype,"devices",void 0),r([Je({type:["document","view","none"]})],Hz.prototype,"enabledFocusMode",void 0),Hz=r([ln("esri.views.input.gamepad.GamepadSettings")],Hz);const Wz=Hz;let Zz=class extends ao{constructor(){super(...arguments),this.gamepad=new Wz}};r([Je({readOnly:!0})],Zz.prototype,"gamepad",void 0),Zz=r([ln("esri.views.input.Input")],Zz);const Jz=Zz;const Yz=()=>St.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;let Kz=class extends ao{constructor(t){super(t),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};r([Je({type:Boolean,nonNullable:!0})],Kz.prototype,"enabled",void 0),r([Je({type:Gz})],Kz.prototype,"device",void 0),r([Je({type:["pan","zoom"],nonNullable:!0})],Kz.prototype,"mode",void 0),r([Je({type:["forward-down","forward-up"],nonNullable:!0})],Kz.prototype,"tiltDirection",void 0),r([Je({type:Number,nonNullable:!0})],Kz.prototype,"velocityFactor",void 0),Kz=r([ln("esri.views.navigation.gamepad.GamepadSettings")],Kz);const Qz=Kz;let Xz=class extends ao{constructor(t){super(t),this.browserTouchPanEnabled=!0,this.gamepad=new Qz,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!Yz()}};r([Je({type:Boolean})],Xz.prototype,"browserTouchPanEnabled",void 0),r([Je({type:Qz,nonNullable:!0})],Xz.prototype,"gamepad",void 0),r([Je({type:Boolean})],Xz.prototype,"momentumEnabled",void 0),r([Je({type:Boolean})],Xz.prototype,"mouseWheelZoomEnabled",void 0),Xz=r([ln("esri.views.navigation.Navigation")],Xz);const tU=Xz;const eU={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},iU=Object.values(eU),nU=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${iU.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),sU=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${iU.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),rU=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function oU(t){return nU.test(t)}function aU(t){if(null==t)return null;const e=ca(t),i=e?.path.match(nU)||e?.path.match(sU);if(!i)return null;const[,n,s,r,o]=i,a=s.indexOf("/");return{title:uU(-1!==a?s.slice(a+1):s),serverType:eU[r.toLowerCase()],sublayer:null!=o&&""!==o?parseInt(o,10):null,url:{path:n}}}function lU(t){const e=ca(t).path.match(rU);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function uU(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function cU(t,e){const i=[];if(t){const e=aU(t);null!=e&&e.title&&i.push(e.title)}if(e){const t=uU(e);i.push(t)}if(2===i.length){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function hU(t){let e=ja(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function dU(t,e){return t?nl(cl(t,e)):t}function fU(t){let{url:e}=t;if(!e)return{url:e};e=cl(e,t.logger);const i=ca(e),n=aU(i.path);let s;if(null!=n)null!=n.sublayer&&null==t.layer.layerId&&(s=n.sublayer),e=n.url.path;else if(t.nonStandardUrlAllowed){const t=lU(i.path);null!=t&&(e=t.serviceUrl,s=t.sublayerId)}return{url:nl(e),layerId:s}}function pU(t,e,i,n,s){bT(e,n,"url",s),n.url&&null!=t.layerId&&(n.url=Ea(n.url,i,t.layerId.toString()))}function mU(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),n=e.includes("/mapserver/wmsserver"),s=e.includes("/imageserver/wmsserver"),r=e.includes("/wmsserver");return i&&(n||s||r)}function yU(t){if(!t)return!1;const e=new ea(Ia(t)),i=e.authority?.toLowerCase();return"server.arcgisonline.com"===i||"services.arcgisonline.com"===i}var gU;function vU(t){if("integrated-mesh-3dtiles"===t.type)return null;const e=t.url?aU(t.url):void 0,i=t.spatialReference?.vcsWkid;return!(null==i&&null!=e&&"ImageServer"===e.serverType)&&wU(t)&&t.heightModelInfo?t.heightModelInfo:SU(t)?qC.deriveUnitFromSR(MU,t.spatialReference):null}function wU(t){return"heightModelInfo"in t}function bU(t){if("unknown"===t.type||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function SU(t){return bU(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):xU(t)}function _U(t){return null!=t.layers||xU(t)||bU(t)||wU(t)}function xU(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"focusArea":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}!function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"}(gU||(gU={}));const MU=new qC({heightModel:"gravity-related-height"});var TU;function AU(t){return t===TU.Global?"global":"local"}!function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"}(TU||(TU={}));let IU,kU=null;async function CU(t){kU||(kU=import("./p-708584c5.js").then((t=>IU=t))),await kU,_s(t)}async function EU(t,e,i,n){if(!t)return null;const s=t.spatialReference;return Ib()||Gb(s,e)?Ob(t,e):IU?IU.projectGeometry(t,e,i,n):(await Promise.race([CU(n),jb(n)]),EU(t,e,i,n))}let jU=class extends ao{constructor(t){super(t),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Cn(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return null==this.userSpatialReference||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const t=this.map?.(),e=[];return null!=this.priorityCollection&&e.push(this.priorityCollection),e.push({parent:t?.basemap,layers:t?.basemap?.baseLayers},{layers:t?.layers},{parent:t?.ground,layers:t?.ground?.layers},{parent:t?.basemap,layers:t?.basemap?.referenceLayers}),e}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let t;if(this._collectLayers(this.mapCollections,(e=>{const i=this._getSupportedSpatialReferences(e);if(i.length>0){const e=this._narrowDownSpatialReferenceCandidates(t,i);null!=e&&(t=e)}return 1===t?.length}))&&1!==t?.length)return{updating:!0};const e=this._pickSpatialReferenceCandidate(t);return{spatialReference:e?.spatialReference??null,viewingMode:e?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const t=this.map?.(),e=this.spatialReference;if(!e)return{updating:this._spatialReferenceTask.updating};let i;const n=this._collectLayers([{parent:t?.basemap,layers:t?.basemap?.baseLayers},{layers:t?.layers}],(t=>!(!("tileInfo"in t)||!t.tileInfo?.spatialReference.equals(e))&&(i=t,!0)),(t=>"tileInfo"in t));if(i){return{tileInfo:i.tileInfo,updating:!1}}return{updating:n}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let t={};const e=this._collectLayers(this.mapCollections,(e=>{const i=vU(e);return!!i&&(t={heightModelInfo:i,vcsWkid:e.spatialReference?.vcsWkid,latestVcsWkid:e.spatialReference?.latestVcsWkid},!0)}),(t=>_U(t)));return{...t,updating:e}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const t=[],e=this._collectLayers(this.mapCollections,(e=>{const i="fullExtents"in e&&e.fullExtents||(null!=e.fullExtent?[e.fullExtent]:[]),n=this.requiresExtentInSpatialReference?null:i[0],s=i.find((t=>t.spatialReference.equals(this.spatialReference)))??n;if(s)return t.push({extent:s,layer:e}),!0;if(this._getSupportedSpatialReferences(e).length>0)for(const n of i)t.push({extent:n,layer:e});return!1}));return{candidates:t,updating:e}}get _extentTask(){const{candidates:t,updating:e}=this._extentCandidatesTask;if(e)return{updating:e};if(null==t||0===t.length)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(t),n=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:null!=this._projectExtentTask.task&&!this._projectExtentTask.task.finished}:(null!=this._projectExtentTask.task&&(this._projectExtentTask.task=Cn(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:n.clone(),task:Xm((async t=>{try{const e=await EU(i.extent,n,"portalItem"in i.layer?i.layer.portalItem:void 0,t);this._projectExtentTask={...this._projectExtentTask,task:null,output:e}}catch(e){if(Ms(t))return;this._projectExtentTask={...this._projectExtentTask,task:null}}}))},{updating:!0})}_narrowDownSpatialReferenceCandidates(t,e){if(null==t)return e;const i=new Array;for(const n of t)for(const t of e){if(!n.spatialReference.equals(t.spatialReference))continue;const e=RU(n.viewingMode,t.viewingMode);if(!1!==e){i.push({spatialReference:n.spatialReference,viewingMode:e});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(t){const e=this.defaultSpatialReference;return null==t||t.length<1?e?{spatialReference:e,viewingMode:null}:null:(null!=e&&t.length>1&&t.some((({spatialReference:t})=>t.equals(e)))&&(t=t.filter((({spatialReference:t})=>t.equals(e)))),t.length>1&&t.some((({viewingMode:t})=>t!==TU.Local))&&(t=t.filter((({viewingMode:t})=>t!==TU.Local))),t[0])}_getSupportedSpatialReferences(t){const e="supportedSpatialReferences"in t&&t.supportedSpatialReferences||(t.spatialReference?[t.spatialReference]:[]);if(0===e.length)return[];const i=[];for(const n of e){const e=this.getSpatialReferenceSupport(n,t);if(null!=e){const t=e.constraints??[{spatialReference:n,viewingMode:null}];for(const{spatialReference:e,viewingMode:n}of t)this.requiresExtentInSpatialReference&&null!=this.userSpatialReference&&!e.equals(this.userSpatialReference)||i.push({spatialReference:e,viewingMode:n})}}return i}_pickExtentCandidate(t){const e=this.spatialReference;return t.find((({extent:t})=>e.equals(t.spatialReference)))||t[0]}_collectLayers(t,e,i=(()=>!0)){if("loaded"!==this._loadMaybe(this.map?.()))return!0;const n=new OU(i,e);for(const e of t)if(this._collectCollection(e,n),n.done||n.preloading===this.sourcePreloadCount)break;return n.updating}_collectCollection(t,e){if(t.layers){switch(this._loadMaybe(t.parent)){case"loading":return e.updating=!0,void++e.preloading;case"failed":return}for(const i of t.layers)if(e.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":e.updating=!0,++e.preloading;break;case"loaded":if(e.updating||(e.done=e.pushLayer(i)),e.done||e.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},e)}if(e.done||e.preloading===this.sourcePreloadCount)break}}}_loadMaybe(t){return t&&"loadStatus"in t&&null!=t.loadStatus?"not-loaded"===t.loadStatus?(t.load().catch((t=>{})),"loading"):t.loadStatus:"loaded"}};r([Je()],jU.prototype,"required",void 0),r([Je({constructOnly:!0})],jU.prototype,"map",void 0),r([Je({constructOnly:!0})],jU.prototype,"getSpatialReferenceSupport",void 0),r([Je()],jU.prototype,"defaultSpatialReference",void 0),r([Je()],jU.prototype,"userSpatialReference",void 0),r([Je()],jU.prototype,"sourcePreloadCount",void 0),r([Je()],jU.prototype,"priorityCollection",void 0),r([Je()],jU.prototype,"requiresExtentInSpatialReference",void 0),r([Je()],jU.prototype,"suspended",void 0),r([Je({readOnly:!0})],jU.prototype,"ready",null),r([Je({readOnly:!0})],jU.prototype,"heightModelInfoReady",null),r([Je({readOnly:!0})],jU.prototype,"spatialReference",null),r([Je({readOnly:!0})],jU.prototype,"extent",null),r([Je({readOnly:!0})],jU.prototype,"heightModelInfo",null),r([Je({readOnly:!0})],jU.prototype,"vcsWkid",null),r([Je({readOnly:!0})],jU.prototype,"latestVcsWkid",null),r([Je({readOnly:!0})],jU.prototype,"viewingMode",null),r([Je({readOnly:!0})],jU.prototype,"tileInfo",null),r([Je({readOnly:!0})],jU.prototype,"mapCollections",null),r([Je({readOnly:!0})],jU.prototype,"_spatialReferenceTask",null),r([Je({readOnly:!0})],jU.prototype,"_tileInfoTask",null),r([Je({readOnly:!0})],jU.prototype,"_heightModelInfoTask",null),r([Je({readOnly:!0})],jU.prototype,"_extentCandidatesTask",null),r([Je()],jU.prototype,"_extentTask",null),r([Je()],jU.prototype,"_projectExtentTask",void 0),jU=r([ln("esri.views.support.DefaultsFromMap")],jU);class OU{constructor(t,e){this.layerFilter=t,this.pushLayer=e,this.preloading=-1,this.updating=!1,this.done=!1}}function RU(t,e){return null!=t?null!=e?t===e&&t:t:e}var LU;let NU=LU=class extends(Tm.EventedMixin(jM(ao))){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new Sn,this.updatingHandles=new SS,this.allLayerViews=new my({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:DU}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new RD,this.analyses=new HC,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Vm,this.magnifier=new GD,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Jz,this.navigation=new tU,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new oz(this),this.persistableViewModels=new Vm,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(ey((()=>this.preconditionsReady),(t=>{const e=this.ready;if(t?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,LU.views.add(this)):(this._lockedSpatialReference=null,LU.views.remove(this)),this.notifyChange("spatialReference"),!t&&e)this.toolViewManager?.detach(),null!=this.analysisViewManager&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(t&&!e){try{this._startup()}catch(t){return void queueMicrotask((()=>{this.fatalError=new Ve("startup-error",null,t)}))}null!=this.analysisViewManager&&this.analysisViewManager.attach(),this.toolViewManager.attach()}}),hy))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then((()=>(this._isValid=!0,oy((()=>this.ready)))))),this.basemapView=new ND({view:this}),this.layerViewManager=new zD({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new Uz({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new Q$({view:this}),this.addHandles([ey((()=>this.initialExtentRequired),(t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t}),fy),ey((()=>this.ready),(t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)}),hy),ey((()=>this._userSpatialReference),(t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)}),fy)])}_setupSpatialReferenceLogger(){let t=null;this.addHandles([ey((()=>this.defaultsFromMap?.ready),(e=>{const i=this.map?.allLayers.length>0;if(e&&!this.spatialReference&&i){if(null!=t)return;const e=we((()=>t=Cn(t)));t=Xm((async e=>{try{await Ns(this.spatialReferenceWarningDelay,null,e)}catch{return}finally{t=null}jt.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})),this.addHandles(e,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")}),{sync:!0})])}destroy(){this.destroyed||(LU.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=An(this.graphics),this.analyses=An(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),An(this.analysisViewManager),this.toolViewManager=An(this.toolViewManager),this.layerViewManager=An(this.layerViewManager),this.selectionManager=An(this.selectionManager),this.basemapView=An(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach((t=>t.destroy())),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=An(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return jt.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new jU({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(t,e)=>this.getSpatialReferenceSupport(t,e),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||$M.isLoadable(this.map)&&!this.map.loaded||0===this.width||0===this.height||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t?.destroyed&&(jt.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),$M.isLoadable(t)&&t.load().catch((()=>{})),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get spatialReference(){const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&this.defaultsFromMap?.required?.heightModelInfo){const e=t.clone();return e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,e}return t}set spatialReference(t){const e=!Gu(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(t){this._userTimeExtent=t}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??og}set timeZone(t){this._userTimeZone=t,wg(t)||jt.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new tz}whenLayerView(t){return this.layerViewManager?.whenLayerView(t)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(t){throw new Ve("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return null!=this.getSpatialReferenceSupport(t)}when(t,e){return this.isResolved()&&!this.ready&&jt.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(iy((()=>this.destroyed||!1===this.preconditionsReady),(()=>this._readyCycleForced=!1),{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};NU.views=new Vm,r([Je()],NU.prototype,"_userSpatialReference",void 0),r([Je()],NU.prototype,"activeTool",null),r([Je({readOnly:!0})],NU.prototype,"allLayerViews",void 0),r([Je()],NU.prototype,"groundView",void 0),r([Je()],NU.prototype,"animation",null),r([Je()],NU.prototype,"basemapView",void 0),r([Je()],NU.prototype,"center",null),r([Je()],NU.prototype,"defaultsFromMapSettings",null),r([Je()],NU.prototype,"defaultsFromMap",null),r([Je()],NU.prototype,"fatalError",void 0),r([Je({type:Od})],NU.prototype,"extent",null),r([Je(FC(RD,"graphics"))],NU.prototype,"graphics",void 0),r([Je(FC(HC,"analyses"))],NU.prototype,"analyses",void 0),r([Je({readOnly:!0,type:qC})],NU.prototype,"heightModelInfo",null),r([Je({readOnly:!0})],NU.prototype,"interacting",null),r([Je({readOnly:!0})],NU.prototype,"navigating",null),r([Je({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],NU.prototype,"preconditionsReady",null),r([Je({readOnly:!0})],NU.prototype,"typeSpecificPreconditionsReady",void 0),r([Je({type:Vm,readOnly:!0})],NU.prototype,"layerViews",void 0),r([Je()],NU.prototype,"resolution",null),r([Je({type:GD})],NU.prototype,"magnifier",void 0),r([Je({value:null,type:NC})],NU.prototype,"map",null),r([Je()],NU.prototype,"padding",void 0),r([Je({readOnly:!0})],NU.prototype,"ready",void 0),r([Je({type:wh})],NU.prototype,"spatialReference",null),r([Je()],NU.prototype,"spatialReferenceWarningDelay",void 0),r([Je()],NU.prototype,"stationary",null),r([Je({readOnly:!0})],NU.prototype,"supportsGround",void 0),r([Je({type:MC})],NU.prototype,"timeExtent",null),r([Je({type:String,nonNullable:!0})],NU.prototype,"timeZone",null),r([Je()],NU.prototype,"tools",null),r([Je()],NU.prototype,"toolViewManager",void 0),r([Je({readOnly:!0})],NU.prototype,"type",void 0),r([Je({type:Number})],NU.prototype,"scale",void 0),r([Je({readOnly:!0})],NU.prototype,"updating",void 0),r([Je({readOnly:!0})],NU.prototype,"initialExtentRequired",void 0),r([Je({readOnly:!0})],NU.prototype,"initialExtent",null),r([Je()],NU.prototype,"cursor",null),r([Je({readOnly:!0})],NU.prototype,"input",void 0),r([Je({type:tU,nonNullable:!0})],NU.prototype,"navigation",void 0),r([Je()],NU.prototype,"layerViewManager",void 0),r([Je()],NU.prototype,"analysisViewManager",void 0),r([Je()],NU.prototype,"selectionManager",void 0),r([Je()],NU.prototype,"width",void 0),r([Je()],NU.prototype,"height",void 0),r([Je({readOnly:!0})],NU.prototype,"resizing",void 0),r([Je({value:null,readOnly:!0})],NU.prototype,"size",null),r([Je({readOnly:!0})],NU.prototype,"suspended",void 0),r([Je({readOnly:!0})],NU.prototype,"viewEvents",void 0),r([Je({readOnly:!0})],NU.prototype,"persistableViewModels",void 0),r([Je()],NU.prototype,"_isValid",void 0),r([Je()],NU.prototype,"_readyCycleForced",void 0),r([Je()],NU.prototype,"_lockedSpatialReference",void 0),r([Je()],NU.prototype,"_userTimeZone",void 0),r([Je()],NU.prototype,"_lockedTimeZone",void 0),r([Je()],NU.prototype,"_userTimeExtent",void 0),r([Je()],NU.prototype,"_lockedTimeExtent",void 0),r([Je({type:tz})],NU.prototype,"theme",void 0),r([Je({readOnly:!0,type:tz})],NU.prototype,"effectiveTheme",null),NU=LU=r([ln("esri.views.View")],NU);const PU=globalThis.$arcgis;PU&&!PU.views&&Object.defineProperty(PU,"views",{configurable:!1,enumerable:!0,writable:!1,value:NU.views});const FU=NU;function DU(t){return t.layerViews}function $U(){return[0,0]}function zU(t){return[t[0],t[1]]}function UU(t,e){return[t,e]}function BU(t,e=$U()){const i=Math.min(2,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function GU(t,e){return new Float64Array(t,e,2)}function VU(){return $U()}function qU(){return UU(1,1)}function HU(){return UU(1,0)}function WU(){return UU(0,1)}const ZU=VU(),JU=qU(),YU=HU(),KU=WU();Object.freeze(Object.defineProperty({__proto__:null,ONES:JU,UNIT_X:YU,UNIT_Y:KU,ZEROS:ZU,clone:zU,create:$U,createView:GU,fromArray:BU,fromValues:UU,ones:qU,unitX:HU,unitY:WU,zeros:VU},Symbol.toStringTag,{value:"Module"}));let QU=class extends OM{constructor(t){super(t),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=zs(),this.addResolvingPromise(this._resolver.promise)}get done(){return"finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._resolver?.reject(new Ve("ViewAnimation stopped")))}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._resolver?.resolve())}update(t,e){e||(e=Fs(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",e)}};r([Je({readOnly:!0})],QU.prototype,"done",null),r([Je({readOnly:!0,type:String})],QU.prototype,"state",void 0),r([Je()],QU.prototype,"target",void 0),QU=r([ln("esri.views.ViewAnimation")],QU),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(QU||(QU={}));const XU=QU;function tB(t,e){return t[0]=e[0],t[1]=e[1],t}function eB(t,e,i){return t[0]=e,t[1]=i,t}function iB(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function nB(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function sB(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function rB(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function oB(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function aB(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function lB(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function uB(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function cB(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function hB(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function dB(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t}function fB(t,e){const i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)}function pB(t,e){const i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n}function mB(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function yB(t){const e=t[0],i=t[1];return e*e+i*i}function gB(t,e){return t[0]=-e[0],t[1]=-e[1],t}function vB(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function wB(t,e){const i=e[0],n=e[1];let s=i*i+n*n;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s),t}function bB(t,e){return t[0]*e[0]+t[1]*e[1]}function SB(t,e,i){const n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t}function _B(t,e,i,n){const s=e[0],r=e[1];return t[0]=s+n*(i[0]-s),t[1]=r+n*(i[1]-r),t}function xB(t,e=1){const i=2*mI()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function MB(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[2]*s,t[1]=i[1]*n+i[3]*s,t}function TB(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[2]*s+i[4],t[1]=i[1]*n+i[3]*s+i[5],t}function AB(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[3]*s+i[6],t[1]=i[1]*n+i[4]*s+i[7],t}function IB(t,e,i){const n=e[0],s=e[1];return t[0]=i[0]*n+i[4]*s+i[12],t[1]=i[1]*n+i[5]*s+i[13],t}function kB(t,e,i,n){const s=e[0]-i[0],r=e[1]-i[1],o=Math.sin(n),a=Math.cos(n);return t[0]=s*a-r*o+i[0],t[1]=s*o+r*a+i[1],t}function CB(t,e){const i=t[0],n=t[1],s=e[0],r=e[1];let o=i*i+n*n;o>0&&(o=1/Math.sqrt(o));let a=s*s+r*r;a>0&&(a=1/Math.sqrt(a));const l=(i*s+n*r)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function EB(t){return"vec2("+t[0]+", "+t[1]+")"}function jB(t,e){return t[0]===e[0]&&t[1]===e[1]}function OB(t,e){const i=t[0],n=t[1],s=e[0],r=e[1],o=fI();return Math.abs(i-s)<=o*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-r)<=o*Math.max(1,Math.abs(n),Math.abs(r))}function RB(t,e,i,n,s){let r=e[0]-i[0],o=e[1]-i[1];const a=(n[0]*r+n[1]*o)*(s-1);return r=n[0]*a,o=n[1]*a,t[0]=e[0]+r,t[1]=e[1]+o,t}const LB=mB,NB=nB,PB=sB,FB=rB,DB=fB,$B=pB,zB=yB;Object.freeze(Object.defineProperty({__proto__:null,add:iB,angle:CB,ceil:oB,copy:tB,cross:SB,dist:DB,distance:fB,div:FB,divide:rB,dot:bB,equals:OB,exactEquals:jB,floor:aB,inverse:vB,len:LB,length:mB,lerp:_B,max:uB,min:lB,mul:PB,multiply:sB,negate:gB,normalize:wB,projectAndScale:RB,random:xB,rotate:kB,round:cB,scale:hB,scaleAndAdd:dB,set:eB,sqrDist:$B,sqrLen:zB,squaredDistance:pB,squaredLength:yB,str:EB,sub:NB,subtract:nB,transformMat2:MB,transformMat2d:TB,transformMat3:AB,transformMat4:IB},Symbol.toStringTag,{value:"Module"}));function UB(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function BB(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function GB(t,e,i,n,s,r,o){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=r,t[5]=o,t}function VB(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5];let l=i*r-n*s;return l?(l=1/l,t[0]=r*l,t[1]=-n*l,t[2]=-s*l,t[3]=i*l,t[4]=(s*a-r*o)*l,t[5]=(n*o-i*a)*l,t):null}function qB(t){return t[0]*t[3]-t[1]*t[2]}function HB(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1],h=i[2],d=i[3],f=i[4],p=i[5];return t[0]=n*u+r*c,t[1]=s*u+o*c,t[2]=n*h+r*d,t[3]=s*h+o*d,t[4]=n*f+r*p+a,t[5]=s*f+o*p+l,t}function WB(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(i),c=Math.cos(i);return t[0]=n*c+r*u,t[1]=s*c+o*u,t[2]=n*-u+r*c,t[3]=s*-u+o*c,t[4]=a,t[5]=l,t}function ZB(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1];return t[0]=n*u,t[1]=s*u,t[2]=r*c,t[3]=o*c,t[4]=a,t[5]=l,t}function JB(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1];return t[0]=n,t[1]=s,t[2]=r,t[3]=o,t[4]=n*u+r*c+a,t[5]=s*u+o*c+l,t}function YB(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t[4]=0,t[5]=0,t}function KB(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function QB(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function XB(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function tG(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function eG(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t}function iG(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}function nG(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t}function sG(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t}function rG(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function oG(t,e){const i=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],f=e[5],p=fI();return Math.abs(i-l)<=p*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-u)<=p*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(s-c)<=p*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(r-h)<=p*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=p*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-f)<=p*Math.max(1,Math.abs(a),Math.abs(f))}const aG=HB,lG=iG;Object.freeze(Object.defineProperty({__proto__:null,add:eG,copy:UB,determinant:qB,equals:oG,exactEquals:rG,frob:tG,fromRotation:YB,fromScaling:KB,fromTranslation:QB,identity:BB,invert:VB,mul:aG,multiply:HB,multiplyScalar:nG,multiplyScalarAndAdd:sG,rotate:WB,scale:ZB,set:GB,str:XB,sub:lG,subtract:iG,translate:JB},Symbol.toStringTag,{value:"Module"}));function uG(){return[1,0,0,1,0,0]}function cG(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function hG(t,e,i,n,s,r){return[t,e,i,n,s,r]}function dG(t,e){return new Float64Array(t,e,6)}const fG=uG();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:fG,clone:cG,create:uG,createView:dG,fromValues:hG},Symbol.toStringTag,{value:"Module"}));const pG={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new Kp({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:wh.WebMercator}),minus180Line:new Kp({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:wh.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Kp({paths:[[[180,-180],[180,180]]],spatialReference:wh.WGS84}),minus180Line:new Kp({paths:[[[-180,-180],[-180,180]]],spatialReference:wh.WGS84})}};function mG(t,e){return Math.ceil((t-e)/(2*e))}function yG(t,e){const i=gG(t);for(const t of i)for(const i of t)i[0]+=e;return t}function gG(t){return sm(t)?t.rings:t.paths}function vG(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function wG(t){return"string"==typeof t?ca(t):nt(t)}function bG(t,e,i){const n={};for(const s in t){if("declaredClass"===s)continue;const r=t[s];if(null!=r&&"function"!=typeof r)if(Array.isArray(r))n[s]=r.map((t=>bG(t)));else if("object"==typeof r)if(r.toJSON){const t=r.toJSON(i?.[s]);n[s]=e?t:JSON.stringify(t)}else n[s]=e?r:JSON.stringify(r);else n[s]=r}return n}async function SG(t,e,i,n){const s=wG(t),r=e[0].spatialReference,o={...n,responseType:"json",query:{...s.query,f:"json",sr:qu(r),target:JSON.stringify({geometryType:om(e[0]),geometries:e}),cutter:JSON.stringify(i)}},a=await Pl(s.path+"/cut",o),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map((t=>{const e=rm(t);return e.spatialReference=r,e}))}}function _G(t){return{geometryType:om(t[0]),geometries:t.map((t=>t.toJSON()))}}function xG(t,e,i){const n=lm(e);return t.map((t=>{const e=n.fromJSON(t);return e.spatialReference=i,e}))}async function MG(t,e,i){const n="string"==typeof t?ca(t):t,s=e[0].spatialReference,r=om(e[0]),o={...i,query:{...n.query,f:"json",sr:qu(s),geometries:JSON.stringify(_G(e))}},{data:a}=await Pl(n.path+"/simplify",o);return xG(a.geometries,r,s)}const TG=()=>jt.getLogger("esri.geometry.support.normalizeUtils");function AG(t){return"polygon"===t.type}function IG(t){return"polygon"===t[0].type}function kG(t){return"polyline"===t[0].type}function CG(t){const e=[];let i=0,n=0;for(let s=0;s<t.length;s++){const r=t[s];let o=null;for(let t=0;t<r.length;t++)o=r[t],e.push(o),0===t?(i=o[0],n=i):(i=Math.min(i,o[0]),n=Math.max(n,o[0]));o&&e.push([(i+n)/2,0])}return e}function EG(t,e){if(!(t instanceof Kp||t instanceof qp)){const t="straightLineDensify: the input geometry is neither polyline nor polygon";throw TG().error(t),new Ve(t)}const i=gG(t),n=[];for(const t of i){const i=[];n.push(i),i.push([t[0][0],t[0][1]]);for(let n=0;n<t.length-1;n++){const s=t[n][0],r=t[n][1],o=t[n+1][0],a=t[n+1][1],l=Math.sqrt((o-s)*(o-s)+(a-r)*(a-r)),u=(a-r)/l,c=(o-s)/l,h=l/e;if(h>1){for(let t=1;t<=h-1;t++){const n=t*e,o=c*n+s,a=u*n+r;i.push([o,a])}const t=(l+Math.floor(h-1)*e)/2,n=c*t+s,o=u*t+r;i.push([n,o])}i.push([o,a])}}return AG(t)?new qp({rings:n,spatialReference:t.spatialReference}):new Kp({paths:n,spatialReference:t.spatialReference})}function jG(t,e,i){if(e){const e=EG(t,1e6);t=Uh(e,!0)}return i&&(t=yG(t,i)),t}function OG(t,e,i){if(Array.isArray(t)){const n=t[0];if(n>e){const i=mG(n,e);t[0]=n+i*(-2*e)}else if(n<i){const e=mG(n,i);t[0]=n+e*(-2*i)}}else{const n=t.x;if(n>e){const i=mG(n,e);t=t.clone().offset(i*(-2*e),0)}else if(n<i){const e=mG(n,i);t=t.clone().offset(e*(-2*i),0)}}return t}function RG(t,e){let i=-1;for(let n=0;n<e.cutIndexes.length;n++){const s=e.cutIndexes[n],r=e.geometries[n],o=gG(r);for(let t=0;t<o.length;t++){const e=o[t];e.some((i=>{if(i[0]<180)return!0;{let i=0;for(let t=0;t<e.length;t++){const n=e[t][0];i=n>i?n:i}i=Number(i.toFixed(9));const n=-360*mG(i,180);for(let i=0;i<e.length;i++){const e=r.getPoint(t,i);r.setPoint(t,i,e.clone().offset(n,0))}return!0}}))}if(s===i){if(IG(t))for(const e of gG(r))t[s]=t[s].addRing(e);else if(kG(t))for(const e of gG(r))t[s]=t[s].addPath(e)}else i=s,t[s]=r}return t}async function LG(t,e,i){if(!Array.isArray(t))return LG([t],e);e&&"string"!=typeof e&&TG().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const n="string"==typeof e?e:e?.url??St.geometryServiceUrl;let s,r,o,a,l,u,c,h,d=0;const f=[],p=[];for(const e of t)if(null!=e)if(s||(s=e.spatialReference,r=Vu(s),o=s.isWebMercator,u=o?102100:4326,a=pG[u].maxX,l=pG[u].minX,c=pG[u].plus180Line,h=pG[u].minus180Line),r)if("mesh"===e.type)p.push(e);else if("point"===e.type)p.push(OG(e.clone(),a,l));else if("multipoint"===e.type){const t=e.clone();t.points=t.points.map((t=>OG(t,a,l))),p.push(t)}else if("extent"===e.type){const t=e.clone()._normalize(!1,!1,r);p.push(t.rings?new qp(t):t)}else if(e.extent){const t=e.extent,i=mG(t.xmin,l)*(2*a);let n=0===i?e.clone():yG(e.clone(),i);t.offset(i,0);let{xmin:s,xmax:r}=t;s=Number(s.toFixed(9)),r=Number(r.toFixed(9)),t.intersects(c)&&r!==a?(d=r>d?r:d,n=jG(n,o),f.push(n),p.push("cut")):t.intersects(h)&&s!==l?(d=r*(2*a)>d?r*(2*a):d,n=jG(n,o,360),f.push(n),p.push("cut")):p.push(n)}else p.push(e.clone());else p.push(e);else p.push(e);let m=mG(d,a),y=-90;const g=m,v=new Kp;for(;m>0;){const t=360*m-180;v.addPath([[t,y],[t,-1*y]]),y*=-1,m--}if(f.length>0&&g>0){const e=RG(f,await SG(n,f,v,i)),s=[],r=[];for(let i=0;i<p.length;i++){const n=p[i];if("cut"!==n)r.push(n);else{const n=e.shift(),a=t[i];null!=a&&"polygon"===a.type&&a.rings&&a.rings.length>1&&n.rings.length>=a.rings.length?(s.push(n),r.push("simplify")):r.push(o?zh(n):n)}}if(!s.length)return r;const a=await MG(n,s,i),l=[];for(let t=0;t<r.length;t++){const e=r[t];"simplify"!==e?l.push(e):l.push(o?zh(a.shift()):a.shift())}return l}const w=[];for(let t=0;t<p.length;t++){const e=p[t];if("cut"!==e)w.push(e);else{const t=f.shift();w.push(!0===o?zh(t):t)}}return w}function NG(t){if(!t)return null;const e=t.extent;if(!e)return null;const i=t.spatialReference&&Vu(t.spatialReference);if(!i)return e;const[n,s]=i.valid,r=2*s,{width:o}=e;let a,{xmin:l,xmax:u}=e;if([l,u]=[u,l],"extent"===t.type||0===o||o<=s||o>r||l<n||u>s)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=CG(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=CG(t.paths);break;case"multipoint":a=t.points}const c=e.clone();for(let t=0;t<a.length;t++){let e=a[t][0];e<0?(e+=s,u=Math.max(e,u)):(e-=s,l=Math.min(e,l))}return c.xmin=l,c.xmax=u,c.width<o?(c.xmin-=s,c.xmax-=s,c):e}function PG(t,e,i){const n=Vu(i);if(null==n)return t;const[s,r]=n.valid,o=2*r;let a=0,l=0;e>r?a=Math.ceil(Math.abs(e-r)/o):e<s&&(a=-Math.ceil(Math.abs(e-s)/o)),t>r?l=Math.ceil(Math.abs(t-r)/o):t<s&&(l=-Math.ceil(Math.abs(t-s)/o));let u=t+(a-l)*o;const c=u-e;return c>r?u-=o:c<s&&(u+=o),u}function FG(t,e){const i=Vu(e);if(i){const[e,n]=i.valid,s=n-e;if(t<e)for(;t<e;)t+=s;if(t>n)for(;t>n;)t-=s}return t}const DG=96,$G=39.37,zG=180/Math.PI;function UG(t){return t.wkid?t:t.spatialReference||wh.WGS84}function BG(t,e){return e.type?eB(t,e.x,e.y):tB(t,e)}function GG(t){return Yc(t)}function VG(t,e,i=0){let n=t.width,s=t.height;if(0!==i){const e=xf(i),r=Math.abs(Math.cos(e)),o=Math.abs(Math.sin(e));n=t.width*r+t.height*o,s=t.width*o+t.height*r}const r=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(n/r,s/o)*rV(t.spatialReference)}async function qG(t,e,i,n){let s,r;if(!t)return null;if(Array.isArray(t)&&!t.length)return null;if(Vm.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&"object"==typeof t[0]){const s=t.every((t=>"attributes"in t)),r=t.some((t=>!t.geometry));let o=t;if(s&&r&&e&&e.allLayerViews){const i=new Map;for(const e of t){const t=e.layer,n=i.get(t)||[],s=e.attributes[t.objectIdField];null!=s&&n.push(s),i.set(t,n)}const n=[];i.forEach(((t,i)=>{const s=e.allLayerViews.find((t=>t.layer.id===i.id));if(s&&"queryFeatures"in s){const e=i.createQuery();e.objectIds=t,e.returnGeometry=!0,n.push(s.queryFeatures(e))}}));const s=await Promise.all(n),r=[];for(const t of s)if(t&&t.features&&t.features.length)for(const e of t.features)null!=e.geometry&&r.push(e.geometry);o=r}for(const t of o)n=await qG(t,e,i,n);return n}if(Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])s=new Kh(t);else if(t instanceof Sh)s=t;else if("geometry"in t)if(t.geometry)s=t.geometry;else if(t.layer){const i=t.layer,n=e.allLayerViews.find((t=>t.layer.id===i.id));if(n&&"queryFeatures"in n){const e=i.createQuery();e.objectIds=[t.attributes[i.objectIdField]],e.returnGeometry=!0;const r=await n.queryFeatures(e);s=r?.features?.[0]?.geometry}}if(null==s)return null;switch(s.type){case"point":r=new Od({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":r=NG(s);break;default:r=s.extent}if(!r)return null;Ib()||Gb(r.spatialReference,i)||await jb();const o=Ob(r,i);if(!o)return null;if(n){const t=o.center,e=t.clone();e.x=PG(t.x,n.center.x,i),e.x!==t.x&&o.centerAt(e),n=n.union(o)}else n=o;return n}function HG(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&null!=t.layer?.minScale&&null!=t.layer.maxScale){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,i=0;for(const n of t){const t=n.layer;t?.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,i=t.maxScale>i?t.maxScale:i)}return e&&i?{min:e,max:i}:null}}}function WG(t,e){const i=UG(t);return Gu(i,e)||i.imageCoordinateSystem||e.imageCoordinateSystem?t:Ob(t,e)}async function ZG(t,e){if(!t||!e)return new _m({targetGeometry:new Kh,scale:0,rotation:0});let i=e.spatialReference;const{constraints:n,padding:s,viewpoint:r,size:o}=e,a=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let l=null;t instanceof _m?l=t:t.viewpoint?l=t.viewpoint:t.target&&"esri.Viewpoint"===t.target.declaredClass&&(l=t.target);let u=null;l?.targetGeometry?u=l.targetGeometry:t instanceof Od?u=t:t instanceof Sh?u=await qG(t,e,i):t&&(u=await qG(t.center,e,i)||await qG(t.target,e,i)||await qG(t,e,i)),!u&&r?.targetGeometry?u=r.targetGeometry:!u&&e.extent&&(u=e.extent),i||(i=UG(e.spatialReference||e.extent||u)),Ib()||Gu(u.spatialReference,i)||Gb(u.spatialReference,i)||await jb();const c=WG(u,i),h="center"in c?c.center:c;!1!==e.pickClosestTarget&&"point"===h.type&&"point"===r.targetGeometry?.type&&(h.x=PG(h.x,r.targetGeometry.x,h.spatialReference));let d=0;l?d=l.rotation:t.hasOwnProperty("rotation")?d=t.rotation:r&&(d=r.rotation);let f=0;f=null!=l?.targetGeometry&&"point"===l.targetGeometry.type?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&-1!==t.zoom&&n&&n.effectiveLODs?n.zoomToScale(t.zoom):Array.isArray(u)||"point"===u.type||"extent"===u.type&&0===u.width&&0===u.height?r.scale:VG(WG(u.extent,i),a,d);const p=HG(t.target??t);p&&(p.min&&p.min<f?f=p.min:p.max&&p.max>f&&(f=p.max));let m=new _m({targetGeometry:h,scale:f,rotation:d});return n&&(m=n.fit(m),n.constrainByGeometry(m),n.rotationEnabled||(m.rotation=r.rotation)),m}function JG(t,e){const i=t.targetGeometry,n=e.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function YG(t,e,i){return i?eB(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):hB(t,e,.5)}const KG=function(){const t=$U();return function(e,i,n){const s=i.targetGeometry;BG(t,s);const r=.5*iV(i);return e.xmin=t[0]-r*n[0],e.ymin=t[1]-r*n[1],e.xmax=t[0]+r*n[0],e.ymax=t[1]+r*n[1],e.spatialReference=s.spatialReference,e}}();function QG(t,e,i,n,s){return pV(t,e,i.center),t.scale=VG(i,n),s?.constraints?.constrain(t),t}function XG(t,e,i,n){return lV(t,e,i,n),VB(t,t)}const tV=function(){const t=$U();return function(e,i,n){return NB(e,oV(e,i),YG(t,i,n))}}(),eV=function(){const t=uG(),e=$U();return function(i,n,s,r){const o=iV(n),a=sV(n);return eB(e,o,o),KB(t,e),WB(t,t,a),JB(t,t,tV(e,s,r)),JB(t,t,[0,r.top-r.bottom]),eB(i,t[4],t[5])}}();function iV(t){return t.scale*nV(t.targetGeometry?.spatialReference)}function nV(t){return null!=t&&sc(t)?1/(GG(t)*$G*DG):1}function sV(t){return vI(t.rotation)||0}function rV(t){return sc(t)?GG(t)*$G*DG:1}function oV(t,e){return hB(t,e,.5)}const aV=function(){const t=$U(),e=$U(),i=$U();return function(n,s,r,o,a,l){return gB(t,s),hB(e,r,.5*l),eB(i,1/o*l,-1/o*l),QB(n,e),a&&WB(n,n,a),ZB(n,n,i),JB(n,n,t),n}}(),lV=function(){const t=$U();return function(e,i,n,s){const r=iV(i),o=sV(i);return BG(t,i.targetGeometry),aV(e,t,n,r,o,s)}}(),uV=function(){const t=$U();return function(e,i,n,s){const r=iV(i);return BG(t,i.targetGeometry),aV(e,t,n,r,0,s)}}();function cV(t){const e=Vu(t);return e?e.valid[1]-e.valid[0]:0}function hV(t,e){return Math.round(cV(t)/e)}const dV=function(){const t=$U(),e=$U(),i=[0,0,0];return function(n,s,r){nB(t,n,s),wB(t,t),nB(e,n,r),wB(e,e),SB(i,t,e);let o=Math.acos(bB(t,e)/(mB(t)*mB(e)))*zG;return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),fV=function(){const t=$U();return function(e,i,n,s){const r=e.targetGeometry;return JG(e,i),eV(t,i,n,s),r.x+=t[0],r.y+=t[1],e}}(),pV=function(t,e,i){JG(t,e);const n=t.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,t},mV=function(){const t=$U();return function(e,i,n,s,r){r||(r="center"),NB(t,n,s),hB(t,t,.5);const o=t[0],a=t[1];switch(r){case"center":eB(t,0,0);break;case"left":eB(t,-o,0);break;case"top":eB(t,0,a);break;case"right":eB(t,o,0);break;case"bottom":eB(t,0,-a);break;case"top-left":eB(t,-o,a);break;case"bottom-left":eB(t,-o,-a);break;case"top-right":eB(t,o,a);break;case"bottom-right":eB(t,o,-a)}return MV(e,i,t),e}}();function yV(t,e,i){return JG(t,e),t.rotation+=i,t}function gV(t,e,i){return JG(t,e),t.rotation=i,t}const vV=function(){const t=$U();return function(e,i,n,s,r){return JG(e,i),isNaN(n)||0===n||(_V(t,s,i,r),e.scale=i.scale*n,xV(t,t,e,r),MV(e,e,eB(t,t[0]-s[0],s[1]-t[1]))),e}}();function wV(t,e,i){return JG(t,e),t.scale=i,t}const bV=function(){const t=$U();return function(e,i,n,s,r,o){return JG(e,i),isNaN(n)||0===n||(_V(t,r,i,o),e.scale=i.scale*n,e.rotation+=s,xV(t,t,e,o),MV(e,e,eB(t,t[0]-r[0],r[1]-t[1]))),e}}(),SV=function(){const t=$U(),e=$U();return function(i,n,s,r,o,a,l){return tV(e,a,l),iB(t,o,e),r?bV(i,n,s,r,t,a):vV(i,n,s,t,a)}}(),_V=function(){const t=uG();return function(e,i,n,s){return TB(e,i,XG(t,n,s,1))}}(),xV=function(){const t=uG();return function(e,i,n,s){return TB(e,i,lV(t,n,s,1))}}(),MV=function(){const t=$U(),e=uG();return function(i,n,s){JG(i,n);const r=iV(n),o=i.targetGeometry;return YB(e,sV(n)),ZB(e,e,UU(r,r)),TB(t,s,e),o.x+=t[0],o.y+=t[1],i}}();function TV(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function AV(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function IV(t,e,i,n,s,r){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=i,o[3]=n,o[4]=s,o[5]=r,o}function kV(t,e){return new Float32Array(t,e,6)}function CV(t,e,i,n){const s=e[n],r=e[n+1];t[n]=i[0]*s+i[2]*r+i[4],t[n+1]=i[1]*s+i[3]*r+i[5]}function EV(t,e,i,n=0,s=0,r=2){const o=s||e.length/r;for(let s=n;s<o;s++){CV(t,e,i,s*r)}}Object.freeze(Object.defineProperty({__proto__:null,clone:AV,create:TV,createView:kV,fromValues:IV,transform:CV,transformMany:EV},Symbol.toStringTag,{value:"Module"}));function jV(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function OV(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function RV(t,e,i,n,s,r,o,a,l,u){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t}function LV(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function NV(t,e){if(t===e){const i=e[1],n=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function PV(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=-c*r+a*l,f=u*r-o*l;let p=i*h+n*d+s*f;return p?(p=1/p,t[0]=h*p,t[1]=(-c*n+s*u)*p,t[2]=(a*n-s*o)*p,t[3]=d*p,t[4]=(c*i-s*l)*p,t[5]=(-a*i+s*r)*p,t[6]=f*p,t[7]=(-u*i+n*l)*p,t[8]=(o*i-n*r)*p,t):null}function FV(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=o*c-a*u,t[1]=s*u-n*c,t[2]=n*a-s*o,t[3]=a*l-r*c,t[4]=i*c-s*l,t[5]=s*r-i*a,t[6]=r*u-o*l,t[7]=n*l-i*u,t[8]=i*o-n*r,t}function DV(t){const e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8];return e*(u*r-o*l)+i*(-u*s+o*a)+n*(l*s-r*a)}function $V(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],f=i[1],p=i[2],m=i[3],y=i[4],g=i[5],v=i[6],w=i[7],b=i[8];return t[0]=d*n+f*o+p*u,t[1]=d*s+f*a+p*c,t[2]=d*r+f*l+p*h,t[3]=m*n+y*o+g*u,t[4]=m*s+y*a+g*c,t[5]=m*r+y*l+g*h,t[6]=v*n+w*o+b*u,t[7]=v*s+w*a+b*c,t[8]=v*r+w*l+b*h,t}function zV(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],f=i[1];return t[0]=n,t[1]=s,t[2]=r,t[3]=o,t[4]=a,t[5]=l,t[6]=d*n+f*o+u,t[7]=d*s+f*a+c,t[8]=d*r+f*l+h,t}function UV(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(i),f=Math.cos(i);return t[0]=f*n+d*o,t[1]=f*s+d*a,t[2]=f*r+d*l,t[3]=f*o-d*n,t[4]=f*a-d*s,t[5]=f*l-d*r,t[6]=u,t[7]=c,t[8]=h,t}function BV(t,e,i){const n=i[0],s=i[1],r=i[2];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=r*e[6],t[7]=r*e[7],t[8]=r*e[8],t}function GV(t,e,i){const n=i[0],s=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t}function VV(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function qV(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function HV(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function WV(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function ZV(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=i+i,a=n+n,l=s+s,u=i*o,c=n*o,h=n*a,d=s*o,f=s*a,p=s*l,m=r*o,y=r*a,g=r*l;return t[0]=1-h-p,t[3]=c-g,t[6]=d+y,t[1]=c+g,t[4]=1-u-p,t[7]=f-m,t[2]=d-y,t[5]=f+m,t[8]=1-u-h,t}function JV(t,e){const i=e[0],n=e[1],s=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10],h=c*o-a*u,d=-c*r+a*l,f=u*r-o*l,p=i*h+n*d+s*f;if(!p)return null;const m=1/p;return t[0]=h*m,t[1]=(-c*n+s*u)*m,t[2]=(a*n-s*o)*m,t[3]=d*m,t[4]=(c*i-s*l)*m,t[5]=(-a*i+s*r)*m,t[6]=f*m,t[7]=(-u*i+n*l)*m,t[8]=(o*i-n*r)*m,t}function YV(t,e){const i=e[0],n=e[1],s=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],y=e[14],g=e[15],v=i*a-n*o,w=i*l-s*o,b=i*u-r*o,S=n*l-s*a,_=n*u-r*a,x=s*u-r*l,M=c*m-h*p,T=c*y-d*p,A=c*g-f*p,I=h*y-d*m,k=h*g-f*m,C=d*g-f*y;let E=v*C-w*k+b*I+S*A-_*T+x*M;return E?(E=1/E,t[0]=(a*C-l*k+u*I)*E,t[1]=(l*A-o*C-u*T)*E,t[2]=(o*k-a*A+u*M)*E,t[3]=(s*k-n*C-r*I)*E,t[4]=(i*C-s*A+r*T)*E,t[5]=(n*A-i*k-r*M)*E,t[6]=(m*x-y*_+g*S)*E,t[7]=(y*b-p*x-g*w)*E,t[8]=(p*_-m*b+g*v)*E,t):null}function KV(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function QV(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function XV(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function tq(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function eq(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function iq(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function nq(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t}function sq(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function rq(t,e){const i=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],f=e[2],p=e[3],m=e[4],y=e[5],g=e[6],v=e[7],w=e[8],b=fI();return Math.abs(i-h)<=b*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-d)<=b*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(s-f)<=b*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(r-p)<=b*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(o-m)<=b*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-y)<=b*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(l-g)<=b*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=b*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-w)<=b*Math.max(1,Math.abs(c),Math.abs(w))}function oq(t){const e=fI(),i=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(n*n+o*o+u*u))<=e&&Math.abs(1-(s*s+a*a+c*c))<=e}const aq=$V,lq=eq;Object.freeze(Object.defineProperty({__proto__:null,add:tq,adjoint:FV,copy:OV,determinant:DV,equals:rq,exactEquals:sq,frob:XV,fromMat2d:WV,fromMat4:jV,fromQuat:ZV,fromRotation:qV,fromScaling:HV,fromTranslation:VV,identity:LV,invert:PV,isOrthoNormal:oq,mul:aq,multiply:$V,multiplyScalar:iq,multiplyScalarAndAdd:nq,normalFromMat4:YV,normalFromMat4Legacy:JV,projection:KV,rotate:UV,scale:BV,scaleByVec2:GV,set:RV,str:QV,sub:lq,subtract:eq,translate:zV,transpose:NV},Symbol.toStringTag,{value:"Module"}));function uq(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function cq(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function hq(t,e,i,n,s,r,o,a,l){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=n,u[4]=s,u[5]=r,u[6]=o,u[7]=a,u[8]=l,u}function dq(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:cq,create:uq,createView:dq,fromValues:hq},Symbol.toStringTag,{value:"Module"}));function fq(){return new Float32Array(2)}function pq(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function mq(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function yq(t,e){return new Float32Array(t,e,2)}function gq(){return fq()}function vq(){return mq(1,1)}function wq(){return mq(1,0)}function bq(){return mq(0,1)}const Sq=gq(),_q=vq(),xq=wq(),Mq=bq();Object.freeze(Object.defineProperty({__proto__:null,ONES:_q,UNIT_X:xq,UNIT_Y:Mq,ZEROS:Sq,clone:pq,create:fq,createView:yq,fromValues:mq,ones:vq,unitX:wq,unitY:bq,zeros:gq},Symbol.toStringTag,{value:"Module"}));function Tq(t){return t instanceof Float32Array&&t.length>=2}function Aq(t){return Array.isArray(t)&&t.length>=2}function Iq(t){return Tq(t)||Aq(t)}var kq;const Cq=[0,0];let Eq=kq=class extends Io{constructor(t){super(t),this._viewpoint2D={center:$U(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Od,this.id=0,this.inverseTransform=uG(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=uG(),this.transformNoRotation=uG(),this.displayMat3=uq(),this.displayViewMat3=uq(),this.viewMat3=uq(),this.viewMat2d=TV(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=JG(i,t.viewpoint),this._set("size",tB(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new kq({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return Iq(e)?TB(t,e,this.inverseTransform):(Cq[0]=e,Cq[1]=i,TB(t,Cq,this.inverseTransform))}toScreen(t,e,i){return Iq(e)?TB(t,e,this.transform):(Cq[0]=e,Cq[1]=i,TB(t,Cq,this.transform))}toScreenNoRotation(t,e,i){return Iq(e)?TB(t,e,this.transformNoRotation):(Cq[0]=e,Cq[1]=i,TB(t,Cq,this.transformNoRotation))}wrapMapCoordinate(t,e){tB(t,e);const[i]=e,[n]=this.center,{extent:s,spatialReference:r}=this;let{xmin:o,xmax:a}=s;if(r.isWrappable){const t=cV(r)/2;o=Math.max(o,n-t),a=Math.min(a,n+t)}return(i<o||i>a)&&(t[0]=PG(i,n,r)),t}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size");return aV(t,i,s,e,0,n),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:n}=this._viewpoint2D,s=this._get("pixelRatio")||1,r=this._get("size"),o=new _m({targetGeometry:new Kh(t[0],t[1],e),scale:i,rotation:n});if(this._set("viewpoint",o),!r||!e||!i)return;this.resolution=iV(o),this.rotation=n,this.scale=i,this.spatialReference=e,tB(this.center,t);const a=0!==r[0]?2/r[0]:0,l=0!==r[1]?-2/r[1]:0;RV(this.displayMat3,a,0,0,0,l,0,-1,1,1);const u=LV(this.viewMat3),c=mq(r[0]/2,r[1]/2),h=mq(-r[0]/2,-r[1]/2),d=vI(n);zV(u,u,c),UV(u,u,d),zV(u,u,h),$V(this.displayViewMat3,this.displayMat3,u);const f=QB(this.viewMat2d,c);return WB(f,f,d),JB(f,f,h),KG(this.extent,o,r),lV(this.transform,o,r,s),VB(this.inverseTransform,this.transform),uV(this.transformNoRotation,o,r,s),this.worldScreenWidth=hV(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};r([Je({readOnly:!0})],Eq.prototype,"id",void 0),r([Je({value:1,json:{write:!0}})],Eq.prototype,"pixelRatio",null),r([Je({json:{write:!0}})],Eq.prototype,"size",null),r([Je()],Eq.prototype,"spatialReference",void 0),r([Je({type:_m,json:{write:!0}})],Eq.prototype,"viewpoint",null),r([Je({readOnly:!0})],Eq.prototype,"visibleArea",null),Eq=kq=r([ln("esri.views.2d.ViewState")],Eq);const jq=Eq;var Oq,Rq;let Lq=Oq=class extends ao{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Oq({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};r([Je()],Lq.prototype,"left",void 0),r([Je()],Lq.prototype,"top",void 0),r([Je()],Lq.prototype,"right",void 0),r([Je()],Lq.prototype,"bottom",void 0),Lq=Oq=r([ln("esri.views.2d.PaddedViewState.Padding")],Lq);let Nq=Rq=class extends jq{constructor(...t){super(...t),this.paddedViewState=new jq,this._updateContent=(()=>{const t=$U();return()=>{const e=this._get("size"),i=this._get("padding");if(!e||!i)return;const n=this.paddedViewState;eB(t,i.left+i.right,i.top+i.bottom),nB(t,e,t),tB(n.size,t);const s=n.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(ey((()=>[this.size,this.padding]),(()=>this._updateContent()),hy)),this.padding=new Lq,this.size=[0,0]}set padding(t){this._set("padding",t||new Lq)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const i=this._get("padding");i&&(e=fV(t.clone(),t,this._get("size"),i));const{targetGeometry:n,rotation:s,scale:r}=e,{x:o,y:a,spatialReference:l}=n,u=this._viewpoint2D;u.center[0]=o,u.center[1]=a,u.rotation=s,u.scale=r,u.spatialReference=l,this._update()}}clone(){return new Rq({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};r([Je()],Nq.prototype,"paddedViewState",void 0),r([Je({type:Lq})],Nq.prototype,"padding",null),r([Je()],Nq.prototype,"viewpoint",null),Nq=Rq=r([ln("esri.views.2d.PaddedViewState")],Nq);const Pq=Nq;function Fq(t,e,i,n){const s=3*t,r=3*(i-t)-s,o=1-s-r,a=3*e,l=3*(n-e)-a,u=1-a-l;function c(t){return((o*t+r)*t+s)*t}function h(t){return((u*t+l)*t+a)*t}function d(t){return(3*o*t+2*r)*t+s}function f(t,e){let i,n,s,r,o,a;for(s=t,a=0;a<8;a++){if(r=c(s)-t,Math.abs(r)<e)return s;if(o=d(s),Math.abs(o)<1e-6)break;s-=r/o}if(i=0,n=1,s=t,s<i)return i;if(s>n)return n;for(;i<n;){if(r=c(s),Math.abs(r-t)<e)return s;t>r?i=s:n=s,s=.5*(n-i)+i}return s}return function(t,e=1e-6){return h(f(t,e))}}const Dq=/^cubic-bezier\((.*)\)/,$q={};function zq(t){let e=$q[t]||null;if(!e){const i=Dq.exec(t);if(i){const t=i[1].split(",").map((t=>parseFloat(t.trim())));4!==t.length||t.some((t=>isNaN(t)))||(e=Fq.apply(Fq,t))}}return e}$q.ease=Fq(.25,.1,.25,1),$q.linear=Fq(0,0,1,1),$q.easeIn=$q["ease-in"]=Fq(.42,0,1,1),$q.easeOut=$q["ease-out"]=Fq(0,0,.58,1),$q.easeInOut=$q["ease-in-out"]=Fq(.42,0,.58,1);class Uq{constructor(t){this._view=t,this.viewpoint=new _m({targetGeometry:new Kh,scale:0,rotation:0})}get view(){return this._view}get size(){const[t,e]=this._view.size;return Math.sqrt(t*t+e*e)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return nV(this.center.spatialReference)}pixelsPerPanAtZoom(t){return 1/(t*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(t){return 1/(t*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(t,e){e.pan=Bh(this.center,t.center);let i=Math.abs(t.rotation-this.rotation);i=i>=180?360-i:i,e.rotate=xf(i),e.sourceZoom=this.scale,e.targetZoom=t.scale}interpolate(t,e,i){const{pan:n,rotate:s,zoom:r,zoomOffset:o}=i,{center:a}=this;a.spatialReference=t.center.spatialReference,a.x=Sf(t.center.x,e.center.x,n),a.y=Sf(t.center.y,e.center.y,n),this.viewpoint.scale=Sf(t.scale,e.scale+o,r);let l=t.rotation;const u=e.rotation;Math.abs(u-l)>=180&&(l+=360*(l<u?1:-1)),this.viewpoint.rotation=Sf(l,u,s)}copyFrom(t){JG(this.viewpoint,t.viewpoint),this._view=t.view}}const Bq=t=>t*t,Gq=t=>1-Bq(1-t),Vq=t=>2**(10*(t-1)),qq=t=>1-Vq(1-t);function Hq(t){const e=2*(t-Math.sqrt((t-1)*t)),i=e/2/t;return n=>n<i?t*n*n:e*n-e+1}function Wq(t,e){return(i,n)=>i<e?e*t(i/e,n):1-t((1-i)/(1-e),n)*(1-e)}const Zq=Wq(Hq(1),.5);class Jq{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}}const Yq={desiredScreenFlow:2,minDuration:Bs(500),maxDuration:Bs(8e3)},Kq={...Yq,maxDuration:Bs(4e3)};class Qq{constructor(t){this._createCamera=t,this.compared=new Jq,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:Yq.desiredScreenFlow},this.source=t(),this.target=t()}clone(){const t=new Qq(this._createCamera);return t.copyFrom(this),t}copyFrom(t){this.update(t.source,t.target,t.settings)}update(t,e,i){this.source!==t&&this.source.copyFrom(t),this.target!==e&&this.target.copyFrom(e),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=i.desiredScreenFlow??Yq.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(t){const e=this.target.pixelsPerPanAtZoom(t);return this.halfWindowSize/e}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>fI()}get hasFov(){return Math.abs(this.compared.fov)>fI()}get hasRotate(){return this.compared.rotate>fI()}}class Xq{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}}let tH=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce(((t,e)=>Vs(t+e.time)),Vs(0))}interpolateComponentsAt(t,e){t=Math.min(Math.max(t,0),1),t*=this.time;let i=0,n=0;const s=this.definition,r=this.segments.reduce(((t,e)=>t||e.definition.hasZoom),!1);for(let o=0;o<this.segments.length;o++){const a=this.segments[o],l=a.definition;if(t<=a.time||o===this.segments.length-1){if(this.segmentInterpolateComponentsAt(a,0===a.time?0:t/a.time,e),s.hasPan&&!isNaN(e.pan)&&isFinite(s.compared.pan)?e.pan=(i+l.compared.pan*e.pan)/s.compared.pan:e.pan=1,s.hasRotate&&!isNaN(e.rotate)&&isFinite(s.compared.rotate)?e.rotate=(n+l.compared.rotate*e.rotate)/s.compared.rotate:e.rotate=1,r&&!isNaN(e.zoom)&&isFinite(l.compared.targetZoom)){const{sourceZoom:t,targetZoom:i}=l.compared,n=e.zoom*(i-t)+t,s=this.segments[0].definition.compared.sourceZoom,r=this.segments[this.segments.length-1].definition.compared.targetZoom,o=Math.abs(i-s)>Math.abs(t-s)?i:t;e.zoomOffset=o-r,e.zoom=(n-s)/(o-s)}else e.zoom=1;return e}t-=a.time,i+=l.compared.pan,n+=l.compared.rotate}}segmentInterpolateComponentsAt(t,e,i){t.interpolateComponentsAt(e,i)}};class eH{get time(){return this._time}constructor(t){t&&this.update(t)}update(t){t&&(this.definition?this.definition.copyFrom(t):this.definition=t.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const t=this.definition,e=t.compared,i=e.sourceZoom,n=e.targetZoom;this._zoomSign=i>n?1:-1,this._panPixelsAtSource=e.pan*t.source.pixelsPerPanAtZoom(i);const s=(t.source.pixelsPerRotate()+t.target.pixelsPerRotate())/2;this._rotatePixels=e.rotate*s}_updatePixelFlow(){const t=this.definition.compared.sourceZoom,e=this.definition.compared.targetZoom,{hasZoom:i,hasPan:n,hasRotate:s}=this.definition;let r=0,o=0;i&&(n&&(r=(e/t-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(o=this._zoomSign*(Math.log(t/e)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const a=this.definition.desiredPixelFlow;if(i&&n&&s){const t=r+o+r*o;this._zoomPixelFlow=r*o/t*a,this._panPixelFlow=o/t*a,this._rotatePixelFlow=r/t*a}else if(i&&n){const t=1+r;this._zoomPixelFlow=r/t*a,this._panPixelFlow=1/t*a}else if(i&&s){const t=1+o;this._zoomPixelFlow=o/t*a,this._rotatePixelFlow=1/t*a}else if(n&&s){const t=this._panPixelsAtSource/this._rotatePixels,e=1+t;this._panPixelFlow=t/e*a,this._rotatePixelFlow=1/e*a}else n?this._panPixelFlow=a:i?this._zoomPixelFlow=a:s&&(this._rotatePixelFlow=a);if(this._time=Vs(Math.max(this.rotateTime,this.zoomTime,this.panTime)),this.fovTime>this._time){const t=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=t,this._panPixelFlow/=t,this._rotatePixelFlow/=t}}get rotateTime(){return this.definition.hasRotate?Vs(this._rotatePixels/this._rotatePixelFlow):Vs(0)}get zoomTime(){return this.definition.hasZoom?Vs(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):Vs(0)}get fovTime(){return this.definition.hasFov?Vs(Math.abs(this.definition.compared.fov)/iH):Vs(0)}get panTime(){if(!this.definition.hasPan)return Vs(0);if(this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,e=t*this._panPixelsAtSource;return Vs(Math.log(e*(this._zoomPixelFlow/this._panPixelFlow)+1)/(t*this._zoomPixelFlow))}return Vs(this._panPixelsAtSource/this._panPixelFlow)}_interpolateComponentsZoom(t){if(0===t||1===t)return t;if(this.definition.hasZoom){const e=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(e*(e/i)**-t-e)/(i-e)}return t}_interpolateComponentsFov(t){if(0===t)return this.definition.segmentStart;if(1===t)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:e,segmentEnd:i}=this.definition;return e+t*(i-e)}return this.definition.segmentStart}_interpolateComponentsPan(t){if(0===t||1===t)return t;if(this.definition.hasPan&&this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(e*t*this._time)-1))/(e*Math.LN2)}return t}_interpolateComponentsRotate(t){return t}interpolateComponentsAt(t,e){t=Math.min(Math.max(t,0),1),e.zoom=this._interpolateComponentsZoom(t),e.pan=this._interpolateComponentsPan(t),e.rotate=this._interpolateComponentsRotate(t),e.zoomOffset=0,e.fov=this._interpolateComponentsFov(t)}}const iH=xf(45);function nH(t,e,i){const n=e-t.compared.sourceZoom,s=t.halfWindowPanAtZoom(n);return-t.halfWindowSize*(i.ascensionFactor*Math.LN2*t.compared.pan+s)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*s)}function sH(t,e,i){const n=1/e,s=Math.log(t.compared.sourceZoom*n),r=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,l=1/a,u=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*r*o*l*u-t.halfWindowSize*s*r*o*l+t.halfWindowSize*s*r*o*u/(a*a)}function rH(t,e,i){const n=e-t.compared.sourceZoom,s=1/n,r=1/e,o=Math.log(t.compared.sourceZoom*r),a=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(n))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*r*a+2*s*o+2*r-2*o*a/(n*n)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function oH(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function aH(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function lH(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function uH(t,e,i){return-t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function cH(t,e,i){return t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function hH(t,e,i){return-2*t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function dH(t,e,i){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function fH(t,e,i){const n=Math.log(e/t.compared.targetZoom),s=1/t.desiredPixelFlow,r=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,l=(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*n*s*r*a+t.halfWindowSize*n*s*r*l/(o*o)+t.halfWindowSize*s*r*a*l/e}function pH(t,e,i){const n=e-t.compared.targetZoom,s=1/n,r=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+i.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*(-2*s*r*a-2*s*o+2*r+2*o*a/(n*n)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function mH(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function yH(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function gH(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function vH(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(0===e)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const i=Math.LN2*t.compared.pan,n=e,s=t.halfWindowPanAtZoom(n),r=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*s);return t.compared.sourceZoom<=t.compared.targetZoom?r*(i-s):r*(i+s)}function wH(t,e){let i=bH(t,e);const n={ascensionFactor:null!=e.ascensionFactor?e.ascensionFactor:.5,descensionFactor:null!=e.descensionFactor?e.descensionFactor:.5},s=0===n.ascensionFactor,r=0===n.descensionFactor,o=s?oH:nH,a=s?aH:sH,l=s?lH:rH,u=r?mH:dH,c=r?yH:fH,h=r?gH:pH,d=e=>o(t,e,n)+uH(t,e,n)+u(t,e,n),f=e=>a(t,e,n)+cH(t,e,n)+c(t,e,n),p=e=>l(t,e,n)+hH(t,e,n)+h(t,e,n);let m=d(i);const y=vH(t);let g;const v=e.maximumIterations||20,w=null!=e.maximumDistance?e.maximumDistance:1/0;for(g=0;g<v;g++){const n=e.desiredSlope??1e-6;let s=f(i);Math.abs(s)>n&&(s+=n);const r=s/p(i);if(isNaN(r)||i>=w&&r<0){if(!isFinite(w))return null;i=w,m=d(i);break}if(i-=r,i<t.compared.sourceZoom||i<t.compared.targetZoom)return null;const o=d(i);if(Math.abs(o-m)/m<=.005)break;m=o}return m>y*(1-.3)||i<t.compared.sourceZoom||i<t.compared.targetZoom?null:i}function bH(t,e){const i=Math.max(t.compared.sourceZoom,t.compared.targetZoom),n=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return n<i?null!=e.maximumDistance?i+(e.maximumDistance-i)/2:1.5*i:e.maximumDistance?Math.min(e.maximumDistance,n):n}class SH extends tH{constructor(t,e){super(),this._preallocSegments=[new eH,new eH,new eH],this._ascensionSegment=null,this._descensionSegment=null,this.update(t,e)}update(t,e){if(!t)return;this.definition?this.definition.copyFrom(t):this.definition=t.clone();const i=e?.apex?wH(t,e.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,e?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(t,e,i){t.interpolateComponentsAt(e,i),t===this._ascensionSegment?i.zoom=Gq(i.zoom):t===this._descensionSegment&&(i.zoom=Bq(i.zoom))}_updateWithApex(t,e){const[i,n,s]=this._preallocSegments,r=e?.ascensionFactor??.5,o=Math.min(1-r,null!=e?.ascensionFactor&&null!=e.descensionFactor?e.descensionFactor:.5),a=1-r-o;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=t,i.definition.compared.pan=this.definition.compared.pan*r,i.definition.compared.rotate=this.definition.compared.rotate*r,i.definition.segmentEnd=r,i.update(),this._ascensionSegment=i,this.segments.push(i),a>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=t,n.definition.compared.targetZoom=t,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.definition.segmentStart=i.definition.segmentEnd,n.definition.segmentEnd=i.definition.segmentEnd+a,n.update(),this.segments.push(n)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=t,s.definition.compared.pan=this.definition.compared.pan*o,s.definition.compared.rotate=this.definition.compared.rotate*o,s.definition.segmentStart=r+a,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[t]=this._preallocSegments;t.update(this.definition),this.segments.push(t)}}const _H=new Xq;let xH=class{get time(){return this._time}get isLinear(){return 1===this.path.segments.length}constructor(t){this._time=Bs(0),this._easing=Zq,this.definition=new Qq(t),this.path=new SH}update(t,e,i){this.definition.update(t,e,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings(Gs(isFinite(this.path.time)?this.path.time:Vs(0)),i),this._easing=i.easing??(this._time>=1e3?Zq:qq)}cameraAt(t,e){t=Math.min(Math.max(0,t),1),t=this._normalizedEasing(t);const i=this.path.interpolateComponentsAt(t,_H);e.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(t){const e=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(t,this._time)-e)/(i-e)}_applyTimeSettings(t,e){const i=null!=e.speedFactor?e.speedFactor:1,n=e.minDuration??Yq.minDuration/i,s=e.maxDuration??Yq.maxDuration/i;return t=null!=e.duration?e.duration:Bs(Math.min(Math.max(t/i,n),s))}};const MH=2e3,TH=64;class AH{constructor(t){this._view=t,this._animation=new xH((()=>new Uq(this._view))),this._current=new Uq(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(t,e,i={}){JG(this._current.viewpoint,t),JG(this._source.viewpoint,t),JG(this._target.viewpoint,e),this._animation.update(this._source,this._target,i)}applyRatio(t,e){this._animation.cameraAt(e,this._current),JG(t,this._current.viewpoint)}}let IH=class extends ao{constructor(t){super(t),this._animation=null,this._destinationViewState=new Pq,this.updateFunction=null,this.easing=$q.ease,this.viewpoint=new _m({targetGeometry:new Kh,scale:0,rotation:0}),this._updateTask=ir({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new AH(t.view)}destroy(){this._updateTask=kn(this._updateTask)}get animation(){return this._animation}set animation(t){this._animation=t,this.view.animation=t}animate(t,e,i){this.stop();const n=this.viewpoint;JG(n,e);const s=("string"==typeof i?.easing?zq(i.easing):i?.easing)||this.easing,r=t.target;this._transition.update(this.viewpoint,r,{apex:{maximumDistance:Math.min(Math.min(e.scale,r.scale)*TH,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:"auto"===i?.animationMode?Bs(1/0):i?.maxDuration??Kq.maxDuration,speedFactor:i?.speedFactor,easing:"function"==typeof s?t=>s(t):void 0}),"auto"===i?.animationMode&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=r,kH(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,r,{duration:Bs(0)}));const o=()=>{this.animation===t&&this._updateTask&&("finished"===t.state&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return t.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinuous(t,e){this.stop(),this.updateFunction=e,this.viewpoint=t;const i=new XU({target:t.clone()}),n=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(t){const e=this.animation;if(e&&e.state!==XU.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime),this.animation?.update(this.viewpoint);else{const t=performance.now()-this._startTime,e=this._transition.duration,i=e>0?t/e:1,n=i>=1;this._transition.applyRatio(this.viewpoint,i),n&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function kH(t,e,i,n){if(null!=e?.duration)return!0;const{time:s,isLinear:r}=t,o=e?.speedFactor||1,a=e?.maxDuration??Kq.maxDuration/o;if(u("esri-goto-debug")&&(console.log("speed factor:",o),console.log("adjusted duration:\t\t",s),console.log("adjusted max duration:\t",a),console.log("is linear:",r)),s>a)return u("esri-goto-debug")&&console.warn(`failed "auto" heuristic: animations must be shorter than ${a/1e3}s`),!1;if(r){const t=1.5,e=$U(),r=eI(...n.toScreen(e,...i.center)),l=eI(...i.toScreen(e,...n.center)),c=null!=l&&l.x>-(t-.5)*i.size[0]&&l.x<(t+.5)*i.size[0]&&l.y>-(t-.5)*i.size[1]&&l.y<(t+.5)*i.size[1],h=null!=r&&r.x>-(t-.5)*n.size[0]&&r.x<(t+.5)*n.size[0]&&r.y>-(t-.5)*n.size[1]&&r.y<(t+.5)*n.size[1];if(u("esri-goto-debug")&&(console.log(`dest is within ${t} screens at start view:`,c),console.log(`start is within ${t} screens at dest view:`,h)),s>MH/o&&!c&&!h)return u("esri-goto-debug")&&console.warn(`failed "auto" heuristic: linear animations must be...\n  - shorter than ${MH/1e3/o}s, or\n  - shorter than ${a/1e3}s and the destination is close enough to the starting screen, or\n  - shorter than ${a/1e3}s and the start point is close enough to the destination screen`),!1}return!0}r([Je()],IH.prototype,"easing",void 0),r([Je()],IH.prototype,"view",void 0),r([Je()],IH.prototype,"viewpoint",void 0),IH=r([ln("esri.views.2d.AnimationManager")],IH);const CH=IH;var EH;!function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"}(EH||(EH={}));const jH=Symbol("Yield");class OH{constructor(){this._tasks=new Array,this._runningTasks=dM(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(t){if(0===this.length)return jH;for(;!t.done&&this._process(t);)t.madeProgress()}push(t,e,i){return++this._runningTasks.value,new Promise(((n,s)=>this._tasks.push(new RH(n,s,t,e,i)))).finally((()=>--this._runningTasks.value))}unshift(t,e,i){return++this._runningTasks.value,new Promise(((n,s)=>this._tasks.unshift(new RH(n,s,t,e,i)))).finally((()=>--this._runningTasks.value))}_process(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const i=Ms(e.signal);if(i&&!e.abortCallback)e.reject(Ss());else{const n=i?e.abortCallback?.(Ss()):e.callback(t);Fs(n)?n.then(e.resolve,e.reject):e.resolve(n)}}catch(t){e.reject(t)}return!0}cancelAll(){const t=Ss();for(const e of this._tasks)if(e.abortCallback){const i=e.abortCallback(t);e.resolve(i)}else e.reject(t);this._tasks.length=0}}class RH{constructor(t,e,i,n=void 0,s=void 0){this.resolve=t,this.reject=e,this.callback=i,this.signal=n,this.abortCallback=s}}let LH=class extends ao{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};r([Je()],LH.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),r([Je()],LH.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),LH=r([ln("esri.views.support.debugFlags")],LH);const NH=new LH;function PH(){return new WH.Scheduler}var FH;!function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t.MAPVIEW_FETCH_QUEUE="mapview fetch queue",t.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",t.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"}(FH||(FH={}));const DH=0,$H=new Map([[FH.RESOURCE_CONTROLLER_IMMEDIATE,DH],[FH.RESOURCE_CONTROLLER,4],[FH.SLIDE,DH],[FH.STREAM_DATA_LOADER,DH],[FH.ELEVATION_QUERY,DH],[FH.TERRAIN_SURFACE,1],[FH.SURFACE_GEOMETRY_UPDATES,1],[FH.LOD_RENDERER,2],[FH.GRAPHICS_CORE,2],[FH.I3S_CONTROLLER,2],[FH.POINT_CLOUD_LAYER,2],[FH.FEATURE_TILE_FETCHER,2],[FH.CLOUDS_GENERATOR,2],[FH.OVERLAY,4],[FH.STAGE,4],[FH.GRAPHICS_DECONFLICTOR,4],[FH.FILTER_VISIBILITY,4],[FH.SCALE_VISIBILITY,4],[FH.FRUSTUM_VISIBILITY,4],[FH.POINT_OF_INTEREST_FREQUENT,6],[FH.POINT_OF_INTEREST_INFREQUENT,30],[FH.LABELER,8],[FH.FEATURE_QUERY_ENGINE,8],[FH.FEATURE_TILE_TREE,16],[FH.FEATURE_TILE_TREE_ACTIVE,DH],[FH.ELEVATION_ALIGNMENT,12],[FH.ELEVATION_ALIGNMENT_SCENE,14],[FH.TEXT_TEXTURE_ATLAS,12],[FH.TEXTURE_UNLOAD,12],[FH.LINE_OF_SIGHT_TOOL,16],[FH.LINE_OF_SIGHT_TOOL_INTERACTIVE,DH],[FH.SNAPPING,DH],[FH.SHADOW_ACCUMULATOR,30],[FH.MAPVIEW_FETCH_QUEUE,DH],[FH.MAPVIEW_LAYERVIEW_UPDATE,2],[FH.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,DH]]);function zH(t){return $H.has(t)?$H.get(t):"number"==typeof t?t:1}const UH=Bs(6.5),BH=Bs(1),GH=Bs(30),VH=Bs(1e3/30),qH=Bs(100),HH=.9;var WH,ZH;!function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((t=>t.needsUpdate))}constructor(){this._updating=dM(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new os("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new n,this._state=EH.INTERACTING,this._tasks=new hs,this._runQueue=new hs,this._load=0,this._idleStateCallbacks=new hs,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=ey((()=>NH.SCHEDULER_LOG_SLOW_TASKS),(t=>this._debug=t),dy);for(const t of Object.keys(FH))this.performanceInfo.tasks.set(FH[t],new os(FH[t]))}destroy(){this._tasks.toArray().forEach((t=>t.remove())),this._tasks.clear(),kn(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(t){this._updatingChanged(),t&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())})))}registerTask(t,e){const n=new i(this,t,e);return this._tasks.push(n),this._updatingChanged(),this.performanceInfo.tasks.has(t)||this.performanceInfo.tasks.set(t,new os(t)),n}registerIdleStateCallbacks(t,e){const i={idleBegin:t,idleEnd:e};this._idleStateCallbacks.push(i),this.state===EH.IDLE&&this._idleUpdatesStartFired&&i.idleBegin();const n=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(t){n._idleUpdatesStartFired&&(i.idleEnd(),n._state===EH.IDLE&&t()),i.idleBegin=t},set idleEnd(t){i.idleEnd=t}}}get load(){return this._load}set state(t){this._state!==t&&(this._state=t,this.state!==EH.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((t=>t.idleEnd()))))}get state(){return this._state}updateBudget(t){this._test&&(this._test.usedBudget=0),++this._frameNumber;let e=UH,i=t.frameDuration,n=BH;switch(this.state){case EH.IDLE:e=Bs(0),i=Bs(Math.max(qH,t.frameDuration)),n=GH;break;case EH.INTERACTING:i=Bs(Math.max(VH,t.frameDuration))}return i=Bs(i-t.elapsedFrameTime-e),this.state!==EH.IDLE&&i<BH&&!this._forceTask?(this._forceTask=!0,!1):(i=Bs(Math.max(i,n)),this._budget.reset(i,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case EH.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((t=>t.idleBegin()))),this._runIdle();break;case EH.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(Bs(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(t){this._idleUpdatesStartFired&&t.idleEnd(),this._idleStateCallbacks.removeUnordered(t)}removeTask(t){this._tasks.removeUnordered(t),this._runQueue.removeUnordered(t),this._updatingChanged()}_updateTask(t){this._tasks.forAll((e=>{e.name===t&&e.setPriority(t)}))}_getState(t){if(this._runQueue.some((e=>e.name===t)))return ZH.SCHEDULED;let e=ZH.IDLE;return this._tasks.forAll((i=>{i.name===t&&i.needsUpdate&&(i.schedulePriority<=1?e=ZH.READY:e!==ZH.READY&&(e=ZH.WAITING))})),e}_getRuntime(t){let e=0;return this._tasks.forAll((i=>{i.name===t&&(e+=i.runtime)})),e}_resetRuntimes(){this._tasks.forAll((t=>t.runtime=0))}_getRunning(){const t=new Map;if(this._tasks.forAll((e=>{e.needsUpdate&&t.set(e.name,(t.get(e.name)||0)+1)})),0===t.size)return null;let e="";return t.forEach(((t,i)=>{e+=t>1?` ${t}x ${i}`:` ${i}`})),e}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const t=this._tasks.reduce(((t,e)=>e.needsUpdate?++t:t),0);this._load=this._load*HH+t*(1-HH)}_schedule(){for(this._runQueue.filterInPlace((t=>!!t.needsUpdate||(t.schedulePriority=t.basePriority,!1))),this._tasks.forAll((t=>{t.basePriority===DH&&t.needsUpdate&&!this._runQueue.includes(t)&&t.blockFrame!==this._frameNumber&&this._runQueue.unshift(t)}));0===this._runQueue.length;){let t=!1;if(this._tasks.forAll((e=>{if(e.needsUpdate&&0!==e.schedulePriority&&e.basePriority!==DH&&e.blockFrame!==this._frameNumber)if(t=!0,1===e.schedulePriority)e.schedulePriority=0,this._runQueue.push(e);else--e.schedulePriority})),!t)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const t=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const e=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.task.runTask(this._budget)===jH&&(i.blockFrame=this._frameNumber)}catch(t){jt.getLogger("esri.views.support.Scheduler").error(`Exception in task "${i.name}"`,t),i.blockFrame=this._frameNumber}!this._budget.hasProgressed&&i.blockFrame!==this._frameNumber&&i.needsUpdate&&(i.blockFrame=this._frameNumber),i.schedulePriority=i.basePriority;const n=this._budget.now()-e;if(i.runtime+=n,this._frameTaskTimes.set(i.priority,this._frameTaskTimes.get(i.priority)+n),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-t)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-t)}_startFrameTaskTimes(){for(const t of Object.keys(FH))this._frameTaskTimes.set(FH[t],0)}_recordFrameTaskTimes(t){this._frameTaskTimes.forEach(((t,e)=>this.performanceInfo.tasks.get(e).push(t))),this.performanceInfo.total.push(t)}get test(){return this._test}}t.Scheduler=e;class i{get task(){return this._task.value}get updating(){return this._queue.running}constructor(t,e,i){this._scheduler=t,this.name=e,this.blockFrame=0,this.runtime=0,this._queue=new OH,this._handles=new Sn,this._basePriority=zH(e),this.schedulePriority=this._basePriority,this._task=dM(null!=i?i:this._queue),this._handles.add(iy((()=>this.task.running),(e=>t.taskRunningChanged(e))))}remove(){this.processQueue(JH),this._scheduler.removeTask(this),this.schedule=KH.schedule,this.reschedule=KH.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(t){if(this.name===t)return;this.name=t;const e=zH(t);this._basePriority!==DH&&0===this.schedulePriority||(this.schedulePriority=e),this._basePriority=e}get priority(){return this.name}set priority(t){this.setPriority(t)}get needsUpdate(){return this.updating||this.task.running}schedule(t,e,i){return this._queue.push(t,e,i)}reschedule(t,e,i){return this._queue.unshift(t,e,i)}processQueue(t){return this._queue.runTask(t)}}class n{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=EH.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(t){return!this.done&&(!0===t()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(t){this._enabled=t}reset(t,e){this._begin=this.now(),this._budget=t,this._state=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=n}(WH||(WH={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(ZH||(ZH={}));const JH=(()=>{const t=new WH.Budget;return t.enabled=!1,t})();class YH{remove(){}processQueue(){}schedule(t,e,i){try{if(Ms(e)){const t=Ss();return i?Promise.resolve(i(t)):Promise.reject(t)}return Ds(t(JH))}catch(t){return Promise.reject(t)}}reschedule(t,e,i){return this.schedule(t,e,i)}}const KH=new YH;class QH{constructor(t){this.view=t,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=PH(),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),null==this.view.animation?.target||Fs(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=t=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:e,graphicsView:i,labelManager:n,state:{id:s}}=this.view;e.forEach(this._updateLayerView,this),null!=n&&(n.lastUpdateId!==s&&(n.viewChange(),n.lastUpdateId=s),n.updateRequested&&n.processUpdate(this._updateParameters)),null!=i&&(i.lastUpdateId!==s&&(i.viewChange(),i.lastUpdateId=s),i.updateRequested&&i.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=EH.ANIMATING:this.view.interacting?this._scheduler.state=EH.INTERACTING:this._scheduler.state=EH.IDLE,this._scheduler.updateBudget(t)&&this._scheduler.frame()}}destroy(){this.stop(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,targetState:new Pq,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=ey((()=>t.stationary),(t=>{this.stationary=t,this.requestFrame()})),this._frameTaskHandle=ir(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){if(!t.attached)return void this.requestUpdate();const e=this.view.state,i=t.lastUpdateId;null!=i&&(this.stationary||t.moving)||(t.moving=!0),i!==e.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=e.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&t.layerViews?.forEach(this._updateLayerView,this)}}let XH=class extends ao{constructor(t){super(t),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(t,e){if(!t)return void jt.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new XU;this.view.animation=i,await oy((()=>this.view.ready),e);const n={...e,animate:e?.animate??!Yz(),animationMode:e?.animationMode??"auto"},{extent:s,spatialReference:r,size:o,viewpoint:a,constraints:l,padding:u,allLayerViews:c}=this.view,h=ZG(t,{extent:s,spatialReference:r,size:o,viewpoint:a,constraints:l,padding:u,allLayerViews:c,pickClosestTarget:e?.pickClosestTarget??!0});return i?.update(h),this._gotoTask={},n.animate?this._gotoAnimated(h,n):this._gotoImmediate(h,n)}_gotoImmediate(t,e){const i=this._gotoTask,n=this.view.animation,s=t.then((t=>{if(_s(e),i!==this._gotoTask)throw new Ve("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=n.target=t,n.finish()}));return this._cancellableGoTo(i,n,s,e)}_gotoAnimated(t,e){const i=this._gotoTask,n=this.view.animation;if(!n)return Promise.resolve();const s=t.then((t=>{if(_s(e),i!==this._gotoTask)throw new Ve("view:goto-interrupted","Goto was interrupted");return n.update(t),this.view.animationManager.animate(n,this.view.viewpoint,e),n.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,n,s,e)}_cancellableGoTo(t,e,i,n){const s=()=>t===this._gotoTask;return Cs(i,n).finally((()=>{s()&&(e.done||e.stop())}))}};r([Je({constructOnly:!0})],XH.prototype,"view",void 0),XH=r([ln("esri.views.2d.GoToManager")],XH);function tW(){return Promise.all([import("./p-21b11ac8.js"),import("./p-a17d1b04.js")])}const eW=()=>tW().then((()=>import("./p-f02f48f0.js"))),iW=()=>tW().then((()=>import("./p-72f8c1e2.js").then((function(t){return t.F})))),nW={"base-dynamic":()=>tW().then((()=>import("./p-f8eb1edf.js"))),"base-tile":eW,"bing-maps":eW,catalog:()=>tW().then((()=>import("./p-cca957bd.js"))),"catalog-dynamic-group":()=>tW().then((()=>import("./p-8518b5e7.js"))),"catalog-footprint":()=>tW().then((()=>import("./p-9ff17a65.js"))),csv:iW,"geo-rss":()=>tW().then((()=>import("./p-7b14c0f1.js"))),feature:iW,geojson:iW,parquet:iW,graphics:()=>tW().then((()=>import("./p-a603817f.js"))),group:()=>tW().then((()=>import("./p-6842c5a1.js"))),imagery:()=>tW().then((()=>import("./p-2ce63fda.js"))),"imagery-tile":()=>tW().then((()=>import("./p-80fa40ad.js"))),kml:()=>tW().then((()=>import("./p-c01d6b7b.js"))),"knowledge-graph":()=>tW().then((()=>import("./p-089bd016.js"))),"link-chart":()=>tW().then((()=>import("./p-089bd016.js"))),"knowledge-graph-sublayer":iW,"map-image":()=>tW().then((()=>import("./p-32d5c857.js"))),"map-notes":()=>tW().then((()=>import("./p-c6bd0232.js"))),media:()=>tW().then((()=>import("./p-eea92a29.js"))),"ogc-feature":()=>tW().then((()=>import("./p-8df72528.js"))),"open-street-map":eW,"oriented-imagery":iW,route:()=>tW().then((()=>import("./p-c49d4d62.js"))),stream:()=>tW().then((()=>import("./p-5748998b.js"))),"subtype-group":()=>tW().then((()=>import("./p-626eec27.js"))),tile:eW,"vector-tile":()=>tW().then((()=>import("./p-a8fb1766.js"))),video:()=>tW().then((()=>import("./p-146b8ebd.js"))),wcs:()=>tW().then((()=>import("./p-80fa40ad.js"))),"web-tile":eW,wfs:iW,wms:()=>tW().then((()=>import("./p-4e7e4d3a.js"))),wmts:()=>tW().then((()=>import("./p-9564aa42.js"))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,focusArea:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function sW(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Ve(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const rW={hasLayerViewModule:t=>null!=nW[t.type],importLayerView:t=>{const e=nW[t.type];if(null==e)throw sW(t);return e(t)}};function oW(t,e){const{spatialReference:i}=e,n=[e.x,e.y];let s=Number.POSITIVE_INFINITY,r=0,o=0;const a=[0,0],l="extent"===t.type?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const t of l)for(let e=0;e<t.length-1;e++){Vd(a,n,t,e);const i=fB(n,a);i<s&&(s=i,r=a[0],o=a[1])}return{coordinate:new Kh({x:r,y:o,spatialReference:i}),distance:s}}var aW;let lW=aW=class extends(fC(ao)){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(null==this.geometry||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Ob(this.geometry,this.spatialReference)}catch(t){return jt.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(null==this.normalizedGeometry)return t;const i=t.targetGeometry;if("extent"===this.normalizedGeometry.type?Xh(this.normalizedGeometry,i):rd(this.normalizedGeometry,i))return t;const{coordinate:n}=oW(this.normalizedGeometry,i);return n?(t.targetGeometry=n,t):t}clone(){return new aW({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};r([Je({constructOnly:!0})],lW.prototype,"geometry",void 0),r([Je({readOnly:!0})],lW.prototype,"normalizedGeometry",null),r([Je({constructOnly:!0})],lW.prototype,"spatialReference",void 0),lW=aW=r([ln("esri.views.2d.constraints.GeometryConstraint")],lW);var uW;let cW=uW=class extends(fC(ao)){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e?(this.rotationEnabled||(t.rotation=e.rotation),t):t}clone(){return new uW({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};r([Je()],cW.prototype,"enabled",void 0),r([Je()],cW.prototype,"rotationEnabled",void 0),cW=uW=r([ln("esri.views.2d.constraints.RotationConstraint")],cW);const hW=cW;var dW;let fW=dW=class extends(fC(ao)){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:n,minZoom:s,maxZoom:r}=this,o=-1,a=-1,l=!1,u=!1;if(0!==i&&0!==n&&i<n&&([i,n]=[n,i]),!e?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",n);e=e.map((t=>t.clone())),e.sort(((t,e)=>e.scale-t.scale)),e.forEach(((t,e)=>t.level=e));for(const s of e)!l&&i>0&&i>=s.scale&&(o=s.level,l=!0),!u&&n>0&&n>=s.scale&&(a=t?t.level:-1,u=!0),t=s;-1===s&&(s=0===i?0:o),-1===r&&(r=0===n?e.length-1:a),s=Math.max(s,0),s=Math.min(s,e.length-1),r=Math.max(r,0),r=Math.min(r,e.length-1),s>r&&([s,r]=[r,s]),i=e[s].scale,n=e[r].scale,e.splice(0,s),e.splice(r-s+1,e.length),e.forEach(((t,e)=>{this._lodByScale[t.scale]=t,this._scales[e]=t.scale})),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",r),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",n)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,n=this.effectiveMaxScale,s=t.targetGeometry,r=e&&e.targetGeometry,o=0!==n&&t.scale<n,a=0!==i&&t.scale>i;if(o||a){const o=a?i:n;if(e&&r){const i=(o-e.scale)/(t.scale-e.scale);s.x=r.x+(s.x-r.x)*i,s.y=r.y+(s.y-r.y)*i}t.scale=o}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.floor(t),n=Math.ceil(t);return e[i]+(t-i)*(e[n]-e[i])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,n;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(i=e[s],n=e[s+1],n===t){return s+this.effectiveMinZoom+1}if(i>t&&n<t){return s+this.effectiveMinZoom+1-(t-n)/(i-n)}}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new dW({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce(((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e),this._scales[0])),this._lodByScale[t].scale}};r([Je({readOnly:!0})],fW.prototype,"effectiveLODs",void 0),r([Je({readOnly:!0})],fW.prototype,"effectiveMinZoom",void 0),r([Je({readOnly:!0})],fW.prototype,"effectiveMaxZoom",void 0),r([Je({readOnly:!0})],fW.prototype,"effectiveMinScale",void 0),r([Je({readOnly:!0})],fW.prototype,"effectiveMaxScale",void 0),r([Je()],fW.prototype,"lods",void 0),r([Je()],fW.prototype,"minZoom",void 0),r([Je()],fW.prototype,"maxZoom",void 0),r([Je()],fW.prototype,"minScale",void 0),r([Je()],fW.prototype,"maxScale",void 0),r([Je()],fW.prototype,"snapToZoom",void 0),fW=dW=r([ln("esri.views.2d.constraints.ZoomConstraint")],fW);const pW=fW;const mW={base:null,key:"type",typeMap:{extent:Od,polygon:qp}};let yW=class extends ao{constructor(t){super(t),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Vm}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(t){t?this._set("geometry",t):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const t=this._get("_geometry");return t&&this.geometry===t.geometry&&this.view?.constraintsInfo.spatialReference===t.spatialReference?t:new lW({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new hW({rotationEnabled:this.rotationEnabled})}get _zoom(){const t=this._get("_zoom"),e=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,n=this.maxZoom,s=this.minScale,r=this.maxScale,o=this.snapToZoom;return t&&t.lods===e&&t.minZoom===i&&t.maxZoom===n&&t.minScale===s&&t.maxScale===r&&t.snapToZoom===o?t:new pW({lods:e,minZoom:i,maxZoom:n,minScale:s,maxScale:r,snapToZoom:o})}canZoomInTo(t){const e=this.effectiveMaxScale;return 0===e||t>=e}canZoomOutTo(t){const e=this.effectiveMinScale;return 0===e||t<=e}constrain(t,e){return this._zoom.constrain(t,e),this._rotation.constrain(t,e),this._geometry.constrain(t,e),this.customConstraints.forEach((i=>i.constrain(t,e))),t}constrainByGeometry(t){return this._geometry.constrain(t),this.customConstraints.forEach((e=>e.applyPanConstraint?.(t))),t}fit(t){return this._zoom.fit(t)}zoomToScale(t){return this._zoom.zoomToScale(t)}scaleToZoom(t){return this._zoom.scaleToZoom(t)}snapScale(t){return this._zoom.snapToClosestScale(t)}snapToNextScale(t){return this._zoom.snapToNextScale(t)}snapToPreviousScale(t){return this._zoom.snapToPreviousScale(t)}};r([Je({readOnly:!0})],yW.prototype,"effectiveLODs",null),r([Je({readOnly:!0})],yW.prototype,"effectiveMinScale",null),r([Je({readOnly:!0})],yW.prototype,"effectiveMaxScale",null),r([Je({readOnly:!0})],yW.prototype,"effectiveMinZoom",null),r([Je({readOnly:!0})],yW.prototype,"effectiveMaxZoom",null),r([Je({types:mW,value:null})],yW.prototype,"geometry",null),r([Je({type:[lS]})],yW.prototype,"lods",void 0),r([Je()],yW.prototype,"minScale",void 0),r([Je()],yW.prototype,"maxScale",void 0),r([Je()],yW.prototype,"minZoom",void 0),r([Je()],yW.prototype,"maxZoom",void 0),r([Je()],yW.prototype,"rotationEnabled",void 0),r([Je()],yW.prototype,"snapToZoom",void 0),r([Je({type:Vm})],yW.prototype,"customConstraints",void 0),r([Je()],yW.prototype,"view",void 0),r([Je({readOnly:!0})],yW.prototype,"version",null),r([Je({type:lW,readOnly:!0})],yW.prototype,"_geometry",null),r([Je({type:hW})],yW.prototype,"_rotation",null),r([Je({readOnly:!0,type:pW})],yW.prototype,"_zoom",null),yW=r([ln("esri.views.2d.MapViewConstraints")],yW);const gW=yW;class vW{static getId(t,e,i,n){return"object"==typeof t?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${e}/${i}/${n}`}constructor(t,e,i,n){this.set(t,e,i,n)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(t){this.set(t)}get hash(){const t=4095&this.row,e=4095&this.col,i=63&this.level;return(3&this.world)<<30|e<<22|t<<8|i}acquire(t,e,i,n){this.set(t,e,i,n)}contains(t){const e=t.level-this.level;return e>=0&&this.row===t.row>>e&&this.col===t.col>>e&&this.world===t.world}containsChild(t){const e=t.level-this.level;return e>0&&this.row===t.row>>e&&this.col===t.col>>e&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new vW(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(t,e,i,n){if(null==t)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof t)this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if("string"==typeof t){const[e,i,n,s]=t.split("/");this.level=parseFloat(e),this.row=parseFloat(i),this.col=parseFloat(n),this.world=parseFloat(s)}else this.level=+t,this.row=+e,this.col=+i,this.world=+n||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new vW(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(t,e,i){const n=this.clone();return n.col+=t,n.row+=e,i.normalizeKey(n),n}getChildKeys(){const t=this.level+1,e=this.row<<1,i=this.col<<1,n=this.world;return[new vW(t,e,i,n),new vW(t,e,i+1,n),new vW(t,e+1,i,n),new vW(t,e+1,i+1,n)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}}vW.pool=new Nn(vW,null,null,25,50);function wW(t,e){return[t,e]}function bW(t,e,i){return t[0]=e,t[1]=i,t}function SW(t,e,i,n,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t}const _W=new vW("0/0/0/0");class xW{static create(t,e,i=null){const n=Vu(t.spatialReference),s=e.origin||wW(t.origin.x,t.origin.y),r=wW(t.size[0]*e.resolution,t.size[1]*e.resolution),o=wW(-1/0,-1/0),a=wW(1/0,1/0),l=wW(1/0,1/0);null!=i&&(bW(o,Math.max(0,Math.floor((i.xmin-s[0])/r[0])),Math.max(0,Math.floor((s[1]-i.ymax)/r[1]))),bW(a,Math.max(0,Math.floor((i.xmax-s[0])/r[0])),Math.max(0,Math.floor((s[1]-i.ymin)/r[1]))),bW(l,a[0]-o[0]+1,a[1]-o[1]+1));const{cols:u,rows:c}=e;let h,d,f,p;return!i&&u&&c&&(bW(o,u[0],c[0]),bW(a,u[1],c[1]),bW(l,u[1]-u[0]+1,c[1]-c[0]+1)),t.isWrappable?(h=wW(Math.ceil(Math.round((n.valid[1]-n.valid[0])/e.resolution)/t.size[0]),l[1]),d=!0,f=n.origin,p=n.valid):(h=l,d=!1),new xW(e.level,e.resolution,e.scale,s,o,a,l,r,h,d,f,p)}constructor(t,e,i,n,s,r,o,a,l,u,c,h){this.level=t,this.resolution=e,this.scale=i,this.origin=n,this.first=s,this.last=r,this.size=o,this.norm=a,this.worldSize=l,this.wrap=u,this._spatialReferenceOrigin=c,this._spatialReferenceValid=h}normalizeCol(t){if(!this.wrap)return t;const e=this.worldSize[0];return t<0?e-1-Math.abs((t+1)%e):t%e}normalizeKey(t){if(!this.wrap)return;const e=this.worldSize[0],i=t.col;i<0?(t.col=i+e,t.world-=1):i>=e&&(t.col=i-e,t.world+=1)}denormalizeCol(t,e){return this.wrap?this.worldSize[0]*e+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return(t-this.origin[0])/this.norm[0]}getXForColumn(t){const e=this.origin[0]+t*this.norm[0],i=this._spatialReferenceOrigin,n=this._spatialReferenceValid;return this.wrap&&i&&n?e===i[0]?n[0]:this.origin[0]===i[0]&&t===this.worldSize[0]?n[1]:e:e}getRowForY(t){return(this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,e,i=!1){_W.set(e);const n=i?_W.col:this.denormalizeCol(_W.col,_W.world),s=_W.row;return SW(t,this.getXForColumn(n),this.getYForRow(s+1),this.getXForColumn(n+1),this.getYForRow(s)),t}getTileCoords(t,e,i=!1){_W.set(e);const n=i?_W.col:this.denormalizeCol(_W.col,_W.world);return Array.isArray(t)?bW(t,this.getXForColumn(n),this.getYForRow(_W.row)):(t.x=this.getXForColumn(n),t.y=this.getYForRow(_W.row)),t}}class MW{constructor(){this.spans=[]}acquire(t){this.lodInfo=t}release(){this.lodInfo=null,this.spans.length=0}*keys(){const t=this.lodInfo;for(const{row:e,colFrom:i,colTo:n}of this.spans)for(let s=i;s<=n;s++){const i=t.getWorldForColumn(s);yield new vW(t.level,e,t.normalizeCol(s),i)}}forEach(t,e){const{spans:i,lodInfo:n}=this,{level:s}=n;if(0!==i.length)for(const{row:r,colFrom:o,colTo:a}of i)for(let i=o;i<=a;i++)t.call(e,s,r,n.normalizeCol(i),n.getWorldForColumn(i))}}MW.pool=new Nn(MW);class TW{constructor(t,e,i){this.row=t,this.colFrom=e,this.colTo=i}}const AW=new vW("0/0/0/0");class IW{static create(t,e){t[1]>e[1]&&([t,e]=[e,t]);const[i,n]=t,[s,r]=e,o=s-i,a=r-n,l=0!==a?o/a:0,u=(Math.ceil(n)-n)*l,c=(Math.floor(n)-n)*l;return new IW(i,Math.floor(n),Math.ceil(r),l,o<0?u:c,o<0?c:u,o<0?s:i,o<0?i:s)}constructor(t,e,i,n,s,r,o,a){this.x=t,this.ymin=e,this.ymax=i,this.invM=n,this.leftAdjust=s,this.rightAdjust=r,this.leftBound=o,this.rightBound=a}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}}const kW=[[0,0],[0,0],[0,0],[0,0]],CW=1e-6;class EW{constructor(t,e=null,i=t.lods[0].level,n=t.lods[t.lods.length-1].level){this.tileInfo=t,this.fullExtent=e,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=t.lods.filter((t=>t.level>=i&&t.level<=n));this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const r=this._lodInfos=s.map((i=>xW.create(t,i,e)));s.forEach(((t,e)=>{this._infoByLevel[t.level]=r[e],this._infoByScale[t.scale]=r[e],this.scales[e]=t.scale}),this),this._wrap=t.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(t){return this._infoByLevel["number"==typeof t?t:t.level]}getTileBounds(t,e,i=!1){AW.set(e);const n=this._infoByLevel[AW.level];return n?n.getTileBounds(t,AW,i):t}getTileCoords(t,e,i=!1){AW.set(e);const n=this._infoByLevel[AW.level];return n?n.getTileCoords(t,AW,i):t}getTileCoverage(t,e=192,i=!0,n="closest"){if(!i&&(t.scale>this.minScale||t.scale<this.maxScale))return null;const s="closest"===n?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),r=MW.pool.acquire(s),o=this._wrap;let a,l,u,c=1/0,h=-1/0;const d=r.spans;kW[0][0]=kW[0][1]=kW[1][1]=kW[3][0]=-e,kW[1][0]=kW[2][0]=t.size[0]+e,kW[2][1]=kW[3][1]=t.size[1]+e;for(const e of kW)t.toMap(e,e),e[0]=s.getColumnForX(e[0]),e[1]=s.getRowForY(e[1]);const f=[];let p=3;for(let t=0;t<4;t++){if(kW[t][1]===kW[p][1]){p=t;continue}const e=IW.create(kW[t],kW[p]);c=Math.min(e.ymin,c),h=Math.max(e.ymax,h),void 0===f[e.ymin]&&(f[e.ymin]=[]),f[e.ymin].push(e),p=t}if(null==c||null==h||h-c>100)return null;let m=[];for(a=c;a<h;){null!=f[a]&&(m=m.concat(f[a])),l=1/0,u=-1/0;for(let t=m.length-1;t>=0;t--){const e=m[t];l=Math.min(l,e.getLeftCol()),u=Math.max(u,e.getRightCol())}if(l=Math.floor(l),u=Math.floor(u),a>=s.first[1]&&a<=s.last[1])if(o)if(s.size[0]<s.worldSize[0]){const t=Math.floor(u/s.worldSize[0]);for(let e=Math.floor(l/s.worldSize[0]);e<=t;e++)d.push(new TW(a,Math.max(s.getFirstColumnForWorld(e),l),Math.min(s.getLastColumnForWorld(e),u)))}else d.push(new TW(a,l,u));else l>s.last[0]||u<s.first[0]||(l=Math.max(l,s.first[0]),u=Math.min(u,s.last[0]),d.push(new TW(a,l,u)));a+=1;for(let t=m.length-1;t>=0;t--){const e=m[t];e.ymax>=a?e.incrRow():m.splice(t,1)}}return r}getTileParentId(t){AW.set(t);const e=this._infoByLevel[AW.level],i=this._lodInfos.indexOf(e)-1;return i<0?null:(this._getTileIdAtLOD(AW,this._lodInfos[i],AW),AW.id)}getTileResolution(t){const e=this._infoByLevel["object"==typeof t?t.level:t];return e?e.resolution:-1}getTileScale(t){const e=this._infoByLevel[t.level];return e?e.scale:-1}intersects(t,e){AW.set(e);const i=this._infoByLevel[AW.level],n=t.lodInfo;if(n.resolution>i.resolution){this._getTileIdAtLOD(AW,n,AW);const e=n.denormalizeCol(AW.col,AW.world);for(const i of t.spans)if(i.row===AW.row&&i.colFrom<=e&&i.colTo>=e)return!0}if(n.resolution<i.resolution){const[e,s,r,o]=t.spans.reduce(((t,e)=>(t[0]=Math.min(t[0],e.row),t[1]=Math.max(t[1],e.row),t[2]=Math.min(t[2],e.colFrom),t[3]=Math.max(t[3],e.colTo),t)),[1/0,-1/0,1/0,-1/0]),a=i.denormalizeCol(AW.col,AW.world),l=n.getColumnForX(i.getXForColumn(a)),u=n.getRowForY(i.getYForRow(AW.row)),c=n.getColumnForX(i.getXForColumn(a+1))-1,h=n.getRowForY(i.getYForRow(AW.row+1))-1;return!(l>o||c<r||u>s||h<e)}const s=n.denormalizeCol(AW.col,AW.world);return t.spans.some((t=>t.row===AW.row&&t.colFrom<=s&&t.colTo>=s))}normalizeBounds(t,e,i){if(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this._wrap){const e=Vu(this.tileInfo.spatialReference),n=-i*(e.valid[1]-e.valid[0]);t[0]+=n,t[2]+=n}return t}getSmallestInfoForScale(t){const e=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>e[0])return this._infoByScale[e[0]];for(let i=1;i<e.length-1;i++)if(t>e[i]+CW)return this._infoByScale[e[i-1]];return this._infoByScale[e[e.length-1]]}getClosestInfoForScale(t){const e=this.scales;return this._infoByScale[t]||(t=e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e),e[0])),this._infoByScale[t]}scaleToLevel(t){const e=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(let i=e.length-1;i>=0;i--)if(t<e[i]){if(i===e.length-1)return this._infoByScale[e[e.length-1]].level;return this._infoByScale[e[i]].level+(e[i]-t)/(e[i]-e[i+1])}return this._infoByScale[e[0]].level}scaleToZoom(t){return this.tileInfo.scaleToZoom(t)}zoomToScale(t){return this.tileInfo.zoomToScale(t)}_getTileIdAtLOD(t,e,i){const n=this._infoByLevel[i.level];return t.set(i),e.resolution<n.resolution?null:(e.resolution===n.resolution||(t.level=e.level,t.col=Math.floor(i.col*n.resolution/e.resolution+.01),t.row=Math.floor(i.row*n.resolution/e.resolution+.01)),t)}}class jW{constructor(t,e){this.item=t,this.controller=e,this.promise=null}}class OW{constructor(t){this._schedule=null,this._task=null,this._deferreds=new VD,this._controllers=new VD,this._processingItems=new VD,this._pausedSignal=dM(!1),this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new yy(t.peeker),this.process=t.process;const e=t.scheduler;t.priority&&e&&(this._task=e.registerTask(t.priority,this))}destroy(){this.clear(),this._schedule=kn(this._schedule),this._task=kn(this._task)}get updating(){return!!this._task?.updating||this.running}get length(){return this._processingItems.size+this._queue.length}abort(t){const e=this._controllers.get(t);e&&e.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach((e=>t.push(e))),this._controllers.clear(),t.forEach((t=>t.abort())),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach(((e,i)=>t(i)))}get(t){const e=this._deferreds.get(t);return e?e.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(t,e){const i=this.get(t);if(i)return i;const n=new AbortController;let s=null;e&&(s=Is(e,(()=>n.abort())));const r=()=>{const e=this._processingItems.get(t);e&&e.controller.abort(),o(),l.reject(Ss())},o=()=>{a.remove(),null!=s&&s.remove(),this._removeItem(t),this._queue.remove(t),this._scheduleNext()},a=ks(n.signal,r),l=zs();return this._deferreds.set(t,l),this._controllers.set(t,n),l.promise.then(o,o),this._queue.push(t),this._scheduleNext(),l.promise}last(){return this._queue.last()}lastPromise(){const t=this.last();return t?this.get(t):null}peek(){return this._queue.peek()}popLast(){const t=this._queue.popLast();return t&&(this._deferreds.get(t)?.reject(Ss()),this._removeItem(t)),t}reset(){const t=Array.from(this._processingItems.values());this._processingItems.clear();for(const e of t)this._queue.push(e.item),e.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(t){for(;!t.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),t.madeProgress()}_removeItem(t){this._deferreds.delete(t),this._controllers.delete(t),this._processingItems.delete(t)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=er((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(e))}_processError(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(e))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(null==t)return;let e;const i=new AbortController,n=new jW(t,i);this._processingItems.set(t,n);try{e=this.process(t,i.signal)}catch(t){this._processError(n,t)}Fs(e)?(n.promise=e,e.then((t=>this._processResult(n,t)),(t=>this._processError(n,t)))):this._processResult(n,e)}get test(){}}const RW=[0,0];let LW=class extends ao{constructor(t){super(t),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:t,process:e,scheduler:i,priority:n}=this;this._queue=new OW({concurrency:t,scheduler:i,priority:n,process:(t,i)=>{const n=this._keyToItem.get(t);return e(n,{signal:i})},peeker:t=>this._peek(t)})}destroy(){this.clear(),this._queue=An(this._queue)}get length(){return this._queue?this._queue.length:0}abort(t){const e="string"==typeof t?t:t.id;this._queue.abort(e)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(t){return"string"==typeof t?this._keyToItem.has(t):this._keyToItem.has(t.id)}pause(){this._queue.pause()}push(t){const e=t.key.id;if(this._queue.has(e))return this._queue.get(e);const i=this._queue.push(e),n=this.tileInfoView.getTileScale(t.key),s=Nt(this._tilesByScale,n,(()=>new Set)),r=()=>{s.delete(t.key),0===s.size&&this._tilesByScale.delete(n),this._keyToItem.delete(e)};return s.add(t.key),this._keyToItem.set(e,t),i.then(r,r),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(t){if(!this.state)return t.values().next().value;const e=new Set;for(const i of t)e.add(this._keyToItem.get(i).key);const i=this.state.scale;let n,s=Number.POSITIVE_INFINITY;for(const[t,r]of this._tilesByScale){if(mr(r,(t=>e.has(t)))){const e=Math.abs(t-i);e<s&&(n=r,s=e)}}return this._getClosestTileKey(n,t).id}_getClosestTileKey(t,e){const i=this.tileInfoView,n=this.state.center;let s,r=Number.POSITIVE_INFINITY;for(const o of t)if(e.has(o.id)){i.getTileCoords(RW,o);const t=fB(RW,n);t<r&&(r=t,s=o)}return s}};r([Je({constructOnly:!0})],LW.prototype,"concurrency",void 0),r([Je({constructOnly:!0})],LW.prototype,"priority",void 0),r([Je({constructOnly:!0})],LW.prototype,"process",void 0),r([Je({constructOnly:!0})],LW.prototype,"scheduler",void 0),r([Je()],LW.prototype,"state",void 0),r([Je({constructOnly:!0})],LW.prototype,"tileInfoView",void 0),LW=r([ln("esri.views.2d.tiling.TileQueue")],LW);const NW=LW;class PW{constructor(t,e,i){this.maxSize=t,this._tileInfoView=e,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(t){return this._tilePerId.has(t)}get(t){return this._tilePerId.get(t)}pop(t){const e=this._tilePerId.get(t);if(!e)return;const i=e.key.level,n=this._tileKeysPerLevel[i];FW(this._tilePerId,t);for(let e=0;e<n.length;e++)if(n[e].id===t){n.splice(e,1);break}return e.visible=!0,e}add(t){t.visible=!1;const e=t.key,i=e.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,t);const n=e.level;this._tileKeysPerLevel[n]||(this._tileKeysPerLevel[n]=[]),this._tileKeysPerLevel[n].push(e)}prune(t,e,i){let n=this._tilePerId.size;if(n<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;n>this.maxSize&&s>=0;)s!==t&&(n=this._pruneAroundCenterTile(n,e,i,s)),s--;n>this.maxSize&&(n=this._pruneAroundCenterTile(n,e,i,t))}_pruneAroundCenterTile(t,e,i,n){const s=this._tileKeysPerLevel[n];if(!s||0===s.length)return t;const{size:r,origin:o}=this._tileInfoView.tileInfo,a=i*r[0],l=i*r[1],u=[0,0],c=[0,0];for(s.sort(((t,i)=>(u[0]=o.x+a*(t.col+.5),u[1]=o.y-l*(t.row+.5),c[0]=o.x+a*(i.col+.5),c[1]=o.y-l*(i.row+.5),pB(u,e)-pB(c,e))));s.length>0;){const e=s.pop();if(this._removeTile(e.id),--t===this.maxSize)break}return t}_removeTile(t){const e=this._tilePerId.get(t);this._removedFunc&&e&&this._removedFunc(e),FW(this._tilePerId,t)}}function FW(t,e){t.delete(e)}const DW=new vW(0,0,0,0),$W=new Map,zW=[],UW=[];class BW{constructor(t){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,null!=t.resampling&&(this.resampling=t.resampling),t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),null!=t.buffer&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new PW(t.cacheSize,this.tileInfoView,(t=>{this.releaseTile(t)})))}destroy(){this.tileIndex.clear()}update(t){const{resampling:e,tileIndex:i}=this,{scale:n,center:s,resolution:r}=t.state,{minScale:o,maxScale:a}=this.tileInfoView,l=!t.stationary&&n>this._previousScale;if(this._previousScale=n,!e&&(n>o||n<a))return this.tiles.length=0,void this.clear();const u=this.tileInfoView.getTileCoverage(t.state,this.buffer,this.resampling,this.coveragePolicy);if(!u)return this.tiles.length=0,void this.clear();const{spans:c,lodInfo:h}=u,{level:d}=h;this.tiles.length=0,i.forEach((t=>t.visible=!0));let f=0,p=0;if(c.length>0)for(const{row:t,colFrom:e,colTo:n}of c)for(let s=e;s<=n;s++){f++;const e=DW.set(d,t,h.normalizeCol(s),h.getWorldForColumn(s)).id;let n=i.get(e);if(n)n.isReady?($W.set(e,n),p++):l||this._addParentTile(e,$W);else{if(this._tileCache?.has(e)){if(n=this._tileCache.pop(e),this.tileIndex.set(e,n),n.isReady){$W.set(e,n),p++;continue}}else n=this.acquireTile(DW),this.tileIndex.set(e,n);l||this._addParentTile(e,$W)}}const m=p===f;for(const[t,e]of i){if($W.has(t))continue;DW.set(t);const i=this.tileInfoView.intersects(u,DW),n="purge"===this.cachePolicy?DW.level!==d:DW.level>d;!i||!l&&m?!n&&i||zW.push(e):e.isReady?n&&"purge"===this.cachePolicy&&this._hasReadyAncestor(DW,d)?zW.push(e):UW.push(e):n&&zW.push(e)}for(const t of UW)t.isReady&&$W.set(t.key.id,t);for(const t of zW)this._tileCache?this._tileCache.add(t):this.releaseTile(t),i.delete(t.key.id);for(const t of $W.values())this.tiles.push(t);for(const t of i.values())$W.has(t.key.id)||(t.visible=!1);this._tileCache?.prune(d,s,r),MW.pool.release(u),UW.length=0,zW.length=0,$W.clear()}clear(){const{tileIndex:t}=this;for(const e of t.values())this.releaseTile(e);t.clear()}refresh(t){for(const e of this.tileIndex.values())t(e);this._tileCache?.clear()}updateCacheSize(t){this._tileCache&&(this._tileCache.maxSize=t)}_addParentTile(t,e){let i=t,n=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(n=this.tileIndex.get(i),n?.isReady){e.has(n.key.id)||e.set(n.key.id,n);break}}else if(this._tileCache?.has(i)&&(n=this._tileCache.pop(i),this.tileIndex.set(i,n),n?.isReady)){e.has(n.key.id)||e.set(n.key.id,n);break}}_hasReadyAncestor(t,e){const i=Bf();this.tileInfoView.getTileBounds(i,t,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=e&&n.key.level<t.level){const t=Bf();if(this.tileInfoView.getTileBounds(t,n.key,!0),np(t,i))return!0}return!1}}let GW=class extends ao{constructor(t){super(t),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([ey((()=>this.constraints?.version),(t=>{this.constraints&&t&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))}),hy)])}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:e}=this.state.paddedViewState;return this.state.commitProperty("id"),new Kh({x:t[0],y:t[1],spatialReference:e})}set center(t){if(null==t)return;if(!this.ready)return void this._set("center",t);let e;try{e=this._project(t,this.state.spatialReference)}catch(e){return void jt.getLogger(this).error(new Ve("mapview:invalid-center","could not project the value in the view's spatial reference",{input:t,error:e}))}const i=this.viewpoint;pV(i,i,e),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(t){if(null==t)return;if(!t.width||!t.height)return void jt.getLogger(this).error(new Ve("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",t),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let e;try{e=this._project(t,this.state.spatialReference)}catch(t){return void jt.getLogger(this).error(new Ve("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:t}))}const i=this.viewpoint;QG(i,i,e,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const e=this.viewpoint;gV(e,e,t),this.viewpoint=e}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",void 0);const e=this._get("extent");return void(e&&(this._set("extent",void 0),this._set("center",e.center)))}const e=this.viewpoint;wV(e,e,t),this.viewpoint=e}get viewpoint(){if(!this.ready)return this._get("viewpoint");return this.state.paddedViewState.viewpoint.clone()}set viewpoint(t){if(null==t)return;if(!this.ready)return this._set("viewpoint",t),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let e,i;try{e=this._project(t,this.state.spatialReference),!t.scale||isNaN(t.scale)?i=new Ve("mapview:invalid-viewpoint",`invalid scale value of ${t.scale}`):null==t.targetGeometry&&(i=new Ve("mapview:invalid-viewpoint","geometry not defined"))}catch(t){i=new Ve("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:t})}if(i)return void jt.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const n=new _m({targetGeometry:new Kh,scale:0,rotation:0});JG(n,e),this.constraints?.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(t){if(!(t>=0))return;if(!this.ready){this._set("zoom",t),this._set("scale",void 0);const e=this._get("extent");return void(e&&(this._set("extent",void 0),this._set("center",e.center)))}const e=this.constraints?.zoomToScale(t)??0;if(!e)return void this._set("zoom",-1);const i=this.viewpoint;wV(i,i,e),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(t){if(!t[0]&&!t[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:e,constraints:i}=this,n=this._get("center"),s=this._get("extent"),r=this._get("scale"),o=this._get("rotation"),a=this._get("viewpoint"),l=this._get("zoom"),u=null!=l&&null!=i&&i.zoomToScale(l)||void 0;let c,h,d;const f=a?.rotation,p=a?.targetGeometry;"extent"===p?.type?c=p:"point"===p?.type&&(h=p,d=a?.scale);const m=s??c;return{center:n??h??m?.center,rotation:o??f,scale:(r??u??d??(m&&VG(m,[t[0]-e.left-e.right,t[1]-e.top-e.bottom])))||void 0}}startup(t,e,i,n){const s=t.targetGeometry;try{this._project(t,i)}catch(e){jt.getLogger(this).warn(new wi("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:i,error:e})),t.targetGeometry=n||new Kh({x:0,y:0,spatialReference:i})}this.constraints?.fit(t),this._set("state",new Pq({padding:this.padding,size:e,viewpoint:t})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[t,e],spatialReference:i,rotation:n,scale:s}=this.state.paddedViewState,r=new Kh({x:t,y:e,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",r),this._set("zoom",-1),this._set("rotation",n),this._set("scale",s),this._set("state",null)}changeSpatialReference(t){const e=this.state.paddedViewState.clone();if(null==this._scaleBeforeChangingSpatialReference)this._scaleBeforeChangingSpatialReference=e.scale;else{const t=e.viewpoint.clone();t.scale=this._scaleBeforeChangingSpatialReference,e.viewpoint=t}const i=e.clone(),[n,s]=e.center;let r=null;try{r=this._project(new Kh({x:n,y:s,spatialReference:e.spatialReference}),t)}catch(e){lu()||jt.getLogger(this).warn(new wi("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:r?.toJSON(),spatialReference:t,error:e}))}r||(r=new Kh({x:0,y:0,spatialReference:t}));const o=pV(new _m({targetGeometry:new Kh,scale:0,rotation:0}),e.viewpoint,r);i.viewpoint=o;try{const n=20,s=[e.size[0]/2,e.size[1]/2],r=[s[0]+n,s[1]],a=e.toMap([0,0],r),{x:l,y:c}=this._project(new Kh({x:a[0],y:a[1],spatialReference:e.spatialReference}),t);a[0]=l,a[1]=c,i.toScreen(a,a);const h=dV(s,a,r),d=Math.hypot(a[0]-s[0],a[1]-s[1])/n;!Number.isFinite(d)||Math.abs(d)>4?(o.rotation=0,o.targetGeometry=new Kh({x:0,y:0,spatialReference:t})):(o.scale*=d,o.scale>u("mapview-srswitch-adjust-rotation-scale-threshold")?o.rotation=0:o.rotation+=Number.isFinite(h)?h:0)}catch{}this._get("constraints")?.constrain(o,void 0),this._get("state").viewpoint=o}resize(t,e){if(!this.ready)return;const i=this.state;let n=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.slice();i.size=[t,e],mV(n,n,s,this.state.paddedViewState.size,this.resizeAlign),n=this.constraints?.constrain(n,void 0)??n,this.state.viewpoint=n}toMap(t){if(!this.ready)return null;const e=[0,0],[i,n]=this.state.toMap(e,[t.x,t.y]),s=this.state.spatialReference;return new Kh({x:i,y:n,spatialReference:s})}toScreen(t,e){if(!this.ready)return null;const i=this._project(t,this.state.spatialReference),n=[i.x,i.y];return!1===e?.pickClosestTarget||this.state.paddedViewState.wrapMapCoordinate(n,n),this.state.toScreen(n,n),eI(n[0],n[1])}_project(t,e){const i=t?.targetGeometry||t;if(!e)return t;if(!i)return null;if(e.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem)return t;if(Gu(e,i.spatialReference))return t;const n=Ob(i,e);if(!n)throw new Ve("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:e});return VW(t)?(t.targetGeometry=n,t):n}};function VW(t){return"esri.Viewpoint"===t?.declaredClass}r([Je({type:Kh})],GW.prototype,"center",null),r([Je()],GW.prototype,"constraints",void 0),r([Je({type:Od})],GW.prototype,"extent",null),r([Je({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],GW.prototype,"padding",null),r([Je()],GW.prototype,"ready",void 0),r([Je()],GW.prototype,"resizeAlign",void 0),r([Je({readOnly:!0})],GW.prototype,"resolution",null),r([Je({type:Number})],GW.prototype,"rotation",null),r([Je({type:Number})],GW.prototype,"scale",null),r([Je({readOnly:!0})],GW.prototype,"state",void 0),r([Je({type:_m})],GW.prototype,"viewpoint",null),r([Je({readOnly:!0})],GW.prototype,"visibleArea",null),r([Je()],GW.prototype,"zoom",null),GW=r([ln("esri.views.2d.ViewStateManager")],GW);function qW(t,e){switch(e){case"primary":return"touch"===t.pointerType||0===t.button;case"secondary":return"touch"!==t.pointerType&&2===t.button;case"tertiary":return"touch"!==t.pointerType&&1===t.button}}class HW extends aM{constructor(t,e){super(!0),this._view=t,this.registerIncoming("double-click",e,(t=>this._handleDoubleClick(t,e)))}_handleDoubleClick(t,e){qW(t.data,"primary")&&(t.stopPropagation(),e?this._view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this._view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}}class WW extends aM{constructor(t,e,i){super(!0),this.view=t,this.pointerType=e,this.registerIncoming("double-tap-drag",i,(t=>this._handleDoubleTapDrag(t)))}_handleDoubleTapDrag(t){const{data:e}=t,{pointerType:i}=e;if(i!==this.pointerType)return;t.stopPropagation();const{action:n,delta:s}=e,{view:r}=this,{mapViewNavigation:o}=r;switch(n){case"begin":{const{scale:t}=r;this._startScale=t,this._currentScale=t,this._previousDelta=s,o.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const t=1.015**s.y,e=this._startScale*t,i=e/this._currentScale;o.setViewpointImmediate(i),this._currentScale=e;break}case"end":{const{constraints:t}=r,{effectiveLODs:e,snapToZoom:i}=t;if(!i||!e)return void o.end();const n=t.snapScale(this._currentScale),a=(s.y>0?Math.max(n,t.snapToPreviousScale(this._startScale)):Math.min(n,t.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(a).then((()=>{o.end()}));break}}}}class ZW{constructor(t){this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(t){const e=t.data,i=e.pointers.size;switch(e.action){case"start":this._currentCount=i,this._emitStart(t);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(t);break;case"end":this._emitEnd(t),this._currentCount=0}this._previousEvent=t}_emitStart(t){this._startEvent=t,this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.start(this._currentCount,t,this._startEvent)}_emitUpdate(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.update(this._currentCount,t,this._startEvent)}_emitEnd(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.end(this._currentCount,t,this._startEvent),this._startEvent=null}}class JW extends aM{constructor(t,e,i){super(!0),this.view=t,this.pointerAction=e,this.registerIncoming("drag",i,(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()))}onInstall(t){super.onInstall(t),this._dragEventSeparator=new ZW({start:(t,e)=>{this.view.mapViewNavigation.pan.begin(this.view,e.data),e.stopPropagation()},update:(t,e)=>{this.view.mapViewNavigation.pan.update(this.view,e.data),e.stopPropagation()},end:(t,e)=>{this.view.mapViewNavigation.pan.end(this.view,e.data),e.stopPropagation()},condition:(t,e)=>1===t&&qW(e.data,this.pointerAction)})}_handleDrag(t){const e=this.view.mapViewNavigation;e.pinch.zoomMomentum||e.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}class YW extends aM{constructor(t,e,i){super(!0),this._view=t,this.pointerAction=e;const n=this._view.mapViewNavigation;this._dragEventSeparator=new ZW({start:(t,e)=>{n.rotate.begin(this._view,e.data),e.stopPropagation()},update:(t,e)=>{n.rotate.update(this._view,e.data),e.stopPropagation()},end:(t,e)=>{n.rotate.end(),e.stopPropagation()},condition:(t,e)=>1===t&&qW(e.data,this.pointerAction)}),this.registerIncoming("drag",i,(t=>this._dragEventSeparator.handle(t)))}}function KW(t){const e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)}function QW(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function XW(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t}function tZ(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function eZ(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function iZ(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function nZ(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function sZ(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function rZ(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function oZ(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function aZ(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function lZ(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function uZ(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function cZ(t,e=0,i=1){return t[0]=Math.min(Math.max(t[0],e),i),t[1]=Math.min(Math.max(t[1],e),i),t[2]=Math.min(Math.max(t[2],e),i),t}function hZ(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function dZ(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function fZ(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t}function pZ(t,e){const i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return Math.sqrt(i*i+n*n+s*s)}function mZ(t,e){const i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return i*i+n*n+s*s}function yZ(t){const e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n}function gZ(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function vZ(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function wZ(t,e){const i=e[0],n=e[1],s=e[2];let r=i*i+n*n+s*s;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r),t}function bZ(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function SZ(t,e,i){const n=e[0],s=e[1],r=e[2],o=i[0],a=i[1],l=i[2];return t[0]=s*l-r*a,t[1]=r*o-n*l,t[2]=n*a-s*o,t}function _Z(t,e,i){const n=e[0],s=e[1],r=e[2],o=i[0],a=i[1],l=i[2],u=s*l-r*a,c=r*o-n*l,h=n*a-s*o,d=Math.sqrt(u*u+c*c+h*h);return t[0]=u/d,t[1]=c/d,t[2]=h/d,t}function xZ(t,e,i,n){const s=e[0],r=e[1],o=e[2];return t[0]=s+n*(i[0]-s),t[1]=r+n*(i[1]-r),t[2]=o+n*(i[2]-o),t}function MZ(t,e,i,n,s,r){const o=r*r,a=o*(2*r-3)+1,l=o*(r-2)+r,u=o*(r-1),c=o*(3-2*r);return t[0]=e[0]*a+i[0]*l+n[0]*u+s[0]*c,t[1]=e[1]*a+i[1]*l+n[1]*u+s[1]*c,t[2]=e[2]*a+i[2]*l+n[2]*u+s[2]*c,t}function TZ(t,e,i,n,s,r){const o=1-r,a=o*o,l=r*r,u=a*o,c=3*r*a,h=3*l*o,d=l*r;return t[0]=e[0]*u+i[0]*c+n[0]*h+s[0]*d,t[1]=e[1]*u+i[1]*c+n[1]*h+s[1]*d,t[2]=e[2]*u+i[2]*c+n[2]*h+s[2]*d,t}function AZ(t,e=1){const i=mI,n=2*i()*Math.PI,s=2*i()-1,r=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=s*e,t}function IZ(t,e,i){const n=e[0],s=e[1],r=e[2];return t[0]=i[0]*n+i[4]*s+i[8]*r+i[12],t[1]=i[1]*n+i[5]*s+i[9]*r+i[13],t[2]=i[2]*n+i[6]*s+i[10]*r+i[14],t}function kZ(t,e,i){const n=e[0],s=e[1],r=e[2];return t[0]=n*i[0]+s*i[3]+r*i[6],t[1]=n*i[1]+s*i[4]+r*i[7],t[2]=n*i[2]+s*i[5]+r*i[8],t}function CZ(t,e,i){const n=i[0],s=i[1],r=i[2],o=i[3],a=e[0],l=e[1],u=e[2],c=s*u-r*l,h=r*a-n*u,d=n*l-s*a,f=s*d-r*h,p=r*c-n*d,m=n*h-s*c,y=2*o;return t[0]=a+c*y+2*f,t[1]=l+h*y+2*p,t[2]=u+d*y+2*m,t}function EZ(t,e,i,n){const s=[],r=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],r[0]=s[0],r[1]=s[1]*Math.cos(n)-s[2]*Math.sin(n),r[2]=s[1]*Math.sin(n)+s[2]*Math.cos(n),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function jZ(t,e,i,n){const s=[],r=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],r[0]=s[2]*Math.sin(n)+s[0]*Math.cos(n),r[1]=s[1],r[2]=s[2]*Math.cos(n)-s[0]*Math.sin(n),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function OZ(t,e,i,n){const s=[],r=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],r[0]=s[0]*Math.cos(n)-s[1]*Math.sin(n),r[1]=s[0]*Math.sin(n)+s[1]*Math.cos(n),r[2]=s[2],t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function RZ(t,e){wZ(LZ,t),wZ(NZ,e);const i=bZ(LZ,NZ);return i>1?0:i<-1?Math.PI:Math.acos(i)}const LZ=Yv(),NZ=Yv();function PZ(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function FZ(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function DZ(t,e){if(t===e)return!0;const i=t[0],n=t[1],s=t[2],r=e[0],o=e[1],a=e[2],l=fI();return Math.abs(i-r)<=l*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(n-o)<=l*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(s-a)<=l*Math.max(1,Math.abs(s),Math.abs(a))}function $Z(t,e,i){const n=i[0]-e[0],s=i[1]-e[1],r=i[2]-e[2];let o=n*n+s*s+r*r;return o>0?(o=1/Math.sqrt(o),t[0]=n*o,t[1]=s*o,t[2]=r*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const zZ=eZ,UZ=iZ,BZ=nZ,GZ=pZ,VZ=mZ,qZ=KW,HZ=yZ;Object.freeze(Object.defineProperty({__proto__:null,abs:oZ,add:tZ,angle:RZ,bezier:TZ,ceil:sZ,clamp:cZ,copy:QW,cross:SZ,crossAndNormalize:_Z,direction:$Z,dist:GZ,distance:pZ,div:BZ,divide:nZ,dot:bZ,equals:DZ,exactEquals:FZ,floor:rZ,hermite:MZ,inverse:vZ,len:qZ,length:KW,lerp:xZ,max:uZ,min:lZ,mul:UZ,multiply:iZ,negate:gZ,normalize:wZ,random:AZ,rotateX:EZ,rotateY:jZ,rotateZ:OZ,round:hZ,scale:dZ,scaleAndAdd:fZ,set:XW,sign:aZ,sqrDist:VZ,sqrLen:HZ,squaredDistance:mZ,squaredLength:yZ,str:PZ,sub:zZ,subtract:eZ,transformMat3:kZ,transformMat4:IZ,transformQuat:CZ},Symbol.toStringTag,{value:"Module"}));function WZ(t){let e=t*t;return t<0&&(e*=-1),e}function ZZ(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function JZ(t,e,i){const n=i,s=t.state,r=t.device,o="forward-down"===e.tiltDirection?1:-1,a=1;return"standard"===r.deviceType?(n.translation[0]=WZ(s.axes[0]),n.translation[1]=WZ(s.axes[1]),n.translation[2]=WZ(s.buttons[7])-WZ(s.buttons[6]),n.heading=WZ(s.axes[2]),n.tilt=WZ(s.axes[3])):"spacemouse"===r.deviceType&&(n.translation[0]=1.2*WZ(s.axes[0]),n.translation[1]=1.2*WZ(s.axes[1]),n.translation[2]=2*-WZ(s.axes[2]),n.heading=1.2*WZ(s.axes[5]),n.tilt=1.2*WZ(s.axes[3])),n.tilt*=o,dZ(n.translation,n.translation,a),n}function YZ(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}class KZ extends aM{constructor(t){super(!0),this._view=t,this._frameTask=null,this._watchHandles=new Sn,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",(t=>this._handleGamePadEvent(t))),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([ey((()=>this._view.navigation.gamepad?.enabled),(t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=ir({update:t=>this._frameUpdate(t.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))}),dy)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const e=this._view.navigation.gamepad.device;e&&t.data.device!==e||this._currentDevice&&this._currentDevice!==t.data.device||("end"===t.data.action?(this._currentDevice=null,ZZ(this._transformation)):(this._currentDevice=t.data.device,JZ(t.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(t){const e=this._transformation;if(YZ(e))return;const i=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,s=XZ*n*t;MV(i,i,[e.translation[0]*s,-e.translation[1]*s]);const r=1+e.translation[2]*tJ*t,o=this._view.constraints.rotationEnabled?-e.heading*QZ*t:0,a=this._view.size,l=[a[0]/2,a[1]];bV(i,i,r,o,l,a);const u=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=u}}const QZ=.06,XZ=.7,tJ=6e-4;function eJ(t){const e=()=>t("visible"===document.visibilityState);return document.addEventListener("visibilitychange",e),we((()=>document.removeEventListener("visibilitychange",e)))}class iJ extends aM{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=t=>{const e=this._keyMap[t.data.key];if(t.modifiers.has("Meta")||t.modifiers.has("Control"))return void this._stopMovement();if(null==e)return;t.stopPropagation(),t.preventDefault();const i="key-down"===t.type;if(this._pressedKeys[i?"add":"delete"](e),i){if(this._direction===e)return;this._direction=e,this._isSticky=!1,this._setTimeout((()=>{this._isSticky&&this._handlePopKey()}))}else{const t=void 0===this._timeout,e=this._pressedKeys.size>0;t||e?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),null==this._direction&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[e.left]:"left",[e.right]:"right",[e.up]:"up",[e.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=eJ((t=>t?null:this._stopMovement()))}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(t){const e=null!=this._currentDirection;if(null!=t){if(e||this.view.mapViewNavigation.begin(),this._currentDirection!==t)switch(t){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else e&&this.view.mapViewNavigation.stop();this._currentDirection=t}_setTimeout(t){clearTimeout(this._timeout),this._timeout=void 0===t?void 0:setTimeout((()=>{this._timeout=void 0,t()}),this._stickyKeyDuration)}}class nJ extends aM{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._pressed=!1,this._keyToDirection={[e.clockwiseOption1]:"clockwise",[e.clockwiseOption2]:"clockwise",[e.counterClockwiseOption1]:"counterClockwise",[e.counterClockwiseOption2]:"counterClockwise",[e.resetOption1]:"reset",[e.resetOption2]:"reset"},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),this.registerIncoming("key-up",i,(t=>this._handleKeyUp(t))),this.registerIncoming("blur",i,(()=>this._handleStop())),this._visibilityHandle=eJ((t=>t?null:this._handleStop()))}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,e){const i=t.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[t.data.key];if(this._pressed=null!=n,this._pressed){if(t.preventDefault(),e)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}}var sJ;!function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"}(sJ||(sJ={}));class rJ extends aM{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._keysToZoomAction={},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),e.zoomIn.forEach((t=>this._keysToZoomAction[t]=sJ.IN)),e.zoomOut.forEach((t=>this._keysToZoomAction[t]=sJ.OUT))}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const e=t.modifiers;if(e.size>0&&!e.has("Shift"))return;const{key:i}=t.data;if(!(i in this._keysToZoomAction))return;const n=this._keysToZoomAction[i],{mapViewNavigation:s}=this.view;let r=null;switch(n){case sJ.IN:r=s.zoomIn();break;case sJ.OUT:r=s.zoomOut();break;default:return}s.begin(),r.then((()=>s.end())),t.stopPropagation()}}const oJ=.6;class aJ extends aM{constructor(t,e){super(!0),this._view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",e,(t=>this._handleMouseWheel(t)))}_handleMouseWheel(t){if(!this._view.navigation.mouseWheelZoomEnabled)return;if(t.preventDefault(),t.stopPropagation(),!this._canZoom)return;const e=this._view.mapViewNavigation,{x:i,y:n,deltaY:s}=t.data,r=1/oJ**(1/60*s),o=e.zoom(r,[i,n]);o&&(this._canZoom=!1,o.catch((()=>{})).then((()=>{this._canZoom=!0,e.end()})))}}class lJ extends aM{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this._stopMomentumNavigation()));const e=this.view.mapViewNavigation;this._dragEventSeparator=new ZW({start:(t,i)=>{e.pinch.begin(this.view,i.data),i.stopPropagation()},update:(t,i)=>{e.pinch.update(this.view,i.data),i.stopPropagation()},end:(t,i)=>{e.pinch.end(this.view),i.stopPropagation()},condition:t=>t>=2})}_handleDrag(t){this._dragEventSeparator.handle(t)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}function uJ(t){const e=t.native;return e?{buttons:e.buttons.map((t=>t.pressed?t.value||1:0)),axes:e.axes.map((e=>dJ(e,t.axisThreshold)))}:{buttons:[],axes:[]}}function cJ(t,e){if(t.axes.length!==e.axes.length)return!1;if(t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function hJ(t){for(let e=0;e<t.axes.length;e++)if(0!==t.axes[e])return!1;for(let e=0;e<t.buttons.length;e++)if(0!==t.buttons[e])return!1;return!0}function dJ(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}class fJ{constructor(t,e){this._element=t,this._input=e,this._hasEventListeners=!1,this._onConnectGamepad=t=>{this._connectGamepad(t.gamepad)},this._onDisconnectGamepad=t=>{const e=t.gamepad,i=e.index,n=this._inputDevices[i];n&&(this._emitGamepadEvent(e,uJ(n),!1),this._inputDevices.splice(i,1),this._latestUpdate.splice(i,1),this._input.gamepad.devices.remove(n),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(mJ((t=>this._connectGamepad(t))),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this._callback=t}_connectGamepad(t){const e=new Gz(t);"unknown"!==e.deviceType&&(this._inputDevices[t.index]=e,this._input.gamepad.devices.add(e)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){null==this._frameTask&&(this._frameTask=ir({update:()=>this._readGamepadState()}))}_stopPolling(){null!=this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const t=document.hasFocus(),e=this._element.contains(document.activeElement),i="document"===this._input.gamepad.enabledFocusMode&&!t||"view"===this._input.gamepad.enabledFocusMode&&!e;mJ((t=>{const e=this._inputDevices[t.index];if(!e)return;const n=this._latestUpdate[t.index],s=uJ(e),r=i||hJ(s);if(n){if(n.timestamp===t.timestamp)return;if(!n.active&&r)return;if(cJ(n.state,s))return}this._emitGamepadEvent(t,s,!r)}))}_emitGamepadEvent(t,e,i){const n=this._latestUpdate[t.index],s=n&&n.active;if(!s&&!i)return;const r=!s&&i?"start":s&&i?"update":"end";this._latestUpdate[t.index]={timestamp:t.timestamp,state:e,active:i},this._callback&&this._callback({device:this._inputDevices[t.index],state:e,action:r})}}function pJ(t){if(!t)return!1;if(!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function mJ(t){for(const e of navigator.getGamepads())pJ(e)&&t(e)}const yJ=u("edge"),gJ=u("chrome"),vJ=u("ff"),wJ=u("safari"),bJ="esri-view-surface",SJ={touchNone:`${bJ}--touch-none`,touchPan:`${bJ}--touch-pan`};class _J{constructor(t,e){this._input=e,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new fJ(t,this._input),this._gamepadSource.onEvent=t=>this._callback("gamepad",t)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach((t=>{this._releasePointerCaptureSafe(t)})),this._gamepadSource=An(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(t){this._browserTouchPanningEnabled=t,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(t){this._callback=t}set activeEvents(t){for(const e in this._active)if(!t||!t.has(e)){const t=this._active[e];this._element.removeEventListener(xJ[e],t),delete this._active[e]}t&&t.forEach((t=>{if(!this._active[t]&&xJ[t]){const e=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(xJ[t],e),this._active[t]=e}})),this._gamepadSource.hasEventListeners=t?.has("gamepad")??!1}setPointerCapture(t,e){e?this._setPointerCatpureSafe(t.pointerId):(this._releasePointerCaptureSafe(t.pointerId),this._activePointerCaptures.delete(t.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?SJ.touchNone:SJ.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?SJ.touchPan:SJ.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(SJ.touchNone),this._element.classList.remove(SJ.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(t){try{this._element.setPointerCapture(t),this._activePointerCaptures.add(t)}catch{}}_releasePointerCaptureSafe(t){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(t))return;this._element.releasePointerCapture(t)}catch(t){}}_updateNormalizedPointerLikeEvent(t,e){const i=kz(this._element,t);return _J.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),e.x=i.x,e.y=i.y,e}_handleKey(t,e){const{key:i}=e;i&&"key-up"===t&&this._keyDownState.delete(i);const n={native:e,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&"key-down"===t&&this._keyDownState.add(n.key),this._callback(t,n)}_handlePointer(t,e){const i=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,pointerType:e.pointerType,button:e.button,buttons:e.buttons,eventId:this._eventId++});this._callback(t,i)}_handlePointerPreventDefault(t,e){const i=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,pointerType:e.pointerType,button:e.button,buttons:e.buttons,eventId:this._eventId++});e.preventDefault(),this._callback(t,i)}_getDeltaFromTrackpadOrMouseWheel(t){return t.shiftKey&&u("mac")&&0===t.deltaY?t.deltaX:t.deltaY}_handleMouseWheel(t,e){let i=this._getDeltaFromTrackpadOrMouseWheel(e);switch(e.deltaMode){case 0:yJ&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}yJ?i*=.7:gJ||wJ?i*=.6:vJ&&(i*=1.375);const n=100,s=Math.abs(i);if(s>n){const t=.02;i=i/s*200/(1+Math.exp(-t*(s-n)))}const r=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,deltaY:i});this._callback(t,r)}_handlePointerCaptureLost(t,e){this._activePointerCaptures.delete(e.pointerId),this._handleDefault(t,e)}_handleDefault(t,e){const i={native:e};e.preventDefault(),this._callback(t,i)}_preventAltKeyDefault(t){"Alt"===t.key&&t.preventDefault()}_preventMultiTouchPanning(t){t.touches.length>1&&t.preventDefault()}}_J.test={disableSubpixelCoordinates:!1};const xJ={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};class MJ extends aM{constructor(){super(!0),this.registerIncoming("context-menu",(t=>t.data.native.preventDefault()))}}const TJ={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function AJ(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function IJ(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}function kJ(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:eI()},0===t.length)return e;if(1===t.length)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(2===t.length){const[i,n]=t,[s,r]=[n.x-i.x,n.y-i.y];return e.radius=Math.sqrt(s*s+r*r)/2,e.center.x=(i.x+n.x)/2,e.center.y=(i.y+n.y)/2,e}let i=0,n=0;for(let e=0;e<t.length;e++)i+=t[e].x,n+=t[e].y;i/=t.length,n/=t.length;const s=t.map((t=>t.x-i)),r=t.map((t=>t.y-n));let o=0,a=0,l=0,u=0,c=0,h=0,d=0;for(let t=0;t<s.length;t++){const e=s[t],i=r[t],n=e*e,f=i*i;o+=n,a+=f,l+=e*i,u+=n*e,c+=f*i,h+=e*f,d+=i*n}const f=.5*(u+h),p=.5*(c+d),m=o*a-l*l,y=(f*a-p*l)/m,g=(o*p-l*f)/m,v=eI(y+i,g+n);return{radius:Math.sqrt(y*y+g*g+(o+a)/t.length),center:v}}function CJ(t){const{native:e}=t,{pointerId:i,button:n,pointerType:s}=e;return"mouse"===s?`${i}:${n}`:`${s}`}class EJ extends aM{constructor(t=TJ.maximumDoubleClickDelay,e=TJ.maximumDoubleClickDistance,i=TJ.maximumDoubleTouchDelay,n=TJ.maximumDoubleTouchDistance,s=ps){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=e,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=eI(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new ZW({start:(t,e)=>this._dragStart(t,e),update:(t,e)=>this._dragUpdate(e),end:(t,e)=>this._dragEnd(e)}),this.registerIncoming("drag",(t=>this._dragEventSeparator.handle(t))),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((t=>{t.doubleTapTimeout=kn(t.doubleTapTimeout)}))}get hasPendingInputs(){for(const t of this._pointerState.values())if(null!=t.doubleTapTimeout)return!0;return!1}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout=kn(e.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_dragStart(t,e){if(!this._doubleTapDragReady||1!==t)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:n}=e,{center:s}=i;this._dragStartCenter=s;const r=jJ("begin",eI(0,0),i);this._doubleTapDrag.emit(r,void 0,n),e.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:n}=e,s=jJ("update",eI(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),e);this._doubleTapDrag.emit(s,void 0,i),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:n}=e,s=jJ("end",eI(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),e);this._doubleTapDrag.emit(s,void 0,i),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:e}=t,i=CJ(e),n=this._pointerState.get(i),{pointerType:s}=e.native;if(n){const r="touch"===s?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(i),AJ(n.event.data,e)>r?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){const{data:e}=t,{pointerType:i}=e.native,n=CJ(e),s="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout((()=>this._clearPointerDown(n)),s);this._pointerState.set(n,{event:t,doubleTapTimeout:r}),this.refreshHasPendingInputs()}}function jJ(t,e,i){const{button:n,buttons:s,pointer:r,pointers:o,pointerType:a,timestamp:l}=i;return{action:t,delta:e,button:n,buttons:s,pointer:r,pointers:o,pointerType:a,timestamp:l}}class OJ extends aM{constructor(t){super(!1),this._navigationTouch=t,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(t,e,i,n){return{action:t,pointerType:this._pointerType,button:this._mouseButton,buttons:e.buttons,timestamp:n,pointers:NJ(this._activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(t){const e=t.native.pointerId,i=LJ(this._activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this._activePointerMap.set(e,n);const s=PJ(n,RJ(this._activePointerMap));n.initialAngle=s,n.lastAngle=s,this._updatePointerAngles(i)}_updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this._activePointerMap.get(e);i?i.event=t:this._addPointer(t)}_removePointer(t){const e=LJ(this._activePointerMap).angle;this._activePointerMap.delete(t),this._updatePointerAngles(e)}_updatePointerAngles(t){const e=LJ(this._activePointerMap);this._activePointerMap.forEach((i=>{i.initialAngle=PJ(i,e)-t,i.lastAngle=PJ(i,e)-t}))}_emitEvent(t,e,i){const n=LJ(this._activePointerMap);this._drag.emit(this._createPayload(t,e,n,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(t){const e=t.data.native.pointerId,i=Bs(t.timestamp);this._activePointerMap.get(e)&&(1===this._activePointerMap.size?(this._updatePointer(t.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",t.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(e)):(this._removePointer(e),this._emitEvent("removed",t.data,Bs(t.timestamp))))}_handlePointerDrag(t){const e=t.data,i=e.currentEvent,n=Bs(t.timestamp);switch(e.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,n)):(this._addPointer(i),this._emitEvent("added",i,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=t.data.startEvent.pointerType,this._mouseButton=t.data.startEvent.button,this._startStateModifiers=t.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&"touch"===this._pointerType&&1===this._activePointerMap.size}}function RJ(t){const e=[];return t.forEach((t=>{e.push(eI(t.event.x,t.event.y))})),kJ(e)}function LJ(t){const e=RJ(t);let i=0;return t.forEach((t=>{let n=PJ(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function NJ(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function PJ(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var FJ;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"}(FJ||(FJ={}));class DJ extends aM{constructor(t=TJ.maximumDoubleClickDelay,e=TJ.maximumDoubleClickDistance,i=TJ.maximumDoubleTouchDelay,n=TJ.maximumDoubleTouchDistance,s=ps){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=e,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=CJ(e);if(!this._pointerState.has(i)){const t={downButton:e.native.button,x:e.x,y:e.y,immediateDoubleClick:null};this._pointerState.set(i,t),this.startCapturingPointer(e.native)}}_handlePointerUp(t){const e=t.data,i=CJ(e),n=this._pointerState.get(i);if(n&&n.downButton===e.native.button){const i=n.immediateDoubleClick,s="touch"===t.data.native.pointerType?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;i?(i.timeoutHandle.remove(),AJ(i,t.data)>s?this._startImmediateDoubleClick(t,n):(this._immediateDoubleClick.emit(t.data,void 0,i.modifiers),this._removeState(e))):AJ(n,t.data)>s?this._removeState(e):this._startImmediateDoubleClick(t,n)}}_startImmediateDoubleClick(t,e){const i="touch"===t.data.native.pointerType?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),i)}}_removeState(t){const e=CJ(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}}class $J extends aM{constructor(t=TJ.maximumClickDelay,e=TJ.movementUntilMouseDrag,i=TJ.movementUntilPenDrag,n=TJ.movementUntilTouchDrag,s=TJ.holdDelay,r=ps){super(!1),this._maximumClickDelay=t,this._movementUntilMouseDrag=e,this._movementUntilPenDrag=i,this._movementUntilTouchDrag=n,this._holdDelay=s,this._clock=r,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t))),this.registerIncoming("pointer-up",(t=>this._handlePointerLoss(t,"pointer-up"))),this.registerIncoming("pointer-capture-lost",(t=>this._handlePointerLoss(t,"pointer-capture-lost"))),this.registerIncoming("pointer-cancel",(t=>this._handlePointerLoss(t,"pointer-cancel"))),this._moveHandle=this.registerIncoming("pointer-move",(t=>this._handlePointerMove(t))),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((t=>{t.holdTimeout=kn(t.holdTimeout)})),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);if(e){if(!e.isDragging){const i=e.previousEvent;this._pointerHold.emit(i,void 0,t.modifiers),e.holdEmitted=!0}e.holdTimeout=null}}),this._holdDelay));const s={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,s),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t)}_handlePointerMove(t){const e=t.data,i=e.native.pointerId,n=this._pointerState.get(i);if(n){if(n.isDragging)this._pointerDrag.emit(zJ("update",n,e),void 0,n.modifiers);else{IJ(e,n.startEvent)>this._getDragThreshold(e.native.pointerType)&&this._startDragging(t)}n.previousEvent=e}}_getDragThreshold(t){switch(t){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(zJ("start",n,e)):this._pointerDrag.emit(zJ("start",n,n.previousEvent),t.timestamp))}))}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,s=this._pointerState.get(n);if(s){if(null!=s.holdTimeout&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging)this._pointerDrag.emit(zJ("end",s,"pointer-up"===e?i:s.previousEvent),void 0,s.modifiers);else if("pointer-up"===e&&s.downButton===i.native.button){t.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(i)}this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause()}}}function zJ(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}class UJ extends aM{constructor(t=TJ.maximumDoubleClickDelay,e=TJ.maximumDoubleClickDistance,i=TJ.maximumDoubleTouchDelay,n=TJ.maximumDoubleTouchDistance,s=ps){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=e,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",(t=>this._handleImmediateClick(t))),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t)))}onUninstall(){this._pointerState.forEach((t=>t.doubleClickTimer=kn(t.doubleClickTimer)))}get hasPendingInputs(){for(const t of this._pointerState.values())if(null!=t.doubleClickTimer)return!0;return!1}_clearDoubleClickTimer(t,e){const i=this._pointerState.get(t);i&&(i.doubleClickTimer=kn(i.doubleClickTimer),e&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const e=this._pointerState.get(t);1===e.pointerDownCount&&this._click.emit(e.event.data,void 0,e.event.modifiers),e.doubleClickTimer=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}_handleImmediateClick(t){const e=t.data,{pointerType:i}=e.native,n=BJ(e);if(!this._pointerState.has(n))return void this._startClick(t);const s=this._pointerState.get(n),{data:r,modifiers:o}=s.event,a="touch"===i?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;AJ(r,e)>a?(this._clearDoubleClickTimer(n,!0),this._startClick(t)):(this._clearDoubleClickTimer(n,!1),2===s.pointerDownCount&&this._doubleClick.emit(r,void 0,o))}_handlePointerDown(t){const e=CJ(t.data),i=this._pointerState.get(e);i&&(i.pointerDownCount+=1)}_startClick(t){const{data:e}=t,{native:{pointerType:i}}=e,n=CJ(e),s="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(n)),s),o=1;this._pointerState.set(n,{event:t,doubleClickTimer:r,pointerDownCount:o}),this.refreshHasPendingInputs()}}function BJ(t){const{pointerId:e,pointerType:i,button:n}=t.native;return"mouse"===i?`${e}:${n}`:`${i}`}const GJ={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let VJ=class extends ao{initialize(){const t=()=>this.view?.ready;this.addHandles([iy((()=>!t()),(()=>this._disconnect())),iy(t,(()=>this._connect()))])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(t){return this._inputManager?.isModifierKeyDown(t)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=An(this._inputManager)}_connect(){const t=this.view.surface,e=new _J(t,this.view.input),i=[new DJ,new $J,new UJ,new OJ(this.view.navigation),new EJ],n=new mM({eventSource:e,recognizers:i});n.installHandlers("prevent-context-menu",[new MJ],vM.INTERNAL),n.installHandlers("navigation",[new lJ(this.view),new KZ(this.view),new aJ(this.view),new HW(this.view),new HW(this.view,[GJ.counter]),new JW(this.view,"primary"),new iJ(this.view,GJ.pan),new rJ(this.view,GJ.zoom),new nJ(this.view,GJ.rotate),new YW(this.view,"secondary"),new WW(this.view,"touch")],vM.INTERNAL),this.view.viewEvents.connect(n),this._source=e,this._inputManager=n,ey((()=>this.view?.navigation?.browserTouchPanEnabled),(t=>{this._source&&(this._source.browserTouchPanningEnabled=!t)}),dy)}get test(){}};r([Je()],VJ.prototype,"view",void 0),r([Je()],VJ.prototype,"latestPointerType",null),r([Je()],VJ.prototype,"latestPointerLocation",null),r([Je()],VJ.prototype,"multiTouchActive",null),VJ=r([ln("esri.views.2d.input.MapViewInputManager")],VJ);const qJ=VJ;function HJ(t,e,i,n,s){WJ(t,e,i||0,n||t.length-1,s||JJ)}function WJ(t,e,i,n,s){for(;n>i;){if(n-i>600){var r=n-i+1,o=e-i+1,a=Math.log(r),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(r-l)/r)*(o-r/2<0?-1:1);WJ(t,e,Math.max(i,Math.floor(e-o*l/r+u)),Math.min(n,Math.floor(e+(r-o)*l/r+u)),s)}var c=t[e],h=i,d=n;for(ZJ(t,i,e),s(t[n],c)>0&&ZJ(t,i,n);h<d;){for(ZJ(t,h,d),h++,d--;s(t[h],c)<0;)h++;for(;s(t[d],c)>0;)d--}0===s(t[i],c)?ZJ(t,i,d):ZJ(t,++d,n),d<=e&&(i=d+1),e<=d&&(n=d-1)}}function ZJ(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function JJ(t,e){return t<e?-1:t>e?1:0}function YJ(t,e){if(!(this instanceof YJ))return new YJ(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this.toBBox=e:this._initFormat(e)),this.clear()}function KJ(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function QJ(t,e){XJ(t,0,t.children.length,e,t)}function XJ(t,e,i,n,s){s||(s=uY(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var r,o=e;o<i;o++)r=t.children[o],tY(s,t.leaf?n(r):r);return s}function tY(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function eY(t,e){return t.minX-e.minX}function iY(t,e){return t.minY-e.minY}function nY(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function sY(t){return t.maxX-t.minX+(t.maxY-t.minY)}function rY(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function oY(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,s-i)*Math.max(0,r-n)}function aY(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function lY(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function uY(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function cY(t,e,i,n,s){for(var r,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=n||(r=e+Math.ceil((i-e)/n/2)*n,HJ(t,r,e,i,s),o.push(e,r,r,i))}YJ.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!lY(t,e))return i;for(var s,r,o,a,l=[];e;){for(s=0,r=e.children.length;s<r;s++)o=e.children[s],lY(t,a=e.leaf?n(o):o)&&(e.leaf?i.push(o):aY(t,a)?this._all(o,i):l.push(o));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!lY(t,e))return!1;for(var n,s,r,o,a=[];e;){for(n=0,s=e.children.length;n<s;n++)if(r=e.children[n],lY(t,o=e.leaf?i(r):r)){if(e.leaf||aY(t,o))return!0;a.push(r)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return null!=t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=uY([]),this},remove:function(t,e){if(null==t)return this;for(var i,n,s,r,o=this.data,a=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],i=u.pop(),r=!0),o.leaf&&-1!==(s=KJ(t,o.children,e)))return o.children.splice(s,1),l.push(o),this._condense(l),this;r||o.leaf||!aY(o,a)?n?(i++,o=n.children[i],r=!1):o=null:(l.push(o),u.push(i),i=0,n=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:eY,compareMinY:iY,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var s,r=i-e+1,o=this._maxEntries;if(r<=o)return QJ(s=uY(t.slice(e,i+1)),this.toBBox),s;n||(n=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,n-1))),(s=uY([])).leaf=!1,s.height=n;var a,l,u,c,h=Math.ceil(r/o),d=h*Math.ceil(Math.sqrt(o));for(cY(t,e,i,d,this.compareMinX),a=e;a<=i;a+=d)for(cY(t,a,u=Math.min(a+d-1,i),h,this.compareMinY),l=a;l<=u;l+=h)c=Math.min(l+h-1,u),s.children.push(this._build(t,l,c,n-1));return QJ(s,this.toBBox),s},_chooseSubtree:function(t,e,i,n){for(var s,r,o,a,l,u,c,h;n.push(e),!e.leaf&&n.length-1!==i;){for(c=h=1/0,s=0,r=e.children.length;s<r;s++)l=nY(o=e.children[s]),(u=rY(t,o)-l)<h?(h=u,c=l<c?l:c,a=o):u===h&&l<c&&(c=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,s=i?t:n(t),r=[],o=this._chooseSubtree(s,this.data,e,r);for(o.children.push(t),tY(o,s);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(s,r,e)},_split:function(t,e){var i=t[e],n=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,n);var r=this._chooseSplitIndex(i,s,n),o=uY(i.children.splice(r,i.children.length-r));o.height=i.height,o.leaf=i.leaf,QJ(i,this.toBBox),QJ(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=uY([t,e]),this.data.height=t.height+1,this.data.leaf=!1,QJ(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,s,r,o,a,l,u,c;for(l=u=1/0,n=e;n<=i-e;n++)o=oY(s=XJ(t,0,n,this.toBBox),r=XJ(t,n,i,this.toBBox)),a=nY(s)+nY(r),o<l?(l=o,c=n,u=a<u?a:u):o===l&&a<u&&(u=a,c=n);return c},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:eY,s=t.leaf?this.compareMinY:iY;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,s)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var s,r,o=this.toBBox,a=XJ(t,0,e,o),l=XJ(t,i-e,i,o),u=sY(a)+sY(l);for(s=e;s<i-e;s++)r=t.children[s],tY(a,t.leaf?o(r):r),u+=sY(a);for(s=i-e-1;s>=e;s--)r=t.children[s],tY(l,t.leaf?o(r):r),u+=sY(l);return u},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)tY(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():QJ(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};class hY{constructor(t,e){this.key=new vW(0,0,0,0),this.bounds=Bf(),this.objectIds=new Set,this.key.set(e);const i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.level=i.level,this.scale=i.scale,this.minScale=t.zoomToScale(i.level-1),this.maxScale=t.zoomToScale(i.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return Od.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(t){return{$view:{scale:this.scale,timeZone:t}}}createChildTiles(){const t=this.key.getChildKeys(),e=es.acquire();for(let i=0;i<t.length;i++)e[i]=new hY(this.tileInfoView,t[i]);return e}getQuantizationParameters(){return N$.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}}const dY={added:[],removed:[]},fY=new Set,pY=new vW(0,0,0,0);function mY(t,e){const i=Vu(e);if(!i)return null;const[n,s]=i.valid;return t[2]>s?[Bf([t[0],t[1],s,t[3]]),Bf([n,t[1],n+t[2]-s,t[3]])]:t[0]<n?[Bf([n,t[1],t[2],t[3]]),Bf([s-(n-t[0]),t[1],s,t[3]])]:null}class yY extends Tm{constructor(t){super(),this._tiles=new Map,this._index=YJ(9,u("esri-csp-restrictions")?t=>({minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}getIntersectingTiles(t){if(!t||0===Jf(t)||0===Yf(t))return[];const e=mY(t,this.tileScheme.spatialReference);return null!=e?[...new Set([...this.boundsIntersections(e[0]),...this.boundsIntersections(e[1])])]:this.boundsIntersections(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const e={added:[],removed:[]};for(const i of t.added)if(!this.has(i)){const t=new hY(this.tileScheme,i);this._tiles.set(i,t),this._index.insert(t),e.added.push(t)}for(const i of t.removed)if(this.has(i)){const t=this.get(i);this._tiles.delete(i),this._index.remove(t),e.removed.push(t)}this.tiles.length=0,this._tiles.forEach((t=>this.tiles.push(t))),(e.added.length||e.removed.length)&&this.emit("update",e)}setViewState(t){const e=this.tileScheme.getTileCoverage(t,0);if(!e)return;const{spans:i,lodInfo:n}=e,{level:s}=n;if(i.length>0)for(const{row:t,colFrom:e,colTo:r}of i)for(let i=e;i<=r;i++){const e=pY.set(s,t,n.normalizeCol(i),n.getWorldForColumn(i)).id;if(fY.add(e),!this.has(e)){const t=new hY(this.tileScheme,e);this._tiles.set(e,t),this._index.insert(t),this.tiles.push(t),dY.added.push(t)}}for(let t=this.tiles.length-1;t>=0;t--){const e=this.tiles[t];fY.has(e.id)||(this._tiles.delete(e.id),this.tiles.splice(t,1),this._index.remove(e),dY.removed.push(e))}(dY.added.length||dY.removed.length)&&this.emit("update",dY),MW.pool.release(e),fY.clear(),dY.added.length=0,dY.removed.length=0}}const gY=1e-30,vY=512,wY=16777216,bY=8,SY=29,_Y=24,xY=4,MY=0,TY=0,AY=0,IY=1,kY=2,CY=3,EY=4,jY=5,OY=6,RY=12,LY=13,NY=5,PY=6,FY=5,DY=6;var $Y;!function(t){t[t.FilterFlags=0]="FilterFlags",t[t.Animation=1]="Animation",t[t.GPGPU=2]="GPGPU",t[t.VV=3]="VV",t[t.DD0=4]="DD0",t[t.DD1=5]="DD1",t[t.DD2=6]="DD2",t[t.LocalTimeOrigin=7]="LocalTimeOrigin"}($Y||($Y={}));const zY=6,UY=1<<zY,BY=UY<<1,GY=1.05,VY=3,qY=1,HY=3,WY=3,ZY=5,JY=6,YY=1.15,KY=2,QY=128,XY=256,tK=XY-2*KY,eK=2,iK=128,nK=10,sK=1024,rK=128,oK=4,aK=1,lK=1<<20,uK=.75,cK=10,hK=.75,dK=256,fK=32,pK=512,mK=0,yK=1;const gK=1,vK=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],wK=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],bK=256;const SK=new RA("cyan"),_K=1,xK=.25;new RA("black");const MK="default",TK="temporary",AK=new RA("yellow");let IK=class extends ao{constructor(t){super(t),this.color=SK.clone(),this.haloOpacity=_K,this.fillOpacity=xK}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity}};r([Je({type:RA})],IK.prototype,"color",void 0),r([Je({type:RA})],IK.prototype,"haloColor",void 0),r([Je()],IK.prototype,"haloOpacity",void 0),r([Je()],IK.prototype,"fillOpacity",void 0),IK=r([ln("esri.views.support.HighlightOptions")],IK);const kK=IK;var CK;let EK=CK=class extends kK{constructor(t){super(t),this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return super.equals(t)&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur}get optionsKey(){return`${this.color};${this.haloColor};${this.haloOpacity};${this.fillOpacity};${this.haloWidth};${this.haloBlur}`}clone(){return new CK({color:this.color.clone(),haloColor:this.haloColor?.clone(),haloOpacity:this.haloOpacity,fillOpacity:this.fillOpacity,haloWidth:this.haloWidth,haloBlur:this.haloBlur})}};r([Je()],EK.prototype,"haloWidth",void 0),r([Je()],EK.prototype,"haloBlur",void 0),EK=CK=r([ln("esri.views.2d.support.HighlightOptions")],EK);const jK=EK;var OK,RK,LK,NK,PK,FK,DK,$K,zK,UK,BK,GK,VK,qK,HK,WK,ZK,JK,YK,KK;!function(t){t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t[t.COLOR=16384]="COLOR"}(OK||(OK={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(RK||(RK={})),function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(LK||(LK={})),function(t){t[t.ADD=32774]="ADD",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.SUBTRACT=32778]="SUBTRACT",t[t.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(NK||(NK={})),function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"}(PK||(PK={})),function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(FK||(FK={})),function(t){t[t.CW=2304]="CW",t[t.CCW=2305]="CCW"}(DK||(DK={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=5131]="HALF_FLOAT"}($K||($K={})),function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"}(zK||(zK={})),function(t){t[t.ZERO=0]="ZERO",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP"}(UK||(UK={})),function(t){t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(BK||(BK={})),function(t){t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(GK||(GK={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(VK||(VK={})),function(t){t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.RED=6403]="RED",t[t.RG=33319]="RG",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER"}(qK||(qK={})),function(t){t[t.RGBA4=32854]="RGBA4",t[t.R16F=33325]="R16F",t[t.RG16F=33327]="RG16F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.R32F=33326]="R32F",t[t.RG32F=33328]="RG32F",t[t.RGBA32F=34836]="RGBA32F",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB5_A1=32855]="RGB5_A1",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RGB16F=34843]="RGB16F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGB565=36194]="RGB565",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGB10_A2UI=36975]="RGB10_A2UI"}(HK||(HK={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.INT=5124]="INT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(WK||(WK={})),function(t){t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(ZK||(ZK={})),function(t){t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_READ=35045]="STATIC_READ",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.STREAM_COPY=35042]="STREAM_COPY"}(JK||(JK={})),function(t){t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER"}(YK||(YK={})),function(t){t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(KK||(KK={}));const QK=33984;var XK,tQ,eQ;!function(t){t[t.Texture=0]="Texture",t[t.BufferObject=1]="BufferObject",t[t.VertexArrayObject=2]="VertexArrayObject",t[t.Shader=3]="Shader",t[t.Program=4]="Program",t[t.FramebufferObject=5]="FramebufferObject",t[t.Renderbuffer=6]="Renderbuffer",t[t.TransformFeedback=7]="TransformFeedback",t[t.Sync=8]="Sync",t[t.UNCOUNTED=9]="UNCOUNTED",t[t.LinesOfCode=9]="LinesOfCode",t[t.Uniform=10]="Uniform",t[t.COUNT=11]="COUNT"}(XK||(XK={})),function(t){t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(tQ||(tQ={})),function(t){t[t.NONE=0]="NONE",t[t.BACK=1029]="BACK"}(eQ||(eQ={}));const iQ=33306;var nQ,sQ,rQ,oQ,aQ,lQ,uQ;!function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"}(nQ||(nQ={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT=5124]="INT",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(sQ||(sQ={})),function(t){t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS"}(rQ||(rQ={})),function(t){t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED"}(oQ||(oQ={})),function(t){t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED"}(aQ||(aQ={})),function(t){t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(lQ||(lQ={})),function(t){t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(uQ||(uQ={}));const cQ=()=>jt.getLogger("esri.views.webgl.checkWebGLError");function hQ(t,e){switch(e){case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const dQ=!!u("enable-feature:webgl-debug");function fQ(){return dQ}function pQ(){return dQ}function mQ(t){if(fQ()){const e=t.getError();if(e){const i=hQ(t,e),n=(new Error).stack;cQ().error(new Ve("webgl-error","WebGL error occurred",{message:i,stack:n}))}}}var yQ;!function(t){t[t.Texture=0]="Texture",t[t.RenderBuffer=1]="RenderBuffer"}(yQ||(yQ={}));function gQ(t){switch(t){case $K.BYTE:case $K.UNSIGNED_BYTE:return 1;case $K.SHORT:case $K.UNSIGNED_SHORT:case $K.HALF_FLOAT:return 2;case $K.FLOAT:case $K.INT:case $K.UNSIGNED_INT:return 4}}function vQ(t){const e=t.gl;switch(e.getError()){case e.NO_ERROR:return null;case e.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case e.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case e.INVALID_OPERATION:return"The specified command is not allowed for the current state";case e.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case e.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case e.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function wQ(t,e,i,n,s=0){const r=t.gl;t.bindBuffer(i);for(const i of n){const n=e.get(i.name);if(null==n){console.warn(`There is no location for vertex attribute '${i.name}' defined.`);continue}const o=s*i.stride;if(i.count<=4)r.vertexAttribPointer(n,i.count,i.type,i.normalized,i.stride,i.offset+o),r.enableVertexAttribArray(n),i.divisor>0&&t.gl.vertexAttribDivisor(n,i.divisor);else if(9===i.count)for(let e=0;e<3;e++)r.vertexAttribPointer(n+e,3,i.type,i.normalized,i.stride,i.offset+12*e+o),r.enableVertexAttribArray(n+e),i.divisor>0&&t.gl.vertexAttribDivisor(n+e,i.divisor);else if(16===i.count)for(let e=0;e<4;e++)r.vertexAttribPointer(n+e,4,i.type,i.normalized,i.stride,i.offset+16*e+o),r.enableVertexAttribArray(n+e),i.divisor>0&&t.gl?.vertexAttribDivisor(n+e,i.divisor);else console.error("Unsupported vertex attribute element count: "+i.count);if(fQ()){const e=vQ(t),n=gQ(i.type),s=i.offset,r=Math.round(n/s)!==n/s?`. Offset not a multiple of stride. DataType requires ${n} bytes, but descriptor has an offset of ${s}`:"";e&&console.error(`Unable to bind vertex attribute "${i.name}" with baseInstanceOffset ${o}${r}:`,e,i)}}}function bQ(t,e,i,n){const s=t.gl;t.bindBuffer(i);for(const i of n){const n=e.get(i.name);if(i.count<=4)s.disableVertexAttribArray(n),i.divisor&&i.divisor>0&&t.gl?.vertexAttribDivisor(n,0);else if(9===i.count)for(let e=0;e<3;e++)s.disableVertexAttribArray(n+e),i.divisor&&i.divisor>0&&t.gl?.vertexAttribDivisor(n+e,0);else if(16===i.count)for(let e=0;e<4;e++)s.disableVertexAttribArray(n+e),i.divisor&&i.divisor>0&&t.gl?.vertexAttribDivisor(n+e,0);else console.error("Unsupported vertex attribute element count: "+i.count)}t.unbindBuffer(PK.ARRAY_BUFFER)}function SQ(t){switch(t){case qK.ALPHA:case qK.LUMINANCE:case qK.RED:case qK.RED_INTEGER:case HK.R8:case HK.R8I:case HK.R8UI:case HK.R8_SNORM:case ZK.STENCIL_INDEX8:return 1;case qK.LUMINANCE_ALPHA:case qK.RG:case qK.RG_INTEGER:case HK.RGBA4:case HK.R16F:case HK.R16I:case HK.R16UI:case HK.RG8:case HK.RG8I:case HK.RG8UI:case HK.RG8_SNORM:case HK.RGB565:case HK.RGB5_A1:case ZK.DEPTH_COMPONENT16:return 2;case qK.DEPTH_COMPONENT:case qK.RGB:case qK.RGB_INTEGER:case HK.RGB8:case HK.RGB8I:case HK.RGB8UI:case HK.RGB8_SNORM:case HK.SRGB8:case ZK.DEPTH_COMPONENT24:return 3;case qK.DEPTH_STENCIL:case qK.DEPTH24_STENCIL8:case qK.RGBA:case qK.RGBA_INTEGER:case HK.RGBA8:case HK.R32F:case HK.R11F_G11F_B10F:case HK.RG16F:case HK.R32I:case HK.R32UI:case HK.RG16I:case HK.RG16UI:case HK.RGBA8I:case HK.RGBA8UI:case HK.RGBA8_SNORM:case HK.SRGB8_ALPHA8:case HK.RGB9_E5:case HK.RGB10_A2UI:case HK.RGB10_A2:case ZK.DEPTH_STENCIL:case ZK.DEPTH_COMPONENT32F:case ZK.DEPTH24_STENCIL8:return 4;case ZK.DEPTH32F_STENCIL8:return 5;case HK.RGB16F:case HK.RGB16I:case HK.RGB16UI:return 6;case HK.RG32F:case HK.RG32I:case HK.RG32UI:case HK.RGBA16F:case HK.RGBA16I:case HK.RGBA16UI:return 8;case HK.RGB32F:case HK.RGB32I:case HK.RGB32UI:return 12;case HK.RGBA32F:case HK.RGBA32I:case HK.RGBA32UI:return 16;case nQ.COMPRESSED_RGB_S3TC_DXT1_EXT:case nQ.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case nQ.COMPRESSED_RGBA_S3TC_DXT3_EXT:case nQ.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case nQ.COMPRESSED_R11_EAC:case nQ.COMPRESSED_SIGNED_R11_EAC:case nQ.COMPRESSED_RGB8_ETC2:case nQ.COMPRESSED_SRGB8_ETC2:case nQ.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case nQ.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case nQ.COMPRESSED_RG11_EAC:case nQ.COMPRESSED_SIGNED_RG11_EAC:case nQ.COMPRESSED_RGBA8_ETC2_EAC:case nQ.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}class _Q{constructor(t=0,e=t){this.width=t,this.height=e,this.target=VK.TEXTURE_2D,this.pixelFormat=qK.RGBA,this.dataType=WK.UNSIGNED_BYTE,this.samplingMode=BK.LINEAR,this.wrapMode=GK.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.depth=1,this.isImmutable=!1}}function xQ(t){return t.width<=0||t.height<=0?0:Math.round(t.width*t.height*(t.hasMipmap?4/3:1)*(null==t.internalFormat?4:SQ(t.internalFormat)))}class MQ extends _Q{constructor(t,e){switch(super(),this.context=t,Object.assign(this,e),this.internalFormat){case HK.R16F:case HK.R16I:case HK.R16UI:case HK.R32F:case HK.R32I:case HK.R32UI:case HK.R8_SNORM:case HK.R8:case HK.R8I:case HK.R8UI:this.pixelFormat=qK.RED}}static validate(t,e){return new MQ(t,e)}}let TQ=class t{constructor(t,e=null,i=null){if(this.type=yQ.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._wasImmutablyAllocated=!1,"context"in t)this._descriptor=t,i=e;else{const i=MQ.validate(t,e);if(!i)throw new Ve("Texture descriptor invalid");this._descriptor=i}this._descriptor.target===VK.TEXTURE_CUBE_MAP?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return xQ(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}dispose(){this._glName&&this._descriptor.context.instanceCounter.decrement(XK.Texture,this),this._descriptor.context.gl&&this._glName&&(this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(t,e){const i=this._descriptor;if(i.width!==t||i.height!==e){if(this._wasImmutablyAllocated)throw new Ve("Immutable textures can't be resized!");i.width=t,i.height=e,this._descriptor.target===VK.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}_setDataCubeMap(t=null){for(let e=VK.TEXTURE_CUBE_MAP_POSITIVE_X;e<=VK.TEXTURE_CUBE_MAP_NEGATIVE_Z;e++)this._setData(t,e)}setData(t){this._setData(t)}_setData(e,i){const n=this._descriptor.context?.gl;if(!n)return;mQ(n),this._glName||(this._glName=n.createTexture(),this._glName&&this._descriptor.context.instanceCounter.increment(XK.Texture,this));const s=this._descriptor,r=i??s.target,o=NQ(r),a=this._descriptor.context.bindTexture(this,t.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(t.TEXTURE_UNIT_FOR_UPDATES),AQ(s),this._configurePixelStorage(),mQ(n);const l=this._deriveInternalFormat();if(LQ(e)){let t="width"in e?e.width:e.codedWidth,i="height"in e?e.height:e.codedHeight;const a=1;e instanceof HTMLVideoElement&&(t=e.videoWidth,i=e.videoHeight),s.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(r,l,s.hasMipmap,t,i,a),this._texImage(r,0,l,t,i,a,e),mQ(n),s.hasMipmap&&(this.generateMipmap(),mQ(n)),s.width||(s.width=t),s.height||(s.height=i),o&&!s.depth&&(s.depth=a)}else{const{width:t,height:i,depth:a}=s;if(null==t||null==i)throw new Ve("Width and height must be specified!");if(o&&null==a)throw new Ve("Depth must be specified!");if(s.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(r,l,s.hasMipmap,t,i,a),OQ(e)){const o=e.levels,u=PQ(r,t,i,a),c=Math.min(u-1,o.length-1);n.texParameteri(s.target,this._descriptor.context.gl.TEXTURE_MAX_LEVEL,c);const h=l;if(!jQ(h))throw new Ve("Attempting to use compressed data with an uncompressed format!");this._forEachMipmapLevel(((t,e,i,n)=>{const s=o[Math.min(t,o.length-1)];this._compressedTexImage(r,t,h,e,i,n,s)}),c)}else this._texImage(r,0,l,t,i,a,e),mQ(n),s.hasMipmap&&this.generateMipmap()}IQ(n,this._descriptor),kQ(n,this._descriptor),CQ(this._descriptor.context,this._descriptor),mQ(n),this._descriptor.context.bindTexture(a,t.TEXTURE_UNIT_FOR_UPDATES)}updateData(e,i,n,s,r,o,a=0){o||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const l=this._descriptor,u=this._deriveInternalFormat(),{context:c,pixelFormat:h,dataType:d,target:f,isImmutable:p}=l;if(p&&!this._wasImmutablyAllocated)throw new Ve("Cannot update immutable texture before allocation!");const m=c.bindTexture(this,t.TEXTURE_UNIT_FOR_UPDATES,!0);(i<0||n<0||i+s>l.width||n+r>l.height)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:y}=c;a&&y.pixelStorei(y.UNPACK_SKIP_ROWS,a),LQ(o)?y.texSubImage2D(f,e,i,n,s,r,h,d,o):OQ(o)?y.compressedTexSubImage2D(f,e,i,n,s,r,u,o.levels[e]):y.texSubImage2D(f,e,i,n,s,r,h,d,o),a&&y.pixelStorei(y.UNPACK_SKIP_ROWS,0),c.bindTexture(m,t.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,i,n,s,r,o,a,l){l||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const u=this._descriptor,c=this._deriveInternalFormat(),{context:h,pixelFormat:d,dataType:f,isImmutable:p,target:m}=u;if(p&&!this._wasImmutablyAllocated)throw new Ve("Cannot update immutable texture before allocation!");NQ(m)||console.warn("Attempting to set 3D texture data on a non-3D texture");const y=h.bindTexture(this,t.TEXTURE_UNIT_FOR_UPDATES);h.setActiveTexture(t.TEXTURE_UNIT_FOR_UPDATES),(i<0||n<0||s<0||i+r>u.width||n+o>u.height||s+a>u.depth)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:g}=h;if(OQ(l))l=l.levels[e],g.compressedTexSubImage3D(m,e,i,n,s,r,o,a,c,l);else{const t=l;g.texSubImage3D(m,e,i,n,s,r,o,a,d,f,t)}h.bindTexture(y,t.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new Ve("Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,AQ(e)}e.samplingMode===BK.LINEAR?(this._samplingModeDirty=!0,e.samplingMode=BK.LINEAR_MIPMAP_NEAREST):e.samplingMode===BK.NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=BK.NEAREST_MIPMAP_NEAREST);const i=this._descriptor.context.bindTexture(this,t.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(t.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(i,t.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const t=this._descriptor;if(t.hasMipmap){if(this._wasImmutablyAllocated)throw new Ve("Cannot delete mipmaps to immutable texture after allocation");t.hasMipmap=!1,this._samplingModeDirty=!0,AQ(t)}t.samplingMode===BK.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,t.samplingMode=BK.LINEAR):t.samplingMode===BK.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,t.samplingMode=BK.NEAREST)}setSamplingMode(t){t!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=t,this._samplingModeDirty=!0)}setWrapMode(t){t!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=t,AQ(this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const t=this._descriptor,e=t.context.gl;this._samplingModeDirty&&(IQ(e,t),this._samplingModeDirty=!1),this._wrapModeDirty&&(kQ(e,t),this._wrapModeDirty=!1)}_deriveInternalFormat(){if(null!=this._descriptor.internalFormat)return this._descriptor.internalFormat===qK.DEPTH_STENCIL&&(this._descriptor.internalFormat=qK.DEPTH24_STENCIL8),this._descriptor.internalFormat;switch(this._descriptor.dataType){case WK.FLOAT:switch(this._descriptor.pixelFormat){case qK.RGBA:return this._descriptor.internalFormat=HK.RGBA32F;case qK.RGB:return this._descriptor.internalFormat=HK.RGB32F;default:throw new Ve("Unable to derive format")}case WK.UNSIGNED_BYTE:switch(this._descriptor.pixelFormat){case qK.RGBA:return this._descriptor.internalFormat=HK.RGBA8;case qK.RGB:return this._descriptor.internalFormat=HK.RGB8}}return this._descriptor.internalFormat=this._descriptor.pixelFormat===qK.DEPTH_STENCIL?qK.DEPTH24_STENCIL8:this._descriptor.pixelFormat}_configurePixelStorage(){const t=this._descriptor.context.gl,{unpackAlignment:e,flipped:i,preMultiplyAlpha:n}=this._descriptor;t.pixelStorei(t.UNPACK_ALIGNMENT,e),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i?1:0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n?1:0)}_texStorage(t,e,i,n,s,r){const{gl:o}=this._descriptor.context;if(!EQ(e))throw new Ve("Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const a=i?PQ(t,n,s,r):1;if(NQ(t)){if(null==r)throw new Ve("Missing depth dimension for 3D texture upload");o.texStorage3D(t,a,e,n,s,r)}else o.texStorage2D(t,a,e,n,s);this._wasImmutablyAllocated=!0}_texImage(t,e,i,n,s,r,o){const a=this._descriptor.context.gl,l=NQ(t),{isImmutable:u,pixelFormat:c,dataType:h}=this._descriptor;if(u){if(null!=o){const i=o;if(l){if(null==r)throw new Ve("Missing depth dimension for 3D texture upload");a.texSubImage3D(t,e,0,0,0,n,s,r,c,h,i)}else a.texSubImage2D(t,e,0,0,n,s,c,h,i)}}else{const u=o;if(l){if(null==r)throw new Ve("Missing depth dimension for 3D texture upload");a.texImage3D(t,e,i,n,s,r,0,c,h,u)}else a.texImage2D(t,e,i,n,s,0,c,h,u)}}_compressedTexImage(t,e,i,n,s,r,o){const a=this._descriptor.context.gl,l=NQ(t);if(this._descriptor.isImmutable){if(null!=o)if(l){if(null==r)throw new Ve("Missing depth dimension for 3D texture upload");a.compressedTexSubImage3D(t,e,0,0,0,n,s,r,i,o)}else a.compressedTexSubImage2D(t,e,0,0,n,s,i,o)}else if(l){if(null==r)throw new Ve("Missing depth dimension for 3D texture upload");a.compressedTexImage3D(t,e,i,n,s,r,0,o)}else a.compressedTexImage2D(t,e,i,n,s,0,o)}_forEachMipmapLevel(t,e=1/0){let{width:i,height:n,depth:s,hasMipmap:r,target:o}=this._descriptor;const a=o===VK.TEXTURE_3D;if(null==i||null==n||a&&null==s)throw new Ve("Missing texture dimensions for mipmap calculation");for(let o=0;t(o,i,n,s),r&&(1!==i||1!==n||a&&1!==s)&&!(o>=e);++o)i=Math.max(1,i>>1),n=Math.max(1,n>>1),a&&(s=Math.max(1,s>>1))}};function AQ(t){(null!=t.width&&t.width<0||null!=t.height&&t.height<0||null!=t.depth&&t.depth<0)&&console.error("Negative dimension parameters are not allowed!")}function IQ(t,e){let i=e.samplingMode,n=e.samplingMode;i===BK.LINEAR_MIPMAP_NEAREST||i===BK.LINEAR_MIPMAP_LINEAR?(i=BK.LINEAR,e.hasMipmap||(n=BK.LINEAR)):i!==BK.NEAREST_MIPMAP_NEAREST&&i!==BK.NEAREST_MIPMAP_LINEAR||(i=BK.NEAREST,e.hasMipmap||(n=BK.NEAREST)),t.texParameteri(e.target,t.TEXTURE_MAG_FILTER,i),t.texParameteri(e.target,t.TEXTURE_MIN_FILTER,n)}function kQ(t,e){"number"==typeof e.wrapMode?(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode)):(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode.s),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode.t))}function CQ(t,e){const i=t.capabilities.textureFilterAnisotropic;if(!i)return;t.gl.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}function EQ(t){return t in HK}function jQ(t){return t in nQ}function OQ(t){return null!=t&&"type"in t&&"compressed"===t.type}function RQ(t){return null!=t&&"byteLength"in t}function LQ(t){return null!=t&&!OQ(t)&&!RQ(t)}function NQ(t){return t===VK.TEXTURE_3D||t===VK.TEXTURE_2D_ARRAY}function PQ(t,e,i,n=1){let s=Math.max(e,i);return t===VK.TEXTURE_3D&&(s=Math.max(s,n)),Math.round(Math.log(s)/Math.LN2)+1}TQ.TEXTURE_UNIT_FOR_UPDATES=0;const FQ=()=>jt.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function DQ(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const $Q=[0,0,0,0];class zQ{constructor(){this.type="single",this._highlightOptions=new jK,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*bK),this._minMaxDistance=[0,0]}setHighlightOptions(t){this._highlightOptions=t}applyHighlightOptions(t,e){this._updateGradientTexture(t),t.bindTexture(this._shadeTex,PY),e.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<zY)-1,activeGradient:this}]}_updateGradientTexture(t){const{optionsKey:e}=this._highlightOptions;if(e===this._optionsShadeTexKey)return;this._optionsShadeTexKey=e,DQ(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,n=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,s=i.outlinePosition-i.outlineWidth/2,r=i.outlinePosition+i.outlineWidth/2,o=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,a=Math.sqrt(Math.PI/2)*gK,l=Math.abs(n)>a?Math.round(10*(Math.abs(n)-a))/10:0,u=Math.abs(o)>a?Math.round(10*(Math.abs(o)-a))/10:0;let c;l&&!u?FQ().error("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&u?FQ().error("The inner rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&u&&FQ().error("The highlight is "+Math.max(l,u)+"px away from the edge of the feature; consider reducing some width values.");const h=[void 0,void 0,void 0,void 0];function d(t,e,i){h[0]=(1-i)*t[0]+i*e[0],h[1]=(1-i)*t[1]+i*e[1],h[2]=(1-i)*t[2]+i*e[2],h[3]=(1-i)*t[3]+i*e[3]}const{_texelData:f}=this;for(let t=0;t<bK;++t)c=n+t/(bK-1)*(o-n),c<n?(h[0]=0,h[1]=0,h[2]=0,h[3]=0):c<s?d($Q,i.outlineColor,(c-n)/(s-n)):c<r?[h[0],h[1],h[2],h[3]]=i.outlineColor:c<o?d(i.outlineColor,i.fillColor,(c-r)/(o-r)):[h[0],h[1],h[2],h[3]]=i.fillColor,f[4*t]=255*h[0],f[4*t+1]=255*h[1],f[4*t+2]=255*h[2],f[4*t+3]=255*h[3];if(this._minMaxDistance[0]=n,this._minMaxDistance[1]=o,!this._shadeTex){const e=new _Q;e.wrapMode=GK.CLAMP_TO_EDGE,e.width=bK,e.height=1,this._shadeTex=new TQ(t,e)}this._shadeTex.updateData(0,0,0,bK,1,this._texelData)}}class UQ{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(t){for(let e=0;e<t.length;e++)this.gradients[e]||(this.gradients[e]=new zQ),this.gradients[e].setHighlightOptions(t[e].options);for(let e=t.length+1;e<this.gradients.length;e++)this.gradients[e].destroy();this.gradients.length=t.length}destroy(){for(const t of this.gradients)t.destroy()}getReasonsWithGradients(){let t=1;const e=[];for(let i=0;i<this.gradients.length;i++){const n=this.gradients[i];e.push({activeReasons:t,activeGradient:n}),t<<=1}return e}}var BQ,GQ,VQ,qQ,HQ,WQ,ZQ,JQ,YQ;!function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL"}(BQ||(BQ={})),function(t){t[t.NONE=0]="NONE",t[t.MAP=1]="MAP",t[t.LABEL=2]="LABEL",t[t.LABEL_ALPHA=4]="LABEL_ALPHA",t[t.HITTEST=8]="HITTEST",t[t.HIGHLIGHT=16]="HIGHLIGHT",t[t.CLIP=32]="CLIP",t[t.DEBUG=64]="DEBUG",t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(GQ||(GQ={})),function(t){t[t.SIZE=0]="SIZE",t[t.COLOR=1]="COLOR",t[t.OPACITY=2]="OPACITY",t[t.ROTATION=3]="ROTATION"}(VQ||(VQ={})),function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(qQ||(qQ={})),function(t){t[t.SPRITE=0]="SPRITE",t[t.GLYPH=1]="GLYPH"}(HQ||(HQ={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.SIMPLE=1]="SIMPLE",t[t.DOT_DENSITY=2]="DOT_DENSITY",t[t.OUTLINE_FILL=3]="OUTLINE_FILL",t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",t[t.HEATMAP=5]="HEATMAP",t[t.PIE_CHART=6]="PIE_CHART"}(WQ||(WQ={})),function(t){t[t.All=0]="All",t[t.Highlight=1]="Highlight",t[t.InsideEffect=2]="InsideEffect",t[t.OutsideEffect=3]="OutsideEffect"}(ZQ||(ZQ={})),function(t){t[t.BATCHING=0]="BATCHING",t[t.STRICT_ORDER=1]="STRICT_ORDER",t[t.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"}(JQ||(JQ={})),function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT"}(YQ||(YQ={}));const KQ={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:zK.EQUAL,mask:255,op:{fail:UK.KEEP,zFail:UK.KEEP,zPass:UK.REPLACE}}}},QQ={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},XQ={...KQ,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function tX({pixelRatio:t,state:e,displayLevel:i,requiredLevel:n},s){const r=1/2**(i-s.key.level),o=1/2**(n-s.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:r,requiredZoomFactor:o,tileOffset:[s.x,s.y],currentScale:e.scale,currentZoom:i,metersPerSRUnit:Yc(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function eX(t){return"highlight"===t.passOptions?.type}function iX(t){return"hittest"===t.passOptions?.type}function nX(t){if(!iX(t))return null;const{position:e,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:s}=t.passOptions;return{position:e,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:s}}function sX(t){if(!eX(t))return null;const{activeReasons:e,highlightAll:i}=t.passOptions;return{activeReasons:e,highlightAll:i?1:0}}function rX(t,e,i){const n={};for(const s in i)i[s]instanceof Function?n[s]=i[s](t,e):n[s]=i[s];return n}function oX(t,e){const{attributeView:i,context:n}=t;return{storage:i.getUniforms(n),view:tX(t,e),hittestRequest:nX(t),highlight:sX(t)}}function aX(t){return{inside:t.selection===ZQ.InsideEffect,outside:t.selection===ZQ.OutsideEffect}}function lX(t){return iX(t)?QQ:eX(t)&&"clear"===t.passOptions.stepType?XQ:KQ}function uX(t){const{row:e,col:i}=t.key,n=i*vY,s=e*vY;return{tileOffsetFromLocalOrigin:[n%wY,s%wY],maxIntsToLocalOrigin:[Math.floor(n/wY),Math.floor(s/wY)]}}const cX=new Co({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function hX(t){return cX.toJSON(t)}function dX(t){const{bandCount:e,attributeTable:i,colormap:n,pixelType:s}=t.raster.rasterInfo;return 1===e&&(null!=i||null!=n||"u8"===s||"s8"===s)}function fX(t,e){return null==e?(t?.destroy(),null):("single"===t?.type&&Array.isArray(e)&&(t.destroy(),t=null),"multi"!==t?.type||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new UQ:new zQ),Array.isArray(e)?"multi"===t.type&&t.setHighlightOptions(e):"single"===t.type&&t.setHighlightOptions(e),t)}function pX(t,e,i,n){const{painter:s,highlightGradient:r}=t,{highlight:o}=s.effects;if(!r)return;const a=t.passOptions,l=r.getReasonsWithGradients();for(let r=0;r<l.length;r++){const a={...t,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[r].activeGradient,activeReasons:l[r].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(a),i(a),r<l.length-1){let s=0;for(let t=r+1;t<l.length;t++)s|=l[t].activeReasons;i({...t,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[r].activeGradient,activeReasons:s,stepType:"clear",highlightAll:e}})}const u={...t,passOptions:{type:"highlight",activeGradient:null!=n?l[n].activeGradient:l[r].activeGradient,activeReasons:l[r].activeReasons,stepType:"draw",highlightAll:e}};s.setPipelineState(lX(t)),s.updatePipelineState(t.context),o.draw(u),o.unbind()}t.passOptions=a}const mX=t=>parseFloat(t)/100;function yX(t,e,i){const n="string"==typeof t.left?mX(t.left)*e:t.left,s="string"==typeof t.right?mX(t.right)*e:t.right,r="string"==typeof t.top?mX(t.top)*i:t.top,o="string"==typeof t.bottom?mX(t.bottom)*i:t.bottom,a=r;return{xmin:n,xmax:Math.max(e-s,n),ymin:a,ymax:Math.max(i-o,r)}}function gX(t,e,i,n){switch(e.type){case"rect":{const{width:n,height:s}=t,{xmin:r,xmax:o,ymin:a,ymax:l}=yX(e,n,s),{x:u,y:c}=i;return u>r&&u<o&&c>a&&c<l}case"path":return 0===e.path.length||!Array.isArray(e.path[0][0])||ad(e.path,[i.x,i.y]);case"geometry":return null==e.geometry||("polygon"===e.geometry.type?rd(e.geometry,n):Xh(e.geometry,n))}}var vX;let wX=vX=class extends ao{constructor(...t){super(...t),this.name="default",this.options=new jK}clone(){return new vX({name:this.name,options:this.options.clone()})}};r([Je({type:String})],wX.prototype,"name",void 0),r([Je({type:jK})],wX.prototype,"options",void 0),wX=vX=r([ln("esri.views.2d.support.HighlightGroup")],wX);const bX=Vm.ofType(wX);function SX(){return new bX([{name:MK,options:new jK},{name:TK,options:new jK({color:AK})}])}SX().items.map((t=>t.name));function _X(t){if(!t.highlights)return null;const e=t.highlights.findIndex((t=>"default"===t.name));return-1===e?null:t.highlights.items[e].options}function xX(t,e){if(!t.highlights){if(!e)return;t.highlights=new bX([{name:"default",options:new jK}])}const i=t.highlights.findIndex((t=>"default"===t.name));e?t.highlights.items[i].options=e:t.highlights.removeAt(i)}async function MX(t,e,i){const n=Ez(e)?Cz(t,e):e;if(!t.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let s=new Set;const r=new Set;let o=!1,a=null,l=null;i?.include?AX(i.include,TX(t,(t=>{s.add(t),kX(t,(t=>r.add(t)))}),((t,e)=>{r.add(t),s.add(e)}),(t=>{a||(a=new Set),a.add(t)}),(t=>s.add(t)),(()=>o=!0))):(o=!0,s=new Set(t.allLayerViews),s.forEach((t=>{kX(t,(t=>r.add(t)))}))),i?.exclude&&AX(i.exclude,TX(t,(t=>{s.delete(t),kX(t,(t=>r.delete(t)))}),(t=>r.delete(t)),(t=>{l||(l=new Set),l.add(t)})));const u=t.toMap(n),c=t.allLayerViews.filter((e=>!e.suspended&&s.has(e)&&e.clips.every((e=>gX(t,e,n,u))))).reverse();let h=[...o?t.graphicsView.hitTest(u).map((t=>({type:"graphic",graphic:t,layer:null,mapPoint:u}))):[],...await Promise.all(c.map((t=>t.hitTest(u,n))).toArray())].filter(C).flat().filter(C);return h=h.filter((t=>"graphic"!==t.type||"subtype-group"!==t.layer?.type||r.has(t.graphic.layer))),a&&(h=h.filter((t=>!("graphic"in t)||!t.graphic||a?.has(IX(t.graphic))))),l&&(h=h.filter((t=>!("graphic"in t)||!t.graphic||!l?.has(IX(t.graphic))))),{screenPoint:n,results:h}}function TX(t,e,i,n,s,r){return o=>{if(o instanceof OD){if(o.layer===t)r?.();else{const e=t.allLayerViews.find((t=>t.layer===o.layer));e&&s?.(e)}n(IX(o))}else if("layer"in o&&"element"in o);else if("subtype-sublayer"===o.type){const e=t.allLayerViews.find((t=>t.layer===o.parent));e&&i(o,e)}else{const i=t.allLayerViews.find((t=>t.layer===o));i&&e(i)}}}function AX(t,e){if(t)if(bn(t))for(const i of t)if(bn(i))for(const t of i)e(t);else e(i);else e(t)}function IX(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function kX({layer:t},e){"subtype-group"===t?.type&&t.sublayers.forEach((t=>{e(t)}))}let CX=null,EX=!0;function jX(t,e,i){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(EX)try{return new ImageData(t,e)}catch(t){EX=!1}return LX(t,e,i)}function OX(t,e,i,n){if(!e||!i)throw new Error("Cannot construct image data without dimensions");if(EX)try{return new ImageData(t,e,i)}catch(t){EX=!1}const s=LX(e,i,n);return s.data.set(t,0),s}function RX(){return CX||(CX=document.createElement("canvas"),CX.width=1,CX.height=1),CX}function LX(t,e,i){return i||(i=RX()),i.getContext("2d").createImageData(t,e)}async function NX(t,e){const i=window.URL.createObjectURL(t);try{const{data:t}=await Pl(i,{...e,responseType:"image"});return t}catch(t){if(!Es(t))throw new Ve("invalid-image",`Could not fetch requested image at ${i}`);throw t}finally{window.URL.revokeObjectURL(i)}}async function PX(t,e){const{arrayBuffer:i,mediaType:n}=await FX(t,e),s="image/png"===n;if("image/gif"===n){const{isAnimatedGIF:t,parseGif:n}=await import("./p-2175a3cb.js");if(t(i))return n(i,e)}if(s){const{isAnimatedPNG:t,parseApng:n}=await import("./p-e649059e.js");if(t(i))return n(i,e)}return NX(new Blob([i],{type:n}),e)}async function FX(t,e){const i=Da(t);if(i?.isBase64)return{arrayBuffer:Bo(i.data),mediaType:i.mediaType};const n=await Pl(t,{responseType:"array-buffer",...e});return{arrayBuffer:n.data,mediaType:n.getHeader?.("Content-Type")??""}}const DX=2048,$X=1.5,zX=8;function UX(t,e){const{format:i,quality:n,rotation:s,disableDecorations:r}=t||{},o=s0(t,e.padding),a=e0(t,{width:e.width-o.left-o.right,height:e.height-o.top-o.bottom}),{width:l,height:u}=t0(t,a),c=r0(i),h=h0[c];return{format:c,quality:wf(null!=n?n:h,0,100),area:a,width:l,height:u,rotation:s,disableDecorations:!!r,ignoreBackground:!!t?.ignoreBackground,ignorePadding:!!t?.ignorePadding}}function BX(t,e){const i=UX(t,e),n=i.area,s=i.width/n.width,r=s0(i,e.padding),o=r.left+r.right,a=r.top+r.bottom,l=e.width-o,u=e.height-a,c=Math.floor(l*s+o),h=Math.floor(u*s+a),d=t?.layers??[],f=i.ignoreBackground,p=i.ignorePadding;return{framebufferWidth:c,framebufferHeight:h,region:{x:Math.floor(n.x*s)+r.left,y:Math.floor(n.y*s)+r.top,width:i.width,height:i.height},format:i.format,quality:i.quality,rotation:i.rotation,pixelRatio:s,layers:d,disableDecorations:i.disableDecorations,ignoreBackground:f,ignorePadding:p,objectAndLayerIdColor:!1}}function GX(t,e,i){const{ctx:n,canvas:s}=qX(t,i),r=n.getImageData(0,0,t.width,t.height),o=JX(s,e);return HX(s),{dataUrl:o,data:r}}function VX(t,e){const{ctx:i,canvas:n}=qX(t,e),s=i.getImageData(0,0,t.width,t.height);return HX(n),s}function qX(t,e){const i=WX();e.premultipliedAlpha&&a0(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(t,0,0),e.flipY&&o0(n),{ctx:n,canvas:i}}function HX(t){t.width=0,t.height=0}function WX(){return null==ZX&&(ZX=document.createElement("canvas")),ZX}let ZX=null;function JX(t,e){const i=l0[e.format],n=e.quality/100;return t.toDataURL(i,n)}function YX(t,e){const i=r0(t),n=h0[i];return{format:i,quality:wf(null!=e?e:n,0,100)}}function KX(t,e){return e/Math.max(t[0],t[1])}function QX(t,e,i,n=0,s=0,r=t.width-n,o=t.height-s,a=!1){const{data:l}=t,{width:u,height:c,data:h}=e,d=r/u,f=o/c,p=Math.ceil(d/2),m=Math.ceil(f/2),y=t.width;for(let t=0;t<c;t++)for(let e=0;e<u;e++){const r=4*(e+(a?c-t-1:t)*u);let o=0,g=0,v=0,w=0,b=0,S=0;const _=(t+.5)*f;for(let r=Math.floor(t*f);r<(t+1)*f;r++){const t=Math.abs(_-(r+.5))/m,a=(e+.5)*d,u=t*t;for(let t=Math.floor(e*d);t<(e+1)*d;t++){const e=Math.abs(a-(t+.5))/p,c=Math.sqrt(u+e*e);if(c>=1)continue;let h=2*c*c*c-3*c*c+1;const d=4*(n+t+(s+r)*y);S+=h*l[d+3],g+=h,!i&&l[d+3]<255&&(h=h*l[d+3]/255),v+=h*l[d],w+=h*l[d+1],b+=h*l[d+2],o+=h}}h[r]=v/o,h[r+1]=w/o,h[r+2]=b/o,h[r+3]=S/g}return e}function XX(t,e,i){if(!e)return t;const{framebufferWidth:n,framebufferHeight:s,pixelRatio:r,region:o}=t,a=s0(t,i),l=a.left+a.right,u=a.top+a.bottom,c=n-l,h=s-u,d=Math.min(zX,Math.min((DX-l)/c,(DX-u)/h));return d<$X?t:{...t,framebufferWidth:Math.round(c*d)+l,framebufferHeight:Math.round(h*d)+u,pixelRatio:r*d,resample:{region:{x:Math.round((o.x-a.left)*d)+a.left,y:Math.round((o.y-a.top)*d)+a.top,width:Math.round(o.width*d),height:Math.round(o.height*d)},width:n,height:s}}}function t0(t,e){if(!t)return e;const i=t.width,n=t.height;if(null!=i&&null!=n)return{width:Math.floor(i),height:Math.floor(n)};if(null==i&&null==n)return e;const s=e.width/e.height;return null==n?{width:Math.floor(i),height:Math.floor(i/s)}:{width:Math.floor(n*s),height:Math.floor(n)}}function e0(t,e){const i={x:0,y:0,width:e.width,height:e.height};if(t?.area){null!=t.area.x&&(i.x=Math.floor(t.area.x)),null!=t.area.y&&(i.y=Math.floor(t.area.y));const n=null!=t.area.width?Math.floor(t.area.width):null,s=null!=t.area.height?Math.floor(t.area.height):null;if(i.width=e.width-i.x,i.height=e.height-i.y,null!=n&&null!=s)i.width=Math.min(i.width,n),i.height=Math.min(i.height,s);else if(null==n&&null!=s){const t=Math.min(i.width,n);i.height=t/i.width*i.height,i.width=t}else if(null!=n&&null==s){const t=Math.min(i.height,s);i.width=t/i.height*i.width,i.height=t}}return i0(n0(i,t),e)}function i0(t,e){const i=Math.floor(Math.max(t.x,0)),n=Math.floor(Math.max(t.y,0)),s={x:i,y:n,width:Math.floor(Math.min(t.width,e.width-i)),height:Math.floor(Math.min(t.height,e.height-n))},r=s.width/s.height,o=t.width/t.height;if(o===r)return s;if(o>r){const t=Math.floor(s.width/o),e=s.height-t;return{x:s.x,y:Math.floor(s.y+e/2),width:s.width,height:t}}const a=Math.floor(s.height*o),l=s.width-a;return{x:Math.floor(s.x+l/2),y:s.y,width:a,height:s.height}}function n0(t,e){if(null==e?.width||null==e.height)return t;const i=e.width/e.height,n=t.width/t.height;if(n===i)return t;if(n<i){const e=Math.floor(t.height*i);return t.x-=(e-t.width)/2,t.width=e,t}const s=Math.floor(t.width/i);return t.y-=(s-t.height)/2,t.height=s,t}function s0(t,e){return!e||t?.ignorePadding?d0:e}function r0(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return c0}}function o0(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function a0(t){const e=t.data,i=e.length;for(let t=0;t<i;t+=4){const i=e[t+3];if(255!==i&&i>0){const n=255/i;e[t]=e[t]*n,e[t+1]=e[t+1]*n,e[t+2]=e[t+2]*n}}}const l0={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},u0=98,c0="png",h0={png:100,jpg:u0,jpeg:u0},d0={top:0,right:0,bottom:0,left:0};const f0=Object.freeze({__proto__:null,completeUserSettings:UX,encode:GX,encodeData:VX,getFormatAndQuality:YX,getMaximumResolutionScale:KX,resampleHermite:QX,screenshotSuperSampleSettings:XX,toDataUrl:JX,toRenderSettings:BX,createEmptyImageData:jX});const p0={flipY:!0,premultipliedAlpha:!0};async function m0(t,e){const i=await g0(t,e),{format:n,quality:s}=YX(e?.format,e?.quality);return GX(i,{format:n,quality:s},p0)}async function y0(t,e){const i=await g0(t,e);return VX(i,p0)}function g0(t,e){const i=b0(e||{},w0(t.stage,t.size),t.size,t.padding),n=v0(e,t.allLayerViews);return t.stage.takeScreenshot(i,n,t.backgroundColor,e?.rotation)}function v0(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach((t=>{const n=e.find((e=>e.layer.id===t.id));n?.container&&i.push(n.container)})),i}function w0(t,e){return Math.min(4,KX(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function b0(t,e,i,n){t.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let s=null;null!=t.width&&null!=t.height?s=[t.width,t.height]:null==t.width&&null!=t.height?s=[t.height,t.height]:null!=t.width&&null==t.height?s=[t.width,t.width]:null==t.width&&null==t.height&&(s=null);const r=i[0]-(n.left+n.right),o=i[1]-(n.top+n.bottom);let a,l,u=t.area||{x:0,y:0,width:r,height:o};if(s){const t=r/o,e=s[0]/s[1];if(e>t){const t=u.width/e;u={x:u.x,y:Math.round(u.y+(u.height-t)/2),width:u.width,height:Math.round(t)}}else{const t=u.height*e;u={x:Math.round(u.x+(u.width-t)/2),y:u.y,width:Math.round(t),height:u.height}}}else s=[u.width,u.height];return s[0]>u.width?(a=Math.min(s[0]/u.width,e),l=s[0]/u.width/a):(a=1,l=s[0]/u.width),{cropArea:{x:Math.round((u.x+n.left)*a),y:Math.round((u.y+n.top)*a),width:Math.round(u.width*a),height:Math.round(u.height*a)},outputScale:l,resolutionScale:a}}const S0=160;let _0=class extends ao{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),null==this._timer&&(this._timer=setInterval((()=>{performance.now()-this._timestamp>=S0&&this.clear()}),S0))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};r([Je()],_0.prototype,"_timer",void 0),r([Je()],_0.prototype,"stationary",null),_0=r([ln("esri.views.2d.support.StationaryManager")],_0);const x0=t=>t.includes("Brush");class M0{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),x0(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark(`Esri.${t}`))}}let T0;function A0(){return T0||(T0=C0()),T0}class I0{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}}function k0(t){if("undefined"==typeof WebGL2RenderingContext)return null;const e=document.createElement("canvas");if(!e)return null;let i=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(null==i&&(i=e.getContext("webgl2"),null!=i&&(t.majorPerformanceCaveat=!0)),null==i)return i;t.available=!0,t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const n=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return n&&(t.supportsHighPrecisionFragment=n.precision>0),i}function C0(){const t=new I0,e=k0(t);return null==e||(t.supportsColorBufferFloat=null!==e.getExtension("EXT_color_buffer_float"),t.supportsColorBufferFloatBlend=null!==e.getExtension("EXT_float_blend"),t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||null!==e.getExtension("EXT_color_buffer_half_float")),t}function E0(t){const e=A0();return e.available?"3d"===t&&e.majorPerformanceCaveat?new Ve("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new Ve("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new Ve("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new Ve("webgl:required","WebGL2 is required but not supported.",(new Error).stack)}function j0(t){return t&&"nodeType"in t}function O0(t){return t&&"function"==typeof t.render}const R0={component:"esri-component"};let L0=class extends ao{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(t){this._set("id",t)}set node(t){const e=this._get("node");t!==e&&(t&&t.classList.add(R0.component),e&&e.classList.remove(R0.component),this._set("node",t))}castNode(t){return this.widget?.destroy(),t?"string"==typeof t||j0(t)?(this._set("widget",null),wS(t)):(O0(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};r([Je()],L0.prototype,"id",null),r([Je()],L0.prototype,"node",null),r([Ah("node")],L0.prototype,"castNode",null),r([Je({readOnly:!0})],L0.prototype,"widget",void 0),L0=r([ln("esri.views.ui.Component")],L0);const N0=L0;const P0="calcite-mode-";function F0(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function D0(){return F0().startsWith("dark")}function $0(){return`${P0}${D0()?"dark":"light"}`}function z0(t){U0(t),t.classList.add($0())}function U0(t){Array.from(t.classList).forEach((e=>{e.startsWith(P0)&&t.classList.remove(e)}))}const B0={left:0,top:0,bottom:0,right:0},G0={bottom:30,top:15,right:15,left:15},V0="esri-ui",q0={ui:V0,corner:`${V0}-corner`,innerContainer:`${V0}-inner-container`,manualContainer:`${V0}-manual-container`,cornerContainer:`${V0}-corner-container`,topLeft:`${V0}-top-left`,topRight:`${V0}-top-right`,bottomLeft:`${V0}-bottom-left`,bottomRight:`${V0}-bottom-right`};function H0(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function W0(t){return 0===t?"0":`${t}px`}function Z0(t){const e="object"==typeof t&&null!==t&&Object.getPrototypeOf(t);return(null===e||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function J0(t,{top:e,bottom:i,left:n,right:s}){t.style.top=e,t.style.bottom=i,t.style.left=n,t.style.right=s}let Y0=class extends Tm.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=Jy(),this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&J0(t,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&J0(t,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([ey((()=>[this.view?.padding,this.container]),this._applyViewPadding,dy),ey((()=>this.padding),this._applyUIPadding,dy),ey((()=>[this.container,this._locale]),(([t,e])=>{t&&t.setAttribute("lang",e)}),dy),Qy((t=>{this._locale=t}))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._componentMap.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add(q0.ui),z0(t),this._attachContainers(t)),e&&(e.classList.remove(q0.ui),J0(e,{top:"",bottom:"",left:"",right:""}),e.textContent=""),this._set("container",t))}get height(){const t=this.view?.height??0;if(0===t)return t;const e=this._getViewPadding(),{top:i,bottom:n}=e;return Math.max(t-i-n,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...G0,...t}}get width(){const t=this.view?.width??0;if(0===t)return t;const e=this._getViewPadding(),{left:i,right:n}=e;return Math.max(t-i-n,0)}add(t,e){let i,n,s;if(Array.isArray(t))return void t.forEach((t=>this.add(t,e)));const r=Z0(t);r&&({index:i,position:e,component:t,key:n}=r),e&&"object"==typeof e&&({index:i,key:n,position:e,internal:s}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i,n,s)}remove(t,e){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,e)));const i=this._find(t);if(i){if(this._componentMap.has(i)&&this._componentMap.get(i)?.key!==e)return;const t=this._components.indexOf(i),n=i.node.parentNode;return n?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(t,1)[0]}}empty(t,e={removeInternal:!1}){if(Array.isArray(t)){for(const i of t)this.empty(i,e);return}const i=this._positionNameToContainerLookup[t??"manual"],n=Array.prototype.slice.call(i.children).map((t=>this._findByNode(t))).filter((t=>{if(null==t)return!1;return!(this._componentMap.get(t)?.internal??!1)||e.removeInternal}));for(const t of n)this.remove(t)}move(t,e){if(Array.isArray(t)&&t.forEach((t=>this.move(t,e))),!t)return;let i;const n=Z0(t)||Z0(e);if(n&&(i=n.index,e=n.position,t=n.component||t),e&&!this._isValidPosition(e))return;const s=this.remove(t);s&&this.add(s,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getComponents(t,e={includeInternal:!1}){return t?Array.isArray(t)?t.flatMap((t=>this._getComponentsAtPosition(t,e))):this._getComponentsAtPosition(t,e):this._components.filter((t=>e.includeInternal||!this._componentMap.get(t)?.internal)).map((({widget:t,node:e})=>t??e))}getPosition(t){for(const e in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[e].contains(t))return e}return null}_add(t,e,i,n,s){t instanceof N0||(t=new N0({node:t}));const{widget:r}=t;null!=r&&r instanceof ao&&r.addHandles(we((()=>{queueMicrotask((()=>this.remove(t)))})),this._removeWidgetHandleKey),this._place({component:t,position:e,index:i}),this._components.push(t),this._componentMap.set(t,{key:n,internal:s})}_find(t){return t?t instanceof N0?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.view?.padding??B0}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(q0.innerContainer,q0.cornerContainer);const e=document.createElement("div");e.classList.add(q0.innerContainer,q0.manualContainer);const i=document.createElement("div");i.classList.add(q0.topLeft,q0.corner),t.appendChild(i);const n=document.createElement("div");n.classList.add(q0.topRight,q0.corner),t.appendChild(n);const s=document.createElement("div");s.classList.add(q0.bottomLeft,q0.corner),t.appendChild(s);const r=document.createElement("div");r.classList.add(q0.bottomRight,q0.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=e;const o=nx();this._cornerNameToContainerLookup={"top-left":i,"top-right":n,"bottom-left":s,"bottom-right":r,"top-leading":o?n:i,"top-trailing":o?i:n,"bottom-leading":o?r:s,"bottom-trailing":o?s:r},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const e=t.position??"manual",{component:i,index:n}=t,s=this._positionNameToContainerLookup[e],r=null!=n&&n>-1;if(H0(i.widget)&&i.widget.startup(),!r)return void s.appendChild(i.node);const o=Array.from(s.children);if(0===n){const{firstChild:t}=s;return void(t?t.parentNode?.insertBefore(i.node,t):s.appendChild(i.node))}if(n>=o.length)return void s.appendChild(i.node);const a=o[n];a.parentNode?.insertBefore(i.node,a)}_toPixelPosition(t){return{top:W0(t.top),left:W0(t.left),right:W0(t.right),bottom:W0(t.bottom)}}_findByComponent(t){return this._components.find((e=>e===t))??null}_findById(t){return this._components.find((({id:e})=>e===t))??null}_findByNode(t){return this._components.find((({node:e})=>e===t))??null}_getComponentsAtPosition(t,e){const i=this._positionNameToContainerLookup[t];return Array.prototype.slice.call(i.children).map((t=>this._findByNode(t))).filter(C).filter((t=>e.includeInternal||!this._componentMap.get(t)?.internal)).map((({widget:t,node:e})=>t??e))}};r([Je()],Y0.prototype,"_locale",void 0),r([Je()],Y0.prototype,"container",null),r([Je()],Y0.prototype,"height",null),r([Je({value:G0})],Y0.prototype,"padding",null),r([Ah("padding")],Y0.prototype,"castPadding",null),r([Je()],Y0.prototype,"view",void 0),r([Je()],Y0.prototype,"width",null),Y0=r([ln("esri.views.ui.UI")],Y0);const K0=Y0;const Q0="randomUUID"in crypto;function X0(){if(Q0)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=e=>t[e].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function t1(){return`{${X0().toUpperCase()}}`}function e1(){return`{${X0()}}`}const i1={handleInterceptedEvent:(t,e,i,n)=>(t.scheduleRender(),e.properties[`on${n.type}`].apply(e.properties.bind||i,[n]))};const n1={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}},s1=t=>({...n1,...t});const r1=(t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i},o1=(t,e)=>t.find(e),a1=(t,e,i=!1)=>{let n=t;return e.forEach(((t,s)=>{const r=n?.children?o1(n.children,(e=>e.domNode===t)):void 0;i&&!r&&s!==e.length-1||(n=r)})),n},l1=t=>{let e;const i={...i1,...t},n=s1(i),s=n.performanceLogger;let r,o=!0,a=!1;const l=[],u=[],c=(t,r,o)=>{let a;n.eventHandlerInterceptor=(t,n,r,o)=>function(t){let n;s("domEvent",t);const r=r1(t.currentTarget,a.domNode),o=r.some((t=>customElements.get(t?.tagName?.toLowerCase())));if(t.eventPhase===Event.CAPTURING_PHASE||!o)r.reverse(),n=a1(a.getLastRender(),r);else{const e=t.composedPath(),i=e.slice(e.indexOf(t.currentTarget),e.indexOf(a.domNode)).reverse();n=a1(a.getLastRender(),i,!0)}let l;return n&&(l=i.handleInterceptedEvent(e,n,this,t)),s("domEventProcessed",t),l},i.postProcessProjectionOptions?.(n);const c=o();a=t(r,c,n),n.eventHandlerInterceptor=void 0,l.push(a),u.push(o),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(a,c)};let h=()=>{if(r=void 0,o){o=!1,s("renderStart",void 0);for(let t=0;t<l.length;t++){const e=u[t]();s("rendered",void 0);try{l[t].update(e)}catch(t){console.error(t)}s("patched",void 0)}s("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,l,u)),e={renderNow:h,scheduleRender:()=>{r||a||(r=requestAnimationFrame(h))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(t,e)=>{c(zx.append,t,e)},insertBefore:(t,e)=>{c(zx.insertBefore,t,e)},merge:(t,e)=>{c(zx.merge,t,e)},replace:(t,e)=>{c(zx.replace,t,e)},detach:t=>{for(let e=0;e<u.length;e++)if(u[e]===t)return u.splice(e,1),l.splice(e,1)[0];throw new Error("renderFunction was not found")}},e
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.2
 */};const u1="calcite-mode-auto";const c1="calcite-mode-dark";const h1="calcite-mode-light";const d1={autoMode:u1,darkMode:c1,lightMode:h1,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"};const f1={filter:250,nextTick:0,resize:150,reposition:100};let p1;let m1;let y1=false;let g1=false;let v1=false;let w1=false;let b1=false;const S1=t=>{const e=new URL(t,F2.A);return e.origin!==L2.location.origin?e.href:e.pathname};const _1=t=>F2.A=t;const x1=(t,e="")=>{{return()=>{}}};const M1=(t,e)=>{{return()=>{}}};const T1={};const A1=t=>{t=typeof t;return t==="object"||t==="function"};function I1(t){var e,i,n;return(n=(i=(e=t.head)===null||e===void 0?void 0:e.querySelector('meta[name="csp-nonce"]'))===null||i===void 0?void 0:i.getAttribute("content"))!==null&&n!==void 0?n:undefined}const k1=(t,e,...i)=>{let n=null;let s=null;let r=false;let o=false;const a=[];const l=e=>{for(let i=0;i<e.length;i++){n=e[i];if(Array.isArray(n)){l(n)}else if(n!=null&&typeof n!=="boolean"){if(r=typeof t!=="function"&&!A1(n)){n=String(n)}if(r&&o){a[a.length-1].I+=n}else{a.push(r?C1(null,n):n)}o=r}}};l(i);if(e){if(e.name){s=e.name}{const t=e.className||e.class;if(t){e.class=typeof t!=="object"?t:Object.keys(t).filter((e=>t[e])).join(" ")}}}const u=C1(t,null);u.C=e;if(a.length>0){u.R=a}{u.L=s}return u};const C1=(t,e)=>{const i={N:0,U:t,I:e,B:null,R:null};{i.C=null}{i.L=null}return i};const E1={};const j1=t=>t&&t.U===E1;const O1=(t,e)=>{if(t!=null&&!A1(t)){if(e&4){return t==="false"?false:t===""||!!t}if(e&2){return parseFloat(t)}if(e&1){return String(t)}return t}return t};const R1=t=>I2(t).V;const L1=(t,e,i)=>{const n=R1(t);return{emit:t=>N1(n,e,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:t})}};const N1=(t,e,i)=>{const n=F2.ce(e,i);t.dispatchEvent(n);return n};const P1=new WeakMap;const F1=(t,e,i)=>{let n=R2.get(t);if($2&&i){n=n||new CSSStyleSheet;if(typeof n==="string"){n=e}else{n.replaceSync(e)}}else{n=e}R2.set(t,n)};const D1=(t,e,i,n)=>{var s;let r=z1(e);const o=R2.get(r);t=t.nodeType===11?t:N2;if(o){if(typeof o==="string"){t=t.head||t;let e=P1.get(t);let i;if(!e){P1.set(t,e=new Set)}if(!e.has(r)){{{i=N2.createElement("style");i.innerHTML=o}const e=(s=F2.H)!==null&&s!==void 0?s:I1(N2);if(e!=null){i.setAttribute("nonce",e)}t.insertBefore(i,t.querySelector("link"))}if(e){e.add(r)}}}else if(!t.adoptedStyleSheets.includes(o)){t.adoptedStyleSheets=[...t.adoptedStyleSheets,o]}}return r};const $1=t=>{const e=t.J;const i=t.V;const n=x1("attachStyles",e.K);D1(i.getRootNode(),e);n()};const z1=(t,e)=>"sc-"+t.K;const U1=(t,e,i,n,s,r)=>{if(i!==n){let o=C2(t,e);e.toLowerCase();if(e==="class"){const e=t.classList;const s=G1(i);const r=G1(n);e.remove(...s.filter((t=>t&&!r.includes(t))));e.add(...r.filter((t=>t&&!s.includes(t))))}else if(e==="ref"){if(n){n(t)}}else{const a=A1(n);if((o||a&&n!==null)&&!s){try{if(!t.tagName.includes("-")){const s=n==null?"":n;if(e==="list"){o=false}else if(i==null||t[e]!=s){t[e]=s}}else{t[e]=n}}catch(t){}}if(n==null||n===false){if(n!==false||t.getAttribute(e)===""){{t.removeAttribute(e)}}}else if((!o||r&4||s)&&!a){n=n===true?"":n;{t.setAttribute(e,n)}}}}};const B1=/\s/;const G1=t=>!t?[]:t.split(B1);const V1=(t,e,i,n)=>{const s=e.B.nodeType===11&&e.B.host?e.B.host:e.B;const r=t&&t.C||T1;const o=e.C||T1;{for(n in r){if(!(n in o)){U1(s,n,r[n],undefined,i,e.N)}}}for(n in o){U1(s,n,r[n],o[n],i,e.N)}};const q1=(t,e,i,n)=>{const s=e.R[i];let r=0;let o;let a;let l;if(!y1){v1=true;if(s.U==="slot"){s.N|=s.R?2:1}}if(s.I!==null){o=s.B=N2.createTextNode(s.I)}else if(s.N&1){o=s.B=N2.createTextNode("")}else{o=s.B=N2.createElement(s.N&2?"slot-fb":s.U);{V1(null,s,w1)}if(s.R){for(r=0;r<s.R.length;++r){a=q1(t,s,r);if(a){o.appendChild(a)}}}}{o["s-hn"]=m1;if(s.N&(2|1)){o["s-sr"]=true;o["s-cr"]=p1;o["s-sn"]=s.L||"";l=t&&t.R&&t.R[i];if(l&&l.U===s.U&&t.B){H1(t.B,false)}}}return o};const H1=(t,e)=>{F2.N|=1;const i=t.childNodes;for(let t=i.length-1;t>=0;t--){const n=i[t];if(n["s-hn"]!==m1&&n["s-ol"]){Q1(n).insertBefore(n,K1(n));n["s-ol"].remove();n["s-ol"]=undefined;v1=true}if(e){H1(n,e)}}F2.N&=~1};const W1=(t,e,i,n,s,r)=>{let o=t["s-cr"]&&t["s-cr"].parentNode||t;let a;for(;s<=r;++s){if(n[s]){a=q1(null,i,s);if(a){n[s].B=a;o.insertBefore(a,K1(e))}}}};const Z1=(t,e,i,n,s)=>{for(;e<=i;++e){if(n=t[e]){s=n.B;s2(n);{g1=true;if(s["s-ol"]){s["s-ol"].remove()}else{H1(s,true)}}s.remove()}}};const J1=(t,e,i,n)=>{let s=0;let r=0;let o=e.length-1;let a=e[0];let l=e[o];let u=n.length-1;let c=n[0];let h=n[u];let d;while(s<=o&&r<=u){if(a==null){a=e[++s]}else if(l==null){l=e[--o]}else if(c==null){c=n[++r]}else if(h==null){h=n[--u]}else if(Y1(a,c)){X1(a,c);a=e[++s];c=n[++r]}else if(Y1(l,h)){X1(l,h);l=e[--o];h=n[--u]}else if(Y1(a,h)){if(a.U==="slot"||h.U==="slot"){H1(a.B.parentNode,false)}X1(a,h);t.insertBefore(a.B,l.B.nextSibling);a=e[++s];h=n[--u]}else if(Y1(l,c)){if(a.U==="slot"||h.U==="slot"){H1(l.B.parentNode,false)}X1(l,c);t.insertBefore(l.B,a.B);l=e[--o];c=n[++r]}else{{d=q1(e&&e[r],i,r);c=n[++r]}if(d){{Q1(a.B).insertBefore(d,K1(a.B))}}}}if(s>o){W1(t,n[u+1]==null?null:n[u+1].B,i,n,r,u)}else if(r>u){Z1(e,s,o)}};const Y1=(t,e)=>{if(t.U===e.U){if(t.U==="slot"){return t.L===e.L}return true}return false};const K1=t=>t&&t["s-ol"]||t;const Q1=t=>(t["s-ol"]?t["s-ol"]:t).parentNode;const X1=(t,e)=>{const i=e.B=t.B;const n=t.R;const s=e.R;const r=e.U;const o=e.I;let a;if(o===null){{if(r==="slot");else{V1(t,e,w1)}}if(n!==null&&s!==null){J1(i,n,e,s)}else if(s!==null){if(t.I!==null){i.textContent=""}W1(i,null,e,s,0,s.length-1)}else if(n!==null){Z1(n,0,n.length-1)}}else if(a=i["s-cr"]){a.parentNode.textContent=o}else if(t.I!==o){i.data=o}};const t2=t=>{const e=t.childNodes;let i;let n;let s;let r;let o;let a;for(n=0,s=e.length;n<s;n++){i=e[n];if(i.nodeType===1){if(i["s-sr"]){o=i["s-sn"];i.hidden=false;for(r=0;r<s;r++){a=e[r].nodeType;if(e[r]["s-hn"]!==i["s-hn"]||o!==""){if(a===1&&o===e[r].getAttribute("slot")){i.hidden=true;break}}else{if(a===1||a===3&&e[r].textContent.trim()!==""){i.hidden=true;break}}}}t2(i)}}};const e2=[];const i2=t=>{let e;let i;let n;let s;let r;let o;let a=0;const l=t.childNodes;const u=l.length;for(;a<u;a++){e=l[a];if(e["s-sr"]&&(i=e["s-cr"])&&i.parentNode){n=i.parentNode.childNodes;s=e["s-sn"];for(o=n.length-1;o>=0;o--){i=n[o];if(!i["s-cn"]&&!i["s-nr"]&&i["s-hn"]!==e["s-hn"]){if(n2(i,s)){r=e2.find((t=>t.nt===i));g1=true;i["s-sn"]=i["s-sn"]||s;if(r){r.st=e}else{e2.push({st:e,nt:i})}if(i["s-sr"]){e2.map((t=>{if(n2(t.nt,i["s-sn"])){r=e2.find((t=>t.nt===i));if(r&&!t.st){t.st=r.st}}}))}}else if(!e2.some((t=>t.nt===i))){e2.push({nt:i})}}}}if(e.nodeType===1){i2(e)}}};const n2=(t,e)=>{if(t.nodeType===1){if(t.getAttribute("slot")===null&&e===""){return true}if(t.getAttribute("slot")===e){return true}return false}if(t["s-sn"]===e){return true}return e===""};const s2=t=>{{t.C&&t.C.ref&&t.C.ref(null);t.R&&t.R.map(s2)}};const r2=(t,e)=>{const i=t.V;const n=t.J;const s=t.rt||C1(null,null);const r=j1(e)?e:k1(null,null,e);m1=i.tagName;if(n.ot){r.C=r.C||{};n.ot.map((([t,e])=>r.C[e]=i[t]))}r.U=null;r.N|=4;t.rt=r;r.B=s.B=i;{p1=i["s-cr"];y1=(n.N&1)!==0;g1=false}X1(s,r);{F2.N|=1;if(v1){i2(r.B);let t;let e;let i;let n;let s;let o;let a=0;for(;a<e2.length;a++){t=e2[a];e=t.nt;if(!e["s-ol"]){i=N2.createTextNode("");i["s-nr"]=e;e.parentNode.insertBefore(e["s-ol"]=i,e)}}for(a=0;a<e2.length;a++){t=e2[a];e=t.nt;if(t.st){n=t.st.parentNode;s=t.st.nextSibling;i=e["s-ol"];while(i=i.previousSibling){o=i["s-nr"];if(o&&o["s-sn"]===e["s-sn"]&&n===o.parentNode){o=o.nextSibling;if(!o||!o["s-nr"]){s=o;break}}}if(!s&&n!==e.parentNode||e.nextSibling!==s){if(e!==s){if(!e["s-hn"]&&e["s-ol"]){e["s-hn"]=e["s-ol"].parentNode.nodeName}n.insertBefore(e,s)}}}else{if(e.nodeType===1){e.hidden=true}}}}if(g1){t2(r.B)}F2.N&=~1;e2.length=0}};const o2=(t,e)=>{if(e&&!t.ut&&e["s-p"]){e["s-p"].push(new Promise((e=>t.ut=e)))}};const a2=(t,e)=>{{t.N|=16}if(t.N&4){t.N|=512;return}o2(t,t.ct);const i=()=>l2(t,e);return W2(i)};const l2=(t,e)=>{const i=x1("scheduleUpdate",t.J.K);const n=t.ht;let s;if(e){{s=p2(n,"componentWillLoad")}}i();return m2(s,(()=>u2(t,n,e)))};const u2=async(t,e,i)=>{const n=t.V;const s=x1("update",t.J.K);const r=n["s-rc"];if(i){$1(t)}const o=x1("render",t.J.K);{c2(t,e)}if(r){r.map((t=>t()));n["s-rc"]=undefined}o();s();{const e=n["s-p"];const i=()=>h2(t);if(e.length===0){i()}else{Promise.all(e).then(i);t.N|=4;e.length=0}}};const c2=(t,e,i)=>{try{e=e.render();{t.N&=~16}{t.N|=2}{{{r2(t,e)}}}}catch(e){E2(e,t.V)}return null};const h2=t=>{const e=t.J.K;const i=t.V;const n=x1("postUpdate",e);const s=t.ht;const r=t.ct;if(!(t.N&64)){t.N|=64;{y2(i)}{p2(s,"componentDidLoad")}n();{t.ft(i);if(!r){f2()}}}else{n()}{t.yt(i)}{if(t.ut){t.ut();t.ut=undefined}if(t.N&512){q2((()=>a2(t,false)))}t.N&=~(4|512)}};const d2=t=>{{const e=I2(t);const i=e.V.isConnected;if(i&&(e.N&(2|16))===2){a2(e,false)}return i}};const f2=e=>{{y2(N2.documentElement)}q2((()=>N1(L2,"appload",{detail:{namespace:t}})))};const p2=(t,e,i)=>{if(t&&t[e]){try{return t[e](i)}catch(t){E2(t)}}return undefined};const m2=(t,e)=>t&&t.then?t.then(e):e();const y2=t=>t.classList.add("hydrated");const g2=(t,e)=>I2(t).gt.get(e);const v2=(t,e,i,n)=>{const s=I2(t);const r=s.V;const o=s.gt.get(e);const a=s.N;const l=s.ht;i=O1(i,n.vt[e][0]);const u=Number.isNaN(o)&&Number.isNaN(i);const c=i!==o&&!u;if((!(a&8)||o===undefined)&&c){s.gt.set(e,i);if(l){if(n.wt&&a&128){const t=n.wt[e];if(t){t.map((t=>{try{l[t](i,o,e)}catch(t){E2(t,r)}}))}}if((a&(2|16))===2){a2(s,false)}}}};const w2=(t,e,i)=>{if(e.vt){if(t.watchers){e.wt=t.watchers}const n=Object.entries(e.vt);const s=t.prototype;n.map((([t,[n]])=>{if(n&31||i&2&&n&32){Object.defineProperty(s,t,{get(){return g2(this,t)},set(i){v2(this,t,i,e)},configurable:true,enumerable:true})}else if(i&1&&n&64){Object.defineProperty(s,t,{value(...e){const i=I2(this);return i.bt.then((()=>i.ht[t](...e)))}})}}));if(i&1){const i=new Map;s.attributeChangedCallback=function(t,e,n){F2.jmp((()=>{const e=i.get(t);if(this.hasOwnProperty(e)){n=this[e];delete this[e]}else if(s.hasOwnProperty(e)&&typeof this[e]==="number"&&this[e]==n){return}this[e]=n===null&&typeof this[e]==="boolean"?false:n}))};t.observedAttributes=n.filter((([t,e])=>e[0]&15)).map((([t,n])=>{const s=n[1]||t;i.set(s,t);if(n[0]&512){e.ot.push([t,s])}return s}))}}return t};const b2=async(t,e,i,n,s)=>{if((e.N&32)===0){{e.N|=32;s=O2(i);if(s.then){const t=M1();s=await s;t()}if(!s.isProxied){{i.wt=s.watchers}w2(s,i,2);s.isProxied=true}const t=x1("createInstance",i.K);{e.N|=8}try{new s(e)}catch(t){E2(t)}{e.N&=~8}{e.N|=128}t()}if(s.style){let t=s.style;const e=z1(i);if(!R2.has(e)){const n=x1("registerStyles",i.K);F1(e,t,!!(i.N&1));n()}}}const r=e.ct;const o=()=>a2(e,true);if(r&&r["s-rc"]){r["s-rc"].push(o)}else{o()}};const S2=t=>{if((F2.N&1)===0){const e=I2(t);const i=e.J;const n=x1("connectedCallback",i.K);if(!(e.N&1)){e.N|=1;{if(i.N&(4|8)){_2(t)}}{let i=t;while(i=i.parentNode||i.host){if(i["s-p"]){o2(e,e.ct=i);break}}}if(i.vt){Object.entries(i.vt).map((([e,[i]])=>{if(i&31&&t.hasOwnProperty(e)){const i=t[e];delete t[e];t[e]=i}}))}{b2(t,e,i)}}n()}};const _2=t=>{const e=t["s-cr"]=N2.createComment("");e["s-cn"]=true;t.insertBefore(e,t.firstChild)};const x2=t=>{if((F2.N&1)===0){I2(t)}};const M2=(t,e)=>{const i={N:e[0],K:e[1]};{i.vt=e[2]}{i.wt=t.wt}{i.ot=[]}Object.assign(t.prototype,{__registerHost(){k2(this,i)},connectedCallback(){S2(this)},disconnectedCallback(){x2(this)},__attachShadow(){{{this.attachShadow({mode:"open"})}}}});t.is=i.K;return w2(t,i,1|2)};const T2=(t,e)=>e;const A2=new WeakMap;const I2=t=>A2.get(t);const k2=(t,e)=>{const i={N:0,V:t,J:e,gt:new Map};{i.bt=new Promise((t=>i.yt=t))}{i.St=new Promise((t=>i.ft=t));t["s-p"]=[];t["s-rc"]=[]}return A2.set(t,i)};const C2=(t,e)=>e in t;const E2=(t,e)=>(0,console.error)(t,e);const j2=new Map;const O2=(t,e,i)=>{const n=t.K.replace(/-/g,"_");const s=t._t;const r=j2.get(s);if(r){return r[n]}
/*!__STENCIL_STATIC_IMPORT_SWITCH__*/return import(`./${s}.entry.js${""}`).then((t=>{{j2.set(s,t)}return t[n]}),E2)};const R2=new Map;const L2=typeof window!=="undefined"?window:{};const N2=L2.document||{head:{}};const P2=L2.HTMLElement||class{};const F2={N:0,A:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,n)=>t.addEventListener(e,i,n),rel:(t,e,i,n)=>t.removeEventListener(e,i,n),ce:(t,e)=>new CustomEvent(t,e)};const D2=t=>Promise.resolve(t);const $2=(()=>{try{new CSSStyleSheet;return typeof(new CSSStyleSheet).replaceSync==="function"}catch(t){}return false})();const z2=[];const U2=[];const B2=(t,e)=>i=>{t.push(i);if(!b1){b1=true;if(e&&F2.N&4){q2(V2)}else{F2.raf(V2)}}};const G2=t=>{for(let e=0;e<t.length;e++){try{t[e](performance.now())}catch(t){E2(t)}}t.length=0};const V2=()=>{G2(z2);{G2(U2);if(b1=z2.length>0){F2.raf(V2)}}};const q2=t=>D2().then(t);const H2=B2(z2,false);const W2=B2(U2,true);
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.2
 */const Z2=globalThis["calciteConfig"];const J2=Z2?.focusTrapStack||[];const Y2="2.13.2";const K2="2024-10-24";const Q2="e38e2977d";function X2(){if(Z2&&Z2.version){return}console.info(`Using Calcite Components ${Y2} [Date: ${K2}, Revision: ${Q2}]`);const t=Z2||globalThis["calciteConfig"]||{};Object.defineProperty(t,"version",{value:Y2,writable:false});globalThis["calciteConfig"]=t}
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.2
 */const t3=()=>typeof navigator!=="undefined"&&typeof window!=="undefined"&&typeof location!=="undefined"&&typeof document!=="undefined"&&window.location===location&&window.document===document
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.2
 */;function e3(){const{classList:t}=document.body;const e=window.matchMedia("(prefers-color-scheme: dark)").matches;const i=()=>t.contains(c1)||t.contains(u1)&&e?"dark":"light";const n=t=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:true,detail:{mode:t}}));const s=t=>{r!==t&&n(t);r=t};let r=i();n(r);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(t=>s(t.matches?"dark":"light")));new MutationObserver((()=>s(i()))).observe(document.body,{attributes:true,attributeFilter:["class"]})}function i3(){if(t3()){if(document.readyState==="interactive"){e3()}else{document.addEventListener("DOMContentLoaded",(()=>e3()),{once:true})}}X2()}const n3=i3;n3();let s3;function r3(){try{S1(".")}catch{_1(Ia(ru(s3)))}}function o3(t){const e=[];for(const i of Object.keys(t))customElements.get(`calcite-${i}`)||e.push(t[i]?.());return e.length>0?Promise.all(e):null}s3="components/assets";const a3=Symbol("widget"),l3=Symbol("widget-test-data");const u3=[],c3={},h3=new WeakMap;function d3(t,e){let i=e.children;if(i?.length)for(let e=0;e<i.length;++e)i[e]=d3(t,i[e]);else i=u3;const n=e.vnodeSelector;if(y3(n)){const s=e.properties||c3,r=s.key||n,o={key:r,afterCreate:f3,afterUpdate:p3,afterRemoved:m3,parentWidget:t,widgetConstructor:n,widgetProperties:{...s,key:r,children:i}};return{vnodeSelector:n.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function f3(t,e,i,{parentWidget:n,widgetConstructor:s,widgetProperties:r}){const o=new s(r);o.container=t,h3.set(t,o),o.afterCreate?.(o,t),n.addHandles(we((()=>m3(t)))),queueMicrotask((()=>{o[l3].projector.renderNow()}))}function p3(t,e,i,{widgetProperties:n}){const s=h3.get(t);s&&(s.set(n),s.afterUpdate?.(s,t))}function m3(t){const e=h3.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),h3.delete(t))}function y3(t){return"function"==typeof t&&t[a3]}const g3=new Set;function v3(t){g3.add(t),t.finally((()=>g3.delete(t)))}var w3;const b3="esri.widgets.Widget";let S3=0;function _3(t,e){const i=Object.prototype.hasOwnProperty;for(const n in e)i.call(e,n)&&i.call(t,n)&&(null!=t[n]&&null!=e[n]&&"object"==typeof t[n]&&"object"==typeof e[n]?_3(t[n],e[n]):t[n]=e[n]);return t}const x3=l1({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(t,n,s,r)=>{const o=e?.(t,n,s,r),a=i.test(t);if(!((t=t.replace(i,"")).toLowerCase()in s)||a){const e=t[2].toLowerCase()+t.slice(3),i=t=>o?.call(s,t);s.addEventListener(e,i,a);const n=()=>s.removeEventListener(e,i,a),l=r.afterRemoved;r.afterRemoved=t=>{l?.(t),n()}}return o}},handleInterceptedEvent(t,e,i,n){const{eventPhase:s,type:r}=n,o=s===Event.CAPTURING_PHASE;let a=`on${r}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${r[0].toUpperCase()}${r.slice(1)}${o?"Capture":""}`,l&&a in l))&&(K_(),t.scheduleRender(),l[a].call(l.bind||i,n))}});let M3=!1,T3=class extends(jM(Tm.EventedAccessor)){constructor(t,e){super(t,e),this._attached=!1,this._projector=x3,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=$s((async()=>{if(this._messageBundleProps?.length){const t=await Promise.allSettled(this._messageBundleProps.map((async({bundlePath:t,propertyName:e})=>{if(this.destroyed)return;let i=await hv(t);this.uiStrings&&Object.keys(this.uiStrings)&&(i=_3(nt(i),this.uiStrings)),this[e]=i})));if(this.destroyed)return;for(const e of t)"rejected"===e.status&&jt.getLogger(this).error("widget-intl:locale-error",this.declaredClass,e.reason)}await this.loadLocale()})),r3();const i="esri-widget-uid-"+X0(),n=this.render.bind(this);this._trackingTarget=new Ar((()=>{this.autoRenderingEnabled&&this.scheduleRender()}));const s=()=>({vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),r=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const t=n()??s(),e=t.properties??={};if(e.key??=i,y3(t.vnodeSelector)){if(!this.visible)return s()}else this.visible?e.styles||(e.styles={}):(e.class="",e.styles={display:"none"}),e.styles.display??="";let r=0;return t.children?.forEach((t=>{y3(t.vnodeSelector)||(t.properties??={},t.properties.key??=`${this.id}--${r++}`)})),d3(this,t)};this.render=()=>{if(M3)return r();let t=Q_(this)??null;if(t)return t;this._trackingTarget.clear(),M3=!0;try{t=ui(this._trackingTarget,r)}catch(t){throw jt.getLogger(this).error(t),t}finally{M3=!1}return t&&X_(this,t),t};const o=this.beforeFirstRender();o?this._resourcesFetch=o.then((()=>{this._readyForTrueRender=!0,this._postInitialize()})):(this._resourcesFetch=Promise.resolve().then((()=>{this._postInitialize()})),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),v3(this._resourcesFetch)}normalizeCtorArgs(t,e){const i={...t};return e&&(i.container=e),i}postInitialize(){}beforeFirstRender(){const t=this.loadDependencies();return this._messageBundleProps?.length||t?Promise.all([t,this._loadLocale()]).then((()=>{})).catch(As):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(An(this._trackingTarget),An(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,tx(this))}set container(t){this._get("container")||this._set("container",t)}castContainer(t){return wS(t)}get domNode(){return this.container}set domNode(t){this.container=t}get icon(){return null}set icon(t){this._overrideIfSome("icon",t)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+S3++}set id(t){t&&this._set("id",t)}get label(){return this.declaredClass.split(".").pop()}set label(t){this._overrideIfSome("label",t)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(t){this._set("visible",t)}get[(w3=a3,l3)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(tx(this),this._projector.scheduleRender())}own(t){pn(jt.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(t)}classes(...t){return ex.apply(this,t)}renderNow(){tx(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(ey((()=>this.viewModel),((t,e)=>{e&&this.removeHandles("delegated-events"),t&&ms(t)&&this.addHandles(this._delegatedEventNames.map((e=>vs(t,e,(t=>{this.emit(e,t)})))),"delegated-events")}),fy)),this.postInitialize();const t=async()=>{await this._loadLocale().catch(As),this.scheduleRender()};this.addHandles([Qy(t),ey((()=>this.uiStrings),t),iy((()=>this.container),(t=>{this.destroyed||this._attach(t)}),{initial:!0,once:!0})])}_attach(t){t&&(this._projector.merge(t,this.render),this._attached=!0)}_detach(t){this._attached&&(this._projector.detach(this.render),this._attached=!1),t?.parentNode?.removeChild(t)}};T3[w3]=!0,T3.vnodeSelector="div",r([Je()],T3.prototype,"_readyForTrueRender",void 0),r([Je({value:null})],T3.prototype,"container",null),r([Ah("container")],T3.prototype,"castContainer",null),r([Je()],T3.prototype,"icon",null),r([Je()],T3.prototype,"id",null),r([Je()],T3.prototype,"label",null),r([Je()],T3.prototype,"renderable",null),r([Je()],T3.prototype,"uiStrings",void 0),r([Je()],T3.prototype,"viewModel",void 0),r([Je({value:!0})],T3.prototype,"visible",null),r([Je()],T3.prototype,"key",void 0),r([Je()],T3.prototype,"children",void 0),r([Je()],T3.prototype,"afterCreate",void 0),r([Je()],T3.prototype,"afterUpdate",void 0),r([Je()],T3.prototype,"afterRemoved",void 0),T3=r([ln(b3)],T3);const A3=T3;const I3=new Map;function k3(t){return I3.get(t)}function C3(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function E3(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}function j3(t,e,i){if(!i||!e)return;t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e})}function O3(t){return"bing-maps"===t.type}const R3=[];let L3=class extends ao{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Vm,this.view=null,this._allLayerViewsChange=t=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const e=this.view?.allLayerViews;e&&(this.addHandles(e.map((t=>ey((()=>[t.suspended,t.layer?.attributionVisible]),(()=>this._updateAttributionItems())))).toArray(),"suspension"),e.forEach((t=>{"esri.views.3d.layers.Tiles3DLayerView3D"===t.declaredClass&&this.addHandles(t.on("visible-geometry-changed",(()=>this._updateAttributionItems())),"visible-geometry-changed")}))),t?.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t)})),this._updateAttributionItems()},this.addHandles([sy((()=>this.view?.allLayerViews),"change",(t=>this._allLayerViewsChange(t)),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),iy((()=>!0===this.view?.stationary),(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t?.allLayerViews;if(R3.length=0,!t||!e)return void this._clear();e.forEach((e=>{if(e.suspended||!e.layer?.attributionVisible)return;const i=e.layer;if(C3(i,"user"))return void j3(R3,e,i.copyright);if(i.hasAttributionData){if(this._fetchedAttributionData.has(e)){const n=this._fetchedAttributionData.get(e);return void(n?j3(R3,e,this._getDynamicAttribution(n,t,i)):C3(i)&&j3(R3,e,i.copyright))}return void this._fetchAttributionData(e)}const n="portalItem"in i?i.portalItem?.accessInformation:void 0;j3(R3,e,n||i.copyright)}));const i=e.find((t=>"integrated-mesh-3dtiles"===t.layer?.type));if(this.view&&i){const t=k3(this.view);if(t){const e=t.getAttributionText();for(let t=0;t<e.length;++t)j3(R3,i,e[t])}}E3(this.items,R3)&&(this.items.removeAll(),this.items.addMany(R3)),R3.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await Km(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,O3(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,e){const i=t.contributors,n={};if(!i)return n;for(let t=0;t<i.length;t++){const s=i[t],r=s.coverageAreas;if(!r)return;for(const i of r){const r=i.bbox,o=i.zoomMin-(e&&i.zoomMin?1:0),a=i.zoomMax-(e&&i.zoomMax?1:0),l=new Od({xmin:r[1],ymin:r[0],xmax:r[3],ymax:r[2],spatialReference:wh.WGS84}),u={extent:zh(l),attribution:s.attribution||"",score:null!=i.score?i.score:100,id:t};for(let t=o;t<=a;t++)n[t]??=[],n[t].push(u)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(t,e,i){const{extent:n,scale:s}=e;let r=i.tileInfo?.scaleToZoom(s)??0;if(r=Math.min(t.maxKey??0,Math.round(r)),!n||null==r||r<=-1)return"";const o=t[r],a=Fh(n.center.clone().normalize(),wh.WebMercator),l=new Set;return o?o.filter((t=>{const e=t.id,i=!l.has(e)&&a&&t.extent&&Xh(t.extent,a);return i&&l.add(e),i})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};r([Je({readOnly:!0,type:Vm})],L3.prototype,"items",void 0),r([Je({readOnly:!0})],L3.prototype,"state",null),r([Je()],L3.prototype,"view",void 0),L3=r([ln("esri.widgets.Attribution.AttributionViewModel")],L3);const N3=L3;const P3={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};function F3(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:$3(t[e])}}}function D3(t){const e=t?.type;return t instanceof KeyboardEvent||"keyup"===e||"keydown"===e||"keypress"===e}function $3(t){return function(e,...i){D3(e)?cx(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}function z3(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]);e._messageBundleProps.push({bundlePath:t,propertyName:i})}}var U3=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},B3=function(t,e){for(var i=0,n=t.length;i<n;i++){var s=t[i];Array.isArray(s)?B3(s,e):null!=s&&!1!==s&&(s.hasOwnProperty("vnodeSelector")||(s=U3(s)),e.push(s))}},G3=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(1===i.length&&"string"==typeof i[0])return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var s=[];return B3(i,s),{vnodeSelector:t,properties:e||void 0,children:s,text:void 0,domNode:null}};function V3(t,e,...i){return"function"!=typeof t||y3(t)?G3(t,e,...i):t(e,...i)}function q3(...t){return t}const H3="esri-attribution",W3={base:H3,poweredBy:`${H3}__powered-by`,sources:`${H3}__sources`,open:`${H3}--open`,sourcesOpen:`${H3}__sources--open`,link:`${H3}__link`};let Z3=class extends A3{constructor(t,e){super(t,e),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver((t=>t.forEach((({target:t})=>this._checkSourceTextOverflow(t))))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new N3}initialize(){this.addHandles(sy((()=>this.viewModel?.items),"change",(()=>this.scheduleRender())))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((t,e)=>(t.includes(e.text)||t.push(e.text),t)),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t={[W3.open]:this._isOpen};return V3("div",{bind:this,class:this.classes(W3.base,P3.widget,t),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return V3("div",{class:W3.poweredBy},"Powered by"," ",V3("a",{class:W3.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const t=this._isOpen,e=this._isInteractive,i=e?0:void 0,{attributionText:n}=this,s={[W3.sourcesOpen]:t,[P3.interactive]:e};return V3("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(W3.sources,s),innerHTML:n,tabIndex:i})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth,this._resizeObserver.observe(t)}_checkSourceTextOverflow(t){let e=!1;const{clientHeight:i,clientWidth:n,scrollWidth:s}=t,r=s>n,o=this._attributionTextOverflowed!==r;if(this._attributionTextOverflowed=r,o&&(e=!0),this._isOpen){const t=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,t&&(this._isOpen=!1,e=!0)}e&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};r([Je()],Z3.prototype,"_isOpen",void 0),r([Je()],Z3.prototype,"_isInteractive",null),r([Je()],Z3.prototype,"_attributionTextOverflowed",void 0),r([Je()],Z3.prototype,"_prevSourceNodeHeight",void 0),r([Je({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Z3.prototype,"attributionText",null),r([Je()],Z3.prototype,"icon",null),r([Je()],Z3.prototype,"itemDelimiter",void 0),r([Je()],Z3.prototype,"label",null),r([Je(),z3("esri/widgets/Attribution/t9n/Attribution")],Z3.prototype,"messages",void 0),r([Je()],Z3.prototype,"view",null),r([Je({type:N3})],Z3.prototype,"viewModel",void 0),r([F3()],Z3.prototype,"_toggleState",null),Z3=r([ln("esri.widgets.Attribution")],Z3);const J3=Z3;function Y3(){const t=u("mapview-essential-goto-duration");return null==t?t:Bs(t)}function K3(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}const Q3=t=>{let e=class extends t{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:e}=this;return Tn(e),this.goToOverride?this.goToOverride(e,t):e.goTo(t.target,t.options)}};return r([Je()],e.prototype,"goToOverride",void 0),r([Je()],e.prototype,"view",void 0),e=r([ln("esri.widgets.support.GoTo")],e),e};let X3=class extends(Q3(ao)){constructor(t){super(t),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles(ey((()=>this.view),this._updateRotationWatcher,dy))}destroy(){this.view=null}get canShowNorth(){return K3(this.view)}get state(){return!this.view?.ready||"2d"===this.view.type&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&("2d"===this.view?.type?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:Y3()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(t){null!=t&&this._set("orientation",{z:t})}_updateForCamera(t){if(!t)return;const e=-t.heading;this._set("orientation",{x:0,y:0,z:e})}_updateRotationWatcher(t){this.removeAllHandles(),t&&this.addHandles("2d"===t.type?ey((()=>t?.rotation),this._updateForRotation,dy):ey((()=>t?.camera),this._updateForCamera,dy))}};r([Je({readOnly:!0})],X3.prototype,"canShowNorth",null),r([Je({readOnly:!0})],X3.prototype,"orientation",void 0),r([Je({readOnly:!0})],X3.prototype,"state",null),r([Je()],X3.prototype,"view",void 0),X3=r([ln("esri.widgets.Compass.CompassViewModel")],X3);const t5=X3;const e5="esri-compass",i5={base:e5,iconContainer:`${e5}__icon-container`};let n5=class extends A3{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new t5,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=t=>({transform:`rotateZ(${t.z}deg)`})}loadDependencies(){return o3({button:()=>import("./p-5b44be17.js"),icon:()=>import("./p-a8caa0f1.js")})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"rotation"===this.viewModel.state?"arrow-up":"compass-needle"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}reset(){return this.viewModel.reset()}render(){const{orientation:t,state:e}=this.viewModel,{messages:i}=this;return V3("div",{class:this.classes(i5.base,P3.widget)},V3("calcite-button",{class:P3.widgetButton,disabled:"disabled"===e,kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},V3("div",{"aria-hidden":"true",class:i5.iconContainer,title:i.reset},V3("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(t)}))))}};r([Je()],n5.prototype,"goToOverride",null),r([Je()],n5.prototype,"icon",null),r([Je()],n5.prototype,"label",null),r([Je(),z3("esri/widgets/Compass/t9n/Compass")],n5.prototype,"messages",void 0),r([Je()],n5.prototype,"view",null),r([Je({type:t5})],n5.prototype,"viewModel",void 0),n5=r([ln("esri.widgets.Compass")],n5);const s5=n5;const r5="esri-navigation-toggle",o5={base:r5,isLayoutHorizontal:`${r5}--horizontal`};let a5=class extends ao{constructor(t){super(t),this._navigationMode="pan",this.view=null}initialize(){this.addHandles(iy((()=>this.view?.inputManager),(()=>this._setNavigationMode())))}destroy(){this.view=null}get state(){return this.view?.ready&&"3d"===this.view?.type?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(t){this._navigationMode=t,this._setNavigationMode()}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate")}_setNavigationMode(){const t=this.view?.inputManager;t&&(t.primaryDragAction="pan"===this._navigationMode?"pan":"rotate")}};r([Je({readOnly:!0})],a5.prototype,"state",null),r([Je()],a5.prototype,"_navigationMode",void 0),r([Je()],a5.prototype,"view",void 0),a5=r([ln("esri.widgets.NavigationToggle.NavigationToggleViewModel")],a5);const l5=a5;let u5=class extends A3{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new l5,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const t="pan"===this.viewModel?.navigationMode?this._rotateButton:this._panButton;hx(t),this.toggle()}}loadDependencies(){return o3({button:()=>import("./p-5b44be17.js")})}get icon(){return"move"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t="disabled"===this.viewModel?.state,e="pan"===this.viewModel?.navigationMode,i=this.messages.toggle;return V3("div",{class:this.classes(o5.base,P3.widget,{[o5.isLayoutHorizontal]:"horizontal"===this.layout})},V3("calcite-button",{afterCreate:t=>{this._panButton=t},appearance:e?"outline-fill":"solid",class:P3.widgetButton,disabled:t,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:e?void 0:-1,title:i}),V3("calcite-button",{afterCreate:t=>{this._rotateButton=t},appearance:e?"solid":"outline-fill",class:P3.widgetButton,disabled:t,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:e?-1:void 0,title:i}))}};r([Je()],u5.prototype,"icon",null),r([Je()],u5.prototype,"label",null),r([Je({value:"vertical"})],u5.prototype,"layout",null),r([Je(),z3("esri/widgets/NavigationToggle/t9n/NavigationToggle")],u5.prototype,"messages",void 0),r([Je()],u5.prototype,"view",null),r([Je({type:l5})],u5.prototype,"viewModel",void 0),u5=r([ln("esri.widgets.NavigationToggle")],u5);const c5=u5;let h5=class extends ao{get canZoomIn(){const t=this.view?.ready;if(!t)return!1;const e=this.view?.constraints?.effectiveMaxScale;return 0===e||this._scale>e}get canZoomOut(){const{view:t}=this,e=t?.ready;if(!e)return!1;const i=t.constraints?.effectiveMinScale;return 0===i||this._scale<i}get _scale(){const t=this.view?.animation?.target;return(t&&"then"in t?void 0:t?.scale)??this.view?.scale??0}};r([Je({readOnly:!0})],h5.prototype,"canZoomIn",null),r([Je({readOnly:!0})],h5.prototype,"canZoomOut",null),r([Je()],h5.prototype,"view",void 0),r([Je()],h5.prototype,"_scale",null),h5=r([ln("esri.widgets.Zoom.ZoomConditions2D")],h5);const d5=h5;let f5=class extends ao{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};r([Je({readOnly:!0})],f5.prototype,"canZoomIn",null),r([Je({readOnly:!0})],f5.prototype,"canZoomOut",null),r([Je()],f5.prototype,"view",void 0),f5=r([ln("esri.widgets.Zoom.ZoomConditions3D")],f5);const p5=f5;let m5=class extends ao{constructor(t){super(t)}destroy(){this.view=null}get canZoomIn(){return null!=this._zoomConditions&&this._zoomConditions.canZoomIn}get canZoomOut(){return null!=this._zoomConditions&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(t){t?"2d"===t.type?this._zoomConditions=new d5({view:t}):"3d"===t.type&&(this._zoomConditions=new p5({view:t})):this._zoomConditions=null,this._set("view",t)}zoomIn(){if(!this.canZoomIn)return;const t=this.view;"2d"===t.type?t.mapViewNavigation.zoomIn():js(t.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const t=this.view;"2d"===t.type?t.mapViewNavigation.zoomOut():js(t.goTo({zoomFactor:.5}))}};r([Je()],m5.prototype,"_zoomConditions",void 0),r([Je()],m5.prototype,"canZoomIn",null),r([Je()],m5.prototype,"canZoomOut",null),r([Je({readOnly:!0})],m5.prototype,"state",null),r([Je()],m5.prototype,"view",null),m5=r([ln("esri.widgets.Zoom.ZoomViewModel")],m5);const y5=m5;const g5={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let v5=class extends A3{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new y5,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return o3({button:()=>import("./p-5b44be17.js")})}get icon(){return"magnifying-glass-plus"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t)}set view(t){this.viewModel.view=t}get view(){return this.viewModel.view}render(){const t={[g5.horizontalLayout]:"horizontal"===this.layout},{canZoomIn:e,canZoomOut:i}=this.viewModel,{zoomIn:n,zoomOut:s}=this.messages;return V3("div",{class:this.classes(g5.base,P3.widget,t)},V3("calcite-button",{class:P3.widgetButton,disabled:!e,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),V3("calcite-button",{class:P3.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:s,onclick:this.zoomOut,title:s}))}};r([Je()],v5.prototype,"icon",null),r([Je()],v5.prototype,"label",null),r([Je({value:"vertical"})],v5.prototype,"layout",null),r([Je(),z3("esri/widgets/Zoom/t9n/Zoom")],v5.prototype,"messages",void 0),r([Je()],v5.prototype,"view",null),r([Je({type:y5})],v5.prototype,"viewModel",void 0),v5=r([ln("esri.widgets.Zoom")],v5);const w5=v5;function b5(t){return void 0!==t?.view}let S5=class extends K0{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=t=>{this.components.forEach((e=>{const i=this._find(e),n=i?.widget;b5(n)&&(n.view=t)}))},this._componentsWatcher=(t,e)=>{this._removeComponents(e),this._addComponents(t),this._adjustPadding(t)}}initialize(){this.addHandles([ey((()=>this.components),this._componentsWatcher,dy),ey((()=>this.view),this._updateViewAwareWidgets,dy)])}_add(t,e,i,n,s){let r=t;if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;r=this._createComponent(t)}super._add(r,e,i,n,s)}_removeComponents(t){t.forEach((t=>{const e=this._find(t);e&&(this.remove(e),e.destroy())}))}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(t){this.constructed&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])))}_createComponent(t){const e=this._createWidget(t);return new N0({id:t,node:e})}_createWidget(t){const e=this.view;switch(t){case"attribution":return new J3({view:e});case"compass":return new s5({view:e});case"navigation-toggle":return new c5({view:e});case"zoom":return new w5({view:e})}}};r([Je()],S5.prototype,"components",void 0),S5=r([ln("esri.views.ui.DefaultUI")],S5);const _5=S5;let x5=class extends _5{constructor(t){super(t),this.components=["attribution","zoom"]}};r([Je()],x5.prototype,"components",void 0),x5=r([ln("esri.views.ui.2d.DefaultUI2D")],x5);const M5=x5;let T5=class t{constructor(t,e,i=""){this.major=t,this.minor=e,this._context=i}lessThan(t,e){return this.major<t||t===this.major&&this.minor<e}greaterEqual(t,e){return!this.lessThan(t,e)}validate(t){if(this.major!==t.major){const e=this._context&&this._context+":",i=this._context&&this._context+" ";throw new Ve(e+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:t})}}clone(){return new t(this.major,this.minor,this._context)}static parse(e,i=""){const[n,s]=e.split("."),r=/^\s*\d+\s*$/;if(!n?.match||!r.test(n)){throw new Ve((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e})}if(!s?.match||!r.test(s)){throw new Ve((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e})}const o=parseInt(n,10),a=parseInt(s,10);return new t(o,a,i)}};class A5 extends T5{constructor(t,e){super(t,e,"webmap")}}function I5(t){return null!=t&&"object"==typeof t&&"declaredClass"in t&&"esri.WebMap"===t.declaredClass}const k5=new A5(2,32);var C5;let E5=C5=class extends Io{constructor(t){super(t),this.color=new RA([0,0,0,1])}clone(){return new C5(nt({color:this.color}))}};r([Je({type:RA,json:{write:!0}})],E5.prototype,"color",void 0),E5=C5=r([ln("esri.webmap.background.ColorBackground")],E5);const j5=E5;let O5,R5,L5,N5,P5,F5,D5;async function $5(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:n,MagnifierView2D:s,GridView2D:r,Stage:o}]=await Promise.all([import("./p-21b11ac8.js"),import("./p-a17d1b04.js")]);R5=t,L5=e,N5=i,P5=n,F5=s,D5=r,O5=o}let z5=class extends(vS(xM(iM(FU)))){constructor(t){super(t),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new my({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new XH({view:this}),this.graphicsView=null,this.stateManager=new GW({constraints:new gW({view:this})}),this.stationaryManager=new _0,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new QH(this),this.floors=new Vm,this.grid=null,this.highlights=SX(),this.inputManager=new qJ({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new M0,this.type="2d",this.view2dType=null,this.ui=new M5,this.test={takeScreenshot:async t=>y0(this._getScreenshotView(t),t)},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([ey((()=>this.viewpoint),(()=>this.stationaryManager.flip()),hy),this.on("resize",(t=>this.stateManager.resize(t.width,t.height)))]),qv()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=An(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new yY(this.featuresTilingScheme)}get constraintsInfo(){const t=this.defaultsFromMap?.tileInfo,e=this.spatialReference;return{lods:t?.spatialReference?.equals(e)?t.lods:null,spatialReference:e}}get state(){return this.stateManager.state}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:t,constraints:e,center:i,viewpoint:n,extent:s}=this;let r=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&(!s&&(e?.effectiveLODs||(r=-1),(!i||0===t&&-1===r)&&(null==n?.targetGeometry||"extent"!==n.targetGeometry.type&&!n.scale)))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const t=this._getDefaultViewpoint();if(!t)return!1;const e=t.targetGeometry,i=this.spatialReference;return Cb(e.spatialReference,i)}set animation(t){const e=this._get("animation");if(t===e)return;if(e&&e.stop(),t!==this.animationManager.animation&&this.animationManager.stop(),!t||t.isFulfilled())return void this._set("animation",null);this._set("animation",t);const i=()=>{this.destroyed||t===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};t.when(i,i)}get background(){return I5(this.map)?this.map.initialViewProperties.background:null}set background(t){this._override("background",t)}get center(){return this.stateManager?.center??null}set center(t){this.stateManager.center=t}get constraints(){return this.stateManager?.constraints}set constraints(t){t.view=this;const e=this.stateManager.constraints;this.stateManager.constraints=t,e?.destroy()}get extent(){return this.stateManager?.extent??null}set extent(t){this.stateManager.extent=t}get highlightOptions(){return _X(this)}set highlightOptions(t){xX(this,t)}get padding(){return this.stateManager?.padding}set padding(t){this.stateManager&&(this.stateManager.padding=t)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(t){this.stateManager.resizeAlign=t}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(t){const{rotationEnabled:e}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=t,this.constraints.rotationEnabled=e}get scale(){return this.stateManager?.scale??0}set scale(t){this.stateManager&&(this.stateManager.scale=t)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const t=!(!this.magnifier.visible||null===this.magnifier.position||!this._magnifierView?.updatingHandles.updating),e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||!0===this.layerViewManager.updating||!0===this.labelManager.updating||!0===this.graphicsView.updating||this.allLayerViews.some((t=>!t.destroyed&&!("layerViews"in t)&&!0===t.updating))||t);if(u("esri-2d-log-updating")){const i=this.allLayerViews.reduce(((t,e)=>({...t,[`${e.layer.id}(${e.layer.type})`]:!e.destroyed&&!("layerViews"in e)&&e.updating})),{});console.log(`Updating MapView: ${e}\n-> Null LayerViewManager: ${!this.layerViewManager}\n-> Null LabelManager: ${!this.labelManager}\n-> Null GraphicsView: ${!this.graphicsView}\n-> layerViewManager.updating: ${this.layerViewManager?.updating}\n-> labelManager.updating: ${this.labelManager?.updating}\n-> graphicsView.updating: ${this.graphicsView?.updating}\n-> allLayerViews: ${JSON.stringify(i)}\n-> updatingMagnifier: ${t}\n`)}return e}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(t){this.stateManager.viewpoint=t,this.frameTask.requestFrame()}get visibleArea(){const t=this.stateManager.visibleArea;return t?new qp({rings:[t.map((t=>[t[0],t[1]]))],spatialReference:this.spatialReference}):t}get zoom(){return this.stateManager.zoom??-1}set zoom(t){this.stateManager.zoom=t}get navigating(){return this.mapViewNavigation?.interacting??!1}goTo(t,e){return this.goToManager.goTo(t,e)}async hitTest(t,e){return MX(this,t,e)}async takeScreenshot(t){return m0(this._getScreenshotView(t),t)}toMap(t){if(!this.ready)return null;const e=Ez(t)?Cz(this,t):t;return this.stateManager.toMap(e)}toScreen(t,e){return this.stateManager.toScreen(t,e)}on(t,e,i,n){const s=this.inputManager&&this.viewEvents.on(t,e,i,n);return s||super.on(t,e)}hasEventListener(t){return super.hasEventListener(t)||this.viewEvents.hasHandler(t)}whenLayerView(t){return super.whenLayerView(t)}graphicChanged(t){if(this.graphicsView){this.graphicsView.graphicUpdateHandler(t)}}whenReady(){return new Promise((t=>{this.ready?t(this):this._resolveWhenReady.push(t)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return I5(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return I5(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(t){return rW.hasLayerViewModule(t)}importLayerView(t){return rW.importLayerView(t)}pixelSizeAt(){return this.ready?this.resolution:(jt.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(t){const e=this.toMap(t),i=await this.hitTest(t),n=this.allLayerViews.toArray().filter((i=>i.clips.every((i=>gX(this,i,t,e))))).reverse(),s=new globalThis.Map(n.map((t=>[t.layer.uid,t]))),r=[];let o=0,a=0;for(;o<i.results.length||a<n.length;){const t=i.results.at(o);if(t&&"graphic"!==t.type){++o;continue}const l=s.get((t?.layer??t?.graphic.layer)?.uid);if((!t||l)&&a<n.length&&n.at(a)!==l){const t=n.at(a);"fetchPopupFeaturesAtLocation"in t&&r.push({mapPoint:e,layerView:t}),++a}else t&&(r.push({graphic:t.graphic,layerView:l}),++o)}return{hits:r,location:e}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let t=E0(this.type);if(u("safari")&&u("safari")<9&&(t=new Ve("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:u("safari")})),null!=t)throw jt.getLogger(this).warn("#validate()",t.message),t}loadAsyncDependencies(){return $5()}_getDefaultViewpoint(){const{constraints:t,initialExtent:e,map:i,padding:n,size:s}=this;if(!t)return null;const r=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,o=this.stateManager.getUserStartupOptions(this.size),a=r?.viewpoint,l=a?.targetGeometry?.extent??e,u=l?.center,c=a?.rotation??0,h=a?.scale||l&&VG(l,[s[0]-n.left-n.right,s[1]-n.top-n.bottom]),d=o.center??u,f=o.rotation??c,p=o.scale??h;return d&&p?new _m({targetGeometry:d,scale:p,rotation:f}):null}_startup(){this.timeline.begin("MapView Startup");const t=this._getDefaultViewpoint();this.stateManager.startup(t,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const e=new O5(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=e,this._magnifierView=new F5,this._magnifierView.magnifier=this.magnifier,this._gridView=new D5;const i=new N5({view:this});this._set("labelManager",i);const n=new CH({view:this});this._set("animationManager",n);const s=new P5({view:this,animationManager:n});this._set("mapViewNavigation",s),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),e.on("webgl-error",(t=>this.fatalError=t.error)),ey((()=>this.stationary),(t=>e.stationary=t),fy),ey((()=>this.background),(t=>{e.backgroundColor=t?.color,this._magnifierView.backgroundColor=t?.color}),fy),ey((()=>this.magnifier),(t=>this._magnifierView.magnifier=t),fy),ey((()=>this.grid),(t=>this._gridView.grid=t),fy),ey((()=>this.renderingOptions),(t=>e.renderingOptions=t),fy),ey((()=>this.highlights.items.map((t=>({name:t.name,options:{fillColor:t.options.color,haloColor:t.options.haloColor,fillOpacity:t.options.fillOpacity,haloOpacity:t.options.haloOpacity,haloWidth:t.options.haloWidth,haloBlur:t.options.haloBlur}})))),(()=>{e.highlightGradient=fX(e.highlightGradient,this.highlights.items)}),fy),ey((()=>this.state.id),(()=>e.state=this.state),fy)],"map-view"),this._updateStageChildren();const r=this._resolveWhenReady;this._resolveWhenReady=[],r.forEach((t=>t(this))),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach((t=>{this.stage.addChild(t.container)}));const t=this.graphicsView;this.stage.addChild(t.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const t=new EW(fS.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",t);const e=new R5({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new L5(t)});this._set("graphicsView",e)}_destroySpatialReferenceDependentProperties(){const t=this.graphicsView;this._set("graphicsView",null),t.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(t){const{allLayerViews:e,padding:i,size:n,stage:s}=this;return{allLayerViews:e,backgroundColor:t?.ignoreBackground?null:this.background?.color,padding:i,size:n,stage:s}}_spatialReferenceChanged(t){if(this.ready){this.frameTask.stop();for(const t of this.allLayerViews)t.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(t),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const t of this.allLayerViews)t.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};z5.type="2d",r([Je({readOnly:!0})],z5.prototype,"animationManager",void 0),r([Je({constructOnly:!0})],z5.prototype,"deactivatedWebGLExtensions",void 0),r([Je({constructOnly:!0})],z5.prototype,"debugWebGLExtensions",void 0),r([Je({readOnly:!0})],z5.prototype,"featuresTilingScheme",void 0),r([Je({readOnly:!0})],z5.prototype,"fullOpacity",void 0),r([Je()],z5.prototype,"goToManager",void 0),r([Je({readOnly:!0})],z5.prototype,"graphicsTileStore",null),r([Je()],z5.prototype,"graphicsView",void 0),r([Je()],z5.prototype,"stateManager",void 0),r([Je()],z5.prototype,"constraintsInfo",null),r([Je({readOnly:!0})],z5.prototype,"state",null),r([Je()],z5.prototype,"initialExtentRequired",null),r([Je()],z5.prototype,"labelManager",void 0),r([Je({readOnly:!0})],z5.prototype,"mapViewNavigation",void 0),r([Je({constructOnly:!0})],z5.prototype,"renderCanvas",void 0),r([Je()],z5.prototype,"renderingOptions",void 0),r([Je({constructOnly:!0})],z5.prototype,"supersampleScreenshotsEnabled",void 0),r([Je({readOnly:!0})],z5.prototype,"supportsGround",void 0),r([Je()],z5.prototype,"defaultsFromMapSettings",null),r([Je({readOnly:!0})],z5.prototype,"typeSpecificPreconditionsReady",null),r([Je()],z5.prototype,"animation",null),r([Je({type:j5})],z5.prototype,"background",null),r([Je()],z5.prototype,"center",null),r([Je({type:gW})],z5.prototype,"constraints",null),r([Je()],z5.prototype,"extent",null),r([Je()],z5.prototype,"floors",void 0),r([Je()],z5.prototype,"grid",void 0),r([Je({type:jK})],z5.prototype,"highlightOptions",null),r([Je({type:Vm.ofType(wX)})],z5.prototype,"highlights",void 0),r([Je({readOnly:!0})],z5.prototype,"inputManager",void 0),r([Je()],z5.prototype,"map",void 0),r([Je()],z5.prototype,"padding",null),r([Je({readOnly:!0})],z5.prototype,"rendering",null),r([Je()],z5.prototype,"resizeAlign",null),r([Je({readOnly:!0})],z5.prototype,"resolution",null),r([Je()],z5.prototype,"rotation",null),r([Je()],z5.prototype,"scale",null),r([Je({constructOnly:!0})],z5.prototype,"spatialReferenceLocked",void 0),r([Je()],z5.prototype,"stationary",null),r([Je({readOnly:!0})],z5.prototype,"tileInfo",null),r([Je({type:M0,readOnly:!0})],z5.prototype,"timeline",void 0),r([Je({readOnly:!0})],z5.prototype,"type",void 0),r([Je({readOnly:!0})],z5.prototype,"updating",null),r([Je({readOnly:!0})],z5.prototype,"view2dType",void 0),r([Je()],z5.prototype,"viewpoint",null),r([Je({readOnly:!0})],z5.prototype,"visibleArea",null),r([Je()],z5.prototype,"zoom",null),r([Je({readOnly:!0})],z5.prototype,"navigating",null),r([Je(),Ah((t=>t instanceof _5?t:Kt(M5,t)))],z5.prototype,"ui",void 0),z5=r([ln("esri.views.View2D")],z5);const U5=z5;let B5=class extends U5{constructor(t){super(t),this.view2dType="map"}};r([Je({readOnly:!0})],B5.prototype,"view2dType",void 0),B5=r([ln("esri.views.MapView")],B5);const G5=B5;class V5{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(zn),this._values=new Map,this.multipleOriginsSupported=!0}clone(t){const e=new V5,i=this._originStores[$n.DEFAULTS];i&&i.forEach(((t,i)=>{e.set(i,nt(t),$n.DEFAULTS)}));for(let i=$n.SERVICE;i<zn;i++){const n=this._originStores[i];n&&n.forEach(((n,s)=>{t&&t.has(s)||e.set(s,nt(n),i)}))}return e}get(t,e){const i=void 0===e?this._values:this._originStores[e];return i?i.get(t):void 0}keys(t){const e=null==t?this._values:this._originStores[t];return e?[...e.keys()]:[]}set(t,e,i=$n.USER){let n=this._originStores[i];if(n||(n=new Map,this._originStores[i]=n),n.set(t,e),!this._values.has(t)||this._propertyOriginMap.get(t)<=i){const n=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,i),n!==e}return!1}delete(t,e=$n.USER){const i=this._originStores[e];if(!i)return;const n=i.get(t);if(i.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===e){this._values.delete(t);for(let i=e-1;i>=0;i--){const e=this._originStores[i];if(e&&e.has(t)){this._values.set(t,e.get(t)),this._propertyOriginMap.set(t,i);break}}}return n}has(t,e){const i=void 0===e?this._values:this._originStores[e];return!!i&&i.has(t)}revert(t,e){for(;e>0&&!this.has(t,e);)--e;const i=this._originStores[e],n=i?.get(t),s=this._values.get(t);return this._values.set(t,n),this._propertyOriginMap.set(t,e),s!==n}originOf(t){return this._propertyOriginMap.get(t)||$n.DEFAULTS}forEach(t){this._values.forEach(t)}}const q5=t=>{let e=class extends t{constructor(...t){super(...t);const e=Me(this),i=e.store,n=new V5;e.store=n,co(e,i,n)}read(t,e){go(this,t,e)}getAtOrigin(t,e){const i=H5(this),n=Un(e);if("string"==typeof t)return i.get(t,n);const s={};return t.forEach((t=>{s[t]=i.get(t,n)})),s}originOf(t){return Bn(this.originIdOf(t))}originIdOf(t){return H5(this).originOf(t)}revert(t,e){const i=H5(this),n=Un(e),s=Me(this);let r;r="string"==typeof t?"*"===t?i.keys(n):[t]:t,r.forEach((t=>{s.invalidate(t),i.revert(t,n),s.commit(t)}))}};return e=r([ln("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function H5(t){return Me(t).store}let W5=class extends(q5(ao)){};W5=r([ln("esri.core.ReadOnlyMultiOriginJSONSupport")],W5);const Z5=t=>{let e=class extends t{constructor(...t){super(...t)}clear(t,e="user"){return J5(this).delete(t,Un(e))}write(t,e){return xo(this,t=t||{},e),t}setAtOrigin(t,e,i){Me(this).setAtOrigin(t,e,Un(i))}removeOrigin(t){const e=J5(this),i=Un(t),n=e.keys(i);for(const t of n)e.originOf(t)===i&&e.set(t,e.get(t,i),$n.USER)}updateOrigin(t,e){const i=J5(this),n=Un(e),s=Ne(this,t);for(let e=n+1;e<zn;++e)i.delete(t,e);i.set(t,s,n)}toJSON(t){return this.write({},t)}};return e=r([ln("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function J5(t){return Me(t).store}const Y5=t=>{let e=class extends(Z5(q5(t))){constructor(...t){super(...t)}};return e=r([ln("esri.core.MultiOriginJSONSupport")],e),e};let K5=class extends(Y5(ao)){};K5=r([ln("esri.core.MultiOriginJSONSupport")],K5);async function Q5(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return Uh(t);const i=wh.WGS84;return await qb(e,i),Ob(t,i)}function X5(t,e){if(!t4(t,e)){const i=t.typeKeywords;i?i.push(e):t.typeKeywords=[e]}}function t4(t,e){return!!t.typeKeywords?.includes(e)}function e4(t){return t4(t,r4.HOSTED_SERVICE)}function i4(t,e){const i=t.typeKeywords;if(i){const t=i.indexOf(e);t>-1&&i.splice(t,1)}}function n4(t,e,i){i?X5(t,e):i4(t,e)}async function s4(t){const e=t.clone().normalize();let i;if(e.length>1)for(const t of e)i?t.width>i.width&&(i=t):i=t;else i=e[0];return Q5(i)}const r4={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer"};function o4(t){const{portal:e,isOrgItem:i,itemControl:n}=t,s=e.user?.privileges;let r=!s||s.includes("features:user:edit"),o=!!i&&!!s?.includes("features:user:fullEdit");const a="update"===n||"admin"===n;return a?o=r=!0:o&&(r=!0),{features:{edit:r,fullEdit:o},content:{updateItem:a}}}let a4=class extends Io{constructor(t){super(t),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};r([Je({type:String,json:{write:!0}})],a4.prototype,"facilityIdField",void 0),r([Je({type:String,json:{write:!0}})],a4.prototype,"layerId",void 0),r([Je({type:String,json:{write:!0}})],a4.prototype,"nameField",void 0),r([Je({type:String,json:{write:!0}})],a4.prototype,"siteIdField",void 0),r([Je({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a4.prototype,"sublayerId",void 0),a4=r([ln("esri.layers.support.FacilityLayerInfo")],a4);const l4=a4;let u4=class extends Io{constructor(t){super(t),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};r([Je({type:String,json:{write:!0}})],u4.prototype,"facilityIdField",void 0),r([Je({type:String,json:{write:!0}})],u4.prototype,"layerId",void 0),r([Je({type:String,json:{write:!0}})],u4.prototype,"levelIdField",void 0),r([Je({type:String,json:{write:!0}})],u4.prototype,"levelNumberField",void 0),r([Je({type:String,json:{write:!0}})],u4.prototype,"longNameField",void 0),r([Je({type:String,json:{write:!0}})],u4.prototype,"shortNameField",void 0),r([Je({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],u4.prototype,"sublayerId",void 0),r([Je({type:String,json:{write:!0}})],u4.prototype,"verticalOrderField",void 0),u4=r([ln("esri.layers.support.LevelLayerInfo")],u4);const c4=u4;let h4=class extends Io{constructor(t){super(t),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};r([Je({type:String,json:{write:!0}})],h4.prototype,"layerId",void 0),r([Je({type:String,json:{write:!0}})],h4.prototype,"nameField",void 0),r([Je({type:String,json:{write:!0}})],h4.prototype,"siteIdField",void 0),r([Je({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],h4.prototype,"sublayerId",void 0),h4=r([ln("esri.layers.support.SiteLayerInfo")],h4);const d4=h4;let f4=class extends Io{constructor(t){super(t),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};r([Je({type:c4,json:{write:!0}})],f4.prototype,"levelLayer",void 0),r([Je({type:l4,json:{write:!0}})],f4.prototype,"facilityLayer",void 0),r([Je({type:d4,json:{write:!0}})],f4.prototype,"siteLayer",void 0),f4=r([ln("esri.support.MapFloorInfo")],f4);const p4=f4;var m4;!function(t){t[t.SAVE=0]="SAVE",t[t.SAVE_AS=1]="SAVE_AS"}(m4||(m4={}));var y4;let g4=y4=class extends Io{constructor(t){super(t),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new y4(nt({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};r([Je({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],g4.prototype,"activeRange",void 0),r([Je({type:[Number],json:{write:!0}})],g4.prototype,"currentRangeExtent",void 0),r([Je({type:[Number],json:{write:!0}})],g4.prototype,"fullRangeExtent",void 0),g4=y4=r([ln("esri.webdoc.RangeInfo")],g4);const v4=g4;var w4;let b4=w4=class extends Io{constructor(t){super(t),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new w4(nt({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};r([Je({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],b4.prototype,"enabled",void 0),r([Je({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],b4.prototype,"longNames",void 0),r([Je({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],b4.prototype,"minimized",void 0),r([Je({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],b4.prototype,"pinnedLevels",void 0),r([Je({type:String,json:{read:{source:"site"},write:{target:"site"}}})],b4.prototype,"site",void 0),r([Je({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],b4.prototype,"facility",void 0),r([Je({type:String,json:{read:{source:"level"},write:{target:"level"}}})],b4.prototype,"level",void 0),b4=w4=r([ln("esri.webdoc.widgets.FloorFilter")],b4);const S4=b4;var _4;const x4=new Co({slider:"slider",picker:"picker"});let M4=_4=class extends Io{constructor(t){super(t),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new _4({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};r([Je({type:x4.apiValues,nonNullable:!0,json:{type:x4.jsonValues,default:null,read:{reader:x4.read},write:{isRequired:!0,writer:x4.write}}})],M4.prototype,"interactionMode",void 0),r([Je({type:ce,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const t=null!=this.stopInterval;return{enabled:!t,isRequired:!t}}}}})],M4.prototype,"numStops",void 0),r([Je({type:Number,json:{write:{overridePolicy(){return{isRequired:null==this.numStops}}}}})],M4.prototype,"stopInterval",void 0),M4=_4=r([ln("esri.webdoc.widgets.Range")],M4);const T4=M4;const A4=Oo()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let I4=class extends(cm(Io)){constructor(t){super(t),this.unit="milliseconds",this.value=0}toMilliseconds(){return bC(this.value,this.unit,"milliseconds")}};r([NA(A4,{nonNullable:!0})],I4.prototype,"unit",void 0),r([Je({type:Number,json:{write:!0},nonNullable:!0})],I4.prototype,"value",void 0),I4=r([ln("esri.time.TimeInterval")],I4);const k4=I4;var C4;let E4=C4=class extends Io{constructor(t){super(t),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(t){return t?MC.fromArray(t):void 0}writeCurrentTimeExtent(t,e,i){t&&gt(i,t.toArray(),e)}readFullTimeExtent(t,e){const i=e.properties;if(!i)return;const n=null!=i.endTime?new Date(i.endTime):null,s=null!=i.startTime?new Date(i.startTime):null;return new MC({start:s,end:n})}writeFullTimeExtent(t,e){if(!t)return;const i=e.properties=e.properties||{},n=t.end,s=t.start;n&&(i.endTime=null!=n?n.getTime():null),s&&(i.startTime=null!=s?s.getTime():null)}readStopInterval(t,e,i){return t?k4.fromJSON({value:t.interval,unit:t.units},i):null}writeStopInterval(t,e,i,n){if(!t)return;const s=t.toJSON(n);gt("properties.timeStopInterval",{interval:s.value,units:s.unit},e)}readStops(t){return t?.length?t.map((t=>new Date(t))):null}writeStops(t,e,i){t?.length&&gt(i,t.map((t=>t.getTime())),e)}clone(){return new C4(nt({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};r([Je({type:MC,json:{type:[[ce,he]],read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],E4.prototype,"currentTimeExtent",void 0),r([ko("currentTimeExtent")],E4.prototype,"readCurrentTimeExtent",null),r([yh("currentTimeExtent")],E4.prototype,"writeCurrentTimeExtent",null),r([Je({type:MC,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],E4.prototype,"fullTimeExtent",void 0),r([ko("fullTimeExtent")],E4.prototype,"readFullTimeExtent",null),r([yh("fullTimeExtent")],E4.prototype,"writeFullTimeExtent",null),r([Je({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],E4.prototype,"loop",void 0),r([Je({type:ce,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){const t=!!this.stopInterval,e=!!this.stops?.length,i=!(t||e);return{enabled:i,isRequired:i}}}}})],E4.prototype,"numStops",void 0),r([Je({type:[1,2],nonNullable:!0,json:{type:ce,read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],E4.prototype,"numThumbs",void 0),r([Je({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],E4.prototype,"stopDelay",void 0),r([Je({type:k4,json:{read:{source:"properties.timeStopInterval"},write:{target:{"properties.timeStopInterval.interval":{type:Number},"properties.timeStopInterval.units":{type:A4.jsonValues.filter((t=>"esriTimeUnitsUnknown"!==t))}},overridePolicy(){const t=null!=this.numStops,e=!!this.stops?.length;return{enabled:!e,isRequired:!(t||e)}}}}})],E4.prototype,"stopInterval",void 0),r([ko("stopInterval")],E4.prototype,"readStopInterval",null),r([yh("stopInterval")],E4.prototype,"writeStopInterval",null),r([Je({type:[Date],json:{type:[ce],read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],E4.prototype,"stops",void 0),r([ko("stops")],E4.prototype,"readStops",null),r([yh("stops")],E4.prototype,"writeStops",null),E4=C4=r([ln("esri.webdoc.widgets.TimeSlider")],E4);const j4=E4;var O4;let R4=O4=class extends Io{constructor(t){super(t),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new O4(nt({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};r([Je({type:T4,json:{write:!0}})],R4.prototype,"range",void 0),r([Je({type:j4,json:{write:!0}})],R4.prototype,"timeSlider",void 0),r([Je({type:S4,json:{write:!0}})],R4.prototype,"floorFilter",void 0),R4=O4=r([ln("esri.webdoc.Widgets")],R4);const L4=R4;const N4={width:600,height:400},P4=1.5;function F4(t,e){e=e||N4;let{width:i,height:n}=e;const s=i/n;return s<P4?n=i/P4:s>P4&&(i=n*P4),i>t.width&&(n*=t.width/i,i=t.width),n>t.height&&(i*=t.height/n,n=t.height),{width:Math.round(i),height:Math.round(n)}}function D4(t,e){return{...z4(t,e),readResourcePaths:[]}}function $4(t,e,i){const n=ca(t.itemUrl);return{...z4(t,e),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:n?{rootPath:n.path,writtenUrls:[]}:null,resources:i?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function z4(t,e){return{origin:e,url:ca(t.itemUrl),portal:t.portal||uT.getDefault(),portalItem:t}}let U4=class extends Io{constructor(t){super(t),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const t=this.geometries.map((t=>t.toJSON())),e=this.geometries[0],i={};return i.outSR=qu(this.outSpatialReference),i.inSR=qu(e.spatialReference),i.geometries=JSON.stringify({geometryType:om(e),geometries:t}),this.transformation&&(i.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(i.transformForward=this.transformForward),i}};r([Je()],U4.prototype,"geometries",void 0),r([Je({json:{read:{source:"outSR"}}})],U4.prototype,"outSpatialReference",void 0),r([Je()],U4.prototype,"transformation",void 0),r([Je()],U4.prototype,"transformForward",void 0),U4=r([ln("esri.rest.support.ProjectParameters")],U4);const B4=U4;const G4=ee(B4);async function V4(t,e,i){e=G4(e);const n=wG(t),s={...n.query,f:"json",...e.toJSON()},r=e.outSpatialReference,o=om(e.geometries[0]),a=vG(s,i);return Pl(n.path+"/project",a).then((({data:{geometries:t}})=>xG(t,o,r)))}function q4(t,e){return e.resourceInfo?H4(e,e.resourceInfo,{origin:t.origin}):e.portalItem?.id?W4(t,e,e.portalItem):Promise.resolve()}function H4(t,e,i){const n={context:{...i,layerContainerType:"operational-layers"}};return t.portalItem&&(n.context.portal=t.portalItem.portal||uT.getDefault()),import("./p-517201ef.js").then((({populateOperationalLayers:i})=>{const s=[],r=e.operationalLayers;r?.length&&s.push(i(t.layers,r,n));const o={...n,context:{...n.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},a=e.tables;return a?.length&&s.push(i(t.tables,a,o)),Promise.allSettled(s).then((()=>{}))}))}async function W4(t,e,i){if(await i.load().catch((e=>{throw new Ve(`${t.name}:load-portal-item`,"Failed to load portal item",{error:e})})),i.type!==t.itemType)throw new Ve(`${t.name}:invalid-portal-item`,`Invalid portal item type '${i.type}', expected '${t.itemType}'`,{type:i.type});const n=await i.fetchData();e.resourceInfo=n;const s=D4(i,t.origin);await Z4(t,e,n,s),e.resourceReferences={portalItem:i,paths:s.readResourcePaths};const r=await Y4(e.initialViewProperties,i,jt.getLogger(e));if(r){const i=e.initialViewProperties?.clone()??t.createInitialViewProperties();i.viewpoint=r,e.initialViewProperties=i}}function Z4(t,e,i,n){const s=J4(t,i);return e.read(s,n),H4(e,s,n)}function J4(t,e){const i=t.parseVersion(e.version||"",t.name);return t.currentVersion.validate(i),e.version=`${i.major}.${i.minor}`,e}async function Y4(t,e,i){const n=t?.viewpoint?.targetGeometry;if(n)return null;const s=await K4(t,e,i);if(!s)return null;return new _m({targetGeometry:s})}async function K4(t,e,i){const n=t?.spatialReference,s=e?.extent;if(!n||!s)return null;if(n.isWGS84)return s.clone();if(n.isWebMercator)return zh(s);const{getGeometryServiceURL:r}=await import("./p-708584c5.js");try{const t=await r(e),i=new B4({geometries:[s],outSpatialReference:n});return(await V4(t,i))[0]}catch(t){i.error("Error projecting item's extent:",t)}return null}function Q4(t){return{enabled:!!t?.length}}var X4;let t6=X4=class extends Io{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new X4({exactMatch:this.exactMatch,type:this.type,name:this.name})}};r([Je({type:Boolean,json:{write:!0}})],t6.prototype,"exactMatch",void 0),r([Je({type:String,json:{write:!0}})],t6.prototype,"name",void 0),r([NA(a$)],t6.prototype,"type",void 0),t6=X4=r([ln("esri.webdoc.applicationProperties.SearchLayerField")],t6);const e6=t6;var i6;let n6=i6=class extends Io{constructor(t){super(t),this.field=null,this.id=null,this.subLayer=null}clone(){return new i6(nt({field:this.field,id:this.id,subLayer:this.subLayer}))}};r([Je({type:e6,json:{write:{isRequired:!0}}})],n6.prototype,"field",void 0),r([Je({type:String,json:{write:{isRequired:!0}}})],n6.prototype,"id",void 0),r([Je({type:ce,json:{write:!0}})],n6.prototype,"subLayer",void 0),n6=i6=r([ln("esri.webdoc.applicationProperties.SearchLayer")],n6);const s6=n6;var r6;let o6=r6=class extends Io{constructor(t){super(t),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new r6({exactMatch:this.exactMatch,type:this.type,name:this.name})}};r([Je({type:Boolean,json:{write:!0}})],o6.prototype,"exactMatch",void 0),r([Je({type:String,json:{write:!0}})],o6.prototype,"name",void 0),r([NA(a$)],o6.prototype,"type",void 0),o6=r6=r([ln("esri.webdoc.applicationProperties.SearchTableField")],o6);const a6=o6;var l6;let u6=l6=class extends Io{constructor(t){super(t),this.field=null,this.id=null}clone(){return new l6(nt({field:this.field,id:this.id}))}};r([Je({type:a6,json:{write:{isRequired:!0}}})],u6.prototype,"field",void 0),r([Je({type:String,json:{write:{isRequired:!0}}})],u6.prototype,"id",void 0),u6=l6=r([ln("esri.webdoc.applicationProperties.SearchTable")],u6);const c6=u6;var h6;const d6=Vm.ofType(s6),f6=Vm.ofType(c6);let p6=h6=class extends Io{constructor(t){super(t),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new d6,this.tables=new f6}readAddressSearchEnabled(t){return!t}writeAddressSearchEnabled(t,e,i){e[i]=!t}clone(){return new h6(nt({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};r([Je({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],p6.prototype,"addressSearchEnabled",void 0),r([ko("addressSearchEnabled")],p6.prototype,"readAddressSearchEnabled",null),r([yh("addressSearchEnabled")],p6.prototype,"writeAddressSearchEnabled",null),r([Je({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],p6.prototype,"enabled",void 0),r([Je({type:String,json:{write:!0}})],p6.prototype,"hintText",void 0),r([Je({type:d6,json:{write:{overridePolicy:Q4},origins:{"web-scene":{write:{isRequired:!0}}}}})],p6.prototype,"layers",void 0),r([Je({type:f6,json:{read:!0,write:{overridePolicy:Q4}}})],p6.prototype,"tables",void 0),p6=h6=r([ln("esri.webdoc.applicationProperties.Search")],p6);const m6=p6;var y6;let g6=y6=class extends Io{constructor(t){super(t),this.search=null}clone(){return new y6(nt({search:this.search}))}};r([Je({type:m6,json:{write:!0}})],g6.prototype,"search",void 0),g6=y6=r([ln("esri.webdoc.applicationProperties.Viewing")],g6);const v6=g6;var w6;let b6=w6=class extends Io{constructor(t){super(t),this.editing=null,this.offline=null,this.viewing=null}clone(){return new w6(nt({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};r([Je({json:{write:!0}})],b6.prototype,"editing",void 0),r([Je({json:{write:!0}})],b6.prototype,"offline",void 0),r([Je({type:v6,json:{write:!0}})],b6.prototype,"viewing",void 0),b6=w6=r([ln("esri.webmap.ApplicationProperties")],b6);const S6=b6;var _6;let x6=_6=class extends Io{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}get isSecureUrl(){return Ha(this.url)}get isDataURI(){return La(this.url)}clone(){return new _6({url:this.url})}};r([Je({type:String,json:{write:{isRequired:!0}}})],x6.prototype,"url",void 0),r([Je()],x6.prototype,"isSecureUrl",null),r([Je()],x6.prototype,"isDataURI",null),x6=_6=r([ln("esri.webdoc.support.SlideThumbnail")],x6);const M6={type:MC,json:{read:{source:"timeExtent",reader:t=>t?Array.isArray(t)?MC.fromArray(t):MC.fromJSON(t):null},write:{writer:(t,e,i,n)=>{t&&(t.isEmpty?n?.messages&&n.messages.push(new Ve("invalid-timeExtent","TimeExtent cannot be empty")):e[i]=t.toArray())},target:{timeExtent:{type:[[ce,he]]}}}}};var T6;let A6=T6=class extends(dC(Io)){constructor(t){super(t),this.name=null,this.thumbnail=new x6,this.timeExtent=null}castThumbnail(t){return"string"==typeof t?new x6({url:t}):ee(x6,t)}set viewpoint(t){const{targetGeometry:e,scale:i}=t;null!=e&&"point"===e.type&&null==i&&jt.getLogger(this).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",t),this._set("viewpoint",t)}readViewpoint(t,e){const{extent:i,viewpoint:n}=e;return _m.fromJSON(n||{targetGeometry:i})}writeViewpoint(t,e,i,n){if(!t)return;const{targetGeometry:s}=t;if(null==s||"extent"===s.type)null!=s&&(e.extent=s.toJSON()),e[i]=t.toJSON();else{const t="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";n?.messages?n.messages.push(new Ve("property:unsupported",t)):jt.getLogger(this).error(t)}}clone(){return new T6(nt({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};r([Je({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],A6.prototype,"name",void 0),r([Je({type:x6,json:{write:{overridePolicy:t=>({enabled:!(!t||!t.url)})}}})],A6.prototype,"thumbnail",void 0),r([Ah("thumbnail")],A6.prototype,"castThumbnail",null),r([Je(M6)],A6.prototype,"timeExtent",void 0),r([Je({type:_m,nonNullable:!0,json:{write:!0}})],A6.prototype,"viewpoint",null),r([ko("viewpoint",["extent","viewpoint"])],A6.prototype,"readViewpoint",null),r([yh("viewpoint")],A6.prototype,"writeViewpoint",null),A6=T6=r([ln("esri.webmap.Bookmark")],A6);const I6=A6;let k6=class extends(cm(ao)){constructor(t){super(t),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.timeExtent=null,this.timeZone=og,this.viewpoint=null}};r([Je({type:j5})],k6.prototype,"background",void 0),r([Je({type:v4})],k6.prototype,"rangeInfo",void 0),r([Je({type:wh})],k6.prototype,"spatialReference",void 0),r([Je({type:MC})],k6.prototype,"timeExtent",void 0),r([Je({nonNullable:!0})],k6.prototype,"timeZone",void 0),r([Je({type:_m})],k6.prototype,"viewpoint",void 0),k6=r([ln("esri.webmap.InitialViewProperties")],k6);const C6=k6;const E6=Vm.ofType(I6),j6=new Map([["image/jpeg","jpeg"],["image/jpg","jpg"],["image/png","png"],["image/gif","gif"]]),O6="ArcGIS Pro",R6=r4.JSAPI;let L6=class extends(Y5($M.LoadableMixin(jM(NC)))){constructor(t){super(t),this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1,this._thumbnailFilename=null,this._updateFromPromise=null,this.resourceReferences={portalItem:null,paths:[]},this.applicationProperties=null,this.bookmarks=new E6,this.floorInfo=null,this.initialViewProperties=new C6,this.portalItem=null,this.sourceVersion=null,this.widgets=null,this._debouncedSaveOperations=$s((async(t,e,i)=>{const{save:n,saveAs:s}=await import("./p-4bb33509.js");switch(t){case m4.SAVE:return n(this.context,this,e);case m4.SAVE_AS:return s(this.context,this,i,e)}})),this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){this.portalItem=An(this.portalItem)}initialize(){if(this.when().catch((t=>{jt.getLogger(this).error("#load()","Failed to load web map",t)})),this.resourceInfo){let t;try{t=this._validateJSON(this.resourceInfo)}catch(t){return void this.addResolvingPromise(Promise.reject(t))}this.read(t)}}set authoringApp(t){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",t)}writeAuthoringApp(t,e){t&&this._isAuthoringAppSetByUser?e.authoringApp=t:e.authoringApp=R6}set authoringAppVersion(t){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",t)}writeAuthoringAppVersion(t,e){t&&this._isAuthoringAppVersionSetByUser?e.authoringAppVersion=t:e.authoringAppVersion=bl}readInitialViewProperties(t,e){const i=new C6;e.background&&(i.background=j5.fromJSON(e.background));const n=e.initialState?.timeExtent;n&&(i.timeExtent=MC.fromArray(n));const s=e.initialState?.viewpoint;if(s){if(s.rotation){A5.parse(e.version||"","webmap").lessThan(2,20)&&e.authoringApp===O6&&(s.rotation*=-1)}i.viewpoint=_m.fromJSON(s)}return e.mapRangeInfo&&(i.rangeInfo=v4.fromJSON(e.mapRangeInfo)),e.spatialReference&&(i.spatialReference=wh.fromJSON(e.spatialReference)),e.timeZone&&(i.timeZone=e.timeZone),i}writeInitialViewProperties(t,e,i,n){if(!t)return;t.background?.color&&(e.background=t.background.write({},n));const{timeExtent:s,viewpoint:r}=t;if(r||s){const t={};r&&(t.viewpoint=r.write({},n)),s&&(t.timeExtent=s.toArray()),e.initialState=t}t.rangeInfo&&(e.mapRangeInfo=t.rangeInfo.toJSON(n)),t.spatialReference&&(e.spatialReference=t.spatialReference.write({},n)),e.timeZone=t.timeZone}writeLayers(t,e,i,n){e[i]=this._writeLayers(t,n,"operational-layers")}readSourceVersion(t,e){const[i,n]=e.version.split(".");return new A5(parseInt(i,10),parseInt(n,10))}writeSourceVersion(t,e,i){e[i]=`${this.context.currentVersion.major}.${this.context.currentVersion.minor}`}writeTables(t,e,i,n){const s=this._writeLayers(t,n,"tables");s.length&&(e[i]=s)}get thumbnailUrl(){return this.portalItem?.thumbnailUrl||null}set thumbnailUrl(t){t?(this._override("thumbnailUrl",t),this._thumbnailFilename=this._generateCustomThumbnailFilename(t)):this._clearThumbnailOverride()}get updatingFromView(){return!!this._updateFromPromise}load(t){return this.addResolvingPromise(q4(this.context,this)),Promise.resolve(this)}loadAll(){return zM(this,(t=>{t(this.ground,this.basemap,this.layers,this.tables)}))}read(t,e){e={...e,origin:this.context.origin};const i=this._getAuthoringPropsState();vo(this,t,(e=>super.read(t,e)),e),this._restoreAuthoringPropsFromState(i)}write(t,e){if("loaded"!==this.loadStatus){const t=new Ve("webmap:not-loaded","Web map must be loaded before it can be serialized");throw jt.getLogger(this).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),t}return this._removeDanglingLayerRefs(),e={...e,origin:this.context.origin,restrictedWebMapWriting:!0,webmap:this},super.write(t,e)}async save(t){return this._debouncedSaveOperations(m4.SAVE,t)}async saveAs(t,e){return this._debouncedSaveOperations(m4.SAVE_AS,e,t)}async updateFrom(t,e){const i=this._updateFromInternal(t,e);this._updateFromPromise=i,await i;i===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(t){const e=this.resourceInfo;return this._collectAllLayersJSON([...e?.baseMap?.baseMapLayers||[],...e?.operationalLayers||[],...this.basemap?.resourceInfo?.data?.baseMapLayers||[]]).find((e=>e.id===t.id))}async updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await(this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename})),this._clearThumbnailOverride())}getThumbnailState(){let t=this.thumbnailUrl;return t&&(t=this._isOverridden("thumbnailUrl")?t:hl(t,"w","8192")),{thumbnailUrl:t,filename:this._thumbnailFilename}}restoreThumbnailFromState(t){this.thumbnailUrl=t.thumbnailUrl,this._thumbnailFilename=t.filename}_collectAllLayersJSON(t){return t.reduce(((t,e)=>(t.push(e),"GroupLayer"===e.layerType&&(t=t.concat(this._collectAllLayersJSON(e.layers||[]))),t)),[])}_writeLayers(t,e,i){e={...e,layerContainerType:i};return t.map((t=>pA(t,"tables"===i?null:this.getLayerJSONFromResourceInfo(t),e))).filter(C).toArray()}_validateJSON(t){const e=A5.parse(t.version||"","webmap");return this.context.currentVersion.validate(e),t.version=`${e.major}.${e.minor}`,t}_removeDanglingLayerRefs(){const t=this.applicationProperties,e=t?.viewing?.search,i=t=>this.allLayers.some((e=>e.id===t));if(e?.layers&&(e.layers=e.layers.filter((t=>i(t.id)))),e?.tables&&(e.tables=e.tables.filter((t=>this.tables.some((e=>e.id===t.id))))),t){const e=t.editing?.locationTracking;e?.info&&!i(e.info.layerId)&&(t.editing=null)}const n="presentation"in this?this.presentation:null,s=n?.slides;s&&s.forEach((t=>{t.visibleLayers&&(t.visibleLayers=t.visibleLayers.filter((t=>i(t.id))))}))}async _updateFromInternal(t,e){if(e??={},await oy((()=>t.ready)),this._updateInitialViewProperties(t,e),t.map===this)for(const e of t.allLayerViews)"visible"in e&&"visible"in e.layer&&e._isOverridden("visible")&&(e.layer.visible=e.visible),"featureEffect"in e&&"featureEffect"in e.layer&&e._isOverridden("featureEffect")&&(e.layer.featureEffect=e.featureEffect);await this._updateThumbnailUrl(t,e)}_updateInitialViewProperties(t,e){if(e.backgroundExcluded||(this.initialViewProperties.background=t.background?.clone()),this.initialViewProperties.spatialReference=t.spatialReference?.clone(),this.initialViewProperties.timeZone=t.timeZone,e.viewpointExcluded||(this.initialViewProperties.viewpoint=new _m({rotation:t.rotation,scale:e.scalePreserved?t.scale:null,targetGeometry:this._getViewExtent(t)})),!e.widgetsExcluded)for(const e of t.persistableViewModels)e.updateWebDocument(this)}_getViewExtent(t){const e=t.center.clone().normalize(),i=t.extent.clone(),n=i.width/2;return i.xmin=e.x-n,i.xmax=e.x+n,i}async _updateThumbnailUrl(t,e){if(e.thumbnailExcluded)return;const i=F4(t,e.thumbnailSize),n=await t.takeScreenshot({format:"png",width:i.width,height:i.height});this._setAutoGeneratedThumbnail(n.dataUrl)}_setAutoGeneratedThumbnail(t){this.thumbnailUrl=t,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(t){if(La(t)){const e=Da(t),i=e?.mediaType,n=i&&j6.get(i.toLowerCase())||null,s=`thumbnail${Date.now()}`;return n?`${s}.${n}`:s}return null}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(t){t.isAuthoringAppSetByUser?this.authoringApp=t.authoringApp:this._isAuthoringAppSetByUser=!1,t.isAuthoringAppVersionSetByUser?this.authoringAppVersion=t.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}};r([Je()],L6.prototype,"_updateFromPromise",void 0),r([Je({type:S6,json:{write:!0}})],L6.prototype,"applicationProperties",void 0),r([Je({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],L6.prototype,"authoringApp",null),r([yh("authoringApp")],L6.prototype,"writeAuthoringApp",null),r([Je({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],L6.prototype,"authoringAppVersion",null),r([yh("authoringAppVersion")],L6.prototype,"writeAuthoringAppVersion",null),r([Je({type:E6,json:{write:{overridePolicy:t=>({enabled:!!(t&&t.length>0),ignoreOrigin:!0})}}})],L6.prototype,"bookmarks",void 0),r([Je({type:p4,json:{name:"mapFloorInfo",write:!0}})],L6.prototype,"floorInfo",void 0),r([Je({type:C6,nonNullable:!0,json:{read:{source:["background","initialState.timeExtent","initialState.viewpoint","mapRangeInfo","spatialReference","timeZone"]},write:{ignoreOrigin:!0,target:{background:{type:j5},"initialState.timeExtent":{type:MC},"initialState.viewpoint":{type:_m},mapRangeInfo:{type:v4},spatialReference:{type:wh},"timeZone:":{type:String}}}}})],L6.prototype,"initialViewProperties",void 0),r([ko("initialViewProperties")],L6.prototype,"readInitialViewProperties",null),r([yh("initialViewProperties")],L6.prototype,"writeInitialViewProperties",null),r([Je({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],L6.prototype,"layers",void 0),r([yh("layers")],L6.prototype,"writeLayers",null),r([Je({type:NT})],L6.prototype,"portalItem",void 0),r([Je()],L6.prototype,"resourceInfo",void 0),r([Je({readOnly:!0,type:A5,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],L6.prototype,"sourceVersion",void 0),r([ko("sourceVersion")],L6.prototype,"readSourceVersion",null),r([yh("sourceVersion")],L6.prototype,"writeSourceVersion",null),r([Je({json:{read:!1,write:{ignoreOrigin:!0}}})],L6.prototype,"tables",void 0),r([yh("tables")],L6.prototype,"writeTables",null),r([Je()],L6.prototype,"thumbnailUrl",null),r([Je()],L6.prototype,"updatingFromView",null),r([Je({type:L4,json:{write:!0}})],L6.prototype,"widgets",void 0),L6=r([ln("esri.WebDocument2D")],L6);const N6=L6;var P6;let F6=P6=class extends Io{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new P6({minValue:this.minValue,maxValue:this.maxValue})}};r([Je({type:Number,json:{write:!0}})],F6.prototype,"minValue",void 0),r([Je({type:Number,json:{write:!0}})],F6.prototype,"maxValue",void 0),F6=P6=r([ln("esri.renderers.support.AuthoringInfoClassBreakInfo")],F6);var D6;let $6=D6=class extends Io{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new D6({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:nt(this.classBreakInfos)})}};r([Je({type:String,json:{write:!0}})],$6.prototype,"field",void 0),r([Je({type:String,json:{write:!0}})],$6.prototype,"normalizationField",void 0),r([Je({type:String,json:{write:!0}})],$6.prototype,"label",void 0),r([Je({type:[F6],json:{write:!0}})],$6.prototype,"classBreakInfos",void 0),$6=D6=r([ln("esri.renderers.support.AuthoringInfoFieldInfo")],$6);var z6;let U6=z6=class extends Io{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new z6({label:this.label,value:this.value,size:this.size})}};r([Je({type:String,json:{write:!0}})],U6.prototype,"label",void 0),r([Je({type:Number,json:{write:!0}})],U6.prototype,"size",void 0),r([Je({type:Number,json:{write:!0}})],U6.prototype,"value",void 0),U6=z6=r([ln("esri.renderers.support.AuthoringInfoSizeStop")],U6);const B6=U6;var G6;const V6=new Co({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),q6=new Co({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),H6={key:t=>"number"==typeof t?"number":"string",typeMap:{number:Number,string:String},base:null},W6=["high-to-low","above-and-below","centered-on","extremes"],Z6=[...new Set([...["high-to-low","above-and-below","centered-on","extremes","above","below"],...["high-to-low","above-and-below","above","below","reference-size"]])],J6=["seconds","minutes","hours","days","months","years"],Y6=["circle","diamond","hexagon-flat","hexagon-pointy","square"];let K6=G6=class extends Io{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return"string"==typeof t||"number"==typeof t?t:null}get normalizationField(){return"reference-size"===this.theme?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return"reference-size"===this.theme?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return"reference-size"===this.theme?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}castStartTime(t){return"string"==typeof t||"number"==typeof t?t:null}get sizeStops(){return"reference-size"===this.theme?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return"color"===this.type?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new G6({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,sizeStops:nt(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};r([Je({types:H6,json:{write:!0}})],K6.prototype,"endTime",void 0),r([Ah("endTime")],K6.prototype,"castEndTime",null),r([Je({type:String,json:{write:!0}})],K6.prototype,"field",void 0),r([Je({type:Number,json:{write:!0}})],K6.prototype,"maxSliderValue",void 0),r([Je({type:Number,json:{write:!0}})],K6.prototype,"minSliderValue",void 0),r([Je({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],K6.prototype,"normalizationField",null),r([Je({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],K6.prototype,"referenceSizeScale",null),r([Je({type:Y6,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],K6.prototype,"referenceSizeSymbolStyle",null),r([Je({types:H6,json:{write:!0}})],K6.prototype,"startTime",void 0),r([Ah("startTime")],K6.prototype,"castStartTime",null),r([Je({type:[B6],json:{origins:{"web-scene":{write:!1}},write:!0}})],K6.prototype,"sizeStops",null),r([Je({type:V6.apiValues,value:null,json:{type:V6.jsonValues,read:V6.read,write:V6.write}})],K6.prototype,"style",null),r([Je({type:Z6,value:null,json:{type:Z6,origins:{"web-scene":{type:W6,write:{writer:(t,e)=>{W6.includes(t)&&(e.theme=t)}}}},write:!0}})],K6.prototype,"theme",null),r([Je({type:q6.apiValues,json:{type:q6.jsonValues,read:q6.read,write:q6.write}})],K6.prototype,"type",void 0),r([Je({type:J6,json:{type:J6,write:!0}})],K6.prototype,"units",void 0),K6=G6=r([ln("esri.renderers.support.AuthoringInfoVisualVariable")],K6);const Q6=K6;let X6=class extends Io{constructor(t){super(t),this.type=null}};r([Je({readOnly:!0,json:{read:!1,write:!0}})],X6.prototype,"type",void 0),X6=r([ln("esri.rest.support.ColorRamp")],X6);const t8=X6;var e8;let i8=e8=class extends t8{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new e8({fromColor:nt(this.fromColor),toColor:nt(this.toColor),algorithm:this.algorithm})}};r([NA({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],i8.prototype,"algorithm",void 0),r([Je({type:RA,json:{type:[ce],write:!0}})],i8.prototype,"fromColor",void 0),r([Je({type:RA,json:{type:[ce],write:!0}})],i8.prototype,"toColor",void 0),r([Je({type:["algorithmic"]})],i8.prototype,"type",void 0),i8=e8=r([ln("esri.rest.support.AlgorithmicColorRamp")],i8);const n8=i8;var s8;let r8=s8=class extends t8{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new s8({colorRamps:nt(this.colorRamps)})}};r([Je({type:[n8],json:{write:!0}})],r8.prototype,"colorRamps",void 0),r([Je({type:["multipart"]})],r8.prototype,"type",void 0),r8=s8=r([ln("esri.rest.support.MultipartColorRamp")],r8);const o8=r8;const a8={key:"type",base:t8,typeMap:{algorithmic:n8,multipart:o8}};function l8(t){return t?.type?"algorithmic"===t.type?n8.fromJSON(t):"multipart"===t.type?o8.fromJSON(t):null:null}var u8;const c8=new Co({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),h8=new Co({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),d8=new Co({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),f8=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],p8=["high-to-low","above-and-below","above","below"],m8=["flow-line","wave-front"],y8=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let g8=u8=class extends Io{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&"relationship"!==e?"class-breaks-size"===e||"class-breaks-color"===e?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?l8(t):void 0}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return"flow"===this.type?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&"relationship"!==t&&"class-breaks-size"!==t&&"class-breaks-color"!==t||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;"classed-size"===t?e="class-breaks-size":"classed-color"===t&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new u8({classificationMethod:this.classificationMethod,colorRamp:nt(this.colorRamp),fadeRatio:nt(this.fadeRatio),fields:this.fields?.slice(),field1:nt(this.field1),field2:nt(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((t=>t.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};r([Je({type:c8.apiValues,value:null,json:{type:c8.jsonValues,read:c8.read,write:c8.write,origins:{"web-document":{default:"manual",type:c8.jsonValues,read:c8.read,write:c8.write}}}})],g8.prototype,"classificationMethod",null),r([Je({types:a8,json:{write:!0}})],g8.prototype,"colorRamp",void 0),r([ko("colorRamp")],g8.prototype,"readColorRamp",null),r([Je({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],g8.prototype,"fadeRatio",void 0),r([Je({type:[String],value:null,json:{write:!0}})],g8.prototype,"fields",null),r([Je({type:$6,value:null,json:{write:!0}})],g8.prototype,"field1",null),r([Je({type:$6,value:null,json:{write:!0}})],g8.prototype,"field2",null),r([Je({type:m8,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],g8.prototype,"flowTheme",null),r([Je({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],g8.prototype,"focus",null),r([Je({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],g8.prototype,"isAutoGenerated",void 0),r([Je({type:Number,value:null,json:{type:ce,write:!0}})],g8.prototype,"numClasses",null),r([Je({type:f8,json:{type:f8,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],g8.prototype,"lengthUnit",void 0),r([Je({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],g8.prototype,"maxSliderValue",void 0),r([Je({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],g8.prototype,"minSliderValue",void 0),r([Je({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],g8.prototype,"statistics",null),r([Je({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],g8.prototype,"standardDeviationInterval",null),r([Je({type:h8.apiValues,value:null,json:{type:h8.jsonValues,read:h8.read,write:h8.write,origins:{"web-scene":{type:d8.jsonValues,write:{writer:d8.write,overridePolicy:t=>({enabled:"flow"!==t})}}}}})],g8.prototype,"type",null),r([Je({type:[Q6],json:{write:!0}})],g8.prototype,"visualVariables",void 0),r([Je({type:y8,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],g8.prototype,"univariateSymbolStyle",null),r([Je({type:p8,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],g8.prototype,"univariateTheme",null),g8=u8=r([ln("esri.renderers.support.AuthoringInfo")],g8);const v8=g8;const w8=new Co({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let b8=class extends Io{constructor(t){super(t),this.authoringInfo=null,this.type=null}async getRequiredFields(t){if(!this.collectRequiredFields)return[];const e=new Set;return await this.collectRequiredFields(e,t),Array.from(e).sort()}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};r([Je({type:v8,json:{write:!0}})],b8.prototype,"authoringInfo",void 0),r([Je({type:w8.apiValues,readOnly:!0,json:{type:w8.jsonValues,read:!1,write:{writer:w8.write,ignoreOrigin:!0}}})],b8.prototype,"type",void 0),b8=r([ln("esri.renderers.Renderer")],b8);const S8=b8;function _8(t){return t.match(x8)?.[1]?.replace(/\\'/g,"'")??null}const x8=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let M8=class extends(cm(Io)){constructor(){super(...arguments),this.showLegend=null,this.title=null}};r([Je({type:Boolean,json:{write:!0}})],M8.prototype,"showLegend",void 0),r([Je({type:String,json:{write:!0}})],M8.prototype,"title",void 0),M8=r([ln("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],M8);const T8=M8;const A8=new Co({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let I8=class extends Io{constructor(t){super(t),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(t){return null==t?t:"function"==typeof t?(jt.getLogger(this).error(".field: field must be a string value"),null):zt(t)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};r([Je()],I8.prototype,"index",void 0),r([Je({type:A8.apiValues,readOnly:!0,json:{read:A8.read,write:A8.write}})],I8.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],I8.prototype,"field",void 0),r([Ah("field")],I8.prototype,"castField",null),r([Je({type:String,json:{write:!0}})],I8.prototype,"valueExpression",void 0),r([Je({type:String,json:{write:!0}})],I8.prototype,"valueExpressionTitle",void 0),r([Je({readOnly:!0})],I8.prototype,"arcadeRequired",null),r([Je({type:T8,json:{write:!0}})],I8.prototype,"legendOptions",void 0),I8=r([ln("esri.renderers.visualVariables.VisualVariable")],I8);const k8=I8;var C8;let E8=C8=class extends Io{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=t??0}clone(){return new C8({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};r([Je({type:RA,json:{type:[ce],write:!0}})],E8.prototype,"color",void 0),r([Je({type:String,json:{write:!0}})],E8.prototype,"label",void 0),r([Je({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],E8.prototype,"value",void 0),r([yh("value")],E8.prototype,"writeValue",null),E8=C8=r([ln("esri.renderers.visualVariables.support.ColorStop")],E8);const j8=E8;var O8;let R8=O8=class extends k8{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new O8({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};r([Je({readOnly:!0})],R8.prototype,"cache",null),r([Je({type:["color"],json:{type:["colorInfo"]}})],R8.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],R8.prototype,"normalizationField",void 0),r([Je({type:[j8],json:{write:!0}})],R8.prototype,"stops",null),R8=O8=r([ln("esri.renderers.visualVariables.ColorVariable")],R8);const L8=R8;var N8;let P8=N8=class extends Io{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return $A(e.transparency)}writeOpacity(t,e,i){e[i]=DA(t)}clone(){return new N8({label:this.label,opacity:this.opacity,value:this.value})}};r([Je({type:String,json:{write:!0}})],P8.prototype,"label",void 0),r([Je({type:Number,json:{type:ce,write:{target:"transparency"}}})],P8.prototype,"opacity",void 0),r([ko("opacity",["transparency"])],P8.prototype,"readOpacity",null),r([yh("opacity")],P8.prototype,"writeOpacity",null),r([Je({type:Number,json:{write:!0}})],P8.prototype,"value",void 0),P8=N8=r([ln("esri.renderers.visualVariables.support.OpacityStop")],P8);const F8=P8;var D8;let $8=D8=class extends k8{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new D8({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};r([Je({readOnly:!0})],$8.prototype,"cache",null),r([Je({type:["opacity"],json:{type:["transparencyInfo"]}})],$8.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],$8.prototype,"normalizationField",void 0),r([Je({type:[F8],json:{write:!0}})],$8.prototype,"stops",null),$8=D8=r([ln("esri.renderers.visualVariables.OpacityVariable")],$8);const z8=$8;var U8;let B8=U8=class extends k8{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){return new U8({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};r([Je({readOnly:!0})],B8.prototype,"cache",null),r([Je({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],B8.prototype,"axis",void 0),r([Je({type:["rotation"],json:{type:["rotationInfo"]}})],B8.prototype,"type",void 0),r([Je({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],B8.prototype,"rotationType",void 0),B8=U8=r([ln("esri.renderers.visualVariables.RotationVariable")],B8);const G8=B8;function V8(t){return tI(t)}var q8;let H8=q8=class extends Io{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new q8({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};r([Je({type:String,json:{write:!0}})],H8.prototype,"label",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],H8.prototype,"size",void 0),r([Je({type:Number,json:{write:!0}})],H8.prototype,"value",void 0),r([Je({type:Boolean,json:{write:!1}})],H8.prototype,"useMinValue",void 0),r([Je({type:Boolean,json:{write:!1}})],H8.prototype,"useMaxValue",void 0),H8=q8=r([ln("esri.renderers.visualVariables.support.SizeStop")],H8);const W8=H8;let Z8=class extends T8{constructor(){super(...arguments),this.customValues=null}};r([Je({type:[Number],json:{write:!0}})],Z8.prototype,"customValues",void 0),Z8=r([ln("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],Z8);const J8=Z8;var Y8,K8;function Q8(t){return t&&"esri.renderers.visualVariables.SizeVariable"===t.declaredClass}function X8(t){return null!=t&&!isNaN(t)&&isFinite(t)}function t9(t){return t.valueExpression?Y8.Expression:t.field&&"string"==typeof t.field?Y8.Field:Y8.Unknown}function e9(t,e){const i=e||t9(t),n=t.valueUnit||"unknown";return i===Y8.Unknown?K8.Constant:t.stops?K8.Stops:null!=t.minSize&&null!=t.maxSize&&null!=t.minDataValue&&null!=t.maxDataValue?K8.ClampedLinear:"unknown"===n?null!=t.minSize&&null!=t.minDataValue?t.minSize&&t.minDataValue?K8.Proportional:K8.Additive:K8.Identity:K8.RealWorldSize}!function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"}(Y8||(Y8={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(K8||(K8={}));const i9={unknown:1,inches:Pc(1,"meters","inches"),feet:Pc(1,"meters","feet"),"us-feet":Pc(1,"meters","us-feet"),yards:Pc(1,"meters","yards"),miles:Pc(1,"meters","miles"),"nautical-miles":Pc(1,"meters","nautical-miles"),millimeters:Pc(1,"meters","millimeters"),centimeters:Pc(1,"meters","centimeters"),decimeters:Pc(1,"meters","decimeters"),meters:Pc(1,"meters","meters"),kilometers:Pc(1,"meters","kilometers"),"decimal-degrees":1/Hc(1,"meters",Lo.radius)};const n9=()=>jt.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),s9=t=>n9().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),r9=()=>n9().error("Use of arcade expressions requires an arcade context"),o9=new OD,a9=Math.PI,l9=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function u9(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find((t=>"color"===t.type)):t;if(!n)return;if("esri.renderers.visualVariables.ColorVariable"!==n.declaredClass)return void s9("ColorVariable");const s="number"==typeof e,r=s?null:e,o=r?.attributes;let a=s?e:null;const l=n.field,{ipData:u,hasExpression:c}=n.cache;let h=n.cache.compiledFunc;if(!l&&!c){const t=n.stops;return t&&t[0]&&t[0].color}if("number"!=typeof a)if(c){if(null==i?.arcade)return void r9();const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},e=i.arcade.arcadeUtils,s=e.getViewInfo(t),o=e.createExecContext(r,s,i.timeZone);if(!h){const t=e.createSyntaxTree(n.valueExpression);h=e.createFunction(t),n.cache.compiledFunc=h}a=e.executeFunction(h,o)}else o&&(a=o[l]);const d=n.normalizationField,f=null!=o&&null!=d?parseFloat(o[d]):void 0;if(null!=a&&(!d||s||!isNaN(f)&&0!==f)){isNaN(f)||s||(a/=f);const t=I9(a,u);if(t){const e=t[0],s=t[1],r=e===s?n.stops[e].color:RA.blendColors(n.stops[e].color,n.stops[s].color,t[2],null!=i?i.color:void 0);return new RA(r)}}}function c9(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find((t=>"opacity"===t.type)):t;if(!n)return;if("esri.renderers.visualVariables.OpacityVariable"!==n.declaredClass)return void s9("OpacityVariable");const s="number"==typeof e,r=s?null:e,o=r?.attributes;let a=s?e:null;const l=n.field,{ipData:u,hasExpression:c}=n.cache;let h=n.cache.compiledFunc;if(!l&&!c){const t=n.stops;return t&&t[0]&&t[0].opacity}if("number"!=typeof a)if(c){if(null==i?.arcade)return void r9();const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},e=i.arcade.arcadeUtils,s=e.getViewInfo(t),o=e.createExecContext(r,s,i.timeZone);if(!h){const t=e.createSyntaxTree(n.valueExpression);h=e.createFunction(t),n.cache.compiledFunc=h}a=e.executeFunction(h,o)}else o&&(a=o[l]);const d=n.normalizationField,f=null!=o&&null!=d?parseFloat(o[d]):void 0;if(null!=a&&(!d||s||!isNaN(f)&&0!==f)){isNaN(f)||s||(a/=f);const t=I9(a,u);if(t){const e=t[0],i=t[1];if(e===i)return n.stops[e].opacity;{const s=n.stops[e].opacity;return s+(n.stops[i].opacity-s)*t[2]}}}}function h9(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find((t=>"rotation"===t.type)):t;if(!n)return;if("esri.renderers.visualVariables.RotationVariable"!==n.declaredClass)return void s9("RotationVariable");const s=n.axis||"heading",r="heading"===s&&"arithmetic"===n.rotationType?90:0,o="heading"===s&&"arithmetic"===n.rotationType?-1:1,a="number"==typeof e?null:e,l=a?.attributes,u=n.field,{hasExpression:c}=n.cache;let h=n.cache.compiledFunc,d=0;if(!u&&!c)return d;if(c){if(null==i?.arcade)return void r9();const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},e=i.arcade.arcadeUtils,s=e.getViewInfo(t),r=e.createExecContext(a,s,i.timeZone);if(!h){const t=e.createSyntaxTree(n.valueExpression);h=e.createFunction(t),n.cache.compiledFunc=h}d=e.executeFunction(h,r)}else l&&(d=l[u]||0);return d="number"!=typeof d||isNaN(d)?null:r+o*d,d}function d9(t,e,i){const n="number"==typeof e,s=n?null:e,r=s?.attributes;let o=n?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const e=null!=i?i.scale:void 0,n=null!=i?i.view:void 0;o=null==e||"3d"===n?f9(t):e}else if(!n)switch(t.inputValueType){case Y8.Expression:{if(null==i?.arcade)return void r9();const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},n=i.arcade.arcadeUtils,r=n.getViewInfo(e),a=n.createExecContext(s,r,i.timeZone);if(!l){const e=n.createSyntaxTree(t.valueExpression);l=n.createFunction(e),t.cache.compiledFunc=l}o=n.executeFunction(l,a);break}case Y8.Field:r&&(o=r[t.field]);break;case Y8.Unknown:o=null}if(!X8(o))return null;if(n||!t.normalizationField)return o;const u=r?parseFloat(r[t.normalizationField]):null;return X8(u)&&0!==u?o/u:null}function f9(t){let e=null,i=null;const n=t.stops;return n?(e=n[0].value,i=n[n.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}function p9(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find((t=>"size"===t.type)):t;if(!n)return;if("esri.renderers.visualVariables.SizeVariable"!==n.declaredClass)return void s9("SizeVariable");const s=M9(d9(n,e,i),n,e,i,n.cache.ipData);return null==s||isNaN(s)?0:s}function m9(t,e,i){return null==t?null:Q8(t)?p9(t,e,i):X8(t)?t:null}function y9(t,e,i){return X8(i)&&t>i?i:X8(e)&&t<e?e:t}function g9(t,e,i,n){return t+((m9(e.minSize,i,n)||e.minDataValue)??0)}function v9(t,e,i){const n=t.stops;let s=n?.length&&n[0].size;return null==s&&(s=t.minSize),m9(s,e,i)}function w9(t,e,i,n){const s=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),r=m9(e.minSize,i,n),o=m9(e.maxSize,i,n),a=null!=n?n.shape:void 0;if(t<=e.minDataValue)return r;if(t>=e.maxDataValue)return o;if(null==r||null==o)return null;if("area"===e.scaleBy&&a){const t="circle"===a,e=t?a9*(r/2)**2:r*r,i=e+s*((t?a9*(o/2)**2:o*o)-e);return t?2*Math.sqrt(i/a9):Math.sqrt(i)}return r+s*(o-r)}function b9(t,e,i,n){const s=null!=n?n.shape:void 0,r=t/e.minDataValue,o=m9(e.minSize,i,n),a=m9(e.maxSize,i,n);let l=null;return l="circle"===s?2*Math.sqrt(r*(o/2)**2):"square"===s||"diamond"===s||"image"===s?Math.sqrt(r*o**2):r*o,y9(l,o,a)}function S9(t,e,i,n,s){const[r,o,a]=I9(t,s);if(r===o)return m9(e.stops?.[r].size,i,n);{const t=m9(e.stops?.[r].size,i,n);return t+(m9(e.stops?.[o].size,i,n)-t)*a}}function _9(t,e,i,n){const s=(n?.resolution??1)*i9[e.valueUnit],r=m9(e.minSize,i,n),o=m9(e.maxSize,i,n),{valueRepresentation:a}=e;let l=null;return l="area"===a?2*Math.sqrt(t/a9)/s:"radius"===a||"distance"===a?2*t/s:t/s,y9(l,r,o)}function x9(t){return t}function M9(t,e,i,n,s){switch(e.transformationType){case K8.Additive:return g9(t,e,i,n);case K8.Constant:return v9(e,i,n);case K8.ClampedLinear:return w9(t,e,i,n);case K8.Proportional:return b9(t,e,i,n);case K8.Stops:return S9(t,e,i,n,s);case K8.RealWorldSize:return _9(t,e,i,n);case K8.Identity:return x9(t);case K8.Unknown:return null}}function T9(t,e,i){const{isScaleDriven:n}=t.cache;if(!(n&&"3d"===i||e))return null;const s={scale:e,view:i};let r=m9(t.minSize,o9,s),o=m9(t.maxSize,o9,s);if(null!=r||null!=o){if(r>o){const t=o;o=r,r=t}return{minSize:r,maxSize:o}}}function A9(t,e,i){if(!t.visualVariables)return;const n=[],s=[],r=[],o=[],a=[];for(const e of t.visualVariables)switch(e.type){case"color":s.push(e);break;case"opacity":r.push(e);break;case"rotation":a.push(e);break;case"size":o.push(e)}return s.forEach((t=>{const s=u9(t,e,i);n.push({variable:t,value:s})})),r.forEach((t=>{const s=c9(t,e,i);n.push({variable:t,value:s})})),a.forEach((t=>{const s=h9(t,e,i);n.push({variable:t,value:s})})),o.forEach((t=>{const s=p9(t,e,i);n.push({variable:t,value:s})})),n.filter((t=>null!=t.value))}function I9(t,e){if(!e)return;let i=0,n=e.length-1;return e.some(((e,s)=>t<e?(n=s,!0):(i=s,!1))),[i,n,(t-e[i])/(e[n]-e[i])]}function k9(t,e,i){const n=["proportional","proportional","proportional"];for(const s of t){const t=s.useSymbolValue?"symbol-value":p9(s,e,i);switch(s.axis){case"width":n[0]=t;break;case"depth":n[1]=t;break;case"height":n[2]=t;break;case"width-and-depth":n[0]=t,n[1]=t;break;case"all":case void 0:case null:n[0]=t,n[1]=t,n[2]=t;break}}return n}const C9=Object.freeze({__proto__:null,getAllSizes:k9,getColor:u9,getOpacity:c9,getRotationAngle:h9,getSize:p9,getSizeForValue:M9,getSizeFromNumberOrVariable:m9,getSizeRangeAtScale:T9,getVisualVariableValues:A9,viewScaleRE:l9});var E9;const j9=new Co({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),O9=new Co({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function R9(t){if(null!=t)return"string"==typeof t||"number"==typeof t?V8(t):"size"===t.type?Q8(t)?t:(delete(t={...t}).type,new N9(t)):void 0}function L9(t,e,i){if("object"!=typeof t)return t;const n=new N9;return n.read(t,i),n}let N9=E9=class extends k8{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:null!=this.valueExpression&&l9.test(this.valueExpression)}}set index(t){Q8(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),Q8(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return t9(this)}set maxDataValue(t){t&&this.stops&&(jt.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(jt.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return R9(t)}readMaxSize(t,e,i){return L9(t,e,i)}set minDataValue(t){t&&this.stops&&(jt.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(jt.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return R9(t)}readMinSize(t,e,i){return L9(t,e,i)}get arcadeRequired(){return!!this.valueExpression||(null!=this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||null!=this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired)}set stops(t){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)):t&&(jt.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return e9(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,n){if("$view.scale"===t){if(n?.messages){const t=this.index,e="string"==typeof t?t:`visualVariables[${t}]`;n.messages.push(new Ve("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:e+".valueExpression",context:n}))}}else e[i]=t}readValueUnit(t){return t?O9.read(t):null}clone(){return new E9({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Q8(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Q8(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((t=>t.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType===K8.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===K8.Stops){const t=this.stops;if(!t)return this;const e=t.map((t=>t.size)).reverse(),i=t.length;for(let n=0;n<i;n++)t[n].size=e[n];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map((t=>t.value||0))}};r([Je({readOnly:!0})],N9.prototype,"cache",null),r([Je({type:j9.apiValues,json:{type:j9.jsonValues,origins:{"web-map":{read:!1}},read:j9.read,write:j9.write}})],N9.prototype,"axis",void 0),r([Je()],N9.prototype,"index",null),r([Je({type:String,readOnly:!0})],N9.prototype,"inputValueType",null),r([Je({type:J8,json:{write:!0}})],N9.prototype,"legendOptions",void 0),r([Je({type:Number,value:null,json:{write:!0}})],N9.prototype,"maxDataValue",null),r([Je({type:Number,value:null,json:{write:!0}})],N9.prototype,"maxSize",null),r([Ah("maxSize")],N9.prototype,"castMaxSize",null),r([ko("maxSize")],N9.prototype,"readMaxSize",null),r([Je({type:Number,value:null,json:{write:!0}})],N9.prototype,"minDataValue",null),r([Je({type:Number,value:null,json:{write:!0}})],N9.prototype,"minSize",null),r([Ah("minSize")],N9.prototype,"castMinSize",null),r([ko("minSize")],N9.prototype,"readMinSize",null),r([Je({type:String,json:{write:!0}})],N9.prototype,"normalizationField",void 0),r([Je({readOnly:!0})],N9.prototype,"arcadeRequired",null),r([Je({type:String})],N9.prototype,"scaleBy",void 0),r([Je({type:[W8],value:null,json:{write:!0}})],N9.prototype,"stops",null),r([Je({type:["outline"],json:{write:!0}})],N9.prototype,"target",void 0),r([Je({type:String,readOnly:!0})],N9.prototype,"transformationType",null),r([Je({type:["size"],json:{type:["sizeInfo"]}})],N9.prototype,"type",void 0),r([Je({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],N9.prototype,"useSymbolValue",void 0),r([Je({type:String,json:{write:!0}})],N9.prototype,"valueExpression",void 0),r([ko("valueExpression",["valueExpression","expression"])],N9.prototype,"readValueExpression",null),r([yh("web-scene","valueExpression")],N9.prototype,"writeValueExpressionWebScene",null),r([Je({type:["radius","diameter","area","width","distance"],json:{write:!0}})],N9.prototype,"valueRepresentation",void 0),r([Je({type:O9.apiValues,json:{write:O9.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],N9.prototype,"valueUnit",void 0),r([ko("valueUnit")],N9.prototype,"readValueUnit",null),N9=E9=r([ln("esri.renderers.visualVariables.SizeVariable")],N9);const P9=N9;const F9={color:L8,size:P9,opacity:z8,rotation:G8},D9=new Co({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),$9=/^\[([^\]]+)\]$/i;let z9=class extends ao{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(t){if(this._resetVariables(),t=t?.filter((t=>!!t)),t?.length){for(const e of t)switch(e.type){case"color":this.colorVariables.push(e);break;case"opacity":this.opacityVariables.push(e);break;case"rotation":this.rotationVariables.push(e);break;case"size":this.sizeVariables.push(e)}if(this.sizeVariables.length){this.sizeVariables.some((t=>!!t.target))&&t.sort(((t,e)=>{let i=null;return i=t.target===e.target?0:t.target?1:-1,i}))}for(let e=0;e<t.length;e++){t[e].index=e}this._set("visualVariables",t)}else this._set("visualVariables",t)}readVariables(t,e,i){const{rotationExpression:n,rotationType:s}=e,r=n?.match($9),o=r?.[1];if(o&&(t||(t=[]),t.push({type:"rotationInfo",rotationType:s,field:o})),t)return t.map((t=>{const e=D9.read(t.type),n=F9[e];n||(jt.getLogger(this).warn(`Unknown variable type: ${e}`),i?.messages&&i.messages.push(new wi("visual-variable:unsupported",`visualVariable of type '${e}' is not supported`,{definition:t,context:i})));const s=new n;return s.read(t,i),s}))}writeVariables(t,e){const i=[];for(const n of t){const t=n.toJSON(e);t&&i.push(t)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};r([Je()],z9.prototype,"visualVariables",null),z9=r([ln("esri.renderers.visualVariables.VisualVariableFactory")],z9);const U9=z9;const B9={base:k8,key:"type",typeMap:{opacity:z8,color:L8,rotation:G8,size:P9}},G9=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new U9}set visualVariables(t){this._vvFactory.visualVariables=t,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(t,e,i){return this._vvFactory.readVariables(t,e,i)}writeVisualVariables(t,e,i,n){e[i]=this._vvFactory.writeVariables(t,n)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const t of this.visualVariables)if(t.arcadeRequired)return!0;return!1}hasVisualVariables(t,e){return t?this.getVisualVariablesForType(t,e).length>0:this.getVisualVariablesForType("size",e).length>0||this.getVisualVariablesForType("color",e).length>0||this.getVisualVariablesForType("opacity",e).length>0||this.getVisualVariablesForType("rotation",e).length>0}getVisualVariablesForType(t,e){const i=this.visualVariables;return i?i.filter((i=>i.type===t&&("string"==typeof e?i.target===e:!1!==e||!i.target))):[]}async collectVVRequiredFields(t,e){let i=[];this.visualVariables&&(i=i.concat(this.visualVariables));for(const n of i)n&&(n.field&&KE(t,e,n.field),n.normalizationField&&KE(t,e,n.normalizationField),n.valueExpression&&(V9(n.valueExpression,t,e)||await tj(t,e,n.valueExpression)))}};return r([Je({types:[B9],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),r([ko("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),r([yh("visualVariables")],e.prototype,"writeVisualVariables",null),e=r([ln("esri.renderers.mixins.VisualVariablesMixin")],e),e};function V9(t,e,i){const n=_8(t);return null!=n&&(KE(e,i,n),!0)}const q9=[252,146,31,255],H9=[153,153,153,255],W9={type:"esriSMS",style:"esriSMSCircle",size:6,color:q9,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},Z9={type:"esriSLS",style:"esriSLSSolid",width:.75,color:q9},J9={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},Y9={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},K9={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},Q9={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},X9={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};const t7=lD.fromJSON(W9),e7=DL.fromJSON(Z9),i7=sD.fromJSON(J9),n7=hD.fromJSON(Y9);function s7(t){if(null==t)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return t7;case"polyline":return e7;case"polygon":case"extent":return i7}return null}const r7=lD.fromJSON(K9),o7=DL.fromJSON(Q9),a7=sD.fromJSON(X9);YF.fromSimpleMarkerSymbol(t7);kF.fromSimpleLineSymbol(e7);tD.fromSimpleFillSymbol(i7);new LF({symbolLayers:new Vm([new ZN({material:{color:q9},edges:new SL({size:XA(1),color:new RA(H9)})})])});const l7=new kF({symbolLayers:new Vm([new IP({material:{color:new RA([0,0,0])},size:XA(1)})])}),u7=new tD({symbolLayers:new Vm([new ZN({outline:{color:new RA([0,0,0]),size:XA(1)}})])});const c7="#useCIMFallbackSymbology()",h7={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function d7(t,e=h7){if(!t)return{symbol:null};const{retainId:i=h7.retainId,ignoreDrivers:n=h7.ignoreDrivers,hasLabelingContext:s=h7.hasLabelingContext,retainCIM:r=h7.retainCIM,cimFallbackEnabled:o=h7.cimFallbackEnabled}=e;let a=null;if(yD(t)||t instanceof pD)a=t.clone();else if("cim"===t.type){const i=t.data?.symbol?.type;switch(i){case"CIMPointSymbol":a=r?t.clone():YF.fromCIMSymbol(t);break;case"CIMLineSymbol":o&&(a=l7.clone(),e?.logWarning?.(c7,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(a=u7.clone(),e?.logWarning?.(c7,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!a)return{error:new Ve("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${i||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof DL)a=kF.fromSimpleLineSymbol(t);else if(t instanceof lD)a=YF.fromSimpleMarkerSymbol(t);else if(t instanceof HF)a=YF.fromPictureMarkerSymbol(t);else if(t instanceof sD)a=e.geometryType&&"mesh"===e.geometryType?LF.fromSimpleFillSymbol(t):tD.fromSimpleFillSymbol(t);else{if(!(t instanceof hD))return{error:new Ve("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};a=s?xF.fromTextSymbol(t):YF.fromTextSymbol(t)}return i&&a&&"cim"!==a.type&&(a.id=t.id),n&&yD(a)&&a.symbolLayers.forEach((t=>t.ignoreDrivers=!0)),{symbol:a}}function f7(t,e,i,n){const s=g7(t,{},{context:n,isLabelSymbol:!1});null!=s&&(e[i]=s)}function p7(t,e,i,n){const s=g7(t,{},{context:n,isLabelSymbol:!0});null!=s&&(e[i]=s)}function m7(t){return t instanceof rF||t instanceof pD}function y7(t){return t instanceof rF&&("polygon-3d"===t.type||"line-3d"===t.type)}function g7(t,e,i){if(null==t)return null;const{context:n,isLabelSymbol:s}=i,r=n?.origin,o=n?.messages;if("web-scene"===r&&!m7(t)){const i=d7(t,{retainCIM:!0,hasLabelingContext:s});return null!=i.symbol?i.symbol.write(e,n):(o?.push(new Ve("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:n,error:i.error})),null)}return KT(n?.layer)&&y7(t)?(o?.push(new Ve("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported on layers of type '${n?.layer?.declaredClass}'.`,{symbol:t,context:n})),null):("web-map"===r||"portal-item"===r&&!KT(n?.layer))&&m7(t)?(o?.push(new Ve("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:n})),null):t.write(e,n)}function v7(t,e){return _D(t,null,e)}const w7={types:xD,json:{write:{writer:f7},origins:{"web-scene":{types:TD,write:{writer:f7},read:{reader:xi({types:TD})}}}}},b7=mt({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},w7),S7={types:{base:sL,key:"type",typeMap:{"simple-fill":gD.typeMap["simple-fill"],"picture-fill":gD.typeMap["picture-fill"],"polygon-3d":gD.typeMap["polygon-3d"],cim:gD.typeMap.cim}},json:{write:{writer:f7},origins:{"web-scene":{type:tD,write:{writer:f7}}}}},_7={cast:t=>null==t||"string"==typeof t||"number"==typeof t?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t?.toString()}}}};var x7;let M7=x7=class extends Io{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new x7({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};r([Je({type:String,json:{write:!0}})],M7.prototype,"description",void 0),r([Je({type:String,json:{write:!0}})],M7.prototype,"label",void 0),r([Je({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],M7.prototype,"minValue",void 0),r([Je({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],M7.prototype,"maxValue",void 0),r([Je(b7)],M7.prototype,"symbol",void 0),M7=x7=r([ln("esri.renderers.support.ClassBreakInfo")],M7);const T7=M7;const A7=Oo()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let I7=class extends(cm(Io)){constructor(t){super(t),this.title=null,this.order=null}};r([Je({type:String,json:{write:!0}})],I7.prototype,"title",void 0),r([NA(A7)],I7.prototype,"order",void 0),I7=r([ln("esri.renderers.support.RendererLegendOptions")],I7);const k7=I7;var C7;const E7="log",j7="percent-of-total",O7="field",R7=new Co({esriNormalizeByLog:E7,esriNormalizeByPercentOfTotal:j7,esriNormalizeByField:O7}),L7=ee(T7);let N7=C7=class extends(G9(S8)){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let n=e.minValue;return t.map((t=>{const e=new T7;return e.read(t,i),null==e.minValue&&(e.minValue=n),null==e.maxValue&&(e.maxValue=e.minValue),n=e.maxValue,e}))}writeClassBreakInfos(t,e,i,n){const s=t.map((t=>t.write({},n)));this._areClassBreaksConsecutive()&&s.forEach((t=>delete t.classMinValue)),e[i]=s}castField(t){return null==t?t:"function"==typeof t?(jt.getLogger(this).error(".field: field must be a string value"),null):zt(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=null!=this.normalizationTotal;return e||i?(t=e&&O7||i&&j7||null,e&&i&&jt.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==O7&&t!==j7||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let n=null;n="number"==typeof t?new T7({minValue:t,maxValue:e,symbol:ID(i)}):L7(nt(t)),this.classBreakInfos.push(n),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let n=0;n<i;n++){const i=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue];if(i[0]===t&&i[1]===e){this.classBreakInfos.splice(n,1);break}}}getBreakIndex(t,e){return this.valueExpression&&null==e?.arcade&&jt.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;this.valueExpression&&null==e?.arcade&&(i={...i,arcade:await PE()});const n=this.getBreakIndex(t,i);return-1!==n?this.classBreakInfos[n]:null}getSymbol(t,e){if(this.valueExpression&&null==e?.arcade)return void jt.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&null==e?.arcade){const t=await PE(),{arcadeUtils:e}=t;e.hasGeometryOperations(this.valueExpression)&&await e.enableGeometryOperations(),i={...i,arcade:t}}const n=this.getBreakIndex(t,i);return n>-1?this.classBreakInfos[n].symbol:this.defaultSymbol}getSymbols(){const t=[];return this.classBreakInfos.forEach((e=>{e.symbol&&t.push(e.symbol)})),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce(((t,e)=>t+e.getMeshHash()),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new C7({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:nt(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:nt(this.visualVariables),legendOptions:nt(this.legendOptions),authoringInfo:nt(this.authoringInfo)})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(t,e))),tj(t,e,this.valueExpression)];KE(t,e,this.field),KE(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:n,spatialReference:s,arcade:r,timeZone:o}=e??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=r.arcadeUtils;if(!l){const t=u.createSyntaxTree(a);l=u.createFunction(t),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(t,u.getViewInfo({viewingMode:i,scale:n,spatialReference:s}),o));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(t){const e=this.field,i=t.attributes,n=this.normalizationType;let s=parseFloat(i[e]);if(n){const t=this.normalizationTotal,e=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(n===E7)s=Math.log(s)*Math.LOG10E;else if(n!==j7||null==t||isNaN(t)){if(n===O7&&!isNaN(e)){if(isNaN(s)||isNaN(e))return-1;s/=e}}else s=s/t*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(null!=t&&"number"==typeof t&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const n=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(n[0]<=t&&(e?t<=n[1]:t<n[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};r([Je(S7)],N7.prototype,"backgroundFillSymbol",void 0),r([Je({type:[T7]})],N7.prototype,"classBreakInfos",void 0),r([ko("classBreakInfos")],N7.prototype,"readClassBreakInfos",null),r([yh("classBreakInfos")],N7.prototype,"writeClassBreakInfos",null),r([Je({type:String,json:{write:!0}})],N7.prototype,"defaultLabel",void 0),r([Je(w7)],N7.prototype,"defaultSymbol",void 0),r([Je({type:String,json:{write:!0}})],N7.prototype,"field",void 0),r([Ah("field")],N7.prototype,"castField",null),r([Je({type:Boolean})],N7.prototype,"isMaxInclusive",void 0),r([Je({type:k7,json:{write:!0}})],N7.prototype,"legendOptions",void 0),r([Je({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],N7.prototype,"minValue",null),r([Je({type:String,json:{write:!0}})],N7.prototype,"normalizationField",void 0),r([Je({type:Number,json:{write:!0}})],N7.prototype,"normalizationTotal",void 0),r([Je({type:R7.apiValues,value:null,json:{type:R7.jsonValues,read:R7.read,write:R7.write}})],N7.prototype,"normalizationType",null),r([NA({classBreaks:"class-breaks"})],N7.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],N7.prototype,"valueExpression",void 0),r([Je({type:String,json:{write:!0}})],N7.prototype,"valueExpressionTitle",void 0),N7=C7=r([ln("esri.renderers.ClassBreaksRenderer")],N7);const P7=N7;const F7=-3,D7=F7-1;var $7;!function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"}($7||($7={}));class z7{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new hs,this._users=new hs}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,e){const i=this._db.get(t.id+e);return i?.size??0}put(t,e,i,n,s){e=t.id+e;const r=this._db.get(e);if(r&&(this._size-=r.size,t.size-=r.size,this._db.delete(e),r.entry!==i&&this._notifyRemove(e,r.entry,r.size,$7.ALL)),n>this._maxSize)return void this._notifyRemove(e,i,n,$7.ALL);if(void 0===i)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${e}`),void this._notifyRemove(e,i,0,$7.ALL);const o=1+Math.max(s,D7)-F7;this._db.set(e,new U7(i,n,o)),this._size+=n,t.size+=n,this._checkSize()}updateSize(t,e,i,n){e=t.id+e;const s=this._db.get(e);if(s&&s.entry===i){for(this._size-=s.size,t.size-=s.size;n>this._maxSize;){const t=this._notifyRemove(e,i,n,$7.SOME);if(!(null!=t&&t>0))return void this._db.delete(e);n=t}s.size=n,this._size+=n,t.size+=n,this._checkSize()}}pop(t,e){e=t.id+e;const i=this._db.get(e);if(i)return this._size-=i.size,t.size-=i.size,this._db.delete(e),++this._hit,i.entry;++this._miss}get(t,e){e=t.id+e;const i=this._db.get(e);if(void 0!==i)return this._db.delete(e),i.lives=i.lifetime,this._db.set(e,i),++this._hit,i.entry;++this._miss}peek(t,e){const i=this._db.get(t.id+e);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},i=new Array;this._db.forEach(((t,n)=>{const s=t.lifetime;i[s]=(i[s]||0)+t.size,this._users.forAll((i=>{const{id:s,name:r}=i;if(n.startsWith(s)){const i=e[r]||0;e[r]=i+t.size}}))}));const n={};this._users.forAll((t=>{const i=t.name;if("hitRate"in t&&"number"==typeof t.hitRate&&!isNaN(t.hitRate)&&t.hitRate>0){const s=e[i]||0;e[i]=s,n[i]=Math.round(100*t.hitRate)+"%"}else n[i]="0%"}));const s=Object.keys(e);s.sort(((t,i)=>e[i]-e[t])),s.forEach((i=>t[i]=Math.round(e[i]/2**20)+"MB / "+n[i]));for(let e=i.length-1;e>=0;--e){const n=i[e];n&&(t["Priority "+(e+F7-1)]=Math.round(n/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){const e=t.id;this._db.forEach(((t,i)=>{i.startsWith(e)&&(this._size-=t.size,this._db.delete(i),this._notifyRemove(i,t.entry,t.size,$7.ALL))})),t.size=0}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,t.size,$7.ALL))),this._users.forAll((t=>t.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,i,n){let s;return this._removeFuncs.some((r=>{if(t.startsWith(r[0])){const t=r[1](e,n,i);return"number"==typeof t&&(s=t),!0}return!1})),s}_checkSize(){this._users.forAll((t=>this._checkSizeLimits(t))),this._checkSizeLimits()}_checkSizeLimits(t){const e=t??this;if(e.maxSize<0||e.size<=e.maxSize)return;const i=t?.id;let n=!0;for(;n;){n=!1;for(const[s,r]of this._db)if(0===r.lifetime&&(!i||s.startsWith(i))){if(this._purgeItem(s,r,t),e.size<=.9*e.maxSize)return;n||=this._db.has(s)}}for(const[n,s]of this._db)if((!i||n.startsWith(i))&&(this._purgeItem(n,s,t),e.size<=.9*e.maxSize))return}_purgeItem(t,e,i=this._users.find((e=>t.startsWith(e.id)))){if(this._db.delete(t),e.lives<=1){this._size-=e.size,i&&(i.size-=e.size);const n=this._notifyRemove(t,e.entry,e.size,$7.SOME);null!=n&&n>0&&(this._size+=n,i&&(i.size+=n),e.lives=e.lifetime,e.size=n,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}class U7{constructor(t,e,i){this.entry=t,this.size=e,this.lifetime=i,this.lives=i}}class B7{constructor(t,e){this._storage=new z7,this.id="",this.name="",this.size=0,this._storage.maxSize=t,this._storage.register(this),e&&this._storage.registerRemoveFunc("",e)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,e,i=1){this._storage.put(this,t,e,i,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}class G7{}function V7(t){return t instanceof rg.Zone?t===G7.instance:"unknown"===t?.toString().toLowerCase()}function q7(t){return V7(t)?G7.instance:t}G7.instance=new rg.IANAZone("Etc/UTC");function H7(t){return"timeZone"in t}function W7(t){return"timeZone"in t}function Z7(t){return"dateFieldsTimeZone"in t}const J7=new Map;class Y7{static fromJSON(t){return new Y7(t.fields,t.timeZoneByFieldName)}static fromLayer(t){return new Y7(t.fields??[],ttt(t))}static fromLayerJSON(t){return new Y7(t.fields??[],ttt(t))}constructor(t=[],e){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=t||[],this._timeZoneByFieldName=e?new Map(e):null;const i=[];for(const t of this.fields){const e=t?.name,n=Q7(e);if(e&&n){const s=K7(e);this._fieldsMap.set(e,t),this._fieldsMap.set(s,t),this._normalizedFieldsMap.set(n,t),i.push(`${s}:${t.type}:${this._timeZoneByFieldName?.get(e)}`),Gj(t)?(this.dateFields.push(t),this._dateFieldsSet.add(t)):Uj(t)&&(this._numericFieldsSet.add(t),this.numericFields.push(t)),Wj(t)||Zj(t)||(t.editable=null==t.editable||!!t.editable,t.nullable=null==t.nullable||!!t.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)Wj(t)||Zj(t)||t.nullable||void 0!==Mj(t)||this._requiredFields.push(t)}return this._requiredFields}equals(t){return this.uid===t?.uid}has(t){return null!=this.get(t)}get(t){if(!t)return;let e=this._fieldsMap.get(t);return e||(e=this._fieldsMap.get(K7(t))??this._normalizedFieldsMap.get(Q7(t)),e&&this._fieldsMap.set(t,e),e)}getTimeZone(t){const e=this.get(t&&"string"!=typeof t?t.name:t);return e?this._timeZoneByFieldName?this._timeZoneByFieldName.get(e.name):"date"===e.type||"esriFieldTypeDate"===e.type?(jt.getLogger("esri.layers.support.FieldsIndex").error(new Ve("getTimeZone:no-timezone-information",`no time zone information for field '${e.name}'`)),lg):X7.has(e.type)?ag:null:null}getLuxonTimeZone(t){const e=this.getTimeZone(t);return e?e===ag?G7.instance:e===lg?rg.FixedOffsetZone.utcInstance:Nt(J7,e,(()=>rg.IANAZone.create(e))):null}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isTimeOnlyField(t){return Hj(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){return this.get(t)?.name??void 0}toJSON(){return{fields:this.fields.map((t=>Ao(t)?t.toJSON():t)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function K7(t){return t.trim().toLowerCase()}function Q7(t){return BE(t)?.toLowerCase()??""}const X7=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function ttt(t){const e=new Map;if(!t.fields)return e;const i=!0===t.datesInUnknownTimezone,{timeInfo:n,editFieldsInfo:s}=t,r=(n?"startField"in n?n.startField:n.startTimeField:"")??"",o=(n?"endField"in n?n.endField:n.endTimeField:"")??"",a=Z7(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?pg(t.dateFieldsTimeReference):null,l=s?H7(s)?s.timeZone??a:s.dateFieldsTimeReference?pg(s.dateFieldsTimeReference):a??lg:null,u=n?W7(n)?n.timeZone??a:n.timeReference?pg(n.timeReference):a:null,c=new Map([[K7(s?.creationDateField??""),l],[K7(s?.editDateField??""),l],[K7(r),u],[K7(o),u]]);for(const{name:n,type:s}of t.fields)if(X7.has(s))e.set(n,ag);else if("date"!==s&&"esriFieldTypeDate"!==s)e.set(n,null);else if(i)e.set(n,ag);else{const t=c.get(K7(n??""))??a;e.set(n,t)}return e}function ett(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function itt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ntt(t,e,i,n,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t}function stt(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function rtt(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function ott(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function att(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function ltt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function utt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function ctt(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}function htt(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}function dtt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function ftt(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function ptt(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t}function mtt(t,e){const i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2],r=e[3]-t[3];return Math.sqrt(i*i+n*n+s*s+r*r)}function ytt(t,e){const i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2],r=e[3]-t[3];return i*i+n*n+s*s+r*r}function gtt(t){const e=t[0],i=t[1],n=t[2],s=t[3];return Math.sqrt(e*e+i*i+n*n+s*s)}function vtt(t){const e=t[0],i=t[1],n=t[2],s=t[3];return e*e+i*i+n*n+s*s}function wtt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function btt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Stt(t,e){const i=e[0],n=e[1],s=e[2],r=e[3];let o=i*i+n*n+s*s+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=n*o,t[2]=s*o,t[3]=r*o),t}function _tt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function xtt(t,e,i,n){const s=e[0],r=e[1],o=e[2],a=e[3];return t[0]=s+n*(i[0]-s),t[1]=r+n*(i[1]-r),t[2]=o+n*(i[2]-o),t[3]=a+n*(i[3]-a),t}function Mtt(t,e=1){const i=mI;let n,s,r,o,a,l;do{n=2*i()-1,s=2*i()-1,a=n*n+s*s}while(a>=1);do{r=2*i()-1,o=2*i()-1,l=r*r+o*o}while(l>=1);const u=Math.sqrt((1-a)/l);return t[0]=e*n,t[1]=e*s,t[2]=e*r*u,t[3]=e*o*u,t}function Ttt(t,e,i){const n=e[0],s=e[1],r=e[2],o=e[3];return t[0]=i[0]*n+i[4]*s+i[8]*r+i[12]*o,t[1]=i[1]*n+i[5]*s+i[9]*r+i[13]*o,t[2]=i[2]*n+i[6]*s+i[10]*r+i[14]*o,t[3]=i[3]*n+i[7]*s+i[11]*r+i[15]*o,t}function Att(t,e,i){const n=e[0],s=e[1],r=e[2],o=i[0],a=i[1],l=i[2],u=i[3],c=u*n+a*r-l*s,h=u*s+l*n-o*r,d=u*r+o*s-a*n,f=-o*n-a*s-l*r;return t[0]=c*u+f*-o+h*-l-d*-a,t[1]=h*u+f*-a+d*-o-c*-l,t[2]=d*u+f*-l+c*-a-h*-o,t[3]=e[3],t}function Itt(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function ktt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Ctt(t,e){const i=t[0],n=t[1],s=t[2],r=t[3],o=e[0],a=e[1],l=e[2],u=e[3],c=fI();return Math.abs(i-o)<=c*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-a)<=c*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(s-l)<=c*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(r-u)<=c*Math.max(1,Math.abs(r),Math.abs(u))}const Ett=rtt,jtt=ott,Ott=att,Rtt=mtt,Ltt=ytt,Ntt=gtt,Ptt=vtt;Object.freeze(Object.defineProperty({__proto__:null,add:stt,ceil:ltt,copy:ett,copyVec3:itt,dist:Rtt,distance:mtt,div:Ott,divide:att,dot:_tt,equals:Ctt,exactEquals:ktt,floor:utt,inverse:btt,len:Ntt,length:gtt,lerp:xtt,max:htt,min:ctt,mul:jtt,multiply:ott,negate:wtt,normalize:Stt,random:Mtt,round:dtt,scale:ftt,scaleAndAdd:ptt,set:ntt,sqrDist:Ltt,sqrLen:Ptt,squaredDistance:ytt,squaredLength:vtt,str:Itt,sub:Ett,subtract:rtt,transformMat4:Ttt,transformQuat:Att},Symbol.toStringTag,{value:"Module"}));function Ftt(){return[0,0,0,0]}function Dtt(t){return[t[0],t[1],t[2],t[3]]}function $tt(t,e,i,n){return[t,e,i,n]}function ztt(t,e,i,n){return[t,e,i,n]}function Utt(t,e=Ftt()){const i=Math.min(4,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function Btt(t,e){return new Float64Array(t,e,4)}function Gtt(){return Ftt()}function Vtt(){return $tt(1,1,1,1)}function qtt(){return $tt(1,0,0,0)}function Htt(){return $tt(0,1,0,0)}function Wtt(){return $tt(0,0,1,0)}function Ztt(){return $tt(0,0,0,1)}const Jtt=Gtt(),Ytt=Vtt(),Ktt=qtt(),Qtt=Htt(),Xtt=Wtt(),tet=Ztt();Object.freeze(Object.defineProperty({__proto__:null,ONES:Ytt,UNIT_W:tet,UNIT_X:Ktt,UNIT_Y:Qtt,UNIT_Z:Xtt,ZEROS:Jtt,clone:Dtt,create:Ftt,createView:Btt,freeze:ztt,fromArray:Utt,fromValues:$tt,ones:Vtt,unitW:Ztt,unitX:qtt,unitY:Htt,unitZ:Wtt,zeros:Gtt},Symbol.toStringTag,{value:"Module"}));function eet(t){return"r"in t&&"g"in t&&"b"in t}function iet(t){return"h"in t&&"s"in t&&"v"in t}function net(t){return"l"in t&&"a"in t&&"b"in t}function set(t){return"l"in t&&"c"in t&&"h"in t}function ret(t){return"x"in t&&"y"in t&&"z"in t}const oet=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],aet=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function uet(t,e){const i=[];let n,s;if(t[0].length!==e.length)throw new Error("dimensions do not match");const r=t.length,o=t[0].length;let a=0;for(n=0;n<r;n++){for(a=0,s=0;s<o;s++)a+=t[n][s]*e[s];i.push(a)}return i}function cet(t){const e=[t.r/255,t.g/255,t.b/255].map((t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4)),i=uet(oet,e);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function het(t){const e=uet(aet,[t.x/100,t.y/100,t.z/100]).map((t=>{const e=t<=.0031308?12.92*t:1.055*t**(1/2.4)-.055;return Math.min(1,Math.max(e,0))}));return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function det(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map((t=>t>(6/29)**3?t**(1/3):1/3*(29/6)**2*t+4/29));return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function fet(t){const e=t.l,i=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map((t=>t>6/29?t**3:3*(6/29)**2*(t-4/29)));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function pet(t){const e=t.l,i=t.a,n=t.b,s=Math.sqrt(i*i+n*n);let r=Math.atan2(n,i);return r=r>0?r:r+2*Math.PI,{l:e,c:s,h:r}}function met(t){const e=t.l,i=t.c,n=t.h;return{l:e,a:i*Math.cos(n),b:i*Math.sin(n)}}function yet(t){return det(cet(t))}function get(t){return het(fet(t))}function vet(t){return pet(det(cet(t)))}function wet(t){return het(fet(met(t)))}function bet(t){const e=t.r,i=t.g,n=t.b,s=Math.max(e,i,n),r=s-Math.min(e,i,n);let o=s,a=0===r?0:s===e?(i-n)/r%6:s===i?(n-e)/r+2:(e-i)/r+4,l=0===r?0:r/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}function _et(t){const e=(t.h+360)%360/60,i=t.s/100,n=t.v/100*255,s=n*i,r=s*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r:s,g:r,b:0};break;case 1:o={r,g:s,b:0};break;case 2:o={r:0,g:s,b:r};break;case 3:o={r:0,g:r,b:s};break;case 4:o={r,g:0,b:s};break;case 5:case 6:o={r:s,g:0,b:r};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+n-s),o.g=Math.round(o.g+n-s),o.b=Math.round(o.b+n-s),o}function xet(t){return eet(t)?t:set(t)?wet(t):net(t)?get(t):ret(t)?het(t):iet(t)?_et(t):t}function Met(t){if(iet(t))return t;return bet(xet(t))}function Tet(t){return net(t)?t:yet(xet(t))}function Aet(t){return set(t)?t:vet(xet(t))}function Iet(t){let{r:e,g:i,b:n,a:s}=t;return s<1&&(e=Math.round(s*e+255*(1-s)),i=Math.round(s*i+255*(1-s)),n=Math.round(s*n+255*(1-s))),new RA({r:e,g:i,b:n})}function ket(t,e){const{r:i,g:n,b:s}=e?.ignoreAlpha?t:Iet(t);return.2126*i+.7152*n+.0722*s}var Cet;function Eet(t,e=Cet.High){return ket(t,{ignoreAlpha:!0})>e?new RA([0,0,0,t.a]):new RA([255,255,255,t.a])}function jet(t,e,i={}){if(0===t.length||e<=0)return[];if(1===(t=t.map((t=>"string"==typeof t?new RA(t):t))).length||1===e){const i=[],n=t[0];for(let t=0;t<e;t++)i.push(n.clone());return i}if(i.shuffle&&(t=A(nt(t),i.seed)),t.length>=e){const i=[],n=(t.length-1)/(e-1);for(let s=0;s<e;s++){const e=Math.round(s*n);i.push(t[e].clone())}return i}return Oet(t,e,i)}function Oet(t,e,i={}){const n=[],s=t.length-1,r=Math.ceil((e-t.length)/s);t:for(let o=0;o<s;o++){const s=t[o],a=t[o+1];for(let o=1;o<=r;o++){const l=o/(r+1);if(n.push(Let(s,a,l,i)),n.length+t.length===e)break t}}return[...t.map((t=>t.clone())),...A(n,i.seed??1)]}!function(t){t[t.Low=160]="Low",t[t.High=225]="High"}(Cet||(Cet={}));const Ret=(t,e)=>{const i=Math.floor(10*e())-5;return Math.min(255,Math.max(0,t+i))};function Let(t,e,i,n={}){const s=t.r,r=t.g,o=t.b,a=e.r,l=e.g,u=e.b,c=Math.round(s+(a-s)*i),h=Math.round(r+(l-r)*i),d=Math.round(o+(u-o)*i);if(!n.offset)return new RA([c,h,d]);const f=T(n.seed);return new RA([Ret(c,f),Ret(h,f),Ret(d,f)])}var Net,Pet,Fet,Det,$et,zet,Uet,Bet,Get,Vet,qet,Het,Wet,Zet,Jet,Yet,Ket,Qet,Xet,tit,eit,iit,nit,sit,rit,oit,ait,lit,uit,cit,hit,dit,fit,pit,mit,yit,git,vit,wit,bit,Sit,_it,xit,Mit,Tit,Ait,Iit,kit,Cit,Eit,jit,Oit,Rit,Lit,Nit,Pit,Fit,Dit,$it,zit,Uit,Bit;!function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN"}(Net||(Net={})),function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(Pet||(Pet={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(Fet||(Fet={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(Det||(Det={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}($et||($et={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(zet||(zet={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(Uet||(Uet={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}(Bet||(Bet={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(Get||(Get={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}(Vet||(Vet={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(qet||(qet={})),function(t){t.Linear="Linear",t.EaseIn="EaseIn",t.EaseOut="EaseOut",t.EaseInOut="EaseInOut"}(Het||(Het={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(Wet||(Wet={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(Zet||(Zet={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(Jet||(Jet={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(Yet||(Yet={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(Ket||(Ket={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(Qet||(Qet={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(Xet||(Xet={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(tit||(tit={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(eit||(eit={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees",t.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",t.ConcentricCircles="ConcentricCircles",t.DoubleJogArrow="DoubleJogArrow",t.LinkedChevrons="LinkedChevrons",t.SegmentThenHalfCircle="SegmentThenHalfCircle",t.LineWithStraightTicks="LineWithStraightTicks",t.DoubleCurve="DoubleCurve",t.ParallelWithTicksByWidth="ParallelWithTicksByWidth",t.EnclosingRoundedRectangle="EnclosingRoundedRectangle"}(iit||(iit={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(nit||(nit={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(sit||(sit={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(rit||(rit={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(oit||(oit={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}(ait||(ait={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(lit||(lit={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(uit||(uit={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(cit||(cit={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(hit||(hit={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(dit||(dit={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(fit||(fit={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AloneLine=1]="AloneLine"}(pit||(pit={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(mit||(mit={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(yit||(yit={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(git||(git={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(vit||(vit={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(wit||(wit={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(bit||(bit={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(Sit||(Sit={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}(_it||(_it={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(xit||(xit={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}(Mit||(Mit={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(Tit||(Tit={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(Ait||(Ait={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(Iit||(Iit={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}(kit||(kit={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(Cit||(Cit={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(Eit||(Eit={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(jit||(jit={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(Oit||(Oit={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(Rit||(Rit={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(Lit||(Lit={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(Nit||(Nit={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(Pit||(Pit={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(Fit||(Fit={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(Dit||(Dit={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}($it||($it={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(zit||(zit={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(Uit||(Uit={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(Bit||(Bit={}));const Git={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},Vit={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:qet.Loop,repeatdelay:0,easing:Het.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0},CIMSymbolAnimationOffset:{offsetx:0,offsety:0}};function qit(t){return[t.r,t.g,t.b,t.a]}const Hit=" /-,\n";function Wit(t){let e=t.length;for(;e--;)if(!Hit.includes(t.charAt(e)))return!1;return!0}function Zit(t,e){const i=[];let n=0,s=-1;do{if(s=t.indexOf("[",n),s>=n){if(s>n){const e=t.slice(n,s);i.push([e,null,Wit(e)])}if(n=s+1,s=t.indexOf("]",n),s>=n){if(s>n){const r=e[t.slice(n,s)];r&&i.push([null,r,!1])}n=s+1}}}while(-1!==s);if(n<t.length){const e=t.slice(n);i.push([e,null,Wit(e)])}return i}function Jit(t,e,i,n){let s="",r=null;for(const n of e){const[e,o,a]=n;if(e)a?r=e:(r&&(s+=r,r=null),s+=e);else{let e=o;null!=i&&(e=jnt(o,i));const n=t.attributes[e];n&&(r&&(s+=r,r=null),s+=n)}}return Yit(s,n)}function Yit(t,e){switch("string"!=typeof t&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function Kit(t,e,i,n,s,r,o=!0){const a=e/s,l=i/r,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let i=0;i<r;i++)for(let h=0;h<s;h++){const d=4*(h+(o?r-i-1:i)*s);let f=0,p=0,m=0,y=0,g=0,v=0,w=0;const b=(i+.5)*l;for(let n=Math.floor(i*l);n<(i+1)*l;n++){const i=Math.abs(b-(n+.5))/c,s=(h+.5)*a,r=i*i;for(let i=Math.floor(h*a);i<(h+1)*a;i++){let o=Math.abs(s-(i+.5))/u;const a=Math.sqrt(r+o*o);a>=-1&&a<=1&&(f=2*a*a*a-3*a*a+1,f>0&&(o=4*(i+n*e),w+=f*t[o+3],m+=f,t[o+3]<255&&(f=f*t[o+3]/250),y+=f*t[o],g+=f*t[o+1],v+=f*t[o+2],p+=f))}}n[d]=y/p,n[d+1]=g/p,n[d+2]=v/p,n[d+3]=w/m}}function Qit(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function Xit(t){return t.data?.symbol??null}function tnt(t){return"CIMVectorMarker"===t.type||"CIMPictureMarker"===t.type||"CIMBarChartMarker"===t.type||"CIMCharacterMarker"===t.type||"CIMPieChartMarker"===t.type||"CIMStackedBarChartMarker"===t.type}function ent(t){return"CIMGradientStroke"===t.type||"CIMPictureStroke"===t.type||"CIMSolidStroke"===t.type}function int(t){return null!=t&&("CIMGradientFill"===t.type||"CIMHatchFill"===t.type||"CIMPictureFill"===t.type||"CIMSolidFill"===t.type||"CIMWaterFill"===t.type)}function nnt(t){return null!=t&&("CIMMarkerPlacementAlongLineRandomSize"===t.type||"CIMMarkerPlacementAlongLineSameSize"===t.type||"CIMMarkerPlacementAlongLineVariableSize"===t.type||"CIMMarkerPlacementAtExtremities"===t.type||"CIMMarkerPlacementAtMeasuredUnits"===t.type||"CIMMarkerPlacementAtRatioPositions"===t.type||"CIMMarkerPlacementOnLine"===t.type||"CIMMarkerPlacementOnVertices"===t.type)}const snt=(t,e=0)=>null==t||isNaN(t)?e:t,rnt=(t,e)=>null!=t?t:e,ont=(t,e)=>t??e,ant=t=>t.tintColor?Qit(t.tintColor):[255,255,255,1],lnt=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function unt(){return import("./p-a9020a78.js")}function cnt(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function hnt(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function dnt(t){let e="normal",i="normal";if(t){const n=t.toLowerCase();n.includes("italic")?e="italic":n.includes("oblique")&&(e="oblique"),n.includes("bold")?i="bold":n.includes("light")&&(i="lighter")}return{style:e,weight:i}}function fnt(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function pnt(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=pnt(e);if(null!=t)return t}break;case"CIMTextSymbol":return pnt(t.symbol);case"CIMSolidFill":return t.color}return null}function mnt(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const t of e){const e=mnt(t);if(null!=e)return e}break}case"CIMTextSymbol":return mnt(t.symbol);case"CIMSolidStroke":return t.color}}function ynt(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=ynt(e);if(void 0!==t)return t}break;case"CIMTextSymbol":return ynt(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function gnt(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function vnt(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function wnt(t){return(t?Object.keys(t):[]).map((e=>({name:e,alias:e,type:"string"==typeof t[e]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const bnt=t=>t.includes("data:image/svg+xml");function Snt(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function _nt(t){return t?t.charAt(0).toLowerCase()+t.slice(1):t}function xnt(t,e,i,n,s,r,o=!0){const{infos:a}=r;let l=1,u=0,c=0,h=0,d=1;for(const{absoluteAnchorPoint:t,offsetX:e,offsetY:i,rotation:n,size:s,frameHeight:r,rotateClockWise:f,scaleSymbolsProportionally:p}of a){d=t?1:l;c=Nnt(e,i,u,d,c),h=Lnt(e,i,u,d,h),r&&(p||o)&&(l*=s/r),u=Pnt(n,f,u)}const f=Nnt(n,s,u,d,c),p=Lnt(n,s,u,d,h);return{size:t*l,rotation:Pnt(e,i,u),offsetX:f,offsetY:p}}function Mnt(t){if(null==t)return!1;if(Array.isArray(t))return t.every((t=>Mnt(t)));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function Tnt(t,e){if("color"===e||"outlinecolor"===e||"backgroundcolor"===e||"borderlinecolor"===e||"tintcolor"===e)return[...Git[e]];const i=Vit[t];if(!i)throw new Error(`InternalError: default value for type ${t}.`);return i[e]}function Ant(t){return t.split(" ").map((t=>Number(t)))}function Int(t){return"string"==typeof t?Ant(t):t}function knt(t){return t?.dashTemplate&&(t.dashTemplate=Int(t.dashTemplate)),t}function Cnt(t){if(null==t)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const t of e)if("CIMVectorMarker"===t.type)return Cnt(t)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const t of e)if(t.symbol)return Cnt(t.symbol)}}return"Normal"}function Ent(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers)for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const t=i.size??Vit.CIMVectorMarker.size;t>e&&(e=t);break}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers)for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const t=i.width;null!=t&&t>e&&(e=t);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(i.markerPlacement&&nnt(i.markerPlacement)){const t=i.size??Vit.CIMVectorMarker.size;t>e&&(e=t)}break;case"CIMPictureFill":{const t=i.height;null!=t&&t>e&&(e=t)}}return e}}}function jnt(t,e){if(null!==e){const i=e.get(t);return i?i.name:t}return t}function Ont(t){return t.map((t=>({...t,propertyName:_nt(t.propertyName)})))}function Rnt(t){const e={};for(const i in t){const n=t[i];e[_nt(i)]=n}return e}function Lnt(t,e,i,n,s){const r=i*Math.PI/180;if(r){const i=Math.cos(r);return(Math.sin(r)*t+i*e)*n+s}return e*n+s}function Nnt(t,e,i,n,s){const r=i*Math.PI/180;if(r){return(Math.cos(r)*t-Math.sin(r)*e)*n+s}return t*n+s}function Pnt(t,e,i){return e?i-t:i+t}function Fnt(t,e,i){const n="Color"===i||"TintColor"===i||"ToColor"===i,s="Rotation"===i||"Angle"===i||"ToRotation"===i;let r=e[_nt(i)];if(null!=r&&(n?r=[r[0]/255,r[1]/255,r[2]/255,r[3]/255]:s&&(r*=Math.PI/180)),null==r&&(r=Tnt(e.type,i.toLowerCase()),null!=r&&(n?r=[r[0]/255,r[1]/255,r[2]/255,r[3]]:s&&(r*=Math.PI/180))),null!=e.primitiveName){const o=t[e.primitiveName];if(null!=o){const t=o[i];null==t||("string"==typeof t||"number"==typeof t||Array.isArray(t)?(r=t,null!=r&&(n?r=[r[0]/255,r[1]/255,r[2]/255,r[3]/255]:s&&(r*=Math.PI/180))):(r={valueExpressionInfo:t,defaultValue:r},null!=r&&(n?r={type:"Process",op:"ArcadeColor",value:r}:s&&(r={type:"Process",op:"Divide",left:r,right:180/Math.PI}))))}}if(null==r)throw new Error(`Failed to derive a value or an expression for "${i}".`);return r}function Dnt(t){if(!t)return null;return{originPosition:"upper-left"===t.originPosition?"upperLeft":"lower-left"===t.originPosition?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance,1,1]:[1,1,1,1],translate:null!=t.extent?[t.extent.xmin,t.extent.ymax,t.extent.zmin??0,t.extent.mmin??0]:[0,0,0,0]}}function $nt(t){return"lowerLeft"===t.originPosition&&4===t.scale.length&&4===t.translate.length}function znt(t){if($nt(t))return t;const{originPosition:e,scale:i,translate:n}=t,s=i[0]??1,r=i[1]??1;return{originPosition:"lowerLeft",scale:[s,"lowerLeft"===e?r:-r,i[2]??1,i[3]??1],translate:[n[0]??0,n[1]??0,n[2]??0,n[3]??0]}}function Unt({scale:t,translate:e},i){return Math.round((i-e[0])/t[0])}function Bnt({scale:t,translate:e},i){return Math.round((i-e[1])/t[1])}function Gnt({scale:t,translate:e},i){return Math.round(((i??0)-e[2])/t[2])}function Vnt({scale:t,translate:e},i){return i?Math.round((i-e[3])/t[3]):0}function qnt({scale:t,translate:e},i){return i*t[0]+e[0]}function Hnt({scale:t,translate:e},i){return i*t[1]+e[1]}function Wnt({scale:t,translate:e},i){return(i??0)*t[2]+e[2]}function Znt({scale:t,translate:e},i){return i?i*t[3]+e[3]:0}function Jnt(t,e){return t&&e?Xnt:t&&!e?Knt:!t&&e?Qnt:Ynt}const Ynt=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const n=e[0];let s=qnt(t,n[0]),r=Hnt(t,n[1]);i[0]=[s,r];const{scale:o,originPosition:a}=t,l=o[0],u="lowerLeft"===a?o[1]:-o[1];for(let t=1;t<e.length;t++){const[n,o]=e[t];s+=l*n,r+=u*o,i[t]=[s,r]}return i},Knt=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const n=e[0];let s=qnt(t,n[0]),r=Hnt(t,n[1]);i[0]=[s,r,Wnt(t,n[2])];const{scale:o,originPosition:a}=t,l=o[0],u="lowerLeft"===a?o[1]:-o[1];for(let n=1;n<e.length;n++){const[o,a,c]=e[n];s+=l*o,r+=u*a,i[n]=[s,r,Wnt(t,c)]}return i},Qnt=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const n=e[0];let s=qnt(t,n[0]),r=Hnt(t,n[1]);i[0]=[s,r,Znt(t,n[2])];const{scale:o,originPosition:a}=t,l=o[0],u="lowerLeft"===a?o[1]:-o[1];for(let n=1;n<e.length;n++){const[o,a,c]=e[n];s+=l*o,r+=u*a,i[n]=[s,r,Znt(t,c)]}return i},Xnt=(t,e)=>{const i=new Array(e.length);if(!e.length)return i;const n=e[0];let s=qnt(t,n[0]),r=Hnt(t,n[1]);i[0]=[s,r,Wnt(t,n[2]),Znt(t,n[3])];const{scale:o,originPosition:a}=t,l=o[0],u="lowerLeft"===a?o[1]:-o[1];for(let n=1;n<e.length;n++){const[o,a,c,h]=e[n];s+=l*o,r+=u*a,i[n]=[s,r,Wnt(t,c),Znt(t,h)]}return i};function tst(t,e,i){const n=new Array(i.length);for(let s=0;s<i.length;s++)n[s]=e(t,i[s]);return n}function est(t,e,i){const n=znt(t);return e.x=Unt(n,i.x),e.y=Bnt(n,i.y),null!=i.z&&(e.z=Gnt(n,i.z)),null!=i.m&&(e.m=Vnt(n,i.m)),e}function ist(t,e,i,n=i?.hasZ??!1,s=i?.hasM??!1){if(null!=i){const r=znt(t);e.points=Jnt(n,s)(r,i.points),e.hasZ=n,e.hasM=s}return e}function nst(t,e,i,n=null!=i?.z,s=null!=i?.m){if(null==i)return e;const r=znt(t);return e.x=qnt(r,i.x),e.y=Hnt(r,i.y),n&&(e.z=Wnt(r,i.z)),s&&(e.m=Znt(r,i.m)),e}function sst(t,e,i,n=i?.hasZ??!1,s=i?.hasM??!1){if(null!=i){const r=znt(t);e.rings=tst(r,Jnt(n,s),i.rings),e.hasZ=n,e.hasM=s}return e}function rst(t,e,i,n=i?.hasZ??!1,s=i?.hasM??!1){if(null!=i){const r=znt(t);e.paths=tst(r,Jnt(n,s),i.paths),e.hasZ=n,e.hasM=s}return e}function ost(t,e,i,n,s){if(null==t)return null;const r=t.referencesGeometry()&&s?lst(e,n,s):e,o=t.repurposeFeature(r);try{return t.evaluate({...i,$feature:o},t.services)}catch(t){return jt.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",t),null}}const ast=new Map;function lst(t,e,i){const{transform:n,hasZ:s,hasM:r}=i;ast.has(e)||ast.set(e,ust(e));const o=ast.get(e)(t.geometry,n,s,r);return{...t,geometry:o}}function ust(t){const e={};switch(t){case"esriGeometryPoint":return(t,i,n,s)=>nst(i,e,t,n,s);case"esriGeometryPolygon":return(t,i,n,s)=>sst(i,e,t,n,s);case"esriGeometryPolyline":return(t,i,n,s)=>rst(i,e,t,n,s);case"esriGeometryMultipoint":return(t,i,n,s)=>ist(i,e,t,n,s);default:return jt.getLogger("esri.views.2d.support.arcadeOnDemand").error(new Ve("mapview-arcade",`Unable to handle geometryType: ${t}`)),t=>t}}const cst=t=>{if(!t)return[0,0,0,0];const{r:e,g:i,b:n,a:s}=t;return[e,i,n,255*s]};class hst{static findApplicableOverrides(t,e,i){if(t&&e){if(t.primitiveName){let n=!1;for(const e of i)if(e.primitiveName===t.primitiveName){n=!0;break}if(!n)for(const n of e)n.primitiveName===t.primitiveName&&i.push(n)}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const n of t.effects)hst.findApplicableOverrides(n,e,i);if(t.symbolLayers)for(const n of t.symbolLayers)hst.findApplicableOverrides(n,e,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(t.effects)for(const n of t.effects)hst.findApplicableOverrides(n,e,i);if(t.markerPlacement&&hst.findApplicableOverrides(t.markerPlacement,e,i),"CIMVectorMarker"===t.type){if(t.markerGraphics)for(const n of t.markerGraphics)hst.findApplicableOverrides(n,e,i),hst.findApplicableOverrides(n.symbol,e,i)}else"CIMCharacterMarker"===t.type?hst.findApplicableOverrides(t.symbol,e,i):"CIMHatchFill"===t.type?hst.findApplicableOverrides(t.lineSymbol,e,i):"CIMPictureMarker"===t.type&&hst.findApplicableOverrides(t.animatedSymbolProperties,e,i)}}}static findEffectOverrides(t,e){if(!t)return null;if("CIMGeometricEffectDashes"===t.type&&knt(t),!e||!t.primitiveName)return{type:"cim-effect-param",effect:t,overrides:[]};const i=Rnt(t),n=t.primitiveName,s=[];for(const t of e)t.primitiveName===n&&s.push(Rnt(t));return{type:"cim-effect-param",effect:i,overrides:Ont(s)}}static async resolveSymbolOverrides(t,e,i,n,s,r,o){if(!t?.symbol)return null;let{symbol:a,primitiveOverrides:l}=t;const u=!!l;if(!u&&!n)return a;a=nt(a),l=nt(l);let c=!0;if(e||(e={attributes:{}},c=!1),u){if(c||(l=l.filter((t=>!t.valueExpressionInfo?.expression.includes("$feature")))),o||(l=l.filter((t=>!t.valueExpressionInfo?.expression.includes("$view")))),l.length>0){const t={spatialReference:i,fields:wnt(e.attributes),geometryType:s};await hst.createRenderExpressions(l,t),hst.evaluateOverrides(l,e,s??"esriGeometryPoint",r,o)}hst.applyOverrides(a,l)}return n&&hst.applyDictionaryTextOverrides(a,e,n,null),a}static async createRenderExpressions(t,e){const i=[];for(const n of t){const t=n.valueExpressionInfo;if(!t||hst._expressionToRenderExpression.has(t.expression))continue;const s=FE(t.expression,e.spatialReference,e.fields);i.push(s),s.then((e=>hst._expressionToRenderExpression.set(t.expression,e)))}i.length>0&&await Promise.all(i)}static evaluateOverrides(t,e,i,n,s){const r={$view:{scale:s?.scale}};for(const s of t){s.value&&"object"==typeof s.value&&eet(s.value)&&("Color"===s.propertyName||"StrokeColor"===s.propertyName)&&(s.value=cst(s.value));const t=s.valueExpressionInfo;if(!t)continue;const o=hst._expressionToRenderExpression.get(t.expression);o&&(s.value=ost(o,e,r,i,n))}}static applyDictionaryTextOverrides(t,e,i,n,s="Normal"){if(t?.type)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const r=t.symbolLayers;if(!r)return;for(const o of r)o&&"CIMVectorMarker"===o.type&&hst.applyDictionaryTextOverrides(o,e,i,n,"CIMTextSymbol"===t.type?t.textCase:s)}break;case"CIMVectorMarker":{const s=t.markerGraphics;if(!s)return;for(const t of s)t&&hst.applyDictionaryTextOverrides(t,e,i,n)}break;case"CIMMarkerGraphic":{const r=t.textString;if(r&&r.includes("[")){const o=Zit(r,i);t.textString=Jit(e,o,n,s)}}}}static applyOverrides(t,e,i,n){if(t.primitiveName)for(const s of e)if(s.primitiveName===t.primitiveName){const e=_nt(s.propertyName);if(n&&n.push({cim:t,nocapPropertyName:e,value:t[e]}),i){let e=!1;for(const n of i)n.primitiveName===t.primitiveName&&(e=!0);e||i.push(s)}null!=s.value&&(t[e]=s.value)}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const s of t.effects)hst.applyOverrides(s,e,i,n);if(t.symbolLayers)for(const s of t.symbolLayers)hst.applyOverrides(s,e,i,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(t.effects)for(const s of t.effects)hst.applyOverrides(s,e,i,n);if("CIMVectorMarker"===t.type&&t.markerGraphics)for(const s of t.markerGraphics)hst.applyOverrides(s,e,i,n),hst.applyOverrides(s.symbol,e,i,n)}}static restoreOverrides(t){for(const e of t)e.cim[e.nocapPropertyName]=e.value}static buildOverrideKey(t){let e="";for(const i of t)void 0!==i.value&&(e+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return e}static toValue(t,e){if("DashTemplate"===t)return e.split(" ").map((t=>Number(t)));if("Color"===t){const t=new RA(e).toRgba();return t[3]*=255,t}return e}}hst._expressionToRenderExpression=new Map;const dst="esri.renderers.support.DictionaryLoader",fst={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};class pst{constructor(t,e,i){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new B7(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=t,this.config=e,this.fieldMap=i}getSymbolFields(){return this._symbolFields}async getSymbolAsync(t,e){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(e));try{i=await this._dictionaryPromise}catch(t){if(Es(t))return this._dictionaryPromise=null,null}const n=this._dictionaryVersion?.greaterEqual(4,0),s={};if(this.fieldMap)for(const e of this._symbolFields){const i=jnt(this.fieldMap[e],this._fieldIndex);if(i){const r=t.attributes[i];s[e]=n?r:null!=r?""+t.attributes[i]:""}else s[e]=""}let r=null;try{r=i?.(s,e)}catch(t){return null}if(!r||"string"!=typeof r||"invalid"===r)return null;const o=r.split(";"),a=[],l=[];for(let e=0;e<o.length;e++){const i=o[e];if(i)if(i.includes("po:")){const e=i.slice(3).split("|");if(3===e.length){const i=e[0],n=e[1];let s=e[2];const r="countrylabel";if(i===r&&"TextString"===n){if(null!=this.fieldMap){let e=this.fieldMap[r];null==e&&(e=r,this.fieldMap[e]=e),t.attributes[e]=s}continue}if("DashTemplate"===n)s=s.split(" ").map((t=>Number(t)));else if("Color"===n){const t=new RA(s).toRgba();s=[t[0],t[1],t[2],255*t[3]]}else s=Number(s);l.push({primitiveName:i,propertyName:n,value:s,defaultValue:null})}}else if(i.includes("|")){for(const t of i.split("|"))if(this._itemNames.has(t)){a.push(t);break}}else if(this._itemNames.has(i))a.push(i);else if(0===e){a.length=0;let e="Invalid_P";null!=t.geometry&&(sm(t.geometry)?e="Invalid_A":nm(t.geometry)&&(e="Invalid_L")),a.push(e);break}}const u=null==t.geometry||!t.geometry.hasZ&&"point"===t.geometry.type;return this._cimPartsToCIMSymbol(t,a,l,u,e)}async fetchResources(t){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void jt.getLogger(dst).error("no valid URL!");const e=Pl(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:null!=t?t.signal:null}),[{data:i}]=await Promise.all([e,PE()]);if(!i)throw this._dictionaryPromise=null,new Ve("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:s,expression:r,itemsNames:o}=i,a=r;let l=!1;s&&(this._dictionaryVersion=T5.parse(s),l=this._dictionaryVersion.greaterEqual(4,0)),this._refSymbolUrlTemplate=this.url+"/"+i.cimRefTemplateUrl,this._itemNames=new Set(o),this._symbolFields=n.symbol;const u={};if(this.config){const t=this.config;for(const e in t)u[e]=t[e]}if(n.configuration)for(const t of n.configuration)u.hasOwnProperty(t.name)||(u[t.name]=t.value);const c=[];if(t?.fields&&this.fieldMap)for(const e in this.fieldMap){const i=this.fieldMap[e],n=t.fields.filter((t=>t.name.toLowerCase()===i?.toLowerCase()));n.length>0&&c.push({...n[0],type:l?n[0].type:"esriFieldTypeString"})}c.length>0&&(this._fieldIndex=new Y7(c));const h=DE(a,null!=t?t.spatialReference:null,c,u).then((t=>{const e={scale:0};return(i,n)=>{if(null==t)return null;const s=t.repurposeFeature({geometry:null,attributes:i});return e.scale=null!=n?n.scale??void 0:void 0,t.evaluate({$feature:s,$view:e},t.services)}})).catch((t=>(jt.getLogger(dst).error("Creating dictionary expression failed:",t),null)));return this._dictionaryPromise=h,h}async _cimPartsToCIMSymbol(t,e,i,n,s){const r=new Array(e.length);for(let t=0;t<e.length;t++)r[t]=this._getSymbolPart(e[t],s);let o=await Promise.all(r);const a=this.fieldMap;if(a){o=nt(o);for(const e of o)hst.applyDictionaryTextOverrides(e,t,a,this._fieldIndex,Cnt(e))}return new aL({data:mst(o,i,n)})}async _getSymbolPart(t,e){const i=this._symbolCache.get(t);if(i)return i;if(this._ongoingRequests.has(t))return this._ongoingRequests.get(t).then((t=>t.data));const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,t),s=Pl(n,{responseType:"json",query:{f:"json"},...e});this._ongoingRequests.set(t,s),s.finally((()=>this._ongoingRequests.delete(t)));try{const e=await s;return this._symbolCache.put(t,e.data),e.data}catch(t){throw t}}}function mst(t,e,i){if(!t||0===t.length)return null;const n={...t[0]};if(t.length>1){n.effects=null,n.symbolLayers=[];for(const e of t){const t=e;if(null!=t.effects)for(const e of t.symbolLayers)null==e.effects?e.effects=t.effects:e.effects.unshift(...t.effects);n.symbolLayers.unshift(...t.symbolLayers)}}return i&&(n.callout=fst),{type:"CIMSymbolReference",symbol:n,primitiveOverrides:e}}var yst;let gst=yst=class extends(G9(S8)){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new pst(this.url,this.config,this.fieldMap)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,n){n?.origin||super.writeVisualVariables(t,e,i,n)}clone(){return new yst({config:nt(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:nt(this.fieldMap),url:nt(this.url),visualVariables:nt(this.visualVariables)})}async getSymbolAsync(t,e){return this._loader.getSymbolAsync(t,e)}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await tj(t,e,this.scaleExpression);for(const i in this.fieldMap){const n=this.fieldMap[i];e.has(n)&&t.add(n)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};r([Je({type:pst})],gst.prototype,"_loader",null),r([Je({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],gst.prototype,"config",void 0),r([Je({type:Object,json:{write:!0}})],gst.prototype,"fieldMap",void 0),r([Je({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],gst.prototype,"scaleExpression",void 0),r([yh("scaleExpression")],gst.prototype,"writeData",null),r([Je({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],gst.prototype,"scaleExpressionTitle",void 0),r([Je({type:String,json:{write:!0}})],gst.prototype,"url",void 0),r([yh("visualVariables")],gst.prototype,"writeVisualVariables",null),gst=yst=r([ln("esri.renderers.DictionaryRenderer")],gst);const vst=gst;var wst;let bst=wst=class extends Io{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return null==t?t:"function"==typeof t?(jt.getLogger(this).error(".field: field must be a string value"),null):zt(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new wst({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};r([Je({type:RA,json:{type:[Number],write:!0}})],bst.prototype,"color",void 0),r([Je({type:String,json:{write:!0}})],bst.prototype,"field",void 0),r([Ah("field")],bst.prototype,"castField",null),r([Je({type:String,json:{write:!0}})],bst.prototype,"label",void 0),r([Je({type:String,json:{write:!0}})],bst.prototype,"valueExpression",void 0),r([Je({type:String,json:{write:!0}})],bst.prototype,"valueExpressionTitle",void 0),bst=wst=r([ln("esri.renderers.support.AttributeColorInfo")],bst);const Sst=bst;var _st;let xst=_st=class extends Io{constructor(){super(...arguments),this.unit=null}clone(){return new _st({unit:this.unit})}};r([Je({type:String,json:{write:!0}})],xst.prototype,"unit",void 0),xst=_st=r([ln("esri.renderers.support.DotDensityLegendOptions")],xst);const Mst=xst;var Tst;let Ast=Tst=class extends(G9(S8)){constructor(t){super(t),this.attributes=null,this.backgroundColor=new RA([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new DL,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(null==this.referenceScale)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new sD({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new Tst({attributes:nt(this.attributes),backgroundColor:nt(this.backgroundColor),dotBlendingEnabled:nt(this.dotBlendingEnabled),dotShape:nt(this.dotShape),dotSize:nt(this.dotSize),dotValue:nt(this.dotValue),legendOptions:nt(this.legendOptions),outline:nt(this.outline),referenceScale:nt(this.referenceScale),seed:nt(this.seed),visualVariables:nt(this.visualVariables),authoringInfo:nt(this.authoringInfo)})}getControllerHash(){const t=this.attributes?.map((t=>t.field||t.valueExpression||""));return`${t}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes??[])i.valueExpression&&await tj(t,e,i.valueExpression),i.field&&t.add(i.field)}};r([Je({type:[Sst],json:{write:!0}})],Ast.prototype,"attributes",void 0),r([Je({type:RA,json:{write:!0}})],Ast.prototype,"backgroundColor",void 0),r([Je({type:Boolean,json:{write:!0}})],Ast.prototype,"dotBlendingEnabled",void 0),r([Je({type:String,json:{write:!1}})],Ast.prototype,"dotShape",void 0),r([Je({type:Number,json:{write:!0}})],Ast.prototype,"dotSize",void 0),r([Je({type:Mst,json:{write:!0}})],Ast.prototype,"legendOptions",void 0),r([Je({type:DL,json:{default:null,write:!0}})],Ast.prototype,"outline",void 0),r([Je({type:Number,json:{write:!0}})],Ast.prototype,"dotValue",void 0),r([Je({type:Number,json:{write:!0}})],Ast.prototype,"referenceScale",void 0),r([Je({type:Number,json:{write:!0}})],Ast.prototype,"seed",void 0),r([NA({dotDensity:"dot-density"})],Ast.prototype,"type",void 0),Ast=Tst=r([ln("esri.renderers.DotDensityRenderer")],Ast);const Ist=Ast;var kst;let Cst=kst=class extends Io{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new kst({color:this.color&&this.color.clone(),ratio:this.ratio})}};r([Je({type:RA,json:{type:[ce],default:null,write:!0}})],Cst.prototype,"color",void 0),r([Je({type:Number,json:{write:!0}})],Cst.prototype,"ratio",void 0),Cst=kst=r([ln("esri.renderers.support.HeatmapColorStop")],Cst);const Est=Cst;let jst=class extends(cm(Io)){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};r([Je({type:String,json:{write:!0}})],jst.prototype,"minLabel",void 0),r([Je({type:String,json:{write:!0}})],jst.prototype,"maxLabel",void 0),r([Je({type:String,json:{write:!0}})],jst.prototype,"title",void 0),jst=r([ln("esri.renderers.support.HeatmapLegendOptions")],jst);const Ost=2.4;function Rst(t){return XA(t*Ost)}function Lst(t){return QA(t)/Ost}function Nst(t,e,i,n){let{color:s,ratio:r}=e,{color:o,ratio:a}=i;if(a===r){const t=1e-6;1===a?r-=t:a+=t}const l=wf((n-r)/(a-r),0,1);xtt(t,s.toArray(),o.toArray(),l)}function Pst(t){const e=512,i=new Uint8ClampedArray(4*e);if(t=t.filter((({ratio:t})=>t>=0&&t<=1)).sort(((t,e)=>t.ratio-e.ratio)).map((({color:t,ratio:e})=>({color:t,ratio:Math.max(e,.001)}))),t.length<1)return i;let n=t[0],s=t[0],r=1;const o=Ftt();for(let a=0;a<e;a++){const l=(a+.5)/e;for(;l>s.ratio&&r<t.length;)n=s,s=t[r++];Nst(o,n,s,l),i.set(o,4*a)}return i}function Fst(t,e,i){const n=Math.sqrt(t**2+e**2)/i;return n>1?0:3/(Math.PI*i**2)*(1-n**2)**2}function Dst(t){return"function"==typeof t?t:t?e=>+e[t]:()=>1}var $st;function zst(t){if(null!=t){const{maxDensity:e,minDensity:i,radius:n}=t;if(null!=e||null!=i||null!=n){const{blurRadius:e,maxPixelIntensity:i,minPixelIntensity:n,...s}=t;return s}}return t}let Ust=$st=class extends S8{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new Est({ratio:0,color:new RA("rgba(255, 140, 0, 0)")}),new Est({ratio:.75,color:new RA("rgba(255, 140, 0, 1)")}),new Est({ratio:.9,color:new RA("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(t){return zst(t)}get blurRadius(){return Lst(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",Rst(t)),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(Ost**2*this.blurRadius**4)}read(t,e){t=zst(t),super.read(t,e)}getSymbol(){return new lD}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const i=this.field,n=this.valueExpression;i&&"string"==typeof i&&KE(t,e,i),n&&"string"==typeof n&&await tj(t,e,n)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new $st({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:nt(this.colorStops),field:this.field,legendOptions:nt(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};r([Je({type:v8,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Ust.prototype,"authoringInfo",void 0),r([Je({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Ust.prototype,"blurRadius",null),r([Je({type:[Est],json:{write:!0}})],Ust.prototype,"colorStops",void 0),r([Je({type:String,json:{write:!0}})],Ust.prototype,"field",void 0),r([Je({type:jst,json:{write:!0}})],Ust.prototype,"legendOptions",void 0),r([Je({type:Number,json:{write:!0}})],Ust.prototype,"maxDensity",void 0),r([Je({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Ust.prototype,"maxPixelIntensity",null),r([Je({type:Number,json:{write:!0}})],Ust.prototype,"minDensity",void 0),r([Je({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Ust.prototype,"minPixelIntensity",null),r([Je({type:Number,cast:tI,json:{write:!0}})],Ust.prototype,"radius",void 0),r([Je({type:Number,range:{min:0},json:{default:0,write:!0}})],Ust.prototype,"referenceScale",void 0),r([NA({heatmap:"heatmap"})],Ust.prototype,"type",void 0),r([Je({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],Ust.prototype,"valueExpression",void 0),r([Je({type:String})],Ust.prototype,"valueExpressionTitle",void 0),r([Je({readOnly:!0})],Ust.prototype,"_pixelIntensityToDensity",null),Ust=$st=r([ln("esri.renderers.HeatmapRenderer")],Ust);const Bst=Ust;let Gst=class extends(cm(Io)){constructor(){super(...arguments),this.color=new RA([0,0,0,0]),this.label=null,this.threshold=0}};r([Je({type:RA,json:{write:!0}})],Gst.prototype,"color",void 0),r([Je({type:String,json:{write:!0}})],Gst.prototype,"label",void 0),r([Je({type:Number,range:{min:0,max:1},json:{write:!0}})],Gst.prototype,"threshold",void 0),Gst=r([ln("esri.renderers.support.OthersCategory")],Gst);const Vst={base:k8,key:"type",typeMap:{size:P9,opacity:z8}};let qst=class extends(G9(cm(S8))){constructor(t){super(t),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new RA([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Gst,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new lD({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(C)}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){return this.getSymbols().reduce(((t,e)=>t+JSON.stringify(e)),"")}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes)i.valueExpression&&await tj(t,e,i.valueExpression),i.field&&t.add(i.field)}};r([Je({type:[Sst],json:{write:!0}})],qst.prototype,"attributes",void 0),r([Je(S7)],qst.prototype,"backgroundFillSymbol",void 0),r([Je({type:RA,json:{write:!0}})],qst.prototype,"defaultColor",void 0),r([Je({type:String,json:{write:!0}})],qst.prototype,"defaultLabel",void 0),r([Je({type:Number,range:{min:0,max:1},json:{write:!0}})],qst.prototype,"holePercentage",void 0),r([Je({type:Gst,json:{write:!0}})],qst.prototype,"othersCategory",void 0),r([Je({type:k7,json:{write:!0}})],qst.prototype,"legendOptions",void 0),r([Je({type:DL,json:{default:null,write:!0}})],qst.prototype,"outline",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],qst.prototype,"size",void 0),r([NA({pieChart:"pie-chart"})],qst.prototype,"type",void 0),r([Je({types:[Vst]})],qst.prototype,"visualVariables",void 0),qst=r([ln("esri.renderers.PieChartRenderer")],qst);const Hst=qst;var Wst;let Zst=Wst=class extends(G9(S8)){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.getSymbols().map((i=>i.collectRequiredFields(t,e))))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){return this.getSymbols().reduce(((t,e)=>t+JSON.stringify(e)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new Wst({description:this.description,label:this.label,symbol:nt(this.symbol),visualVariables:nt(this.visualVariables),authoringInfo:nt(this.authoringInfo)})}};r([Je({type:String,json:{write:!0}})],Zst.prototype,"description",void 0),r([Je({type:String,json:{write:!0}})],Zst.prototype,"label",void 0),r([Je(b7)],Zst.prototype,"symbol",void 0),r([NA({simple:"simple"})],Zst.prototype,"type",void 0),Zst=Wst=r([ln("esri.renderers.SimpleRenderer")],Zst);const Jst=Zst;const Yst=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function Kst(t){return t instanceof ao}function Qst(t){return t instanceof Vm?Object.keys(t.items):Kst(t)?Me(t).keys():t?Object.keys(t):[]}function Xst(t,e){return t instanceof Vm?t.items[e]:t[e]}function trt(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function ert(t){return t?t.declaredClass:null}function irt(t,e){const i=t.diff;if(i&&"function"==typeof i)return i(t,e);const n=Qst(t),s=Qst(e);if(0===n.length&&0===s.length)return;if(!n.length||!s.length||trt(t,e))return{type:"complete",oldValue:t,newValue:e};const r=s.filter((t=>!n.includes(t))),o=n.filter((t=>!s.includes(t))),a=n.filter((i=>s.includes(i)&&Xst(t,i)!==Xst(e,i))).concat(r,o).sort(),l=ert(t);if(l&&Yst.has(l)&&a.length)return{type:"complete",oldValue:t,newValue:e};let u;const c=Kst(t)&&Kst(e);for(const n of a){const s=Xst(t,n),r=Xst(e,n);let o;if((c||"function"!=typeof s&&"function"!=typeof r)&&(s!==r&&(null!=s||null!=r))){if(i&&i[n]&&"function"==typeof i[n])o=i[n]?.(s,r);else if(s instanceof Date&&r instanceof Date){if(s.getTime()===r.getTime())continue;o={type:"complete",oldValue:s,newValue:r}}else o="object"==typeof s&&"object"==typeof r&&ert(s)===ert(r)?irt(s,r):{type:"complete",oldValue:s,newValue:r};null!=o&&(null!=u?u.diff[n]=o:u={type:"partial",diff:{[n]:o}})}}return u}function nrt(t,e){return srt(t,e)}function srt(t,e){if(null==t)return!1;const i=e.split(".");let n=t;for(const t of i){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;{const e=n.diff[t];if(!e)return!1;n=e}}return!0}function rrt(t,e){if(!t)return!1;if("partial"===t.type){const i=Object.keys(t.diff);return 1===i.length&&i[0]===e}return!1}function ort(t,e){if("function"!=typeof t&&"function"!=typeof e&&(null!=t||null!=e))return null==t||null==e||"object"==typeof t&&"object"==typeof e&&ert(t)!==ert(e)?{type:"complete",oldValue:t,newValue:e}:irt(t,e)}let art=class extends(cm(Io)){constructor(t){super(t),this.value=null,this.value2=null,this.value3=null}};r([Je(_7)],art.prototype,"value",void 0),r([Je(_7)],art.prototype,"value2",void 0),r([Je(_7)],art.prototype,"value3",void 0),art=r([ln("esri.renderers.support.UniqueValue")],art);const lrt=art;let urt=class extends(cm(Io)){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(t){if(null==t)return null;const e=typeof(t=Array.isArray(t)?t:[t])[0];return"string"===e||"number"===e?t.map((t=>new lrt({value:t}))):"object"===e?t[0]instanceof lrt?t:t.map((t=>new lrt(t))):null}};r([Je({type:String,json:{write:!0}})],urt.prototype,"description",void 0),r([Je({type:String,json:{write:!0}})],urt.prototype,"label",void 0),r([Je(w7)],urt.prototype,"symbol",void 0),r([Je({type:[lrt],json:{type:[[String]],read:{reader:t=>t?t.map((t=>new lrt({value:t[0],value2:t[1],value3:t[2]}))):null},write:{writer:(t,e)=>{const i=[];for(const e of t){const t=[e.value,e.value2,e.value3].filter(C).map((t=>t.toString()));i.push(t)}e.values=i}}}})],urt.prototype,"values",void 0),r([Ah("values")],urt.prototype,"castValues",null),urt=r([ln("esri.renderers.support.UniqueValueClass")],urt);const crt=urt;let hrt=class extends(cm(Io)){constructor(t){super(t),this.heading=null,this.classes=null}};r([Je({type:String,json:{write:!0}})],hrt.prototype,"heading",void 0),r([Je({type:[crt],json:{write:!0}})],hrt.prototype,"classes",void 0),hrt=r([ln("esri.renderers.support.UniqueValueGroup")],hrt);const drt=hrt;var frt;let prt=frt=class extends Io{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new frt({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${t}`}};r([Je({type:String,json:{write:!0}})],prt.prototype,"description",void 0),r([Je({type:String,json:{write:!0}})],prt.prototype,"label",void 0),r([Je(b7)],prt.prototype,"symbol",void 0),r([Je(_7)],prt.prototype,"value",void 0),prt=frt=r([ln("esri.renderers.support.UniqueValueInfo")],prt);const mrt=prt;const yrt=new Map;async function grt(t,e){try{return{data:(await xrt(t,e)).data,baseUrl:tl(t),styleUrl:t}}catch(t){return Ts(t),null}}function vrt(t,e,i){const n=null!=e.portal?e.portal:uT.getDefault();let s;const r=`${n.url} - ${n.user?.username} - ${t}`,o=yrt.get(r);if(o)return o;const a=wrt(t,n,i).then((t=>(s=t,t.fetchData()))).then((e=>({data:e,baseUrl:s.itemUrl??"",styleName:t})));return yrt.set(r,a),a}function wrt(t,e,i){return e.load(i).then((()=>{const n=new ZM({disableExtraQuery:!0,query:`owner:${Mrt} AND type:${Trt} AND typekeywords:"${t}"`});return e.queryItems(n,i)})).then((({results:e})=>{let n=null;const s=t.toLowerCase();if(e&&Array.isArray(e))for(const t of e){const e=t.typeKeywords?.some((t=>t.toLowerCase()===s));if(e&&t.type===Trt&&t.owner===Mrt){n=t;break}}if(!n)throw new Ve("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return n.load(i)}))}function brt(t,e,i){return null!=t?.styleUrl?grt(t.styleUrl,i):null!=t?.styleName?vrt(t.styleName,e,i):Promise.reject(new Ve("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function Srt(t){return null===t||"CIMSymbolReference"===t.type?t:{type:"CIMSymbolReference",symbol:t}}function _rt(t,e,i=["gltf"]){if("cimRef"===e)return encodeURI(t.cimRef);if(t.formatInfos&&!u("enable-feature:force-wosr"))for(const e of i){const i=t.formatInfos.find((t=>t.type===e));if(i)return i.href}return encodeURI(t.webRef)}function xrt(t,e){const i={responseType:"json",query:{f:"json"},...e};return Pl(Ca(t),i)}const Mrt="esri_en",Trt="Style",Art="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Irt;const krt="esri.renderers.UniqueValueRenderer",Crt=()=>jt.getLogger(krt),Ert="uvInfos-watcher",jrt="uvGroups-watcher",Ort=",",Rrt=ee(mrt);function Lrt(t){const{field1:e,field2:i,field3:n,fieldDelimiter:s,uniqueValueInfos:r,valueExpression:o}=t,a=!(!e||!i);return[{classes:(r??[]).map((t=>{const{symbol:r,label:l,value:u,description:c}=t,[h,d,f]=a?u?.toString()?.split(s||"")||[]:[u],p=[];return(e||o)&&p.push(h),i&&p.push(d),n&&p.push(f),{symbol:r,label:l,values:[p],description:c}}))}]}function Nrt(t){return null!=t&&""!==t&&("string"!=typeof t||""!==t.trim()&&"<null>"!==t.toLowerCase())||(t=null),t+""}let Prt=Irt=class extends(G9(S8)){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(t,e){if(!t&&!e)return;if(!t||!e)return{type:"complete",oldValue:t,newValue:e};let i=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let s=0;s<e.length;s++){const r=t.find((t=>t.value===e[s].value));r?ort(r,e[s])?(n.changed.push({type:"complete",oldValue:r,newValue:e[s]}),i=!0):n.unchanged.push({oldValue:r,newValue:e[s]}):(n.added.push(e[s]),i=!0)}for(let s=0;s<t.length;s++){e.find((e=>e.value===t[s].value))||(n.removed.push(t[s]),i=!0)}return i?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return null==t||"function"==typeof t?t:zt(t)}writeField(t,e,i,n){"string"==typeof t?e[i]=t:n?.messages?n.messages.push(new Ve("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):Crt().error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,i){return i.portal||uT.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const t=gT(e.styleUrl,i);return Object.freeze({styleUrl:t})}}writeStyleOrigin(t,e,i,n){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=vT(t.styleUrl,n))}set uniqueValueGroups(t){this.styleOrigin?Crt().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?Crt().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){if(this.styleOrigin)return void Crt().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i="object"==typeof t?Rrt(t):new mrt({value:t,symbol:ID(e)}),this.uniqueValueInfos?.push(i),this._valueInfoMap[Nrt(i.value)]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void Crt().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let i=0;i<e.length;i++){const n=e[i];if(String(n.value)===String(t)){delete this._valueInfoMap[Nrt(t)],e.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let i=e;return this.valueExpression&&null==e?.arcade&&(i={...i,arcade:await PE()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&null==e?.arcade)return void Crt().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return i?.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&null==i?.arcade){const t=await PE(),{arcadeUtils:e}=t;e.hasGeometryOperations(this.valueExpression)&&await e.enableGeometryOperations(),i={...i,arcade:t}}const n=this._getUniqueValueInfo(t,i);return n?.symbol||this.defaultSymbol}getSymbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables?.reduce(((t,e)=>t+e.getAttributeHash()),"")??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=this.uniqueValueInfos?.reduce(((t,e)=>t+e.getMeshHash()),"");return`${t}.${e}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new Irt({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:nt(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:nt(this.visualVariables),legendOptions:nt(this.legendOptions),authoringInfo:nt(this.authoringInfo),backgroundFillSymbol:nt(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=nt(this.uniqueValueInfos),i=nt(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(nt(this.styleOrigin))),Object.freeze(e),Object.freeze(i)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",i),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(t,e))),tj(t,e,this.valueExpression)];KE(t,e,this.field),KE(t,e,this.field2),KE(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return brt(this.styleOrigin,{portal:this.portal}).then((t=>{const e=[];return this._valueInfoMap={},t?.data&&Array.isArray(t.data.items)&&t.data.items.forEach((i=>{const n=new pD({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==t.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const s=new mrt({value:i.name,symbol:n});e.push(s),this._valueInfoMap[Nrt(i.name)]=s})),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",Ort)}_updateUniqueValues(){null!=this._isInfosSource&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[Nrt(e.value)]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(Ert);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const i of t)e.push(ey((()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description})),((t,e)=>{t!==e&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)}),{sync:!0}));this.addHandles(e,Ert)}}_watchUniqueValueGroups(){this.removeHandles(jrt);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const i of t){e.push(ey((()=>({classes:i.classes})),((t,e)=>{t!==e&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}));for(const t of i.classes??[])e.push(ey((()=>({symbol:t.symbol,values:t.values,label:t.label,description:t.description})),((t,e)=>{t!==e&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}))}this.addHandles(e,jrt)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:i,field3:n,fieldDelimiter:s,uniqueValueGroups:r,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!i);for(const e of r)for(const r of e.classes??[]){const{symbol:e,label:o,values:l,description:u}=r;for(const r of l??[]){const{value:l,value2:c,value3:h}=r,d=[l];i&&d.push(c),n&&d.push(h);const f=a?d.join(s||""):d[0]??void 0;t.push(new mrt({symbol:e,label:o,value:f,description:u}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:i,valueExpression:n,fieldDelimiter:s,uniqueValueInfos:r}=this;if(!e&&!n||!r.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!i),a=r.map((t=>{const{symbol:e,label:i,value:n,description:r}=t,[a,l,u]=o?n?.toString()?.split(s||"")||[]:[n];return new crt({symbol:e,label:i,description:r,values:[new lrt({value:a,value2:l,value3:u})]})})),l=[new drt({classes:a})];t&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:n,spatialReference:s,arcade:r,timeZone:o}=e??{};let a=this._cache.compiledFunc;const l=r.arcadeUtils;if(!a){const t=l.createSyntaxTree(this.valueExpression);a=l.createFunction(t),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(t,l.getViewInfo({viewingMode:i,scale:n,spatialReference:s}),o));return this._valueInfoMap[Nrt(u)]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let n;if(this.field2){const t=this.field2,s=this.field3,r=[];e&&r.push(i[e]),t&&r.push(i[t]),s&&r.push(i[s]),n=r.join(this.fieldDelimiter||"")}else e&&(n=i[e]);return this._valueInfoMap[Nrt(n)]}static fromPortalStyle(t,e){const i=new Irt(e?.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",e?.portal||uT.getDefault());const n=i.populateFromStyle();return n.catch((e=>{Crt().error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",e)})),n}static fromStyleUrl(t,e){const i=new Irt(e?.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const n=i.populateFromStyle();return n.catch((e=>{Crt().error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",e)})),n}};r([Je({readOnly:!0})],Prt.prototype,"_cache",null),r([NA({uniqueValue:"unique-value"})],Prt.prototype,"type",void 0),r([Je(S7)],Prt.prototype,"backgroundFillSymbol",void 0),r([Je({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],Prt.prototype,"field",null),r([Ah("field")],Prt.prototype,"castField",null),r([yh("field")],Prt.prototype,"writeField",null),r([Je({type:String,value:null,json:{write:!0}})],Prt.prototype,"field2",null),r([Je({type:String,value:null,json:{write:!0}})],Prt.prototype,"field3",null),r([Je({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],Prt.prototype,"orderByClassesEnabled",void 0),r([Je({type:String,value:null,json:{write:!0}})],Prt.prototype,"valueExpression",null),r([Je({type:String,json:{write:!0}})],Prt.prototype,"valueExpressionTitle",void 0),r([Je({type:k7,json:{write:!0}})],Prt.prototype,"legendOptions",void 0),r([Je({type:String,json:{write:!0}})],Prt.prototype,"defaultLabel",void 0),r([Je(mt({...w7},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],Prt.prototype,"defaultSymbol",null),r([Je({type:String,value:null,json:{write:!0}})],Prt.prototype,"fieldDelimiter",null),r([Je({type:uT,readOnly:!0})],Prt.prototype,"portal",void 0),r([ko("portal",["styleName"])],Prt.prototype,"readPortal",null),r([Je({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],Prt.prototype,"styleOrigin",void 0),r([ko("styleOrigin",["styleName","styleUrl"])],Prt.prototype,"readStyleOrigin",null),r([yh("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],Prt.prototype,"writeStyleOrigin",null),r([Je({type:[drt],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,i)=>(e.uniqueValueGroups||Lrt(e)).map((t=>drt.fromJSON(t,i)))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],Prt.prototype,"uniqueValueGroups",null),r([Je({type:[mrt],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],Prt.prototype,"uniqueValueInfos",null),Prt=Irt=r([ln(krt)],Prt);const Frt=Prt;const Drt={key:"type",base:S8,typeMap:{heatmap:Bst,simple:Jst,"unique-value":Frt,"class-breaks":P7,"dot-density":Ist,dictionary:vst,"pie-chart":Hst},errorContext:"renderer"},$rt={key:"type",base:S8,typeMap:{simple:Jst,"unique-value":Frt,"class-breaks":P7,heatmap:Bst},errorContext:"renderer",validate:zrt};function zrt(t){switch(t.type){case"simple":return Urt(t);case"unique-value":return Brt(t);case"class-breaks":return Grt(t);case"heatmap":return t}}function Urt(t){if(t.symbol)return t;jt.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function Brt(t){const e=t.uniqueValueInfos,i=e?.filter((({symbol:t,label:e},i)=>(t||jt.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${i}] ${e}) without a symbol from web scene.`),!!t)));return i?.length!==e?.length&&(t.uniqueValueInfos=i),t}function Grt(t){const e=t.classBreakInfos,i=e?.filter((({symbol:t,label:e},i)=>(t||jt.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${i}] ${e}) without a symbol from web scene.`),!!t)));return i?.length!==e?.length&&(t.classBreakInfos=i),t}function Vrt(t,e){return Hrt(t,null,e)}const qrt=xi({types:Drt});function Hrt(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&"uniqueValue"!==t.type?(i?.messages&&i.messages.push(new wi("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):qrt(t,e,i):null}const Wrt=(t=>t)(["operational-layers","basemap","ground"]);var Zrt;let Jrt=Zrt=class extends Io{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new Zrt({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};r([Je({type:String,json:{write:!0}})],Jrt.prototype,"expression",void 0),r([Je({type:String,json:{write:!0}})],Jrt.prototype,"name",void 0),r([Je({type:["boolean","date","number","string"],json:{write:!0}})],Jrt.prototype,"returnType",void 0),r([Je({type:String,json:{write:!0}})],Jrt.prototype,"title",void 0),Jrt=Zrt=r([ln("esri.form.ExpressionInfo")],Jrt);const Yrt=Jrt;let Krt=class extends Io{constructor(t){super(t),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};r([Je({type:String,json:{write:!0}})],Krt.prototype,"description",void 0),r([Je({type:String,json:{write:!0}})],Krt.prototype,"label",void 0),r([Je()],Krt.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],Krt.prototype,"visibilityExpression",void 0),Krt=r([ln("esri.form.elements.Element")],Krt);const Qrt=Krt;let Xrt=class extends(cm(Io)){constructor(t){super(t),this.type=null}};r([Je()],Xrt.prototype,"type",void 0),Xrt=r([ln("esri.form.elements.inputs.attachments.Input")],Xrt);const tot=Xrt;const eot=["any","capture","upload"];let iot=class extends tot{constructor(t){super(t),this.type="audio",this.inputMethod="any",this.maxDuration=null}};r([Je({type:["audio"],readOnly:!0,json:{write:!0}})],iot.prototype,"type",void 0),r([Je({type:eot,json:{write:!0}})],iot.prototype,"inputMethod",void 0),r([Je({type:Number,json:{write:!0}})],iot.prototype,"maxDuration",void 0),iot=r([ln("esri.form.elements.inputs.attachments.AudioInput")],iot);const not=iot;let sot=class extends tot{constructor(t){super(t),this.type="document",this.maxFileSize=null}};r([Je({type:["document"],readOnly:!0,json:{write:!0}})],sot.prototype,"type",void 0),r([Je({type:Number,json:{write:!0}})],sot.prototype,"maxFileSize",void 0),sot=r([ln("esri.form.elements.inputs.attachments.DocumentInput")],sot);const rot=sot;let oot=class extends tot{constructor(t){super(t),this.type="image",this.inputMethod="any",this.maxImageSize=null}};r([Je({type:["image"],readOnly:!0,json:{write:!0}})],oot.prototype,"type",void 0),r([Je({type:eot,json:{write:!0}})],oot.prototype,"inputMethod",void 0),r([Je({type:Number,json:{write:!0}})],oot.prototype,"maxImageSize",void 0),oot=r([ln("esri.form.elements.inputs.attachments.ImageInput")],oot);const aot=oot;let lot=class extends tot{constructor(t){super(t),this.type="signature",this.inputMethod="any"}};r([Je({type:["signature"],readOnly:!0,json:{write:!0}})],lot.prototype,"type",void 0),r([Je({type:eot,json:{write:!0}})],lot.prototype,"inputMethod",void 0),lot=r([ln("esri.form.elements.inputs.attachments.SignatureInput")],lot);const uot=lot;let cot=class extends tot{constructor(t){super(t),this.type="video",this.inputMethod="any",this.maxDuration=null}};r([Je({type:["video"],readOnly:!0,json:{write:!0}})],cot.prototype,"type",void 0),r([Je({type:eot,json:{write:!0}})],cot.prototype,"inputMethod",void 0),r([Je({type:Number,json:{write:!0}})],cot.prototype,"maxDuration",void 0),cot=r([ln("esri.form.elements.inputs.attachments.VideoInput")],cot);const hot=cot;function dot(t){return{nestableTypes:{base:tot,key:"type",typeMap:{audio:not,document:rot,image:aot,signature:uot,video:hot}},allTypes:{base:tot,key:"type",typeMap:{attachment:t,audio:not,document:rot,image:aot,signature:uot,video:hot}}}}function fot(t,e,i){return t?t.map((t=>ue(i?e.nestableTypes:e.allTypes,t))):null}function pot(t,e,i){if(!t)return null;const n=i?e.nestableTypes.typeMap:e.allTypes.typeMap;return t.filter((t=>n[t.type])).map((t=>n[t.type].fromJSON(t)))}function mot(t,e,i){if(!t)return null;const n=i?e.nestableTypes.typeMap:e.allTypes.typeMap;return t.filter((t=>n[t.type])).map((t=>t.toJSON()))}let yot=class extends tot{constructor(t){super(t),this.type="attachment",this.attachmentAssociationType="exact",this.inputTypes=null}castInputs(t){return fot(t,got,!0)}readInputs(t,e){return pot(e.inputTypes,got,!0)}writeInputs(t,e){e.inputTypes=mot(t,got,!0)}};r([Je({type:["attachment"],readOnly:!0,json:{write:!0}})],yot.prototype,"type",void 0),r([Je({type:["any","exact","exactOrNone"],json:{write:!0}})],yot.prototype,"attachmentAssociationType",void 0),r([Je({json:{write:{isRequired:!0}}})],yot.prototype,"inputTypes",void 0),r([Ah("inputTypes")],yot.prototype,"castInputs",null),r([ko("inputTypes")],yot.prototype,"readInputs",null),r([yh("inputTypes")],yot.prototype,"writeInputs",null),yot=r([ln("esri.form.elements.inputs.attachments.AttachmentInput")],yot);const got=dot(yot),vot=yot;var wot;const bot=dot(vot);let Sot=wot=class extends Qrt{constructor(t){super(t),this.allowUserRename=!0,this.attachmentKeyword=null,this.displayFilename=!1,this.editableExpression=null,this.filenameExpression="{attachmentKeyword}_{now}",this.input=null,this.maxAttachmentCount=null,this.minAttachmentCount=null,this.type="attachment",this.useOriginalFilename=!0}clone(){return new wot({allowUserRename:this.allowUserRename,attachmentKeyword:this.attachmentKeyword,description:this.description,displayFilename:this.displayFilename,editableExpression:this.editableExpression,filenameExpression:this.filenameExpression,input:this.input?.clone(),label:this.label,maxAttachmentCount:this.maxAttachmentCount,minAttachmentCount:this.minAttachmentCount,useOriginalFilename:this.useOriginalFilename,visibilityExpression:this.visibilityExpression})}};r([Je({type:Boolean,json:{write:!0}})],Sot.prototype,"allowUserRename",void 0),r([Je({type:String,json:{write:{isRequired:!0}}})],Sot.prototype,"attachmentKeyword",void 0),r([Je({type:Boolean,json:{write:!0}})],Sot.prototype,"displayFilename",void 0),r([Je({type:String,json:{write:!0}})],Sot.prototype,"editableExpression",void 0),r([Je({type:String,json:{write:!0}})],Sot.prototype,"filenameExpression",void 0),r([Je({types:bot.allTypes,json:{read:{source:"inputType"},write:{target:"inputType",isRequired:!0}}})],Sot.prototype,"input",void 0),r([Je({type:Number,json:{write:!0}})],Sot.prototype,"maxAttachmentCount",void 0),r([Je({type:Number,json:{write:!0}})],Sot.prototype,"minAttachmentCount",void 0),r([Je({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Sot.prototype,"type",void 0),r([Je({type:Boolean,json:{write:!0}})],Sot.prototype,"useOriginalFilename",void 0),Sot=wot=r([ln("esri.form.elements.AttachmentElement")],Sot);const _ot=Sot;let xot=class extends Io{constructor(t){super(t),this.type=null}};r([Je()],xot.prototype,"type",void 0),xot=r([ln("esri.form.elements.inputs.Input")],xot);const Mot=xot;let Tot=class extends Mot{constructor(t){super(t),this.maxLength=null,this.minLength=0}};r([Je({type:Number,json:{write:!0}})],Tot.prototype,"maxLength",void 0),r([Je({type:Number,json:{write:!0}})],Tot.prototype,"minLength",void 0),Tot=r([ln("esri.form.elements.inputs.TextInput")],Tot);const Aot=Tot;var Iot;let kot=Iot=class extends Aot{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new Iot({maxLength:this.maxLength,minLength:this.minLength})}};r([Je({type:["barcode-scanner"],json:{read:!1,write:!0}})],kot.prototype,"type",void 0),kot=Iot=r([ln("esri.form.elements.inputs.BarcodeScannerInput")],kot);const Cot=kot;var Eot;let jot=Eot=class extends Mot{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new Eot({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};r([Je({type:String,json:{write:!0}})],jot.prototype,"noValueOptionLabel",void 0),r([Je({type:Boolean,json:{write:!0}})],jot.prototype,"showNoValueOption",void 0),r([Je({type:["combo-box"],json:{read:!1,write:!0}})],jot.prototype,"type",void 0),jot=Eot=r([ln("esri.form.elements.inputs.ComboBoxInput")],jot);const Oot=jot;var Rot;function Lot(t){return null!=t?t:null}function Not(t){return null!=t?t:null}let Pot=Rot=class extends Mot{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return Lot(e.max)}writeMax(t,e){e.max=Not(t)}readMin(t,e){return Lot(e.min)}writeMin(t,e){e.min=Not(t)}clone(){return new Rot({max:this.max,min:this.min})}};r([Je({type:String,json:{type:String,write:!0}})],Pot.prototype,"max",void 0),r([ko("max")],Pot.prototype,"readMax",null),r([yh("max")],Pot.prototype,"writeMax",null),r([Je({type:String,json:{type:String,write:!0}})],Pot.prototype,"min",void 0),r([ko("min")],Pot.prototype,"readMin",null),r([yh("min")],Pot.prototype,"writeMin",null),r([Je({type:["date-picker"],json:{read:!1,write:!0}})],Pot.prototype,"type",void 0),Pot=Rot=r([ln("esri.form.elements.inputs.DatePickerInput")],Pot);const Fot=Pot;var Dot;function $ot(t){return null!=t?t:null}function zot(t){return null!=t?t:null}let Uot=Dot=class extends Mot{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return $ot(e.max)}writeMax(t,e){e.max=zot(t)}readMin(t,e){return $ot(e.min)}writeMin(t,e){e.min=zot(t)}readTimeResolution(t,e){return $ot(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=zot(t)}clone(){return new Dot({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};r([Je({type:Boolean,json:{write:!0}})],Uot.prototype,"includeTimeOffset",void 0),r([Je({type:String,json:{type:String,write:!0}})],Uot.prototype,"max",void 0),r([ko("max")],Uot.prototype,"readMax",null),r([yh("max")],Uot.prototype,"writeMax",null),r([Je({type:String,json:{type:String,write:!0}})],Uot.prototype,"min",void 0),r([ko("min")],Uot.prototype,"readMin",null),r([yh("min")],Uot.prototype,"writeMin",null),r([Je({type:String,json:{type:String,write:!0}})],Uot.prototype,"timeResolution",void 0),r([ko("timeResolution")],Uot.prototype,"readTimeResolution",null),r([yh("timeResolution")],Uot.prototype,"writeTimeResolution",null),r([Je({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],Uot.prototype,"type",void 0),Uot=Dot=r([ln("esri.form.elements.inputs.DateTimeOffsetPickerInput")],Uot);const Bot=Uot;var Got;function Vot(t){return null!=t?new Date(t):null}function qot(t){return t?t.getTime():null}let Hot=Got=class extends Mot{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return Vot(e.max)}writeMax(t,e){e.max=qot(t)}readMin(t,e){return Vot(e.min)}writeMin(t,e){e.min=qot(t)}clone(){return new Got({includeTime:this.includeTime,max:this.max,min:this.min})}};r([Je({type:Boolean,json:{write:!0}})],Hot.prototype,"includeTime",void 0),r([Je({type:Date,json:{type:Number,write:!0}})],Hot.prototype,"max",void 0),r([ko("max")],Hot.prototype,"readMax",null),r([yh("max")],Hot.prototype,"writeMax",null),r([Je({type:Date,json:{type:Number,write:!0}})],Hot.prototype,"min",void 0),r([ko("min")],Hot.prototype,"readMin",null),r([yh("min")],Hot.prototype,"writeMin",null),r([Je({type:["datetime-picker"],json:{read:!1,write:!0}})],Hot.prototype,"type",void 0),Hot=Got=r([ln("esri.form.elements.inputs.DateTimePickerInput")],Hot);const Wot=Hot;var Zot;let Jot=Zot=class extends Mot{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new Zot({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};r([Je({type:String,json:{write:!0}})],Jot.prototype,"noValueOptionLabel",void 0),r([Je({type:Boolean,json:{write:!0}})],Jot.prototype,"showNoValueOption",void 0),r([Je({type:["radio-buttons"],json:{read:!1,write:!0}})],Jot.prototype,"type",void 0),Jot=Zot=r([ln("esri.form.elements.inputs.RadioButtonsInput")],Jot);const Yot=Jot;var Kot;let Qot=Kot=class extends Mot{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new Kot({offValue:this.offValue,onValue:this.onValue})}};r([Je({type:[String,Number],json:{write:!0}})],Qot.prototype,"offValue",void 0),r([Je({type:[String,Number],json:{write:!0}})],Qot.prototype,"onValue",void 0),r([Je({type:["switch"],json:{read:!1,write:!0}})],Qot.prototype,"type",void 0),Qot=Kot=r([ln("esri.form.elements.inputs.SwitchInput")],Qot);const Xot=Qot;var tat;let eat=tat=class extends Aot{constructor(t){super(t),this.type="text-area"}clone(){return new tat({maxLength:this.maxLength,minLength:this.minLength})}};r([Je({type:["text-area"],json:{read:!1,write:!0}})],eat.prototype,"type",void 0),eat=tat=r([ln("esri.form.elements.inputs.TextAreaInput")],eat);const iat=eat;var nat;let sat=nat=class extends Aot{constructor(t){super(t),this.type="text-box"}clone(){return new nat({maxLength:this.maxLength,minLength:this.minLength})}};r([Je({type:["text-box"],json:{read:!1,write:!0}})],sat.prototype,"type",void 0),sat=nat=r([ln("esri.form.elements.inputs.TextBoxInput")],sat);const rat=sat;var oat;function aat(t){return null!=t?t:null}function lat(t){return null!=t?t:null}let uat=oat=class extends Mot{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return aat(e.max)}writeMax(t,e){e.max=lat(t)}readMin(t,e){return aat(e.min)}writeMin(t,e){e.min=lat(t)}readTimeResolution(t,e){return aat(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=lat(t)}clone(){return new oat({max:this.max,min:this.min,timeResolution:this.timeResolution})}};r([Je({type:String,json:{type:String,write:!0}})],uat.prototype,"max",void 0),r([ko("max")],uat.prototype,"readMax",null),r([yh("max")],uat.prototype,"writeMax",null),r([Je({type:String,json:{type:String,write:!0}})],uat.prototype,"min",void 0),r([ko("min")],uat.prototype,"readMin",null),r([yh("min")],uat.prototype,"writeMin",null),r([Je({type:String,json:{type:String,write:!0}})],uat.prototype,"timeResolution",void 0),r([ko("timeResolution")],uat.prototype,"readTimeResolution",null),r([yh("timeResolution")],uat.prototype,"writeTimeResolution",null),r([Je({type:["time-picker"],json:{read:!1,write:!0}})],uat.prototype,"type",void 0),uat=oat=r([ln("esri.form.elements.inputs.TimePickerInput")],uat);const cat=uat;const hat={base:Mot,key:"type",typeMap:{"barcode-scanner":Cot,"combo-box":Oot,"date-picker":Fot,"datetime-picker":Wot,"datetimeoffset-picker":Bot,"radio-buttons":Yot,switch:Xot,"text-area":iat,"text-box":rat,"time-picker":cat}};var dat;let fat=dat=class extends Qrt{constructor(t){super(t),this.domain=null,this.editable=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}clone(){return new dat({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};r([Je({types:r$,json:{read:{reader:o$},write:!0}})],fat.prototype,"domain",void 0),r([Je({type:Boolean,json:{write:!0}})],fat.prototype,"editable",void 0),r([Je({type:String,json:{write:!0}})],fat.prototype,"editableExpression",void 0),r([Je({type:String,json:{write:!0}})],fat.prototype,"fieldName",void 0),r([Je({type:String,json:{write:!0}})],fat.prototype,"hint",void 0),r([Je({types:hat,json:{read:{source:"inputType"},write:{target:"inputType"}}})],fat.prototype,"input",void 0),r([Je({type:String,json:{write:!0}})],fat.prototype,"requiredExpression",void 0),r([Je({type:String,json:{read:!1,write:!0}})],fat.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],fat.prototype,"valueExpression",void 0),fat=dat=r([ln("esri.form.elements.FieldElement")],fat);const pat=fat;var mat;let yat=mat=class extends Qrt{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new mat({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:nt(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};r([Je({type:Number,json:{write:!0}})],yat.prototype,"displayCount",void 0),r([Je({type:["list"],json:{write:!0}})],yat.prototype,"displayType",void 0),r([Je({type:String,json:{write:!0}})],yat.prototype,"editableExpression",void 0),r([Je({type:[gR],json:{write:!0}})],yat.prototype,"orderByFields",void 0),r([Je({type:Number,json:{write:!0}})],yat.prototype,"relationshipId",void 0),r([Je({type:["relationship"],json:{read:!1,write:!0}})],yat.prototype,"type",void 0),yat=mat=r([ln("esri.form.elements.RelationshipElement")],yat);const gat=yat;var vat;let wat=vat=class extends Qrt{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new vat({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};r([Je({type:String,json:{write:!0}})],wat.prototype,"text",void 0),r([Je({type:String,json:{write:!0}})],wat.prototype,"textFormat",void 0),r([Je({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],wat.prototype,"type",void 0),wat=vat=r([ln("esri.form.elements.TextElement")],wat);const bat=wat;function Sat(t){return{typesWithGroup:{base:Qrt,key:"type",typeMap:{attachment:_ot,field:pat,group:t,relationship:gat,text:bat}},typesWithoutGroup:{base:Qrt,key:"type",typeMap:{attachment:_ot,field:pat,relationship:gat,text:bat}}}}function _at(t,e,i=!0){if(!t)return null;const n=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>n[t.type])).map((t=>n[t.type].fromJSON(t)))}function xat(t,e,i=!0){if(!t)return null;const n=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>n[t.type])).map((t=>t.toJSON()))}function Mat(t,e,i=!0){return t?t.map((t=>ue(i?e.typesWithGroup:e.typesWithoutGroup,t))):null}var Tat;let Aat=Tat=class extends Qrt{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return Mat(t,Iat,!1)}readElements(t,e){return _at(e.formElements,Iat,!1)}writeElements(t,e){e.formElements=xat(t,Iat,!1)}clone(){return new Tat({description:this.description,elements:nt(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};r([Je({json:{write:!0}})],Aat.prototype,"elements",void 0),r([Ah("elements")],Aat.prototype,"castElements",null),r([ko("elements",["formElements"])],Aat.prototype,"readElements",null),r([yh("elements")],Aat.prototype,"writeElements",null),r([Je({type:["collapsed","expanded"],json:{write:!0}})],Aat.prototype,"initialState",void 0),r([Je({type:String,json:{read:!1,write:!0}})],Aat.prototype,"type",void 0),Aat=Tat=r([ln("esri.form.elements.GroupElement")],Aat);const Iat=Sat(Aat),kat=Aat;const Cat=t=>"field"===t.type,Eat=t=>"group"===t.type,jat=t=>"text"===t.type;var Oat;const Rat=Sat(kat);let Lat=Oat=class extends Io{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return Mat(t,Rat)}readElements(t,e){return _at(e.formElements,Rat)}writeElements(t,e){e.formElements=xat(t,Rat)}clone(){return new Oat({description:this.description,expressionInfos:nt(this.expressionInfos),elements:nt(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const i=new Set,{description:n,elements:s,expressionInfos:r,title:o}=this;if(Dat(i,t,n),Dat(i,t,o),!s)return[];const a=Pat(s,r).map((e=>tj(i,t,e)));await Promise.all(a);for(const n of s)Nat(i,{fieldsIndex:t,relationships:e},n);return Array.from(i).sort()}};function Nat(t,e,i){const{fieldsIndex:n}=e;if(!n||n.fields.length!==t.size)switch(Dat(t,n,i.label),Dat(t,n,i.description),i.type){case"field":KE(t,n,i.fieldName);break;case"group":i.elements.forEach((i=>Nat(t,e,i)));break;case"relationship":if(e.relationships){const s=e.relationships.find((t=>t.id===i.relationshipId));s&&KE(t,n,s.keyField)}YE(t,n,i.orderByFields?.map((t=>t.field)));break;case"text":Dat(t,n,i.text)}}function Pat(t,e){if(!e||0===e.length)return[];const i=Fat(t),n=[];for(const t of e)i.has(t.name)&&n.push(t.expression);return n}function Fat(t){const e=new Set;for(const i of t)if(gr(e,i.visibilityExpression),!jat(i))if(Eat(i))yr(e,Fat(i.elements));else if(gr(e,i.editableExpression),Cat(i)){const{requiredExpression:t,valueExpression:n}=i;yr(e,[t,n])}return e}function Dat(t,e,i){YE(t,e,fO(i))}r([Je({type:String,json:{write:!0}})],Lat.prototype,"description",void 0),r([Je({json:{write:!0}})],Lat.prototype,"elements",void 0),r([Ah("elements")],Lat.prototype,"castElements",null),r([ko("elements",["formElements"])],Lat.prototype,"readElements",null),r([yh("elements")],Lat.prototype,"writeElements",null),r([Je({type:[Yrt],json:{write:!0}})],Lat.prototype,"expressionInfos",void 0),r([Je({type:Boolean,json:{default:!1,write:!0}})],Lat.prototype,"preserveFieldValuesWhenHidden",void 0),r([Je({type:String,json:{write:!0}})],Lat.prototype,"title",void 0),Lat=Oat=r([ln("esri.form.FormTemplate")],Lat);const $at=Lat;function zat(t,e,i){if(null==t.hasM||t.hasZ)for(const t of e)for(const e of t)e.length>2&&(e[2]*=i)}function Uat(t,e,i){if(!t&&!e||!i)return;const n=Zc(i);Bat(t,i,n),Bat(e,i,n)}function Bat(t,e,i){if(t)for(const n of t)Gat(n.geometry,e,i)}function Gat(t,e,i){if(!t?.spatialReference||Gu(t.spatialReference,e))return;const n=Zc(t.spatialReference)/i;if(1!==n)if("x"in t)null!=t.z&&(t.z*=n);else if("rings"in t)zat(t,t.rings,n);else if("paths"in t)zat(t,t.paths,n);else if("points"in t&&(null==t.hasM||t.hasZ))for(const e of t.points)e.length>2&&(e[2]*=n)}function Vat(t,e,i){if(!i?.features||!i.hasZ)return;const n=yb(i.geometryType,e,t.outSpatialReference);if(null!=n)for(const t of i.features)n(t.geometry)}var qat;const Hat=new Co({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Wat=qat=class extends Io{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){const i=wh.fromJSON(e.spatialReference),n=[];for(let e=0;e<t.length;e++){const s=t[e],r=OD.fromJSON(s),o=s.geometry?.spatialReference;null==r.geometry||o||(r.geometry.spatialReference=i);const a=s.aggregateGeometries,l=r.aggregateGeometries;if(a&&null!=l)for(const t in l){const e=l[t],n=a[t],s=n?.spatialReference;null==e||s||(e.spatialReference=i)}n.push(r)}return n}writeGeometryType(t,e,i,n){if(t)return void Hat.write(t,e,i,n);const{features:s}=this;if(s)for(const t of s)if(null!=t?.geometry)return void Hat.write(t.geometry.type,e,i,n)}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,n=rm(t);return n&&!i&&e.spatialReference&&(n.spatialReference=wh.fromJSON(e.spatialReference)),n}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i)for(const t of i)if(t&&null!=t.geometry&&t.geometry.spatialReference)return void(e.spatialReference=t.geometry.spatialReference.toJSON())}clone(){return new qat(this.cloneProperties())}cloneProperties(){return nt({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const n=e.features[i];if(n.geometry){const e=t?.[i];n.geometry=e?.toJSON()||n.geometry}}return e}quantize(t){const{scale:[e,i],translate:[n,s]}=t,r=t=>Math.round((t-n)/e),o=t=>Math.round((s-t)/i),a=this.features,l=this._getQuantizationFunction(this.geometryType,r,o);for(let t=0,e=a.length;t<e;t++)l?.(a[t].geometry)||(a.splice(t,1),t--,e--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[n,s],scale:[r,o]}=i,a=t=>t*r+n,l=t=>s-t*o;let u=null,c=null;if(this.hasZ&&null!=i?.scale?.[2]){const{translate:[,,t],scale:[,,e]}=i;u=i=>i*e+t}if(this.hasM&&null!=i?.scale?.[3]){const{translate:[,,,t],scale:[,,,e]}=i;c=i=>null==i?i:i*e+t}const h=this._getHydrationFunction(t,a,l,u,c);for(const{geometry:t}of e)null!=t&&h&&h(t);return this.transform=null,this}_quantizePoints(t,e,i){let n,s;const r=[];for(let o=0,a=t.length;o<a;o++){const a=t[o];if(o>0){const t=e(a[0]),o=i(a[1]);t===n&&o===s||(r.push([t-n,o-s]),n=t,s=o)}else n=e(a[0]),s=i(a[1]),r.push([n,s])}return r.length>0?r:null}_getQuantizationFunction(t,e,i){return"point"===t?t=>(t.x=e(t.x),t.y=i(t.y),t):"polyline"===t||"polygon"===t?t=>{const n=sm(t)?t.rings:t.paths,s=[];for(let t=0,r=n.length;t<r;t++){const r=n[t],o=this._quantizePoints(r,e,i);o&&s.push(o)}return s.length>0?(sm(t)?t.rings=s:t.paths=s,t):null}:"multipoint"===t?t=>{const n=this._quantizePoints(t.points,e,i);return n&&n.length>0?(t.points=n,t):null}:"extent"===t?t=>t:null}_getHydrationFunction(t,e,i,n,s){return"point"===t?t=>{t.x=e(t.x),t.y=i(t.y),n&&(t.z=n(t.z))}:"polyline"===t||"polygon"===t?t=>{const r=sm(t)?t.rings:t.paths;let o,a;for(let t=0,n=r.length;t<n;t++){const n=r[t];for(let t=0,s=n.length;t<s;t++){const s=n[t];t>0?(o+=s[0],a+=s[1]):(o=s[0],a=s[1]),s[0]=e(o),s[1]=i(a)}}if(n&&s)for(let t=0,e=r.length;t<e;t++){const e=r[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=n(i[2]),i[3]=s(i[3])}}else if(n)for(let t=0,e=r.length;t<e;t++){const e=r[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=n(i[2])}}else if(s)for(let t=0,e=r.length;t<e;t++){const e=r[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=s(i[2])}}}:"extent"===t?t=>{t.xmin=e(t.xmin),t.ymin=i(t.ymin),t.xmax=e(t.xmax),t.ymax=i(t.ymax),n&&null!=t.zmax&&null!=t.zmin&&(t.zmax=n(t.zmax),t.zmin=n(t.zmin)),s&&null!=t.mmax&&null!=t.mmin&&(t.mmax=s(t.mmax),t.mmin=s(t.mmin))}:"multipoint"===t?t=>{const r=t.points;let o,a;for(let t=0,n=r.length;t<n;t++){const n=r[t];t>0?(o+=n[0],a+=n[1]):(o=n[0],a=n[1]),n[0]=e(o),n[1]=i(a)}if(n&&s)for(let t=0,e=r.length;t<e;t++){const e=r[t];e[2]=n(e[2]),e[3]=s(e[3])}else if(n)for(let t=0,e=r.length;t<e;t++){const e=r[t];e[2]=n(e[2])}else if(s)for(let t=0,e=r.length;t<e;t++){const e=r[t];e[2]=s(e[2])}}:null}};r([Je({type:String,json:{write:!0}})],Wat.prototype,"displayFieldName",void 0),r([Je({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Wat.prototype,"exceededTransferLimit",void 0),r([Je({type:[OD],json:{write:!0}})],Wat.prototype,"features",void 0),r([ko("features")],Wat.prototype,"readFeatures",null),r([Je({type:[h$],json:{write:!0}})],Wat.prototype,"fields",void 0),r([Je({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:Hat.read}}})],Wat.prototype,"geometryType",void 0),r([yh("geometryType")],Wat.prototype,"writeGeometryType",null),r([Je({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Wat.prototype,"hasM",void 0),r([Je({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Wat.prototype,"hasZ",void 0),r([Je({types:um,json:{write:!0}})],Wat.prototype,"queryGeometry",void 0),r([ko("queryGeometry")],Wat.prototype,"readQueryGeometry",null),r([Je({type:wh,json:{write:!0}})],Wat.prototype,"spatialReference",void 0),r([yh("spatialReference")],Wat.prototype,"writeSpatialReference",null),r([Je({json:{write:!0}})],Wat.prototype,"transform",void 0),Wat=qat=r([ln("esri.rest.support.FeatureSet")],Wat),Wat.prototype.toJSON.isDefaultToJSON=!0;const Zat=Wat;let Jat=0,Yat=class extends($M.LoadableMixin(jM(Vm))){constructor(t){super(t),this._idToClientGraphic=null,this.type="memory"}load(t){const e=null!=t?t.signal:null;return this.addResolvingPromise(this._startWorker(e)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}get _workerGeometryType(){const t=this.layer?.geometryType;return t?this._geometryTypeRequiresClientGraphicMapping(t)?"polygon":t:null}applyEdits(t){return this.load().then((()=>this._applyEdits(t)))}openPorts(){return this.load().then((()=>this._connection.openPorts()))}async queryFeatures(t,e={}){await this.load(e);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,e);Vat(t,this.layer.spatialReference,i);const n=Zat.fromJSON(i);if(!this._requiresClientGraphicMapping())return n;const s=this.layer.objectIdField;for(const t of n.features){const e=t.attributes[s],i=this._idToClientGraphic.get(e);i&&(t.geometry=i.geometry)}return n.geometryType=this.layer.geometryType,n}async queryFeaturesJSON(t,e={}){if(this._requiresClientGraphicMapping())throw new Ve("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(e);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,e);return Vat(t,this.layer.spatialReference,i),i}queryFeatureCount(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryFeatureCount",t?t.toJSON():null,e)))}queryObjectIds(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryObjectIds",t?t.toJSON():null,e)))}queryExtent(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryExtent",t?t.toJSON():null,e))).then((t=>({count:t.count,extent:Od.fromJSON(t.extent)})))}querySnapping(t,e={}){return this.load(e).then((()=>this._connection.invoke("querySnapping",t,e)))}async _applyEdits(t){if(!this._connection)throw new Ve("feature-layer-source:edit-failure","Memory source not loaded");const e=this.layer.objectIdField;let i=null;const n=[],s=[];await Promise.all([this._prepareClientMapping(t.addFeatures,null),this._prepareClientMapping(t.updateFeatures,null)]);const r=t=>"objectId"in t&&null!=t.objectId?t.objectId:"attributes"in t&&null!=t.attributes[e]?t.attributes[e]:null;if(t.addFeatures&&(i=this._prepareAddFeatures(t.addFeatures)),t.deleteFeatures)for(const e of t.deleteFeatures){const t=r(e);null!=t&&n.push(t)}const o=t.updateFeatures&&this._idToClientGraphic?new Map:null;if(t.updateFeatures)for(const e of t.updateFeatures)if(s.push(this._serializeFeature(e)),o){const t=r(e);null!=t&&o.set(t,e)}Uat(i?i.features:null,s,this.layer.spatialReference);const{fullExtent:a,featureEditResults:l}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:s,deletes:n});return this.fullExtent=a,i&&i.finish(l.uidToObjectId),this._updateClientGraphicIds(o,l),this._createEditsResult(l)}async _prepareClientMapping(t,e){if("mesh"!==this._layerOrSourceGeometryType||null==t)return;const i=[];for(const{geometry:n}of t)null==n||"mesh"!==n.type||n.hasExtent||n.loaded||i.push(n.load({signal:e}));i.length&&await Promise.all(i)}_updateClientGraphicIds(t,e){if(this._idToClientGraphic){if(t)for(const i of e.updateResults){if(!i.success)continue;const e=t.get(i.objectId);null!=e&&this._addIdToClientGraphic(e)}for(const t of e.deleteResults)t.success&&this._idToClientGraphic.delete(t.objectId)}}_createEditsResult(t){return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(t){const e=!0===t.success?null:t.error||{code:void 0,description:void 0};return{objectId:t.objectId,globalId:t.globalId,error:e?new Ve("feature-layer-source:edit-failure",e.description,{code:e.code}):null}}_prepareAddFeatures(t){const e=new Map,i=new Array(t.length);let n=null;for(let s=0;s<t.length;s++){const r=t[s],o=this._serializeFeature(r);n||null==r.geometry||(n=r.geometry.type),i[s]=o,e.set(`${o.uid}`,r)}const s=this;return{features:i,inferredGeometryType:n,finish(t){const i=s.sourceJSON.objectIdField;for(const n in t){const r=t[n],o=e.get(n);o&&(o.attributes||(o.attributes={}),-1===r?delete o.attributes[i]:o.attributes[i]=r,s._addIdToClientGraphic(o))}}}}_addIdToClientGraphic(t){if(!this._idToClientGraphic)return;const e=this.sourceJSON.objectIdField,i=t.attributes?.[e];null!=i&&this._idToClientGraphic.set(i,t)}get _layerOrSourceGeometryType(){return this.layer?.geometryType??this.sourceJSON?.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(t){return this._geometryTypeRequiresClientGraphicMapping(t.type)}_geometryTypeRequiresClientGraphicMapping(t){return"mesh"===t||"multipatch"===t||"extent"===t}_serializeFeature(t){const{attributes:e}=t,i=this._geometryForSerialization(t),n=(Jat++).toString();return i?{uid:n,geometry:i.toJSON(),attributes:e}:{uid:n,attributes:e}}_geometryForSerialization(t){const{geometry:e}=t;if(null==e)return null;if(this._geometryRequiresClientGraphicMapping(e)){return e.extent?qp.fromExtent(e.extent):null}return e}async _startWorker(t){this._connection=await Wv("MemorySourceWorker",{strategy:u("feature-layers-workers")?"dedicated":"local",signal:t,registryTarget:this});const{fields:e,spatialReference:i,objectIdField:n,hasM:s,hasZ:r,timeInfo:o,dateFieldsTimeZone:a}=this.layer,l="defaults"===this.layer.originOf("spatialReference");await this._prepareClientMapping(this.items,t);const c=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",(t=>{jt.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),t.preventDefault()})));const h={features:c.features,fields:e?.map((t=>t.toJSON())),geometryType:Xp.toJSON(this._workerGeometryType),hasM:"mesh"!==this._layerOrSourceGeometryType&&s,hasZ:"mesh"===this._layerOrSourceGeometryType||r,objectIdField:n,spatialReference:l?null:i&&i.toJSON(),timeInfo:o?.toJSON()??null,dateFieldsTimeZone:a},d=await this._connection.invoke("load",h,{signal:t});for(const t of d.warnings)jt.getLogger(this.layer).warn("#load()",`${t.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:t});d.featureErrors.length&&jt.getLogger(this.layer).warn("#load()",`Encountered ${d.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:d.featureErrors});const f=d.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(c.inferredGeometryType)&&(f.geometryType=Xp.toJSON(c.inferredGeometryType)),this.sourceJSON=f,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),c.finish(d.assignedObjectIds)}};r([Im({Type:OD,ensureType:ee(OD)})],Yat.prototype,"itemType",void 0),r([Je()],Yat.prototype,"type",void 0),r([Je({constructOnly:!0})],Yat.prototype,"layer",void 0),r([Je({readOnly:!0})],Yat.prototype,"_workerGeometryType",null),r([Je()],Yat.prototype,"sourceJSON",void 0),Yat=r([ln("esri.layers.graphics.sources.MemorySource")],Yat);function Kat(t){return"portalItem"in t}const Qat=t=>{let e=class extends t{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):Kat(this)?this.portalItem?.apiKey:null}set apiKey(t){null!=t?this._override("apiKey",t):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return r([Je({type:String})],e.prototype,"apiKey",null),e=r([ln("esri.layers.mixins.APIKeyMixin")],e),e};const Xat=t=>{let e=class extends t{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const t=aU(this.url);if(null!=t&&t.title)return t.title}return this._get("title")||""}set title(t){this._set("title",t)}set url(t){this._set("url",dU(t,jt.getLogger(this)))}};return r([Je()],e.prototype,"title",null),r([Je({type:String})],e.prototype,"url",null),e=r([ln("esri.layers.mixins.ArcGISService")],e),e};function tlt(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i}function elt(t,e,i,n){var s=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(s,elt.prototype),s.expected=e,s.found=i,s.location=n,s.name="SyntaxError",s}function ilt(t,e,i){return i=i||" ",t.length>e?t:(e-=t.length,t+(i+=i.repeat(e)).slice(0,e))}function nlt(t,e){var i,n={},s=(e=void 0!==e?e:{}).grammarSource,r={start:Ht},o=Ht,a="none",l=")",u=",",c="(",h="%",d="px",f="cm",p="mm",m="in",y="pt",g="pc",v="deg",w="rad",b="grad",S="turn",_="#",x=".",M="e",T=/^[ \t\n\r]/,A=/^[a-z\-]/,I=/^[0-9a-fA-F]/,k=/^[+\-]/,C=/^[0-9]/,E=Ut("none"),j=Dt("none",!1),O=Dt(")",!1),R=Dt(",",!1),L=Ut("whitespace"),N=$t([" ","\t","\n","\r"],!1,!1),P=Ut("function"),F=Dt("(",!1),D=Ut("identifier"),$=$t([["a","z"],"-"],!1,!1),z=Ut("percentage"),U=Dt("%",!1),B=Ut("length"),G=Dt("px",!1),V=Dt("cm",!1),q=Dt("mm",!1),H=Dt("in",!1),W=Dt("pt",!1),Z=Dt("pc",!1),J=Ut("angle"),Y=Dt("deg",!1),K=Dt("rad",!1),Q=Dt("grad",!1),X=Dt("turn",!1),tt=Ut("number"),et=Ut("color"),it=Dt("#",!1),nt=$t([["0","9"],["a","f"],["A","F"]],!1,!1),st=$t(["+","-"],!1,!1),rt=$t([["0","9"]],!1,!1),ot=Dt(".",!1),at=Dt("e",!1),lt=function(){return[]},ut=function(t,e){return{type:"function",name:t,parameters:e||[]}},ct=function(t,e){return e.length>0?le(t,e,3):[t]},ht=function(t){return{type:"quantity",value:t.value,unit:t.unit}},dt=function(t){return{type:"color",colorType:t.type,value:t.value}},ft=function(t){return t},pt=function(){return Ft()},mt=function(t){return{value:t,unit:"%"}},yt=function(t){return{value:t,unit:"px"}},gt=function(t){return{value:t,unit:"cm"}},vt=function(t){return{value:t,unit:"mm"}},wt=function(t){return{value:t,unit:"in"}},bt=function(t){return{value:t,unit:"pt"}},St=function(t){return{value:t,unit:"pc"}},_t=function(t){return{value:t,unit:"deg"}},xt=function(t){return{value:t,unit:"rad"}},Mt=function(t){return{value:t,unit:"grad"}},Tt=function(t){return{value:t,unit:"turn"}},At=function(t){return{value:t,unit:null}},It=function(){return{type:"hex",value:Ft()}},kt=function(t){return{type:"function",value:t}},Ct=function(){return{type:"named",value:Ft()}},Et=function(){return parseFloat(Ft())},jt=0|e.peg$currPos,Ot=jt,Rt=[{line:1,column:1}],Lt=jt,Nt=e.peg$maxFailExpected||[],Pt=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in r))throw new Error("Can't start parsing from rule \""+e.startRule+'".');o=r[e.startRule]}function Ft(){return t.substring(Ot,jt)}function Dt(t,e){return{type:"literal",text:t,ignoreCase:e}}function $t(t,e,i){return{type:"class",parts:t,inverted:e,ignoreCase:i}}function zt(){return{type:"end"}}function Ut(t){return{type:"other",description:t}}function Bt(e){var i,n=Rt[e];if(n)return n;if(e>=Rt.length)i=Rt.length-1;else for(i=e;!Rt[--i];);for(n={line:(n=Rt[i]).line,column:n.column};i<e;)10===t.charCodeAt(i)?(n.line++,n.column=1):n.column++,i++;return Rt[e]=n,n}function Gt(t,e,i){var n=Bt(t),r=Bt(e);return{source:s,start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function Vt(t){jt<Lt||(jt>Lt&&(Lt=jt,Nt=[]),Nt.push(t))}function qt(t,e,i){return new elt(elt.buildMessage(t,e),t,e,i)}function Ht(){var t;return(t=Wt())===n&&(t=Zt()),t}function Wt(){var e,i;return Pt++,e=jt,Qt(),t.substr(jt,4)===a?(i=a,jt+=4):(i=n,0===Pt&&Vt(j)),i!==n?(Qt(),Ot=e,e=lt()):(jt=e,e=n),Pt--,e===n&&0===Pt&&Vt(E),e}function Zt(){var t,e;if(t=[],(e=Jt())!==n)for(;e!==n;)t.push(e),e=Jt();else t=n;return t}function Jt(){var e,i,s,r;return e=jt,Qt(),(i=Xt())!==n?(Qt(),(s=Yt())===n&&(s=null),Qt(),41===t.charCodeAt(jt)?(r=l,jt++):(r=n,0===Pt&&Vt(O)),r!==n?(Qt(),Ot=e,e=ut(i,s)):(jt=e,e=n)):(jt=e,e=n),e}function Yt(){var e,i,s,r,o,a,l,c;if(e=jt,(i=Kt())!==n){for(s=[],r=jt,o=Qt(),44===t.charCodeAt(jt)?(a=u,jt++):(a=n,0===Pt&&Vt(R)),a===n&&(a=null),l=Qt(),(c=Kt())!==n?r=o=[o,a,l,c]:(jt=r,r=n);r!==n;)s.push(r),r=jt,o=Qt(),44===t.charCodeAt(jt)?(a=u,jt++):(a=n,0===Pt&&Vt(R)),a===n&&(a=null),l=Qt(),(c=Kt())!==n?r=o=[o,a,l,c]:(jt=r,r=n);Ot=e,e=ct(i,s)}else jt=e,e=n;return e}function Kt(){var t,e;return t=jt,(e=ee())===n&&(e=ie())===n&&(e=ne())===n&&(e=se()),e!==n&&(Ot=t,e=ht(e)),(t=e)===n&&(t=jt,(e=re())!==n&&(Ot=t,e=dt(e)),t=e),t}function Qt(){var e,i;for(Pt++,e=[],i=t.charAt(jt),T.test(i)?jt++:(i=n,0===Pt&&Vt(N));i!==n;)e.push(i),i=t.charAt(jt),T.test(i)?jt++:(i=n,0===Pt&&Vt(N));return Pt--,i=n,0===Pt&&Vt(L),e}function Xt(){var e,i,s;return Pt++,e=jt,(i=te())!==n?(40===t.charCodeAt(jt)?(s=c,jt++):(s=n,0===Pt&&Vt(F)),s!==n?(Ot=e,e=ft(i)):(jt=e,e=n)):(jt=e,e=n),Pt--,e===n&&(i=n,0===Pt&&Vt(P)),e}function te(){var e,i,s;if(Pt++,e=jt,i=[],s=t.charAt(jt),A.test(s)?jt++:(s=n,0===Pt&&Vt($)),s!==n)for(;s!==n;)i.push(s),s=t.charAt(jt),A.test(s)?jt++:(s=n,0===Pt&&Vt($));else i=n;return i!==n&&(Ot=e,i=pt()),Pt--,(e=i)===n&&(i=n,0===Pt&&Vt(D)),e}function ee(){var e,i,s;return Pt++,e=jt,Qt(),(i=oe())!==n?(37===t.charCodeAt(jt)?(s=h,jt++):(s=n,0===Pt&&Vt(U)),s!==n?(Ot=e,e=mt(i)):(jt=e,e=n)):(jt=e,e=n),Pt--,e===n&&0===Pt&&Vt(z),e}function ie(){var e,i,s;return Pt++,e=jt,Qt(),(i=oe())!==n?(t.substr(jt,2)===d?(s=d,jt+=2):(s=n,0===Pt&&Vt(G)),s!==n?(Ot=e,e=yt(i)):(jt=e,e=n)):(jt=e,e=n),e===n&&(e=jt,Qt(),(i=oe())!==n?(t.substr(jt,2)===f?(s=f,jt+=2):(s=n,0===Pt&&Vt(V)),s!==n?(Ot=e,e=gt(i)):(jt=e,e=n)):(jt=e,e=n),e===n&&(e=jt,Qt(),(i=oe())!==n?(t.substr(jt,2)===p?(s=p,jt+=2):(s=n,0===Pt&&Vt(q)),s!==n?(Ot=e,e=vt(i)):(jt=e,e=n)):(jt=e,e=n),e===n&&(e=jt,Qt(),(i=oe())!==n?(t.substr(jt,2)===m?(s=m,jt+=2):(s=n,0===Pt&&Vt(H)),s!==n?(Ot=e,e=wt(i)):(jt=e,e=n)):(jt=e,e=n),e===n&&(e=jt,Qt(),(i=oe())!==n?(t.substr(jt,2)===y?(s=y,jt+=2):(s=n,0===Pt&&Vt(W)),s!==n?(Ot=e,e=bt(i)):(jt=e,e=n)):(jt=e,e=n),e===n&&(e=jt,Qt(),(i=oe())!==n?(t.substr(jt,2)===g?(s=g,jt+=2):(s=n,0===Pt&&Vt(Z)),s!==n?(Ot=e,e=St(i)):(jt=e,e=n)):(jt=e,e=n)))))),Pt--,e===n&&0===Pt&&Vt(B),e}function ne(){var e,i,s;return Pt++,e=jt,(i=oe())!==n?(t.substr(jt,3)===v?(s=v,jt+=3):(s=n,0===Pt&&Vt(Y)),s!==n?(Ot=e,e=_t(i)):(jt=e,e=n)):(jt=e,e=n),e===n&&(e=jt,(i=oe())!==n?(t.substr(jt,3)===w?(s=w,jt+=3):(s=n,0===Pt&&Vt(K)),s!==n?(Ot=e,e=xt(i)):(jt=e,e=n)):(jt=e,e=n),e===n&&(e=jt,(i=oe())!==n?(t.substr(jt,4)===b?(s=b,jt+=4):(s=n,0===Pt&&Vt(Q)),s!==n?(Ot=e,e=Mt(i)):(jt=e,e=n)):(jt=e,e=n),e===n&&(e=jt,(i=oe())!==n?(t.substr(jt,4)===S?(s=S,jt+=4):(s=n,0===Pt&&Vt(X)),s!==n?(Ot=e,e=Tt(i)):(jt=e,e=n)):(jt=e,e=n)))),Pt--,e===n&&(i=n,0===Pt&&Vt(J)),e}function se(){var t,e;return Pt++,t=jt,Qt(),(e=oe())!==n?(Ot=t,t=At(e)):(jt=t,t=n),Pt--,t===n&&0===Pt&&Vt(tt),t}function re(){var e,i,s,r;if(Pt++,e=jt,35===t.charCodeAt(jt)?(i=_,jt++):(i=n,0===Pt&&Vt(it)),i!==n){if(s=[],r=t.charAt(jt),I.test(r)?jt++:(r=n,0===Pt&&Vt(nt)),r!==n)for(;r!==n;)s.push(r),r=t.charAt(jt),I.test(r)?jt++:(r=n,0===Pt&&Vt(nt));else s=n;s!==n?(Ot=e,e=It()):(jt=e,e=n)}else jt=e,e=n;return e===n&&(e=jt,(i=Jt())!==n&&(Ot=e,i=kt(i)),(e=i)===n&&(e=jt,(i=te())!==n&&(Ot=e,i=Ct()),e=i)),Pt--,e===n&&(i=n,0===Pt&&Vt(et)),e}function oe(){var e,i,s,r,o,a,l,u;for(e=jt,i=t.charAt(jt),k.test(i)?jt++:(i=n,0===Pt&&Vt(st)),i===n&&(i=null),s=jt,r=[],o=t.charAt(jt),C.test(o)?jt++:(o=n,0===Pt&&Vt(rt));o!==n;)r.push(o),o=t.charAt(jt),C.test(o)?jt++:(o=n,0===Pt&&Vt(rt));if(46===t.charCodeAt(jt)?(o=x,jt++):(o=n,0===Pt&&Vt(ot)),o!==n){if(a=[],l=t.charAt(jt),C.test(l)?jt++:(l=n,0===Pt&&Vt(rt)),l!==n)for(;l!==n;)a.push(l),l=t.charAt(jt),C.test(l)?jt++:(l=n,0===Pt&&Vt(rt));else a=n;a!==n?s=r=[r,o,a]:(jt=s,s=n)}else jt=s,s=n;if(s===n)if(s=[],r=t.charAt(jt),C.test(r)?jt++:(r=n,0===Pt&&Vt(rt)),r!==n)for(;r!==n;)s.push(r),r=t.charAt(jt),C.test(r)?jt++:(r=n,0===Pt&&Vt(rt));else s=n;if(s!==n){if(r=jt,101===t.charCodeAt(jt)?(o=M,jt++):(o=n,0===Pt&&Vt(at)),o!==n){if(a=t.charAt(jt),k.test(a)?jt++:(a=n,0===Pt&&Vt(st)),a===n&&(a=null),l=[],u=t.charAt(jt),C.test(u)?jt++:(u=n,0===Pt&&Vt(rt)),u!==n)for(;u!==n;)l.push(u),u=t.charAt(jt),C.test(u)?jt++:(u=n,0===Pt&&Vt(rt));else l=n;l!==n?r=o=[o,a,l]:(jt=r,r=n)}else jt=r,r=n;r===n&&(r=null),Ot=e,e=Et()}else jt=e,e=n;return e}function ae(t,e){return t.map((function(t){return t[e]}))}function le(t,e,i){return[t].concat(ae(e,i))}if(i=o(),e.peg$library)return{peg$result:i,peg$currPos:jt,peg$FAILED:n,peg$maxFailExpected:Nt,peg$maxFailPos:Lt};if(i!==n&&jt===t.length)return i;throw i!==n&&jt<t.length&&Vt(zt()),qt(Nt,Lt<t.length?t.charAt(Lt):null,Lt<t.length?Gt(Lt,Lt+1):Gt(Lt,Lt))}function slt(t){if(!t||0===t.length)return null;if("string"==typeof t){const e=rlt(t);return e&&0!==e.length?e:null}const e=t.map((t=>{if(!Number.isFinite(t.scale)||t.scale<=0)throw new Ve("effect:invalid-scale","scale must be finite and greater than 0",{stop:t});return{scale:t.scale,effects:rlt(t.value)}}));e.sort(((t,e)=>e.effects.length-t.effects.length));for(let t=0;t<e.length-1;t++){if(!jk(e[t].effects,e[t+1].effects))throw new Ve("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[t].effects,b:e[t+1].effects});Ok(e[t].effects,e[t+1].effects)}return e.sort(((t,e)=>e.scale-t.scale)),e}function rlt(t){let e;if(!t)return[];try{e=nlt(t)}catch(e){throw new Ve("effect:invalid-syntax","Invalid effect syntax",{value:t,error:e})}return e.map((t=>olt(t)))}function olt(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return alt(t);case"opacity":return llt(t);case"hue-rotate":return ult(t);case"blur":return clt(t);case"drop-shadow":return hlt(t);case"bloom":return dlt(t)}}catch(e){throw e.details.filter=t,e}throw new Ve("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function alt(t){let e=1;return flt(t.parameters,1),1===t.parameters.length&&(e=_lt(t.parameters[0])),new Mk(t.name,e)}function llt(t){let e=1;return flt(t.parameters,1),1===t.parameters.length&&(e=_lt(t.parameters[0])),new Ik(e)}function ult(t){let e=0;return flt(t.parameters,1),1===t.parameters.length&&(e=Mlt(t.parameters[0])),new Ak(e)}function clt(t){let e=0;return flt(t.parameters,1),1===t.parameters.length&&(e=Tlt(t.parameters[0]),mlt(e,t.parameters[0])),new xk(e)}function hlt(t){const e=[];let i=null;for(const n of t.parameters)if("color"===n.type){if(e.length&&Object.freeze(e),i)throw new Ve("effect:type-error","Accepts only one color",{});i=Alt(n)}else{const t=Tlt(n);if(Object.isFrozen(e))throw new Ve("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(t),3===e.length&&mlt(t,n)}if(e.length<2||e.length>3)throw new Ve("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new Tk(e[0],e[1],e[2]||0,i||Ilt("black"))}function dlt(t){let e=1,i=0,n=0;return flt(t.parameters,3),t.parameters[0]&&(e=_lt(t.parameters[0])),t.parameters[1]&&(i=Tlt(t.parameters[1]),mlt(i,t.parameters[1])),t.parameters[2]&&(n=_lt(t.parameters[2])),new _k(e,i,n)}function flt(t,e){if(t.length>e)throw new Ve("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function plt(t){if("color"===t.type)return"<color>";if(t.unit){if(t.unit in blt)return"<length>";if(t.unit in vlt)return"<angle>";if("%"===t.unit)return"<percentage>"}return"<double>"}function mlt(t,e){if(t<0)throw new Ve("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function ylt(t){if("quantity"!==t.type||null!==t.unit)throw new Ve("effect:type-error",`Expected <double>, Actual: ${plt(t)}`,{term:t})}function glt(t){if("quantity"!==t.type||null!==t.unit&&"%"!==t.unit)throw new Ve("effect:type-error",`Expected <double> or <percentage>, Actual: ${plt(t)}`,{term:t})}tlt(elt,Error),elt.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var i,n=null;for(i=0;i<t.length;i++)if(t[i].source===this.location.source){n=t[i].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,r=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(s):s,o=this.location.source+":"+r.line+":"+r.column;if(n){var a=this.location.end,l=ilt("",r.line.toString().length," "),u=n[s.line-1],c=(s.line===a.line?a.column:u.length+1)-s.column||1;e+="\n --\x3e "+o+"\n"+l+" |\n"+r.line+" | "+u+"\n"+l+" | "+ilt("",s.column-1," ")+ilt("",c,"^")}else e+="\n at "+o}return e},elt.buildMessage=function(t,e){var i={literal:function(t){return'"'+s(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?r(t[0])+"-"+r(t[1]):r(t)}));return"["+(t.inverted?"^":"")+e.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function s(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function r(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function o(t){return i[t.type](t)}function a(t){var e,i,n=t.map(o);if(n.sort(),n.length>0){for(e=1,i=1;e<n.length;e++)n[e-1]!==n[e]&&(n[i]=n[e],i++);n.length=i}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}function l(t){return t?'"'+s(t)+'"':"end of input"}return"Expected "+a(t)+" but "+l(e)+" found."};const vlt={deg:1,grad:.9,rad:180/Math.PI,turn:360};function wlt(t){if("quantity"!==t.type||!(0===t.value&&null===t.unit||t.unit&&null!=vlt[t.unit]))throw new Ve("effect:type-error",`Expected <angle>, Actual: ${plt(t)}`,{term:t})}const blt={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function Slt(t){if("quantity"!==t.type||!(0===t.value&&null===t.unit||t.unit&&null!=blt[t.unit]))throw new Ve("effect:type-error",`Expected <length>, Actual: ${plt(t)}`,{term:t})}function _lt(t){glt(t);const e=t.value;return mlt(e,t),"%"===t.unit?.01*e:e}function xlt(t){return ylt(t),mlt(t.value,t),t.value}function Mlt(t){return wlt(t),t.value*vlt[t.unit]||0}function Tlt(t){return Slt(t),t.value*blt[t.unit]||0}function Alt(t){switch(t.colorType){case"hex":return kA(t.value);case"named":return Ilt(t.value);case"function":return Elt(t.value)}}function Ilt(t){if(!xA(t))throw new Ve("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return TA(t)}const klt=/^rgba?/i,Clt=/^hsla?/i;function Elt(t){if(flt(t.parameters,4),klt.test(t.name))return[_lt(t.parameters[0]),_lt(t.parameters[1]),_lt(t.parameters[2]),t.parameters[3]?_lt(t.parameters[3]):1];if(Clt.test(t.name))return IA(xlt(t.parameters[0]),_lt(t.parameters[1]),_lt(t.parameters[2]),t.parameters[3]?_lt(t.parameters[3]):1);throw new Ve("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function jlt(t,e,i){try{return Llt(t)}catch(t){i?.messages?.push(t)}return null}function Olt(t,e,i,n){try{const n=Rlt(t);gt(i,n,e)}catch(t){n.messages&&n.messages.push(t)}}function Rlt(t){const e=slt(t);return e?Rk(e)?e.map((t=>t.toJSON())):e.map((({scale:t,effects:e})=>({scale:t,value:e.map((t=>t.toJSON()))}))):null}function Llt(t){if(!t||0===t.length)return null;if(Nlt(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:Plt(i.value)});return e}return Plt(t)}function Nlt(t){const e=t[0];return!!e&&"scale"in e}function Plt(t){if(!t?.length)return"";const e=[];for(const i of t){let t=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":t=[Flt(i,"amount")];break;case"blur":t=[Flt(i,"radius","pt")];break;case"hue-rotate":t=[Flt(i,"angle","deg")];break;case"drop-shadow":t=[Flt(i,"xoffset","pt"),Flt(i,"yoffset","pt"),Flt(i,"blurRadius","pt"),Dlt(i,"color")];break;case"bloom":t=[Flt(i,"strength"),Flt(i,"radius","pt"),Flt(i,"threshold")]}const n=`${i.type}(${t.filter(Boolean).join(" ")})`;slt(n),e.push(n)}return e.join(" ")}function Flt(t,e,i){if(null==t[e])throw new Ve("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function Dlt(t,e){if(null==t[e])throw new Ve("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const $lt={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}},zlt={read:{reader:jlt},write:{allowNull:!0,writer:Olt}},Ult={json:{read:!1,write:!1,origins:{"web-map":zlt,"portal-item":zlt}}},Blt=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return r([Je($lt)],e.prototype,"blendMode",void 0),r([Je(Ult)],e.prototype,"effect",void 0),e=r([ln("esri.layers.mixins.BlendLayer")],e),e};const Glt=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return r([Je({type:Object,json:{write:{overridePolicy:t=>({enabled:!!(t&&Object.keys(t).length>0)})}}})],e.prototype,"customParameters",void 0),e=r([ln("esri.layers.mixins.CustomParametersMixin")],e),e};const Vlt=e1(),qlt=new Map,Hlt=new Map;async function Wlt(t,e,i){if(!t||!i)return!1;if(!e)return!0;const n=new URL(t).host;let s=qlt.get(n);if(!s){const e=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");s=(await Pl(e,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return s===e}async function Zlt(t,e,i=!1){if(!t||!e)return!0;const n=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),s=Hlt.get(n)?.entries();if(s)for(const[t,r]of s)if(r.name===e){const e=!r.stack?.hasForwardEdits();if(!e&&i){const[{deleteForwardEdits:e},{default:i}]=await Promise.all([import("./p-5ed8cabb.js"),import("./p-910555d0.js")]),s=await e(n,t,new i({sessionId:Vlt,moment:r.moment}));return s.success&&r.stack?.clearForwardEdits(),s.success}return e}return!0}function Jlt(t,e){if(!t)return!1;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),n=Hlt.get(i)?.entries();if(n)for(const[t,i]of n)if(i.name===e){return"edit"===i.lockType}return!1}const Ylt=new Tm.EventEmitter;function Klt(t){return Ylt.on("apply-edits",new WeakRef(t))}function Qlt(t){return Ylt.on("update-moment",new WeakRef(t))}function Xlt(t,e,i=null,n=!1){const s=zs();return n=null==e||n,Ylt.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:i,mayReceiveServiceEdits:n,result:s.promise}),s}const tut=Symbol();function eut(t){return null!=t&&"object"==typeof t&&tut in t}function iut(t){return null!=t&&"object"==typeof t&&"gdbVersion"in t}function nut(t,e,i){const n=new URL(t).host,s=qlt.get(n),r=t=>!t||t===s;return r(e)&&r(i)||e===i}const sut=t=>{var e;let i=class extends t{constructor(...t){super(...t),this[e]=!0,this._applyEditsHandler=t=>{const{serviceUrl:e,layerId:i,gdbVersion:n,mayReceiveServiceEdits:s,result:r}=t,o=e===this.url,a=null!=i&&null!=this.layerId&&i===this.layerId,l=iut(this),u=iut(this)&&nut(e,n,this.gdbVersion);if(!o||l&&!u||!a&&!s)return;const c=r.then((t=>{if(this.lastEditsEventDate=new Date,a&&(t.addedFeatures.length||t.updatedFeatures.length||t.deletedFeatures.length||t.addedAttachments.length||t.updatedAttachments.length||t.deletedAttachments.length))return this.emit("edits",nt(t)),t;const i=t.editedFeatures?.find((({layerId:t})=>t===this.layerId));if(i){const{adds:e,updates:n,deletes:s}=i.editedFeatures,r={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:e?e.map((({attributes:t})=>({objectId:this.objectIdField&&t[this.objectIdField],globalId:this.globalIdField&&t[this.globalIdField]}))):[],deletedFeatures:s?s.map((({attributes:t})=>({objectId:this.objectIdField&&t[this.objectIdField],globalId:this.globalIdField&&t[this.globalIdField]}))):[],updatedFeatures:n?n.map((({current:{attributes:t}})=>({objectId:this.objectIdField&&t[this.objectIdField],globalId:this.globalIdField&&t[this.globalIdField]}))):[],editedFeatures:nt(t.editedFeatures),exceededTransferLimit:!1,historicMoment:nt(t.historicMoment)};return this.emit("edits",r),r}const s={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:nt(t.editedFeatures),exceededTransferLimit:!1,historicMoment:nt(t.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(e,n,s.historicMoment)&&this.emit("edits",s),s})).then((t=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(e,n,t.historicMoment)&&(this.historicMoment=t.historicMoment),t)));this.emit("apply-edits",{result:c})},this._updateMomentHandler=t=>{const{serviceUrl:e,gdbVersion:i,moment:n}=t,s=e===this.url,r=iut(this),o=iut(this)&&nut(e,i,this.gdbVersion),a=iut(this)&&!nut(e,this.gdbVersion,null);s&&r&&o&&a&&"historicMoment"in this&&this.historicMoment!==n&&(this.historicMoment=n)},this.when().then((()=>{this.addHandles(Klt(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(Qlt(this._updateMomentHandler))}),(()=>{}))}_shouldUpdateHistoricMoment(t,e,i){return"historicMoment"in this&&this.historicMoment!==i&&Jlt(t,e)}};return e=tut,r([Je()],i.prototype,"lastEditsEventDate",void 0),i=r([ln("esri.layers.mixins.EditBusLayer")],i),i};var rut;const out=new Co({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),aut=new Co({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let lut=rut=class extends Io{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:n,timeExtent:s,objectIds:r,units:o,distance:a}=this;return new V$({geometry:nt(i),objectIds:nt(r),spatialRelationship:n,timeExtent:nt(s),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:n,objectIds:s,units:r,distance:o}=this;return new rut({geometry:nt(e),objectIds:nt(s),spatialRelationship:i,timeExtent:nt(n),where:t,units:r,distance:o})}};r([Je({type:String,json:{write:!0}})],lut.prototype,"where",void 0),r([Je({types:um,json:{write:!0}})],lut.prototype,"geometry",void 0),r([Je({type:out.apiValues,json:{name:"spatialRel",read:{reader:out.read},write:{allowNull:!1,writer:out.write,overridePolicy(){return{enabled:null!=this.geometry}}}}})],lut.prototype,"spatialRelationship",void 0),r([Je({type:Number,json:{write:{overridePolicy(t){return{enabled:null!=t&&null!=this.geometry}}}}})],lut.prototype,"distance",void 0),r([Je({type:[Number],json:{write:!0}})],lut.prototype,"objectIds",void 0),r([Je({type:aut.apiValues,json:{read:aut.read,write:{writer:aut.write,overridePolicy(t){return{enabled:null!=t&&null!=this.geometry}}}}})],lut.prototype,"units",void 0),r([Je({type:MC,json:{write:!0}})],lut.prototype,"timeExtent",void 0),lut=rut=r([ln("esri.layers.support.FeatureFilter")],lut);const uut=lut;var cut;const hut={read:{reader:jlt},write:{writer:Olt,overridePolicy(){return{allowNull:null!=this.excludedEffect,isRequired:null==this.excludedEffect}}}},dut={read:{reader:jlt},write:{writer:Olt,overridePolicy(){return{allowNull:null!=this.includedEffect,isRequired:null==this.includedEffect}}}},fut={name:"showExcludedLabels",default:!0};let put=cut=class extends Io{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){const i=super.write(t,e);if(e?.origin){if(i.filter){const t=Object.keys(i.filter);if(t.length>1||"where"!==t[0])return e.messages?.push(new Ve("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in i)return e.messages?.push(new Ve("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return i}clone(){return new cut({filter:null!=this.filter?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};r([Je({type:uut,json:{write:{allowNull:!0,writer(t,e,i,n){const s=t?.write({},n);s&&0!==Object.keys(s).length?gt(i,s,e):gt(i,null,e)}}}})],put.prototype,"filter",void 0),r([Je({json:{read:jlt,write:{writer:Olt,allowNull:!0},origins:{"web-map":hut,"portal-item":hut}}})],put.prototype,"includedEffect",void 0),r([Je({json:{read:jlt,write:{writer:Olt,allowNull:!0},origins:{"web-map":dut,"portal-item":dut}}})],put.prototype,"excludedEffect",void 0),r([Je({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":fut,"portal-item":fut}}})],put.prototype,"excludedLabelsVisible",void 0),put=cut=r([ln("esri.layers.support.FeatureEffect")],put);const mut=put;const yut={write:{allowNull:!0}},gut={type:mut,json:{origins:{"web-map":yut,"portal-item":yut}}},vut=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return r([Je(gut)],e.prototype,"featureEffect",void 0),e=r([ln("esri.layers.mixins.FeatureEffectLayer")],e),e};var wut;let but=wut=class extends Io{constructor(t){super(t)}async collectRequiredFields(t,e){return tj(t,e,this.expression)}clone(){return new wut({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};r([Je({type:String,json:{write:!0}})],but.prototype,"expression",void 0),r([Je({type:String,json:{write:!0}})],but.prototype,"title",void 0),but=wut=r([ln("esri.symbols.support.FeatureExpressionInfo")],but);const Sut=but;function _ut(t){return 1/(i9[t]||1)}function xut(){const t=Object.keys(i9);return k(t,"decimal-degrees"),t.sort(),t}const Mut=xut();var Tut;const Aut=Oo()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),Iut=new Co({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let kut=Tut=class extends Io{constructor(t){super(t),this.offset=null}readFeatureExpressionInfo(t,e){return null!=t?t:e.featureExpression&&0===e.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(t,e,i,n){e[i]=t.write({},n),"0"===t.expression&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):null!=t||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new Tut({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&jn(this.featureExpressionInfo,t.featureExpressionInfo)}};r([Je({type:Sut,json:{write:!0}})],kut.prototype,"featureExpressionInfo",void 0),r([ko("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],kut.prototype,"readFeatureExpressionInfo",null),r([yh("featureExpressionInfo",{featureExpressionInfo:{type:Sut},"featureExpression.value":{type:[0]}})],kut.prototype,"writeFeatureExpressionInfo",null),r([Je({type:Aut.apiValues,nonNullable:!0,json:{type:Aut.jsonValues,read:Aut.read,write:{writer:Aut.write,isRequired:!0}}})],kut.prototype,"mode",null),r([Je({type:Number,json:{write:!0}})],kut.prototype,"offset",void 0),r([Je({type:Mut,json:{type:String,read:Iut.read,write:Iut.write}})],kut.prototype,"unit",null),kut=Tut=r([ln("esri.symbols.support.ElevationInfo")],kut);const Cut=kut;let Eut=class extends Io{constructor(t){super(t),this.description=null,this.label=null,this.type=null}};r([Je({type:String,json:{write:!0}})],Eut.prototype,"description",void 0),r([Je({type:String,json:{write:!0}})],Eut.prototype,"label",void 0),r([Je()],Eut.prototype,"type",void 0),Eut=r([ln("esri.tables.elements.AttributeTableElement")],Eut);const jut=Eut;var Out;let Rut=Out=class extends jut{constructor(t){super(t),this.displayType="auto",this.type="attachment"}clone(){return new Out({description:this.description,displayType:this.displayType,label:this.label})}};r([Je({type:["auto"],json:{write:!0}})],Rut.prototype,"displayType",void 0),r([Je({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Rut.prototype,"type",void 0),Rut=Out=r([ln("esri.tables.elements.AttributeTableAttachmentElement")],Rut);const Lut=Rut;var Nut;let Put=Nut=class extends jut{constructor(t){super(t),this.fieldName=null,this.type="field"}clone(){return new Nut({description:this.description,fieldName:this.fieldName,label:this.label})}};r([Je({type:String,json:{write:!0}})],Put.prototype,"fieldName",void 0),r([Je({type:String,json:{read:!1,write:!0}})],Put.prototype,"type",void 0),Put=Nut=r([ln("esri.tables.elements.AttributeTableFieldElement")],Put);const Fut=Put;var Dut;let $ut=Dut=class extends jut{constructor(t){super(t),this.relationshipId=null,this.type="relationship"}clone(){return new Dut({description:this.description,label:this.label,relationshipId:this.relationshipId})}};r([Je({type:Number,json:{write:!0}})],$ut.prototype,"relationshipId",void 0),r([Je({type:["relationship"],json:{read:!1,write:!0}})],$ut.prototype,"type",void 0),$ut=Dut=r([ln("esri.tables.elements.AttributeTableRelationshipElement")],$ut);const zut=$ut;function Uut(t){return{typesWithGroup:{base:jut,key:"type",typeMap:{attachment:Lut,field:Fut,group:t,relationship:zut}},typesWithoutGroup:{base:jut,key:"type",typeMap:{attachment:Lut,field:Fut,relationship:zut}}}}function But(t,e,i=!0){if(!t)return null;const n=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>n[t.type])).map((t=>n[t.type].fromJSON(t)))}function Gut(t,e,i=!0){if(!t)return null;const n=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>n[t.type])).map((t=>t.toJSON()))}function Vut(t,e,i=!0){return t?t.map((t=>ue(i?e.typesWithGroup:e.typesWithoutGroup,t))):null}var qut;let Hut=qut=class extends jut{constructor(t){super(t),this.elements=null,this.type="group"}castElements(t){return Vut(t,Wut,!1)}readElements(t,e){return But(e.attributeTableElements,Wut,!1)}writeElements(t,e){e.attributeTableElements=Gut(t,Wut,!1)}clone(){return new qut({description:this.description,elements:nt(this.elements),label:this.label})}};r([Je({json:{write:!0}})],Hut.prototype,"elements",void 0),r([Ah("elements")],Hut.prototype,"castElements",null),r([ko("elements",["attributeTableElements"])],Hut.prototype,"readElements",null),r([yh("elements")],Hut.prototype,"writeElements",null),r([Je({type:String,json:{read:!1,write:!0}})],Hut.prototype,"type",void 0),Hut=qut=r([ln("esri.tables.elements.AttributeTableGroupElement")],Hut);const Wut=Uut(Hut),Zut=Hut;var Jut;const Yut=Uut(Zut);let Kut=Jut=class extends Io{constructor(t){super(t),this.elements=null,this.orderByFields=null}castElements(t){return Vut(t,Yut)}readElements(t,e){return But(e.attributeTableElements,Yut)}writeElements(t,e){e.attributeTableElements=Gut(t,Yut)}clone(){return new Jut({elements:nt(this.elements),orderByFields:this.orderByFields})}};r([Je({json:{write:!0}})],Kut.prototype,"elements",void 0),r([Ah("elements")],Kut.prototype,"castElements",null),r([ko("elements",["attributeTableElements"])],Kut.prototype,"readElements",null),r([yh("elements")],Kut.prototype,"writeElements",null),r([Je({type:[Object],json:{write:!0}})],Kut.prototype,"orderByFields",void 0),Kut=Jut=r([ln("esri.tables.AttributeTableTemplate")],Kut);const Qut=Kut;const Xut={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:Wrt}}},tct={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},ect={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:Wrt}}},ict={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:bT}}},nct={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:Wrt}}},sct={value:null,type:Cut,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:Wrt}}};function rct(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const oct={write:{enabled:!0,layerContainerTypes:Wrt},read:!0},act={type:Number,json:{origins:{"web-document":oct,"portal-item":{write:!0}}}},lct={...act,json:{...act.json,origins:{"web-document":{...oct,write:{enabled:!0,layerContainerTypes:Wrt,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>i&&"service"!==i.origin||!e.drawingInfo||void 0===e.drawingInfo.transparency?e.layerDefinition?.drawingInfo&&void 0!==e.layerDefinition.drawingInfo.transparency?$A(e.layerDefinition.drawingInfo.transparency):void 0:$A(e.drawingInfo.transparency)}}},uct={type:Od,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=Od.fromJSON(t);return null!=e.spatialReference&&"object"==typeof e.spatialReference&&(i.spatialReference=wh.fromJSON(e.spatialReference)),i}}}},read:!1}},cct={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},hct={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:Wrt}}},name:"layerDefinition.minScale",write:!0}},dct={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:Wrt}}},name:"layerDefinition.maxScale",write:!0}},fct={json:{write:{ignoreOrigin:!0,layerContainerTypes:Wrt},origins:{"web-map":{read:!1,write:!1}}}},pct={type:Qut,json:{name:"attributeTableInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}};let mct=class extends(cm(Io)){constructor(t){super(t),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};r([Je()],mct.prototype,"creatorField",void 0),r([Je()],mct.prototype,"creationDateField",void 0),r([Je()],mct.prototype,"editorField",void 0),r([Je()],mct.prototype,"editDateField",void 0),r([Je()],mct.prototype,"realm",void 0),r([Je(fg("dateFieldsTimeReference",!0))],mct.prototype,"timeZone",void 0),mct=r([ln("esri.layers.support.EditFieldsInfo")],mct);const yct=mct;let gct=class extends(cm(Io)){constructor(t){super(t)}};r([Je({constructOnly:!0,json:{write:!0}})],gct.prototype,"name",void 0),r([Je({constructOnly:!0,json:{write:!0}})],gct.prototype,"fields",void 0),r([Je({constructOnly:!0,json:{write:!0}})],gct.prototype,"isAscending",void 0),r([Je({constructOnly:!0,json:{write:!0}})],gct.prototype,"indexType",void 0),r([Je({constructOnly:!0,json:{write:!0}})],gct.prototype,"isUnique",void 0),r([Je({constructOnly:!0,json:{write:!0}})],gct.prototype,"description",void 0),gct=r([ln("esri.layers.support.FeatureIndex")],gct);async function vct(t,e,i){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=Sct(t));const n=wct(t),s=t.capabilities.query.supportsPagination;e.start=0,e.num=n;let r=null;for(;;){const o=await t.source.queryFeaturesJSON(e,i);if(null==r?r=o:r.features=r.features.concat(o.features),r.exceededTransferLimit=o.exceededTransferLimit,!s||!o.exceededTransferLimit)break;e.start+=n}return r}function wct(t){return Sct(t)*bct(t)}function bct(t){return t.capabilities.query.maxRecordCount||2e3}function Sct(t){return t.capabilities.query.supportsMaxRecordCountFactor?V$.MAX_MAX_RECORD_COUNT_FACTOR:1}var _ct;let xct=_ct=class extends Io{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new _ct(nt({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};r([Je({type:[String],json:{write:!0}})],xct.prototype,"attachmentTypes",void 0),r([Je({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],xct.prototype,"attachmentsWhere",void 0),r([Je({type:Boolean,json:{write:!0}})],xct.prototype,"cacheHint",void 0),r([Je({type:[String],json:{write:!0}})],xct.prototype,"keywords",void 0),r([Je({type:[String],json:{write:!0}})],xct.prototype,"globalIds",void 0),r([Je({json:{write:!0}})],xct.prototype,"name",void 0),r([Je({type:Number,json:{read:{source:"resultRecordCount"}}})],xct.prototype,"num",void 0),r([Je({type:[Number],json:{write:!0}})],xct.prototype,"objectIds",void 0),r([Je({type:Boolean,json:{default:!1,write:!0}})],xct.prototype,"returnMetadata",void 0),r([Je({type:[Number],json:{write:!0}})],xct.prototype,"size",void 0),r([Je({type:Number,json:{read:{source:"resultOffset"}}})],xct.prototype,"start",void 0),r([yh("start"),yh("num")],xct.prototype,"writeStart",null),r([Je({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],xct.prototype,"where",void 0),xct=_ct=r([ln("esri.rest.support.AttachmentQuery")],xct),xct.from=ee(xct);const Mct=xct;var Tct;let Act=Tct=class extends Io{constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(e.definitionExpression="1=1")}clone(){return new Tct(nt({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};r([Je({type:Boolean,json:{write:!0}})],Act.prototype,"cacheHint",void 0),r([Je({type:C$,json:{write:!0}})],Act.prototype,"dynamicDataSource",void 0),r([Je({type:String,json:{write:!0}})],Act.prototype,"gdbVersion",void 0),r([Je({type:Number,json:{write:!0}})],Act.prototype,"geometryPrecision",void 0),r([Je({type:Date})],Act.prototype,"historicMoment",void 0),r([yh("historicMoment")],Act.prototype,"_writeHistoricMoment",null),r([Je({type:Number,json:{write:!0}})],Act.prototype,"maxAllowableOffset",void 0),r([Je({json:{write:!0}})],Act.prototype,"objectIds",void 0),r([Je({type:[String],json:{write:!0}})],Act.prototype,"orderByFields",void 0),r([Je({type:[String],json:{write:!0}})],Act.prototype,"outFields",void 0),r([Je({type:wh,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Act.prototype,"outSpatialReference",void 0),r([Je({json:{write:!0}})],Act.prototype,"relationshipId",void 0),r([Je({type:Number,json:{read:{source:"resultOffset"}}})],Act.prototype,"start",void 0),r([yh("start"),yh("num")],Act.prototype,"writeStart",null),r([Je({type:Number,json:{read:{source:"resultRecordCount"}}})],Act.prototype,"num",void 0),r([Je({json:{write:!0}})],Act.prototype,"returnGeometry",void 0),r([Je({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Act.prototype,"returnM",void 0),r([Je({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Act.prototype,"returnZ",void 0),r([Je({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Act.prototype,"where",void 0),Act=Tct=r([ln("esri.rest.support.RelationshipQuery")],Act),Act.from=ee(Act);const Ict=Act;const kct=Object.freeze({__proto__:null,default:Ict});const Cct=new Co({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function Ect(t,e,i,n){const s=await Kct(t);if(await jct(t,e,n),!s.addAttachment)throw new Ve(n,"Layer source does not support addAttachment capability");return s.addAttachment(e,i)}function jct(t,e,i){const{attributes:n}=e,{objectIdField:s}=t;return t.capabilities?.data?.supportsAttachment?e?n?s&&n[s]?Promise.resolve():Promise.reject(new Ve(i,`feature is missing the identifying attribute ${s}`)):Promise.reject(new Ve(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new Ve(i,"A feature is required to add/delete/update attachments")):Promise.reject(new Ve(i,"this layer doesn't support attachments"))}async function Oct(t,e,i,n,s){const r=await Kct(t);if(await jct(t,e,s),!r.updateAttachment)throw new Ve(s,"Layer source does not support updateAttachment capability");return r.updateAttachment(e,i,n)}async function Rct(t,e,i){const{applyEdits:n}=await import("./p-572c8d83.js"),s=await t.load();let r=i;return"feature"===s.type&&s.infoFor3D&&null!=e.deleteFeatures&&null!=s.globalIdField&&(r={...r,globalIdToObjectId:await sht(s,e.deleteFeatures,s.globalIdField)}),n(s,s.source,e,i)}async function Lct(t,e,i){const{uploadAssets:n}=await import("./p-572c8d83.js"),s=await t.load();return n(s,s.source,e,i)}async function Nct(t,e,i,n){const s=await Kct(t);if(await jct(t,e,n),!s.deleteAttachments)throw new Ve(n,"Layer source does not support deleteAttachments capability");return s.deleteAttachments(e,i)}async function Pct(t,e,i){const n=(await t.load({signal:e?.signal})).source;if(!n.fetchRecomputedExtents)throw new Ve(i,"Layer source does not support fetchUpdates capability");return n.fetchRecomputedExtents(e)}async function Fct(t,e,i,n){e=Mct.from(e),await t.load();const s=t.source,r=t.capabilities;if(!r?.data?.supportsAttachment)throw new Ve(n,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:l,num:u,size:c,start:h,where:d}=e;if(!r?.operations?.supportsQueryAttachments){if(o?.length>0||l?.length>0||c?.length>0||u||h||d)throw new Ve(n,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e)}if(!(a?.length||l?.length||d))throw new Ve(n,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!s.queryAttachments)throw new Ve(n,"Layer source does not support queryAttachments capability",e);return s.queryAttachments(e)}async function Dct(t,e,i,n){const s=await Kct(t);if(!s.queryObjectIds)throw new Ve(n,"Layer source does not support queryObjectIds capability");return s.queryObjectIds(V$.from(e)??t.createQuery(),i)}async function $ct(t,e,i,n){const s=await Kct(t);if(!s.queryFeatureCount)throw new Ve(n,"Layer source does not support queryFeatureCount capability");return s.queryFeatureCount(V$.from(e)??t.createQuery(),i)}async function zct(t,e,i,n){const s=await Kct(t);if(!s.queryExtent)throw new Ve(n,"Layer source does not support queryExtent capability");return s.queryExtent(V$.from(e)??t.createQuery(),i)}async function Uct(t,e,i,n){const s=await Kct(t);if(!s.queryRelatedFeatures)throw new Ve(n,"Layer source does not support queryRelatedFeatures capability");return s.queryRelatedFeatures(Ict.from(e),i)}async function Bct(t,e,i,n){const s=await Kct(t);if(!s.queryRelatedFeaturesCount)throw new Ve(n,"Layer source does not support queryRelatedFeaturesCount capability");return s.queryRelatedFeaturesCount(Ict.from(e),i)}async function Gct(t){const e=t.source;if(e?.refresh)try{const{dataChanged:i,updates:n}=await e.refresh();if(null!=n&&(t.sourceJSON={...t.sourceJSON,...n},t.read(n,{origin:"service",url:t.parsedUrl})),i)return!0}catch{}if(t.definitionExpression)try{return(await WC(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function Vct(t){const e=new V$,i=t.capabilities?.data,n=t.capabilities?.query;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,n&&(e.compactGeometryEnabled=n.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=n.supportsDefaultSpatialReference),i&&(i.supportsZ&&null!=t.returnZ&&(e.returnZ=t.returnZ),i.supportsM&&null!=t.returnM&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:s,timeExtent:r}=t;return e.timeExtent=null!=s&&null!=r?r.offset(-s.value,s.unit):r||null,e.multipatchOption="multipatch"===t.geometryType?"xyFootprint":null,e}function qct(t){const{globalIdField:e,fields:i}=t;if(e)return e;if(i)for(const t of i)if("esriFieldTypeGlobalID"===t.type)return t.name}function Hct(t){const{objectIdField:e,fields:i}=t;if(e)return e;if(i)for(const t of i)if("esriFieldTypeOID"===t.type)return t.name}function Wct(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function Zct(t,e){const{subtypes:i,subtypeField:n}=t;if(!e?.attributes||!i?.length||!n)return null;const s=e.attributes[n];return null==s?null:i.find((t=>t.code===s))}function Jct(t,e){const{fieldsIndex:i,subtypeField:n}=t,{name:s}=i.get(e)??{};if(!s)return null;if((n&&i.get(n)?.name)===s&&t.subtypes?.length){const e=t.subtypes.map((t=>new HD({code:t.code,name:t.name})));if(e?.length)return new QD({codedValues:e})}return null}function Yct(t,e){const{fieldsIndex:i}=t,{name:n}=i.get(e)??{};if(!n)return null;if(("typeIdField"in t?i.get(t.typeIdField)?.name:null)===n&&"types"in t&&t.types?.length){const e=t.types.map((t=>new HD({code:t.id,name:t.name})));return new QD({codedValues:e})}return null}async function Kct(t){return(await t.load()).source}async function Qct(t,e){if(!Sl)return;if(Sl.findCredential(t))return;let i;try{const n=await eA(t,e);n&&(i=await Sl.checkSignInStatus(`${n}/sharing`))}catch(t){}if(i)try{const i=null!=e?e.signal:null;await Sl.getCredential(t,{signal:i})}catch(t){}}async function Xct(t,e,i){const n=t.parsedUrl?.path;n&&t.authenticationTriggerEvent===e&&await Qct(n,i)}function tht(t){return!oht(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const eht=xi({types:xD});function iht(t,e){if(t.defaultSymbol)return t.types?.length?new Frt({defaultSymbol:eht(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map((t=>({id:t.id,symbol:eht(t.symbol,t,e)})))}):new Jst({symbol:eht(t.defaultSymbol,t,e)})}function nht(t){let e=t.sourceJSON?.cacheMaxAge;if(!e)return!1;const i=t.editingInfo?.lastEditDate?.getTime();return null==i||(e*=1e3,Date.now()-i<e)}async function sht(t,e,i){if(null==e)return null;const n=[],{objectIdField:s}=t;if(e.forEach((t=>{let e=null;if("attributes"in t){const{attributes:n}=t;e={globalId:n[i],objectId:null!=n[s]&&-1!==n[s]?n[s]:null}}else e={globalId:t.globalId,objectId:null!=t.objectId&&-1!==t.objectId?t.objectId:null};null!=e.globalId&&(null!=e.objectId&&-1!==e.objectId||n.push(e.globalId))})),0===n.length)return null;const r=t.createQuery();r.where=n.map((t=>`${i}='${t}'`)).join(" OR "),r.returnGeometry=!1,r.outFields=[s,i],r.cacheHint=!1;const o=await Qm(vct(t,r));if(!o.ok)return null;const a=new Map,l=o.value.features;for(const t of l){const e=t.attributes[i],n=t.attributes[s];null!=e&&null!=n&&-1!==n&&a.set(e,n)}return a}function rht(t,e,i){if(!e||!i||!t)return null;const n=i.getAttribute(e);return null==n?null:t.find((t=>{const{id:e}=t;return null!=e&&e.toString()===n.toString()}))??null}function oht(t){return t.sourceJSON?.isMultiServicesView||aht(t)}function aht(t){return!!t.sourceJSON?.capabilities?.toLowerCase().split(",").map((t=>t.trim())).includes("map")}function lht(t,e,i){const n=e?.queryBins;if(!n)throw new Ve(i,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!n.supportsAutoInterval)throw new Ve(i,"Layer source does not support auto-interval binning");break;case"date":if(!n.supportsDate)throw new Ve(i,"Layer source does not support date binning");break;case"fixed-boundaries":if(!n.supportsFixedBoundaries)throw new Ve(i,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!n.supportsFixedInterval)throw new Ve(i,"Layer source does not support fixed-interval binning")}const s=n?.supportedStatistics;if(t.outStatistics&&s){const e=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:n}of t.outStatistics){const t=e.get(n);if(t&&!s[t])throw new Ve(i,`Layer source does not support ${n} statistic type`)}}}let uht=class extends(cm(Io)){constructor(t){super(t),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};r([Je({type:String,json:{read:{source:"shapeAreaFieldName"}}})],uht.prototype,"shapeAreaField",void 0),r([Je({type:String,json:{read:{source:"shapeLengthFieldName"}}})],uht.prototype,"shapeLengthField",void 0),r([Je({type:String,json:{read:t=>fh.read(t)||ph.read(t)}})],uht.prototype,"units",void 0),uht=r([ln("esri.layers.support.GeometryFieldsInfo")],uht);const cht=uht;var hht;let dht=hht=class extends Io{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new Vm}clone(){return new hht({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};r([Je({type:String,json:{write:!0}})],dht.prototype,"floorField",void 0),r([Je({json:{read:!1,write:!1}})],dht.prototype,"viewAllMode",void 0),r([Je({json:{read:!1,write:!1}})],dht.prototype,"viewAllLevelIds",void 0),dht=hht=r([ln("esri.layers.support.LayerFloorInfo")],dht);const fht=dht;const pht=new Co({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),mht=new Co({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let yht=class extends(cm(Io)){constructor(t){super(t),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};r([Je({json:{read:pht.read,write:pht.write}})],yht.prototype,"cardinality",void 0),r([Je({json:{read:!0,write:!0}})],yht.prototype,"composite",void 0),r([Je({json:{read:!0,write:!0}})],yht.prototype,"id",void 0),r([Je({json:{read:!0,write:!0}})],yht.prototype,"keyField",void 0),r([Je({json:{read:!0,write:!0}})],yht.prototype,"keyFieldInRelationshipTable",void 0),r([Je({json:{read:!0,write:!0}})],yht.prototype,"name",void 0),r([Je({json:{read:!0,write:!0}})],yht.prototype,"relatedTableId",void 0),r([Je({json:{read:!0,write:!0}})],yht.prototype,"relationshipTableId",void 0),r([Je({json:{read:mht.read,write:mht.write}})],yht.prototype,"role",void 0),yht=r([ln("esri.layers.support.Relationship")],yht);const ght=yht;function vht(t,e,i){return!!bht(t,e,i)}function wht(t,e,i){return bht(t,e,i)}function bht(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}const Sht={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function _ht(t){const e=t?.supportedSpatialAggregationStatistics?.map((t=>t.toLowerCase()));return{envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function xht(t,e){const i=t?.supportedOperationsWithCacheHint?.map((t=>t.toLowerCase()));return!!i?.includes(e.toLowerCase())}function Mht(t){const e=t?.supportedStatisticTypes?.map((t=>t.toLowerCase()));return{count:!!e?.includes("count"),sum:!!e?.includes("sum"),min:!!e?.includes("min"),max:!!e?.includes("max"),avg:!!e?.includes("avg"),var:!!e?.includes("var"),stddev:!!e?.includes("stddev"),percentileContinuous:!!e?.includes("percentile_continuous"),percentileDiscrete:!!e?.includes("percentile_discrete"),envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function Tht(t,e){return{analytics:Aht(t),attachment:Iht(t),data:kht(t),metadata:Cht(t),operations:Eht(t.capabilities,t,e),query:jht(t,e),queryBins:Lht(t),queryRelated:Oht(t),queryTopFeatures:Rht(t),editing:Nht(t)}}function Aht(t){return{supportsCacheHint:xht(t.advancedQueryCapabilities,"queryAnalytics")}}function Iht(t){const e=t.attachmentProperties,i={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:xht(t.advancedQueryCapabilities,"queryAttachments"),supportsResize:vht(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach((t=>{const e=Sht[t.name];e&&(i[e]=!!t.isEnabled)})),i}function kht(t){return{isVersioned:vht(t,"isDataVersioned",!1),isBranchVersioned:vht(t,"isDataBranchVersioned",!1),supportsAttachment:vht(t,"hasAttachments",!1),supportsM:vht(t,"hasM",!1),supportsZ:vht(t,"hasZ",!1)}}function Cht(t){return{supportsAdvancedFieldProperties:vht(t,"supportsFieldDescriptionProperty",!1)}}function Eht(t,e,i){const n=t?t.toLowerCase().split(",").map((t=>t.trim())):[],s=i?aU(i):null,r=n.includes(null!=s&&"MapServer"===s.serverType?"data":"query"),o=n.includes("editing")&&!e.datesInUnknownTimezone;let a=o&&n.includes("create"),l=o&&n.includes("delete"),u=o&&n.includes("update");const c=n.includes("changetracking"),h=e.advancedQueryCapabilities;return o&&!(a||l||u)&&(a=l=u=!0),{supportsCalculate:vht(e,"supportsCalculate",!1),supportsTruncate:vht(e,"supportsTruncate",!1),supportsValidateSql:vht(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:l,supportsEditing:o,supportsChangeTracking:c,supportsQuery:r,supportsQueryAnalytics:vht(h,"supportsQueryAnalytic",!1),supportsQueryAttachments:vht(h,"supportsQueryAttachments",!1),supportsQueryBins:vht(h,"supportsQueryBins",!1),supportsQueryTopFeatures:vht(h,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:vht(e,"supportsAttachmentsResizing",!1),supportsSync:n.includes("sync"),supportsUpdate:u,supportsExceedsLimitStatistics:vht(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:vht(e,"supportsAsyncConvert3D",!1)}}function jht(t,e){const i=t.advancedQueryCapabilities,n=t.ownershipBasedAccessControlForFeatures,s=t.archivingInfo,r=t.currentVersion,o=e?.includes("MapServer"),a=!o||r>=u("mapserver-pbf-version-support"),l=hU(e),c=new Set((t.supportedQueryFormats??"").split(",").map((t=>t.toLowerCase().trim())));return{maxRecordCount:wht(t,"maxRecordCount",void 0),maxRecordCountFactor:wht(t,"maxRecordCountFactor",void 0),standardMaxRecordCount:wht(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:_ht(i),supportsCacheHint:vht(i,"supportsQueryWithCacheHint",!1)||xht(i,"query"),supportsCentroid:vht(i,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:l,supportsDefaultSpatialReference:vht(i,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:vht(i,"supportsDisjointSpatialRel",!1),supportsDistance:vht(i,"supportsQueryWithDistance",!1),supportsDistinct:vht(i,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:vht(i,"supportsReturningQueryExtent",!1),supportsFormatPBF:a&&c.has("pbf"),supportsFullTextSearch:vht(i,"supportsFullTextSearch",!1),supportsGeometryProperties:vht(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:vht(i,"supportsHavingClause",!1),supportsHistoricMoment:vht(s,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:vht(i,"supportsMaxRecordCountFactor",!1),supportsOrderBy:vht(i,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:vht(i,"supportsPagination",!1),supportsPercentileStatistics:vht(i,"supportsPercentileStatistics",!1),supportsQuantization:vht(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:vht(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:vht(n,"allowAnonymousToQuery",!0),supportsQueryByOthers:vht(n,"allowOthersToQuery",!0),supportsQueryGeometry:vht(t,"supportsReturningQueryGeometry",!1),supportsResultType:vht(i,"supportsQueryWithResultType",!1),supportsSpatialAggregationStatistics:vht(i,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:vht(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:vht(t,"useStandardizedQueries",!1),supportsStatistics:vht(i,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:vht(i,"supportsTopFeaturesQuery",!1),tileMaxRecordCount:wht(t,"tileMaxRecordCount",void 0)}}function Oht(t){const e=t.advancedQueryCapabilities,i=vht(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:vht(e,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i,supportsCacheHint:xht(e,"queryRelated")}}function Rht(t){return{supportsCacheHint:xht(t.advancedQueryCapabilities,"queryTopFilter")}}function Lht(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:vht(e,"supportsDateBin",!1),supportsFixedInterval:vht(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:vht(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:vht(e,"supportsFixedBoundariesBin",!1),supportedStatistics:Mht(e)}}function Nht(t){const e=t.ownershipBasedAccessControlForFeatures,i=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:vht(t,"allowGeometryUpdates",!0),supportsGlobalId:vht(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:vht(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:vht(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:vht(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:vht(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:vht(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:vht(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:vht(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:vht(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:vht(i,"supportsAsyncApplyEdits",!1),zDefault:wht(t,"zDefault",void 0)}}function Pht(t){return{operations:{supportsAppend:vht(t,"supportsAppend",!1),supportsCoverageQuery:t?.playbackInfo?.klv["0601"]??!1,supportsExportClip:vht(t,"supportsExportClip",!1),supportsExportFrameset:vht(t,"supportsExportFrameset",!1),supportsMensuration:vht(t,"supportsMensuration",!1),supportsUpdate:vht(t,"supportsUpdate",!1)}}}let Fht=class extends(cm(Io)){constructor(t){super(t),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(t){if(!t)return null;const e={};for(const i of Object.keys(t))e[i]=o$(t[i]);return e}writeDomains(t,e){if(!t)return;const i={};for(const e of Object.keys(t))t[e]&&(i[e]=t[e]?.toJSON());e.domains=i}};r([Je({type:Number,json:{write:!0}})],Fht.prototype,"code",void 0),r([Je({type:Object,json:{write:!0}})],Fht.prototype,"defaultValues",void 0),r([Je({json:{write:!0}})],Fht.prototype,"domains",void 0),r([ko("domains")],Fht.prototype,"readDomains",null),r([yh("domains")],Fht.prototype,"writeDomains",null),r([Je({type:String,json:{write:!0}})],Fht.prototype,"name",void 0),Fht=r([ln("esri.layers.support.Subtype")],Fht);const Dht=Fht;const $ht=t=>{let e=class extends t{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(Vm.ofType(gct)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=wh.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.version=void 0}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:t}=this;if(t){const{query:e,operations:i,editing:n}=t;if(!e.supportsQueryByOthers||!e.supportsQueryByAnonymous)return"load";if(i.supportsEditing&&!(n.supportsUpdateByOthers&&n.supportsUpdateByAnonymous&&n.supportsDeleteByOthers&&n.supportsDeleteByAnonymous))return"load"}if(this.serviceDefinitionExpression?.toLowerCase().includes("current_user"))return"load";if(this.userHasUpdateItemPrivileges){if(nht(this))return"load";if(this.hasUpdateItemRestrictions)return t.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const e=this.editFieldsInfo;return(e?.creatorField||e?.editorField)&&t?.operations.supportsEditing?"editing":null}readCapabilitiesFromService(t,e){return Tht(e,this.url)}readEditingInfo(t,e){const{editingInfo:i}=e;return i?{lastEditDate:null!=i.lastEditDate?new Date(i.lastEditDate):null}:null}get effectiveCapabilities(){const t=this.capabilities;if(!t)return null;const e=nt(t),{operations:i,editing:n}=e;return oht(this)?(this.userHasUpdateItemPrivileges&&(i.supportsQuery=!0),e):this.userHasUpdateItemPrivileges?(i.supportsAdd=i.supportsDelete=i.supportsEditing=i.supportsQuery=i.supportsUpdate=n.supportsDeleteByOthers=n.supportsGeometryUpdate=n.supportsUpdateByOthers=!0,e):(this.userHasFullEditingPrivileges&&i.supportsEditing&&(i.supportsAdd=i.supportsDelete=i.supportsUpdate=n.supportsGeometryUpdate=!0),e)}readGlobalIdFieldFromService(t,e){return qct(e)}get hasFullEditingRestrictions(){const t=this.capabilities;if(!t||oht(this))return!1;const{operations:e,editing:i}=t;return e.supportsEditing&&!(e.supportsAdd&&e.supportsDelete&&e.supportsUpdate&&i.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const t=this.capabilities;if(!t)return!1;const{operations:e,editing:i}=t;return oht(this)?!e.supportsQuery:!(e.supportsAdd&&e.supportsDelete&&e.supportsEditing&&e.supportsQuery&&e.supportsUpdate&&i.supportsDeleteByOthers&&i.supportsGeometryUpdate&&i.supportsUpdateByOthers)}readIsTableFromService(t,e){return"Table"===e.type}readMaxScale(t,e){return e.effectiveMaxScale||t||0}readMinScale(t,e){return e.effectiveMinScale||t||0}readObjectIdFieldFromService(t,e){return Hct(e)}readServiceDefinitionExpression(t,e){return e.definitionQuery||e.definitionExpression}set url(t){if(null==t)return void this._set("url",t);const e=fU({layer:this,url:t,nonStandardUrlAllowed:!0,logger:jt.getLogger(this)});this._set("url",e.url),null!=e.layerId&&this._set("layerId",e.layerId)}writeUrl(t,e,i,n){pU(this,t,null,e,n)}readVersion(t,e){return Wct(e)}};return r([Je({readOnly:!0})],e.prototype,"authenticationTriggerEvent",null),r([Je({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),r([Je({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],e.prototype,"capabilities",void 0),r([ko("service","capabilities")],e.prototype,"readCapabilitiesFromService",null),r([Je(fg("dateFieldsTimeReference"))],e.prototype,"dateFieldsTimeZone",void 0),r([Je({type:Boolean})],e.prototype,"datesInUnknownTimezone",void 0),r([Je({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],e.prototype,"definitionExpression",void 0),r([Je({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],e.prototype,"displayField",void 0),r([Je({readOnly:!0,type:yct})],e.prototype,"editFieldsInfo",void 0),r([Je({readOnly:!0})],e.prototype,"editingInfo",void 0),r([ko("editingInfo")],e.prototype,"readEditingInfo",null),r([Je({readOnly:!0})],e.prototype,"effectiveCapabilities",null),r([Je((()=>{const t=nt(sct),e=t.json.origins;return e["web-map"]={read:!1,write:!1},e["portal-item"]={read:!1,write:!1},t})())],e.prototype,"elevationInfo",void 0),r([Je({type:fht,json:{name:"layerDefinition.floorInfo",write:!0,origins:{"web-scene":{name:"layerDefinition.floorInfo",write:{enabled:!0,layerContainerTypes:Wrt}}}}})],e.prototype,"floorInfo",void 0),r([Je({type:Od,json:{origins:{service:{read:{source:"extent"}}}}})],e.prototype,"fullExtent",void 0),r([Je()],e.prototype,"gdbVersion",void 0),r([Je({readOnly:!0,type:cht,json:{read:{source:"geometryProperties"}}})],e.prototype,"geometryFieldsInfo",void 0),r([Je({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:Cct.read}}}})],e.prototype,"geometryType",void 0),r([Je({type:String})],e.prototype,"globalIdField",void 0),r([ko("service","globalIdField",["globalIdField","fields"])],e.prototype,"readGlobalIdFieldFromService",null),r([Je({readOnly:!0})],e.prototype,"hasFullEditingRestrictions",null),r([Je({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasM",void 0),r([Je({readOnly:!0})],e.prototype,"hasUpdateItemRestrictions",null),r([Je({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasZ",void 0),r([Je({readOnly:!0,type:qC})],e.prototype,"heightModelInfo",void 0),r([Je({type:Date})],e.prototype,"historicMoment",void 0),r([Je({type:Vm.ofType(gct),readOnly:!0})],e.prototype,"indexes",void 0),r([Je({readOnly:!0})],e.prototype,"isTable",void 0),r([ko("service","isTable",["type"])],e.prototype,"readIsTableFromService",null),r([Je({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],e.prototype,"layerId",void 0),r([Je(dct)],e.prototype,"maxScale",void 0),r([ko("service","maxScale",["maxScale","effectiveMaxScale"])],e.prototype,"readMaxScale",null),r([Je(hct)],e.prototype,"minScale",void 0),r([ko("service","minScale",["minScale","effectiveMinScale"])],e.prototype,"readMinScale",null),r([Je({type:String})],e.prototype,"objectIdField",void 0),r([ko("service","objectIdField",["objectIdField","fields"])],e.prototype,"readObjectIdFieldFromService",null),r([Je(fg("preferredTimeReference"))],e.prototype,"preferredTimeZone",void 0),r([Je({type:[ght],readOnly:!0})],e.prototype,"relationships",void 0),r([Je({type:Boolean})],e.prototype,"returnM",void 0),r([Je({type:Boolean})],e.prototype,"returnZ",void 0),r([Je({readOnly:!0,json:{write:!1}})],e.prototype,"serverGens",void 0),r([Je({readOnly:!0})],e.prototype,"serviceDefinitionExpression",void 0),r([ko("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],e.prototype,"readServiceDefinitionExpression",null),r([Je({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"serviceItemId",void 0),r([Je()],e.prototype,"sourceJSON",void 0),r([Je({type:wh,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],e.prototype,"spatialReference",void 0),r([Je({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],e.prototype,"subtypeField",void 0),r([Je({type:[Dht],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"subtypes",void 0),r([Je({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],e.prototype,"trackIdField",void 0),r([Je(ict)],e.prototype,"url",null),r([yh("url")],e.prototype,"writeUrl",null),r([Je({json:{origins:{service:{read:!0}},read:!1}})],e.prototype,"version",void 0),r([ko("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],e.prototype,"readVersion",null),e=r([ln("esri.layers.mixins.FeatureLayerBase")],e),e};let zht=class extends(cm(Io)){constructor(t){super(t),this.expression=null,this.title=null,this.returnType=null}};r([Je({type:String,json:{write:!0}})],zht.prototype,"expression",void 0),r([Je({type:String,json:{write:!0}})],zht.prototype,"title",void 0),r([Je({type:String,json:{write:!0}})],zht.prototype,"returnType",void 0),zht=r([ln("esri.layers.support.ExpressionInfo")],zht);const Uht=zht;var Bht;let Ght=Bht=class extends Io{constructor(t){super(t),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new Bht({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:nt(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};r([Je({type:Boolean,json:{write:!0}})],Ght.prototype,"isAutoGenerated",void 0),r([Je({type:String,json:{write:!0}})],Ght.prototype,"name",void 0),r([Je({type:String,json:{write:!0}})],Ght.prototype,"alias",void 0),r([Je({type:String,json:{write:!0}})],Ght.prototype,"onStatisticField",void 0),r([Je({type:Uht,json:{write:!0}})],Ght.prototype,"onStatisticExpression",void 0),r([Je({type:String,json:{write:!0}})],Ght.prototype,"statisticType",void 0),Ght=Bht=r([ln("esri.layers.support.AggregateField")],Ght);const Vht=Ght;let qht=class extends Io{constructor(){super(...arguments),this.type=null}};r([Je({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],qht.prototype,"type",void 0),qht=r([ln("esri.layers.support.FeatureReduction")],qht);const Hht="__begin__",Wht="__end__",Zht=new RegExp(Hht,"ig"),Jht=new RegExp(Wht,"ig"),Yht=new RegExp("^"+Hht,"i"),Kht=new RegExp(Wht+"$","i"),Qht='"',Xht=Qht+" + ",tdt=" + "+Qht;function edt(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function idt(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function ndt(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):null!=t.labelExpression&&(e.expression=edt(t.labelExpression),e.type="conventional"),e}function sdt(t){const e=ndt(t);if(!e)return null;switch(e.type){case"conventional":return odt(e.expression);case"arcade":return e.expression}return null}function rdt(t){const e=ndt(t);if(!e)return null;switch(e.type){case"conventional":return ldt(e.expression);case"arcade":return ddt(e.expression)}return null}function odt(t){let e;return t?(e=Mt(t,(t=>Hht+'$feature["'+t+'"]'+Wht)),e=Yht.test(e)?e.replace(Yht,""):Qht+e,e=Kht.test(e)?e.replace(Kht,""):e+Qht,e=e.replaceAll(Zht,Xht).replaceAll(Jht,tdt)):e='""',e}const adt=/^\s*\{([^}]+)\}\s*$/i;function ldt(t){const e=t?.match(adt);return e?.[1].trim()||null}const udt=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,cdt=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,hdt=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function ddt(t){if(!t)return null;let e=udt.exec(t)||cdt.exec(t);return e?e[1]||e[3]:(e=hdt.exec(t),e?e[2]:null)}var fdt;let pdt=fdt=class extends Io{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?odt(e.value):t}writeExpression(t,e,i){null!=this.value&&(t=odt(this.value)),null!=t&&(e[i]=t)}clone(){return new fdt({expression:this.expression,title:this.title,value:this.value})}};r([Je({type:String,json:{write:{writerEnsuresNonNull:!0}}})],pdt.prototype,"expression",void 0),r([ko("expression",["expression","value"])],pdt.prototype,"readExpression",null),r([yh("expression")],pdt.prototype,"writeExpression",null),r([Je({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],pdt.prototype,"title",void 0),r([Je({json:{read:!1,write:!1}})],pdt.prototype,"value",void 0),pdt=fdt=r([ln("esri.layers.support.LabelExpressionInfo")],pdt);const mdt=pdt;var ydt;const gdt=new Co({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function vdt(t,e,i){return{enabled:!KT(i?.layer)}}function wdt(t){return!t||"service"!==t.origin&&!("map-image"===t.layer?.type)}function bdt(t){return"map-image"===t?.type}function Sdt(t){return!!bdt(t)&&!!t.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}function _dt(t){return wdt(t)||Sdt(t?.layer)}let xdt=ydt=class extends Io{static evaluateWhere(t,e){const i=(t,e,i)=>{switch(e){case"=":return t==i;case"<>":return t!=i;case">":return t>i;case">=":return t>=i;case"<":return t<i;case"<=":return t<=i}return!1};try{if(null==t)return!0;const n=t.split(" ");if(3===n.length)return i(e[n[0]],n[1],n[2]);if(7===n.length){const t=i(e[n[0]],n[1],n[2]),s=n[3],r=i(e[n[4]],n[5],n[6]);switch(s){case"AND":return t&&r;case"OR":return t||r}}return!1}catch(t){}}constructor(t){super(t),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=n7,this.useCodedValues=void 0,this.where=null}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)t=idt(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const e=ddt(this.labelExpressionInfo.expression);e&&(t="["+e+"]")}null!=t&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,n){if(null==t&&null!=this.labelExpression&&wdt(n))t=new mdt({expression:this.getLabelExpressionArcade()});else if(!t)return;const s=t.toJSON(n);s.expression&&(e[i]=s)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return ndt(this)}getLabelExpressionArcade(){return sdt(this)}getLabelExpressionSingleField(){return rdt(this)}hash(){return JSON.stringify(this)}clone(){return new ydt({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:nt(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:nt(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};r([Je({type:String,json:{write:!0}})],xdt.prototype,"name",void 0),r([Je({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:vdt}}}}})],xdt.prototype,"allowOverrun",void 0),r([Je({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:vdt}}}}})],xdt.prototype,"deconflictionStrategy",void 0),r([Je({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&"service"===i?.origin&&Sdt(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],xdt.prototype,"labelExpression",void 0),r([ko("labelExpression")],xdt.prototype,"readLabelExpression",null),r([yh("labelExpression")],xdt.prototype,"writeLabelExpression",null),r([Je({type:mdt,json:{write:{overridePolicy:(t,e,i)=>_dt(i)?{allowNull:!0}:{enabled:!1}}}})],xdt.prototype,"labelExpressionInfo",void 0),r([yh("labelExpressionInfo")],xdt.prototype,"writeLabelExpressionInfo",null),r([Je({type:gdt.apiValues,json:{type:gdt.jsonValues,read:gdt.read,write:gdt.write}})],xdt.prototype,"labelPlacement",void 0),r([Je({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],xdt.prototype,"labelPosition",void 0),r([Je({type:Number})],xdt.prototype,"maxScale",void 0),r([yh("maxScale")],xdt.prototype,"writeMaxScale",null),r([Je({type:Number})],xdt.prototype,"minScale",void 0),r([yh("minScale")],xdt.prototype,"writeMinScale",null),r([Je({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:vdt}}}}})],xdt.prototype,"repeatLabel",void 0),r([Je({type:Number,cast:tI,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:vdt}}}}})],xdt.prototype,"repeatLabelDistance",void 0),r([Je({types:MD,json:{origins:{"web-scene":{types:AD,write:p7,default:null}},write:p7,default:null}})],xdt.prototype,"symbol",void 0),r([Je({type:Boolean,json:{write:!0}})],xdt.prototype,"useCodedValues",void 0),r([Je({type:String,json:{write:!0}})],xdt.prototype,"where",void 0),xdt=ydt=r([ln("esri.layers.support.LabelClass")],xdt);const Mdt=xdt;var Tdt;let Adt=Tdt=class extends qht{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=tI("12px"),this.fields=[],this.renderer=null}writeFields(t,e,i){const n=t.filter((t=>"avg_angle"!==t.statisticType)).map((t=>t.toJSON()));gt(i,n,e)}readRenderer(t,e,i){const n=e.drawingInfo?.renderer;return n?Hrt(n,e,i)??void 0:iht(e,i)}clone(){return new Tdt({fields:nt(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:nt(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:nt(this.popupTemplate),renderer:nt(this.renderer),binType:nt(this.binType),size:this.size})}};r([NA({binning:"binning"})],Adt.prototype,"type",void 0),r([NA({geohash:"geohash",square:"square"}),Je({type:["geohash","square"]})],Adt.prototype,"binType",void 0),r([Je({type:Number,json:{write:!0}})],Adt.prototype,"fixedBinLevel",void 0),r([Je({type:[Mdt],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Adt.prototype,"labelingInfo",void 0),r([Je(ect)],Adt.prototype,"labelsVisible",void 0),r([Je({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Adt.prototype,"maxScale",void 0),r([Je(tct)],Adt.prototype,"popupEnabled",void 0),r([Je({type:tL,json:{name:"popupInfo",write:!0}})],Adt.prototype,"popupTemplate",void 0),r([Je({cast:t=>"auto"===t?t:Ut(tI(t))})],Adt.prototype,"size",void 0),r([Je({type:[Vht],json:{write:!0}})],Adt.prototype,"fields",void 0),r([yh("fields")],Adt.prototype,"writeFields",null),r([Je({types:Drt,json:{write:{target:"drawingInfo.renderer"}}})],Adt.prototype,"renderer",void 0),r([ko("renderer",["drawingInfo.renderer"])],Adt.prototype,"readRenderer",null),Adt=Tdt=r([ln("esri.layers.support.FeatureReductionBinning")],Adt);const Idt=Adt;var kdt;function Cdt(t){return"simple"===t.type&&!t.visualVariables?.length}let Edt=kdt=class extends Io{constructor(t){super(t),this.type="cluster",this.clusterRadius=tI("80px"),this.clusterMinSize=tI("12px"),this.clusterMaxSize=tI("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,i){const n=e.drawingInfo?.renderer;return n?.authoringInfo?.isAutoGenerated?null:n?Cdt(n)?null:Hrt(n,e,i)??void 0:iht(e,i)}readSymbol(t,e,i){const n=e.drawingInfo?.renderer;if(n?.authoringInfo?.isAutoGenerated)return null;if(n&&Cdt(n)){const t=Hrt(n,e,i);return t?.symbol}return null}writeSymbol(t,e,i,n){const s=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||s){const i=new Jst({symbol:t});e.drawingInfo={renderer:i.write({},n)}}}writeFields(t,e,i){const n=t.filter((t=>"avg_angle"!==t.statisticType)).map((t=>t.toJSON()));gt(i,n,e)}readFields(t,e,i){return t.filter((t=>!t.isAutoGenerated)).map((t=>Vht.fromJSON(t)))}clone(){return new kdt({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:nt(this.labelingInfo),labelsVisible:this.labelsVisible,fields:nt(this.fields),maxScale:this.maxScale,renderer:nt(this.renderer),symbol:nt(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:nt(this.popupTemplate)})}};r([Je({type:["cluster"],readOnly:!0,json:{write:!0}})],Edt.prototype,"type",void 0),r([Je({cast:t=>"auto"===t?t:Ut(tI(t)),json:{write:!0}})],Edt.prototype,"clusterRadius",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],Edt.prototype,"clusterMinSize",void 0),r([Je({type:Number,cast:tI,json:{write:!0}})],Edt.prototype,"clusterMaxSize",void 0),r([Je({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Edt.prototype,"maxScale",void 0),r([Je(tct)],Edt.prototype,"popupEnabled",void 0),r([Je({type:tL,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Edt.prototype,"popupTemplate",void 0),r([Je({types:Drt,json:{write:{target:"drawingInfo.renderer"}}})],Edt.prototype,"renderer",void 0),r([ko("renderer",["drawingInfo.renderer"])],Edt.prototype,"readRenderer",null),r([Je({types:SD})],Edt.prototype,"symbol",void 0),r([ko("symbol",["drawingInfo.renderer"])],Edt.prototype,"readSymbol",null),r([yh("symbol")],Edt.prototype,"writeSymbol",null),r([Je({type:[Mdt],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Edt.prototype,"labelingInfo",void 0),r([Je(ect)],Edt.prototype,"labelsVisible",void 0),r([Je({type:[Vht],json:{write:!0}})],Edt.prototype,"fields",void 0),r([yh("fields")],Edt.prototype,"writeFields",null),r([ko("fields")],Edt.prototype,"readFields",null),Edt=kdt=r([ln("esri.layers.support.FeatureReductionCluster")],Edt);const jdt=Edt;var Odt;let Rdt=Odt=class extends qht{constructor(t){super(t),this.type="selection"}clone(){return new Odt}};r([Je({type:["selection"]})],Rdt.prototype,"type",void 0),Rdt=Odt=r([ln("esri.layers.support.FeatureReductionSelection")],Rdt);const Ldt=Rdt;const Ndt={key:"type",base:qht,typeMap:{cluster:jdt,binning:Idt}},Pdt={types:{key:"type",base:qht,typeMap:{selection:Ldt,cluster:jdt,binning:Idt}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:Ndt},"portal-item":{types:Ndt},"web-scene":{types:{key:"type",base:qht,typeMap:{selection:Ldt}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:Wrt}}}}};const Fdt={Base64:0,Hex:1,String:2,Raw:3},Ddt=8,$dt=(1<<Ddt)-1;function zdt(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function Udt(t){const e=[];for(let i=0,n=t.length*Ddt;i<n;i+=Ddt)e[i>>5]|=(t.charCodeAt(i/Ddt)&$dt)<<i%32;return e}function Bdt(t){const e=[];for(let i=0,n=32*t.length;i<n;i+=Ddt)e.push(String.fromCharCode(t[i>>5]>>>i%32&$dt));return e.join("")}function Gdt(t){const e="0123456789abcdef",i=[];for(let n=0,s=4*t.length;n<s;n++)i.push(e.charAt(t[n>>2]>>n%4*8+4&15)+e.charAt(t[n>>2]>>n%4*8&15));return i.join("")}function Vdt(t){const e="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[];for(let s=0,r=4*t.length;s<r;s+=3){const r=(t[s>>2]>>s%4*8&255)<<16|(t[s+1>>2]>>(s+1)%4*8&255)<<8|t[s+2>>2]>>(s+2)%4*8&255;for(let o=0;o<4;o++)8*s+6*o>32*t.length?n.push(e):n.push(i.charAt(r>>6*(3-o)&63))}return n.join("")}function qdt(t,e){return t<<e|t>>>32-e}function Hdt(t,e,i,n,s,r){return zdt(qdt(zdt(zdt(e,t),zdt(n,r)),s),i)}function Wdt(t,e,i,n,s,r,o){return Hdt(e&i|~e&n,t,e,s,r,o)}function Zdt(t,e,i,n,s,r,o){return Hdt(e&n|i&~n,t,e,s,r,o)}function Jdt(t,e,i,n,s,r,o){return Hdt(e^i^n,t,e,s,r,o)}function Ydt(t,e,i,n,s,r,o){return Hdt(i^(e|~n),t,e,s,r,o)}function Kdt(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let i=1732584193,n=-271733879,s=-1732584194,r=271733878;for(let e=0;e<t.length;e+=16){const o=i,a=n,l=s,u=r;i=Wdt(i,n,s,r,t[e],7,-680876936),r=Wdt(r,i,n,s,t[e+1],12,-389564586),s=Wdt(s,r,i,n,t[e+2],17,606105819),n=Wdt(n,s,r,i,t[e+3],22,-1044525330),i=Wdt(i,n,s,r,t[e+4],7,-176418897),r=Wdt(r,i,n,s,t[e+5],12,1200080426),s=Wdt(s,r,i,n,t[e+6],17,-1473231341),n=Wdt(n,s,r,i,t[e+7],22,-45705983),i=Wdt(i,n,s,r,t[e+8],7,1770035416),r=Wdt(r,i,n,s,t[e+9],12,-1958414417),s=Wdt(s,r,i,n,t[e+10],17,-42063),n=Wdt(n,s,r,i,t[e+11],22,-1990404162),i=Wdt(i,n,s,r,t[e+12],7,1804603682),r=Wdt(r,i,n,s,t[e+13],12,-40341101),s=Wdt(s,r,i,n,t[e+14],17,-1502002290),n=Wdt(n,s,r,i,t[e+15],22,1236535329),i=Zdt(i,n,s,r,t[e+1],5,-165796510),r=Zdt(r,i,n,s,t[e+6],9,-1069501632),s=Zdt(s,r,i,n,t[e+11],14,643717713),n=Zdt(n,s,r,i,t[e],20,-373897302),i=Zdt(i,n,s,r,t[e+5],5,-701558691),r=Zdt(r,i,n,s,t[e+10],9,38016083),s=Zdt(s,r,i,n,t[e+15],14,-660478335),n=Zdt(n,s,r,i,t[e+4],20,-405537848),i=Zdt(i,n,s,r,t[e+9],5,568446438),r=Zdt(r,i,n,s,t[e+14],9,-1019803690),s=Zdt(s,r,i,n,t[e+3],14,-187363961),n=Zdt(n,s,r,i,t[e+8],20,1163531501),i=Zdt(i,n,s,r,t[e+13],5,-1444681467),r=Zdt(r,i,n,s,t[e+2],9,-51403784),s=Zdt(s,r,i,n,t[e+7],14,1735328473),n=Zdt(n,s,r,i,t[e+12],20,-1926607734),i=Jdt(i,n,s,r,t[e+5],4,-378558),r=Jdt(r,i,n,s,t[e+8],11,-2022574463),s=Jdt(s,r,i,n,t[e+11],16,1839030562),n=Jdt(n,s,r,i,t[e+14],23,-35309556),i=Jdt(i,n,s,r,t[e+1],4,-1530992060),r=Jdt(r,i,n,s,t[e+4],11,1272893353),s=Jdt(s,r,i,n,t[e+7],16,-155497632),n=Jdt(n,s,r,i,t[e+10],23,-1094730640),i=Jdt(i,n,s,r,t[e+13],4,681279174),r=Jdt(r,i,n,s,t[e],11,-358537222),s=Jdt(s,r,i,n,t[e+3],16,-722521979),n=Jdt(n,s,r,i,t[e+6],23,76029189),i=Jdt(i,n,s,r,t[e+9],4,-640364487),r=Jdt(r,i,n,s,t[e+12],11,-421815835),s=Jdt(s,r,i,n,t[e+15],16,530742520),n=Jdt(n,s,r,i,t[e+2],23,-995338651),i=Ydt(i,n,s,r,t[e],6,-198630844),r=Ydt(r,i,n,s,t[e+7],10,1126891415),s=Ydt(s,r,i,n,t[e+14],15,-1416354905),n=Ydt(n,s,r,i,t[e+5],21,-57434055),i=Ydt(i,n,s,r,t[e+12],6,1700485571),r=Ydt(r,i,n,s,t[e+3],10,-1894986606),s=Ydt(s,r,i,n,t[e+10],15,-1051523),n=Ydt(n,s,r,i,t[e+1],21,-2054922799),i=Ydt(i,n,s,r,t[e+8],6,1873313359),r=Ydt(r,i,n,s,t[e+15],10,-30611744),s=Ydt(s,r,i,n,t[e+6],15,-1560198380),n=Ydt(n,s,r,i,t[e+13],21,1309151649),i=Ydt(i,n,s,r,t[e+4],6,-145523070),r=Ydt(r,i,n,s,t[e+11],10,-1120210379),s=Ydt(s,r,i,n,t[e+2],15,718787259),n=Ydt(n,s,r,i,t[e+9],21,-343485551),i=zdt(i,o),n=zdt(n,a),s=zdt(s,l),r=zdt(r,u)}return[i,n,s,r]}function Qdt(t,e=Fdt.Hex){const i=e||Fdt.Base64,n=Kdt(Udt(t),t.length*Ddt);switch(i){case Fdt.Raw:return n;case Fdt.Hex:return Gdt(n);case Fdt.String:return Bdt(n);case Fdt.Base64:return Vdt(n)}}const Xdt=()=>jt.getLogger("esri.views.2d.layers.support.clusterUtils");u.add("esri-cluster-arcade-enabled",!0);const tft=u("esri-cluster-arcade-enabled"),eft=new Set(["simple-line","simple-fill","picture-fill"]);function ift(t,e){let i=e.clone();if(!nft(i))return i;if(e.getSymbols().some((t=>eft.has(t.type)))&&(i=new Jst({symbol:new lD})),i.authoringInfo||(i.authoringInfo=new v8),i.authoringInfo.isAutoGenerated=!0,"visualVariables"in i){const e=(i.visualVariables||[]).filter((t=>"$view.scale"!==t.valueExpression));e.forEach((e=>{"rotation"===e.type?e.field?e.field=oft(t,e.field,"avg_angle","number"):e.valueExpression&&(e.field=rft(t,e.valueExpression,"avg_angle","number"),e.valueExpression=null):e.normalizationField?(e.field=oft(t,e.field,"avg_norm","number",e.normalizationField),e.normalizationField=null):e.field?e.field=oft(t,e.field,"avg","number"):e.valueExpression&&(e.field=rft(t,e.valueExpression,"avg","number"),e.valueExpression=null)})),i.visualVariables=e}switch(i.type){case"simple":break;case"pie-chart":for(const e of i.attributes)e.field?e.field=oft(t,e.field,"sum","number"):e.valueExpression&&(e.field=rft(t,e.valueExpression,"sum","number"),e.valueExpression=null);break;case"unique-value":i.field?i.field=oft(t,i.field,"mode","string"):i.valueExpression&&(i.field=rft(t,i.valueExpression,"mode","string"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=oft(t,i.field,"avg_norm","number",i.normalizationField),i.normalizationField=null):i.field?i.field=oft(t,i.field,"avg","number"):i.valueExpression&&(i.field=rft(t,i.valueExpression,"avg","number"),i.valueExpression=null)}return i}const nft=t=>{const e=e=>Xdt().error(new Ve("Unsupported-renderer",e,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const i=t.normalizationType;if("field"!==i)return e(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!tft){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some((t=>!(!("valueExpression"in t)||!t.valueExpression))))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function sft(t,e,i){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const t=i,n="field",s=e.toLowerCase()+",norm:"+n+","+t.toLowerCase();return"cluster_avg_"+Qdt(s)}}}function rft(t,e,i,n){const s=Qdt(e),r="mode"===i?`cluster_type_${s}`:"sum"===i?`cluster_sum_${s}`:`cluster_avg_${s}`;return t.some((t=>t.name===r))||t.push(new Vht({name:r,isAutoGenerated:!0,onStatisticExpression:new Uht({expression:e,returnType:n}),statisticType:i})),r}function oft(t,e,i,n,s){if("cluster_count"===e||t.some((t=>t.name===e)))return e;const r=sft(i,e,s);return t.some((t=>t.name===r))||("avg_norm"===i?t.push(new Vht({name:r,isAutoGenerated:!0,onStatisticExpression:new Uht({expression:`$feature.${e} / $feature.${s}`,returnType:n}),statisticType:"avg"})):t.push(new Vht({name:r,isAutoGenerated:!0,onStatisticField:e,statisticType:i}))),r}const aft=t=>{let e=class extends t{constructor(...t){super(...t),this.addHandles(ey((()=>this.renderer),(()=>{if(this.featureReduction){const t=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",t)}}),hy))}set featureReduction(t){const e=this._normalizeFeatureReduction(t);this._set("featureReduction",e)}set renderer(t){}_withClusterVariable(t,e,i){const n=t.clone();if("visualVariables"in n){n.visualVariables||(n.visualVariables=[]);n.visualVariables.some((t=>"size"===t.type))||n.visualVariables.push(new P9({field:"cluster_count",stops:[new W8({value:1}),new W8({useMinValue:!0,size:e}),new W8({useMaxValue:!0,size:i})]}))}return n}_normalizeFeatureReduction(t){if("cluster"!==t?.type)return t;const e=t.clone(),i=[new Vht({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],n=(e.fields??[]).filter((t=>!t.isAutoGenerated)),s=t.renderer&&!t.renderer.authoringInfo?.isAutoGenerated,{clusterMinSize:r,clusterMaxSize:o}=e;if(s){e.fields=[...i,...n];const t=this._withClusterVariable(e.renderer,r,o);return e.effectiveFeatureRenderer=t,e.effectiveClusterRenderer=t,e}if(t.symbol){if(e.fields=[...i,...n],e.renderer=null,!this.renderer)return e.effectiveFeatureRenderer=null,e.effectiveClusterRenderer=null,e;const s=ift(i,this.renderer),a=this._withClusterVariable(s,r,o),l="visualVariables"in a&&a.visualVariables?a.visualVariables:[],u=new Jst({symbol:t.symbol,visualVariables:l});return e.fields=[...i,...n],e.effectiveFeatureRenderer=a,e.effectiveClusterRenderer=u,e}if(!this.renderer)return t;const a=ift(i,this.renderer);e.fields=[...i,...n],e.renderer=a;const l=this._withClusterVariable(a,r,o);return e.effectiveFeatureRenderer=l,e.effectiveClusterRenderer=l,e}};return r([Je(Pdt)],e.prototype,"featureReduction",null),e=r([ln("esri.layers.mixins.FeatureReductionLayer")],e),e};const lft={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},uft={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},cft={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},hft={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":lft,"web-map/basemap":uft,"web-map/tables":cft,"link-chart/operational-layers":{...lft,LinkChartLayer:!0},"link-chart/basemap":uft,"link-chart/tables":cft,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0}};const dft=t=>{let e=class extends t{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(t,e,i){return"Group Layer"===i?.portalItem?.type?void 0:t}writeListMode(t,e,i,n){(n&&"ground"===n.layerContainerType||t&&_o(this,i,{},n))&&(e[i]=t)}writeOperationalLayerType(t,e,i,n){t&&"tables"!==n?.layerContainerType&&(e.layerType=t)}writeTitle(t,e){e.title=t??"Layer"}readTimeExtent(t){return t?MC.fromArray(t):null}writeTimeExtent(t,e,i,n){t&&"tables"!==n.layerContainerType&&(t.isEmpty?n?.messages&&n.messages.push(new Ve("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):e[i]=t.toArray())}read(t,e){e&&(e.layer=this),vo(this,t,(e=>super.read(t,e)),e)}write(t,e){if(!this.persistenceEnabled&&!e?.ignorePersistenceEnabled)return null;if(e?.origin){const t=`${e.origin}/${e.layerContainerType||"operational-layers"}`,i=hft[t];let n=!!i?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===t&&(n=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===t&&(n=!1),!n)return e.messages?.push(new Ve("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${t}'`,{layer:this})),null}const i=super.write(t,{...e,layer:this}),n=!!e&&!!e.messages&&!!e.messages.filter((t=>t instanceof Ve&&"web-document-write:property-required"===t.name)).length;return Ra(i?.url)?(e?.messages?.push(new Ve("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:i}beforeSave(){}};return r([Je({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),r([ko("id",["id"])],e.prototype,"readId",null),r([Je(fct)],e.prototype,"listMode",void 0),r([yh("listMode")],e.prototype,"writeListMode",null),r([Je({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:Wrt}}}}})],e.prototype,"operationalLayerType",void 0),r([yh("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),r([Je(act)],e.prototype,"opacity",void 0),r([Je({type:Boolean,readOnly:!1})],e.prototype,"persistenceEnabled",void 0),r([Je({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),r([yh("title"),yh(["web-scene"],"title")],e.prototype,"writeTitle",null),r([Je({type:MC,json:{origins:{"web-scene":{write:{layerContainerTypes:Wrt}}}}})],e.prototype,"visibilityTimeExtent",void 0),r([ko("visibilityTimeExtent")],e.prototype,"readTimeExtent",null),r([yh(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[ce,he]]}})],e.prototype,"writeTimeExtent",null),r([Je({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:Wrt}}},name:"visibility",write:!0}})],e.prototype,"visible",void 0),e=r([ln("esri.layers.mixins.OperationalLayer")],e),e};var fft;const pft=new Co({asc:"ascending",desc:"descending"});let mft=fft=class extends Io{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new fft({field:this.field,valueExpression:this.valueExpression,order:this.order})}};r([Je({type:String,json:{write:!0}})],mft.prototype,"field",void 0),r([Je({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],mft.prototype,"valueExpression",void 0),r([Je({type:pft.apiValues,json:{type:pft.jsonValues,read:pft.read,write:pft.write}})],mft.prototype,"order",void 0),mft=fft=r([ln("esri.layers.support.OrderByInfo")],mft);const yft=mft;function gft(t,e,i){if(!t)return null;const n=t.find((t=>!!t.field));if(!n)return null;const s=new yft;return s.read(n,i),[s]}function vft(t,e,i,n){const s=t.find((t=>!!t.field));s&&gt(i,[s.toJSON()],e)}const wft={type:[yft],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:gft},write:{writer:vft}}},bft=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return r([Je(wft)],e.prototype,"orderBy",void 0),e=r([ln("esri.layers.mixins.OrderedLayer")],e),e};const Sft=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=An(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t))}readPortalItem(t,e,i){if(e.itemId)return new NT({id:e.itemId,portal:i?.portal})}writePortalItem(t,e){t?.id&&(e.itemId=t.id)}async loadFromPortal(t,e){if(this.portalItem?.id)try{const{load:i}=await import("./p-948d6175.js");return _s(e),await i({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData,layerModuleTypeMap:t.layerModuleTypeMap},e)}catch(t){throw Es(t)||jt.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${t}`),t}}async finishLoadEditablePortalLayer(t){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(t).catch((t=>(Ts(t),!0))))}async setUserPrivileges(t,e){if(!St.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(e);if(this.url)try{const{features:{edit:i,fullEdit:n},content:{updateItem:s}}=await this._fetchUserPrivileges(t,e);this._set("userHasEditingPrivileges",i),this._set("userHasFullEditingPrivileges",n),this._set("userHasUpdateItemPrivileges",s)}catch(t){Ts(t)}}async _fetchUserPrivileges(t,e){let i=this.portalItem;if(!t||!i||!i.loaded||i.sourceUrl)return this._fetchFallbackUserPrivileges(e);const n=t===i.id;if(n&&i.portal.user)return o4(i);let s,r;if(n)s=i.portal.url;else try{s=await eA(this.url,e)}catch(t){Ts(t)}if(!s||!ba(s,i.portal.url))return this._fetchFallbackUserPrivileges(e);try{const t=null!=e?e.signal:null;r=await(Sl?.getCredential(`${s}/sharing`,{prompt:!1,signal:t}))}catch(t){Ts(t)}const o=!0,a=!1,l=!1;if(!r)return{features:{edit:o,fullEdit:a},content:{updateItem:l}};try{if(n?await i.reload():(i=new NT({id:t,portal:{url:s}}),await i.load(e)),i.portal.user)return o4(i)}catch(t){Ts(t)}return{features:{edit:o,fullEdit:a},content:{updateItem:l}}}async _fetchFallbackUserPrivileges(t){let e=!0;try{e=await this._fetchUserHasEditingPrivileges(t)}catch(t){Ts(t)}return{features:{edit:e,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(t){const e=this.url?Sl?.findCredential(this.url):null;if(!e)return!0;const i=_ft.credential===e?_ft.user:await this._fetchEditingUser(t);return _ft.credential=e,_ft.user=i,null==i?.privileges||i.privileges.includes("features:user:edit")}async _fetchEditingUser(t){const e=this.portalItem?.portal?.user;if(e)return e;const i=Sl?.findServerInfo(this.url??"");if(!i?.owningSystemUrl)return null;const n=`${i.owningSystemUrl}/sharing/rest`,s=uT.getDefault();if(s&&s.loaded&&Ca(s.restUrl)===Ca(n))return s.user;const r=`${n}/community/self`,o=null!=t?t.signal:null,a=await Km(Pl(r,{authMode:"no-prompt",query:{f:"json"},signal:o}));return a.ok?sT.fromJSON(a.value.data):null}read(t,e){e&&(e.layer=this),super.read(t,e)}write(t,e){const i=e?.portal,n=this.portalItem?.id&&(this.portalItem.portal||uT.getDefault());return i&&n&&!Sa(n.restUrl,i.restUrl)?(e.messages&&e.messages.push(new Ve("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(t,{...e,layer:this})}};return r([Je({type:NT})],e.prototype,"portalItem",null),r([ko("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),r([yh("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),r([Je({clonable:!1})],e.prototype,"resourceReferences",void 0),r([Je({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),r([Je({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),r([Je({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=r([ln("esri.layers.mixins.PortalLayer")],e),e},_ft={credential:null,user:null};let xft=class extends ao{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};r([Je()],xft.prototype,"updating",void 0),r([Je()],xft.prototype,"status",void 0),xft=r([ln("esri.layers.support.PublishingInfo")],xft);const Mft=xft;const Tft=Symbol();const Aft=t=>{var e;let i=class extends t{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const t=this._get("publishingInfo");if(t)return t;const e=new Mft;return this._checkPublishingStatus(e),e}_checkPublishingStatus(t){const e=250,i=125;let n=0;const s=async e=>{let o;t.updating=!0;try{o=await this.fetchPublishingStatus()}catch(t){o="unavailable"}"published"!==o&&"unavailable"!==o||("publishing"===t.status&&this.refresh(),r.remove()),t.status=o,t.updating=!1,r.removed||(n=setTimeout(s,e,e+i))},r={removed:!1,remove(){this.removed=!0,clearTimeout(n)}};this.when().catch((()=>r.remove())),s(e),this.addHandles(r)}};return e=Tft,r([Je({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=r([ln("esri.layers.mixins.PublishableLayer")],i),i};const Ift=new Vm,kft=new WeakMap;function Cft(t){jft(t)&&Ift.push(new WeakRef(t))}function Eft(t){const e=Ift.find((e=>e.deref()===t));e&&Ift.remove(e)}function jft(t){return null!=t&&"object"==typeof t&&"refreshInterval"in t&&"refresh"in t}function Oft(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:Oft(e,t%e):0}let Rft=0,Lft=0;function Nft(){const t=Date.now();let e=!1;for(const i of Ift){const n=i.deref();if(n){if(n.refreshInterval){t-(kft.get(n)??0)+5>=6e4*n.refreshInterval&&(kft.set(n,t),n.refresh(t))}}else e=!0}if(e)for(let t=Ift.length-1;t>=0;t--){Ift.at(t).deref()||Ift.removeAt(t)}}Lr((()=>{const t=Date.now();let e=0;for(const i of Ift){const n=i.deref();n&&(e=Oft(Math.round(6e4*n.refreshInterval),e),n.refreshInterval?kft.get(n)||kft.set(n,t):kft.delete(n))}if(e!==Lft){if(Lft=e,clearInterval(Rft),0===Lft)return void(Rft=0);Rft=setInterval(Nft,Lft)}}),hy);const Pft=.1,Fft=t=>{let e=class extends t{constructor(...t){super(...t),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=$s((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||Cft(this)}),(()=>{}))}destroy(){Eft(this)}castRefreshInterval(t){return t>=Pft?t:t<=0?0:Pft}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(t=Date.now()){js(this._debounceHasDataChanged()).then((e=>{e&&this._set("refreshTimestamp",t),this.emit("refresh",{dataChanged:e})}),(t=>{jt.getLogger(this).error(t),this.emit("refresh",{dataChanged:!1,error:t})}))}async hasDataChanged(){return!0}get test(){}};return r([Je({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:Wrt}}}}})],e.prototype,"refreshInterval",void 0),r([Ah("refreshInterval")],e.prototype,"castRefreshInterval",null),r([Je({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),r([Je({readOnly:!0})],e.prototype,"refreshParameters",null),e=r([ln("esri.layers.mixins.RefreshableLayer")],e),e};const Dft=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const t={minScale:this.minScale,maxScale:this.maxScale},e=this.parent;e&&"effectiveScaleRange"in e&&$ft(t,e.effectiveScaleRange);const i=this._get("effectiveScaleRange");return i&&i.minScale===t.minScale&&i.maxScale===t.maxScale?i:t}};return r([Je({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),r([Je({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),r([Je({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=r([ln("esri.layers.mixins.ScaleRangeLayer")],e),e};function $ft(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}function zft(t,e){return k4.fromJSON({value:t,unit:e})}let Uft=class extends(cm(Io)){constructor(t){super(t),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(t,e){return e.timeExtent&&Array.isArray(e.timeExtent)&&2===e.timeExtent.length?MC.fromArray(e.timeExtent):null}writeFullTimeExtent(t,e){null!=t?.start&&null!=t.end?e.timeExtent=t.toArray():e.timeExtent=null}readInterval(t,e){return e.timeInterval&&e.timeIntervalUnits?zft(e.timeInterval,e.timeIntervalUnits):e.defaultTimeInterval&&e.defaultTimeIntervalUnits?zft(e.defaultTimeInterval,e.defaultTimeIntervalUnits):null}writeInterval(t,e){e.timeInterval=t?.toJSON().value??null,e.timeIntervalUnits=t?.toJSON().unit??null}};r([Je({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],Uft.prototype,"cumulative",void 0),r([Je({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],Uft.prototype,"endField",void 0),r([Je({type:MC,json:{write:{enabled:!0,allowNull:!0}}})],Uft.prototype,"fullTimeExtent",void 0),r([ko("fullTimeExtent",["timeExtent"])],Uft.prototype,"readFullTimeExtent",null),r([yh("fullTimeExtent")],Uft.prototype,"writeFullTimeExtent",null),r([Je({type:Boolean,json:{write:!0}})],Uft.prototype,"hasLiveData",void 0),r([Je({type:k4,json:{write:{enabled:!0,allowNull:!0}}})],Uft.prototype,"interval",void 0),r([ko("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],Uft.prototype,"readInterval",null),r([yh("interval")],Uft.prototype,"writeInterval",null),r([Je({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],Uft.prototype,"startField",void 0),r([Je(fg("timeReference",!0))],Uft.prototype,"timeZone",void 0),r([Je({type:String,json:{write:{enabled:!0,allowNull:!0}}})],Uft.prototype,"trackIdField",void 0),r([Je({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],Uft.prototype,"useTime",void 0),r([Je({type:[Date],json:{read:!1}})],Uft.prototype,"stops",void 0),Uft=r([ln("esri.layers.support.TimeInfo")],Uft);const Bft=Uft;const Gft={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:Wrt}}},Vft=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(t,e){const i=e.timeInfo.exportOptions;if(!i)return null;const n=i.timeOffset,s=A4.fromJSON(i.timeOffsetUnits);return n&&s?new k4({value:n,unit:s}):null}set timeInfo(t){WE(t,this.fieldsIndex),this._set("timeInfo",t)}};return r([Je({type:MC,json:{write:!1}})],e.prototype,"timeExtent",void 0),r([Je({type:k4})],e.prototype,"timeOffset",void 0),r([ko("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),r([Je({value:null,type:Bft,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),r([Je(Gft)],e.prototype,"useViewTime",void 0),e=r([ln("esri.layers.mixins.TemporalLayer")],e),e};const qft=new Co({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let Hft=class extends(cm(Io)){constructor(t){super(t),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};r([Je({json:{write:!0}})],Hft.prototype,"name",void 0),r([Je({json:{write:!0}})],Hft.prototype,"description",void 0),r([Je({json:{read:qft.read,write:qft.write}})],Hft.prototype,"drawingTool",void 0),r([Je({json:{write:!0}})],Hft.prototype,"prototype",void 0),r([Je({json:{write:!0}})],Hft.prototype,"thumbnail",void 0),Hft=r([ln("esri.layers.support.FeatureTemplate")],Hft);const Wft=Hft;let Zft=class extends(cm(Io)){constructor(t){super(t),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(t){const e={};for(const i of Object.keys(t))e[i]=o$(t[i]);return e}writeDomains(t,e){const i={};for(const e of Object.keys(t))t[e]&&(i[e]=t[e]?.toJSON());e.domains=i}};r([Je({json:{write:!0}})],Zft.prototype,"id",void 0),r([Je({json:{write:!0}})],Zft.prototype,"name",void 0),r([Je({json:{write:!0}})],Zft.prototype,"domains",void 0),r([ko("domains")],Zft.prototype,"readDomains",null),r([yh("domains")],Zft.prototype,"writeDomains",null),r([Je({type:[Wft],json:{write:!0}})],Zft.prototype,"templates",void 0),Zft=r([ln("esri.layers.support.FeatureType")],Zft);const Jft=Zft;function Yft(){return{fields:{type:[h$],value:null,set:function(t){if(t&&u("big-integer-warning-enabled")){const e=t.filter((t=>"big-integer"===t.type||"oid"===t.type&&(t.length||0)>=8));if(e.length){const t=e.map((t=>`'${t.name}'`)).join(", ");jt.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${t}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return Y7.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){const t=this._userOutFields;if(!t?.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const e of t){const i=this.fieldsIndex?.has(e);i||jt.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${e} found in outFields`,{layer:this,outFields:t})}return JE(this.fieldsIndex,t)}}}}const Kft=()=>jt.getLogger("esri.layers.support.labelingInfo"),Qft=/\[([^[\]]+)\]/gi;function Xft(t,e,i){return t?t.map((t=>{const n=new Mdt;if(n.read(t,i),n.labelExpression){const t=e.fields||e.layerDefinition?.fields||this.fields;n.labelExpression=n.labelExpression.replaceAll(Qft,((e,i)=>`[${tpt(i,t)}]`))}return n})):null}function tpt(t,e){if(!e)return t;const i=t.toLowerCase();for(let t=0;t<e.length;t++){const n=e[t].name;if(n.toLowerCase()===i)return n}return t}const ept={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function ipt(t,e){const i=[];for(const n of t){const t=n.labelPlacement,s=ept[e];if(!n.symbol)return Kft().warn("No ILabelClass symbol specified."),[];if(!s)return Kft().error(new Ve("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(s.includes(t))i.push(n);else{const r=s[0];t&&Kft().warn(`Found invalid label placement type ${t} for ${e}. Defaulting to ${r}`);const o=n.clone();o.labelPlacement=r,i.push(o)}}return i}const npt=[];function spt(t,e){if(hU(t.url??""))return!0;const{wkid:i}=e;for(const e of npt){if((t.version??0)>=e[0])return!0;if("function"==typeof e[1]&&(e[1]=e[1]()),e[1].has(i))return!1}return!0}npt.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),npt.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),npt.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),npt.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),npt.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function rpt(t,e,i){const n=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(n&&"unique-value"===n.type&&n.styleOrigin){const s=await Km(n.populateFromStyle());if(_s(i),!1===s.ok){const i=s.error;e?.messages&&e.messages.push(new wi("renderer:style-reference",`Failed to create unique value renderer from style reference: ${i.message}`,{error:i,context:e})),t.clear("renderer",e?.origin)}}}function opt({displayField:t,editFieldsInfo:e,fields:i,objectIdField:n,title:s},r){if(!i)return null;const o=hpt({editFieldsInfo:e,fields:i,objectIdField:n},r);if(!o.length)return null;const a=ppt({titleBase:s,fields:i,displayField:t}),l=fpt();return new tL({title:a,content:l,fieldInfos:o})}function apt(t){const{title:e,graphic:i}=t??{},{attributes:n,sourceLayer:s}=i??{},r=s&&"displayField"in s?s.displayField:null,o=r?n?.[r]:null,a=i?.getObjectId()?.toString();return e||o||a||""}const lpt=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):Sj(t,e);function upt({fields:t,ignoreFieldTypes:e,sortDisabled:i}){const n=t;return e&&(t=t.filter((t=>!e.includes(t.type)))),t===n&&(t=t.slice()),!0!==i&&t.sort(cpt),t}function cpt(t,e){return"oid"===t.type?-1:"oid"===e.type?1:mpt(t)?-1:mpt(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function hpt(t,e){const i=e?.visibleFieldNames;return upt({fields:t.fields??[],ignoreFieldTypes:e?.ignoreFieldTypes||ypt,sortDisabled:e?.sortDisabled}).map((e=>new OO({fieldName:e.name,isEditable:bj(e,t),label:e.alias,format:dpt(e),visible:lpt(e,{...t,visibleFieldNames:i})})))}function dpt(t){switch(t.type){case"small-integer":case"integer":case"single":return new CO({digitSeparator:!0,places:0});case"double":return new CO({digitSeparator:!0,places:2});case"string":return hO(t.name)?new CO({digitSeparator:!0,places:0}):void 0;default:return}}function fpt(){return[new NO,new vO]}function ppt(t){const e=ij(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i??""}function mpt(t){if("name"===(t.name&&t.name.toLowerCase()))return!0;const e=t.alias?.toLowerCase();return"name"===e}const ypt=["geometry","blob","raster","guid","xml"];const gpt=1/255.5;const vpt="FeatureLayer";function wpt(t,e){return new Ve("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function bpt(t){return t&&t instanceof Vm}const Spt=Yft();function _pt(t,e,i){const n=!!i?.writeLayerSchema;return{enabled:n,ignoreOrigin:n}}let xpt=class extends($ht(aft(vut(Aft(sut(Blt(bft(Vft(Dft(Fft(Xat(dft(Sft(Y5(Glt(Qat(cm(CC)))))))))))))))))){constructor(...t){super(...t),this.attributeTableTemplate=null,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=wh.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=$s((async(t,e,i)=>{const{save:n,saveAs:s}=await import("./p-ffdea19b.js");switch(t){case m4.SAVE:return n(this,e);case m4.SAVE_AS:return s(this,i,e)}}))}destroy(){this.source?.destroy()}normalizeCtorArgs(t,e){return"string"==typeof t?{url:t,...e}:t}load(t){const e=null!=t?t.signal:null;if(this.portalItem?.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(e).then((t=>this.initLayerProperties(t)))),Promise.resolve(this);const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},t).catch(Ts).then((async()=>{if(this.url&&null==this.layerId&&/FeatureServer|MapServer\/*$/i.test(this.url)){const t=await this._fetchFirstValidLayerId(e);null!=t&&(this.layerId=t)}if(!this.url&&!this._hasMemorySource())throw new Ve("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(e))})).then((()=>Xct(this,"load",t)));return this.addResolvingPromise(i),Promise.resolve(this)}warnInvisibleDrapedSymbols(){"on-the-ground"===this.elevationInfo?.mode&&"simple"===this.renderer?.type&&"polygon-3d"===this.renderer.symbol?.type&&this.renderer.symbol.symbolLayers.some((t=>"fill"===t.type&&null!=t.material&&((!t.material.color||t.material.color.a*this.opacity<gpt)&&(this.loadWarnings.push(new wi("feature-layer:invisible-draped-symbols","FeatureLayer has fully transparent symbols which will no longer render or highlight",{layer:this})),!0))))}readCapabilities(t,e){return e=e.layerDefinition||e,Tht(e,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return!(this.loaded&&!this.capabilities?.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){this._overrideIfSome("editingEnabled",t)}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,i){return this._readEditingEnabled(e,!0,i)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,i,n){this._writeEditingEnabled(t,e,!0,n)}get effectiveEditingEnabled(){return tht(this)}readIsTable(t,e){return"Table"===(e=e?.layerDefinition??e).type||!e.geometryType}writeIsTable(t,e,i,n){n?.writeLayerSchema&&gt(i,t?"Table":"Feature Layer",e)}readGlobalIdField(t,e){return qct(e.layerDefinition||e)}readObjectIdField(t,e){return Hct(e.layerDefinition||e)}get parsedUrl(){const t=ca(this.url);return null!=t&&(null!=this.dynamicDataSource?t.path=Ea(t.path,"dynamicLayer"):null!=this.layerId&&(t.path=Ea(t.path,this.layerId.toString()))),t}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){qE(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,i){e=e.layerDefinition||e;const n=e.drawingInfo?.renderer;if(n){const t=Hrt(n,e,i)??void 0;return t||jt.getLogger(this).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:i}),t}return iht(e,i)}set source(t){const e=this._get("source");e!==t&&(bpt(e)&&this._resetMemorySource(e),bpt(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof Vm?new Yat({layer:this,items:t}):t:null}readSource(t,e){const i=Zat.fromJSON(e.featureSet);return new Yat({layer:this,items:i?.features??[]})}readTemplates(t,e){const i=e.editFieldsInfo,n=i?.creatorField,s=i?.editorField;return t=t?.map((t=>Wft.fromJSON(t))),this._fixTemplates(t,n),this._fixTemplates(t,s),t}readTitle(t,e){const i=e.layerDefinition?.name??e.name,n=e.title||e.layerDefinition?.title;if(i){const t=this.portalItem?.title;if("item-title"===this.sublayerTitleMode)return this.url?cU(this.url,i):i;let e=i;if(!e&&this.url){const t=aU(this.url);null!=t&&(e=t.title)}if(!e)return;return"item-title-and-service-name"===this.sublayerTitleMode&&t&&t!==e&&(e=t+" - "+e),uU(e)}if("item-title"===this.sublayerTitleMode&&n)return n}readTitleFromWebMap(t,e){return e.title||e.layerDefinition?.name}readTypeIdField(t,e){let i=(e=e.layerDefinition||e).typeIdField;if(i&&e.fields){i=i.toLowerCase();const t=e.fields.find((t=>t.name.toLowerCase()===i));t&&(i=t.name)}return i}readTypes(t,e){t=(e=e.layerDefinition||e).types;const i=e.editFieldsInfo,n=i?.creatorField,s=i?.editorField;return t?.map((t=>(t=Jft.fromJSON(t),this._fixTemplates(t.templates,n),this._fixTemplates(t.templates,s),t)))}readVisible(t,e){return null!=e.layerDefinition?.defaultVisibility?!!e.layerDefinition.defaultVisibility:null!=e.visibility?!!e.visibility:void 0}async addAttachment(t,e){return Ect(this,t,e,vpt)}async updateAttachment(t,e,i){return Oct(this,t,e,i,vpt)}async applyEdits(t,e){return Rct(this,t,e)}async uploadAssets(t,e){return Lct(this,t,e)}on(t,e){return super.on(t,e)}createPopupTemplate(t){return opt(this,t)}async createGraphicsSource(t){if(this._hasMemorySource()&&this.source)return this.source.load({signal:t});const{default:e}=await Cs(import("./p-00d0ebf5.js"),t);return new e({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:t})}createQuery(){const t=Vct(this);t.dynamicDataSource=this.dynamicDataSource;const e=null!=this.subtypeCode?`${this.subtypeField} = ${this.subtypeCode}`:null,i=ZC(this.definitionExpression,e);return t.where=i||"1=1",t}async deleteAttachments(t,e){return Nct(this,t,e,vpt)}async fetchRecomputedExtents(t){return Pct(this,t,vpt)}getFeatureType(t){return rht(this.types,this.typeIdField,t)}getFieldDomain(t,e){const i=e?.feature,n=!!this.subtypes?.length;if(n&&!e?.excludeImpliedDomains){const e=Jct(this,t);if(e)return e}const s=n&&Zct(this,i);if(s){const e=s?.domains?.[t];return"inherited"===e?.type?this._getLayerDomain(t):e}const r=this.getFeatureType(i),o=this._getLayerDomain(t);if(r){const e=r.domains&&r.domains[t];if(e&&"inherited"!==e?.type)return e;if("inherited"===e?.type&&o)return o}if(!e?.excludeImpliedDomains){const e=Yct(this,t);if(e)return e}return o}getField(t){return this.fieldsIndex.get(t)}async queryAttachments(t,e){return Fct(this,t,e,vpt)}async queryFeatures(t,e){const i=await this.load(),n=await i.source.queryFeatures(V$.from(t)??i.createQuery(),e);if(n?.features)for(const t of n.features)t.layer=t.sourceLayer=i;return n}async queryObjectIds(t,e){return Dct(this,t,e,vpt)}async queryFeatureCount(t,e){return $ct(this,t,e,vpt)}async queryExtent(t,e){return zct(this,t,e,vpt)}async queryRelatedFeatures(t,e){return Uct(this,t,e,vpt)}async queryRelatedFeaturesCount(t,e){return Bct(this,t,e,vpt)}async queryTopFeatures(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryTopFeatures||!n?.query?.supportsTopFeaturesQuery)throw new Ve(vpt,"Layer source does not support queryTopFeatures capability");const s=await import("./p-bd629d1b.js"),r=await i.queryTopFeatures(s.default.from(t),e);if(r?.features)for(const t of r.features)t.layer=t.sourceLayer=this;return r}async queryBins(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryBins||!n?.operations?.supportsQueryBins)throw new Ve(vpt,"Layer source does not support queryBins capability");lht(t,n,vpt);const s=await import("./p-f9a549ce.js"),r=await i.queryBins(s.default.from(t),e);if(r.features)for(const t of r.features)t.layer=t.sourceLayer=this;return r}async queryTopObjectIds(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryTopObjectIds||!n?.query.supportsTopFeaturesQuery)throw new Ve(vpt,"Layer source does not support queryTopObjectIds capability");const s=await import("./p-bd629d1b.js");return i.queryTopObjectIds(s.default.from(t),e)}async queryTopFeaturesExtent(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryTopExtents||!n?.query?.supportsTopFeaturesQuery)throw new Ve(vpt,"Layer source does not support queryTopExtents capability");const s=await import("./p-bd629d1b.js");return i.queryTopExtents(s.default.from(t),e)}async queryTopFeatureCount(t,e){const{source:i,capabilities:n}=await this.load();if(!i.queryTopCount||!n?.query?.supportsTopFeaturesQuery)throw new Ve(vpt,"Layer source does not support queryFeatureCount capability");const s=await import("./p-bd629d1b.js");return i.queryTopCount(s.default.from(t),e)}read(t,e){const i=t.featureCollection;if((i||"Feature Collection"===t.type)&&(this.resourceInfo=t),i){const t=i.layers;t&&1===t.length&&(super.read(t[0],e),null!=i.showLegend&&super.read({showLegend:i.showLegend},e))}super.read(t,e),e&&"service"===e.origin&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(t,e){e={...e,origin:e?.origin??void 0,writeLayerSchema:e?.writeLayerSchema??this._hasMemorySource()};const{origin:i,layerContainerType:n,messages:s}=e;if(this.dynamicDataSource)return s?.push(wpt(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if(("web-map"===i||"web-scene"===i)&&"tables"!==n)return s?.push(wpt(this,`a table source can only be written to tables, not ${n}`)),null;if(this._hasMemorySource())return s?.push(wpt(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&("web-map"===i||"web-scene"===i)&&"tables"===n)return s?.push(wpt(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(t,e)}clone(){if(this._hasMemorySource())throw new Ve(vpt,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(t){return!!this.loaded&&("memory"===this.source?.type||spt(this,t))}async save(t){return this._debouncedSaveOperations(m4.SAVE,t)}async saveAs(t,e){return this._debouncedSaveOperations(m4.SAVE_AS,e,t)}_readEditingEnabled(t,e,i){let n=t.layerDefinition?.capabilities;return n?this._hasEditingCapability(n):(n=t.capabilities,e&&"web-map"===i?.origin&&!this._hasMemorySource()&&n?this._hasEditingCapability(n):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map((t=>t.trim())).includes("editing")}_writeEditingEnabled(t,e,i,n){if(!t){const t=this.capabilities?.operations?.supportsSync?"Query,Sync":"Query";gt("layerDefinition.capabilities",t,e),i&&!n?.writeLayerSchema&&(e.capabilities=t)}}_getLayerDomain(t){const e=this.fieldsIndex.get(t);return e?e.domain:null}_fetchFirstValidLayerId(t){return Pl(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then((t=>{const e=t.data;if(e)return this.findFirstValidLayerId(e)}))}async initLayerProperties(t){return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:this.portalItem?.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),qE(this.renderer,this.fieldsIndex),WE(this.timeInfo,this.fieldsIndex),rpt(this,{origin:"service"})}async hasDataChanged(){return Gct(this)}async fetchPublishingStatus(){const t=this.source;return t?.fetchPublishingStatus?t.fetchPublishingStatus():"unavailable"}_verifyFields(){const t=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||-1!==t.search(/\/FeatureServer\//i)||this.fields?.some((t=>"geometry"===t.type))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach((t=>{const i=t.prototype?.attributes;i&&e&&delete i[e]}))}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new Ve("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new Ve("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach((t=>{t.layer=this,t.sourceLayer=this})),this.addHandles([t.on("after-add",(t=>{t.item.layer=this,t.item.sourceLayer=this})),t.on("after-remove",(t=>{t.item.layer=null,t.item.sourceLayer=null}))],"fl-source")}_resetMemorySource(t){t.forEach((t=>{t.layer=null,t.sourceLayer=null})),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(t){return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}};r([Je(pct)],xpt.prototype,"attributeTableTemplate",void 0),r([ko("service","capabilities")],xpt.prototype,"readCapabilities",null),r([Je({json:{origins:{"web-scene":{write:!1}},write:!0}})],xpt.prototype,"charts",void 0),r([Je({readOnly:!0})],xpt.prototype,"createQueryVersion",null),r([Je({json:{read:{source:"layerDefinition.copyrightText"}}})],xpt.prototype,"copyright",void 0),r([Je({json:{read:{source:"layerDefinition.displayField"}}})],xpt.prototype,"displayField",void 0),r([Je({types:gD,readOnly:!0})],xpt.prototype,"defaultSymbol",void 0),r([Je({type:C$})],xpt.prototype,"dynamicDataSource",void 0),r([Je({type:Boolean})],xpt.prototype,"editingEnabled",null),r([ko(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],xpt.prototype,"readEditingEnabled",null),r([ko("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],xpt.prototype,"readEditingEnabledFromWebMap",null),r([yh(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],xpt.prototype,"writeEditingEnabled",null),r([yh("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],xpt.prototype,"writeEditingEnabledToWebMap",null),r([Je({readOnly:!0})],xpt.prototype,"effectiveEditingEnabled",null),r([Je({...Spt.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:_pt}}}}})],xpt.prototype,"fields",void 0),r([Je(Spt.fieldsIndex)],xpt.prototype,"fieldsIndex",void 0),r([Je({type:$at,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],xpt.prototype,"formTemplate",void 0),r([Je({json:{read:{source:"layerDefinition.extent"}}})],xpt.prototype,"fullExtent",void 0),r([Je({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:_pt,writer(t,e,i){const n=t?Cct.toJSON(t):null;n&&gt(i,n,e)}}}},read:{source:"layerDefinition.geometryType",reader:Cct.read}}})],xpt.prototype,"geometryType",void 0),r([Je({json:{read:{source:"layerDefinition.hasM"}}})],xpt.prototype,"hasM",void 0),r([Je({json:{read:{source:"layerDefinition.hasZ"}}})],xpt.prototype,"hasZ",void 0),r([Je(cct)],xpt.prototype,"id",void 0),r([Je({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],xpt.prototype,"infoFor3D",void 0),r([Je({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],xpt.prototype,"isTable",void 0),r([ko("service","isTable",["type","geometryType"]),ko("isTable",["layerDefinition.type","layerDefinition.geometryType"])],xpt.prototype,"readIsTable",null),r([yh("web-map","isTable")],xpt.prototype,"writeIsTable",null),r([Je(ect)],xpt.prototype,"labelsVisible",void 0),r([Je({type:[Mdt],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:Xft,write:!1},"web-scene":{name:"layerDefinition.drawingInfo.labelingInfo",read:Xft,write:{enabled:!0,layerContainerTypes:Wrt}}},name:"layerDefinition.drawingInfo.labelingInfo",read:Xft,write:!0}})],xpt.prototype,"labelingInfo",void 0),r([Je((()=>{const t=nt(lct);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(t,e,i){gt(i,DA(t),e)}}},t})())],xpt.prototype,"opacity",void 0),r([Je(nct)],xpt.prototype,"legendEnabled",void 0),r([Je({type:["show","hide"],json:(()=>{const t=nt(fct.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],xpt.prototype,"listMode",void 0),r([ko("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],xpt.prototype,"readGlobalIdField",null),r([Je({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:_pt}}}}})],xpt.prototype,"objectIdField",void 0),r([ko("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],xpt.prototype,"readObjectIdField",null),r([Je({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],xpt.prototype,"operationalLayerType",void 0),r([Je(Spt.outFields)],xpt.prototype,"outFields",void 0),r([Je({readOnly:!0})],xpt.prototype,"parsedUrl",null),r([Je({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],xpt.prototype,"path",void 0),r([Je(tct)],xpt.prototype,"popupEnabled",void 0),r([Je({type:tL,json:{name:"popupInfo",write:!0}})],xpt.prototype,"popupTemplate",void 0),r([Je({readOnly:!0})],xpt.prototype,"defaultPopupTemplate",null),r([Je({types:Drt,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:$rt,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:Wrt,overridePolicy:(t,e,i)=>({ignoreOrigin:i?.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,i)=>({ignoreOrigin:i?.writeLayerSchema})}}})],xpt.prototype,"renderer",null),r([ko("service","renderer",["drawingInfo.renderer","defaultSymbol"]),ko("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],xpt.prototype,"readRenderer",null),r([Je()],xpt.prototype,"resourceInfo",void 0),r([Je((()=>{const t=nt(Xut);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],xpt.prototype,"screenSizePerspectiveEnabled",void 0),r([Je({clonable:!1})],xpt.prototype,"source",null),r([Ah("source")],xpt.prototype,"castSource",null),r([ko("portal-item","source",["featureSet"]),ko("web-map","source",["featureSet"])],xpt.prototype,"readSource",null),r([Je({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],xpt.prototype,"spatialReference",void 0),r([Je({type:Number})],xpt.prototype,"subtypeCode",void 0),r([Je({type:[Wft]})],xpt.prototype,"templates",void 0),r([ko("templates",["editFieldsInfo","creatorField","editorField","templates"])],xpt.prototype,"readTemplates",null),r([Je({type:Bft})],xpt.prototype,"timeInfo",void 0),r([Je()],xpt.prototype,"title",void 0),r([ko("service","title",["name"]),ko("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],xpt.prototype,"readTitle",null),r([ko("web-map","title",["layerDefinition.name","title"])],xpt.prototype,"readTitleFromWebMap",null),r([Je({type:String})],xpt.prototype,"sublayerTitleMode",void 0),r([Je({json:{read:!1}})],xpt.prototype,"type",void 0),r([Je({type:String})],xpt.prototype,"typeIdField",void 0),r([ko("service","typeIdField"),ko("typeIdField",["layerDefinition.typeIdField"])],xpt.prototype,"readTypeIdField",null),r([Je({type:[Jft]})],xpt.prototype,"types",void 0),r([ko("service","types",["types"]),ko("types",["layerDefinition.types"])],xpt.prototype,"readTypes",null),r([Je({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],xpt.prototype,"visible",void 0),r([ko("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],xpt.prototype,"readVisible",null),xpt=r([ln("esri.layers.FeatureLayer")],xpt);const Mpt=xpt;const Tpt=Object.freeze({__proto__:null,default:Mpt});let Apt=class extends Io{constructor(t){super(t),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.dirtyAreaCount=null,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};r([Je({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.moment=t?t.getTime():null}}}})],Apt.prototype,"moment",void 0),r([Je({type:Boolean,json:{write:!0}})],Apt.prototype,"fullUpdate",void 0),r([Je({type:Boolean,json:{write:!0}})],Apt.prototype,"validateErrorsCreated",void 0),r([Je({type:Number,json:{write:!0}})],Apt.prototype,"dirtyAreaCount",void 0),r([Je({type:Boolean,json:{write:!0}})],Apt.prototype,"exceededTransferLimit",void 0),r([Je({type:[Object],json:{write:!0}})],Apt.prototype,"serviceEdits",void 0),r([Je({type:[Object],json:{write:!0}})],Apt.prototype,"discoveredSubnetworks",void 0),Apt=r([ln("esri.rest.networks.support.ValidateNetworkTopologyResult")],Apt);const Ipt=Apt;const kpt=Oo()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let Cpt=class extends Ipt{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const e={...t,query:{f:"json"}},{data:i}=await Pl(this.statusUrl,e);return this.read(i),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(t={}){const{interval:e=1e3,statusCallback:i}=t;return new Promise(((t,n)=>{this._clearTimer();const s=setInterval((()=>{this._timer||n(Ss()),this.checkJobStatus().then((e=>{const{status:n}=e;switch(this.status=n,n){case"job-succeeded":this._clearTimer(),t(this);break;case"job-waiting":case"job-executing":i&&i(this)}}),(t=>{this._clearTimer(),n(t)}))}),e);this._timer=s}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};r([Je()],Cpt.prototype,"editsResolver",void 0),r([Je({type:String,json:{write:!0}})],Cpt.prototype,"statusUrl",void 0),r([NA(kpt)],Cpt.prototype,"status",void 0),r([Je({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],Cpt.prototype,"submissionTime",void 0),r([Je({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],Cpt.prototype,"lastUpdatedTime",void 0),Cpt=r([ln("esri.networks.support.TopologyValidationJobInfo")],Cpt);const Ept=Cpt;async function jpt(t,e){if("Utility Network Layer"===t){const{default:t}=await Promise.resolve().then((function(){return vmt}));return new t({layerUrl:e})}return null}async function Opt(t){let e="portalItem"in t?t:{portalItem:t};!e.portalItem||e.portalItem instanceof NT||(e={...e,portalItem:new NT(e.portalItem)});const i=e.portalItem;if(await i.load(),"Feature Service"!==i.type)throw new Ve("portal:unknown-item-type","Unknown item type '${type}'",{type:i.type});const n=i.url,s=await Pl(n,{responseType:"json",query:{f:"json"}}),r="Network Layer";if(s.data.type?.includes(r))return jpt(s.data.type,n);if(s.data.layers){const t=s.data.layers.find((t=>t.type.includes(r)));if(t){const e=`${n}/${t.id}`;return jpt(t.type,e)}}return null}let Rpt=class extends(Y5($M)){static fromPortalItem(t){return Opt(t)}constructor(t){super(t),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._sourceIdByLayerId=new Map,this._layerIdBySourceId=new Map,this._applyEditsHandler=t=>{const{serviceUrl:e,gdbVersion:i,result:n}=t,s=e===this.featureServiceUrl,r=nut(e,i,this.gdbVersion);s&&r&&n.then((t=>{Jlt(e,i)&&(this.historicMoment=t.historicMoment)}))},this._updateMomentHandler=t=>{const{serviceUrl:e,gdbVersion:i,moment:n}=t,s=e===this.featureServiceUrl,r=nut(e,i,this.gdbVersion);s&&r&&(this.historicMoment=n)},this.when().then((()=>{this.addHandles([Klt(this._applyEditsHandler),Qlt(this._updateMomentHandler)])}),(()=>{}))}initialize(){this.when().catch((t=>{Es(t)||jt.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})}))}get datasetName(){return this.dataElement?.name??null}get owner(){return this.dataElement?.userIdentity??null}get schemaGeneration(){return this.dataElement?.schemaGeneration??null}get parsedUrl(){return ca(this.layerUrl)}get featureServiceUrl(){return aU(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return aU(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(t){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),t)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,t)),this}getLayerIdBySourceId(t){if(!this.dataElement)return null;const e=this._layerIdBySourceId.get(t);if(null!=e)return e;const i=this.dataElement.domainNetworks,n=this._traverseNetworkSources(i,this._layerIdBySourceId,"sourceId","layerId",t);return n>=0?n:null}getSourceIdByLayerId(t){if(!this.dataElement)return null;const e=this._sourceIdByLayerId.get(t);if(null!=e)return e;const i=this.dataElement.domainNetworks,n=this._traverseNetworkSources(i,this._sourceIdByLayerId,"layerId","sourceId",t);return n>=0?n:null}getObjectIdsFromElements(t){const e=[],i=new Map;for(const e of t){const t=this.getLayerIdBySourceId(e.networkSourceId);if(null==t)continue;let n=i.get(t);void 0===n&&(n=[]),n.push(e.objectId),i.set(t,n)}const n=this.featureServiceUrl;return i.forEach(((t,i)=>e.push({layerUrl:`${n}/${i}`,objectIds:t}))),e}async queryNamedTraceConfigurations(t,e){const[{queryNamedTraceConfigurations:i},{default:n}]=await Promise.all([import("./p-e1e7f772.js"),import("./p-a88f5f2a.js")]),s=this.networkServiceUrl,r=n.from(t);return(await i(s,r,{...e}))?.namedTraceConfigurations}async validateTopology(t,e){if(!t.validateArea)throw new Ve("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:i},{default:n}]=await Promise.all([import("./p-0b428620.js"),import("./p-a7c11157.js")]),s=n.from(t);Jlt(this.featureServiceUrl,this.gdbVersion||null)?(s.sessionID=Vlt,await Zlt(this.featureServiceUrl,this.gdbVersion,!0)):s.sessionID=null,s.gdbVersion=this.gdbVersion;const r=this.networkServiceUrl,o=this.featureServiceUrl,a=Xlt(o,null,this.gdbVersion,!0),l=await i(r,s,{...e});if(l?.serviceEdits){const t=[];for(const e of l.serviceEdits){const{editedFeatures:i}=e,n=i?.spatialReference?new wh(i.spatialReference):null;t.push({layerId:e.layerId,editedFeatures:{adds:i?.adds?.map((t=>Lpt(t,n)))||[],updates:i?.updates?.map((t=>({original:Lpt(t[0],n),current:Lpt(t[1],n)})))||[],deletes:i?.deletes?.map((t=>Lpt(t,n)))||[],spatialReference:n}})}a.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:t,exceededTransferLimit:!1,historicMoment:l.moment})}return l}async submitTopologyValidationJob(t,e){let i=null;if(!t.validateArea)throw new Ve("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const t=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");i=(await Pl(t,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:n},{default:s}]=await Promise.all([import("./p-0b428620.js"),import("./p-a7c11157.js")]),r=s.from(t);Jlt(this.featureServiceUrl,this.gdbVersion||null)?(r.sessionID=Vlt,await Zlt(this.featureServiceUrl,this.gdbVersion,!0)):r.sessionID=null,r.gdbVersion=this.gdbVersion||i;const o=this.networkServiceUrl,a=this.featureServiceUrl?Xlt(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,l=await n(o,r,{...e});return new Ept({statusUrl:l,editsResolver:a})}_traverseNetworkSources(t,e,i,n,s){for(const r of t)for(const t of[r.edgeSources??[],r.junctionSources??[]])for(const r of t)if(r[i]===s)return e.set(s,r[n]),r[n];return-1}async _fetchLayerMetaData(t,e){const i=await Pl(t,{responseType:"json",query:{f:"json"},...e});this.sourceJSON=i.data,this.read(i.data,{origin:"service"})}async _fetchDataElement(t,e,i){if(this.dataElement)return;const n=await Pl(`${t}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then((t=>t.data.layerDataElements?.[0]));n&&this.read(n,{origin:"service"})}};function Lpt(t,e){return new OD({attributes:t.attributes,geometry:rm({...t.geometry,spatialReference:e})})}r([Je({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],Rpt.prototype,"id",void 0),r([Je({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],Rpt.prototype,"title",void 0),r([Je({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],Rpt.prototype,"layerUrl",void 0),r([Je({type:Object,json:{origins:{service:{read:!0}},read:!1}})],Rpt.prototype,"dataElement",void 0),r([Je({type:Od,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],Rpt.prototype,"fullExtent",void 0),r([Je({type:wh,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],Rpt.prototype,"spatialReference",void 0),r([Je({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],Rpt.prototype,"type",void 0),r([Je({readOnly:!0})],Rpt.prototype,"datasetName",null),r([Je({readOnly:!0})],Rpt.prototype,"owner",null),r([Je({readOnly:!0})],Rpt.prototype,"schemaGeneration",null),r([Je({readOnly:!0})],Rpt.prototype,"parsedUrl",null),r([Je({readOnly:!0})],Rpt.prototype,"featureServiceUrl",null),r([Je({readOnly:!0})],Rpt.prototype,"networkServiceUrl",null),r([Je({readOnly:!0})],Rpt.prototype,"layerId",null),r([Je()],Rpt.prototype,"sourceJSON",void 0),r([Je({readOnly:!0})],Rpt.prototype,"networkSystemLayers",null),r([Je()],Rpt.prototype,"gdbVersion",void 0),r([Je({type:Date})],Rpt.prototype,"historicMoment",void 0),Rpt=r([ln("esri.networks.Network")],Rpt);const Npt=Rpt;var Ppt;!function(t){t[t.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",t[t.RTAttachment=2]="RTAttachment",t[t.RTContainment=3]="RTContainment",t[t.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",t[t.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"}(Ppt||(Ppt={}));const Fpt=new Co({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"}),Dpt=new Co({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),$pt={connectivity:1,"junction-junction-connectivity":1,attachment:2,containment:3,"junction-edge-from-connectivity":4,"junction-midspan-connectivity":5,"junction-edge-to-connectivity":6},zpt=Array.from({length:33},((t,e)=>2*e)),Upt=new Map([[1,"connectivity"],[2,"containment"],[3,"attachment"],[4,"junction-edge-from-connectivity"],[5,"junction-midspan-connectivity"],[6,"junction-edge-to-connectivity"]]),Bpt=new Co({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});let Gpt=class extends(Mo($M)){constructor(t){super(t),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=Pl}initialize(){}async load(t){const e=this.layer.load(t).then((()=>this._initializeRulesTable()));return this.addResolvingPromise(e),this}getFeatureSQL(t,e){const i=t.layerId.toString(),n=t.fieldsIndex?.normalizeFieldName("assetGroup"),s=t.fieldsIndex?.normalizeFieldName("assetType"),r=n?e.attributes[n]:null,o=s?e.attributes[s]:null,a=this.rulesHash[i];if(a){const t=a.assetGroupHash[r];if(t){return t.assetTypeHash[o]||null}}return null}async _initializeRulesTable(){const t={};let e;!function(t){t[t.from=0]="from",t[t.to=1]="to",t[t.via=2]="via"}(e||(e={}));const i=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const n of this.rules){if(n.ruleType===Ppt.RTAttachment){this.rulesCategorized.attachment.push(n);continue}if(n.ruleType===Ppt.RTContainment){this.rulesCategorized.containment.push(n);continue}if(n.ruleType===Ppt.RTJunctionJunctionConnectivity){this.rulesCategorized.connectivity.push(n);continue}this.rulesCategorized.connectivity.push(n);let s=[[e.from,e.to],[e.to,e.from]];n.ruleType===Ppt.RTEdgeJunctionEdgeConnectivity&&(s=[[e.from,e.via],[e.via,e.from],[e.to,e.via],[e.via,e.to]]);for(const r of s){const s=r.shift(),o=r.shift();let a=!1;switch(n.ruleType){case Ppt.RTEdgeJunctionEdgeConnectivity:a=s===e.from||s===e.to;break;case Ppt.RTJunctionEdgeConnectivity:a=s===e.to}const l=i[s],u=n[l.networkSourceId]?.layerId.toString()??"",c=n[l.assetGroupId]?.assetGroupCode?.toString(),h=n[l.assetTypeId],d=h?.assetTypeCode?.toString(),f=i[o],p=n[f.networkSourceId]?.layerId.toString()??"",m=n[f.assetGroupId]?.assetGroupCode?.toString(),y=n[f.assetTypeId],g=y?.assetTypeCode?.toString(),v=t[u]??{assetGroupHash:{}};if(!(c&&d&&m&&g))continue;const w=v.assetGroupHash[c]??{assetTypeHash:{}},b=w.assetTypeHash[d]??{};if(b[p]=b[p]??{},a){b[u]=b[u]??{};const t=`(assetgroup = ${c} AND assettype = ${d})`;"esriNECPEndVertex"===y?.connectivityPolicy?b[u].endVertex=b[u]?.endVertex?`${b[u].endVertex}`:`${t}`:b[u].anyVertex=b[u].anyVertex?`${b[u].anyVertex}`:`${t}`}const S=`(assetgroup = ${m} AND assettype = ${g})`;"esriNECPEndVertex"===y?.connectivityPolicy?b[p].endVertex=b[p]?.endVertex?`${b[p].endVertex} OR ${S}`:`${S}`:b[p].anyVertex=b[p]?.anyVertex?`${b[p].anyVertex} OR ${S}`:`${S}`,w.assetTypeHash[d]=b,v.assetGroupHash[c]=w,t[u]=v}}this.rulesHash=t}};r([Je({constructOnly:!0})],Gpt.prototype,"layer",void 0),r([Je({constructOnly:!0})],Gpt.prototype,"rules",void 0),r([Je()],Gpt.prototype,"rulesHash",void 0),r([Je()],Gpt.prototype,"rulesCategorized",void 0),r([Je({constructOnly:!0})],Gpt.prototype,"request",void 0),Gpt=r([ln("esri.networks.RulesTable")],Gpt);const Vpt=Gpt;let qpt=class extends Io{constructor(t){super(t),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};r([Je({type:[Object],json:{write:!0}})],qpt.prototype,"conditionBarriers",void 0),r([Je({type:[Object],json:{write:!0}})],qpt.prototype,"outputConditions",void 0),r([Je({type:[Object],json:{write:!0}})],qpt.prototype,"functions",void 0),r([Je({type:[Object],json:{write:!0}})],qpt.prototype,"functionBarriers",void 0),r([Je({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],qpt.prototype,"traversabilityScope",void 0),r([Je({type:String,json:{write:!0}})],qpt.prototype,"shortestPathNetworkAttributeName",void 0),r([Je({type:Boolean,json:{write:!0}})],qpt.prototype,"includeBarriers",void 0),r([Je({type:Boolean,json:{write:!0}})],qpt.prototype,"validateConsistency",void 0),r([Je({type:Boolean,json:{write:!0}})],qpt.prototype,"ignoreBarriersAtStartingPoints",void 0),qpt=r([ln("esri.networks.support.TraceConfiguration")],qpt);const Hpt=qpt;let Wpt=class extends Hpt{constructor(t){super(t),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};r([Je({type:[Object],json:{write:!0}})],Wpt.prototype,"filterBarriers",void 0),r([Je({type:String,json:{write:!0}})],Wpt.prototype,"arcadeExpressionBarrier",void 0),r([Je({type:String,json:{write:!0}})],Wpt.prototype,"domainNetworkName",void 0),r([Je({type:String,json:{write:!0}})],Wpt.prototype,"filterBitsetNetworkAttributeName",void 0),r([Je({type:[Object],json:{write:!0}})],Wpt.prototype,"filterFunctionBarriers",void 0),r([Je({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],Wpt.prototype,"filterScope",void 0),r([Je({type:Boolean,json:{write:!0}})],Wpt.prototype,"includeContainers",void 0),r([Je({type:Boolean,json:{write:!0}})],Wpt.prototype,"includeContent",void 0),r([Je({type:Boolean,json:{write:!0}})],Wpt.prototype,"includeIsolated",void 0),r([Je({type:Boolean,json:{write:!0}})],Wpt.prototype,"includeStructures",void 0),r([Je({type:Boolean,json:{write:!0}})],Wpt.prototype,"allowIndeterminateFlow",void 0),r([Je({type:Boolean,json:{write:!0}})],Wpt.prototype,"includeUpToFirstSpatialContainer",void 0),r([Je({type:Object,json:{write:!0}})],Wpt.prototype,"nearestNeighbor",void 0),r([Je({type:[Object],json:{write:!0}})],Wpt.prototype,"outputFilterCategories",void 0),r([Je({type:[Object],json:{write:!0}})],Wpt.prototype,"outputFilters",void 0),r([Je({type:[Object],json:{write:!0}})],Wpt.prototype,"propagators",void 0),r([Je({type:String,json:{write:!0}})],Wpt.prototype,"subnetworkName",void 0),r([Je({type:String,json:{write:!0}})],Wpt.prototype,"targetTierName",void 0),r([Je({type:String,json:{write:!0}})],Wpt.prototype,"diagramTemplateName",void 0),r([Je({type:String,json:{write:!0}})],Wpt.prototype,"tierName",void 0),r([Je({type:Boolean,json:{write:!0}})],Wpt.prototype,"validateLocatability",void 0),Wpt=r([ln("esri.networks.support.UNTraceConfiguration")],Wpt);const Zpt=Wpt;let Jpt=class extends K5{constructor(t){super(t),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(t,e){return void 0!==t.tierName?Zpt.fromJSON(t):Hpt.fromJSON(t)}};r([Je({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],Jpt.prototype,"globalId",void 0),r([Je({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],Jpt.prototype,"title",void 0),r([Je({type:Hpt,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jpt.prototype,"traceConfiguration",void 0),r([ko("service","traceConfiguration")],Jpt.prototype,"readTraceConfiguration",null),r([Je({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jpt.prototype,"creationDate",void 0),r([Je({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jpt.prototype,"creator",void 0),r([Je({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jpt.prototype,"description",void 0),r([Je({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],Jpt.prototype,"minStartingPoints",void 0),r([Je({json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jpt.prototype,"resultTypes",void 0),r([Je({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],Jpt.prototype,"tags",void 0),r([Je({type:Fpt.apiValues,json:{type:Fpt.jsonValues,origins:{service:{read:Fpt.read,write:Fpt.write}},read:!1}})],Jpt.prototype,"traceType",void 0),Jpt=r([ln("esri.networks.support.NamedTraceConfiguration")],Jpt);const Ypt=Jpt;let Kpt=class extends ao{constructor(t){super(t),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTableId=null,this.associationsTableUrl=null}};r([Je({constructOnly:!0})],Kpt.prototype,"rulesTableId",void 0),r([Je({constructOnly:!0})],Kpt.prototype,"rulesTableUrl",void 0),r([Je({constructOnly:!0})],Kpt.prototype,"subnetworksTableId",void 0),r([Je({constructOnly:!0})],Kpt.prototype,"subnetworksTableUrl",void 0),r([Je({constructOnly:!0})],Kpt.prototype,"dirtyAreasLayerId",void 0),r([Je({constructOnly:!0})],Kpt.prototype,"dirtyAreasLayerUrl",void 0),r([Je({constructOnly:!0})],Kpt.prototype,"associationsTableId",void 0),r([Je({constructOnly:!0})],Kpt.prototype,"associationsTableUrl",void 0),Kpt=r([ln("esri.networks.support.NetworkSystemLayers")],Kpt);const Qpt=Kpt;let Xpt=class extends Io{constructor(t){super(t),this.id=null,this.name=null}};r([Je({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],Xpt.prototype,"id",void 0),r([Je({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],Xpt.prototype,"name",void 0),r([Je({type:Boolean,json:{write:!0}})],Xpt.prototype,"isUpstreamTerminal",void 0),Xpt=r([ln("esri.networks.support.Terminal")],Xpt);const tmt=Xpt;const emt=new Co({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let imt=class extends Io{constructor(t){super(t),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};r([Je({type:String,json:{write:!0}})],imt.prototype,"defaultConfiguration",void 0),r([Je({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],imt.prototype,"id",void 0),r([Je({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],imt.prototype,"name",void 0),r([Je({type:[tmt],json:{write:!0}})],imt.prototype,"terminals",void 0),r([Je({type:emt.apiValues,json:{type:emt.jsonValues,read:emt.read,write:emt.write}})],imt.prototype,"traversabilityModel",void 0),imt=r([ln("esri.networks.support.TerminalConfiguration")],imt);const nmt=imt;let smt=class extends Io{constructor(t){super(t),this.line=null,this.multipoint=null,this.polygon=null}};r([Je({type:Kp,json:{write:!0},readOnly:!0})],smt.prototype,"line",void 0),r([Je({type:Dd,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],smt.prototype,"multipoint",void 0),r([Je({type:qp,json:{write:!0},readOnly:!0})],smt.prototype,"polygon",void 0),smt=r([ln("esri.rest.networks.support.AggregatedGeometry")],smt);const rmt=smt;let omt=class extends Io{constructor(t){super(t),this.functionType=null,this.networkAttributeName=null,this.result=null}};r([Je({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],omt.prototype,"functionType",void 0),r([Je({type:String,json:{write:!0},readOnly:!0})],omt.prototype,"networkAttributeName",void 0),r([Je({type:Number,json:{write:!0},readOnly:!0})],omt.prototype,"result",void 0),omt=r([ln("esri.rest.networks.support.FunctionResult")],omt);const amt=omt;let lmt=class extends Io{constructor(t){super(t),this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}};r([Je({type:Number,json:{write:!0}})],lmt.prototype,"assetGroupCode",void 0),r([Je({type:Number,json:{write:!0}})],lmt.prototype,"assetTypeCode",void 0),r([Je({type:String,json:{write:!0}})],lmt.prototype,"globalId",void 0),r([Je({type:Number,json:{write:!0}})],lmt.prototype,"networkSourceId",void 0),r([Je({type:Number,json:{write:!0}})],lmt.prototype,"objectId",void 0),r([Je({type:Number,json:{write:!0}})],lmt.prototype,"positionFrom",void 0),r([Je({type:Number,json:{write:!0}})],lmt.prototype,"positionTo",void 0),r([Je({type:Number,json:{write:!0}})],lmt.prototype,"terminalId",void 0),lmt=r([ln("esri.rest.networks.support.NetworkElement")],lmt);const umt=lmt;let cmt=class extends Io{constructor(t){super(t),this.aggregatedGeometry=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.startingPointsIgnored=!1,this.warnings=null}};r([Je({type:rmt,json:{write:!0},readOnly:!0})],cmt.prototype,"aggregatedGeometry",void 0),r([Je({type:[umt],json:{write:!0},readOnly:!0})],cmt.prototype,"elements",void 0),r([Je({type:[amt],json:{write:!0},readOnly:!0})],cmt.prototype,"globalFunctionResults",void 0),r([Je({type:Boolean,json:{write:!0},readOnly:!0})],cmt.prototype,"kFeaturesForKNNFound",void 0),r([Je({type:Boolean,json:{write:!0},readOnly:!0})],cmt.prototype,"startingPointsIgnored",void 0),r([Je({type:[String],json:{write:!0},readOnly:!0})],cmt.prototype,"warnings",void 0),cmt=r([ln("esri.rest.networks.support.TraceResult")],cmt);const hmt=cmt;const dmt=Oo()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let fmt=class extends hmt{constructor(t){super(t),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(t){const e={...t,query:{f:"json"}},{data:i}=await Pl(this.statusUrl,e),n=i.traceResults?{...i.traceResults,...i}:i;return this.read(n),this}async waitForJobCompletion(t={}){const{interval:e=1e3,statusCallback:i}=t;return new Promise(((t,n)=>{this._clearTimer();const s=setInterval((()=>{this._timer||n(Ss()),this.checkJobStatus().then((e=>{const{status:n}=e;switch(this.status=n,n){case"job-succeeded":this._clearTimer(),t(this);break;case"job-waiting":case"job-executing":i&&i(this)}}),(t=>{this._clearTimer(),n(t)}))}),e);this._timer=s}))}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};r([Je({type:String,json:{write:!0}})],fmt.prototype,"statusUrl",void 0),r([NA(dmt)],fmt.prototype,"status",void 0),r([Je({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.submissionTime=t?t.getTime():null}}}})],fmt.prototype,"submissionTime",void 0),r([Je({type:Date,json:{type:Number,write:{writer:(t,e)=>{e.lastUpdatedTime=t?t.getTime():null}}}})],fmt.prototype,"lastUpdatedTime",void 0),fmt=r([ln("esri.networks.support.TraceJobInfo")],fmt);const pmt=fmt;let mmt=class extends Npt{constructor(t){super(t),this.sharedNamedTraceConfigurations=[],this.type="utility",this._terminalById=new Map}get serviceTerritoryFeatureLayerId(){return this.dataElement?.serviceTerritoryFeatureLayerId??null}get networkSystemLayers(){return new Qpt({rulesTableId:this.sourceJSON?.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.rulesTableId}`:null,subnetworksTableId:this.sourceJSON?.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:this.sourceJSON?.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:this.sourceJSON?.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){return this.dataElement?.terminalConfigurations.map((t=>nmt.fromJSON(t)))||[]}get domainNetworkNames(){return this.dataElement?.domainNetworks.map((t=>t.domainNetworkName))||[]}get _utilityLayerList(){const t=new Set;return this.dataElement?.domainNetworks?.map((e=>{e.edgeSources.map((e=>{t.add(e.layerId)})),e.junctionSources.map((e=>{t.add(e.layerId)}))})),t}async load(t){return this.addResolvingPromise(super.load(t)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(t)),this}getTerminalConfiguration(t){let e=null,i=null;const n=t.layer;let s=null;if("feature"===n?.type){if(s=n.layerId,null===s)return null}else{if("subtype-sublayer"!==n?.type)return null;if(s=n?.parent?.layerId??null,null===s)return null}const r=t.attributes;if(null==r)return null;for(const n of Object.keys(r))"ASSETGROUP"===n.toUpperCase()&&(e=t.getAttribute(n)),"ASSETTYPE"===n.toUpperCase()&&(i=t.getAttribute(n));if(!this.dataElement)return null;let o=null;const a=this.dataElement.domainNetworks;for(const t of a){const n=t.junctionSources?.find((t=>t.layerId===s));if(n){const t=n.assetGroups?.find((t=>t.assetGroupCode===e));if(t){const e=t.assetTypes?.find((t=>t.assetTypeCode===i));if(e){o=e.terminalConfigurationId;break}}}}if(null!=o){const t=this.dataElement.terminalConfigurations,e=t?.find((t=>t.terminalConfigurationId===o));return e?nmt.fromJSON(e):null}return null}getTierNames(t){const e=this.dataElement?.domainNetworks.find((e=>e.domainNetworkName===t));return e?.tiers.map((t=>t.name))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}getTerminalById(t){if(!this.dataElement||null==t)return null;const e=this._terminalById.get(t);return null!=e?e:(this.terminalConfigurations.forEach((t=>{t.terminals.forEach((t=>{this._terminalById.set(t.id,t)}))})),this._terminalById.get(t))}isUtilityLayer(t){return"layerId"in t&&(this._utilityLayerList.has(t.layerId)&&(t.url?.startsWith(this.featureServiceUrl)??!1))}async queryAssociations(t){const[{queryAssociations:e},{default:i}]=await Promise.all([import("./p-a1a56386.js"),import("./p-01a9b5b3.js")]),n=i.from(t);n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment;return(await e(this.networkServiceUrl,n)).associations}async synthesizeAssociationGeometries(t){const[{synthesizeAssociationGeometries:e},{default:i}]=await Promise.all([import("./p-fa19e967.js"),import("./p-40872d08.js")]),n=i.from(t);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,e(this.networkServiceUrl,n)}async trace(t){const[{trace:e},{default:i}]=await Promise.all([import("./p-b363a7e3.js"),import("./p-4ebdd836.js")]),n=i.from(t);return n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment,e(this.networkServiceUrl,n)}async submitTraceJob(t){const[{submitTraceJob:e},{default:i}]=await Promise.all([import("./p-b363a7e3.js"),import("./p-4ebdd836.js")]),n=i.from(t);n.gdbVersion=this.gdbVersion,n.moment=this.historicMoment;const s=await e(this.networkServiceUrl,n);return new pmt({statusUrl:s})}async canAddAssociation(t){const e=await this.getRulesTable();if(!e)return!1;await e.load();const i=(t,e)=>t?1===t.terminalId?!e?.terminalId||e?.terminalId===t.terminalId:t.terminalId===e?.terminalId:!e?.terminalId,n=(t,e)=>t.fromNetworkSource?.sourceId===e.fromNetworkElement?.networkSourceId&&t.toNetworkSource?.sourceId===e.toNetworkElement?.networkSourceId&&t.fromAssetGroup?.assetGroupCode===e.fromNetworkElement?.assetGroupCode&&t.fromAssetType?.assetTypeCode===e.fromNetworkElement?.assetTypeCode&&t.toAssetGroup?.assetGroupCode===e.toNetworkElement?.assetGroupCode&&t.toAssetType?.assetTypeCode===e.toNetworkElement?.assetTypeCode&&i(t.fromTerminal,e.fromNetworkElement)&&i(t.toTerminal,e.toNetworkElement);if("containment"===t.associationType){return e.rulesCategorized.containment.some((e=>n(e,t)))}if("attachment"===t.associationType){return e.rulesCategorized.attachment.some((e=>n(e,t)))}return e.rulesCategorized.connectivity.some((e=>e.viaNetworkSource?e.fromNetworkSource?.sourceId===t.fromNetworkElement?.networkSourceId&&e.viaNetworkSource?.sourceId===t.toNetworkElement?.networkSourceId&&e.fromAssetGroup?.assetGroupCode===t.fromNetworkElement?.assetGroupCode&&e.fromAssetType?.assetTypeCode===t.fromNetworkElement?.assetTypeCode&&e.viaAssetGroup?.assetGroupCode===t.toNetworkElement?.assetGroupCode&&e.viaAssetType?.assetTypeCode===t.toNetworkElement?.assetTypeCode&&i(e.fromTerminal,t.fromNetworkElement)&&i(e.viaTerminal,t.toNetworkElement)||e.viaNetworkSource?.sourceId===t.fromNetworkElement?.networkSourceId&&e.toNetworkSource?.sourceId===t.toNetworkElement?.networkSourceId&&e.viaAssetGroup?.assetGroupCode===t.fromNetworkElement?.assetGroupCode&&e.viaAssetType?.assetTypeCode===t.fromNetworkElement?.assetTypeCode&&e.toAssetGroup?.assetGroupCode===t.toNetworkElement?.assetGroupCode&&e.toAssetType?.assetTypeCode===t.toNetworkElement?.assetTypeCode&&i(e.viaTerminal,t.fromNetworkElement)&&i(e.toTerminal,t.toNetworkElement):n(e,t)))}generateAddAssociations(t){return{addFeatures:t.map((t=>new OD({attributes:{fromnetworksourceid:t.fromNetworkElement?.networkSourceId,fromglobalid:t.fromNetworkElement?.globalId,fromterminalid:t.fromNetworkElement?.terminalId,tonetworksourceid:t.toNetworkElement?.networkSourceId,toglobalid:t.toNetworkElement?.globalId,toterminalid:t.toNetworkElement?.terminalId,associationtype:$pt[t.associationType],iscontentvisible:t.isContentVisible?1:0,percentalong:t.percentAlong,globalid:t.globalId}}))),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}generateDeleteAssociations(t){return{deleteFeatures:t.map((t=>({globalId:t.globalId}))),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:"globalid",objectIdField:"objectid"}}}async _loadNamedTraceConfigurationsFromNetwork(t){if(0===this.sharedNamedTraceConfigurations?.length)return;const e=this.sharedNamedTraceConfigurations.map((t=>t.globalId)),i=await this.queryNamedTraceConfigurations({globalIds:e},t);for(const t of this.sharedNamedTraceConfigurations){const e=i?.find((e=>e.globalId===t.globalId));if(e){const i=e.write({},{origin:"service"});t.read(i,{origin:"service"})}}}async _createRulesTable(){const t=this.networkSystemLayers.rulesTableUrl,e=new Mpt({url:t});await e.load();const i=this.dataElement?.domainNetworks;if(!i)return null;const n=i.flatMap((t=>[...t.edgeSources||[],...t.junctionSources||[]])),s=(await ymt(e)).map((t=>this._hydrateRuleInfo(e,n,t)));return new Vpt({layer:e,rules:s})}_hydrateRuleInfo(t,e,i){const n=t.fieldsIndex,s=n.get("RULETYPE"),r=n.get("CREATIONDATE"),o=n.get("FROMNETWORKSOURCEID"),a=n.get("FROMASSETGROUP"),l=n.get("FROMASSETTYPE"),u=n.get("FROMTERMINALID"),c=n.get("TONETWORKSOURCEID"),h=n.get("TOASSETGROUP"),d=n.get("TOASSETTYPE"),f=n.get("TOTERMINALID"),p=n.get("VIANETWORKSOURCEID"),m=n.get("VIAASSETGROUP"),y=n.get("VIAASSETTYPE"),g=n.get("VIATERMINALID"),v=i.attributes[s.name],w=new Date(i.attributes[r.name]),b=[{networkSourceId:i.attributes[o.name],assetGroupId:i.attributes[a.name],assetTypeId:i.attributes[l.name],terminalId:i.attributes[u.name]},{networkSourceId:i.attributes[c.name],assetGroupId:i.attributes[h.name],assetTypeId:i.attributes[d.name],terminalId:i.attributes[f.name]},{networkSourceId:i.attributes[p.name],assetGroupId:i.attributes[m.name],assetTypeId:i.attributes[y.name],terminalId:i.attributes[g.name]}];let S;!function(t){t[t.from=0]="from",t[t.to=1]="to",t[t.via=2]="via"}(S||(S={}));const _={ruleType:v,creationDate:w};for(const t of[S.from,S.to,S.via]){if(v!==Ppt.RTEdgeJunctionEdgeConnectivity&&t===S.via)continue;const i=b[t],n=e.find((t=>t.sourceId===i.networkSourceId)),s=n?.assetGroups.find((t=>t.assetGroupCode===i.assetGroupId)),r=s?.assetTypes.find((t=>t.assetTypeCode===i.assetTypeId)),o=this._getTerminal(r,i);let a="";switch(t){case S.from:a="from";break;case S.to:a="to";break;case S.via:a="via"}_[`${a}NetworkSource`]=n,_[`${a}AssetGroup`]=s,_[`${a}AssetType`]=r,_[`${a}Terminal`]=o?.toJSON()}return _}_getTerminal(t,e){const i=t?.terminalConfigurationId,n=this.terminalConfigurations?.find((t=>t.id===i));return n?.terminals?.find((t=>t.id===e.terminalId))??null}};async function ymt(t){const e=new V$({where:"1=1",outFields:["*"]});return(await vct(t,e)).features}r([Je({type:[Ypt],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],mmt.prototype,"sharedNamedTraceConfigurations",void 0),r([Je({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],mmt.prototype,"type",void 0),r([Je({readOnly:!0})],mmt.prototype,"serviceTerritoryFeatureLayerId",null),r([Je({readOnly:!0})],mmt.prototype,"networkSystemLayers",null),r([Je({readOnly:!0})],mmt.prototype,"terminalConfigurations",null),r([Je({readOnly:!0})],mmt.prototype,"domainNetworkNames",null),mmt=r([ln("esri.networks.UtilityNetwork")],mmt);const gmt=mmt;const vmt=Object.freeze({__proto__:null,default:gmt});let wmt=class extends(cm(Io)){constructor(t){super(t),this.expression=null,this.returnType="string",this.title=null}};r([Je({type:String,json:{write:{isRequired:!0}}})],wmt.prototype,"expression",void 0),r([Je({type:["number","string"],json:{write:!0}})],wmt.prototype,"returnType",void 0),r([Je({type:String,json:{write:!0}})],wmt.prototype,"title",void 0),wmt=r([ln("esri.webdoc.geotriggersInfo.ExpressionInfo")],wmt);const bmt=wmt;const Smt=new Co({deviceLocation:"device-location"});let _mt=class extends(cm(Io)){constructor(t){super(t),this.filterExpression=null,this.type="device-location"}};r([Je({type:bmt,json:{write:!0}})],_mt.prototype,"filterExpression",void 0),r([Je({type:Smt.apiValues,readOnly:!0,json:{type:Smt.jsonValues,read:Smt.read,write:Smt.write}})],_mt.prototype,"type",void 0),_mt=r([ln("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],_mt);const xmt=_mt;let Mmt=class extends(cm(Io)){constructor(t){super(t),this.geometry=null,this.where=null}};r([Je({types:um,json:{read:rm,write:!0}})],Mmt.prototype,"geometry",void 0),r([Je({type:String,json:{write:!0}})],Mmt.prototype,"where",void 0),Mmt=r([ln("esri.webdoc.geotriggersInfo.FeatureFilter")],Mmt);const Tmt=Mmt;let Amt=class extends(cm(Io)){constructor(t){super(t),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};r([Je({type:String,json:{write:{overridePolicy(){return{isRequired:null===this.layerUrl}}}}})],Amt.prototype,"layerId",void 0),r([Je({type:String,json:{write:{overridePolicy(){return{isRequired:null===this.layerId}}}}})],Amt.prototype,"layerUrl",void 0),r([NA({featureLayer:"feature-layer"},{readOnly:!0})],Amt.prototype,"type",void 0),Amt=r([ln("esri.webdoc.geotriggersInfo.FeatureLayerSource")],Amt);const Imt=Amt;let kmt=class extends(cm(Io)){constructor(t){super(t),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};r([Je({type:Imt,json:{write:{isRequired:!0}}})],kmt.prototype,"fenceSource",void 0),r([Je({type:Tmt,json:{write:!0}})],kmt.prototype,"filter",void 0),r([Je({type:Number,json:{write:!0}})],kmt.prototype,"bufferDistance",void 0),r([NA({features:"features"},{readOnly:!0})],kmt.prototype,"type",void 0),kmt=r([ln("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],kmt);const Cmt=kmt;let Emt=class extends(cm(Io)){constructor(t){super(t),this.type="fence"}};r([NA({fence:"fence"},{readOnly:!0})],Emt.prototype,"type",void 0),Emt=r([ln("esri.webdoc.geotriggersInfo.Geotrigger")],Emt);const jmt=Emt;let Omt=class extends(cm(Io)){constructor(t){super(t),this.expressionInfo=null,this.requestedActions=null}};r([Je({type:bmt,json:{write:!0}})],Omt.prototype,"expressionInfo",void 0),r([Je({type:[String],json:{write:!0}})],Omt.prototype,"requestedActions",void 0),Omt=r([ln("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],Omt);const Rmt=Omt;const Lmt=new Co({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),Nmt=new Co({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),Pmt=new Co({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});let Fmt=class extends jmt{constructor(t){super(t),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};r([NA(Lmt)],Fmt.prototype,"enterExitRule",void 0),r([Je({type:xmt,json:{write:{isRequired:!0}}})],Fmt.prototype,"feed",void 0),r([NA(Nmt)],Fmt.prototype,"feedAccuracyMode",void 0),r([Je({type:Pmt.apiValues,json:{type:Pmt.jsonValues,read:Pmt.read,write:{writer:Pmt.write,isRequired:!0}}})],Fmt.prototype,"fenceNotificationRule",void 0),r([Je({type:Cmt,json:{write:{isRequired:!0}}})],Fmt.prototype,"fenceParameters",void 0),r([Je({type:String,json:{write:!0}})],Fmt.prototype,"name",void 0),r([Je({type:Rmt,json:{write:!0}})],Fmt.prototype,"notificationOptions",void 0),r([NA({fence:"fence"},{readOnly:!0})],Fmt.prototype,"type",void 0),Fmt=r([ln("esri.webdoc.geotriggersInfo.FenceGeotrigger")],Fmt);const Dmt=Fmt;const $mt={base:jmt,key:"type",typeMap:{fence:Dmt}};let zmt=class extends(cm(Io)){constructor(t){super(t),this.geotriggers=null}};r([Je({types:[$mt],json:{write:{isRequired:!0}}})],zmt.prototype,"geotriggers",void 0),zmt=r([ln("esri.webdoc.GeotriggersInfo")],zmt);const Umt=zmt;let Bmt=class extends(cm(Io)){constructor(t){super(t),this.portalItem=null}readPortalItem(t,e,i){const{itemId:n}=e;if(n)return new NT({id:n,portal:i?.portal})}writePortalItem(t,e){t?.id&&(e.itemId=t.id)}};r([Je({type:NT,json:{write:{isRequired:!0}}})],Bmt.prototype,"portalItem",void 0),r([ko("portalItem",["itemId"])],Bmt.prototype,"readPortalItem",null),r([yh("portalItem",{itemId:{type:String}})],Bmt.prototype,"writePortalItem",null),Bmt=r([ln("esri.webdoc.ips.PositioningService")],Bmt);const Gmt=Bmt;let Vmt=class extends(cm(Io)){constructor(t){super(t),this.positioningService=null}};r([Je({type:Gmt,json:{write:{isRequired:!0}}})],Vmt.prototype,"positioningService",void 0),Vmt=r([ln("esri.webdoc.IPSInfo")],Vmt);const qmt=Vmt;const Hmt={currentVersion:k5,createInitialViewProperties:()=>new C6,parseVersion:A5.parse,itemType:"Web Map",name:"webmap",origin:"web-map"},Wmt=Vm.ofType(gmt);let Zmt=class extends N6{constructor(t){super(t),this.geotriggersInfo=null,this.ipsInfo=null,this.presentation=null,this.utilityNetworks=null}destroy(){if(this.utilityNetworks){const t=this.utilityNetworks.removeAll();for(const e of t)e.destroy();this.utilityNetworks.destroy()}}get context(){return Hmt}loadAll(){return zM(this,(t=>{t(this.ground,this.basemap,this.layers,this.tables,this.ipsInfo?.positioningService?.portalItem)}))}static fromJSON(t){if(t)return new this({resourceInfo:t});throw new Ve("webmap:empty-resource","Expected a JSON resource but got nothing")}};Zmt.VERSION=k5,r([Je({type:Umt,json:{write:!0}})],Zmt.prototype,"geotriggersInfo",void 0),r([Je({type:qmt,json:{write:!0,name:"mapIPSInfo"}})],Zmt.prototype,"ipsInfo",void 0),r([Je({json:{write:!0}})],Zmt.prototype,"presentation",void 0),r([Je({type:Wmt,json:{read:!0,write:!0}})],Zmt.prototype,"utilityNetworks",void 0),Zmt=r([ln("esri.WebMap")],Zmt);const Jmt=Zmt;const Ymt={type:String,json:{read:{source:"token"},write:{target:"token"}}};const Kmt={esriCentimeters:"centimeters",esriDecimalDegrees:"decimal-degrees",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriPoints:"points",esriUnknownUnits:"unknown",esriYards:"yards"},Qmt=Oo()(Kmt);Oo()({...Kmt,esriIntFeet:"international-feet",esriIntInches:"international-inches",esriIntMiles:"international-miles",esriIntNauticalMiles:"international-nautical-miles",esriIntYards:"international-yards"});Oo()({esriAcres:"international-acres",esriAcresUS:"us-acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-international-feet",esriSquareFeetUS:"square-us-feet",esriSquareInches:"square-international-inches",esriSquareInchesUS:"square-us-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-international-miles",esriSquareMilesUS:"square-us-miles",esriSquareMillimeters:"square-millimeters",esriSquareYards:"square-international-yards",esriSquareYardsUS:"square-us-yards",esriUnknownAreaUnits:"unknown"});const Xmt=Oo()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards"});Oo()({esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds"});const tyt=Oo()({esriNAUCentimeters:"centimeters",esriNAUDecimalDegrees:"decimal-degrees",esriNAUDecimeters:"decimeters",esriNAUFeet:"feet",esriNAUInches:"inches",esriNAUKilometers:"kilometers",esriNAUMeters:"meters",esriNAUMiles:"miles",esriNAUMillimeters:"millimeters",esriNAUNauticalMiles:"nautical-miles",esriNAUPoints:"points",esriNAUYards:"yards",esriNAUDays:"days",esriNAUHours:"hours",esriNAUMinutes:"minutes",esriNAUSeconds:"seconds",esriNAUKilometersPerHour:"kilometers-per-hour",esriNAUMilesPerHour:"miles-per-hour",esriNAUUnknown:"unknown"}),eyt=Oo()({esriDOTComplete:"complete",esriDOTCompleteNoEvents:"complete-no-events",esriDOTFeatureSets:"featuresets",esriDOTInstructionsOnly:"instructions-only",esriDOTStandard:"standard",esriDOTSummaryOnly:"summary-only"}),iyt=Oo()({esriNAOutputLineNone:"none",esriNAOutputLineStraight:"straight",esriNAOutputLineTrueShape:"true-shape",esriNAOutputLineTrueShapeWithMeasure:"true-shape-with-measure"}),nyt=Oo()({esriNAOutputPolygonNone:"none",esriNAOutputPolygonSimplified:"simplified",esriNAOutputPolygonDetailed:"detailed"}),syt=Oo()({esriNFSBAllowBacktrack:"allow-backtrack",esriNFSBAtDeadEndsOnly:"at-dead-ends-only",esriNFSBNoBacktrack:"no-backtrack",esriNFSBAtDeadEndsAndIntersections:"at-dead-ends-and-intersections"}),ryt=Oo()({esriNATravelDirectionFromFacility:"from-facility",esriNATravelDirectionToFacility:"to-facility"});Oo()({esriNATimeOfDayNotUsed:"not-used",esriNATimeOfDayUseAsStartTime:"start",esriNATimeOfDayUseAsEndTime:"end"});const oyt=Oo()({AUTOMOBILE:"automobile",TRUCK:"truck",WALK:"walk",OTHER:"other"}),ayt=Oo()({0:"either-side-of-vehicle",1:"right-side-of-vehicle",2:"left-side-of-vehicle",3:"no-u-turn"},{useNumericKeys:!0}),lyt=Oo()({0:"stop",1:"waypoint",2:"break"},{useNumericKeys:!0}),uyt=Oo()({0:"ok",1:"not-located",2:"network-element-not-located",3:"element-not-traversable",4:"invalid-field-values",5:"not-reached",6:"time-window-violation",7:"not-located-on-closest"},{useNumericKeys:!0}),cyt=Oo()({1:"right",2:"left"},{useNumericKeys:!0}),hyt=Oo()({0:"restriction",1:"scaled-cost",2:"added-cost"},{useNumericKeys:!0}),dyt=Oo()({0:"permit",1:"restrict"},{useNumericKeys:!0}),fyt=Oo()({1:"header",50:"arrive",51:"depart",52:"straight",100:"on-ferry",101:"off-ferry",102:"central-fork",103:"roundabout",104:"u-turn",150:"door",151:"stairs",152:"elevator",153:"escalator",154:"pedestrian-ramp",200:"left-fork",201:"left-ramp",202:"clockwise-roundabout",203:"left-handed-u-turn",204:"bear-left",205:"left-turn",206:"sharp-left",207:"left-turn-and-immediate-left-turn",208:"left-turn-and-immediate-right-turn",300:"right-fork",301:"right-ramp",302:"counter-clockwise-roundabout",303:"right-handed-u-turn",304:"bear-right",305:"right-turn",306:"sharp-right",307:"right-turn-and-immediate-left-turn",308:"right-turn-and-immediate-right-turn",400:"up-elevator",401:"up-escalator",402:"up-stairs",500:"down-elevator",501:"down-escalator",502:"down-stairs",1e3:"general-event",1001:"landmark",1002:"time-zone-change",1003:"traffic-event",1004:"scaled-cost-barrier-event",1005:"boundary-crossing",1006:"restriction-violation",1007:"lane"},{useNumericKeys:!0}),pyt=Oo()({0:"unknown",1:"segment",2:"maneuver-segment",3:"restriction-violation",4:"scaled-cost-barrier",5:"heavy-traffic",6:"slow-traffic",7:"moderate-traffic"},{useNumericKeys:!0}),myt=Oo()({"NA Campus":"campus","NA Desktop":"desktop","NA Navigation":"navigation"}),yyt=Oo()({Kilometers:"kilometers",Miles:"miles",Meters:"meters"},{ignoreUnknown:!1}),gyt=Oo()({Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),vyt=Oo()({Kilometers:"kilometers",Miles:"miles",Meters:"meters",Minutes:"minutes",TimeAt1KPH:"time-at-1-kph",TravelTime:"travel-time",TruckMinutes:"truck-minutes",TruckTravelTime:"truck-travel-time",WalkTime:"walk-time"},{ignoreUnknown:!1}),wyt=Oo()({"Any Hazmat Prohibited":"any-hazmat-prohibited","Avoid Carpool Roads":"avoid-carpool-roads","Avoid Express Lanes":"avoid-express-lanes","Avoid Ferries":"avoid-ferries","Avoid Gates":"avoid-gates","Avoid Limited Access Roads":"avoid-limited-access-roads","Avoid Private Roads":"avoid-private-roads","Avoid Roads Unsuitable for Pedestrians":"avoid-roads-unsuitable-for-pedestrians","Avoid Stairways":"avoid-stairways","Avoid Toll Roads":"avoid-toll-roads","Avoid Toll Roads for Trucks":"avoid-toll-roads-for-trucks","Avoid Truck Restricted Roads":"avoid-truck-restricted-roads","Avoid Unpaved Roads":"avoid-unpaved-roads","Axle Count Restriction":"axle-count-restriction","Driving a Bus":"driving-a-bus","Driving a Taxi":"driving-a-taxi","Driving a Truck":"driving-a-truck","Driving an Automobile":"driving-an-automobile","Driving an Emergency Vehicle":"driving-an-emergency-vehicle","Height Restriction":"height-restriction","Kingpin to Rear Axle Length Restriction":"kingpin-to-rear-axle-length-restriction","Length Restriction":"length-restriction","Preferred for Pedestrians":"preferred-for-pedestrians","Riding a Motorcycle":"riding-a-motorcycle","Roads Under Construction Prohibited":"roads-under-construction-prohibited","Semi or Tractor with One or More Trailers Prohibited":"semi-or-tractor-with-one-or-more-trailers-prohibited","Single Axle Vehicles Prohibited":"single-axle-vehicles-prohibited","Tandem Axle Vehicles Prohibited":"tandem-axle-vehicles-prohibited","Through Traffic Prohibited":"through-traffic-prohibited","Truck with Trailers Restriction":"truck-with-trailers-restriction","Use Preferred Hazmat Routes":"use-preferred-hazmat-routes","Use Preferred Truck Routes":"use-preferred-truck-routes",Walking:"walking","Weight Restriction":"weight-restriction"},{ignoreUnknown:!1}),byt=Oo()({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),Syt=Oo()({esriGeometryPoint:"point",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"envelope",esriGeometryMultipoint:"multipoint"}),_yt=Oo()({esriNAUTCost:"cost",esriNAUTDescriptor:"descriptor",esriNAUTRestriction:"restriction",esriNAUTHierarchy:"hierarchy"}),xyt=Oo()({esriDSTAltName:"alt-name",esriDSTArrive:"arrive",esriDSTBranch:"branch",esriDSTCrossStreet:"cross-street",esriDSTCumulativeLength:"cumulative-length",esriDSTDepart:"depart",esriDSTEstimatedArrivalTime:"estimated-arrival-time",esriDSTExit:"exit",esriDSTGeneral:"general",esriDSTLength:"length",esriDSTServiceTime:"service-time",esriDSTStreetName:"street-name",esriDSTSummary:"summary",esriDSTTime:"time",esriDSTTimeWindow:"time-window",esriDSTToward:"toward",esriDSTViolationTime:"violation-time",esriDSTWaitTime:"wait-time"});let Myt=class extends(cm(Io)){constructor(t){super(t),this.attributeParameterValues=null,this.description=null,this.distanceAttributeName=null,this.id=null,this.impedanceAttributeName=null,this.name=null,this.restrictionAttributeNames=null,this.simplificationTolerance=null,this.simplificationToleranceUnits=null,this.timeAttributeName=null,this.type=null,this.useHierarchy=null,this.uturnAtJunctions=null}readId(t,e){return e.id??e.itemId??null}readRestrictionAttributes(t,e){const{restrictionAttributeNames:i}=e;return null==i?null:i.map((t=>wyt.fromJSON(t)))}writeRestrictionAttributes(t,e,i){null!=t&&(e[i]=t.map((t=>wyt.toJSON(t))))}};r([Je({type:[Object],json:{write:!0}})],Myt.prototype,"attributeParameterValues",void 0),r([Je({type:String,json:{write:!0}})],Myt.prototype,"description",void 0),r([NA(yyt,{ignoreUnknown:!1})],Myt.prototype,"distanceAttributeName",void 0),r([Je({type:String,json:{write:!0}})],Myt.prototype,"id",void 0),r([ko("id",["id","itemId"])],Myt.prototype,"readId",null),r([NA(vyt,{ignoreUnknown:!1})],Myt.prototype,"impedanceAttributeName",void 0),r([Je({type:String,json:{write:!0}})],Myt.prototype,"name",void 0),r([Je({type:[String],json:{write:!0}})],Myt.prototype,"restrictionAttributeNames",void 0),r([ko("restrictionAttributeNames")],Myt.prototype,"readRestrictionAttributes",null),r([yh("restrictionAttributeNames")],Myt.prototype,"writeRestrictionAttributes",null),r([Je({type:Number,json:{write:{allowNull:!0}}})],Myt.prototype,"simplificationTolerance",void 0),r([NA(Qmt)],Myt.prototype,"simplificationToleranceUnits",void 0),r([NA(gyt,{ignoreUnknown:!1})],Myt.prototype,"timeAttributeName",void 0),r([NA(oyt)],Myt.prototype,"type",void 0),r([Je({type:Boolean,json:{write:!0}})],Myt.prototype,"useHierarchy",void 0),r([NA(syt)],Myt.prototype,"uturnAtJunctions",void 0),Myt=r([ln("esri.rest.support.TravelMode")],Myt);const Tyt=Myt;var Ayt;let Iyt=Ayt=class extends(cm(Io)){constructor(t){super(t),this.accumulateAttributes=null,this.apiKey=null,this.attributeParameterValues=null,this.defaultBreaks=null,this.excludeSourcesFromPolygons=null,this.facilities=null,this.geometryPrecision=null,this.geometryPrecisionM=null,this.geometryPrecisionZ=null,this.ignoreInvalidLocations=null,this.impedanceAttribute=null,this.mergeSimilarPolygonRanges=!1,this.outputGeometryPrecision=null,this.outputGeometryPrecisionUnits=null,this.outputLines=null,this.outputPolygons=null,this.outSpatialReference=null,this.overlapLines=!1,this.overlapPolygons=!1,this.overrides=null,this.pointBarriers=null,this.polygonBarriers=null,this.polylineBarriers=null,this.preserveObjectID=null,this.restrictionAttributes=null,this.restrictUTurns=null,this.returnFacilities=!1,this.returnPointBarriers=!1,this.returnPolygonBarriers=!1,this.returnPolylineBarriers=!1,this.splitLinesAtBreaks=!1,this.splitPolygonsAtBreaks=!1,this.timeOfDay=null,this.timeOfDayIsUTC=null,this.travelDirection=null,this.travelMode=null,this.trimOuterPolygon=!1,this.trimPolygonDistance=null,this.trimPolygonDistanceUnits=null,this.useHierarchy=null}static from(t){return Kt(Ayt,t)}readAccumulateAttributes(t){return null==t?null:t.map((t=>vyt.fromJSON(t)))}writeAccumulateAttributes(t,e,i){t?.length&&(e[i]=t.map((t=>vyt.toJSON(t))))}writeFacilities(t,e,i){Cyt(t,e,i)}writePointBarriers(t,e,i){Cyt(t,e,i)}writePolygonBarrier(t,e,i){Cyt(t,e,i)}writePolylineBarrier(t,e,i){Cyt(t,e,i)}readRestrictionAttributes(t){return null==t?null:t.map((t=>wyt.fromJSON(t)))}writeRestrictionAttributes(t,e,i){t?.length&&(e[i]=t.map((t=>wyt.toJSON(t))))}readTimeOfDay(t,e){const{timeOfDay:i}=e;return null==i?null:"now"===i?"now":new Date(i)}writeTimeOfDay(t,e){null!=t&&(e.timeOfDay="now"===t?"now":t.getTime())}};r([Je({type:[String],json:{name:"accumulateAttributeNames",write:!0}})],Iyt.prototype,"accumulateAttributes",void 0),r([ko("accumulateAttributes")],Iyt.prototype,"readAccumulateAttributes",null),r([yh("accumulateAttributes")],Iyt.prototype,"writeAccumulateAttributes",null),r([Je(Ymt)],Iyt.prototype,"apiKey",void 0),r([Je({json:{write:!0}})],Iyt.prototype,"attributeParameterValues",void 0),r([Je({type:[Number],json:{write:!0}})],Iyt.prototype,"defaultBreaks",void 0),r([Je({type:[String],json:{write:!0}})],Iyt.prototype,"excludeSourcesFromPolygons",void 0),r([Je({json:{write:!0}})],Iyt.prototype,"facilities",void 0),r([yh("facilities")],Iyt.prototype,"writeFacilities",null),r([Je({type:Number,json:{write:!0}})],Iyt.prototype,"geometryPrecision",void 0),r([Je({type:Number,json:{write:!0}})],Iyt.prototype,"geometryPrecisionM",void 0),r([Je({type:Number,json:{write:!0}})],Iyt.prototype,"geometryPrecisionZ",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"ignoreInvalidLocations",void 0),r([NA(vyt,{name:"impedanceAttributeName",ignoreUnknown:!1})],Iyt.prototype,"impedanceAttribute",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"mergeSimilarPolygonRanges",void 0),r([Je({type:Number,json:{write:!0}})],Iyt.prototype,"outputGeometryPrecision",void 0),r([NA(Qmt)],Iyt.prototype,"outputGeometryPrecisionUnits",void 0),r([NA(iyt)],Iyt.prototype,"outputLines",void 0),r([NA(nyt)],Iyt.prototype,"outputPolygons",void 0),r([Je({type:wh,json:{name:"outSR",write:!0}})],Iyt.prototype,"outSpatialReference",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"overlapLines",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"overlapPolygons",void 0),r([Je({json:{write:!0}})],Iyt.prototype,"overrides",void 0),r([Je({json:{name:"barriers",write:!0}})],Iyt.prototype,"pointBarriers",void 0),r([yh("pointBarriers")],Iyt.prototype,"writePointBarriers",null),r([Je({json:{write:!0}})],Iyt.prototype,"polygonBarriers",void 0),r([yh("polygonBarriers")],Iyt.prototype,"writePolygonBarrier",null),r([Je({json:{write:!0}})],Iyt.prototype,"polylineBarriers",void 0),r([yh("polylineBarriers")],Iyt.prototype,"writePolylineBarrier",null),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"preserveObjectID",void 0),r([Je({type:[String],json:{name:"restrictionAttributeNames",write:!0}})],Iyt.prototype,"restrictionAttributes",void 0),r([ko("restrictionAttributes")],Iyt.prototype,"readRestrictionAttributes",null),r([yh("restrictionAttributes")],Iyt.prototype,"writeRestrictionAttributes",null),r([NA(syt)],Iyt.prototype,"restrictUTurns",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"returnFacilities",void 0),r([Je({type:Boolean,json:{name:"returnBarriers",write:!0}})],Iyt.prototype,"returnPointBarriers",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"returnPolygonBarriers",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"returnPolylineBarriers",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"splitLinesAtBreaks",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"splitPolygonsAtBreaks",void 0),r([Je({json:{write:!0}})],Iyt.prototype,"timeOfDay",void 0),r([ko("timeOfDay")],Iyt.prototype,"readTimeOfDay",null),r([yh("timeOfDay")],Iyt.prototype,"writeTimeOfDay",null),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"timeOfDayIsUTC",void 0),r([NA(ryt)],Iyt.prototype,"travelDirection",void 0),r([Je({type:Tyt,json:{write:!0}})],Iyt.prototype,"travelMode",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"trimOuterPolygon",void 0),r([Je({type:Number,json:{write:!0}})],Iyt.prototype,"trimPolygonDistance",void 0),r([NA(Qmt)],Iyt.prototype,"trimPolygonDistanceUnits",void 0),r([Je({type:Boolean,json:{write:!0}})],Iyt.prototype,"useHierarchy",void 0),Iyt=Ayt=r([ln("esri.rest.support.ServiceAreaParameters")],Iyt);const kyt=Iyt;function Cyt(t,e,i){null!=t&&(e[i]=Vm.isCollection(t)?{features:t.toArray().map((t=>t.toJSON()))}:t.toJSON())}let Eyt=class extends Io{constructor(t){super(t),this.dataType=null,this.name=null,this.parameterNames=null,this.restrictionUsageParameterName=null,this.timeNeutralAttributeName=null,this.trafficSupport=null,this.units=null,this.usageType=null}};r([Je({type:String})],Eyt.prototype,"dataType",void 0),r([NA(vyt,{ignoreUnknown:!1})],Eyt.prototype,"name",void 0),r([Je({type:[String]})],Eyt.prototype,"parameterNames",void 0),r([Je({type:String})],Eyt.prototype,"restrictionUsageParameterName",void 0),r([NA(gyt,{ignoreUnknown:!1})],Eyt.prototype,"timeNeutralAttributeName",void 0),r([Je({type:String})],Eyt.prototype,"trafficSupport",void 0),r([NA(tyt)],Eyt.prototype,"units",void 0),r([NA(_yt)],Eyt.prototype,"usageType",void 0),Eyt=r([ln("esri.rest.support.NetworkAttribute")],Eyt);const jyt=Eyt;let Oyt=class extends Io{constructor(t){super(t),this.buildTime=null,this.name=null,this.networkAttributes=null,this.networkSources=null,this.state=null}};r([Je({type:Number})],Oyt.prototype,"buildTime",void 0),r([Je({type:String})],Oyt.prototype,"name",void 0),r([Je({type:[jyt]})],Oyt.prototype,"networkAttributes",void 0),r([Je()],Oyt.prototype,"networkSources",void 0),r([Je({type:String})],Oyt.prototype,"state",void 0),Oyt=r([ln("esri.rest.support.NetworkDataset")],Oyt);const Ryt=Oyt;let Lyt=class extends Io{constructor(t){super(t),this.accumulateAttributeNames=null,this.attributeParameterValues=null,this.currentVersion=null,this.defaultTravelMode=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsSupportedLanguages=null,this.directionsTimeAttribute=null,this.hasZ=null,this.impedance=null,this.networkDataset=null,this.supportedTravelModes=null}readAccumulateAttributes(t){return null==t?null:t.map((t=>vyt.fromJSON(t)))}writeAccumulateAttributes(t,e,i){t?.length&&(e[i]=t.map((t=>vyt.toJSON(t))))}get capabilities(){return{supportsNow:(this.currentVersion??10)>=10.81}}readDefaultTravelMode(t,e){const i=e.supportedTravelModes?.find((({id:t})=>t===e.defaultTravelMode))??e.supportedTravelModes?.find((({itemId:t})=>t===e.defaultTravelMode));return i?Tyt.fromJSON(i):null}};r([Je()],Lyt.prototype,"accumulateAttributeNames",void 0),r([ko("accumulateAttributeNames")],Lyt.prototype,"readAccumulateAttributes",null),r([yh("accumulateAttributeNames")],Lyt.prototype,"writeAccumulateAttributes",null),r([Je()],Lyt.prototype,"attributeParameterValues",void 0),r([Je()],Lyt.prototype,"capabilities",null),r([Je()],Lyt.prototype,"currentVersion",void 0),r([Je()],Lyt.prototype,"defaultTravelMode",void 0),r([ko("defaultTravelMode",["defaultTravelMode","supportedTravelModes"])],Lyt.prototype,"readDefaultTravelMode",null),r([Je()],Lyt.prototype,"directionsLanguage",void 0),r([NA(Xmt)],Lyt.prototype,"directionsLengthUnits",void 0),r([Je()],Lyt.prototype,"directionsSupportedLanguages",void 0),r([NA(gyt,{ignoreUnknown:!1})],Lyt.prototype,"directionsTimeAttribute",void 0),r([Je()],Lyt.prototype,"hasZ",void 0),r([NA(vyt,{ignoreUnknown:!1})],Lyt.prototype,"impedance",void 0),r([Je({type:Ryt})],Lyt.prototype,"networkDataset",void 0),r([Je({type:[Tyt]})],Lyt.prototype,"supportedTravelModes",void 0),Lyt=r([ln("esri.rest.support.NetworkServiceDescription")],Lyt);const Nyt=Lyt;const Pyt=()=>jt.getLogger("esri.rest.networkService");function Fyt(t,e,i,n){n[i]=[e.length,e.length+t.length],t.forEach((t=>{e.push(t.geometry)}))}function Dyt(t,e){for(let i=0;i<e.length;i++){const n=t[e[i]];if(n&&n.length)for(const t of n)t.z=void 0}Pyt().warnOnce("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")}function $yt(t,e){for(let i=0;i<e.length;i++){const n=t[e[i]];if(n&&n.length)for(const t of n)if(null!=t&&t.hasZ)return!0}return!1}async function zyt(t,e,i){if(!t)throw new Ve("network-service:missing-url","Url to Network service is missing");const n=vG({f:"json",token:e},i),{data:s}=await Pl(t,n),r=s.currentVersion>=10.4?Byt(t,e,i):Uyt(t,i),{defaultTravelMode:o,supportedTravelModes:a}=await r;return s.defaultTravelMode=o,s.supportedTravelModes=a,Nyt.fromJSON(s)}async function Uyt(t,e){const i=vG({f:"json"},e),{data:n}=await Pl(t.replace(/\/rest\/.*$/i,"/info"),i);if(!n?.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};const{owningSystemUrl:s}=n,r=nl(s)+"/sharing/rest/portals/self",{data:o}=await Pl(r,i),a=yt("helperServices.routingUtilities.url",o);if(!a)return{supportedTravelModes:[],defaultTravelMode:null};const l=wG(s),u=/\/solve$/i.test(l.path)?"Route":/\/solveclosestfacility$/i.test(l.path)?"ClosestFacility":"ServiceAreas",c=vG({f:"json",serviceName:u},e),h=nl(a)+"/GetTravelModes/execute",d=await Pl(h,c),f=[];let p=null;if(d?.data?.results?.length){const t=d.data.results;for(const e of t)if("supportedTravelModes"===e.paramName){if(e.value?.features)for(const{attributes:t}of e.value.features)if(t){const e=JSON.parse(t.TravelMode);f.push(e)}}else"defaultTravelMode"===e.paramName&&(p=e.value)}return{supportedTravelModes:f,defaultTravelMode:p}}async function Byt(t,e,i){try{const n=vG({f:"json",token:e},i),s=nl(t)+"/retrieveTravelModes",{data:{supportedTravelModes:r,defaultTravelMode:o}}=await Pl(s,n);return{supportedTravelModes:r,defaultTravelMode:o}}catch(t){throw new Ve("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:t})}}function Gyt(t,e){if(null==t)return null;const i={},n=new RegExp(`^${e}`,"i");for(const s of Object.keys(t))if(n.test(s)){const n=s.slice(e.length);i[vyt.fromJSON(n)]=t[s]}return i}function Vyt(t,e,i){if(null!=t){e.attributes||(e.attributes={});for(const n in t){const s=vyt.toJSON(n);e.attributes[`${i}${s}`]=t[n]}}}function qyt(t){const e={};for(const i of Object.keys(t)){const n=i;e[vyt.fromJSON(n)]=t[i]}return e}function Hyt(t){const e={};for(const i of Object.keys(t)){const n=i;e[vyt.toJSON(n)]=t[i]}return e}function Wyt(t,e){return null==t||null==e?null:Math.round((t-e)/6e4)}function Zyt(t){const e=t.toJSON(),i=e;return i.accumulateAttributeNames&&=e.accumulateAttributeNames?.join(),i.attributeParameterValues&&=JSON.stringify(e.attributeParameterValues),i.barriers&&=JSON.stringify(e.barriers),i.outSR&&=e.outSR?.wkid,i.overrides&&=JSON.stringify(e.overrides),i.polygonBarriers&&=JSON.stringify(e.polygonBarriers),i.polylineBarriers&&=JSON.stringify(e.polylineBarriers),i.restrictionAttributeNames&&=e.restrictionAttributeNames?.join(),i.stops&&=JSON.stringify(e.stops),i.travelMode&&=JSON.stringify(e.travelMode),i}function Jyt(t){const e=t.toJSON(),i=e;return i.accumulateAttributeNames&&=e.accumulateAttributeNames?.join(),i.attributeParameterValues&&=JSON.stringify(e.attributeParameterValues),i.barriers&&=JSON.stringify(e.barriers),i.defaultBreaks&&=e.defaultBreaks?.join(),i.excludeSourcesFromPolygons&&=e.excludeSourcesFromPolygons?.join(),i.facilities&&=JSON.stringify(e.facilities),i.outSR&&=e.outSR?.wkid,i.overrides&&=JSON.stringify(e.overrides),i.polygonBarriers&&=JSON.stringify(e.polygonBarriers),i.polylineBarriers&&=JSON.stringify(e.polylineBarriers),i.restrictionAttributeNames&&=e.restrictionAttributeNames?.join(),i.travelMode&&=JSON.stringify(e.travelMode),i}const Yyt=new Co({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let Kyt=class extends Io{constructor(t){super(t),this.description=null,this.type=null}};r([Je({type:String,json:{write:!0}})],Kyt.prototype,"description",void 0),r([Je({type:String,json:{read:Yyt.read,write:Yyt.write}})],Kyt.prototype,"type",void 0),Kyt=r([ln("esri.rest.support.GPMessage")],Kyt);const Qyt=Kyt;const Xyt=new Co({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});let tgt=class extends Qyt{constructor(t){super(t),this.type=null}};r([Je({type:String,json:{read:Xyt.read,write:Xyt.write}})],tgt.prototype,"type",void 0),tgt=r([ln("esri.rest.support.NAMessage")],tgt);const egt=tgt;let igt=class extends Io{constructor(t){super(t),this.facilities=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.serviceAreaPolylines=null,this.serviceAreaPolygons=null}};r([Je({type:Zat})],igt.prototype,"facilities",void 0),r([Je({type:[egt]})],igt.prototype,"messages",void 0),r([Je({type:Zat,json:{read:{source:"barriers"}}})],igt.prototype,"pointBarriers",void 0),r([Je({type:Zat})],igt.prototype,"polylineBarriers",void 0),r([Je({type:Zat})],igt.prototype,"polygonBarriers",void 0),r([Je({type:Zat,json:{read:{source:"saPolylines"}}})],igt.prototype,"serviceAreaPolylines",void 0),r([Je({type:Zat,json:{read:{source:"saPolygons"}}})],igt.prototype,"serviceAreaPolygons",void 0),igt=r([ln("esri.rest.support.ServiceAreaSolveResult")],igt);const ngt=igt;function sgt(t){return t instanceof Zat}async function rgt(t,e,i){const n=[],s=[],r={},o={},a=wG(t),{path:l}=a;sgt(e.facilities)&&Fyt(e.facilities.features,s,"facilities.features",r),sgt(e.pointBarriers)&&Fyt(e.pointBarriers.features,s,"pointBarriers.features",r),sgt(e.polylineBarriers)&&Fyt(e.polylineBarriers.features,s,"polylineBarriers.features",r),sgt(e.polygonBarriers)&&Fyt(e.polygonBarriers.features,s,"polygonBarriers.features",r);const u=await LG(s);for(const t in r){const e=r[t];n.push(t),o[t]=u.slice(e[0],e[1])}if($yt(o,n)){let t=null;try{t=await zyt(l,e.apiKey,i)}catch{}t&&!t.hasZ&&Dyt(o,n)}for(const t in o)o[t].forEach(((i,n)=>{Ne(e,t)[n].geometry=i}));const c={...i,query:{...a.query,...Jyt(e),f:"json"}},{data:h}=await Pl(`${l}/solveServiceArea`,c);return ngt.fromJSON(h)}const ogt="esri-search",agt={base:ogt,hasMultipleSources:`${ogt}--multiple-sources`,isLoading:`${ogt}--loading`,isSearching:`${ogt}--searching`,showSuggestions:`${ogt}--show-suggestions`,showSources:`${ogt}--sources`,showWarning:`${ogt}--warning`,container:`${ogt}__container`,input:`${ogt}__input`,inputContainer:`${ogt}__input-container`,form:`${ogt}__form`,submitButton:`${ogt}__submit-button`,sourcesButton:`${ogt}__sources-button`,sourcesButtonDown:`${ogt}__sources-button--down`,sourcesButtonUp:`${ogt}__sources-button--up`,clearButton:`${ogt}__clear-button`,sourceName:`${ogt}__source-name`,suggestionsMenu:`${ogt}__suggestions-menu`,suggestionList:`${ogt}__suggestions-list`,suggestionListCurrentLocation:`${ogt}__suggestions-list--current-location`,sourcesMenu:`${ogt}__sources-menu`,source:`${ogt}__source`,warningMenu:`${ogt}__warning-menu`,warningMenuBody:`${ogt}__warning-body`,warningMenuHeader:`${ogt}__warning-header`,warningMenuText:`${ogt}__warning-text`,noValueText:`${ogt}__no-value-text`};const lgt="esri-search-result-renderer",ugt={base:lgt,showMoreResults:`${lgt}__more-results--show-more-results`,moreResults:`${lgt}__more-results`,moreResultsList:`${lgt}__more-results-list`,moreResultsHeader:`${lgt}__more-results-header`,moreResultsItem:`${lgt}__more-results-item`,moreResultsListHeader:`${lgt}__more-results-list-header`};const cgt=96;function hgt(t,e){const i=e||t.extent,n=t.width,s=Yc(i?.spatialReference);return i&&n?i.width/n*s*wc*cgt:0}function dgt(t,e){return t/(Yc(e)*wc*cgt)}function fgt(t,e){const i=t.extent,n=t.width-(t.padding?t.padding.left+t.padding.right:0),s=dgt(e,i.spatialReference);return i.clone().expand(s*n/i.width)}function pgt(t,e,i){return mgt(t,e)&&ygt(t,i)}function mgt(t,e){return 0===e||If(t,e)||t<e}function ygt(t,e){return 0===e||If(t,e)||t>e}function ggt(t){switch(t?.type){case"point":return t;case"extent":return t.center;case"polygon":return t.centroid;case"multipoint":case"polyline":return t.extent?.center;default:return null}}async function vgt(t,e){if(t.hasZ||"2d"===e.type)return t;const i=e.map?.ground;if(!i?.layers.length)return t;const{geometry:n}=await i.queryElevation(t,{cache:e.basemapTerrain?.elevationQueryCache});return n}function wgt(t,e,i){return Sgt(t.center,e,i)}function bgt(t,e,i){switch(t?.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return Sgt(t,e,i);default:return null}}function Sgt(t,e,i){const n=t.hasZ?t.z:void 0;if(e?.map){return(null!=i?fgt(e,i):e.extent).clone().centerAt(t).set({zmax:n,zmin:n})}const{x:s,y:r,spatialReference:o}=t;return new Od({xmin:s-.25,ymin:r-.25,xmax:s+.25,ymax:r+.25,spatialReference:o,zmin:n,zmax:n})}function _gt(t){return t&&"function"==typeof t.highlight}function xgt(t,e,i){return null==t||t>=i&&(0===e||t<=e)}function Mgt(t,e){if(e&&t){const{minScale:i,maxScale:n}=t;if(Tgt(i,n))return xgt(e,i,n)}return!0}function Tgt(t,e){return null!=t&&t>0||null!=e&&e>0}function Agt(t){return!t?.minScale||!t.maxScale||t.minScale>=t.maxScale}let Igt=class extends(dC(Io)){constructor(t){super(t),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};r([Je()],Igt.prototype,"autoNavigate",void 0),r([Je()],Igt.prototype,"filter",void 0),r([Je()],Igt.prototype,"getResults",void 0),r([Je()],Igt.prototype,"getSuggestions",void 0),r([Je()],Igt.prototype,"maxResults",void 0),r([Je()],Igt.prototype,"maxSuggestions",void 0),r([Je()],Igt.prototype,"minSuggestCharacters",void 0),r([Je()],Igt.prototype,"outFields",void 0),r([Je()],Igt.prototype,"placeholder",void 0),r([Je()],Igt.prototype,"popupEnabled",void 0),r([Je()],Igt.prototype,"popupTemplate",void 0),r([Je()],Igt.prototype,"prefix",void 0),r([Je()],Igt.prototype,"resultGraphicEnabled",void 0),r([Je()],Igt.prototype,"resultSymbol",void 0),r([Je()],Igt.prototype,"suggestionsEnabled",void 0),r([Je()],Igt.prototype,"suffix",void 0),r([Je()],Igt.prototype,"withinViewEnabled",void 0),r([Je()],Igt.prototype,"zoomScale",void 0),Igt=r([ln("esri.widgets.Search.SearchSource")],Igt);const kgt=Igt;const Cgt=/https?:\/\/services.*\.arcgis\.com/i,Egt=/(?:\{([^}]+)\})/g,jgt=()=>jt.getLogger("esri.widgets.Search.support.layerSearchUtils");function Ogt(t,e){const{exactMatch:i=!1,location:n,maxResults:s,spatialReference:r,source:o,sourceIndex:a,suggestResult:l,view:u}=t,{layer:c,filter:h,zoomScale:d}=o,f=u?.scale,p=Lgt(o,u),m=e?.signal;return Pgt(c).then((()=>{const t=c.popupTemplate;return t?t.getRequiredFields(c.fieldsIndex):null})).then((t=>{const{objectIdField:e,returnZ:y}=c,g=Ggt(o);if(!qgt(c,g))throw jgt().error("invalid-field: displayField is invalid."),new Ve("getResults():invalid-field","displayField is invalid.");const v=t?.length?t:[g],w=o.outFields||v,b=Ngt(w);w.includes(e)||b||w.push(e),c.floorInfo?.floorField&&w.push(c.floorInfo.floorField);if(!(b||Vgt(c,w)))throw jgt().error("invalid-field: outField is invalid."),new Ve("getResults():invalid-field","outField is invalid.");const S=c.createQuery(),{orderByFields:_}=o;if(_&&(S.orderByFields=_),r){S.outSpatialReference=r;const t=1/Yc(r);t&&(S.maxAllowableOffset=t)}const x="mesh"===c.geometryType||"multipatch"===c.geometryType,M=c.capabilities?.data?.supportsZ&&!x;if(S.returnZ=M&&!1!==y,S.returnGeometry=!0,S.multipatchOption=x?"xyFootprint":null,w&&(S.outFields=w),n)S.geometry=n;else if(l.key)S.objectIds=[l.key];else{const t=o.searchFields||[g];if(!Vgt(c,t))throw jgt().error("invalid-field: search field is invalid."),new Ve("getResults():invalid-field","search field is invalid.");Ugt(c)&&(S.num=s),p&&(S.geometry=p);const e=l.text?.trim();if(!e)return[];const n=l.text,{prefix:r="",suffix:a=""}=o,u=Zgt(`${r}${n}${a}`);zgt(c)&&Dgt(c,t)&&!i&&n&&(S.fullText=$gt({text:n,searchFields:t}));const d=Qgt({searchTerm:u,layer:c,searchFields:t,filter:h,exactMatch:i,query:S,type:"search"});if(S.where=d,!Fgt(S))return[]}return c.queryFeatures(S,{signal:m}).then((t=>ovt(t,u,o,a,g,f,d)))}))}function Rgt(t,e){const{source:i,spatialReference:n,view:s,suggestTerm:r,maxSuggestions:o,sourceIndex:a,exactMatch:l}=t,{layer:u,filter:c}=i,h=e?.signal,d=Lgt(i,s);return Pgt(u).then((()=>{if(!Ugt(u))return[];const t=Ggt(i),e=i.searchFields||[t],s=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(Egt,((t,e)=>(s.push(e),t))):s.push(t);const f=Ngt(s);s.includes(u.objectIdField)||f||s.push(u.objectIdField);const p=qgt(u,t),m=f||Vgt(u,s),y=Vgt(u,e);if(!p)throw jgt().error("invalid-field: displayField is invalid."),new Ve("getSuggestions():invalid-field","displayField is invalid.");if(!m)throw jgt().error("invalid-field: outField is invalid."),new Ve("getSuggestions():invalid-field","outField is invalid.");if(!y)throw jgt().error("invalid-field: search field is invalid."),new Ve("getSuggestions():invalid-field","search field is invalid.");const g=u.createQuery(),{orderByFields:v}=i;v&&(g.orderByFields=v),g.outSpatialReference=n,g.returnGeometry=!1,g.num=o,g.outFields=s,d&&(g.geometry=d);if(!r.trim())return[];const{prefix:w="",suffix:b=""}=i,S=Zgt(`${w}${r}${b}`);zgt(u)&&Dgt(u,e)&&!l&&r&&(g.fullText=$gt({text:r,searchFields:e}));const _=Qgt({searchTerm:S,layer:u,searchFields:e,filter:c,exactMatch:l,query:g,type:"suggest"});return g.where=_,Fgt(g)?u.queryFeatures(g,{signal:h}).then((e=>nvt(e,i,a,t))):[]}))}function Lgt(t,e){const{filter:i,withinViewEnabled:n}=t,s=e?.extent,r=i?.geometry;return r??(n&&s?s:void 0)}function Ngt(t){return t&&t.includes("*")}async function Pgt(t){t&&await t.load()}function Fgt(t){return!(!t.fullText&&!t.where)}function Dgt(t,e){const i=t?.indexes;if(!i||!e?.length)return!1;return i.filter((t=>"FullText"===t.indexType)).some((t=>{const i=t.fields?.split(",").map((t=>t.trim().toLowerCase()))||[];return e.every((t=>i.includes(t.toLowerCase())))}))}function $gt({text:t,searchFields:e}){return t.trim().split(" ").filter((t=>!!t.trim())).map((t=>new j$({onFields:e,searchTerm:t,searchType:"prefix"})))}function zgt(t){return t?.capabilities?.query?.supportsFullTextSearch??!1}function Ugt(t){return t?.capabilities?.query?.supportsPagination??!1}function Bgt(t){return t?.fieldsIndex?.fields?.find((t=>"string"===t.type))?.name??""}function Ggt(t){return t.displayField||t.layer.displayField||Bgt(t.layer)}function Vgt(t,e){return!(!t||!e?.length)&&e.every((e=>qgt(t,e)))}function qgt(t,e){return!!t.getField(e)}function Hgt(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function Wgt({codedValues:t},e,i){return On(t??[],(t=>{const n=t.name,s=i?n:n.toLowerCase();return(i?e:e.toLowerCase())===s?t.code.toString():null}))??null}function Zgt(t){return t.replaceAll("'","''")}function Jgt(t,e){const i=e?.where;return i?`(${t}) AND (${i})`:t}function Ygt({currentTerm:t,field:e,filter:i,exactMatch:n,url:s,type:r}){const o=e?.type,a=e?.name;if("string"===o||"date"===o||"global-id"===o){const e=Cgt.test(s??""),o=e&&Hgt(t)?"N":"";if(n&&"search"===r)return Jgt(`${a} = ${o}'${t}'`,i);if(e){return Jgt(`${a} LIKE ${o}${`'${t}%'`}`,i)}return Jgt(`${`LOWER(${a})`} LIKE ${o}${`'${t.toLowerCase()}%'`}`,i)}if("oid"===o||"small-integer"===o||"integer"===o||"single"===o||"double"===o){const e=Number(t);return isNaN(e)?null:Jgt(`${a} = ${e}`,i)}return Jgt(`${a} = ${t}`,i)}function Kgt(t,e){return t?` OR (${e})`:`(${e})`}function Qgt({searchTerm:t,layer:e,searchFields:i,filter:n,exactMatch:s,query:r,type:o}){const{definitionExpression:a,url:l}=e;let c="";return!r.fullText&&t&&i&&i.forEach((i=>{const r=e.getField(i),a=e.getFieldDomain?.(i,{excludeImpliedDomains:u("esri-widget-legacy-field-domain-calculation")}),h=(a&&"coded-value"===a.type?Wgt(a,t,s):null)||t||null;if(null!==h){const t=Ygt({currentTerm:h,field:r,filter:n,exactMatch:s,url:l,type:o});t&&(c+=Kgt(c,t))}})),a&&c?`(${a}) AND (${c})`:a||c}function Xgt(t,e){let i=null;const{codedValues:n}=t;return n&&n.length&&n.some((t=>t.code===e&&(i=t.name,!0))),i}function tvt(t,e){return t[e]??t[Object.keys(t).find((t=>t.toLowerCase()===e.toLowerCase()))]}function evt(t,e,i){const n=t.sourceLayer,{attributes:s}=t,r=n.getFieldDomain?.(i,{feature:t,excludeImpliedDomains:u("esri-widget-legacy-field-domain-calculation")});if(e)return Xg(e,s);if(i&&s){const t=n.getField(i),e=tvt(s,i);return null==e?"":r&&"coded-value"===r.type?Xgt(r,e)??"":"date"===t?.type?$g(new Date(e)):"number"==typeof e?e.toString():"string"!=typeof e?"":e.trim()}return""}function ivt(t,e,i,n){const s=t.sourceLayer,{attributes:r}=t,{objectIdField:o}=s,a=o?r[o]:null;return{text:evt(t,e.suggestionTemplate,n),key:a,sourceIndex:i}}function nvt(t,e,i,n){return t.features.map((t=>ivt(t,e,i,n)))}function svt(t){return null!=t&&null!=t.minScale&&null!=t.maxScale}function rvt(t,e,i,n,s,r,o){const a=t.clone(),l=t.sourceLayer,u=l?.objectIdField,c=u?t.attributes[u]:null,h=evt(t,i.searchTemplate,s);null!=r&&svt(l)&&(l.minScale&&l.minScale<r?r=l.minScale:l.maxScale&&l.maxScale>r&&(r=l.maxScale));const d=a.geometry?bgt(a.geometry,e??void 0,r??void 0):void 0,f="number"==typeof o&&d?wgt(nt(d),e??void 0,o):d,p=t.clone();return null!=f&&(p.geometry=qp.fromExtent(f)),{extent:f,target:p,feature:a,key:c,name:h,sourceIndex:n}}function ovt(t,e,i,n,s,r,o){return t.features.map((t=>rvt(t,e,i,n,s,r,o)))}var avt;let lvt=avt=class extends kgt{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(t,e)=>Ogt({source:this,...t},e),this.getSuggestions=(t,e)=>Rgt({source:this,...t},e)}set layer(t){this._set("layer",t),t&&t.load().catch((()=>{}))}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new avt({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?nt(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?nt(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find((t=>"string"===t.type))?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;if(!t.loaded)return"";return`: ${(e||[this._getDisplayField()]).map((e=>{const i=t.getField(e);return i?.alias||e})).join(", ")}`}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};r([Je({json:{read:{source:"field.name"},write:{target:"field.name"}}})],lvt.prototype,"displayField",void 0),r([Je({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],lvt.prototype,"exactMatch",void 0),r([Je({value:null})],lvt.prototype,"layer",null),r([Je()],lvt.prototype,"name",null),r([Je({type:[String],json:{write:!0}})],lvt.prototype,"orderByFields",void 0),r([Je()],lvt.prototype,"searchFields",void 0),r([Je()],lvt.prototype,"searchTemplate",void 0),r([Je()],lvt.prototype,"suggestionTemplate",void 0),lvt=avt=r([ln("esri.widgets.Search.LayerSearchSource")],lvt);const uvt=lvt;function cvt(t){return!!t&&"number"==typeof t.x&&"number"==typeof t.y}function hvt(t){return t&&"number"==typeof t.xmin&&"number"==typeof t.ymin&&"number"==typeof t.xmax&&"number"==typeof t.ymax}let dvt=class extends Io{constructor(t){super(t),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};r([Je({type:String,json:{write:!0}})],dvt.prototype,"address",void 0),r([Je({type:Object,json:{write:!0}})],dvt.prototype,"attributes",void 0),r([Je({type:Od,json:{write:!0}})],dvt.prototype,"extent",void 0),r([Je({type:Kh,json:{write:!0}})],dvt.prototype,"location",void 0),r([Je({type:Number,json:{write:!0}})],dvt.prototype,"score",void 0),dvt=r([ln("esri.rest.support.AddressCandidate")],dvt);const fvt=dvt;let pvt=class extends Io{constructor(t){super(t),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};r([Je({type:Object,json:{write:!0}})],pvt.prototype,"address",void 0),r([Je(Ymt)],pvt.prototype,"apiKey",void 0),r([Je({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],pvt.prototype,"categories",void 0),r([Je({type:String,json:{write:!0}})],pvt.prototype,"countryCode",void 0),r([Je({type:Boolean,json:{write:!0}})],pvt.prototype,"forStorage",void 0),r([Je({type:Kh,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],pvt.prototype,"location",void 0),r([Je({type:String,json:{write:!0}})],pvt.prototype,"locationType",void 0),r([Je({type:String,json:{write:!0}})],pvt.prototype,"magicKey",void 0),r([Je({type:Number,json:{write:!0}})],pvt.prototype,"maxLocations",void 0),r([Je({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],pvt.prototype,"outFields",void 0),r([Je({type:wh,json:{read:{source:"outSR"},write:{target:"outSR"}}})],pvt.prototype,"outSpatialReference",void 0),r([Je({type:Od,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=i}}}})],pvt.prototype,"searchExtent",void 0),pvt=r([ln("esri.rest.support.AddressToLocationsParameters")],pvt),pvt.from=ee(pvt);const mvt=pvt;async function yvt(t,e,i){e=mvt.from(e);const n=wG(t),{address:s,...r}=e.toJSON(),o={...s,...r,f:"json"},a=bG({...n.query,...o}),l=vG(a,i),u=`${n.path}/findAddressCandidates`;return Pl(u,l).then(gvt)}function gvt({data:t}){if(!t)return[];const{candidates:e,spatialReference:i}=t;return e?e.map((t=>{if(!t)return;const{extent:e,location:n}=t,s=!e||hvt(e);return cvt(n)&&s?(e&&(e.spatialReference=i),n&&(n.spatialReference=i),fvt.fromJSON(t)):void 0})):[]}let vvt=class extends Io{constructor(t){super(t),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null}};r([Je(Ymt)],vvt.prototype,"apiKey",void 0),r([Je({type:Kh,json:{write:{writer:(t,e)=>{const i=t?t.clone().normalize():null,n=void 0!==i;e.location=n?i:null}}}})],vvt.prototype,"location",void 0),r([Je({type:String,json:{write:!0}})],vvt.prototype,"locationType",void 0),r([Je({type:wh,json:{read:{source:"outSR"},write:{target:"outSR"}}})],vvt.prototype,"outSpatialReference",void 0),vvt=r([ln("esri.rest.support.LocationToAddressParameters")],vvt),vvt.from=ee(vvt);const wvt=vvt;async function bvt(t,e,i){e=wvt.from(e);const n=wG(t),s={...e.toJSON(),f:"json"},r=bG({...n.query,...s}),o=vG(r,i),a=`${n.path}/reverseGeocode`;return Pl(a,o).then(Svt)}function Svt({data:t}){if(!t)return;const{address:e,location:i}=t,n=e?.Match_addr||"";return fvt.fromJSON({address:n,attributes:e||{},location:i,score:100})}let _vt=class extends Io{constructor(t){super(t),this.isCollection=null,this.magicKey=null,this.text=null}};r([Je({type:Boolean,json:{write:!0}})],_vt.prototype,"isCollection",void 0),r([Je({type:String,json:{write:!0}})],_vt.prototype,"magicKey",void 0),r([Je({type:String,json:{write:!0}})],_vt.prototype,"text",void 0),_vt=r([ln("esri.rest.support.SuggestionCandidate")],_vt);const xvt=_vt;let Mvt=class extends Io{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};r([Je(Ymt)],Mvt.prototype,"apiKey",void 0),r([Je({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Mvt.prototype,"categories",void 0),r([Je({type:String,json:{write:!0}})],Mvt.prototype,"countryCode",void 0),r([Je({type:Kh,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Mvt.prototype,"location",void 0),r([Je({type:Number,json:{write:!0}})],Mvt.prototype,"maxSuggestions",void 0),r([Je({type:wh,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Mvt.prototype,"outSpatialReference",void 0),r([Je({type:Od,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(i)}}}})],Mvt.prototype,"searchExtent",void 0),r([Je({type:String,json:{write:!0}})],Mvt.prototype,"text",void 0),Mvt=r([ln("esri.rest.support.SuggestLocationsParameters")],Mvt),Mvt.from=ee(Mvt);const Tvt=Mvt;async function Avt(t,e,i){const n=wG(t),s={...(e=Tvt.from(e)).toJSON(),f:"json"},r=bG({...n.query,...s}),o=vG(r,i),a=`${n.path}/suggest`;return Pl(a,o).then(Ivt)}function Ivt(t){const{data:e}=t;if(!e)return[];const{suggestions:i}=e;return i?i.map((t=>new xvt(t))):[]}const kvt="Single Line Input",Cvt=3e5;function Evt(t,e){return t.location?Fvt(t,e):$vt(t,e)}function jvt(t,e){if(e.localSearchDisabled)return null;const i=t?.scale;return"number"==typeof i&&i<=Cvt?t?.extent?.center:null}async function Ovt(t,e){const{source:i,spatialReference:n,view:s,suggestTerm:r,maxSuggestions:o,sourceIndex:a}=t,l=new Tvt,{apiKey:u,url:c}=i,h=Dvt(i,s),d=e?.signal;if(!c)return null;u&&(l.apiKey=u),i.categories&&(l.categories=i.categories),n&&(l.outSpatialReference=n);const f=jvt(s,i);f&&(l.location=f);if(!r.trim())return null;const{prefix:p="",suffix:m=""}=i,y=`${p}${r}${m}`;return l.text=y,h&&(l.searchExtent=h),l.maxSuggestions=o,i.countryCode&&(l.countryCode=i.countryCode),Avt(c,l,{signal:d}).then((t=>Uvt(t,a)))}function Rvt(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Lvt(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Nvt(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const Pvt="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function Fvt(t,e){const{source:i,spatialReference:n,location:s,sourceIndex:r,view:o}=t,{apiKey:a,url:l,zoomScale:u,defaultZoomScale:c}=i;if(null==l)return[];const h=o?.scale,d=e?.signal,f=new wvt({location:s});a&&(f.apiKey=a),n&&(f.outSpatialReference=n);try{return Gvt([await bvt(l,f,{signal:d})],{sourceIndex:r,scale:h,view:o,zoomScale:u,defaultZoomScale:c})}catch(t){return[]}}function Dvt(t,e){const{filter:i,withinViewEnabled:n}=t,s=e?.scale,r=e?.extent,o=i?.geometry;return(o?bgt(o,e??void 0,s):void 0)||(n&&r?r:void 0)}async function $vt(t,e){const{source:i,suggestResult:n,spatialReference:s,view:r,maxResults:o,sourceIndex:a}=t,l=i?.zoomScale,u=i?.defaultZoomScale,c=n.text?.trim();if(!c)return null;const h=!n.key&&i.prefix?i.prefix:"",d=!n.key&&i.suffix?i.suffix:"",f=`${h}${n.text}${d}`,p=new mvt,{apiKey:m,url:y}=i,g=r?.scale,v=Dvt(i,r),w=e?.signal;if(m&&(p.apiKey=m),!y)return null;i.categories&&(p.categories=i.categories),i.locationType&&(p.locationType=i.locationType),s&&(p.outSpatialReference=s);const b=jvt(r,i);b&&(p.location=b),p.maxLocations=o,v&&(p.searchExtent=v),i.countryCode&&(p.countryCode=i.countryCode);const{key:S}=n,_=`${S}`;return S&&(p.magicKey=_),p.address={},p.address[i.singleLineFieldName||kvt]=f,i.outFields&&(p.outFields=i.outFields),yvt(y,p,{signal:w}).then((t=>Gvt(t,{key:_,scale:g,sourceIndex:a,view:r,zoomScale:l,defaultZoomScale:u})))}function zvt(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function Uvt(t,e){return t.map((t=>zvt(t,e)))}function Bvt(t,e){const{key:i,scale:n,sourceIndex:s,view:r,zoomScale:o,defaultZoomScale:a}=e,{attributes:l,extent:u,location:c,address:h}=t,d=new OD({geometry:c,attributes:l}),f=u||c,p=f?bgt(f,r??void 0,n??void 0):void 0,m=p?"number"==typeof o?wgt(p,r??void 0,o):"number"==typeof a&&"point"===f?.type?wgt(p,r??void 0,a):p:null,y=c?`${c.x},${c.y}`:"",g=h||y,v=d.clone();return null!=m&&(v.geometry=qp.fromExtent(m)),{extent:m,feature:d,target:v,key:i,name:g,sourceIndex:s}}function Gvt(t,e){return t.filter(Boolean).map((t=>Bvt(t,e)))}var Vvt;let qvt=Vvt=class extends kgt{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(t,e)=>Evt({source:this,...t},e),this.getSuggestions=(t,e)=>Ovt({source:this,...t},e)}clone(){return new Vvt({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?nt(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?nt(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};r([Je()],qvt.prototype,"apiKey",void 0),r([Je()],qvt.prototype,"categories",void 0),r([Je()],qvt.prototype,"countryCode",void 0),r([Je({json:{write:!0}})],qvt.prototype,"defaultZoomScale",void 0),r([Je()],qvt.prototype,"localSearchDisabled",void 0),r([Je()],qvt.prototype,"locationType",void 0),r([Je({json:{write:!0}})],qvt.prototype,"name",void 0),r([Je({json:{write:!0}})],qvt.prototype,"placeholder",void 0),r([Je()],qvt.prototype,"searchTemplate",void 0),r([Je({json:{write:!0}})],qvt.prototype,"singleLineFieldName",void 0),r([Je({json:{read:{source:"suggest"},write:{target:"suggest"}}})],qvt.prototype,"suggestionsEnabled",void 0),r([Je({json:{write:!0}})],qvt.prototype,"url",void 0),r([Je({json:{write:!0}})],qvt.prototype,"zoomScale",void 0),qvt=Vvt=r([ln("esri.widgets.Search.LocatorSearchSource")],qvt);const Hvt=qvt;const Wvt=()=>jt.getLogger("esri.widgets.support.geolocationUtils"),Zvt={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function Jvt(){const t=!!u("esri-geolocation");return t||Wvt().warn("geolocation-unsupported","Geolocation unsupported."),t}function Yvt(){const t=window.isSecureContext;return t||Wvt().warn("insecure-context","Geolocation requires a secure origin."),t}function Kvt(){return Jvt()&&Yvt()}function Qvt(t){const e=15e3;return t??=Zvt,new Promise(((i,n)=>{setTimeout((()=>n(new Ve("geolocation:timeout","getting the current geolocation position timed out"))),e),navigator.geolocation.getCurrentPosition(i,n,t??void 0)}))}function Xvt(t,e){const{position:i,view:n}=t,s=twt(i),r=s?.coords;if(!r)throw new Ve("geometry-service:no-coords","Geolocation has no coordinates");return iwt(ewt(r),n,e)}function twt(t){const e=t&&t.coords||{},i={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed};return t?{coords:i,timestamp:t.timestamp}:t}function ewt({longitude:t,latitude:e,altitude:i}){return new Kh({longitude:t,latitude:e,z:i||void 0,spatialReference:{wkid:4326}})}function iwt(t,e,i){if(!e)return Promise.resolve(t);const n=e.spatialReference;return n.isWGS84?Promise.resolve(t):n.isWebMercator?Promise.resolve(zh(t)):nwt(i).then((e=>{if(!e)throw new Ve("geometry-service:missing-url","Geometry service URL is missing");const s=new B4({geometries:[t],outSpatialReference:n});return V4(e,s,i).then((t=>t[0]))}))}function nwt(t){if(St.geometryServiceUrl)return Promise.resolve(St.geometryServiceUrl);const e=uT.getDefault();return e.load(t).catch((()=>{})).then((()=>e.helperServices?.geometry?.url))}function swt(t,e){return t.hasOwnProperty(e)&&null!=t[e]&&""!==t[e]}const rwt=()=>hv("esri/widgets/Search/t9n/Search"),owt="highlight",awt=Vm.ofType({key:t=>t.layer?"layer":"locator",base:kgt,typeMap:{layer:uvt,locator:Hvt}}),lwt=wh.WGS84,uwt="esri/images/search/search-symbol-32.png",cwt=/<[\s\S]*?>/g,hwt=-1;let dwt=class extends(Q3(Tm.EventedMixin(ao))){constructor(t){super(t),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new awt,this.defaultSymbols={point:new HF({url:ru(uwt),size:24,width:24,height:24}),polyline:new DL({color:[130,130,130,1],width:2}),polygon:new sD({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=uT.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new awt,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const t=async()=>{const t=await rwt();this.messages=t,this.defaultPopupTemplate=new tL({title:t.searchResult,content:"{Match_addr}"})};t(),this.addHandles([ey((()=>[this.includeDefaultSources,this.view,this.portal]),(()=>this._update()),dy),Qy(t)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return 1===this.allSources.length||!this.searchAllEnabled?0:hwt}set activeSourceIndex(t){this._overrideIfSome("activeSourceIndex",t)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(t){this._overrideIfSome("allPlaceholder",t)}get allSources(){const{sources:t,defaultSources:e,includeDefaultSources:i}=this,n="function"==typeof i?i.call(null,{sources:t,defaultSources:e}):i?e.concat(t):t,s=this._get("allSources")||new awt;return s.removeAll(),s.addMany(n.filter(Boolean)),s}get locationEnabled(){return this._get("locationEnabled")||Kvt()}set locationEnabled(t){if(void 0===t)return void this._clearOverride("locationEnabled");const e=Kvt();if(t&&!e){const t=new Ve("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});jt.getLogger(this).error(t)}this._override("locationEnabled",!!t&&e)}get placeholder(){const{allSources:t,activeSourceIndex:e,allPlaceholder:i}=this;if(e===hwt)return i??"";const n=t.at(e);return n?.placeholder??""}set searchTerm(t){this._set("searchTerm",t||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==t&&this._set("selectedSuggestion",null),""===t&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:t,resultGraphic:e}=this;t&&e&&t.graphics.remove(e),this._set("resultGraphic",null)}search(t,e){this.emit("search-start"),this.clearGraphics();const i=this._createSuggestionForSearch(t),n=(async()=>{try{await this.when();const t=await this._getResultsFromSources(i,e);if(e?.signal?.aborted)return null;const n={activeSourceIndex:this.activeSourceIndex,searchTerm:i.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(n,t,i);const s=this._getFirstResult(n.results),r=i.location&&s?s.name:i.text,o=r?.replace(cwt,"");return this._set("searchTerm",o),(i.key&&"number"==typeof i.sourceIndex||i.location)&&this._set("selectedSuggestion",i),this._set("results",n.results),this._set("resultCount",n.results.reduce(((t,e)=>t+(e.results?.length??0)),0)),this.emit("search-complete",n),await this._selectFirstResult(s),n}finally{this._clearSearching()}})();return this._searching=n,n}async searchNearby(t){if(!this.locationEnabled){const t=new Ve("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw jt.getLogger(this).error(t),t}const e=(async()=>{try{const e=await Qvt(),i=await Xvt({position:e,view:this.view},t);return await this.search(i,t)}finally{this._clearSearching()}})();return this._searching=e,e}async select(t){if(this.clearGraphics(),!t){const e=new Ve("select:missing-parameter","Cannot select without a searchResult.",{searchResult:t});throw jt.getLogger(this).error(e),e}const{view:e}=this,i=swt(t,"sourceIndex")?t.sourceIndex:this._getSourceIndexOfResult(t),n=null!=i?this.allSources.at(i):null;if(!n){const t=new Ve("select:missing-source","Cannot select without a source.",{source:n});throw jt.getLogger(this).error(t),t}const s=n instanceof uvt?this._getLayerSourcePopupTemplate(n):n.popupTemplate,r=n.resultSymbol||this._getDefaultSymbol(t),o=swt(n,"resultGraphicEnabled")?n.resultGraphicEnabled:this.resultGraphicEnabled,a=swt(n,"autoNavigate")?n.autoNavigate:this.autoNavigate,l=swt(n,"popupEnabled")?n.popupEnabled:this.popupEnabled,u=l?s||this.popupTemplate||this.defaultPopupTemplate:null,{feature:c}=t;if(!c){const t=new Ve("select:missing-feature","Cannot select without a feature.",{feature:c});throw jt.getLogger(this).error(t),t}const{attributes:h,geometry:d,layer:f,sourceLayer:p}=c,m=d?ggt(d):null,y={layerViewQuery:this._getLayerView(c),elevationQuery:e&&null!=m?vgt(m,e):Promise.resolve(m)},g=await Os(y),v=g.layerViewQuery.value,w=g.elevationQuery.value;r instanceof hD&&(r.text=t.name);const b=e&&a?t.target||t.extent:null,S=null!=b?this._goToSearchResult(b):Promise.resolve();await S;const _=v?c:new OD({geometry:d,symbol:r,attributes:h,layer:f,sourceLayer:p,popupTemplate:u}),x=e?.popup,M=x&&l&&_.getEffectivePopupTemplate(x.defaultPopupTemplateEnabled);return M&&await e.openPopup({features:[_],location:w}),v&&_gt(v)&&!M&&this._highlightFeature({graphic:_,layerView:v}),!v&&o&&e&&e.graphics.push(_),this._setResultFloor(t),this._set("selectedResult",t),this._set("resultGraphic",_),this.emit("select-result",{result:t,source:n,sourceIndex:i}),t}async suggest(t,e,i){const n=t||this.searchTerm;this.emit("suggest-start",{searchTerm:n}),await this._suggestTimer(e,i);const s=await this._suggestImmediate(n,i);return this._set("suggestions",s?.results),this._set("suggestionCount",s?.results.reduce(((t,e)=>t+(e.results?.length??0)),0)??null),this.emit("suggest-complete",s),s}async when(){await oy((()=>!this.updating))}async _update(){const{portal:t,view:e}=this;if(this.includeDefaultSources){const i=this._updatingPromise=Os([t?.load(),e?.when()]);if(this.destroyed)return;if(await i,i!==this._updatingPromise)return}await oy((()=>this.messages)),this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const t=this.portal?.helperServices?.geocode;if(!t)return[];return t.map((t=>{if(!1===t.placefinding)return;const e=St.apiKey&&Nvt(t.url)?{url:Pvt}:null,i=Hvt.fromJSON({...t,...e}),n=i.url;if(Nvt(n)||Lvt(n)||Rvt(n)){const t=i.outFields??["Addr_type","Match_addr","StAddr","City"],e=(i.placeholder||this.messages?.placeholder)??"",n="number"==typeof i.defaultZoomScale?i.defaultZoomScale:2500;i.singleLineFieldName="SingleLine",i.outFields=t,i.placeholder=e,i.defaultZoomScale=n}return i.singleLineFieldName?i:void 0})).filter(C)}_destroyFeatureLayers(){this._createdFeatureLayers.forEach((t=>t?.destroy())),this._createdFeatureLayers=[]}_getLayerSources(t,e){const i=this.view?.map;return t.map((t=>{const n=i.findLayerById(t.id);if(!n)return;const s=this._getLayerJSON(t),r=uvt.fromJSON(s);return r.placeholder=e,this._getLayer(n,s).then((t=>{r.layer=t})),r})).filter(C).toArray()}_getTableSources(t,e){const i=this.view?.map;return t.map((t=>{if(!t.id)return;const n=i.findTableById(t.id);if(!n)return;const s=this._getLayerJSON(t),r=uvt.fromJSON(s);return r.placeholder=e,this._getLayer(n,s).then((t=>{r.layer=t})),r})).filter(C).toArray()}_convertApplicationProperties(){const t=this.view?.map,e=t?.applicationProperties?.viewing?.search;if(!e)return[];const{enabled:i,hintText:n,layers:s,tables:r}=e;if(!i)return[];return[...this._getLayerSources(s,n),...this._getTableSources(r,n)]}async _getSubLayer(t,e){if(await t.load(),!t.allSublayers)throw new Error;const i=t.allSublayers.find((t=>t.id===e.subLayer));if(!i)throw new Error;const n=await(i.createFeatureLayer?.());if(!n)throw new Error;return this._createdFeatureLayers.push(n),n}async _getBuildingSubLayer(t,e){await t.load();const i=t.allSublayers.find((t=>t.id===e.subLayer));if("building-component"!==i?.type)throw new Error;if(await i.load(),null==i.associatedLayer)throw new Error;return await i.associatedLayer.load(),i}async _getLayer(t,e){if("feature"===t.type||"scene"===t.type||"csv"===t.type||"geojson"===t.type||"ogc-feature"===t.type)return t;if("map-image"===t.type)try{return await this._getSubLayer(t,e)}catch(e){const i=new Ve("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:t});return jt.getLogger(this).error(i),null}return"building-scene"===t.type?this._getBuildingSubLayer(t,e):null}_getLayerJSON(t){return"function"==typeof t.toJSON?t.toJSON():t}_updateDefaultSources(){const{defaultSources:t,includeDefaultSources:e}=this;this._destroyFeatureLayers(),t.removeAll(),e&&t.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){const t=this.view?.popup,{resultGraphic:e}=this;if(!t||!e)return;const i="selectedFeature"in t,n=i?t.selectedFeature:null;i&&(n&&n===e)&&t.close()}_suggestTimer(t,e){const i=null!=t?t:this.suggestionDelay;return Ns(i,null,e?.signal)}_createLocationForSearch(t){return t instanceof OD&&t.geometry?ggt(t.geometry):t instanceof Kh?t:Array.isArray(t)&&2===t.length?new Kh({longitude:t[0],latitude:t[1]}):null}_createSuggestionForSearch(t){if(t&&swt(t,"key")&&swt(t,"text")&&swt(t,"sourceIndex"))return t;const e=this._createLocationForSearch(t),i="string"==typeof t?t:this.searchTerm,{selectedSuggestion:n,selectedResult:s}=this,r=!t&&n&&s,o=r&&n.key===s.key&&n.sourceIndex===s.sourceIndex,a=r&&n.location;return o||a?n:{location:e,text:e?"":i,sourceIndex:null,key:null}}_getFirstResult(t){return On(t,(({results:t})=>t?.[0]))??null}async _selectFirstResult(t){return this.autoSelect&&t?this.select(t):null}async _suggestImmediate(t,e){await this.when();const i=await this._getSuggestionsFromSources(t,e);if(e?.signal?.aborted)return null;const n={activeSourceIndex:this.activeSourceIndex,searchTerm:t??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(n,i),n}_formatSourceResponse(t,e,i){const n=e?.value||[],s=e?.error,r=this.allSources.at(i);if(s){const e={sourceIndex:i,source:r,error:s};t.errors.push(e),jt.getLogger(this).error(s),t.numErrors++}else{const e={sourceIndex:i,source:r,results:n};t.results.push(e),t.numResults+=n.length}}_formatResponse(t,e,i){if(e)if(t.activeSourceIndex===hwt){const n=i&&swt(i,"sourceIndex")&&-1!==i.sourceIndex?i.sourceIndex:void 0;e.forEach(((e,i)=>{const s=void 0!==n?n:i;this._formatSourceResponse(t,e,s)}))}else this._formatSourceResponse(t,e[0],t.activeSourceIndex)}async _getResultsFromSources(t,e){const{allSources:i}=this,n=!t.location&&swt(t,"sourceIndex")?t.sourceIndex:this.activeSourceIndex,s=[];if(!i.length){const t=new Ve("search:no-sources-defined","At least one source is required.",{allSources:i});throw jt.getLogger(this).error(t),t}return n===hwt?i.forEach(((i,n)=>{s.push(this._getResultsFromSource(t,n,e))})):s.push(this._getResultsFromSource(t,n,e)),Os(s)}async _getSuggestionsFromSources(t,e){const{allSources:i,activeSourceIndex:n}=this,s=[];if(!i.length){const t=new Ve("suggest:no-sources-defined","At least one source is required.",{allSources:i});throw jt.getLogger(this).error(t),t}return n===hwt?i.forEach(((i,n)=>{s.push(this._getSuggestionsFromSource(t,n,e))})):s.push(this._getSuggestionsFromSource(t,n,e)),Os(s)}async _getResultsFromSource(t,e,i){const n=null!=e?this.allSources.at(e):null;if(!n)return null;const{location:s=null}=t,r=this.view?.spatialReference||lwt,o=swt(n,"maxResults")?n.maxResults:this.maxResults,a=!!(n instanceof uvt&&swt(n,"exactMatch"))&&n.exactMatch,{view:l}=this;return n.getResults?.({view:l,sourceIndex:e,location:s,suggestResult:t,spatialReference:r,exactMatch:a,maxResults:o},i)}async _getSuggestionsFromSource(t,e,i){const n=this.allSources.at(e);if(!n)return null;t??="";const s=swt(n,"suggestionsEnabled")?n.suggestionsEnabled:this.suggestionsEnabled,r=t?.length,o=swt(n,"minSuggestCharacters")?n.minSuggestCharacters:this.minSuggestCharacters;if(s&&t.trim()&&r>=o){const s=this.view?.spatialReference||lwt,r=swt(n,"maxSuggestions")?n.maxSuggestions:this.maxSuggestions,{view:o}=this,a=!!(n instanceof uvt&&swt(n,"exactMatch"))&&n.exactMatch;return n.getSuggestions?.({view:o,sourceIndex:e,suggestTerm:t,spatialReference:s,maxSuggestions:r,exactMatch:a},i)}return null}_getLayerSourcePopupTemplate(t){const{layer:e}=t;if(e)return swt(t,"popupTemplate")?t.popupTemplate:e.popupTemplate}_getSourceIndexOfResult(t){return On(this.results??[],(({results:e,sourceIndex:i})=>{const n=e?.includes(t);return n?i:null}))??null}async _goToSearchResult(t){this._abortGoTo();const e=new AbortController;this._gotoController=e;const i={target:{target:t},options:{signal:e.signal}};t||(i.options.animate=!1),await this.callGoTo(i),this._gotoController=null}_getDefaultSymbol(t){const{defaultSymbols:e}=this,i=t.feature?.geometry;if(null==i)return null;switch(i.type){case"point":case"multipoint":return e.point;case"polyline":return e.polyline;case"extent":case"polygon":return e.polygon;default:return null}}_removeHighlight(){this.removeHandles(owt)}async _getLayerView(t){const{view:e}=this;if(!t||!e||"building-component"===t.layer?.type||"subtype-sublayer"===t.layer?.type)return null;const{layer:i}=t;return i?(await e.when(),e.whenLayerView(i)):null}_highlightFeature(t){const{graphic:e,layerView:i}=t,{attributes:n,layer:s}=e,{objectIdField:r}=s,o=(r&&n?.[r])??null,a=i.highlight(o??e);this.addHandles(a,owt)}_setResultFloor(t){const{view:e}=this,i=t.feature?.attributes,n=t.feature?.sourceLayer;if(n&&"floorInfo"in n&&n?.floorInfo?.floorField&&i){const t=i[n.floorInfo.floorField];e?.emit("select-result-floor",t)}}};dwt.ALL_INDEX=hwt,r([Je()],dwt.prototype,"_searching",void 0),r([Je()],dwt.prototype,"_updatingPromise",void 0),r([Je({readOnly:!0,value:null})],dwt.prototype,"activeSource",null),r([Je()],dwt.prototype,"activeSourceIndex",null),r([Je()],dwt.prototype,"allPlaceholder",null),r([Je({readOnly:!0})],dwt.prototype,"allSources",null),r([Je()],dwt.prototype,"autoNavigate",void 0),r([Je()],dwt.prototype,"autoSelect",void 0),r([Je()],dwt.prototype,"defaultPopupTemplate",void 0),r([Je({readOnly:!0})],dwt.prototype,"defaultSources",void 0),r([Je()],dwt.prototype,"defaultSymbols",void 0),r([Je()],dwt.prototype,"includeDefaultSources",void 0),r([Je()],dwt.prototype,"locationEnabled",null),r([Je()],dwt.prototype,"maxInputLength",void 0),r([Je()],dwt.prototype,"maxResults",void 0),r([Je()],dwt.prototype,"maxSuggestions",void 0),r([Je()],dwt.prototype,"messages",void 0),r([Je()],dwt.prototype,"minSuggestCharacters",void 0),r([Je({readOnly:!0})],dwt.prototype,"placeholder",null),r([Je()],dwt.prototype,"popupEnabled",void 0),r([Je({type:tL})],dwt.prototype,"popupTemplate",void 0),r([Je({type:uT})],dwt.prototype,"portal",void 0),r([Je()],dwt.prototype,"resultCount",void 0),r([Je()],dwt.prototype,"resultGraphicEnabled",void 0),r([Je({readOnly:!0})],dwt.prototype,"resultGraphic",void 0),r([Je({readOnly:!0})],dwt.prototype,"results",void 0),r([Je({readOnly:!0})],dwt.prototype,"selectedSuggestion",void 0),r([Je()],dwt.prototype,"searchAllEnabled",void 0),r([Je({readOnly:!0})],dwt.prototype,"selectedResult",void 0),r([Je()],dwt.prototype,"searchTerm",null),r([Je({type:awt})],dwt.prototype,"sources",void 0),r([Je({readOnly:!0})],dwt.prototype,"state",null),r([Je()],dwt.prototype,"suggestionDelay",void 0),r([Je()],dwt.prototype,"suggestionCount",void 0),r([Je({readOnly:!0})],dwt.prototype,"suggestions",void 0),r([Je()],dwt.prototype,"suggestionsEnabled",void 0),r([Je({readOnly:!0})],dwt.prototype,"updating",null),r([Je()],dwt.prototype,"view",void 0),r([Je()],dwt.prototype,"clear",null),dwt=r([ln("esri.widgets.Search.SearchViewModel")],dwt);const fwt=dwt;let pwt=class extends A3{constructor(t,e){super(t,e),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const t={[ugt.showMoreResults]:this.showMoreResultsOpen};return V3("div",{class:this.classes(ugt.base,P3.widget)},V3("div",{class:this.classes(ugt.moreResults,t),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return V3("div",{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){const t=this.viewModel?.selectedResult,e=t?.name||"";return V3("div",{class:ugt.moreResultsItem,key:"esri-search-renderer__result-name"},e)}_renderMoreResultsLists(){const{viewModel:t}=this;if(!t)return[];const e=t.results;if((t.resultCount??0)<2)return null;const i=e?.map((t=>this._renderMoreResultsList(t)));return V3("div",{class:ugt.moreResultsList,key:"esri-search-renderer__more-results-container"},i)}_renderMoreResultsButton(){const{messages:t,viewModel:e}=this;if(!e)return null;return(e.resultCount??0)<2?null:V3("div",{class:ugt.moreResultsItem,key:"esri-search-renderer__more-results-button"},V3("a",{bind:this,class:P3.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?t.hideMoreResults:t.showMoreResults))}_renderMoreResultsHeader(t,e){return V3("div",{class:ugt.moreResultsListHeader,key:`esri-search-result-renderer__header-${e}`},t)}_renderMoreResultsList(t){const{results:e}=t,i=e?.length??0,n=i>0,s=this.viewModel?.selectedResult,r=1===i&&e[0]===s,o=this._getSourceName(t.source,t.sourceIndex),a=(this.viewModel?.results?.length??0)>1&&!r?this._renderMoreResultsHeader(o,t.sourceIndex):null,l=n&&e.map(((t,e)=>this._renderMoreResultsListItem(t,e))),u=n&&!r?V3("ul",{key:`esri-search-result-renderer__list-${t.sourceIndex}`},l):null;return n?V3("div",{key:`esri-search-result-renderer__results-${t.sourceIndex}`},a,u):null}_renderMoreResultsListItem(t,e){const i=this.viewModel?.selectedResult;return t!==i?V3("li",{key:`esri-search-result-renderer__list-item-${e}`},V3("a",{bind:this,class:P3.anchor,"data-result":t,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},t.name)):null}_showMoreResultsClick(t){t.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const e=this.viewModel?.view?.popup;e&&"reposition"in e&&e.reposition()}_selectResultClick(t){t.preventDefault();const e=t.currentTarget["data-result"];this.viewModel?.select(e)}_getSourceName(t,e){return e===fwt.ALL_INDEX?this.messages.all:t.name}};r([Je(),z3("esri/widgets/Search/t9n/Search")],pwt.prototype,"messages",void 0),r([Je()],pwt.prototype,"showMoreResultsOpen",void 0),r([Je()],pwt.prototype,"viewModel",void 0),r([F3()],pwt.prototype,"_showMoreResultsClick",null),r([F3()],pwt.prototype,"_selectResultClick",null),pwt=r([ln("esri.widgets.Search.SearchResultRenderer")],pwt);const mwt=pwt;const ywt={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"};function gwt(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const i=e._delegatedEventNames,n=Array.isArray(t)?t:vwt(t);i.push(...n)}}function vwt(t){return t.split(",").map((t=>t.trim()))}const wwt=/<[a-z/][\s\S]*>/i,bwt=(t,e)=>{const i=Tt(e).split(/\s/),n=new RegExp(`(${i.join("|")})`,"gi");return t.replace(n,(t=>`<strong>${t}</strong>`))};let Swt=class extends A3{constructor(t,e){super(t,e),this._activeMenuItemIndex=-1,this._inputNode=null,this._focusAbortController=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new mwt,this._suggestController=null,this._searchController=null,this._locateFailed=!1,this._container=null,this.activeMenu="none",this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new fwt,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=t=>{const e=t.relatedTarget;e&&this._container?.contains(e)||this._clearActiveMenu()},this._renderSearchResultsContent=()=>this._searchResultRenderer,this.addHandles([ey((()=>this.searchTerm),(t=>{(t&&"warning"===this.activeMenu||!t&&!this.viewModel?.selectedSuggestion?.location)&&this._clearActiveMenu()})),sy((()=>this.viewModel?.allSources),"change",(()=>this._watchSourceChanges())),ey((()=>this.activeMenu),(()=>this._resetActiveMenuItemIndex()),dy),ey((()=>this.viewModel),(t=>this._searchResultRenderer.viewModel=t),dy),ey((()=>this.viewModel.results),(()=>this._searchResultRenderer.showMoreResultsOpen=!1)),ey((()=>this.viewModel?.defaultPopupTemplate),(t=>{t&&(t.content=this._renderSearchResultsContent)}),dy)])}destroy(){this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer=An(this._searchResultRenderer),this._focusAbortController?.abort()}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(t){this.viewModel.activeSourceIndex=t}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(t){this.viewModel.allPlaceholder=t}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(t){this.viewModel.autoNavigate=t}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(t){this.viewModel.autoSelect=t}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return"search"}set icon(t){this._overrideIfSome("icon",t)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(t){this.viewModel.includeDefaultSources=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(t){this.viewModel.locationEnabled=t}get maxResults(){return this.viewModel.maxResults}set maxResults(t){this.viewModel.maxResults=t}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(t){this.viewModel.maxSuggestions=t}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(t){this.viewModel.minSuggestCharacters=t}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(t){this.viewModel.popupEnabled=t}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(t){this.viewModel.popupTemplate=t}get portal(){return this.viewModel?.portal}set portal(t){this.viewModel&&(this.viewModel.portal=t)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(t){this.viewModel.resultGraphic=t}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(t){this.viewModel.resultGraphicEnabled=t}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(t){this.viewModel.searchAllEnabled=t}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(t){this.viewModel.searchTerm=t}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(t){this.viewModel.sources=t}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(t){this.viewModel.suggestionsEnabled=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}clear(){this.viewModel.clear()}focus(){this._handleFocus(),this.emit("search-focus")}async _handleFocus(){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const t=this._focusAbortController.signal;await js(dr(t)),this._inputNode?.focus()}blur(){this._inputNode?.blur(),this.emit("search-blur")}async search(t){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:i}=e;this._searchController=e;try{const n=await this.viewModel.search(t,{signal:i});if(this._searchController!==e)return;return this.activeMenu=n?.numResults?"none":"warning",this._searchController=null,n}catch(t){if(this._searchController!==e)return;return this._clearActiveMenu(),void(this._searchController=null)}}async suggest(t){this._cancelSuggest();const e=new AbortController,{signal:i}=e;this._suggestController=e;try{const n=await this.viewModel.suggest(t,null,{signal:i});if(this._suggestController!==e)return;return this._suggestController=null,n?.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),n}catch(t){return this._suggestController!==e||(this._suggestController=null),null}}render(){const{state:t}=this.viewModel,e={[P3.disabled]:"disabled"===t,[P3.widgetDisabled]:this.disabled};return V3("div",{class:this.classes(agt.base,P3.widget,e)},"loading"===t?this._renderLoader():this._renderContainer())}_renderSubmitButton(){const{messages:t,disabled:e}=this;return V3("button",{"aria-label":t.searchButtonTitle,bind:this,class:this.classes(agt.submitButton,P3.widgetButton),disabled:e,key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:t.searchButtonTitle,type:"button"},V3("span",{"aria-hidden":"true",class:ywt.search}))}_renderWarningMenu(){return V3("div",{class:this.classes(P3.menu,agt.warningMenu),key:"esri-search__error-menu"},V3("div",{class:agt.warningMenuBody},this._renderWarning()))}_renderSourceMenuButton(){const{messages:t,activeMenu:e,sourceMenuId:i,sourceMenuButtonId:n,disabled:s}=this,{activeSourceIndex:r,allSources:o}=this.viewModel;return o.length>1?V3("button",{afterCreate:rx,"aria-controls":i,"aria-expanded":("source"===e).toString(),"aria-haspopup":"true","aria-label":t.searchIn,bind:this,class:this.classes(agt.sourcesButton,P3.widgetButton),"data-node-ref":"_sourceMenuButtonNode",disabled:s,id:n,key:"esri-search__source-menu-button",onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,title:t.searchIn,type:"button"},V3("span",{"aria-hidden":"true",class:this.classes(ywt.downArrow,agt.sourcesButtonDown)}),V3("span",{"aria-hidden":"true",class:this.classes(ywt.upArrow,agt.sourcesButtonUp)}),V3("span",{class:agt.sourceName},this._getSourceName(r))):null}_renderSourcesList(){const{allSources:t,searchAllEnabled:e}=this.viewModel,{_activeMenuItemIndex:i,activeMenu:n,sourceMenuId:s,sourceMenuButtonId:r}=this,o="source"===n&&i>-1?this._buildId("source-item",i):null;return t.length>1?V3("ul",{afterCreate:rx,"aria-activedescendant":o,"aria-labelledby":r,bind:this,class:P3.menuList,"data-node-ref":"_sourceListNode",id:s,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,role:"menu",tabIndex:-1},e?this._renderSource(fwt.ALL_INDEX):null,t.map(((t,e)=>this._renderSource(e))).toArray()):null}_renderSourcesMenu(){const{allSources:t}=this.viewModel;return t.length>1?V3("div",{class:this.classes(P3.menu,agt.sourcesMenu),key:"esri-search__source-menu"},this._renderSourcesList()):null}_renderLoader(){const{messages:t,messagesCommon:e,disabled:i}=this;return V3("div",{class:P3.loader,key:"base-loader",tabIndex:i?-1:void 0},V3("span",{"aria-hidden":"true",class:P3.loaderAnimation}),V3("span",{class:ywt.fontFallbackText},t.searchButtonTitle),V3("span",{class:P3.loaderText},e.loading))}_renderContainer(){const{allSources:t,state:e}=this.viewModel,{activeMenu:i}=this,n={[agt.hasMultipleSources]:t.length>1,[agt.isLoading]:"loading"===e,[agt.isSearching]:"searching"===e,[agt.showWarning]:"warning"===i,[agt.showSources]:"source"===i,[agt.showSuggestions]:"suggestion"===i};return V3("div",{afterCreate:t=>{this._container=t,t.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:t=>{t.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes(n,agt.container),key:"base-container",tabIndex:-1},this._renderSourceMenuButton(),this._renderSourcesMenu(),this._renderInputContainer(),this._renderSubmitButton(),this._renderWarningMenu())}_renderClearButton(){return this.searchTerm?V3("button",{bind:this,class:this.classes(agt.clearButton,P3.widgetButton),disabled:this.disabled,key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},V3("span",{"aria-hidden":"true",class:ywt.close})):null}_renderLocationGroup(){const{messages:t,locationEnabled:e,displayedSearchTerm:i}=this,n=e&&!i,s="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return n?V3("ul",{class:this.classes(P3.menuList,agt.suggestionList,agt.suggestionListCurrentLocation),key:"esri-search__suggestion-list-current-location",role:"group"},V3("li",{"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),bind:this,class:this.classes(P3.menuItem,s?P3.menuItemFocus:null),"data-current-location-item":!0,id:this._buildId("suggestion-item",0),onclick:this._handleUseCurrentLocationClick,role:"option"},V3("span",{"aria-hidden":"true",class:ywt.locateCircled})," ",t.useCurrentLocation)):null}_renderInput(){const{activeMenu:t,locationEnabled:e,displayedSearchTerm:i,messages:n,suggestionsMenuId:s,inputId:r,_activeMenuItemIndex:o,disabled:a}=this,{maxInputLength:l,placeholder:u,searchTerm:c,suggestionCount:h}=this.viewModel,d=!(!(e&&!i)&&!h),f="suggestion"===t&&o>-1?this._buildId("suggestion-item",o):null;return V3("input",{afterCreate:rx,"aria-activedescendant":f,"aria-autocomplete":"list","aria-controls":d?s:null,"aria-expanded":(d&&"suggestion"===t).toString(),"aria-haspopup":"listbox","aria-label":n.searchButtonTitle,autocomplete:"off",bind:this,class:this.classes(P3.input,agt.input),"data-node-ref":"_inputNode",disabled:a,id:r,maxlength:l,onblur:this.blur,onclick:this._openSuggestionMenu,onfocus:this.focus,oninput:this._handleInputPaste,onkeyup:this._handleInputKeyup,onpaste:this._handleInputPaste,placeholder:u,role:"combobox",title:c?"":u,type:"text",value:c})}_renderForm(){return V3("form",{bind:this,class:agt.form,disabled:this.disabled,key:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this._renderInput())}_renderSuggestList(t){const{sourceIndex:e}=t,{results:i}=t,n=i?.length;return n?V3("ul",{class:this.classes(P3.menuList,agt.suggestionList),key:`esri-search__suggestion-list-${e}`,role:"group"},i?.map((t=>this._renderSuggestion(t,this._menuItemCount++)))):null}_renderSuggestionsGroup(){const{suggestions:t}=this.viewModel;return t?t.map((t=>[this._renderSuggestionHeader(t),this._renderSuggestList(t)])):[]}_renderSuggestionsMenu(){const{displayedSearchTerm:t,locationEnabled:e,suggestionsMenuId:i,inputId:n}=this,{suggestionCount:s}=this.viewModel,r=e&&!t||s;return this._menuItemCount=0,r?V3("div",{afterCreate:rx,"aria-labelledby":n,bind:this,class:this.classes(P3.menu,agt.suggestionsMenu),"data-node-ref":"_suggestionListNode",id:i,key:"esri-search__suggestions-menu",role:"listbox"},this._renderLocationGroup(),this._renderSuggestionsGroup()):null}_renderInputContainer(){return V3("div",{class:agt.inputContainer,key:"esri-search__input-container"},this._renderForm(),this._renderSuggestionsMenu(),this._renderClearButton())}_renderSuggestionHeader(t){const{allSources:e,activeSourceIndex:i}=this.viewModel,{sourceIndex:n}=t,s=t.results?.length,r=e.length>1&&i===fwt.ALL_INDEX;return s&&r?V3("div",{class:P3.menuHeader,key:`esri-search__suggestion-header-${n}`},this._getSourceName(n)):null}_renderSuggestion(t,e){const{_activeMenuItemIndex:i,viewModel:{searchTerm:n}}=this;if(!n)return;const s="suggestion"===this.activeMenu&&i===e;return V3("li",{"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===e).toString(),bind:this,class:this.classes(P3.menuItem,s?P3.menuItemFocus:null),"data-suggestion":t,id:this._buildId("suggestion-item",e),innerHTML:this._getSuggestResultHTML(t.text,n),key:`esri-search__suggestion_${e}`,onclick:this._handleSuggestionClick,role:"option"})}_renderSource(t){const{activeSourceIndex:e,searchAllEnabled:i}=this.viewModel,n={[P3.menuItemActive]:t===e,[P3.menuItemFocus]:"source"===this.activeMenu&&t===(i?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},s=i?t+1:t;return V3("li",{"aria-checked":(t===e).toString(),bind:this,class:this.classes(agt.source,P3.menuItem,n),"data-source-index":t,id:this._buildId("source-item",s),key:`esri-search__source-${t}`,onclick:this._handleSourceClick,role:"menuitemradio"},this._getSourceName(t))}_renderNoResultsWarning(t){const{messages:e}=this,i=t?Xg(e.noResultsFoundForValue,{value:`"${t}"`}):e.noResultsFound;return V3("div",{key:"esri-search__no_results"},V3("div",{class:agt.warningMenuHeader},e.noResults),V3("div",{class:agt.warningMenuText},i))}_renderEmptySearchWarning(){const{messages:t}=this;return V3("div",{key:"esri-search__empty-search"},V3("span",{"aria-hidden":"true",class:ywt.noticeTriangle}),V3("span",{class:agt.noValueText},t.emptyValue))}_renderLocateWarning(){const{messages:t}=this;return V3("div",{key:"esri-search__locate-error"},V3("span",{"aria-hidden":"true",class:ywt.noticeTriangle}),V3("span",{class:agt.noValueText},t.locateError))}_renderWarning(){const{displayedSearchTerm:t,_locateFailed:e}=this,{viewModel:i}=this;return e?this._renderLocateWarning():i.selectedSuggestion?.location||t?this._renderNoResultsWarning(t):this._renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(t,e){return`${this.id}-${t}${void 0===e?"":`-${e}`}`}_watchSourceChanges(){const{viewModel:{allSources:t}}=this,e="sources";this.removeHandles(e),t.forEach((t=>this.addHandles(ey((()=>t.name),(()=>this.scheduleRender())),e)))}_handleSourcesMenuToggleFocus(){"source"!==this.activeMenu&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){const t="source"===this.activeMenu;this.activeMenu=t?"none":"source",this.renderNow(),"source"===this.activeMenu&&this._sourceListNode?.focus()}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(t){const e=_wt(t.currentTarget);e&&(this._focus(),this.search(e))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const t=new AbortController,{signal:e}=t;this._searchController=t;(async()=>{try{const t=await this.viewModel.searchNearby({signal:e});this.activeMenu=t?.numResults?"none":"warning"}catch(t){this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(t){this._setSourceFromMenuItem(t.currentTarget)}_setSourceFromMenuItem(t){if(!t)return;const e=xwt(t);null!=e&&(this.viewModel.activeSourceIndex=e,this._clearActiveMenu(),this._sourceMenuButtonNode?.focus())}_cancelSuggest(){this._suggestController=Cn(this._suggestController)}_cancelSearch(){this._searchController=Cn(this._searchController),this._locateFailed=!1}_handleInputKeyup(t){const{key:e}=t;if(t.ctrlKey||t.metaKey||"Copy"===e||"ArrowLeft"===e||"ArrowRight"===e||"Shift"===e)return;if("Tab"===e||"Escape"===e||t.shiftKey&&"Tab"===e)return this._cancelSuggest(),void("Escape"===e&&this._clearActiveMenu());const i="Home"===e||"End"===e||"ArrowUp"===e||"ArrowDown"===e;if("Enter"===e&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const n=this._suggestionListNode?.getElementsByTagName("li");if(n?.length){if("suggestion"!==this.activeMenu&&this._openSuggestionMenu(),i)return t.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(e,n,this._suggestionListNode);const s=n[this._activeMenuItemIndex];if("Enter"===e&&s){const t=_wt(s);return void(t?(this._focus(),this.search(t)):Mwt(s)&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}_handleItemNavigation(t,e,i){const n=this._activeMenuItemIndex;"Home"===t&&(this._activeMenuItemIndex=0),"End"===t&&(this._activeMenuItemIndex=e.length-1),"ArrowUp"===t&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?e.length-1:this._activeMenuItemIndex-1),"ArrowDown"===t&&(this._activeMenuItemIndex=this._activeMenuItemIndex===e.length-1?0:this._activeMenuItemIndex+1),n!==this._activeMenuItemIndex&&i&&Twt(e[this._activeMenuItemIndex],i)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(t){const e=t.target;this.viewModel.searchTerm!==e.value&&(this.viewModel.searchTerm=e.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(t){const{key:e}=t;if(cx(e)){t.preventDefault();const e=this._sourceListNode?.getElementsByTagName("li"),i=e?.[this._activeMenuItemIndex];this._setSourceFromMenuItem(i)}else"ArrowUp"!==e&&"ArrowDown"!==e&&"End"!==e&&"Home"!==e||t.preventDefault()}_handleSourceMenuKeyup(t){const{key:e}=t,i="ArrowUp"===e||"ArrowDown"===e||"End"===e||"Home"===e;if(i&&t.preventDefault(),"Escape"===e)return this._clearActiveMenu(),void this._sourceMenuButtonNode?.focus();const n=this._sourceListNode?.getElementsByTagName("li");return n&&0!==n.length&&i?("source"!==this.activeMenu&&(this.activeMenu="source"),void this._handleItemNavigation(e,n,this._sourceListNode?.parentElement)):void 0}_focus(t){this.focus(),t&&(this.activeMenu=t)}_formSubmit(t){t.preventDefault(),-1===this._activeMenuItemIndex&&this.search()}_getSourceName(t){const{messages:e}=this,i=this.viewModel,{allSources:n}=i,s=n.at(t);return t===fwt.ALL_INDEX?e.all:s&&s.name||e.untitledSource}_getSuggestResultHTML(t,e){return t?wwt.test(t)?t:bwt(t,e):this.messages.untitledResult}};function _wt(t){return t?.["data-suggestion"]}function xwt(t){return t?.["data-source-index"]}function Mwt(t){return!!t?.["data-current-location-item"]}function Twt(t,e){const i=t.getBoundingClientRect(),n=e.getBoundingClientRect(),s=i.top+i.height,r=n.top+n.height,o=i.top,a=n.top;(s>r||o<a)&&t.scrollIntoView({block:"end"})}r([Je()],Swt.prototype,"_activeMenuItemIndex",void 0),r([Je()],Swt.prototype,"displayedSearchTerm",null),r([Je({readOnly:!0})],Swt.prototype,"inputId",null),r([Je({readOnly:!0})],Swt.prototype,"suggestionsMenuId",null),r([Je({readOnly:!0})],Swt.prototype,"sourceMenuId",null),r([Je({readOnly:!0})],Swt.prototype,"sourceMenuButtonId",null),r([Je()],Swt.prototype,"activeMenu",void 0),r([Je({readOnly:!0})],Swt.prototype,"activeSource",null),r([Je()],Swt.prototype,"activeSourceIndex",null),r([Je()],Swt.prototype,"allPlaceholder",null),r([Je({readOnly:!0})],Swt.prototype,"allSources",null),r([Je()],Swt.prototype,"autoNavigate",null),r([Je()],Swt.prototype,"autoSelect",null),r([Je({readOnly:!0})],Swt.prototype,"defaultSources",null),r([Je()],Swt.prototype,"disabled",void 0),r([Je()],Swt.prototype,"goToOverride",null),r([Je()],Swt.prototype,"icon",null),r([Je()],Swt.prototype,"includeDefaultSources",null),r([Je()],Swt.prototype,"label",null),r([Je()],Swt.prototype,"locationEnabled",null),r([Je()],Swt.prototype,"maxResults",null),r([Je()],Swt.prototype,"maxSuggestions",null),r([Je(),z3("esri/widgets/Search/t9n/Search")],Swt.prototype,"messages",void 0),r([Je(),z3("esri/t9n/common")],Swt.prototype,"messagesCommon",void 0),r([Je()],Swt.prototype,"minSuggestCharacters",null),r([Je()],Swt.prototype,"popupEnabled",null),r([Je()],Swt.prototype,"popupTemplate",null),r([Je()],Swt.prototype,"portal",null),r([Je()],Swt.prototype,"resultGraphic",null),r([Je()],Swt.prototype,"resultGraphicEnabled",null),r([Je({readOnly:!0})],Swt.prototype,"results",null),r([Je()],Swt.prototype,"searchAllEnabled",null),r([Je()],Swt.prototype,"searchTerm",null),r([Je({readOnly:!0})],Swt.prototype,"selectedResult",null),r([Je()],Swt.prototype,"sources",null),r([Je({readOnly:!0})],Swt.prototype,"suggestions",null),r([Je()],Swt.prototype,"suggestionsEnabled",null),r([Je()],Swt.prototype,"view",null),r([gwt(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),Je({type:fwt})],Swt.prototype,"viewModel",void 0),Swt=r([ln("esri.widgets.Search")],Swt);const Awt=Swt;const Iwt="esri-layer-list",kwt=`${Iwt}__item`,Cwt={base:Iwt,actionMenu:`${Iwt}__action-menu`,actionGroup:`${Iwt}__action-group`,filterNoResults:`${Iwt}__filter-no-results`,item:kwt,itemActive:`${kwt}--active`,itemContent:`${kwt}-content`,itemContentBottom:`${kwt}-content-bottom`,itemMessage:`${kwt}-message`,itemInvisible:`${kwt}--invisible`,itemActionIcon:`${kwt}-action-icon`,itemActionImage:`${kwt}-action-image`,itemTemporaryIcon:`${kwt}-temporary-icon`,itemTableIcon:`${kwt}-table-icon`,itemCatalogIcon:`${kwt}-catalog-icon`,statusIndicator:`${Iwt}__status-indicator`,publishing:`${Iwt}__publishing`,updating:`${Iwt}__updating`,connectionStatus:`${Iwt}__connection-status`,connectionStatusConnected:`${Iwt}__connection-status--connected`,visibleToggle:`${Iwt}__visible-toggle`,visibleIcon:`${Iwt}__visible-icon`};function Ewt(t){return t.icon?t.icon:"image"in t&&t.image||t.className?void 0:"question"}function jwt(t){return t?{backgroundImage:`url(${t})`}:{}}function Owt({action:t,feature:e}){const i=e?.attributes,n="image"in t?t.image:void 0;return n&&i?Xg(n,i):n??""}const Rwt={hide:"hide",hideChildren:"hide-children"},Lwt=10,Nwt=2;function Pwt({exclusive:t,visible:e,visibilityAppearance:i}){const n="checkbox"===i;return e?t?"circle-f":n?"check-square-f":"view-visible":t?"circle":n?"square":"view-hide"}function Fwt({connectionStatus:t,publishing:e}){return t?"connected"===t?"beacon":"offline":e?"square":"bullet-point"}function Dwt(t){return t?.listMode===Rwt.hideChildren}function $wt(t){return t?.listMode??void 0}function zwt(t){return null!=t&&"minScale"in t&&null!=t.minScale?t.minScale:void 0}function Uwt(t){return null!=t&&"maxScale"in t&&null!=t.maxScale?t.maxScale:void 0}function Bwt(t){if(!t)return"inherited";const e=Kwt(Ywt(t)?t.layer:t);return null!=e?e?"independent":"inherited":"visibilityMode"in t&&null!=t.visibilityMode?t.visibilityMode:"independent"}function Gwt(t){if(t&&(!("type"in t)||"wmts"!==t.type))return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function Vwt(t){const e=(t?.layer&&Ywt(t.layer)?t.layer.layer:void 0)??t?.layer;return!!e&&("catalog"!==e.type&&(Qwt(e)??!0))}function qwt(t){return $wt(t)!==Rwt.hide}function Hwt(t,e){if(!t||null==e||isNaN(e))return!1;const i=zwt(t),n=Uwt(t),s=null!=i&&!isNaN(i)&&i>0&&e>i,r=null!=n&&!isNaN(n)&&n>0&&e<n;return s||r}function Wwt(t,e){t?.sort(((t,i)=>{const n="uid"in t?e.indexOf(t.uid):-1,s="uid"in i?e.indexOf(i.uid):-1;return n>s?-1:n<s?1:0}))}function Zwt(t,e){const i=t?.layer;if(!i)return;const n=Gwt(i);if(!n)return;let s;"layers"===n&&"layers"in i?s=i.layers:"sublayers"===n&&"sublayers"in i&&(s=i.sublayers),Wwt(s,e)}function Jwt(t){const e=t?.layer;return e&&"layers"in e?e.layers:null}function Ywt(t){return null!=t&&"layer"in t&&null!=t.layer}function Kwt(t){const e=Xwt(t);return null!=e&&"supportsSublayerVisibility"in e?e.supportsSublayerVisibility:void 0}function Qwt(t){const e=Xwt(t);return null!=e&&"supportsDynamicLayers"in e?e.supportsDynamicLayers:void 0}function Xwt(t){return t&&"capabilities"in t&&null!=t.capabilities&&"exportMap"in t.capabilities?t.capabilities.exportMap:void 0}function tbt(t){return t?.["data-item"]}function ebt(t){return t?.getAttribute("data-layer-type")}function ibt({children:t,error:e,incompatible:i}){return!!t?.filter((t=>!t.hidden)).length&&!e&&!i}function nbt(t){for(const e of t)for(const t of e)if("button"===t.type||"toggle"===t.type)return t}var sbt;let rbt=sbt=class extends A3{constructor(t){super(t),this.dragEnabled=!1,this.listModeDisabled=!1,this.parent=null,this.parentTitles=null,this.viewModel=null,this._onActionMenuOpen=t=>{this.item.actionsOpen=t.target.open},this._setTooltipReference=t=>{this.onTooltipReferenceChange?.(this.item.layer.uid,t)},this._removeTooltipReference=()=>{this.onTooltipReferenceChange?.(this.item.layer.uid,null)}}loadDependencies(){return o3({"action-group":()=>import("./p-1c563561.js"),"action-menu":()=>import("./p-2add2282.js"),action:()=>import("./p-255edeba.js"),icon:()=>import("./p-a8caa0f1.js"),"list-item":()=>import("./p-0b8be892.js"),list:()=>import("./p-4bdb39fa.js"),notice:()=>import("./p-cebdc047.js")})}render(){const t=this.parentTitles??[],{_title:e,item:i,activeItem:n,selectedDragItemLayerUid:s,selectionMode:r,selectedItems:o,messages:a,parent:l,css:u}=this,c="visibleAtCurrentTimeExtent"in i&&"layerInvisibleAtTime"in a&&!i.visibleAtCurrentTimeExtent?`${e} (${a.layerInvisibleAtTime})`:"visibleAtCurrentScale"in i&&"layerInvisibleAtScale"in a&&!i.visibleAtCurrentScale?`${e} (${a.layerInvisibleAtScale})`:e,h="parent"in i&&"catalog"===i.parent?.layer?.type,{layer:d}=i,f="visibleAtCurrentScale"in i&&!i.visibleAtCurrentScale||"visibleAtCurrentTimeExtent"in i&&!i.visibleAtCurrentTimeExtent;return V3("calcite-list-item",{afterCreate:t=>this._focusSelectedDragEl(t,i),afterUpdate:t=>this._focusSelectedDragEl(t,i),class:this.classes(u.item,"itemActive"in u&&{[u.itemActive]:n===i}),"data-item":i,"data-layer-id":d.id,dragDisabled:!i.sortable||h,dragSelected:d.uid===s,id:d.uid,key:`list-item-${d.uid}`,label:e,metadata:{parentTitles:t,_title:e},open:"open"in i&&i.open,selected:"none"!==r&&o.includes(i),title:c,unavailable:f,value:d.uid,onCalciteListItemDragHandleChange:t=>this._handleCalciteListItemDragHandleChange(t,i),onCalciteListItemSelect:t=>"visible"in i&&this._handleCalciteListItemSelect(t,i,l),onCalciteListItemToggle:t=>"open"in i&&this._handleCalciteListItemToggle(t,i)},this._renderedCatalogFootprintIcon,this._renderedCatalogDynamicIcon,V3("div",{class:this.classes(u.itemContent,"itemInvisible"in u&&{[u.itemInvisible]:f}),slot:"content"},e),this._renderedItemStatus,this._renderedItemToggle,this._renderedCatalogSelectNode,this._renderedItemTemporaryIcon,this._renderedChildList,this._renderedItemMessage,this._renderedPanel,this._renderedPanelAction,this._renderedActions)}get _title(){const{messages:t}=this;return this.item.title||("untitledTable"in t?t.untitledTable:t.untitledLayer)}get _renderedItemStatus(){const{item:t,parent:e,visibleElements:i,css:n}=this;if(!i.statusIndicators)return null;const{publishing:s}=t,r="updating"in t&&t.updating&&!e,o="connectionStatus"in t?t.connectionStatus:void 0,a=!!o;return V3("calcite-icon",{class:this.classes(n.statusIndicator,{[n.publishing]:s},"updating"in n&&{[n.updating]:r},"connectionStatus"in n&&{[n.connectionStatus]:a},"connectionStatusConnected"in n&&{[n.connectionStatusConnected]:a&&"connected"===o}),icon:Fwt({connectionStatus:o,publishing:s}),key:"layer-item-status",scale:"s",slot:"content-end"})}get _renderedItemTemporaryIcon(){const{item:t,visibleElements:e,css:i}=this,{layer:n}=t,s="temporaryLayerIndicators"in e&&e.temporaryLayerIndicators,r="temporaryTableIndicators"in e&&e.temporaryTableIndicators,o="persistenceEnabled"in n&&(HA(n)||!n.persistenceEnabled);return(s||r)&&o?V3("calcite-icon",{class:i.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"actions-start",title:this.messages.temporary}):null}get _renderedItemToggle(){const{item:t,parent:e,messages:i,visibilityAppearance:n,css:s}=this;if(!("visible"in t&&"layerVisibility"in i&&"visibleToggle"in s&&n))return null;const{visible:r}=t,o=e?.visibilityMode;if("inherited"===o)return null;const a=Pwt({visible:r,exclusive:"exclusive"===o,visibilityAppearance:n}),l="checkbox"===n,u=i.layerVisibility;return V3("calcite-action",{appearance:"transparent",class:s.visibleToggle,icon:l?a:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(t,e),scale:"s",slot:l?"actions-start":"actions-end",text:u,title:u},l?null:V3("calcite-icon",{class:this.classes({[s.visibleIcon]:"exclusive"!==o&&r}),icon:a,scale:"s"}))}get _renderedPanel(){const{panel:t}=this.item;return!t?.open||t.disabled||t.flowEnabled?null:V3("div",{class:this.css.itemContentBottom,key:`content-panel-${t.uid}`,slot:"content-bottom"},t.render())}get _renderedPanelAction(){const{panel:t}=this.item;if(!t?.visible)return null;const{open:e,title:i,disabled:n}=t;return V3("calcite-action",{active:e,appearance:"transparent",disabled:n,icon:Ewt(t),key:`action-${t.uid}`,onclick:()=>this._togglePanel(t),scale:"s",slot:"actions-end",text:i??"",title:i??void 0},this._renderFallbackIcon(t))}get _renderedActions(){switch(this._actionsCount){case 0:return null;case 1:return this._singleAction;default:return this._renderedActionMenu}}get _renderedActionMenu(){const{item:t,messagesCommon:e}=this,i=e.options;return V3("calcite-action-menu",{appearance:"transparent",key:"item-action-menu",label:e.menu,open:t.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:this._onActionMenuOpen},V3("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:i,title:i}),this._renderedActionMenuContent)}get _renderedActionMenuContent(){return this._filteredSections.toArray().map((t=>V3("calcite-action-group",{key:`action-section-${t.uid}`},t.toArray().map((t=>this._renderAction({action:t,textEnabled:!0}))))))}get _renderedCatalogFootprintIcon(){const{css:t}=this,e="catalog-footprint"===this.item.layer?.type;return"itemCatalogIcon"in t&&e?V3("calcite-icon",{class:t.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null}get _renderedCatalogDynamicIcon(){const{css:t}=this,e="catalog-dynamic-group"===this.item.layer?.type;return"itemCatalogIcon"in t&&e?V3("calcite-icon",{class:t.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null}get _renderedCatalogSelectNode(){const{_title:t,item:e,visibleElements:i}=this;if(!("visible"in e))return;const{layer:n}=e,s="catalog-dynamic-group"===n?.type;return"catalogLayerList"in i&&i.catalogLayerList&&s?V3("calcite-action",{appearance:"transparent",disabled:!n.visible,icon:"chevron-right",iconFlipRtl:!0,onclick:()=>this._triggerOnCatalogOpen(e),scale:"s",slot:"actions-end",text:t}):null}get _renderedChildList(){const{dragEnabled:t,item:e,rootGroupUid:i,listModeDisabled:n,selectionMode:s}=this;if(!("visible"in e))return;const r=[...this.parentTitles??[],e.title],{children:o,layer:a}=e,l="catalog-dynamic-group"!==a?.type&&ibt(e),u=!n&&Dwt(a);return l||!u&&!l&&t&&"group"===a?.type?V3("calcite-list",{canPull:t=>!!this.canMove&&this.canMove(t,"pull"),canPut:t=>!!this.canMove&&this.canMove(t,"put"),"data-item":e,"data-layer-type":i,dragEnabled:!!t&&(e.childrenSortable&&Vwt(e)),group:`${i}-${a.uid}`,key:`child-list-${a.uid}`,selectionAppearance:"border",selectionMode:s},o?.filter((t=>!t.hidden)).toArray().map((t=>this._renderItem(t,e,r))),this._renderedTablesItem):null}get _hasTables(){const{layerTablesEnabled:t}=this,e=this.item.layer;if(!t||!e)return!1;switch(e.type){case"knowledge-graph":return t.includes(e.type)&&!!e.tables?.length;case"map-image":case"tile":return t.includes(e.type)&&!!e.subtables?.length;default:return!1}}get _renderedTablesItem(){const{item:t,messages:e,css:i}=this,{layer:n}=t;return"itemTableIcon"in i&&"visible"in t&&"tables"in e&&this._hasTables?V3("calcite-list-item",{class:i.item,"data-layer-id":n.id,dragDisabled:!0,key:`list-item-table-list-tables-${n.uid}`,title:e.tables,onCalciteListItemSelect:()=>this._triggerOnTablesOpen(t)},V3("div",{class:i.itemContent,slot:"content"},e.tables),V3("calcite-icon",{class:i.itemTableIcon,icon:"table",scale:"s",slot:"content-start"}),V3("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"})):null}get _renderedItemMessage(){const{item:t,messages:e,css:i}=this;return t.error?V3("div",{class:i.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},V3("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},V3("div",{slot:"message"},"tableError"in e?e.tableError:e.layerError))):"incompatible"in t&&t.incompatible&&"layerIncompatible"in e?V3("div",{class:i.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},V3("calcite-notice",{afterCreate:this._setTooltipReference,afterRemoved:this._removeTooltipReference,bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},V3("div",{slot:"message"},e.layerIncompatible))):null}get _singleAction(){return this._renderAction({action:nbt(this._filteredSections),textEnabled:!1})}get _filteredSections(){return this.item.actionsSections.map((t=>t.filter((t=>t.visible))))}get _actionsCount(){return this.item.actionsSections.reduce(((t,e)=>t+e.length),0)}_renderAction(t){const{item:e}=this,{action:i,textEnabled:n}=t;if(!i)return null;const{active:s,disabled:r,title:o,type:a,indicator:l}=i;return V3("calcite-action",{active:"toggle"===a&&i.value,appearance:"transparent",disabled:r,icon:Ewt(i),indicator:l,key:`action-${i.uid}`,loading:s,onclick:()=>this._triggerAction(e,i),scale:"s",slot:n?void 0:"actions-end",text:o??"",textEnabled:n,title:o??void 0},this._renderFallbackIcon(i))}_renderFallbackIcon(t){const{css:e}=this,{className:i,icon:n}=t;if(n)return null;const s="image"in t?t.image:void 0,r={[e.itemActionIcon]:!!i,[e.itemActionImage]:!!s};return i&&(r[i]=!0),s||i?V3("span",{"aria-hidden":"true",class:this.classes(e.itemActionIcon,r),key:"icon",styles:jwt(s)}):null}_renderItem(t,e,i=[]){return V3(sbt,{activeItem:this.activeItem,canMove:this.canMove,css:this.css,dragEnabled:this.dragEnabled,item:t,key:`layerListItem-${t.layer.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:e,parentTitles:i,rootGroupUid:this.rootGroupUid,selectedDragItemLayerUid:this.selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this.onAction,onCatalogOpen:this.onCatalogOpen,onPanelOpen:this.onPanelOpen,onSelectedDragItemLayerUidChange:this.onSelectedDragItemLayerUidChange,onTablesOpen:this.onTablesOpen,onTooltipReferenceChange:this.onTooltipReferenceChange})}_triggerAction(t,e){e&&t&&("toggle"===e.type&&(e.value=!e.value),this.onAction(e,t))}_triggerOnTablesOpen(t){t&&this.onTablesOpen&&this.onTablesOpen(t)}_triggerOnCatalogOpen(t){t&&this.onCatalogOpen?.(t)}_focusSelectedDragEl(t,e){this.selectedDragItemLayerUid===e.layer.uid&&hx(t)}_handleCalciteListItemToggle(t,e){t.stopPropagation(),e.open=t.target.open}_handleCalciteListItemDragHandleChange(t,e){t.stopPropagation();const i=t.target.dragSelected;this.onSelectedDragItemLayerUidChange?.(i?e.layer.uid:null)}_handleCalciteListItemSelect(t,e,i){tbt(t.target)===e&&"none"===this.selectionMode&&"inherited"!==i?.visibilityMode&&this._toggleVisibility(e,i)}_togglePanel(t){t.open=!t.open,t.open&&this.onPanelOpen()}_toggleVisibility(t,e){if(!t)return;const i=e?.visibilityMode;"exclusive"===i&&t.visible||(t.visible=!t.visible)}};rbt.vnodeSelector="calcite-list-item",r([Je()],rbt.prototype,"activeItem",void 0),r([Je()],rbt.prototype,"canMove",void 0),r([Je()],rbt.prototype,"css",void 0),r([Je()],rbt.prototype,"dragEnabled",void 0),r([Je()],rbt.prototype,"item",void 0),r([Je()],rbt.prototype,"layerTablesEnabled",void 0),r([Je()],rbt.prototype,"listModeDisabled",void 0),r([Je()],rbt.prototype,"messages",void 0),r([Je()],rbt.prototype,"messagesCommon",void 0),r([Je()],rbt.prototype,"onAction",void 0),r([Je()],rbt.prototype,"onPanelOpen",void 0),r([Je()],rbt.prototype,"onCatalogOpen",void 0),r([Je()],rbt.prototype,"onTablesOpen",void 0),r([Je()],rbt.prototype,"onSelectedDragItemLayerUidChange",void 0),r([Je()],rbt.prototype,"onTooltipReferenceChange",void 0),r([Je()],rbt.prototype,"parent",void 0),r([Je()],rbt.prototype,"parentTitles",void 0),r([Je()],rbt.prototype,"rootGroupUid",void 0),r([Je()],rbt.prototype,"selectionMode",void 0),r([Je()],rbt.prototype,"selectedItems",void 0),r([Je()],rbt.prototype,"selectedDragItemLayerUid",void 0),r([Je()],rbt.prototype,"visibleElements",void 0),r([Je()],rbt.prototype,"visibilityAppearance",void 0),r([Je()],rbt.prototype,"_title",null),r([Je()],rbt.prototype,"_renderedItemStatus",null),r([Je()],rbt.prototype,"_renderedItemTemporaryIcon",null),r([Je()],rbt.prototype,"_renderedItemToggle",null),r([Je()],rbt.prototype,"_renderedPanel",null),r([Je()],rbt.prototype,"_renderedPanelAction",null),r([Je()],rbt.prototype,"_renderedActions",null),r([Je()],rbt.prototype,"_renderedActionMenu",null),r([Je()],rbt.prototype,"_renderedActionMenuContent",null),r([Je()],rbt.prototype,"_renderedCatalogFootprintIcon",null),r([Je()],rbt.prototype,"_renderedCatalogDynamicIcon",null),r([Je()],rbt.prototype,"_renderedCatalogSelectNode",null),r([Je()],rbt.prototype,"_renderedChildList",null),r([Je()],rbt.prototype,"_hasTables",null),r([Je()],rbt.prototype,"_renderedTablesItem",null),r([Je()],rbt.prototype,"_renderedItemMessage",null),r([Je()],rbt.prototype,"_singleAction",null),r([Je()],rbt.prototype,"_filteredSections",null),r([Je()],rbt.prototype,"_actionsCount",null),rbt=sbt=r([ln("esri.widgets.LayerList.LayerListItem")],rbt);const obt=rbt;function abt(t){return null!=t&&"object"==typeof t&&"2d"===t.type&&"linkchart"===t.view2dType}var lbt;let ubt=lbt=class extends zR{constructor(t){super(t),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new lbt({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};r([Je()],ubt.prototype,"displayValueEnabled",void 0),r([Je()],ubt.prototype,"max",void 0),r([Je()],ubt.prototype,"min",void 0),r([Je()],ubt.prototype,"step",void 0),r([Je()],ubt.prototype,"value",void 0),ubt=lbt=r([ln("esri.support.actions.ActionSlider")],ubt);const cbt=ubt;function hbt(t){return t&&"function"==typeof t.render}function dbt(t){return t&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}let fbt=class extends(dC(A3)){constructor(t,e){super(t,e),this._legend=null,this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([ey((()=>this._canCreateLegend),(()=>this._createLegend()),dy),ey((()=>[this._legend,this._legendOptions]),(()=>this._updateLegend()),dy)])}destroy(){this._legend=An(this._legend)}get _canCreateLegend(){const{content:t,listItem:e}=this;if(!e)return!1;const i="legend";return t===i||null!=t&&!!Array.isArray(t)&&t.includes(i)}get _legendOptions(){const{listItem:t,_legendLayerInfo:e}=this,i=t?.view;return e&&i?{view:i,layerInfos:[e]}:{}}get _legendLayerInfo(){const t=this.listItem?.layer;if(!t||"subtype-sublayer"===t.type)return null;const e=Ywt(t)?t:null,i=t?.parent,n=null!=i&&"type"in i&&"map-image"===i.type?e?.source:null,s="";return n&&i?{layer:i,title:s,sublayerIds:[n.mapLayerId]}:{layer:t,title:s}}get disabled(){const{listItem:t,_legend:e,content:i}=this;return!t||!(Array.isArray(i)&&i.length>1)&&(!!e&&(!e.activeLayerInfos?.length||!t.visibleAtCurrentScale||!t.visible))}set disabled(t){this._overrideIfSome("disabled",t)}get icon(){const{image:t}=this,e=this._getFirstWidget();return this._get("icon")??(!t&&e?e.icon:null)}set icon(t){this._overrideIfSome("icon",t)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(t){this._override("title",t)}render(){return V3("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(t){const{_legend:e,disabled:i,open:n}=this;return t&&!i&&n?"legend"===t&&e?V3("div",{key:"legend-widget"},e.render()):"string"==typeof t?V3("div",{innerHTML:t,key:t}):hbt(t)?V3("div",{key:"content-widget"},t.render()):t instanceof HTMLElement?V3("div",{afterCreate:this._attachToNode,bind:t,key:"content-element"}):null:null}_renderContents(){const{content:t,open:e}=this;return e?Array.isArray(t)?t.map((t=>this._renderContent(t))):this._renderContent(t):null}async _createLegend(){if(An(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:t}=await Promise.resolve().then((function(){return wIt})),e=new t(this._legendOptions);this._legend=e}_attachToNode(t){t.appendChild(this)}_updateLegend(){const t=this._legend;t&&t.set(this._legendOptions)}_getWidget(t){return"legend"===t?this._legend:hbt(t)?t:null}_getFirstWidget(){const{content:t}=this;return Array.isArray(t)?t.map((t=>this._getWidget(t))).find((t=>t)):this._getWidget(t)}};r([Je()],fbt.prototype,"_legend",void 0),r([Je()],fbt.prototype,"_canCreateLegend",null),r([Je()],fbt.prototype,"_legendOptions",null),r([Je()],fbt.prototype,"_legendLayerInfo",null),r([Je()],fbt.prototype,"className",void 0),r([Je()],fbt.prototype,"content",void 0),r([Je()],fbt.prototype,"disabled",null),r([Je()],fbt.prototype,"flowEnabled",void 0),r([Je()],fbt.prototype,"icon",null),r([Je()],fbt.prototype,"image",void 0),r([Je()],fbt.prototype,"listItem",void 0),r([Je()],fbt.prototype,"open",void 0),r([Je()],fbt.prototype,"title",null),r([Je()],fbt.prototype,"visible",void 0),fbt=r([ln("esri.widgets.LayerList.ListItemPanel")],fbt);const pbt=fbt;var mbt;const ybt=Vm.ofType({key:"type",defaultKeyValue:"button",base:zR,typeMap:{button:GR,toggle:HR,slider:cbt}}),gbt=Vm.ofType(ybt),vbt="layer",wbt="child-list-mode",bbt="hide";let Sbt=mbt=class extends(dC(ao)){constructor(t){super(t),this.actionsSections=new gbt,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(Vm.ofType(mbt)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.panel=null,this.parent=null,this.view=null}initialize(){if(this.addHandles([ey((()=>[this.layer,this.layer?.listMode,this.listModeDisabled]),(()=>this._watchLayerProperties(this.layer)),dy),ey((()=>this.checkPublishStatusEnabled),(t=>this._updateChildrenPublishing(t)),dy),ey((()=>this.view),(t=>this._updateChildrenView(t)),dy),ey((()=>this.panel),(t=>this._setListItemOnPanel(t)),dy)]),"function"==typeof this.listItemCreatedFunction){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){this.panel?.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:t,publishing:e}=this;if(!e&&t&&"connectionStatus"in t)return t.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const{layerView:t}=this;return!(!t||!("spatialReferenceSupported"in t))&&!t.spatialReferenceSupported}get layerView(){const{layer:t,view:e}=this;if(!t||!e||"sublayer"===t.type)return null;const i="subtype-sublayer"===t.type?t.parent:t;return e.allLayerViews.find((t=>t.layer===i))??null}castPanel(t){return this.panel?.open&&!t.hasOwnProperty("open")&&(t.open=!0),t?new pbt(t):null}get sortable(){return"knowledge-graph-sublayer"!==this.layer?.type&&this._get("sortable")}set sortable(t){this._set("sortable",t)}get title(){const t=Ne(this,"layer.layer");return(!t||t&&Ne(this,"layer.layer.loaded"))&&Ne(this,"layer.title")||Ne(this,"layer.attributes.title")||""}set title(t){this._override("title",t)}get publishing(){const{layer:t,checkPublishStatusEnabled:e}=this;return e&&t&&"publishingInfo"in t&&"publishing"===t.publishingInfo?.status}get updating(){const{layerView:t,connectionStatus:e,layer:i,publishing:n}=this;return!n&&!e&&(t?t.updating:"loading"===i?.loadStatus||!1)}get visible(){return this.layer?.visible}set visible(t){const e=this.layer;e&&(e.visible=t)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!Hwt(this.layer,this.view?.scale)}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return Bwt(this.layer)}clone(){return new mbt({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(t){t&&(t.listItem=this)}_updateChildrenPublishing(t){const e=this.children;e&&e.forEach((e=>e.checkPublishStatusEnabled=t))}_updateChildrenView(t){const e=this.children;e&&e.forEach((e=>e.view=t))}_createChildren(t){const{listModeDisabled:e,children:i}=this,n=t.filter((t=>!i.some((e=>e.layer===t))));i.addMany(this._createChildItems(n,e))}_destroyChildren(t){const{children:e}=this,i=e.filter((e=>!t.includes(e.layer)));e.destroyMany(i)}_sortChildren(t){this.children.sort(((e,i)=>t.indexOf(i.layer)-t.indexOf(e.layer)))}_destroyAllChildren(){this.removeHandles(wbt),this.children.destroyAll()}_watchChildLayerListMode(t){this.removeHandles(wbt),this.listModeDisabled||this.addHandles(t.toArray().map((e=>ey((()=>e.listMode),(()=>this._compileChildren(t))))),wbt)}_compileChildren(t){const e=this.listModeDisabled?t:t?.filter((t=>$wt(t)!==bbt));e?.length?(this._createChildren(e),this._destroyChildren(e),this._sortChildren(e),this._watchChildLayerListMode(t)):this._destroyAllChildren()}_watchSublayerChanges(t){t&&this.addHandles(t.on("change",(()=>this._compileChildren(t))),vbt)}_initializeChildLayers(t){this._compileChildren(t),this._watchSublayerChanges(t)}_createChildItems(t,e){return t.map((t=>e||qwt(t)?new mbt({layer:t,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null)).filter(C).reverse()}_watchLayerProperties(t){if(this.removeHandles(vbt),this.removeHandles(wbt),!t)return;if("hide-children"===(!this.listModeDisabled&&$wt(t)))return void this.children.destroyAll();const e=Gwt(t);e&&this.addHandles(ey((()=>t[e]),(i=>{t.hasOwnProperty(e)&&this._initializeChildLayers(i)}),dy),vbt)}};r([Je({type:gbt})],Sbt.prototype,"actionsSections",void 0),r([Je()],Sbt.prototype,"actionsOpen",void 0),r([Je()],Sbt.prototype,"checkPublishStatusEnabled",void 0),r([Je({type:Vm})],Sbt.prototype,"children",void 0),r([Je()],Sbt.prototype,"childrenSortable",void 0),r([Je({readOnly:!0})],Sbt.prototype,"connectionStatus",null),r([Je({readOnly:!0})],Sbt.prototype,"error",null),r([Je()],Sbt.prototype,"hidden",void 0),r([Je({readOnly:!0})],Sbt.prototype,"incompatible",null),r([Je()],Sbt.prototype,"layer",void 0),r([Je({readOnly:!0})],Sbt.prototype,"layerView",null),r([Je()],Sbt.prototype,"listItemCreatedFunction",void 0),r([Je({nonNullable:!0})],Sbt.prototype,"listModeDisabled",void 0),r([Je()],Sbt.prototype,"open",void 0),r([Je({type:pbt})],Sbt.prototype,"panel",void 0),r([Ah("panel")],Sbt.prototype,"castPanel",null),r([Je()],Sbt.prototype,"parent",void 0),r([Je({value:!0})],Sbt.prototype,"sortable",null),r([Je()],Sbt.prototype,"title",null),r([Je({readOnly:!0})],Sbt.prototype,"publishing",null),r([Je({readOnly:!0})],Sbt.prototype,"updating",null),r([Je()],Sbt.prototype,"view",void 0),r([Je()],Sbt.prototype,"visible",null),r([Je({readOnly:!0})],Sbt.prototype,"visibleAtCurrentScale",null),r([Je({readOnly:!0})],Sbt.prototype,"visibleAtCurrentTimeExtent",null),r([Je({readOnly:!0})],Sbt.prototype,"visibilityMode",null),Sbt=mbt=r([ln("esri.widgets.LayerList.ListItem")],Sbt);const _bt=Sbt;const xbt={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},Mbt="hide",Tbt=Vm.ofType(_bt);let Abt=class extends Tm.EventedAccessor{constructor(t){super(t),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new Tbt,this.view=null}initialize(){this.addHandles([ey((()=>!0===this.view?.ready),(()=>this._viewHandles()),dy),ey((()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._recompileList())),ey((()=>abt(this.view)?this.view.inGeographicLayout:null),(()=>this._compileList()))],xbt.view)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:t}=this;return t?.ready?"ready":t?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten((t=>t.children)).length}triggerAction(t,e){t&&!t.disabled&&this.emit("trigger-action",{action:t,item:e})}moveListItem(t,e,i,n){const s=t?.layer;if(!s||"subtype-sublayer"===s.type||"sublayer"===s.type)return;const r=this.view?.map?.layers,o=e?Jwt(e):r,a=i?Jwt(i):r;if(!o||!a)return;const{operationalItems:l}=this,u=e?.children||l,c=i?.children||l,h=a.length-n;t.parent=i||null,u.remove(t),o.remove(s),c.includes(t)||c.add(t,h),a.includes(s)||a.add(s,h),this._compileList()}_createLayerViewHandles(t){this.removeHandles(xbt.layerViews),this._compileList(),t&&this.addHandles(t.on("change",(()=>this._compileList())),xbt.layerViews)}_createMapLayerHandles(t){this.removeHandles(xbt.mapLayers),this._compileList(),t&&this.addHandles(t.on("change",(()=>this._compileList())),xbt.mapLayers)}_createListItem(t){const{view:e,listItemCreatedFunction:i,checkPublishStatusEnabled:n,listModeDisabled:s}=this;return new _bt({checkPublishStatusEnabled:n,listModeDisabled:s,layer:t,listItemCreatedFunction:i,view:e})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(t){return t?this.listModeDisabled?t:t.filter((t=>$wt(t)!==Mbt)):void 0}_watchLayersListMode(t){this.removeHandles(xbt.layerListMode),t&&!this.listModeDisabled&&this.addHandles(ey((()=>t.filter((t=>"listMode"in t)).map((t=>t.listMode)).toArray()),(()=>this._compileList())),xbt.layerListMode)}_compileList(){const t=this.view?.map?.layers,e=abt(this.view)&&!this.view.inGeographicLayout?t?.filter((({type:t})=>"link-chart"===t)):t;this._watchLayersListMode(e);const i=this._getViewableLayers(e);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(t){const{operationalItems:e}=this;t.forEach((t=>{e.some((e=>e.layer===t))||e.add(this._createListItem(t))}))}_removeItems(t){const{operationalItems:e}=this,i=[];e.forEach((e=>{e&&t&&t.includes(e.layer)||i.push(e)})),e.destroyMany(i)}_sortItems(t){const{operationalItems:e}=this;e.sort(((e,i)=>{const n=t.indexOf(e.layer),s=t.indexOf(i.layer);return n>s?-1:n<s?1:0}))}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:t}=this;this.removeHandles([xbt.mapLayers,xbt.layerViews,xbt.viewLayers]),t?.ready?this.addHandles([ey((()=>this.view?.map?.allLayers),(t=>this._createMapLayerHandles(t)),dy),ey((()=>this.view?.allLayerViews),(t=>this._createLayerViewHandles(t)),dy)],xbt.viewLayers):this._removeAllItems()}};r([Je()],Abt.prototype,"checkPublishStatusEnabled",void 0),r([Je()],Abt.prototype,"listItemCreatedFunction",void 0),r([Je({nonNullable:!0})],Abt.prototype,"listModeDisabled",void 0),r([Je({type:Tbt})],Abt.prototype,"operationalItems",void 0),r([Je({readOnly:!0})],Abt.prototype,"state",null),r([Je()],Abt.prototype,"totalItems",null),r([Je()],Abt.prototype,"view",void 0),Abt=r([ln("esri.widgets.LayerList.LayerListViewModel")],Abt);const Ibt=Abt;let kbt=class extends ao{constructor(){super(...arguments),this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"catalogLayerList",void 0),r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"closeButton",void 0),r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"collapseButton",void 0),r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"errors",void 0),r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"filter",void 0),r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"flow",void 0),r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"heading",void 0),r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"statusIndicators",void 0),r([Je({type:Boolean,nonNullable:!0})],kbt.prototype,"temporaryLayerIndicators",void 0),kbt=r([ln("esri.widgets.LayerList.LayerListVisibleElements")],kbt);const Cbt=kbt;const Ebt=["label","description","metadata"];const jbt=Vm.ofType(_bt);let Obt=class extends(dC(A3)){constructor(t,e){super(t,e),this._activeItem=null,this._tooltipReferenceMap=new VD,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusLayerFlowItem=null,this._layerListMap=new VD,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`operational-${this.uid}`,this._openedLayersController=null,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterText="",this.headingLevel=2,this.knowledgeGraphOptions=null,this.layerTablesEnabled=new Vm(["knowledge-graph"]),this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.mapImageOptions=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=Nwt,this.minFilterItems=Lwt,this.openedLayers=new Vm,this.openedLayerLists=new Vm,this.selectedItems=new jbt,this.selectionMode="none",this.tableList=null,this.tileOptions=null,this.viewModel=new Ibt,this.visibilityAppearance="default",this.visibleElements=new Cbt,this._canMove=({dragEl:t,fromEl:e,toEl:i},n)=>{const s="pull"===n?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,r=tbt(t);if(!r?.sortable)return!1;const o=tbt(e),a=ebt(e),l=tbt(i),u=ebt(i),c=!!a&&!!u&&a===u,h={selected:r,from:o,to:l},d=e.group,f=i.group,p=o?.layer?.type??"",m=l?.layer?.type??"",y=new Set(["map-image","catalog","knowledge-graph"]),g="sublayer";return d&&f&&"function"==typeof s?s.call(null,h):c&&!y.has(p)&&!y.has(m)&&r?.layer?.type!==g},this._onCatalogOpen=t=>{this.openedLayers.push(t.layer.parent),this._focusLayerFlowItem=t.layer.uid},this._onTablesOpen=t=>{this.openedLayers.push(t.layer),this._focusLayerFlowItem=t.layer.uid},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onSelectedDragItemLayerUidChange=t=>{this._selectedDragItemLayerUid=t},this._onTooltipReferenceChange=(t,e)=>{e?this._tooltipReferenceMap.set(t,e):this._tooltipReferenceMap.delete(t)},this._onTriggerAction=(t,e)=>{this.triggerAction(t,e)},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=t=>{if("default"!==this.visibilityAppearance)return;const e=Array.from(t.composedPath()).find((t=>t.classList?.contains(Cwt.item)));this._activeItem=tbt(e)},this._onCalciteListOrderChange=t=>{const{_lastDragDetail:e}=this,{toEl:i,fromEl:n,dragEl:s,newIndex:r}=t;if(n&&i&&!(e?.newIndex===r&&e?.dragEl===s&&e?.toEl===i&&e?.fromEl===n))if(this._lastDragDetail=t,n!==i)this._moveLayerFromChildList({toEl:i,fromEl:n,dragEl:s,newIndex:r});else{const t=Array.from(n.children).filter((t=>t?.matches("calcite-list-item"))).map((t=>t.value));this._sortLayers(n,t)}}}initialize(){this.addHandles(sy((()=>this.openedLayers),"change",(()=>this._handleOpenedLayersChange()),dy))}loadDependencies(){return o3({button:()=>import("./p-5b44be17.js"),flow:()=>import("./p-b1874b0a.js"),"flow-item":()=>import("./p-e9d31c79.js"),list:()=>import("./p-4bdb39fa.js"),notice:()=>import("./p-cebdc047.js"),tooltip:()=>import("./p-c63113ff.js")})}destroy(){this._destroyOpenedLayerLists(),this._tooltipReferenceMap.clear()}get _totalItems(){return this.viewModel.operationalItems.flatten((t=>t.children.filter((t=>"catalog-dynamic-group"!==t.layer.type)))).length}get _dragEnabled(){return this._totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this._totalItems>=this.minFilterItems&&this.visibleElements.filter}get _renderedOpenLayerFlowItems(){return this.openedLayers.toArray().map((t=>this._renderLayerFlowItem(t)))}get icon(){return"layers"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(t){this.viewModel.listItemCreatedFunction=t}get multipleSelectionEnabled(){return mn(jt.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),"multiple"===this.selectionMode}set multipleSelectionEnabled(t){mn(jt.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0}),this.selectionMode=t?"multiple":this.selectionEnabled?"single":"none"}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(t){this.viewModel.operationalItems=t}get selectionEnabled(){return mn(jt.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),"none"!==this.selectionMode&&this.dragEnabled}set selectionEnabled(t){mn(jt.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0}),this.dragEnabled=t,this.selectionMode=t?this.multipleSelectionEnabled?"multiple":"single":"none"}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}triggerAction(t,e){return this.viewModel.triggerAction(t,e)}render(){const t=this.viewModel?.state,e={[P3.hidden]:"loading"===t,[P3.disabled]:"disabled"===t},i=this.operationalItems?.filter((t=>!t.hidden&&(this.visibleElements.errors||!t.error)));return V3("div",{class:this.classes(Cwt.base,P3.widget,P3.panel,e)},i?.length?[this._renderItemTooltips(i),this._renderItems(i)]:this._renderNoItems())}async _createFlowList(t,e){const{_layerListMap:i}=this,n=i.get(t);if(n)return n;const s="catalog"===t.type?await this._createCatalogLayerList(t):await this._createTableList(t);return e.aborted||i.set(t,s),s}async _handleOpenedLayersChange(){const{_layerListMap:t,openedLayers:e,openedLayerLists:i}=this;this._openedLayersController?.abort();const n=new AbortController,{signal:s}=n;this._openedLayersController=n,t.forEach(((i,n)=>{e.includes(n)||(i.destroy(),t.delete(n))}));const r=await Promise.all(e.map((t=>this._createFlowList(t,s))));if(s.aborted)return;i.removeAll(),i.addMany(r);const o=i.at(-1);o?"catalogLayer"in o?(this._set("catalogLayerList",o),this._set("tableList",null)):(this._set("catalogLayerList",null),this._set("tableList",o)):(this._set("catalogLayerList",null),this._set("tableList",null))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll(),this.openedLayers.removeAll(),this._layerListMap.clear()}_renderItemTooltip(t){const{_tooltipReferenceMap:e,messages:i}=this;return t?V3("calcite-tooltip",{key:`tooltip-${t.layer.uid}`,referenceElement:e.get(t.layer.uid)},i.layerIncompatibleTooltip):null}_renderItemTooltipNodes(t){return t.incompatible?this._renderItemTooltip(t):t.children?.filter((t=>!t.hidden)).toArray().map((t=>this._renderItemTooltipNodes(t)))}_renderItemTooltips(t){return t?.toArray().map((t=>this._renderItemTooltipNodes(t)))}_renderNoItemsMessage(){return V3("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return V3("div",{class:Cwt.itemMessage,key:"esri-layer-list__no-items"},V3("calcite-notice",{icon:"information",kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}async _createCatalogLayerList(t){const{default:e}=await import("./p-f0aac58c.js"),{headingLevel:i,catalogOptions:n,view:s,filterPlaceholder:r,listItemCreatedFunction:o,minFilterItems:a,selectionMode:l,visibilityAppearance:u,_onCatalogOpen:c,_onTablesOpen:h,layerTablesEnabled:d}=this;return new e({headingLevel:i,view:s,filterPlaceholder:r,listItemCreatedFunction:o,minFilterItems:a,selectionMode:l,visibilityAppearance:u,...n,catalogLayer:t,layerTablesEnabled:d,onCatalogOpen:c,onTablesOpen:h})}_getTableListParams(t){switch(t.type){case"knowledge-graph":return{...this.knowledgeGraphOptions,tables:t.tables};case"map-image":return{...this.mapImageOptions,tables:t.subtables};case"tile":return{...this.tileOptions,tables:t.subtables};default:return null}}async _createTableList(t){const{default:e}=await import("./p-efeb9bcb.js"),{headingLevel:i,selectionMode:n,dragEnabled:s}=this;return new e({headingLevel:i,selectionMode:n,dragEnabled:s,...this._getTableListParams(t)})}_renderLayerFlowItem(t){const{messages:e,openedLayers:i}=this,n=t.title||this.messages.untitledLayer;return V3("calcite-flow-item",{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":t.uid,description:n,heading:e["catalog"===t.type?"catalogLayers":"tables"],headingLevel:this.headingLevel,key:`flow-layer-list-${t.uid}`,onCalciteFlowItemBack:t=>{t.preventDefault(),i.pop();const e=i.at(-1);e?this._focusLayerFlowItem=e.uid:this._focusRootFlowItem=!0}},this._layerListMap.get(t)?.render())}_renderPanelFlowItems(t){return t?t.flatten((t=>t.children)).filter((({hidden:t,panel:e})=>!t&&e?.open&&!e.disabled&&e.flowEnabled)).toArray().map((({title:t,panel:e})=>{const i=()=>this._handlePanelFlowItemBack(e);return V3("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:t,heading:e.title,headingLevel:this.headingLevel,key:`flow-panel-${e.uid}`,onCalciteFlowItemBack:t=>{t.preventDefault(),i()}},e.render(),V3("calcite-button",{appearance:"transparent",onclick:i,slot:"footer-actions",width:"full"},this.messagesCommon.back))})):[]}_handlePanelFlowItemBack(t){t.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(t){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,hx(t))}_focusLayerFlowItemNode(t){this._focusLayerFlowItem===t.dataset.layerUid&&(this._focusLayerFlowItem=null,hx(t))}_focusPanelFlowItemNode(t){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,hx(t))}_renderItems(t){const{visible:e,collapsed:i,_filterEnabled:n,_rootGroupUid:s,visibleElements:{closeButton:r,collapseButton:o,heading:a,flow:l},_dragEnabled:u,selectionMode:c,filterText:h,filterPlaceholder:d,messages:f}=this,p=[V3("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:r,closed:!e,collapsed:i,collapsible:o,heading:a?f.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},V3("calcite-list",{afterCreate:t=>{t.addEventListener("focusin",this._setActiveItem),t.addEventListener("focusout",this._clearActiveItem)},afterRemoved:t=>{t.removeEventListener("focusin",this._setActiveItem),t.removeEventListener("focusout",this._clearActiveItem)},canPull:t=>this._canMove(t,"pull"),canPut:t=>this._canMove(t,"put"),"data-layer-type":s,dragEnabled:u,filterEnabled:n,filterPlaceholder:d,filterProps:Ebt,filterText:n?h:"",group:s,key:"root-list",label:f.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:c,onCalciteListChange:t=>this._handleCalciteListChange(t),onCalciteListDragEnd:t=>this._handleCalciteListDragEnd(t.detail),onCalciteListFilter:t=>this.filterText=t.target?.filterText??"",onCalciteListOrderChange:t=>this._onCalciteListOrderChange(t.detail)},t?.toArray().map((t=>this._renderItem(t))),t?.length&&n?V3("div",{class:Cwt.filterNoResults,slot:"filter-no-results"},V3("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(t),this._renderedOpenLayerFlowItems];return e?l?V3("calcite-flow",{key:"root-flow"},p):p:null}_renderItem(t,e,i){return V3(obt,{activeItem:this._activeItem,canMove:this._canMove,css:Cwt,dragEnabled:this.dragEnabled,item:t,key:`layerListItem-${t.layer.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:e,parentTitles:i,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange,onTablesOpen:this._onTablesOpen,onTooltipReferenceChange:this._onTooltipReferenceChange})}_moveLayerFromChildList({toEl:t,fromEl:e,dragEl:i,newIndex:n}){const s=tbt(i),r=tbt(t),o=tbt(e);this.viewModel.moveListItem(s,o,r,n)}_handleCalciteListDragEnd(t){const{fromEl:e,dragEl:i,oldIndex:n}=t;e.insertBefore(i,e.children[n])}_sortLayers(t,e){if(t)if(t.group===this._rootGroupUid)Wwt(this.view?.map?.layers,e);else{const i=tbt(t);if(!i)return;Zwt(i,e)}}_handleCalciteListChange(t){const{selectionMode:e,selectedItems:i}=this;if("none"===e)return;const n=t.target.selectedItems.map((t=>tbt(t))).filter(Boolean);i.removeAll(),i.addMany(n)}};r([Je()],Obt.prototype,"_activeItem",void 0),r([Je()],Obt.prototype,"_tooltipReferenceMap",void 0),r([Je()],Obt.prototype,"_focusRootFlowItem",void 0),r([Je()],Obt.prototype,"_focusPanelFlowItem",void 0),r([Je()],Obt.prototype,"_focusLayerFlowItem",void 0),r([Je()],Obt.prototype,"_layerListMap",void 0),r([Je()],Obt.prototype,"_totalItems",null),r([Je()],Obt.prototype,"_dragEnabled",null),r([Je()],Obt.prototype,"_filterEnabled",null),r([Je()],Obt.prototype,"_renderedOpenLayerFlowItems",null),r([Je({readOnly:!0})],Obt.prototype,"catalogLayerList",void 0),r([Je()],Obt.prototype,"catalogOptions",void 0),r([Je()],Obt.prototype,"collapsed",void 0),r([Je()],Obt.prototype,"dragEnabled",void 0),r([Je()],Obt.prototype,"filterPlaceholder",void 0),r([Je()],Obt.prototype,"filterText",void 0),r([Je()],Obt.prototype,"headingLevel",void 0),r([Je()],Obt.prototype,"icon",null),r([Je()],Obt.prototype,"knowledgeGraphOptions",void 0),r([Je()],Obt.prototype,"label",null),r([Je()],Obt.prototype,"layerTablesEnabled",void 0),r([Je()],Obt.prototype,"listItemCanGiveFunction",void 0),r([Je()],Obt.prototype,"listItemCanReceiveFunction",void 0),r([Je()],Obt.prototype,"listItemCreatedFunction",null),r([Je()],Obt.prototype,"mapImageOptions",void 0),r([Je(),z3("esri/widgets/LayerList/t9n/LayerList")],Obt.prototype,"messages",void 0),r([Je(),z3("esri/t9n/common")],Obt.prototype,"messagesCommon",void 0),r([Je()],Obt.prototype,"minDragEnabledItems",void 0),r([Je()],Obt.prototype,"minFilterItems",void 0),r([Je()],Obt.prototype,"multipleSelectionEnabled",null),r([Je({readOnly:!0})],Obt.prototype,"openedLayers",void 0),r([Je({readOnly:!0})],Obt.prototype,"openedLayerLists",void 0),r([Je()],Obt.prototype,"operationalItems",null),r([Je()],Obt.prototype,"selectionEnabled",null),r([Je()],Obt.prototype,"selectedItems",void 0),r([Je()],Obt.prototype,"selectionMode",void 0),r([Je({readOnly:!0})],Obt.prototype,"tableList",void 0),r([Je()],Obt.prototype,"tileOptions",void 0),r([Je()],Obt.prototype,"view",null),r([gwt("trigger-action"),Je({type:Ibt})],Obt.prototype,"viewModel",void 0),r([Je()],Obt.prototype,"visibilityAppearance",void 0),r([Je({type:Cbt,nonNullable:!0})],Obt.prototype,"visibleElements",void 0),Obt=r([ln("esri.widgets.LayerList")],Obt);const Rbt=Obt;function Lbt(t,e){const i=t.featureReduction;return i&&"selection"!==i.type&&(!("maxScale"in i)||!i.maxScale||i.maxScale<e.scale)?i:null}const Nbt=-1;let Pbt=class extends ao{constructor(t){super(t),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=u("mapview-transitions-duration"),this.effects=[]}set effect(t){if(this._get("effect")!==(t=t||"")){this._set("effect",t);try{this._transitionTo(Fbt(t))}catch(e){this._transitionTo([]),jt.getLogger(this).warn("Invalid Effect",{effect:t,error:e})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(t){this._updateForScale(t)}get transitioning(){return null!==this._to}canTransitionTo(t){try{return this.scale>0&&Dbt(this._current,Fbt(t),this.scale)}catch{return!1}}transitionStep(t,e){this._applyTimeTransition(t),this._updateForScale(e)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(t){this.scale>0&&Dbt(this._current,t,this.scale)?(this._final=t,this._to=nt(t),$bt(this._current,this._to,this.scale),this._from=nt(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=t),this._set("effects",this._current[0]?nt(this._current[0].effects):[])}_applyTimeTransition(t){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=t;const e=Math.min(1,this._time/this.duration);for(let t=0;t<this._current.length;t++){const i=this._current[t],n=this._from[t],s=this._to[t];i.scale=zbt(n.scale,s.scale,e);for(let t=0;t<i.effects.length;t++){const r=i.effects[t],o=n.effects[t],a=s.effects[t];r.interpolate(o,a,e)}}1===e&&(this._current=this._final,this._set("effects",this._current[0]?nt(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(t){if(this._set("scale",t),0===this._current.length)return;const e=this._current,i=this._current.length-1;let n,s,r=1;if(1===e.length||t>=e[0].scale)s=n=e[0].effects;else if(t<=e[i].scale)s=n=e[i].effects;else for(let o=0;o<i;o++){const i=e[o],a=e[o+1];if(i.scale>=t&&a.scale<=t){r=(t-i.scale)/(a.scale-i.scale),n=i.effects,s=a.effects;break}}for(let t=0;t<this.effects.length;t++){this.effects[t].interpolate(n[t],s[t],r)}}};function Fbt(t){const e=slt(t)||[];return Ubt(e)?[{scale:Nbt,effects:e}]:e}function Dbt(t,e,i){if(!t[0]?.effects||!e[0]?.effects)return!0;return!((t[0]?.scale===Nbt||e[0]?.scale===Nbt)&&(t.length>1||e.length>1)&&i<=0)&&jk(t[0].effects,e[0].effects)}function $bt(t,e,i){const n=t.length>e.length?t:e,s=t.length>e.length?e:t,r=s[s.length-1],o=r?.scale??i,a=r?.effects??[];for(let t=s.length;t<n.length;t++)s.push({scale:o,effects:[...a]});for(let t=0;t<n.length;t++)s[t].scale=s[t].scale===Nbt?i:s[t].scale,n[t].scale=n[t].scale===Nbt?i:n[t].scale,Ok(s[t].effects,n[t].effects)}function zbt(t,e,i){return t+(e-t)*i}function Ubt(t){const e=t[0];return!!e&&"type"in e}r([Je()],Pbt.prototype,"_to",void 0),r([Je()],Pbt.prototype,"duration",void 0),r([Je({value:""})],Pbt.prototype,"effect",null),r([Je({readOnly:!0})],Pbt.prototype,"effects",void 0),r([Je({readOnly:!0})],Pbt.prototype,"final",null),r([Je({readOnly:!0})],Pbt.prototype,"hasEffects",null),r([Je({value:0})],Pbt.prototype,"scale",null),r([Je({readOnly:!0})],Pbt.prototype,"transitioning",null),Pbt=r([ln("esri.layers.effects.EffectView")],Pbt);function Bbt(t){const e=t.layer;if("floorInfo"in e&&e.floorInfo?.floorField&&"floors"in t.view){return Vbt(t.view.floors,e.floorInfo.floorField)}return null}function Gbt(t,e){return"floorInfo"in e&&e.floorInfo?.floorField?Vbt(t,e.floorInfo.floorField):null}function Vbt(t,e){if(!t?.length)return null;const i=t.filter((t=>""!==t)).map((t=>`'${t}'`));return i.push("''"),`${e} IN (${i.join(",")}) OR ${e} IS NULL`}function qbt(t,e,i){const n=e.flatten((({sublayers:t})=>t)).length;if(n!==t.length)return!0;return!!t.some((t=>t.originIdOf("minScale")>i||t.originIdOf("maxScale")>i||t.originIdOf("renderer")>i||t.originIdOf("labelingInfo")>i||t.originIdOf("opacity")>i||t.originIdOf("labelsVisible")>i||t.originIdOf("source")>i))||!Wbt(t,e)}function Hbt(t,e,i){return!!t.some((t=>{const e=t.source,n=!e||"map-layer"===e.type&&e.mapLayerId===t.id&&(null==e.gdbVersion||e.gdbVersion===i);return t.commitProperty("renderer"),t.commitProperty("labelingInfo"),t.commitProperty("opacity"),t.commitProperty("labelsVisible"),!n||t.originIdOf("renderer")>$n.SERVICE||t.originIdOf("labelingInfo")>$n.SERVICE||t.originIdOf("opacity")>$n.SERVICE||t.originIdOf("labelsVisible")>$n.SERVICE}))||!Wbt(t,e)}function Wbt(t,e){if(!t?.length||null==e)return!0;const i=e.slice().reverse().flatten((({sublayers:t})=>t&&t.toArray().reverse())).map((t=>t.id)).toArray();if(t.length>i.length)return!1;let n=0;const s=i.length;for(const{id:e}of t){for(;n<s&&i[n]!==e;)n++;if(n>=s)return!1}return!0}function Zbt(t){return!!t&&t.some((t=>null!=t.minScale||null!=t.layerDefinition?.minScale))}const Jbt={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let Ybt=class extends ao{constructor(t){super(t),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const t=this.visibleSublayers.map((t=>{const e=Gbt(this.floors,t);return t.toExportImageJSON(e)}));return t.length?JSON.stringify(t):null}get hasDynamicLayers(){return this.layer&&Hbt(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(t){this._get("layer")!==t&&(this._set("layer",t),this.removeHandles("layer"),t&&this.addHandles([t.allSublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),t.on("sublayer-update",(t=>this.notifyChange(Jbt[t.propertyName])))],"layer"))}get layers(){const t=this.visibleSublayers;return t?t.length?"show:"+t.map((t=>t.id)).join(","):"show:-1":null}get layerDefs(){const t=!!this.floors?.length,e=this.visibleSublayers.filter((e=>null!=e.definitionExpression||t&&null!=e.floorInfo));return e.length?JSON.stringify(e.reduce(((t,e)=>{const i=Gbt(this.floors,e),n=ZC(i,e.definitionExpression);return null!=n&&(t[e.id]=n),t}),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");const t=this.layer;return t&&(t.commitProperty("dpi"),t.commitProperty("imageFormat"),t.commitProperty("imageTransparency"),t.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const t=[];if(!this.layer)return t;const e=this.layer.sublayers,i=this.scale,n=e=>{e.visible&&(0===i||pgt(i,e.minScale,e.maxScale))&&(e.sublayers?e.sublayers.forEach(n):t.unshift(e))};e&&e.forEach(n);const s=this._get("visibleSublayers");return!s||s.length!==t.length||s.some(((e,i)=>t[i]!==e))?t:s}toJSON(){const t=this.layer;let e={dpi:t.dpi,format:t.imageFormat,transparent:t.imageTransparency,gdbVersion:t.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?e.dynamicLayers=this.dynamicLayers:e={...e,layers:this.layers,layerDefs:this.layerDefs},e}};r([Je({readOnly:!0})],Ybt.prototype,"dynamicLayers",null),r([Je()],Ybt.prototype,"floors",void 0),r([Je({readOnly:!0})],Ybt.prototype,"hasDynamicLayers",null),r([Je()],Ybt.prototype,"layer",null),r([Je({readOnly:!0})],Ybt.prototype,"layers",null),r([Je({readOnly:!0})],Ybt.prototype,"layerDefs",null),r([Je({type:Number})],Ybt.prototype,"scale",void 0),r([Je({readOnly:!0})],Ybt.prototype,"version",null),r([Je({readOnly:!0})],Ybt.prototype,"visibleSublayers",null),Ybt=r([ln("esri.layers.support.ExportImageParameters")],Ybt);const Kbt=9999999e31,Qbt=2e-7,Xbt={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function tSt(t){return Xbt[t]??[-34028234663852886e22,34028234663852886e22]}function eSt(t,e){return null==t||null==e?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function iSt(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function nSt(t,e,i,n){let[s,r]=tSt(i);const o=iSt(i);return o&&(s-=1e-5,r+=1e-5),o?i.startsWith("u")?rSt(t,e,n,[s,r]):oSt(t,e,n,[s,r]):aSt(t,e,n,[s,r])}function sSt(t,e){for(let i=0;i<e.length;i++)e[i]&&isNaN(t[i])&&(e[i]=0,t[i]=0)}function rSt(t,e,i,n){const[s,r]=n;for(let n=0;n<e.length;n++)if(e[n]){const o=t[n];o<s||o>r?e[n]=0:i[n]=o+.5|0}}function oSt(t,e,i,n){const[s,r]=n;for(let n=0;n<e.length;n++)if(e[n]){const o=t[n];o<s||o>r?e[n]=0:i[n]=o+(o>0?.5:-.5)|0}}function aSt(t,e,i,n){const[s,r]=n;for(let n=0;n<e.length;n++)if(e[n]){const o=t[n];o<s||o>r?e[n]=0:i[n]=o}}function lSt(t,e,i){if(t.depthCount&&t.depthCount>1)return;const{pixels:n,statistics:s,pixelType:r}=t,o=n[0].length,a=t.bandMasks??[],l=t.mask??new Uint8Array(o).fill(255),u="f32"===r||"f64"===r,c=tSt(r);let h=!1;for(let t=0;t<n.length;t++){const o="number"==typeof e?e:e[t];if(null==o)continue;const d=s?.[t]?.minValue??c[0],f=s?.[t]?.maxValue??c[1];if(d>o+Number.EPSILON||f<o-Number.EPSILON)continue;const p=a[t]||l.slice(),m=n[t],y=i?.customFloatTolerance;if(u&&0!==y){let t=y;t||(t=Math.abs(o)>=Kbt?Qbt*Math.abs(o):"f32"===r?2**-23:Number.EPSILON);for(let e=0;e<m.length;e++)p[e]&&Math.abs(m[e]-o)<t&&(m[e]=0,p[e]=0,l[e]=0,h=!0)}else for(let t=0;t<m.length;t++)p[t]&&m[t]===o&&(m[t]=0,p[t]=0,l[t]=0,h=!0);a[t]=p}h&&(t.bandMasks=t.bandMasks||t.pixels.length>1?a:null,t.mask=l),h&&"updateStatistics"in t&&t.updateStatistics()}function uSt(t){return null==t||"simple"===t.type||"unique-value"===t.type||"class-breaks"===t.type||"dictionary"===t.type||"heatmap"===t.type}var cSt;function hSt(t){switch(t){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function dSt(t){return"CIMVectorMarker"===t?.type?t.markerGraphics?.[0]:void 0}function fSt(t){return"CIMPolygonSymbol"===t?.symbol?.type?t.symbol.symbolLayers?.[0]:void 0}function pSt(t,e){"CIMVectorMarker"===t?.type&&null!=e&&(t.size=e)}function mSt(t,e){const i=dSt(t);i&&null!=e&&(i.geometry=hSt(e))}function ySt(t,e){const i=fSt(dSt(t));i&&null!=e&&(i.color=e.toArray())}function gSt(t,e,i){const n=fSt(dSt(t));n&&null!=e&&i&&(n.colorLocked=e)}function vSt(t,e){const{outerRingSize:i,innerDotSize:n,type:s,color:r,colorLocked:o,primitiveOverrides:a}=e,l="CIMPolygonSymbol"===t.data.symbol?.type?t.data.symbol.symbolLayers:null;if(2===l?.length)for(const t of l){const e=t.primitiveName===cSt.OuterRing;pSt(t,e?i:n),mSt(t,s),ySt(t,r),gSt(t,o,e)}return null!=i&&null!=n&&(t.data.primitiveOverrides=null),void 0!==a&&(t.data.primitiveOverrides=nt(a)),t}!function(t){t.OuterRing="reference-size-outer-ring",t.InnerDot="reference-size-inner-dot"}(cSt||(cSt={}));function wSt(t){const e=[];return bSt(Xit(t),e),e.length?new RA(Qit(e[0])):null}function bSt(t,e){if(!t)return;let i;i="CIMTextSymbol"===t.type?t.symbol:t;const n="CIMPolygonSymbol"===t.type;if(i?.symbolLayers)for(const t of i.symbolLayers)if(!(t.colorLocked||n&&(ent(t)||tnt(t)&&t.markerPlacement&&nnt(t.markerPlacement))))switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":t.tintColor&&SSt(e,t.tintColor);break;case"CIMVectorMarker":t.markerGraphics?.forEach((t=>{bSt(t.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":SSt(e,t.color);break;case"CIMHatchFill":bSt(t.lineSymbol,e)}}function SSt(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function _St(t,e,i){e instanceof RA||(e=new RA(e));const n=Xit(t);n&&xSt(n,e,i)}function xSt(t,e,i){if(!t)return;let n;n="CIMTextSymbol"===t.type?t.symbol:t;const s="CIMPolygonSymbol"===n?.type;if(n?.symbolLayers)for(const t of n.symbolLayers){if(t.colorLocked)continue;if(s)if(i){const{layersToColor:e}=i;if((ent(t)||tnt(t)&&t.markerPlacement&&nnt(t.markerPlacement))&&"fill"===e||int(t)&&"outline"===e)continue}else if(ent(t)||tnt(t)&&t.markerPlacement&&nnt(t.markerPlacement))continue;const n=e.toArray();switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":t.tintColor=n;break;case"CIMVectorMarker":t.markerGraphics?.forEach((t=>{xSt(t.symbol,e,i)}));break;case"CIMSolidStroke":case"CIMSolidFill":t.color=n;break;case"CIMHatchFill":xSt(t.lineSymbol,e,i)}}}var MSt;!function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"}(MSt||(MSt={}));const TSt={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function ASt(t,e,i){const n=MSt.size;let s=n,r=n;t<1?s*=.75:t>1&&(r*=1.25);const o=0,a=0;let l=n,u=n;e&&i&&(s=r=l=u=0);return[{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[i?l:.875*l,o]},{command:"L",values:[i?s-.5*l:a,r-.5*u]},{command:"L",values:[s-.5*l,r-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[l,e?o:.125*u]},{command:"L",values:[s-.5*l,e?r-.5*u:u]},{command:"L",values:[s-.5*l,r-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s-.5*l,r-.5*u]},{command:"L",values:[i?s-.5*l:a,r-.5*u]},{command:"L",values:[i?s-.5*l:a,e?r-.5*u:u]},{command:"L",values:[s-.5*l,e?r-.5*u:u]},{command:"Z",values:[]}]}]}function ISt(t){const e=MSt.size,i=.5*t,n=0,s=0;return[{type:"path",path:[{command:"M",values:[s,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[s,.7*e+i-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[e,i]},{command:"L",values:[e,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,n]},{command:"L",values:[e,n]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[s,.7*e*.5]},{command:"Z",values:[]}]}]}function kSt(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function CSt(t,e){let i=e?MSt.tallSymbolWidth:t;const n=t,s=e?4:6;i<=MSt.size?i-=.5*s:i-=s;const r=0,o=0,a=e?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,r]},{command:"L",values:[i,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[o,.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[.5*i,n]},{command:"L",values:[o,n-.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,a]},{command:"L",values:[.5*i,n]},{command:"L",values:[i,n-.5*a]},{command:"L",values:[i,.5*a]},{command:"Z",values:[]}]}]}function ESt(t,e){let i=e?MSt.tallSymbolWidth:t;const n=t,s=e?4:6;i<=MSt.size?i-=.5*s:i-=s;const r=.5*i,o=.15*i,a=0,l=n-o;return[{type:"ellipse",cx:.5*i,cy:l,rx:r,ry:o},{type:"path",path:[{command:"M",values:[a,o]},{command:"L",values:[a,l]},{command:"L",values:[i,l]},{command:"L",values:[i,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:o,rx:r,ry:o}]}function jSt(t,e){let i=e?MSt.tallSymbolWidth:t;const n=t,s=e?4:6;i<=MSt.size?i-=.5*s:i-=s;const r=.15*i,o=n-r;return[{type:"ellipse",cx:.5*i,cy:o,rx:.5*i,ry:r},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function OSt(t){let e=t;const i=t,n=6;e<MSt.size?e-=.5*n:e-=n;const s=.15*e,r=0;return[{type:"path",path:[{command:"M",values:[0,r]},{command:"L",values:[e,r]},{command:"L",values:[.5*e,i-s]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:r,rx:.5*e,ry:s}]}function RSt(t){let e=t;const i=t,n=4;e<MSt.size?e-=.5*n:e-=n;const s=0,r=0,o=e,a=i,l=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,s]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[r,.5*a-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[.45*o,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,i]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]}]}function LSt(t){const e=t,i=2;let n=t;n<MSt.size?n-=.5*i:n-=i;const s=0,r=0;return[{type:"path",path:[{command:"M",values:[.45*e,s]},{command:"L",values:[e,n]},{command:"L",values:[.45*e,.6*n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,s]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[r,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r,n]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[e,n]},{command:"Z",values:[]}]}]}function NSt(t,e){const i=.75;return Math.round(Math.min(Math.max(t+255*e*i,0),255))}function PSt(t,e){if(null==t)return new RA;if("type"in t&&("linear"===t.type||"pattern"===t.type))return t;const i=new RA(t);return new RA([NSt(i.r,e),NSt(i.g,e),NSt(i.b,e),i.a])}const FSt="picture-fill",DSt="simple-fill",$St="simple-line",zSt="simple-marker",USt="text",BSt="cim",GSt=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),VSt=new B7(1e3);function qSt(t){const e=t.style;let i=null;if(t)switch(t.type){case zSt:"cross"!==e&&"x"!==e&&(i=t.color);break;case DSt:e&&"solid"!==e?"none"!==e&&(i={type:"pattern",x:0,y:0,src:ru(`esri/symbols/patterns/${e}.png`),width:5,height:5}):i=t.color;break;case FSt:i={type:"pattern",src:t.url,width:QA(t.width)*t.xscale,height:QA(t.height)*t.yscale,x:QA(t.xoffset),y:QA(t.yoffset)};break;case USt:i=t.color;break;case BSt:i=wSt(t)}return i}function HSt(t,e){const i=t+"-"+e;return void 0!==VSt.get(i)?Promise.resolve(VSt.get(i)):Pl(t,{responseType:"image"}).then((t=>{const n=t.data,s=n.naturalWidth,r=n.naturalHeight,o=document.createElement("canvas");o.width=s,o.height=r;const a=o.getContext("2d");a.fillStyle=e,a.fillRect(0,0,s,r),a.globalCompositeOperation="destination-in",a.drawImage(n,0,0);const l=o.toDataURL();return VSt.put(i,l),l}))}function WSt(t){if(!t)return null;let e=null;switch(t.type){case DSt:case FSt:case zSt:e=WSt(t.outline);break;case $St:{const i=QA(t.width);null!=t.style&&"none"!==t.style&&0!==i&&(e={color:t.color,style:JSt(t.style),width:i,cap:t.cap,join:"miter"===t.join?QA(t.miterLimit):t.join},e.dashArray=ZSt(e).join(",")||"none");break}default:e=null}return e}function ZSt(t){if(!t?.style)return[];const{dashArray:e,style:i,width:n}=t;if("string"==typeof e&&"none"!==e)return e.split(",").map((t=>Number(t)));const s=n??0,r=GSt.has(i)?GSt.get(i).map((t=>t*s)):[];if("butt"!==t.cap)for(const[t,e]of r.entries())r[t]=t%2==1?e+s:Math.max(e-s,1);return r}const JSt=(()=>{const t={};return e=>{if(t[e])return t[e];const i=e.replaceAll("-","");return t[e]=i,i}})(),YSt=new RA([128,128,128]);let KSt=0;function QSt(){return KSt++}let XSt=0;function t_t(){return XSt++}let e_t=0;function i_t(){return e_t++}const n_t="http://www.w3.org/2000/svg",s_t=u("android"),r_t=u("chrome")||s_t&&s_t>=4?"auto":"optimizeLegibility",o_t={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},a_t=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let l_t={},u_t={};const c_t=Math.PI;function h_t(t,e){const i=t*(c_t/180);return Math.abs(e*Math.sin(i))+Math.abs(e*Math.cos(i))}function d_t(t){return t.map((t=>`${t.command} ${t.values.join(" ")}`)).join(" ").trim()}function f_t(t,e,i,n,s){if(t){if("circle"===t.type)return V3("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if("ellipse"===t.type)return V3("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width});if("rect"===t.type)return V3("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,width:t.width,x:t.x,y:t.y});if("image"===t.type)return V3("image",{alt:s||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if("path"===t.type){const n="string"!=typeof t.path?d_t(t.path):t.path;return V3("path",{d:n,fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width})}if("text"===t.type)return Tn(n),V3("text",{"dominant-baseline":n.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":n.font.family,"font-size":n.font.size,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,kerning:n.kerning,rotate:n.rotate,stroke:i.color,"stroke-dasharray":i.dashArray,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-miterlimit":"4","stroke-width":i.width,"text-anchor":n.align,"text-decoration":n.decoration,"text-rendering":r_t,x:t.x,y:t.y},t.text)}return null}function p_t(t){if(!t)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in t))return{fill:new RA(t).toString(),pattern:null,linearGradient:null};if("pattern"===t.type){const e=`patternId-${QSt()}`;return{fill:`url(#${e})`,pattern:{id:e,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}},linearGradient:null}}const e=`linearGradientId-${t_t()}`;return{fill:`url(#${e})`,pattern:null,linearGradient:{id:e,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map((t=>({offset:t.offset,color:t.color&&new RA(t.color).toString()})))}}}function m_t(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(null!=t.width&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new RA(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=ZSt(t).join(",")||"none")),e}function y_t(t,e){const i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const n=t.alignBaseline,s="baseline"===n?"auto":"top"===n?"text-top":"bottom"===n?"hanging":n;i.align=t.align,i.dominantBaseline=s,i.decoration=t.decoration,i.kerning=t.kerning?"auto":"0",i.rotate=t.rotated?"90":"0",Tn(e),i.font.style=e.style||"normal",i.font.variant=e.variant||"normal",i.font.weight=e.weight||"normal",i.font.size=e.size&&e.size.toString()||"10pt",i.font.family=e.family||"serif"}return i}function g_t(t){const{pattern:e,linearGradient:i}=t;if(e)return V3("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},V3("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(i){const t=i.stops.map(((t,e)=>V3("stop",{key:`${e}-stop`,offset:t.offset,"stop-color":t.color})));return V3("linearGradient",{gradientUnits:"userSpaceOnUse",id:i.id,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2},t)}return null}function v_t(t,e){if(!t||0===t.length)return null;const i=[];for(const e of t){const{shape:t,fill:n,stroke:s,font:r}=e,o=p_t(n),a=m_t(s),l="text"===t.type?y_t(t,r):null,u=f_t(t,o.fill,a,l);u&&i.push(u)}return V3("mask",{id:e,maskUnits:"userSpaceOnUse"},V3("g",null,i))}function w_t(t,e,i){return JB(t,BB(t),[e,i])}function b_t(t,e,i,n,s){return ZB(t,BB(t),[e,i]),t[4]=t[4]*e-n*e+n,t[5]=t[5]*i-s*i+s,t}function S_t(t,e,i,n){const s=e%360*Math.PI/180;WB(t,BB(t),s);const r=Math.cos(s),o=Math.sin(s),a=t[4],l=t[5];return t[4]=a*r-l*o+n*o-i*r+i,t[5]=l*r+a*o-i*o-n*r+n,t}function __t(t,e){l_t&&"left"in l_t?(null!=l_t.left&&l_t.left>t&&(l_t.left=t),(null==l_t.right||l_t.right<t)&&(l_t.right=t),(null==l_t.top||l_t.top>e)&&(l_t.top=e),(null==l_t.bottom||l_t.bottom<e)&&(l_t.bottom=e)):l_t={left:t,bottom:e,right:t,top:e}}function x_t(t){const e=t.args,i=e.length;let n;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(n=0;n<i;n+=2)__t(e[n],e[n+1]);u_t.x=e[i-2],u_t.y=e[i-1];break;case"H":for(n=0;n<i;++n)__t(e[n],u_t.y);u_t.x=e[i-1];break;case"V":for(n=0;n<i;++n)__t(u_t.x,e[n]);u_t.y=e[i-1];break;case"m":{let t=0;"x"in u_t||(__t(u_t.x=e[0],u_t.y=e[1]),t=2);for(n=t;n<i;n+=2)__t(u_t.x+=e[n],u_t.y+=e[n+1]);break}case"l":case"t":for(n=0;n<i;n+=2)__t(u_t.x+=e[n],u_t.y+=e[n+1]);break;case"h":for(n=0;n<i;++n)__t(u_t.x+=e[n],u_t.y);break;case"v":for(n=0;n<i;++n)__t(u_t.x,u_t.y+=e[n]);break;case"c":for(n=0;n<i;n+=6)__t(u_t.x+e[n],u_t.y+e[n+1]),__t(u_t.x+e[n+2],u_t.y+e[n+3]),__t(u_t.x+=e[n+4],u_t.y+=e[n+5]);break;case"s":case"q":for(n=0;n<i;n+=4)__t(u_t.x+e[n],u_t.y+e[n+1]),__t(u_t.x+=e[n+2],u_t.y+=e[n+3]);break;case"A":for(n=0;n<i;n+=7)__t(e[n+5],e[n+6]);u_t.x=e[i-2],u_t.y=e[i-1];break;case"a":for(n=0;n<i;n+=7)__t(u_t.x+=e[n+5],u_t.y+=e[n+6])}}function M_t(t,e,i){const n=o_t[t.toLowerCase()];let s;"number"==typeof n&&(n?e.length>=n&&(s={action:t,args:e.slice(0,e.length-e.length%n)},i.push(s),x_t(s)):(s={action:t,args:[]},i.push(s),x_t(s)))}function T_t(t){const e=("string"!=typeof t.path?d_t(t.path):t.path).match(a_t),i=[];if(l_t={},u_t={},!e)return null;let n="",s=[];const r=e.length;for(let t=0;t<r;++t){const r=e[t],o=parseFloat(r);isNaN(o)?(n&&M_t(n,s,i),s=[],n=r):s.push(o)}M_t(n,s,i);const o={x:0,y:0,width:0,height:0};return l_t&&"left"in l_t&&(o.x=l_t.left,o.y=l_t.top,o.width=l_t.right-l_t.left,o.height=l_t.bottom-l_t.top),o}function A_t(t){const e={x:0,y:0,width:0,height:0};if("circle"===t.type)e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if("ellipse"===t.type)e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if("image"===t.type||"rect"===t.type)e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if("path"===t.type){const i=T_t(t);e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height}return e}function I_t(t){const e={x:0,y:0,width:0,height:0};let i=null,n=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY;for(const r of t)i?(i.x=Math.min(i.x,r.x),i.y=Math.min(i.y,r.y),n=Math.max(n,r.x+r.width),s=Math.max(s,r.y+r.height)):(i=e,i.x=r.x,i.y=r.y,n=r.x+r.width,s=r.y+r.height);return i&&(i.width=n-i.x,i.height=s-i.y),i}function k_t(t,e,i,n,s,r,o,a,l){let u=(o&&r?h_t(r,e):e)/2,c=(o&&r?h_t(r,i):i)/2;if(l){const t=l[0],e=l[1];u=(o&&r?h_t(r,t):t)/2,c=(o&&r?h_t(r,e):e)/2}const h=t.width+n,d=t.height+n,f=TV(),p=TV();let m=!1;if(s&&0!==h&&0!==d){const t=e!==i?e/i:h/d,n=e>i?e:i;let s=1,r=1;isNaN(n)||(t>1?(s=n/h,r=n/t/d):(r=n/d,s=n*t/h)),HB(p,p,b_t(f,s,r,u,c)),m=!0}const y=t.x+(h-n)/2,g=t.y+(d-n)/2;if(HB(p,p,w_t(f,u-y,c-g)),!m&&(h>e||d>i)){const t=h/e>d/i,n=(t?e:i)/(t?h:d);HB(p,p,b_t(f,n,n,y,g))}return a&&HB(p,p,w_t(f,a[0],a[1])),r&&HB(p,p,S_t(f,r,y,g)),`matrix(${p[0]},${p[1]},${p[2]},${p[3]},${p[4]},${p[5]})`}function C_t(t,e,i){const n=t?.effects.find((t=>"bloom"===t.type));if(!n)return null;const{strength:s,radius:r}=n,o=s>0?r:0,a=(s+o)*e,l=4*s+1;return V3("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${i}`,width:"300%",x:"-100%",y:"-100%"},V3("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(s+.5*o)*(5**(e/100)*(.4+e/100)),result:"dilate"}),V3("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:a/25}),V3("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:a/50}),V3("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},V3("feFuncR",{slope:l,type:"linear"}),V3("feFuncG",{slope:l,type:"linear"}),V3("feFuncB",{slope:l,type:"linear"})),V3("feMerge",null,V3("feMergeNode",{in:"intensityBlur"}),V3("feMergeNode",{in:"intensityBrightness"}),V3("feGaussianBlur",{stdDeviation:s/10})))}function E_t(t,e,i,n={}){const s=[],r=[],o=i_t(),a=C_t(n.effectView,e,o);let l=null;if(a){const t=n.effectView?.effects.find((t=>"bloom"===t.type)),s=(t.strength?t.strength+t.radius/2:0)/3,r=e+e*s,o=i+i*s;l=[Math.max(r,10),Math.max(o,10)]}let u=e,c=i;if(n.useRotationSize)for(let s=0;s<t.length;s++){const t=n.rotations?.[s]??0;u=Math.max(h_t(t,e),u),c=Math.max(h_t(t,i),c)}for(let o=0;o<t.length;o++){const a=t[o],h=[],d=[];let f=0,p=0,m=0;for(const t of a){const{shape:e,fill:i,stroke:r,font:o,offset:a}=t;n.ignoreStrokeWidth||"text"===e.type||(f+=r?.width||0);const l=p_t(i),u=m_t(r),c="text"===e.type?y_t(e,o):null;s.push(g_t(l)),h.push(f_t(e,l.fill,u,c,n.ariaLabel)),d.push(A_t(e)),a&&(p+=a[0],m+=a[1])}const y=n.rotations?.[o]??0;n.useRotationSize&&(p+=(u-h_t(y,e))/2,m+=(c-h_t(y,i))/2);const g=k_t(I_t(d),e,i,f,n.scale??!1,y,n.useRotationSize??!1,[p,m],l);let v=null;if(n.masking){const t=`mask-${o}`,e=n.masking[o];s.push(v_t(e,t)),v=`url(#${t})`}r.push(v?V3("g",{mask:v},V3("g",{transform:g},h)):V3("g",{transform:g},h))}a&&(Tn(l),u=l[0],c=l[1]);const h="display: block;";return V3("svg",{"aria-label":n.ariaLabel,focusable:!1,height:c,role:"img",style:h,width:u,xmlns:n_t},a,V3("defs",null,s),a?V3("g",{filter:`url(#bloom${o})`},r):r)}const j_t=new RA("white");function O_t(t){const e=t.symbolLayers?.at(-1);if(e&&"outline"in e)return e?.outline?.size}function R_t(t){if(!t)return 0;if(yD(t)){const e=O_t(t);return null!=e?e:0}return XA(WSt(t)?.width)}function L_t(t){if(null==t||!("symbolLayers"in t)||null==t.symbolLayers)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some((t=>"object"===t.type));case"line-3d":return t.symbolLayers.some((t=>"path"===t.type));case"polygon-3d":return t.symbolLayers.some((t=>"object"===t.type||"extrude"===t.type));default:return!1}}function N_t(t){return t.resource?.href??""}function P_t(t,e){if(!t)return null;let i=null;return yD(t)?i=F_t(t):mD(t)&&(i="cim"===t.type?wSt(t):t.color?new RA(t.color):null),i?D_t(i,e):null}function F_t(t){const e=t.symbolLayers;if(!e)return null;let i=null;return e.forEach((t=>{"object"===t.type&&t.resource?.href||(i="water"===t.type?t.color:t.material?t.material.color:null)})),i?new RA(i):null}function D_t(t,e){if(null==e||null==t)return t;const i=t.toRgba();return i[3]=i[3]*e,new RA(i)}function $_t(t,e,i){const n=t.symbolLayers;if(!n)return;const s=t=>D_t(e=e??t??(null!=i?j_t:null),i);n.forEach((t=>{if("object"!==t.type||!t.resource?.href||e)if("water"===t.type)t.color=s(t.color);else{const e=null!=t.material?t.material.color:null,n=s(e);null==t.material?t.material=new ML({color:n}):t.material.color=n,null!=i&&"outline"in t&&null!=t.outline?.color&&(t.outline.color=D_t(t.outline.color,i))}}))}function z_t(t,e,i){(e=e??t.color)&&(t.color=D_t(e,i)),null!=i&&"outline"in t&&t.outline?.color&&(t.outline.color=D_t(t.outline.color,i))}function U_t(t,e,i){t&&(e||null!=i)&&(e&&(e=new RA(e)),yD(t)?$_t(t,e,i):mD(t)&&z_t(t,e,i))}async function B_t(t,e){const i=t.symbolLayers;i&&await qm(i,(async t=>G_t(t,e)))}async function G_t(t,e){switch(t.type){case"extrude":H_t(t,e);break;case"icon":case"line":case"text":V_t(t,e);break;case"path":Z_t(t,e);break;case"object":await W_t(t,e)}}function V_t(t,e){const i=q_t(e);null!=i&&(t.size=i)}function q_t(t){for(const e of t)if("number"==typeof e)return e;return null}function H_t(t,e){t.size="number"==typeof e[2]?e[2]:0}async function W_t(t,e){const{resourceSize:i,symbolSize:n}=await Y_t(t),s=J_t(e,i,n);t.width=K_t(e[0],n[0],i[0],s),t.depth=K_t(e[1],n[1],i[1],s),t.height=K_t(e[2],n[2],i[2],s)}function Z_t(t,e){const i=J_t(e,lw,[t.width,void 0,t.height]);t.width=K_t(e[0],t.width,1,i),t.height=K_t(e[2],t.height,1,i)}function J_t(t,e,i){for(let n=0;n<3;n++){const s=t[n];switch(s){case"symbol-value":{const t=i[n];return null!=t?t/e[n]:1}case"proportional":break;default:if(s&&e[n])return s/e[n]}}return 1}async function Y_t(t){const{computeObjectLayerResourceSize:e}=await import("./p-e35898b3.js"),i=await e(t,10),{width:n,height:s,depth:r}=t,o=[n,r,s];let a=1;for(let t=0;t<3;t++){const e=o[t];if(null!=e){a=e/i[t];break}}for(let t=0;t<3;t++)null==o[t]&&(o[t]=i[t]*a);return{resourceSize:i,symbolSize:o}}function K_t(t,e,i,n){switch(t){case"proportional":return i*n;case"symbol-value":return null!=e?e:i;default:return t}}function Q_t(t,e){const i=q_t(e);if(null!=i)switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const e=t.width/t.height;e>1?(t.width=i,t.height=i*e):(t.width=i*e,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}async function X_t(t,e){if(t&&e)return yD(t)?B_t(t,e):void(mD(t)&&Q_t(t,e))}function txt(t,e,i){if(t&&null!=e)if(yD(t)){const n=t.symbolLayers;n&&n.forEach((t=>{if("object"===t.type)switch(i){case"tilt":t.tilt=(t.tilt??0)+e;break;case"roll":t.roll=(t.roll??0)+e;break;default:t.heading=(t.heading??0)+e}"icon"===t.type&&(t.angle+=e)}))}else mD(t)&&("simple-marker"!==t.type&&"picture-marker"!==t.type&&"text"!==t.type||(t.angle+=e))}function ext(t){if(!t)return null;const e=t.effects.filter((t=>"bloom"!==t.type)).map((t=>t.toJSON()));return Plt(e)}async function ixt(t,e){const i=await t.fetchSymbol(e);return i||t.fetchCIMSymbol(e)}const nxt=qx();function sxt(t,e){nxt.append(t,e),nxt.detach(e)}function rxt(t,e,i){const n=Math.ceil(e[0]),s=Math.ceil(e[1]);if(!t.some((t=>!!t.length)))return null;const r=i?.node||document.createElement("div");null!=i.opacity&&(r.style.opacity=i.opacity.toString()),null!=i.effectView&&(r.style.filter=ext(i.effectView));return sxt(r,(()=>E_t(t,n,s,i))),r}function oxt(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=document.createElement("canvas");i.width=t,i.height=e,i.style.width=t+"px",i.style.height=e+"px";const n=i.getContext("2d");return n.clearRect(0,0,t,e),n}function axt(t,e,i){return t?Pl(t,{responseType:"image"}).then((t=>{const n=t.data,s=n.width,r=n.height,o=s/r;let a=e;if(i){const t=Math.max(s,r);a=Math.min(a,t)}return{image:n,width:o<=1?Math.ceil(a*o):a,height:o<=1?a:Math.ceil(a/o)}})):Promise.reject(new Ve("renderUtils: imageDataSize","href not provided."))}function lxt(t,e){return!(!t||"ignore"===e)&&("multiply"!==e||255!==t.r||255!==t.g||255!==t.b||1!==t.a)}function uxt(t,e,i,n,s){switch(s){case"multiply":t[e]*=i[0],t[e+1]*=i[1],t[e+2]*=i[2],t[e+3]*=i[3];break;default:{const s=Met({r:t[e],g:t[e+1],b:t[e+2]});s.h=n.h,s.s=n.s,s.v=s.v/100*n.v;const r=xet(s);t[e]=r.r,t[e+1]=r.g,t[e+2]=r.b,t[e+3]*=i[3];break}}}function cxt(t,e,i,n,s){return axt(t,e,s).then((s=>{const r=s.width??e,o=s.height??e;if(s.image&&lxt(i,n)){let e=s.image.width,a=s.image.height;u("edge")&&/\.svg$/i.test(t)&&(e-=1,a-=1);const l=oxt(r,o);l.drawImage(s.image,0,0,e,a,0,0,r,o);const c=l.getImageData(0,0,r,o),h=[i.r/255,i.g/255,i.b/255,i.a],d=Met(i);for(let t=0;t<c.data.length;t+=4)uxt(c.data,t,h,d,n);l.putImageData(c,0,0),t=l.canvas.toDataURL("image/png")}else{const e=Sl?.findCredential(t);if(e?.token){const i=t.includes("?")?"&":"?";t=`${t}${i}token=${e.token}`}}return{url:t,width:r,height:o}})).catch((()=>({url:t,width:e,height:e})))}const hxt="esri-relationship-ramp",dxt=`${hxt}--diamond`,fxt=`${hxt}--square`,pxt="http://www.w3.org/2000/svg",mxt={diamondContainer:`${dxt}__container`,diamondLeftCol:`${dxt}__left-column`,diamondRightCol:`${dxt}__right-column`,diamondMidCol:`${dxt}__middle-column`,diamondMidColLabel:`${dxt}__middle-column--label`,diamondMidColRamp:`${dxt}__middle-column--ramp`,squareTable:`${fxt}__table`,squareTableRow:`${fxt}__table-row`,squareTableCell:`${fxt}__table-cell`,squareTableLabel:`${fxt}__table-label`,squareTableLabelLeftBottom:`${fxt}__table-label--left-bottom`,squareTableLabelRightBottom:`${fxt}__table-label--right-bottom`,squareTableLabelLeftTop:`${fxt}__table-label--left-top`,squareTableLabelRightTop:`${fxt}__table-label--right-top`};function yxt(t,e,i={}){const{focus:n,labels:s}=t,r=!!n,o=vxt(t,e,i),a={justifyContent:"center"},l=nx(),u=i.key??e;return r?V3("div",{class:mxt.diamondContainer,key:`${u}-container`,styles:a},V3("div",{class:mxt.diamondLeftCol},l?s.right:s.left),V3("div",{class:mxt.diamondMidCol},V3("div",{class:mxt.diamondMidColLabel},s.top),o,V3("div",{class:mxt.diamondMidColLabel},s.bottom)),V3("div",{class:mxt.diamondRightCol},l?s.left:s.right)):V3("div",{class:mxt.squareTable,key:`${u}-container`},V3("div",{class:mxt.squareTableRow},V3("div",{class:ex(mxt.squareTableCell,mxt.squareTableLabel,mxt.squareTableLabelRightBottom)},l?s.top:s.left),V3("div",{class:mxt.squareTableCell}),V3("div",{class:ex(mxt.squareTableCell,mxt.squareTableLabel,mxt.squareTableLabelLeftBottom)},l?s.left:s.top)),V3("div",{class:mxt.squareTableRow},V3("div",{class:mxt.squareTableCell}),o,V3("div",{class:mxt.squareTableCell})),V3("div",{class:mxt.squareTableRow},V3("div",{class:ex(mxt.squareTableCell,mxt.squareTableLabel,mxt.squareTableLabelRightTop)},l?s.right:s.bottom),V3("div",{class:mxt.squareTableCell}),V3("div",{class:ex(mxt.squareTableCell,mxt.squareTableLabel,mxt.squareTableLabelLeftTop)},l?s.bottom:s.right)))}function gxt(t,e,i){const n=`${i}_arrowStart`,s=`${i}_arrowEnd`,r="left"===t,o={markerStart:null,markerEnd:null};switch(e){case"HL":r?o.markerStart=`url(#${s})`:o.markerEnd=`url(#${n})`;break;case"LL":o.markerStart=`url(#${s})`;break;case"LH":r?o.markerEnd=`url(#${n})`:o.markerStart=`url(#${s})`;break;default:o.markerEnd=`url(#${n})`}return o}function vxt(t,e,i={}){const{focus:n,numClasses:s,colors:r,rotation:o}=t,{opacity:a,effectList:l,ariaLabel:u}=i,c=i.size??60,h=!!n,d=Math.sqrt(c**2+c**2)+(h?0:5),f=[],p=[],m=[],y=(c||75)/s;for(let t=0;t<s;t++){const e=t*y;for(let i=0;i<s;i++){const n=i*y,s=p_t(r[t][i]),o=m_t(null),a={type:"rect",x:n,y:e,width:y,height:y},l=g_t(s);l&&f.push(l);const u=f_t(a,s.fill,o,null);u&&p.push(u),m.push(A_t(a))}}const g=10,v=15,w=15,b=10;let S=null;h||(S="margin: -15px -15px -18px -15px");const _=gxt("left",n,e),x=gxt("right",n,e),M=I_t(m),T=k_t(M,d,d,0,!1,o,!1),A=k_t(M,d,d,0,!1,h?-45:null,!1),I={filter:ext(l)??void 0,opacity:null==a?"":`${a}`};return V3("div",{class:h?mxt.diamondMidColRamp:mxt.squareTableCell,styles:I},V3("svg",{"aria-label":u,focusable:!1,height:d,role:"image",style:S,width:d,xmlns:pxt},V3("defs",null,V3("marker",{id:`${e}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},V3("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),V3("marker",{id:`${e}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},V3("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),f),V3("g",{transform:T},p),V3("g",{transform:A},V3("line",{fill:"none","marker-end":_.markerEnd,"marker-start":_.markerStart,stroke:"#555555","stroke-width":"1",x1:-g,x2:-g,y1:c-v,y2:v}),V3("line",{fill:"none","marker-end":x.markerEnd,"marker-start":x.markerStart,stroke:"#555555","stroke-width":"1",x1:w,x2:c-w,y1:c+b,y2:c+b}))))}function wxt(t){return t=t||globalThis.location.hostname,Txt.some((e=>null!=t?.match(e)))}function bxt(t,e){return t?(e=e||globalThis.location.hostname)?null!=e.match(Sxt)||null!=e.match(xxt)?t.replace("static.arcgis.com","staticdev.arcgis.com"):null!=e.match(_xt)||null!=e.match(Mxt)?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t:null}const Sxt=/^devext\.arcgis\.com$/,_xt=/^qaext\.arcgis\.com$/,xxt=/^[\w-]*\.mapsdevext\.arcgis\.com$/,Mxt=/^[\w-]*\.mapsqa\.arcgis\.com$/,Txt=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,Sxt,_xt,/^jsapps\.esri\.com$/,xxt,Mxt];function Axt(t,e,i,n){const s=t.name;return null==s?Promise.reject(new Ve("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):"Esri2DPointSymbolsStyle"===t.styleName?Cxt(s,e,n):brt(t,e,n).then((t=>kxt(t,s,e,i,_rt,n)))}function Ixt(t,e){return e.items.find((e=>e.name===t))}function kxt(t,e,i,n,s,r){const o=null!=i?.portal?i.portal:uT.getDefault(),a={portal:o,url:ca(t.baseUrl),origin:"portal-item"},l=Ixt(e,t.data);if(!l){const t=`The symbol name '${e}' could not be found`;return Promise.reject(new Ve("symbolstyleutils:symbol-name-not-found",t,{symbolName:e}))}let u=gT(s(l,n),a),c=l.thumbnail?.href??null;const h=l.thumbnail?.imageData;wxt()&&(u=bxt(u)??"",c=bxt(c));const d={portal:o,url:ca(tl(u)),origin:"portal-item"};return xrt(u,r).then((s=>{const r="cimRef"===n?Srt(s.data):s.data,o=v7(r,d);if(o&&yD(o)){if(c){const t=gT(c,a);o.thumbnail=new eF({url:t})}else h&&(o.thumbnail=new eF({url:`data:image/png;base64,${h}`}));t.styleUrl?o.styleOrigin=new XP({portal:i.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(o.styleOrigin=new XP({portal:i.portal,styleName:t.styleName,name:e}))}return o}))}function Cxt(t,e,i){const n=Art.replaceAll(/\{SymbolName\}/gi,t),s=null!=e.portal?e.portal:uT.getDefault();return xrt(n,i).then((t=>{const e=Srt(t.data);return v7(e,{portal:s,url:ca(tl(n)),origin:"portal-item"})}))}const Ext=Object.freeze({__proto__:null,fetchSymbolFromStyle:kxt,getStyleItemFromStyle:Ixt,resolveWebStyleSymbol:Axt});const jxt=MSt.size,Oxt=MSt.maxSize,Rxt=MSt.maxOutlineSize,Lxt=MSt.lineWidth,Nxt=MSt.tallSymbolWidth;function Pxt(t){const e=t.outline,i=null!=t.material?t.material.color:null,n=null!=i?i.toHex():null;if(null==e||"pattern"in e&&null!=e.pattern&&"style"===e.pattern.type&&"none"===e.pattern.style)return"fill"===t.type&&"#ffffff"===n?{color:"#bdc3c7",width:.75}:null;const s=QA(e.size)||0;return{color:"rgba("+(null!=e.color?e.color.toRgba():"255,255,255,1")+")",width:Math.min(s,Rxt),style:"pattern"in e&&null!=e.pattern&&"style"===e.pattern.type?JSt(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function Fxt(t,e){if(t.thumbnail?.url)return t.thumbnail.url;if("icon"===e.type){const t=e?.resource?.href;if(t)return N_t(e)}const i=ru("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const e=await Axt(t.styleOrigin,{portal:t.styleOrigin.portal},"webRef").catch((()=>null));if(e&&"thumbnail"in e&&e.thumbnail?.url)return e.thumbnail.url}return i}function Dxt(t,e=1){const i=t.a,n=Met(t),s=n.h,r=n.s/e,o=100-(100-n.v)/e,{r:a,g:l,b:u}=xet({h:s,s:r,v:o});return[a,l,u,i]}function $xt(t){return"water"===t.type?null==t.color?null:t.color:null==t.material?.color?null:t.material.color}function zxt(t,e=0){const i=$xt(t);if(!i){if("fill"===t.type)return null;const i=YSt.r,n=NSt(i,e);return[n,n,n,100]}const n=i.toRgba();for(let t=0;t<3;t++)n[t]=NSt(n[t],e);return n}async function Uxt(t,e){const i=t.style;if("none"===i)return null;return{type:"pattern",x:0,y:0,src:await HSt(ru(`esri/symbols/patterns/${i}.png`),e.toCss(!0)),width:5,height:5}}function Bxt(t){return t.outline?Pxt(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function Gxt(t,e){const i=$xt(t);if(!i)return null;let n="rgba(";return n+=NSt(i.r,e)+",",n+=NSt(i.g,e)+",",n+=NSt(i.b,e)+",",n+i.a+");"}function Vxt(t,e){const i=Gxt(t,e);if(!i)return{};if("pattern"in t&&null!=t.pattern&&"style"===t.pattern.type&&"none"===t.pattern.style)return null;return{color:i,width:Math.min(t.size?QA(t.size):.75,Rxt),style:"pattern"in t&&null!=t.pattern&&"style"===t.pattern.type?JSt(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?"miter"===t.join?QA(2):t.join:null}}function qxt(t,e,i){const n=null!=i?.75*i:0;return{type:"linear",x1:n?.25*n:0,y1:n?.5*n:0,x2:n||4,y2:n?.5*n:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function Hxt(t){const e=t.depth,i=t.height,n=t.width;return 0!==n&&0!==e&&0!==i&&n===e&&null!=n&&null!=i&&n<i}function Wxt(t,e,i){const n=[];if(!t)return n;switch(t.type){case"icon":{const i=0,s=0,r=e,o=e;switch(t.resource?.primitive??cP){case"circle":n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:zxt(t,0),stroke:Pxt(t)});break;case"square":n.push({shape:{type:"path",path:[{command:"M",values:[i,o]},{command:"L",values:[i,s]},{command:"L",values:[r,s]},{command:"L",values:[r,o]},{command:"Z",values:[]}]},fill:zxt(t,0),stroke:Pxt(t)});break;case"triangle":n.push({shape:{type:"path",path:[{command:"M",values:[i,o]},{command:"L",values:[.5*r,s]},{command:"L",values:[r,o]},{command:"Z",values:[]}]},fill:zxt(t,0),stroke:Pxt(t)});break;case"cross":n.push({shape:{type:"path",path:[{command:"M",values:[.5*r,s]},{command:"L",values:[.5*r,o]},{command:"M",values:[i,.5*o]},{command:"L",values:[r,.5*o]}]},stroke:Bxt(t)});break;case"x":n.push({shape:{type:"path",path:[{command:"M",values:[i,s]},{command:"L",values:[r,o]},{command:"M",values:[r,s]},{command:"L",values:[i,o]}]},stroke:Bxt(t)});break;case"kite":n.push({shape:{type:"path",path:[{command:"M",values:[i,.5*o]},{command:"L",values:[.5*r,s]},{command:"L",values:[r,.5*o]},{command:"L",values:[.5*r,o]},{command:"Z",values:[]}]},fill:zxt(t,0),stroke:Pxt(t)})}break}case"object":switch(t.resource?.primitive??jP){case"cone":{const s=qxt(zxt(t,0),zxt(t,-.6),i?Nxt:e),r=jSt(e,i);n.push({shape:r[0],fill:s},{shape:r[1],fill:s});break}case"inverted-cone":{const i=zxt(t,0),s=qxt(i,zxt(t,-.6),e),r=OSt(e);n.push({shape:r[0],fill:s},{shape:r[1],fill:i});break}case"cube":{const s=CSt(e,i);n.push({shape:s[0],fill:zxt(t,0)},{shape:s[1],fill:zxt(t,-.3)},{shape:s[2],fill:zxt(t,-.5)});break}case"cylinder":{const s=qxt(zxt(t,0),zxt(t,-.6),i?Nxt:e),r=ESt(e,i);n.push({shape:r[0],fill:s},{shape:r[1],fill:s},{shape:r[2],fill:zxt(t,0)});break}case"diamond":{const i=RSt(e);n.push({shape:i[0],fill:zxt(t,-.3)},{shape:i[1],fill:zxt(t,0)},{shape:i[2],fill:zxt(t,-.3)},{shape:i[3],fill:zxt(t,-.7)});break}case"sphere":{const i=qxt(zxt(t,0),zxt(t,-.6));i.x1=0,i.y1=0,i.x2=.25*e,i.y2=.25*e,n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:i});break}case"tetrahedron":{const i=LSt(e);n.push({shape:i[0],fill:zxt(t,-.3)},{shape:i[1],fill:zxt(t,0)},{shape:i[2],fill:zxt(t,-.6)});break}}break}return n}function Zxt(t){const e="number"==typeof t?.size?t?.size:null;return e?QA(e):null}function Jxt(t){return"icon"===t.type?"multiply":"tint"}async function Yxt(t,e){const i=Zxt(e),n=e?.maxSize?QA(e.maxSize):null,s=e?.disableUpsampling??!1,r=t.symbolLayers,o=[],a=[];let l=!1,u=0,c=0,h=0;r.forEach((r=>{if("icon"!==r.type&&"object"!==r.type)return;r&&"icon"===r.type&&(h=Math.max(r.size&&QA(r.size),h));const d="icon"===r.type?r.size&&QA(r.size):0,f=i||d?Math.ceil(Math.min(i||d,n||Oxt)):jxt;let p="icon"===r.type?r.angle:null;if(null!=e?.rotation&&(p=(p??0)+e.rotation),a.push(p),r?.resource?.href){const e=Fxt(t,r).then((t=>{const e=r?.material?.color,i=Jxt(r);return cxt(t,f,e,i,s)})).then((t=>{const e=t.width,i=t.height;return u=Math.max(u,e),c=Math.max(c,i),p&&(l=!0),[{shape:{type:"image",x:0,y:0,width:e,height:i,src:t.url},fill:null,stroke:null}]}));o.push(e)}else{let t=f;"icon"===r.type&&i&&(t=f*(d/h));const n="tall"===e?.symbolConfig||e?.symbolConfig?.isTall||"object"===r.type&&Hxt(r);u=Math.max(u,n?Nxt:t),c=Math.max(c,t),p&&r.resource?.primitive&&["square","triangle","x"].includes(r.resource?.primitive)&&(l=!0),o.push(Promise.resolve(Wxt(r,t,n)))}}));const d=await Promise.allSettled(o),f=[];return d.forEach((t=>{"fulfilled"===t.status?f.push(t.value):t.reason&&jt.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",t.reason)})),rxt(f,[u,c],{node:e?.node,scale:!1,opacity:e?.opacity,ariaLabel:e?.ariaLabel,rotations:a,useRotationSize:l})}function Kxt(t,e){const i=t.symbolLayers,n=[],s=L_t(t),r=Zxt(e),o=(e?.maxSize?QA(e.maxSize):null)||Rxt;let a,l=0,u=0;return i.forEach(((t,e)=>{if(!t)return;if("line"!==t.type&&"path"!==t.type)return;const i=[];switch(t.type){case"line":{const n=Vxt(t,0);if(null==n)break;const s=n?.width||0;0===e&&(a=s);const c=Math.min(r||s,o),h=0===e?c:r?c*(s/a):c,d=h>Lxt/2?2*h:Lxt;u=Math.max(u,h),l=Math.max(l,d),n.width=h,i.push({shape:{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[l,.5*u]}]},stroke:n});break}case"path":{const e=Math.min(r||jxt,o),n=zxt(t,0),s=zxt(t,-.2),a=Gxt(t,-.4),c=a?{color:a,width:1}:{};if("quad"===t.profile){const e=t.width,r=t.height,o=ASt(e&&r?e/r:1,0===r,0===e),a={...c,join:"bevel"};i.push({shape:o[0],fill:s,stroke:a},{shape:o[1],fill:s,stroke:a},{shape:o[2],fill:n,stroke:a})}else i.push({shape:TSt.pathSymbol3DLayer[0],fill:s,stroke:c},{shape:TSt.pathSymbol3DLayer[1],fill:n,stroke:c});u=Math.max(u,e),l=u}}n.push(i)})),Promise.resolve(rxt(n,[l,u],{node:e?.node,scale:s,opacity:e?.opacity,ariaLabel:e?.ariaLabel}))}async function Qxt(t,e){const i="mesh-3d"===t.type,n=t.symbolLayers,s=Zxt(e),r=e?.maxSize?QA(e.maxSize):null,o=s||jxt,a=[];let l=0,u=0,c=!1;for(let t=0;t<n.length;t++){const e=n.at(t),s=[];if(!i||"fill"===e.type){switch(e.type){case"fill":{const t=Math.min(o,r||Oxt);if(l=Math.max(l,t),u=Math.max(u,t),c=!0,i){const t=TSt.meshSymbol3DFill,i=Gxt(e,-.4),n=i?{color:i,width:1,join:"round"}:{};s.push({shape:t[0],fill:zxt(e,0),stroke:n},{shape:t[1],fill:zxt(e,-.2),stroke:n},{shape:t[2],fill:zxt(e,-.6),stroke:n})}else{let t=zxt(e,0);const i="pattern"in e?e.pattern:null,n=Pxt(e),r=$xt(e);null!=i&&"style"===i.type&&"solid"!==i.style&&r&&(t=await Uxt(i,r)),s.push({shape:TSt.fill[0],fill:t,stroke:n})}break}case"line":{const t=Vxt(e,0);if(null==t)break;const i={stroke:t,shape:TSt.fill[0]};l=Math.max(l,jxt),u=Math.max(u,jxt),s.push(i);break}case"extrude":{const t={join:"round",width:1,...Vxt(e,-.4)},i=zxt(e,0),n=zxt(e,-.2),a=Math.min(o,r||Oxt),c=ISt(a);t.width=1,s.push({shape:c[0],fill:n,stroke:t},{shape:c[1],fill:n,stroke:t},{shape:c[2],fill:i,stroke:t});const h=jxt,d=.7*jxt+.5*a;l=Math.max(l,h),u=Math.max(u,d);break}case"water":{const t=$xt(e),i=Dxt(t),n=Dxt(t,2),a=Dxt(t,3),h=kSt();c=!0,s.push({shape:h[0],fill:i},{shape:h[1],fill:n},{shape:h[2],fill:a});const d=Math.min(o,r||Oxt);l=Math.max(l,d),u=Math.max(u,d);break}}a.push(s)}}return rxt(a,[l,u],{node:e?.node,scale:c,opacity:e?.opacity,ariaLabel:e?.ariaLabel})}function Xxt(t,e){if(0===t.symbolLayers.length)return Promise.reject(new Ve("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return Yxt(t,e);case"line-3d":return Kxt(t,e);case"polygon-3d":case"mesh-3d":return Qxt(t,e)}return Promise.reject(new Ve("symbolPreview: swatchInfo3D","symbol not supported."))}const tMt=Object.freeze({__proto__:null,getPatternDescriptor:Uxt,getSizeFromOptions:Zxt,getSymbolLayerFill:zxt,previewSymbol3D:Xxt});const eMt={HH:315,HL:45,LL:135,LH:225},iMt={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function nMt(t){if(!t)return;const{type:e}=t;if(e.includes("3d"))return zxt(t.symbolLayers.at(0));if("simple-line"===e){const e=WSt(t);return e&&e.color}if("simple-marker"===t.type&&("x"===t.style||"cross"===t.style)){const e=WSt(t);return e&&e.color}return qSt(t)}function sMt(t,e){const i=e.HH.label,n=e.LL.label,s=e.HL.label,r=e.LH.label;switch(t){case"HH":default:return{top:i,bottom:n,left:s,right:r};case"HL":return{top:s,bottom:r,left:n,right:i};case"LL":return{top:n,bottom:i,left:r,right:s};case"LH":return{top:r,bottom:s,left:i,right:n}}}function rMt(t){const{focus:e,infos:i,numClasses:n}=t,s=iMt[n],r={};i.forEach((t=>{r[t.value]={label:t.label,fill:nMt(t.symbol)}}));const o=[];for(let t=0;t<n;t++){const e=[];for(let i=0;i<n;i++){const n=r[s[t][i]];e.push(n.fill)}o.push(e)}return{type:"relationship-ramp",numClasses:n,focus:e,colors:o,labels:sMt(e,r),rotation:oMt(e)}}function oMt(t){let e=eMt[t];return t&&null==e&&(e=eMt.HH),e||0}let aMt=null;const lMt=[255,255,255];function uMt(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function cMt(t,e,i){const{backgroundColor:n,outline:s,dotSize:r}=t,o=i?.swatchSize||MSt.size,a=.8,l=Math.round(o*o/Math.max(r,.5)**2*a),u=window.devicePixelRatio,c=document.createElement("canvas"),h=o*u;c.width=h,c.height=h,c.style.width=c.width/u+"px",c.style.height=c.height/u+"px";const d=c.getContext("2d");if(n&&(d.fillStyle=n.toCss(!0),d.fillRect(0,0,h,h),d.fill()),d.fillStyle=e?.toCss(!0)??"",aMt&&aMt.length/2===l)for(let t=0;t<2*l;t+=2){const e=aMt[t],i=aMt[t+1];d.fillRect(e,i,r*u,r*u),d.fill()}else{aMt=[];for(let t=0;t<2*l;t+=2){const t=uMt(0,h),e=uMt(0,h);aMt.push(t,e),d.fillRect(t,e,r*u,r*u),d.fill()}}s&&(s.color&&(d.strokeStyle=s.color.toCss(!0)),d.lineWidth=s.width,d.strokeRect(0,0,h,h));const f=new Image(o,o);return f.src=c.toDataURL(),f.ariaLabel=i?.ariaLabel??null,f.alt=i?.ariaLabel??"",f}function hMt(t,e={}){const i=e.radius||40,n=2*Math.PI*i,s=t.length,r=n/s,o=[],a=WSt(e.outline);null!=a?.width&&(a.width*=2),(a||e.backgroundColor)&&o.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:e.backgroundColor,stroke:a,offset:[0,0]});const l=e.values,u=l&&l.length===s&&100===l.reduce(((t,e)=>t+e),0),c=[0];for(let e=0;e<s;e++){let s=null;u&&(s=l[e]*n/100,c.push(s+c[e])),o.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(s??r)/2} ${n}`,dashoffset:"-"+(u?c[e]/2:e*(r/2)),color:t[e]},offset:[0,0]})}let h=null;const d=2*i+(a?.width||0),f=e.holePercentage;if(f){a&&o.push({shape:{type:"circle",cx:i,cy:i,r:i*f},fill:null,stroke:a,offset:[0,0]});const t=d/2;h=[[{shape:{type:"circle",cx:t,cy:t,r:t},fill:lMt,stroke:a?{...a,color:lMt}:null,offset:[0,0]},{shape:{type:"circle",cx:t,cy:t,r:i*f},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return rxt([o],[d,d],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:h,rotations:[-90],ariaLabel:e.ariaLabel})}function dMt(t,e={}){const i=24,n=75,s="horizontal"===e.align,r=s?n:i,o=s?i:n,a=e.width??r,l=e.height??o,u=e.gradient??!0,c=window.devicePixelRatio,h=a*c,d=l*c,f=document.createElement("canvas");f.width=h,f.height=d,f.ariaLabel=e.ariaLabel??null,f.style.width=`${a}px`,f.style.height=`${l}px`;const p=f.getContext("2d"),m=s?h:0,y=s?0:d;if(u){const e=p.createLinearGradient(0,0,m,y),i=t.length,n=1===i?0:1/(i-1);t.forEach(((t,i)=>e.addColorStop(i*n,t.toString()))),p.fillStyle=e,p.fillRect(0,0,h,d)}else{const e=s?h/t.length:h,i=s?d:d/t.length;let n=0,r=0;for(const o of t)p.fillStyle=o.toString(),p.fillRect(n,r,e,i),n=s?n+e:0,r=s?0:r+i}const g=document.createElement("div");return g.style.width=`${a}px`,g.style.height=`${l}px`,fMt(g,e?.effectList),g.appendChild(f),g}function fMt(t,e){if(!e)return;t.style.filter=ext(e);const i=e.effects;if(i)for(const e of i)if("drop-shadow"===e?.type){e.offsetX<0?t.style.marginLeft=`${Math.abs(e.offsetX)}px`:t.style.marginRight=`${e.offsetX}px`;break}}async function pMt(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:i}=await import("./p-03d9dc6c.js");return i(t,pMt,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await Promise.resolve().then((function(){return tMt}));return i(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await import("./p-3eee9af2.js");return i(t,e)}case"cim":{const{previewCIMSymbol:i}=await import("./p-411ba250.js");return i(t,e)}default:return}}function mMt(t){return t&&"opacity"in t?t.opacity*mMt(t.parent):1}async function yMt(t,e){if(!t)return;const i=t.sourceLayer,n=(null!=e&&e.useSourceLayer?i:t.layer)??i,s=mMt(n);if(null!=t.symbol&&(null==e||!0!==e.ignoreGraphicSymbol)){const i="web-style"===t.symbol.type?await ixt(t.symbol,{...e,cache:null!=e?e.webStyleCache:null}):t.symbol.clone();return U_t(i,null,s),i}const r=e?.renderer??gMt(n);let o=r&&"getSymbolAsync"in r?await r.getSymbolAsync(t,e):null;if(!o)return;if(o="web-style"===o.type?await o.fetchSymbol({...e,cache:null!=e?e.webStyleCache:null}):o.clone(),!r||!("visualVariables"in r)||!r.visualVariables?.length)return U_t(o,null,s),o;if("arcadeRequiredForVisualVariables"in r&&r.arcadeRequiredForVisualVariables&&null==e?.arcade){const t={...e};t.arcade=await PE(),e=t}const{getColor:a,getOpacity:l,getAllSizes:u,getRotationAngle:c}=await Promise.resolve().then((function(){return C9})),h=[],d=[],f=[],p=[];for(const t of r.visualVariables)switch(t.type){case"color":h.push(t);break;case"opacity":d.push(t);break;case"rotation":p.push(t);break;case"size":t.target||f.push(t)}const m=!!h.length&&h[h.length-1],y=m?a(m,t,e):null,g=!!d.length&&d[d.length-1];let v=g?l(g,t,e):null;if(null!=s&&(v=null!=v?v*s:s),U_t(o,y,v),f.length){const i=u(f,t,e);await X_t(o,i)}for(const i of p)txt(o,c(i,t,e),i.axis);return o}function gMt(t){if(t)return"renderer"in t?t.renderer:void 0}function vMt(t,e,i){const n=t.effectiveClusterRenderer;if(!n||!("visualVariables"in n)||!n.visualVariables)return null;const s=n.visualVariables.find((t=>"size"===t.type));if(!("stops"in s)||!s.stops)return null;const r=s.stops.find((t=>t.useMinValue)),o=s.stops.find((t=>t.useMaxValue));if(null==r||null==o)return null;const a=i.featuresTilingScheme.getClosestInfoForScale(i.scale).level,l=s.field,u=e.getDisplayStatistics(a,l);return u?new P9({field:s.field,minSize:t.clusterMinSize,minDataValue:u.minValue,maxSize:t.clusterMaxSize,maxDataValue:u.maxValue}):null}const wMt=/^-?(\d+)(\.(\d+))?$/i;function bMt(t,e){return t-e}function SMt(t,e){let i,n;return i=Number(t.toFixed(e)),i<t?n=i+1/10**e:(n=i,i-=1/10**e),i=Number(i.toFixed(e)),n=Number(n.toFixed(e)),[i,n]}function _Mt(t,e,i,n,s){const r=MMt(t,e,i,n),o=null==r.previous||r.previous<=s,a=null==r.next||r.next<=s;return o&&a||r.previous+r.next<=2*s}function xMt(t){const e=String(t),i=e.match(wMt);if(i?.[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(e.toLowerCase().includes("e")){const t=e.split("e"),i=t[0],n=t[1];if(i&&n){const t=Number(i);let e=Number(n);const s=e>0;s||(e=Math.abs(e));const r=xMt(t);return s?(r.integer+=e,e>r.fractional?r.fractional=0:r.fractional-=e):(r.fractional+=e,e>r.integer?r.integer=1:r.integer-=e),r}}return{integer:0,fractional:0}}function MMt(t,e,i,n){const s={previous:null,next:null};if(null!=i){const n=t-i,r=e-i-n;s.previous=Math.floor(Math.abs(100*r/n))}if(null!=n){const i=n-t,r=n-e-i;s.next=Math.floor(Math.abs(100*r/i))}return s}function TMt(t,e={}){const i=t.slice(),{tolerance:n=2,strictBounds:s=!1,indexes:r=i.map(((t,e)=>e))}=e;r.sort(bMt);for(let t=0;t<r.length;t++){const e=r[t],o=i[e],a=0===e?null:i[e-1],l=e===i.length-1?null:i[e+1],u=xMt(o).fractional;if(u){let r,c=0,h=!1;for(;c<=u&&!h;){const e=SMt(o,c);r=s&&0===t?e[1]:e[0],h=_Mt(o,r,a,l,n),c++}h&&(i[e]=r)}}return i}const AMt={maximumFractionDigits:20};function IMt(t){return Jg(t,AMt)}function kMt(t){return Gj(t)||Vj(t)||qj(t)}function CMt(t,e){const{format:i,timeZoneOptions:n,fieldType:s}=e??{};let r,o;if(n&&({timeZone:r,timeZoneName:o}=vg(n.layerTimeZone,n.datesInUnknownTimezone,n.viewTimeZone,Dg(i||"short-date-short-time"),s)),"string"==typeof t&&isNaN(Date.parse("time-only"===s?`1970-01-01T${t}Z`:t)))return t;switch(s){case"date-only":{const e=Dg(i||"short-date");return"string"==typeof t?zg(t,{...e}):$g(t,{...e,timeZone:lg})}case"time-only":{const e=Dg(i||"short-time");return"string"==typeof t?Ug(t,e):$g(t,{...e,timeZone:lg})}case"timestamp-offset":{if(!r&&"string"==typeof t&&new Date(t).toISOString()!==t)return t;const e=i||n?Dg(i||"short-date-short-time"):void 0,s=e?{...e,timeZone:r,timeZoneName:o}:void 0;return"string"==typeof t?Bg(t,s):$g(t,s)}default:{const e=i||n?Dg(i||"short-date-short-time"):void 0;return $g("string"==typeof t?new Date(t):t,e?{...e,timeZone:r,timeZoneName:o}:void 0)}}}const EMt="<",jMt=">";function OMt(t,e,i,n){let s="";0===e?s=`${EMt} `:e===i&&(s=`${jMt} `);return s+(n?CMt(t,n):IMt(t))}const RMt=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function LMt(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find((t=>"color"===t.type));if(!e)return null;let i=null,n=null;if(e.stops){if(1===e.stops.length)return e.stops[0].color;i=e.stops[0].value,n=e.stops[e.stops.length-1].value}const s=null!=i&&null!=n?i+(n-i)/2:0,{getColor:r}=await Promise.resolve().then((function(){return C9}));return r(e,s)??null}async function NMt(t,e){const i=t.trailCap,n=t.trailWidth||1,s=e||await LMt(t)||t.color;return new DL({cap:i,color:s,width:n})}function PMt(t,e){if(!e.field)return null;if("featureReduction"in t)switch(t.featureReduction?.type){case"cluster":case"binning":{const i=t.featureReduction.fields.find((({name:t})=>t.toLowerCase()===e.field.toLowerCase()));return i&&"getField"in t?t.getField(i.onStatisticField):null}}return"getField"in t?t.getField?.(e.field):null}function FMt(t,e){const i="popupTemplate"in t?t.popupTemplate?.fieldInfos:null;if(i?.length&&e)return i.find((t=>t.fieldName?.toLowerCase()===e.toLowerCase()))?.format?.dateFormat}function DMt(t,e,i){const n=PMt(t,e);if(!n||!kMt(n)&&!Hj(n))return null;let s=FMt(t,n.name);if(!s&&"date"===n.type){let t=0,i=0;e.stops?(t=e.stops?.at(0)?.value??t,i=e.stops?.at(-1)?.value??i):"minDataValue"in e&&"maxDataValue"in e&&(t=e.minDataValue??t,i=e.maxDataValue??i),s=i-t>2*yC.days?"short-date":"short-date-short-time"}return{fieldType:n.type,format:s,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:i,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}function $Mt(t){if("authoringInfo"in t)return t.authoringInfo?.visualVariables?.find((({theme:t})=>"reference-size"===t))}const zMt=new RA([64,64,64]);function UMt(t,e){const i=[],n=t.length-1;return 5===t.length?i.push(0,2,4):i.push(0,n),t.map(((t,s)=>i.includes(s)?OMt(t,s,n,e):null))}async function BMt(t,e,i){let n=!1,s=[],r=[];if(t.stops){const e=t.stops;s=e.map((t=>t.value)),n=e.some((t=>!!t.label)),n&&(r=e.map((t=>t.label)))}const o=s[0],a=s[s.length-1];if(null==o&&null==a)return null;const l=n?null:UMt(s,i);return(await Promise.all(s.map((async(i,s)=>({value:i,color:"opacity"===t.type?await GMt(i,t,e):(await Promise.resolve().then((function(){return C9}))).getColor(t,i),label:n?r[s]:l?.[s]??""}))))).reverse()}async function GMt(t,e,i){const n=new RA(i??zMt),s=(await Promise.resolve().then((function(){return C9}))).getOpacity(e,t);return null!=s&&(n.a=s),n}function VMt(t){let e=!1,i=[],n=[];i=t.map((t=>t.value)),e=t.some((t=>!!t.label)),e&&(n=t.map((t=>t.label??"")));const s=i[0],r=i[i.length-1];if(null==s&&null==r)return null;const o=e?null:UMt(i);return i.map(((i,s)=>({value:i,color:qMt(i,t),label:e?n[s]:o?.[s]??""}))).reverse()}function qMt(t,e){const{startIndex:i,endIndex:n,weight:s}=HMt(t,e);if(i===n)return e[i].color;const r=RA.blendColors(e[i].color,e[n].color,s);return new RA(r)}function HMt(t,e){let i=0,n=e.length-1;return e.some(((e,s)=>t<e.value?(n=s,!0):(i=s,!1))),{startIndex:i,endIndex:n,weight:(t-e[i].value)/(e[n].value-e[i].value)}}function WMt(t,e){let i=[];if(t&&"multipart"===t.type)t.colorRamps.reverse().forEach(((n,s)=>{0===s?i.push({value:e.max,color:new RA(n.toColor),label:"high"}):i.push({value:null,color:new RA(n.toColor),label:""}),s===t.colorRamps.length-1?i.push({value:e.min,color:new RA(n.fromColor),label:"low"}):i.push({value:null,color:new RA(n.fromColor),label:""})}));else{let n,s;t&&"algorithmic"===t.type?(n=t.fromColor,s=t.toColor):(n=[0,0,0,1],s=[255,255,255,1]),i=[{value:e.max,color:new RA(s),label:"high"},{value:e.min,color:new RA(n),label:"low"}]}return i}function ZMt(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter((t=>t.color?.a>0));let i=e.length-1;if(e&&e[0]){const t=e[i];t&&1!==t.ratio&&(e.push(new Est({ratio:1,color:t.color})),i++)}return e.map(((e,n)=>{let s="";return 0===n?s=t.legendOptions?.minLabel||"low":n===i&&(s=t.legendOptions?.maxLabel||"high"),{color:e.color,label:s,ratio:e.ratio}})).reverse()}const JMt=30,YMt=12,KMt=24,QMt=[255,255,255],XMt=[200,200,200],tTt=[128,128,128],eTt=20,iTt=5;function nTt(t){return"esri.symbols.SimpleMarkerSymbol"===t.declaredClass}function sTt(t){return"esri.symbols.PictureMarkerSymbol"===t.declaredClass}function rTt(t){return"esri.symbols.SimpleLineSymbol"===t.declaredClass}function oTt(t){return"esri.symbols.TextSymbol"===t.declaredClass}function aTt(t,e){const i=t.length-1;return t.map(((t,n)=>OMt(t,n,i,e)))}async function lTt(t,e,i,n,s,r,o){const a=e.legendOptions,l=a?.customValues,u=o||await dTt(t,i),c=e.stops,h=!!u,d=!!l,f=null!=e.minSize&&null!=e.maxSize,p=c&&c.length>1,m=!!e.target;if(!h||!d&&!(f||p&&!m))return;const y=L_t(u);let g=!1,v=null,w=null;v=y&&!p?TMt([e.minDataValue,e.maxDataValue]):l??await yTt(e,u,n,s?.type);const b=t?.authoringInfo,S="univariate-color-size"===b?.type,_=S&&"above-and-below"===b?.univariateTheme,x=!!$Mt(t);if(!v&&p&&(v=c.map((t=>t.value)),g=c.some((t=>!!t.label)),"flow"===t.type&&(v=TMt(v)),g&&(w=c.map((t=>t.label)))),y&&null!=v&&v?.length>2&&!_&&(v=[v[0],v[v.length-1]]),!v)return null;S&&5!==v?.length&&(v=gTt({minSize:v[0],maxSize:v[v.length-1]}));const M=y?uTt(t,v):null,T=R_t(u),A=g?null:aTt(v,r);return(await Promise.all(v.map((async(r,o)=>{const a=y?M[o]:await bTt(e,u,r,n,s?.type);return{value:r,symbol:!x||"class-breaks"!==t.type&&"unique-value"!==t.type?STt(_&&"class-breaks"===t.type?hTt(t,o):u,a):cTt(t,a,e.maxSize,i)??u,label:g?w[o]:A[o],size:x?KMt:a,outlineSize:T}})))).reverse()}function uTt(t,e){const i=t?.authoringInfo,n="univariate-color-size"===i?.type;let s=[YMt,JMt];if(n){const t=e[0],i=e[e.length-1],n=YMt,r=JMt;s=e.map((e=>n+(e-t)/(i-t)*(r-n)))}return n&&"below"===i?.univariateTheme&&s.reverse(),s}function cTt(t,e,i,n){const s="class-breaks"===t.type,r=s?t.classBreakInfos?.[0]?.symbol?.clone():t.uniqueValueInfos?.[0]?.symbol?.clone();return r&&"type"in r&&"cim"===r.type?(vSt(r,{color:n??(s?null:new RA(XMt)),innerDotSize:e*(KMt/i)||1,outerRingSize:KMt}),r):null}function hTt(t,e){const i=t.classBreakInfos,n=i.length,s=n<2||!(e>=2)?i[0].symbol.clone():i[n-1].symbol.clone(),r=t.visualVariables?.some((t=>"color"===t.type));return r&&(s.type.includes("3d")?pTt(s):mTt(s)),s}async function dTt(t,e){if("flow"===t.type)return NMt(t,e);if("pie-chart"===t.type)return new lD({color:null,outline:t.outline?.width?t.outline:new DL});let i=null,n=null;if("simple"===t.type)i=t.symbol;else if("class-breaks"===t.type){const e=t.classBreakInfos;i=e&&e[0]&&e[0].symbol,n=e.length>1}else if("unique-value"===t.type){const e=t.uniqueValueInfos;i=e?.[0]?.symbol,n=null!=e&&e.length>1}return!i||fTt(i)?null:(i=i.clone(),(e||n)&&(i.type.includes("3d")?pTt(i):mTt(i)),i)}function fTt(t){if(t){if(yD(t)){return!!t.symbolLayers&&t.symbolLayers.some((t=>t&&"fill"===t.type))}return t.type.includes("fill")}return!1}function pTt(t){"line-3d"===t.type?t.symbolLayers.forEach((t=>{t.material={color:tTt}})):t.symbolLayers.forEach((t=>{"icon"!==t.type||t.resource?.href?t.material={color:XMt}:(t.material={color:QMt},t.outline={color:tTt,size:1.5})}))}function mTt(t){const e=D0();if("cim"===t.type)_St(t,new RA(XMt));else if(t.type.includes("line"))t.color=tTt;else if(t.color=e?tTt:QMt,"simple-marker"===t.type)if(t.outline){const e=t.outline?.color?.toHex();"#ffffff"===e&&(t.outline.color=tTt)}else t.outline={color:tTt,width:1.5}}async function yTt(t,e,i,n){const s=(await Promise.resolve().then((function(){return C9}))).getSizeRangeAtScale(t,i,n),r=s&&gTt(s);if(!s||!r)return;let o=r.map((e=>vTt(e,t,s)));o=TMt(o);for(let s=1;s<o.length-1;s++){const a=await wTt(t,e,o[s],o[s-1],i,n);a&&(o[s]=a[0],r[s]=a[1])}return o}function gTt(t){const e=t.minSize,i=t.maxSize,n=iTt,s=(i-e)/(n-1),r=[];for(let t=0;t<n;t++)r.push(e+s*t);return r}function vTt(t,e,i){const n=i.minSize,s=i.maxSize,r=e.minDataValue,o=e.maxDataValue;let a;if(t<=n)a=r;else if(t>=s)a=o;else{a=(t-n)/(s-n)*(o-r)+r}return a}async function wTt(t,e,i,n,s,r){const o=await bTt(t,e,i,s,r),a=await bTt(t,e,n,s,r),l=xMt(i),u=l.fractional,c=eTt;let h=l.integer,d=null,f=null;i>0&&i<1&&(d=10**u,h=xMt(i*=d).integer);for(let n=h-1;n>=0;n--){const l=10**n;let u=Math.floor(i/l)*l,h=Math.ceil(i/l)*l;null!=d&&(u/=d,h/=d);let p=(u+h)/2;[,p]=TMt([u,p,h],{indexes:[1]});const m=await bTt(t,e,u,s,r),y=await bTt(t,e,h,s,r),g=await bTt(t,e,p,s,r),v=MMt(o,m,a,null),w=MMt(o,y,a,null),b=MMt(o,g,a,null);let S=v.previous<=c,_=w.previous<=c;if(S&&_&&(v.previous<=w.previous?(S=!0,_=!1):(_=!0,S=!1)),S?f=[u,m]:_?f=[h,y]:b.previous<=c&&(f=[p,g]),f)break}return f}async function bTt(t,e,i,n,s){const{getSize:r}=await Promise.resolve().then((function(){return C9}));return r(t,i,{scale:n,view:s,shape:"simple-marker"===e.type?e.style:null})}function STt(t,e){const i=t.clone();if(yD(i))L_t(i)||i.symbolLayers.forEach((t=>{"fill"!==t.type&&(t.size=e)}));else if(nTt(i))i.size=e;else if(sTt(i)){const t=i.width,n=i.height;i.height=e,i.width=e*(t/n)}else rTt(i)?i.width=e:oTt(i)&&i.font&&(i.font.size=e);return i}function _Tt(t){const e=2,i=Math.floor(Math.log10(Math.abs(t)))+1,n=i<4||i>6?4:i,s=1e6,r=Math.abs(t)>=s?"compact":"standard";return Jg(t,{notation:r,minimumSignificantDigits:e,maximumSignificantDigits:n})}const xTt=16,MTt="https://utility.arcgis.com/sharing/tools/legend",TTt="esri.layers.ImageryLayer",ATt="esri.layers.ImageryTileLayer",ITt="esri.layers.WCSLayer",kTt=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,CTt=new Co({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),ETt=new lD({size:6,outline:{color:[128,128,128,.5],width:.5}}),jTt=new sD({style:"solid"});function OTt(t){return"flow"===t.type}function RTt(t){return"vector-field"===t.type}function LTt(t){return"raster-colormap"===t.type}function NTt(t){return"raster-stretch"===t.type}function PTt(t){return"raster-shaded-relief"===t.type}function FTt(t){return"esri.renderers.SimpleRenderer"===t.declaredClass}function DTt(t){return"esri.renderers.ClassBreaksRenderer"===t.declaredClass}function $Tt(t){return"esri.renderers.UniqueValueRenderer"===t.declaredClass}function zTt(t){return"esri.renderers.HeatmapRenderer"===t.declaredClass}function UTt(t){return GTt(t)||VTt(t)||qTt(t)||BTt(t)}function BTt(t){return"esri.renderers.PointCloudRGBRenderer"===t.declaredClass}function GTt(t){return"esri.renderers.PointCloudClassBreaksRenderer"===t.declaredClass}function VTt(t){return"esri.renderers.PointCloudStretchRenderer"===t.declaredClass}function qTt(t){return"esri.renderers.PointCloudUniqueValueRenderer"===t.declaredClass}function HTt(t){return"esri.renderers.DotDensityRenderer"===t.declaredClass}function WTt(t){return"esri.renderers.PieChartRenderer"===t.declaredClass}function ZTt(t,e){return FTt(t)||DTt(t)||$Tt(t)||zTt(t)||HTt(t)||WTt(t)?"2d"===e.type||uSt(t):NTt(t)||LTt(t)||PTt(t)||GTt(t)||VTt(t)||qTt(t)||RTt(t)||OTt(t)}function JTt(t){return"esri.layers.BuildingSceneLayer"===t.declaredClass}function YTt(t){return"esri.layers.SubtypeGroupLayer"===t.declaredClass}function KTt(t){return"esri.layers.VoxelLayer"===t.declaredClass}function QTt(t){return"esri.layers.WMSLayer"===t.declaredClass}function XTt(t){return"esri.layers.WMTSLayer"===t.declaredClass}function tAt(t){return"esri.layers.MapImageLayer"===t.declaredClass}function eAt(t){return"esri.layers.TileLayer"===t.declaredClass}function iAt(t){return t.declaredClass===TTt}function nAt(t){return t.declaredClass===ATt}function sAt(t){return t.declaredClass===ITt}function rAt(t){return"stretch-ramp"===t.type}function oAt(t){const e="authoringInfo"in t?t?.authoringInfo:null;return"univariate-color-size"===e?.type}function aAt(t){const e="authoringInfo"in t?t?.authoringInfo:null;return"univariate-color-size"===e?.type&&"above-and-below"===e?.univariateTheme}function lAt(t){return"sublayers"in t}async function uAt(t,e){const i=await hv("esri/widgets/Legend/t9n/Legend");return"previewTemplateAriaLabel"!==t||e||(t="previewAriaLabel"),Xg(i[t],{label:e})}function cAt(t,e){const{field:i,field2:n,field3:s,fieldDelimiter:r,valueExpression:o}=t;if(!i)return null;const a=!(!i&&!o||!n&&!s)?e?.toString().split(r||""):[e],l=i?{[i]:a?.[0]}:null;return l&&(n&&(l[n]=a?.[1]),s&&(l[s]=a?.[2])),l}const hAt=new lD({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let dAt={},fAt=class extends ao{constructor(t){super(t),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this._layerDefinitionExpression=null,this._layerDefinitionExpressionClause=null,this.children=new Vm,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const t=()=>this.notifyChange("ready");this.addHandles([sy((()=>this.children),"change",(e=>{const{added:i,removed:n}=e;i.forEach((e=>{const i=`activeLayerInfo-ready-watcher-${e.layer.uid}`;this.addHandles(ey((()=>e.ready),t,dy),i)})),n.forEach((t=>this.removeHandles(t.layer.uid))),t()}))]),this.keepCacheOnDestroy||(dAt={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(dAt=null),this._layerDefinitionExpressionClause=null}get effectList(){const t=this.layer;let e=null;return"effect"in t&&t.effect&&(e=new Pbt,e.effect=t.effect,e.endTransition(),e.scale=this.scale),e}get opacity(){const t=this.layer.opacity,e=this.parent?.opacity,i=this.layer.parent,n=i&&"uid"in i?this._getParentLayerOpacity(i):null;return null!=e?e*t:null!=n?n*t:t}get ready(){return null===this.layer||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){return this.view?.scale??0}get isScaleDriven(){const t=this.layer;if(null===t)return!1;if("effect"in t&&t.effect&&Array.isArray(t.effect))return!0;if("featureReduction"in t&&t.featureReduction){if("cluster"===t.featureReduction.type)return!0;if("binning"===t.featureReduction.type&&"renderer"in t.featureReduction&&t.featureReduction.renderer)return this._isRendererScaleDriven(t.featureReduction.renderer)}return"renderer"in t&&t.renderer?this._isRendererScaleDriven(t.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(t){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const e=Array.from(t,(t=>{if(GT(t))return this._getRendererLegendElements(t.renderer,{title:t.title});if(t.featureSet?.features.length){const e=t.layerDefinition,i=e?.drawingInfo,n=i&&Vrt(i.renderer),s=CTt.read(e.geometryType);return n?this._getRendererLegendElements(n,{title:t.name,geometryType:s}):(jt.getLogger(this).warn("drawingInfo not available!"),null)}return null}));try{const t=[],i=await Promise.allSettled(e);for(const e of i)if("fulfilled"===e.status)for(const i of e.value??[])t.push(i);this.legendElements=t,this.notifyChange("ready")}catch(t){jt.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForRenderer(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getRendererLegendElements(t):[],this.notifyChange("ready")}catch(t){jt.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForFeatureReduction(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getLegendElementsForFeatureReduction(t):[],this.notifyChange("ready")}catch(t){jt.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForTools(){const t=this.layer;if(KTt(t))this._constructLegendElementsForVoxelLayer();else if(XTt(t))this._constructLegendElementsForWMTSlayer();else if(QTt(t))await this._constructLegendElementsForWMSSublayers();else if(JTt(t))await this._constructLegendElementsForBuildingSceneLayer();else if(tAt(t)||eAt(t)||YTt(t))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let e="default";if(iAt(t)){const i=t;e=(i?.rasterFunction?.functionName||"default")+"_"+(t.bandIds?.length?t.bandIds.join(""):"###")}if(nAt(t)||"link-chart"===t.type)return;await this._getLegendLayers(`${t.uid}-${e}`).then((async e=>{this.legendElements=[],this.notifyChange("ready");const i=e.map((async e=>{if(iAt(t)){const e=ey((()=>[t.rasterFunction,t.bandIds]),(()=>$s((async()=>{dAt.default=null,t.renderer?await this.buildLegendElementsForRenderer(t.renderer):await this.buildLegendElementsForTools()}))()));this.addHandles(e,"imageryLayers-watcher")}const i=this._generateSymbolTableElementForLegendLayer(e);i?.infos.length&&(iAt(t)&&(i.title=t.title),this.legendElements.push(i)),this.notifyChange("ready")}));await Promise.allSettled(i)})).catch((t=>{jt.getLogger(this).warn("Request to server for legend has failed!",t)}))}}async _isLayerInCurrentView(){const t=this.layer,e=this.layerView,i=e&&"createQuery"in e&&"queryFeatureCount"in e;if(!i&&!(e&&"createQuery"in t&&"queryFeatureCount"in t))return!0;await oy((()=>!e.updating));const n=i?"createQuery"in e&&e.createQuery():"createQuery"in t&&t.createQuery();if(!n)return!0;n.geometry=this.view.extent;return 0!==(i?"queryFeatureCount"in e&&await e.queryFeatureCount(n):"queryFeatureCount"in t&&await t.queryFeatureCount(n))}_getParentLayerOpacity(t){let e=1;const i=t.parent;return i&&"uid"in i&&(e=this._getParentLayerOpacity(i)),t.opacity*e}_isGroupActive(){return this.children.some((t=>t.ready))}_isRendererScaleDriven(t){if("dot-density"===t.type)return!0;const e="valueExpression"in t?t.valueExpression:null;if(kTt.test(e))return!0;const i="visualVariables"in t?t.visualVariables:null;return!!i?.some((t=>this._isScaleDrivenSizeVariable(t)))||this._hasScaleDrivenSymbols(t)}_hasScaleDrivenSymbols(t){switch(t.type){case"simple":return this._isScaleDrivenSymbol(t.symbol);case"class-breaks":return this._isScaleDrivenSymbol(t.defaultSymbol)||t.classBreakInfos.some((t=>this._isScaleDrivenSymbol(t.symbol)));case"unique-value":return this._isScaleDrivenSymbol(t.defaultSymbol)||!!t.uniqueValueInfos?.some((t=>this._isScaleDrivenSymbol(t.symbol)))}return!1}_isScaleDrivenSymbol(t){if("cim"===t?.type){const{primitiveOverrides:e,minScale:i,maxScale:n}=t.data,s=e?.some((t=>/\$view\.scale/.test(t.valueExpressionInfo?.expression||"")))??!1;return null!=i||null!=n||s}return!1}_isScaleDrivenSizeVariable(t){if(t&&"size"!==t.type)return!1;const e=t,i=e.minSize,n=e.maxSize;return!("object"!=typeof i||!i||!this._isScaleDrivenSizeVariable(i))||(!("object"!=typeof n||!n||!this._isScaleDrivenSizeVariable(n))||kTt.test(e.valueExpression))}_isLayerScaleDriven(t){if("minScale"in t&&t.minScale>0||"maxScale"in t&&t.maxScale>0)return!0;if("sublayers"in t&&t.sublayers)return t.sublayers.some((t=>this._isLayerScaleDriven(t)));const e=t.parent;if(!1===t.loaded&&e&&tAt(e)&&"source"in t&&t.source&&"map-layer"===t.source.type)for(const i of e.sourceJSON.layers??[])if(i.id===t.source.mapLayerId&&(i.minScale>0||i.maxScale>0))return!0;return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const t=this.layer;this.addHandles(ey((()=>t.currentVariableId),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-current-variable"),this.addHandles(ey((()=>t.getVariableStyles()),(()=>this._constructLegendElementsForVoxelLayer())),"voxel-style-watcher");const e=t.getVariableStyle(null),i=[];if(e)if(e.uniqueValues?.length){const t=[];e.uniqueValues.forEach((e=>{e.enabled&&t.push({label:e.label||`${e.value}`,value:e.value,symbol:new sD({color:e.color,outline:null})})})),t.length&&i.push({type:"symbol-table",title:e.label,infos:t})}else if(e.transferFunction){const{colorStops:t,stretchRange:n}=e.transferFunction,s=t.toArray().reverse(),r=n.map(((t,e)=>`${0===e?EMt:jMt} ${_Tt(t)}`)).reverse(),o=s.map((t=>({color:t.color,value:null,label:null})));o[0].label=r[0],o[o.length-1].label=r[1],i.push({type:"color-ramp",title:e.label,infos:o,preview:dMt(s.map((t=>t.color)),{ariaLabel:await uAt("previewColorRampAriaLabel")})})}const n=t.opacity,s=i.reduce(((t,e)=>[...t,...this._getAllInfos(e)]),[]).filter((t=>!!t?.symbol)).map((t=>this._getSymbolPreview(t,n)));await Promise.allSettled(s),this.legendElements=i,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const t=this.layer.activeLayer;this.addHandles(ey((()=>{const{layer:t}=this;return t&&"activeLayer"in t&&t.activeLayer}),(()=>this._constructLegendElementsForWMTSlayer())),"wmts-activeLayer-watcher");const e=t.styleId?t.styles?.find((({id:e})=>e===t.styleId))?.legendUrl:void 0;e&&(this.legendElements=[{type:"symbol-table",title:t.title,infos:[{src:e,opacity:this.opacity}]}]),this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const t=this.layer;let e=null;(t.customParameters||t.customLayerParameters)&&(e={...t.customParameters,...t.customLayerParameters}),this.addHandles(ey((()=>{const{layer:t}=this;return t&&"sublayers"in t&&t.sublayers}),(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(t.sublayers,e),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(t,e){const i=this.layer,n=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForWMSSublayers())),"wms-sublayers-watcher");const s=this.sublayerIds?.map((t=>i.findSublayerById(t)))?.filter(C)??[],r=s.length?s:t.toArray();for(const t of r){const i=ey((()=>[t.title,t.visible,t.legendEnabled]),(()=>this._constructLegendElementsForWMSSublayers()));if(this.addHandles(i,"wms-sublayers-watcher"),!this.respectLayerVisibility||t.visible&&t.legendEnabled){const i=await this._generateSymbolTableElementForWMSSublayer(t,e);i?.infos.length&&n.unshift(i)}}return n}async _generateSymbolTableElementForWMSSublayer(t,e){if(!t.legendUrl&&t.sublayers){const i=(await this._generateLegendElementsForWMSSublayers(t.sublayers,e)).filter((t=>t));return{type:"symbol-table",title:t.title,infos:i}}return this._generateSymbolTableElementForLegendUrl(t,e)}async _generateSymbolTableElementForLegendUrl(t,e){let i=t.legendUrl;if(!i)return;const n={type:"symbol-table",title:t.title||t.name||String(t.id??""),infos:[]};e&&(i=dl(i,e));let s=null;const r=t.layer?.opacity;try{s=(await Pl(i,{responseType:"image"})).data,s&&(s.style.opacity=r)}catch{}return n.infos.push({src:i,preview:s,opacity:r}),n}_getLegendLayers(t,e){const i=dAt&&dAt[t];return i?Promise.resolve(i):this._legendRequest(e).then((e=>{const i=e.layers;return dAt[t]=i,i}))}_legendRequest(t){const e=this.layer;let i={f:"json",dynamicLayers:t};if(iAt(e)){const t=e.exportImageServiceParameters.rasterFunction;if(t&&(i.renderingRule=JSON.stringify(t.functionDefinition?.toJSON()||t.toJSON())),e.bandIds&&(i.bandIds=e.bandIds.join()),e.raster||e.viewId||e.customParameters){const{raster:t,viewId:n,customParameters:s}=e;i={raster:t,viewId:n,...i,...s}}}let n=e.url.replace(/(\/)+$/,"");if("version"in e&&+e.version>=10.01){const t=n.indexOf("?");t>-1?n=n.slice(0,t)+"/legend"+n.slice(t):n+="/legend"}else{const t=n.toLowerCase().indexOf("/rest/"),e=-1===t?n:n.slice(0,t)+n.slice(t+5);n=MTt+"?soapUrl="+encodeURI(e)+"&returnbytes=true"}return Pl(n,{query:i}).then((t=>t.data))}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;this.addHandles(ey((()=>t.sublayers),(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(t){jt.getLogger(this).warn("Request to server for legend has failed!",t)}}async _generateLegendElementsForBuildingSublayers(t,e){let i=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForBuildingSceneLayer())),"sublayers-watcher");const n=t.toArray();for(const t of n){const n=ey((()=>["renderer"in t&&t.renderer,t.opacity,t.title,t.visible]),(()=>this._constructLegendElementsForBuildingSceneLayer()));if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||t.visible){const n=null!=t?.opacity?t.opacity:null,s=null!=n?n*e:e;if("building-group"===t.type){const e={type:"symbol-table",title:t.title,infos:[]},n=await this._generateLegendElementsForBuildingSublayers(t.sublayers,s);e.infos.push(...n),i=[e,...i]}else if(t.renderer){i=[...await this._getRendererLegendElements(t.renderer,{title:t.title,opacity:s,sublayer:t}),...i]}}}return i.filter((t=>!!t&&(!("infos"in t)||!t.infos||t.infos.length>0)))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;if(tAt(t)||eAt(t)||YTt(t)){this.addHandles(ey((()=>t.sublayers),(()=>this._constructLegendElementsForSublayers)),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(t){jt.getLogger(this).warn("Request to server for legend has failed!",t)}}}async _generateLegendElementsForSublayers(t,e,i){const n=this.layer;let s=[];this.addHandles(t.on("change",(()=>this._constructLegendElementsForSublayers())),"sublayers-watcher");let r=t.toArray();!i&&this.sublayerIds&&this.sublayerIds.length&&(r=YTt(n)?this.sublayerIds.map((t=>n.findSublayerForSubtypeCode(t))).filter(C):this.sublayerIds.map((t=>n.findSublayerById(t))).filter(C));for(const t of r){const n=ey((()=>[t.renderer,t.opacity,t.title,t.visible,t.legendEnabled]),(()=>this._constructLegendElementsForSublayers()));if(this.addHandles(n,"sublayers-watcher"),!this.respectLayerVisibility||t.visible&&t.legendEnabled&&this._isSublayerInScale(t)){const n=null!=t?.opacity?t.opacity:null,r=null!=n?n*e:e,o=!lAt(t)||t.originIdOf("renderer")>$n.SERVICE&&!t.sublayers;if(t.renderer&&o){await t.load();s=[...await this._getRendererLegendElements(t.renderer,{title:t.title,opacity:r,sublayer:t}),...s]}else if(lAt(t)){const e=await this._generateSymbolTableElementForSublayer(t,r,i);e&&s.unshift(e)}}}return s.filter((t=>!!t&&(!("infos"in t)||!t.infos||t.infos.length>0)))}async _generateSymbolTableElementForSublayer(t,e,i){if(!i){i=new Map;const e=this.layer,n=t.source;let s=null;if(!(!n||"map-layer"===n.type&&n.mapLayerId===t.id&&(!n.gdbVersion||n.gdbVersion===("gdbVersion"in e&&e.gdbVersion)))||t.originIdOf("renderer")>$n.SERVICE||t.originIdOf("labelingInfo")>$n.SERVICE||t.originIdOf("labelsVisible")>$n.SERVICE){const t=new Ybt({layer:this.layer});s=t.hasDynamicLayers?t.dynamicLayers:null,t.destroy()}const r=s||`${e.uid}-default`;(await this._getLegendLayers(r,s)).forEach((t=>i.set(t.layerId,t)))}const n=i.get(t.id);if((!n||n?.subLayerIds&&n.defaultVisibility)&&t.sublayers){const n=await this._generateLegendElementsForSublayers(t.sublayers,e,i);return{type:"symbol-table",title:t.title,infos:n}}return this._generateSymbolTableElementForLegendLayer(n,t,e)}_generateSymbolTableElementForLegendLayer(t,e,i){if(!t?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(t,e))return null;const n=e?.renderer;let s=e?.title||t.layerName;if(n&&(!e||e?.originIdOf("renderer")>$n.SERVICE)){const t=e?.title||this._getRendererTitle(n,e);t&&(s&&"string"!=typeof t&&"title"in t&&(t.title=s),s=t)}const r={type:"symbol-table",title:s,legendType:t.legendType||null,infos:[]},o=e?this._sanitizeLegendForSublayer(t.legend.slice(),e):t.legend;return t.legendGroups&&t.legendGroups.length>0?t.legendGroups.forEach((e=>{const n={type:"symbol-table",title:e.heading,legendType:t.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(o.filter((t=>t.groupId===e.id)),t.layerId,i)};n.infos?.length>0&&r.infos.push(n)})):r.infos=this._generateSymbolTableElementInfosForLegendLayer(o,t.layerId,i),r.infos.length>0?r:null}_generateSymbolTableElementInfosForLegendLayer(t,e,i){return t.map((t=>{let n=t.url;if(t.imageData&&t.imageData.length>0)n=`data:image/png;base64,${t.imageData}`;else{if(0===n.indexOf("http"))return null;n=Ml(`${this.layer.url}/${e}/images/${n}`)}return{label:t.label,src:n,opacity:i??this.opacity,width:t.width,height:t.height}})).filter(C)}_isSublayerInScale(t){const e=t.minScale||0,i=t.maxScale||0;return!(e>0&&e<this.scale||i>this.scale)}_isLegendLayerInScale(t,e){const i=e||this.layer;let n=null,s=null,r=!0;return!i.minScale&&0!==i.minScale||!i.maxScale&&0!==i.maxScale?(0===t.minScale&&i.tileInfo&&(n=i.tileInfo.lods[0].scale),0===t.maxScale&&i.tileInfo&&(s=i.tileInfo.lods[i.tileInfo.lods.length-1].scale)):(n=Math.min(i.minScale,t.minScale)||i.minScale||t.minScale,s=Math.max(i.maxScale,t.maxScale)),(n>0&&n<this.scale||s>this.scale)&&(r=!1),r}_sanitizeLegendForSublayer(t,e){if("version"in this.layer&&+this.layer.version<10.1||0===t.length)return t;const i=e.renderer,n=t.some((t=>t.values));let s=0,r=null;return n&&t.some(((t,e)=>(t.values||(s=e,r=t,r.label||(r.label="others")),null!=r))),i?"unique-value"===i.type?r&&(t.splice(s,1),t.push(r)):"class-breaks"===i.type&&(r&&t.splice(s,1),t.reverse(),r&&t.push(r)):r&&(t.splice(s,1),t.push(r)),t}async _getRendererLegendElements(t,e={}){if(!ZTt(t,this.view))return jt.getLogger(this).warn(`Renderer of type '${t.type}' not supported!`),[];if(UTt(t))return this._constructPointCloudRendererLegendElements(t,e);if(HTt(t))return this._constructDotDensityRendererLegendElements(t);const i=await this._loadRenderer(t);return WTt(i)?this._constructPieChartRendererLegendElements(i):this._constructRendererLegendElements(i,e)}async _getLegendElementsForFeatureReduction(t){let e=null;return"binning"===t.type?e=t.renderer:"cluster"===t.type&&(e=this._getClusterRenderer(t)),e?this._getRendererLegendElements(e):[]}_getPointCloudRendererTitle(t){return(t.legendOptions?.title||t.field)??""}async _constructPointCloudRendererLegendElements(t,e={}){const i=e.title,n=[];let s=null,r=null;if(GTt(t))s={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},t.colorClassBreakInfos.forEach((t=>{s.infos.unshift({label:t.label||t.minValue+" - "+t.maxValue,value:[t.minValue,t.maxValue],symbol:this._getAppliedCloneSymbol(ETt,t.color)})}));else if(VTt(t)){const e=t.stops;let n=null;if(e?.length&&(1===e.length&&(n=e[0].color),!n)){const t=e[0].value,i=e[e.length-1].value;if(null!=t&&null!=i){n=qMt(t+(i-t)/2,e)}}s={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(ETt,n||ETt.color)}]};const o=VMt(t.stops??[])??[];r={type:"color-ramp",title:i||this._getPointCloudRendererTitle(t),infos:o,preview:dMt(o.map((t=>t.color)),{ariaLabel:await uAt("previewColorRampAriaLabel")})}}else qTt(t)&&(s={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},t.colorUniqueValueInfos?.forEach((t=>{s.infos.push({label:t.label||t.values.join(", "),value:t.values.join(", "),symbol:this._getAppliedCloneSymbol(ETt,t.color)})})));s?.infos.length&&n.push(s),r?.infos.length&&n.push(r);const o=n.reduce(((t,e)=>[...t,...e.infos??[]]),[]).filter((t=>!!t.symbol)).map((e=>this._getSymbolPreview(e,this.opacity,{symbolConfig:{applyColorModulation:!!t.colorModulation}})));return await Promise.allSettled(o),n}async _getElementInfoForDotDensity(t,e){const{color:i,label:n,valueExpressionTitle:s}=e,{backgroundColor:r,outline:o,dotSize:a}=t,l=this.effectList,u=l?.effects.map((t=>t.toJSON())),c=Plt(u),h=await uAt("previewTemplateAriaLabel",n||s),d=a+"-"+i+"-"+r+"-"+(o&&JSON.stringify(o.toJSON()))+"-"+c,f=this._dotDensityUrlCache,p=f.has(d)?f.get(d):cMt(t,i,{ariaLabel:h});f.set(d,p);const m={shape:{type:"image",x:0,y:0,width:p.width,height:p.height,src:p.src},fill:null,stroke:null,offset:[0,0]},y=rxt([[m]],[p.width,p.height],{effectView:this.effectList,ariaLabel:h});return{opacity:1,src:p.src,preview:y,width:p.width,height:p.height}}async _constructDotDensityRendererLegendElements(t){const e=t.calculateDotValue(this.view.scale),i=t.legendOptions?.unit,n={type:"symbol-table",title:{value:e&&Math.round(e),unit:i||""},infos:[]};for(const e of t.attributes){const i=await this._getElementInfoForDotDensity(t,e);i.label=e.label||e.valueExpressionTitle||e.field,n.infos.push(i)}return[n]}async _constructPieChartRendererLegendElements(t){const e=this.layer.opacity,i=[];let n=null;const s=t.outline;t.attributes.forEach((t=>{const e=new lD({color:t.color,outline:s}),n=t.label||t.valueExpressionTitle||t.field;i.push({label:n,symbol:e})}));const r=i.length?[...i]:[];if(t.othersCategory?.color&&0!==t.othersCategory?.threshold){const e=new lD({color:t.othersCategory.color,outline:s});n=t.othersCategory.label||"Other",i.push({label:n,symbol:e})}if(t.defaultColor?.a){const e=new lD({color:t.defaultColor,outline:s});i.push({label:t.defaultLabel,symbol:e})}const o=await this._getVisualVariableLegendElements(t,this.layer)||[];if(i.length){o.unshift({type:"symbol-table",title:null,infos:i});const e=r.filter((t=>t.label!==n)).map((t=>t.symbol.color)).filter(Boolean),a=hMt(e,{holePercentage:t.holePercentage,backgroundColor:t.backgroundFillSymbol?.color,effectList:this.effectList,outline:s,ariaLabel:await uAt("previewPieChartAriaLabel")});o.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(t,this.layer),infos:i,preview:a})}const a=o.reduce(((t,e)=>[...t,...this._getAllInfos(e)]),[]).filter((t=>!!t?.symbol&&!t?.preview)).map((t=>this._getSymbolPreview(t,e,{effectList:this.effectList})));return await Promise.allSettled(a),o}async _constructRendererLegendElements(t,e={}){const{title:i,sublayer:n}=e,s=n||this.layer,r=$Mt(t);if("definitionExpression"in s){const e=s.definitionExpression;if(e&&this.respectLayerDefinitionExpression&&$Tt(t)){if(this._layerDefinitionExpression!==e){this._layerDefinitionExpressionClause=await WC(e,s.fieldsIndex);const i=new Set((await dO(t,s.fieldsIndex)).map((t=>t.toLowerCase()))),n=this._layerDefinitionExpressionClause?.fieldNames.map((t=>t.toLowerCase()));n?.every((t=>i.has(t)))||(this._layerDefinitionExpressionClause=null,n?.length&&jt.getLogger(this).warn("Definition expression will be ignored in the Legend, as fields in the expression do not match with renderer fields"))}}else this._layerDefinitionExpressionClause=null;this._layerDefinitionExpression=e}this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const o=await this._getVisualVariableLegendElements(t,s)||[],a={type:"symbol-table",title:i||this._getRendererTitle(t,s),infos:[]};let l=null,u=!1;const c=new Set;if(OTt(t)&&!this._hasSizeRamp){const e=await NMt(t);a.infos.push({label:null,symbol:e})}else if(oAt(t)){let e=i;const n=aAt(t)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",s=o.findIndex((t=>"color-ramp"===t.type)),r=-1!==s?o.splice(s,1)[0]:null,a=o.findIndex((t=>"size-ramp"===t.type)),l=-1!==a?o.splice(a,1)[0]:null,u=[];r&&(e=r.title,u.push(r)),l&&(e=l.title,u.push(l)),u.length>0&&o.push({type:n,title:e,infos:u})}else if(zTt(t)){const e=ZMt(t);o.push({type:"heatmap-ramp",title:i||this._getRendererTitle(t,s),infos:e,preview:dMt(e.map((t=>t.color)),{effectList:this.effectList,ariaLabel:await uAt("previewColorRampAriaLabel")})})}else if($Tt(t)){const e=t.authoringInfo;if(e&&"relationship"===e.type){const{numClasses:i,field1:n,field2:r}=e,l=e.focus;if(i&&n&&r){const e=[n,r];let u=oMt(l)||0;for(const t of e){const{field:e,normalizationField:i,label:n}=t,r=n||{field:this._getFieldAlias(e,s),normField:i&&this._getFieldAlias(i,s)},o=hAt.clone();o.angle=u,a.infos.push({label:r,symbol:o}),c.add(o),u+=90}const h=rMt({focus:l,numClasses:i,infos:t.uniqueValueInfos??[]});o.unshift(h)}}else if(iAt(this.layer)||nAt(this.layer))t.uniqueValueInfos?.forEach((e=>{e.symbol&&this._checkDefinitionExpressionForUVR(t,e.value)&&a.infos.push({label:e.label||e.value,value:e.value,symbol:e.symbol})}));else{const{field:e,field2:n,field3:o,fieldDelimiter:l,valueExpression:c,defaultSymbol:h}=t,d=!(!e&&!c||!n&&!o),f=[];if(t.uniqueValueGroups?.forEach((i=>{const a={type:"symbol-table",title:i.heading,infos:[]};i.classes?.forEach((i=>{const{symbol:u,values:h}=i;if(u){const f=[],p=[];for(const t of h??[]){const{value:i,value2:r,value3:a}=t,u=[],h=[];(e||c)&&(u.push(i),h.push(this._getDomainName(e,i,s))),n&&(u.push(r),h.push(this._getDomainName(n,r,s))),o&&(u.push(a),h.push(this._getDomainName(o,a,s))),f.push(d?u.join(l||""):u[0]),p.push(h.join(" - "))}const m=f.join(", ");let y=i.label;if(!y){const t=p.filter(Boolean);y=t.length?t.join(", "):m}const g=u.clone();"cim"===g.type&&r&&vSt(g,{innerDotSize:.5*xTt,outerRingSize:xTt}),f.some((e=>this._checkDefinitionExpressionForUVR(t,e)))&&a.infos.push({label:y,value:m,symbol:g})}})),a.infos.length&&f.push(a)})),f.length){const e=f[0];1===f.length&&"title"in e&&!e.title?a.infos.push(...e.infos??[]):(h&&(f.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:h}]}),u=!0),a.infos.push(...f)),i||t.legendOptions?.title||t.valueExpressionTitle||(a.title=null)}}t.defaultSymbol&&!u&&(a.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),u=!0)}else if(DTt(t)){if(!r){l=this._isUnclassedRenderer(t);if(!l||!this._hasSizeRamp){const e=t.classBreakInfos.filter((({symbol:t})=>t));for(const{label:t,minValue:i,maxValue:n,symbol:s}of e)a.infos.unshift({label:t||(l?null:`${i} - ${n}`),value:[i,n],symbol:s});l&&(a.title=null),this._updateInfosForClassedSizeRenderer(t,a.infos)}t.defaultSymbol&&!l&&(a.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),u=!0)}}else if(NTt(t))if(nAt(this.layer)||sAt(this.layer)){const e=await this._constructTileImageryStretchRendererElements(t);rAt(e)?o.push(e):a.infos=e}else{const e=this.layer;let i,n;t.customStatistics?.length&&({min:i,max:n}=t.customStatistics[0]);let s=[],r=e.serviceRasterInfo;if(e.rasterFunction)try{r=await e.generateRasterInfo(e.rasterFunction)}catch{}const l=tSt(r.pixelType);if(1===r.bandCount){const s=e.bandIds?.[0]||0;i=null!=i?i:r.statistics?r.statistics[s].min:l[0],n=null!=n?n:r.statistics?r.statistics[s].max:l[1],i||n?o.push(await this._getStretchLegendElements(t,{min:i,max:n})):this._getServerSideLegend()}else if(e.bandIds&&1===e.bandIds.length)i=null!=i?i:r.statistics?r.statistics[e.bandIds[0]].min:l[0],n=null!=n?n:r.statistics?r.statistics[e.bandIds[0]].max:l[1],i||n?o.push(await this._getStretchLegendElements(t,{min:i,max:n})):this._getServerSideLegend();else if(r.bandCount>=3){const{bandInfos:t}=r,{bandIds:i}=e;t.length>=r.bandCount?3===i?.length?(s=i.map((e=>t[e].name)),a.infos=this._createSymbolTableElementMultiBand(s)):"lerc"===e.format?(s=[0,1,2].map((e=>t[e].name)),a.infos=this._createSymbolTableElementMultiBand(s)):this._getServerSideLegend():"lerc"===e.format?(s=["band1","band2","band3"],a.infos=this._createSymbolTableElementMultiBand(s)):this._getServerSideLegend()}else this._getServerSideLegend()}else if(LTt(t))t.colormapInfos.forEach((t=>{a.infos.push({label:t.label,value:t.value,symbol:this._getAppliedCloneSymbol(jTt,t.color)})}));else if(FTt(t)){let i=t.symbol;switch(e.geometryType){case"point":i="pointSymbol"in s?s.pointSymbol:null;break;case"polyline":i="lineSymbol"in s?s.lineSymbol:null;break;case"polygon":i="polygonSymbol"in s?s.polygonSymbol:null}const n=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;t.symbol&&n&&a.infos.push({label:t.label,symbol:i})}else if(RTt(t)){t.outputUnit&&(this.title="("+t.toJSON().outputUnit+")"),a.title=t.attributeField;const e=t.getClassBreakInfos();e?.length?e.forEach((t=>{a.infos.push({label:t.minValue+" - "+t.maxValue,symbol:t.symbol})})):a.infos.push({label:t.attributeField,symbol:t.getDefaultSymbol()})}else PTt(t)&&o.push(await this._getStretchLegendElements(t,{min:0,max:255}));const h=t.defaultSymbol;!h||u||FTt(t)||l&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||o.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:h}]}),a.infos.length&&o.unshift(a);const d=null==e.opacity?this.opacity:e.opacity,f=this._isTallSymbol("visualVariables"in t?t.visualVariables:null),p=iAt(this.layer)||nAt(this.layer),m=o.reduce(((t,e)=>[...t,...this._getAllInfos(e)]),[]).filter((t=>!!t?.symbol)).filter((t=>{if("cim"===t.symbol.type){const{minScale:e,maxScale:i}=t.symbol.data;if(e&&e<this.scale||i&&i>this.scale)return!1}return!0})).map((t=>this._getSymbolPreview(t,d,{isDefault:t.symbol===h,applyScaleDrivenSize:!c.has(t.symbol),symbolConfig:{isTall:f,isSquareFill:p},effectList:c.has(t.symbol)?null:this.effectList})));return t=null,await Promise.allSettled(m),o}_checkDefinitionExpressionForUVR(t,e){if(!this._layerDefinitionExpressionClause)return!0;const i=cAt(t,e);return(i&&this._layerDefinitionExpressionClause.testFeature(i))??!0}_getServerSideLegend(){setTimeout((()=>this.buildLegendElementsForTools()),0)}_getAllInfos(t){const e=t?.infos;return e?e.reduce(((t,e)=>t.concat(this._getAllInfos(e))),[]):[t]}async _constructTileImageryStretchRendererElements(t){const e=this.layer,i=e.symbolizer.rasterInfo??e.raster.rasterInfo;let n,s;const r=t?.customStatistics?.length?t.customStatistics:i?.statistics;if(r)({min:n,max:s}=r[0]);else{const t=tSt(i.pixelType);n=t[0],s=t[1]}if(e.hasStandardTime()&&(n=e.getStandardTimeValue(n),s=e.getStandardTimeValue(s)),1===i.bandCount||1===e.bandIds?.length)return this._getStretchLegendElements(t,{min:n,max:s});const o=(e?.bandIds?.length?e.bandIds:Array.from(Array(Math.min(i.bandCount,3)).keys())).map((t=>i.bandInfos[t].name));return o.length<3?o.push(o[1]):o.length>3&&o.splice(3),this._createSymbolTableElementMultiBand(o)}async _getStretchLegendElements(t,e){const i=t.colorRamp,n=WMt(i,e);return{type:"stretch-ramp",title:"",infos:n,preview:dMt(n.map((t=>t.color)),{ariaLabel:await uAt("previewColorRampAriaLabel")})}}_getClusterSymbol(){const t=this.layer,e="featureReduction"in t&&t.featureReduction,i=e&&"symbol"in e&&e.renderer;return i&&!0!==i?.authoringInfo?.isAutoGenerated?null:e&&"symbol"in e?e.symbol:null}async _getSizeLegendElement(t,e,i,n){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(e):t,infos:await lTt(i,e,await LMt(i),this.scale,this.view,n,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(t){const e=[],i=["red","green","blue"];return t.forEach(((t,n)=>{e.push({label:{colorName:i[n],bandName:t},src:RMt[n],opacity:this.opacity??1})})),e}_updateInfosForClassedSizeRenderer(t,e){const i=t.authoringInfo&&"class-breaks-size"===t.authoringInfo.type,n=t.classBreakInfos.some((t=>L_t(t.symbol)));if(i&&n){const i=JMt,n=YMt,s=t.classBreakInfos.length,r=(i-n)/(s>1?s-1:s);e.forEach(((t,e)=>{t.size=i-r*e}))}}_isTallSymbol(t){let e=!1,i=!1;if(t)for(let n=0;n<t.length&&(!e||!i);n++){const s=t[n];"size"===s.type&&("height"===s.axis&&(e=!0),"width-and-depth"===s.axis&&(i=!0))}return e&&i}async _getSymbolPreview(t,e,i){let n=!i?.isDefault&&null==t.size&&this._hasSizeRamp?XA(MSt.size):t.size;if(this._scaleDrivenSizeVariable&&i?.applyScaleDrivenSize){const{getSize:e}=await Promise.resolve().then((function(){return C9}));n=e(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===t.symbol.type?t.symbol.style:null})}const s=!i?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!i?.applyScaleDrivenSize);return pMt(t.symbol,{size:n,opacity:e,scale:!1,symbolConfig:i?.symbolConfig,effectView:i?.effectList,style:"legend",cimOptions:{allowScalingUp:s,viewParams:this.isScaleDriven?{viewingMode:"2d"===this.view?.type?"map":this.view?.viewingMode,scale:this.view?.scale}:null},ariaLabel:t.label&&"string"!=typeof t.label?null:await uAt("previewTemplateAriaLabel",t.label)}).then((e=>(t.preview=e,t))).catch((()=>(t.preview=null,t)))}_getClusterRenderer(t){this._hasClusterSizeVariable=!1;const e="renderer"in this.layer?this.layer.renderer:null,i=t.renderer?.clone()||e?.clone(),n=vMt(t,this.layerView,this.view);if(n&&null!=i&&"visualVariables"in i){const e=i.visualVariables?.some((t=>"size"===t.type&&"outline"!==t.target&&!kTt.test(t.valueExpression)));if(!e){if("clusterMinSize"in t&&"clusterMaxSize"in t){const{clusterMinSize:e,clusterMaxSize:i}=t;n.legendOptions=new J8({showLegend:e!==i})}const e=i.visualVariables||[];i.visualVariables=e.concat([n]),this._hasClusterSizeVariable=!0}}return i}async _loadRenderer(t){const e=[],i=t.clone(),n=await LMt(i);if(DTt(i)||$Tt(i)){const t=(i.classBreakInfos||i.uniqueValueInfos).map((t=>this._fetchSymbol(t.symbol,n).then((e=>{t.symbol=e})).catch((()=>{t.symbol=null}))));Array.prototype.push.apply(e,t)}return e.push(this._fetchSymbol(i.symbol||i.defaultSymbol,i.defaultSymbol?null:n).then((t=>{this._applySymbolToRenderer(i,t,FTt(i))})).catch((()=>{this._applySymbolToRenderer(i,null,FTt(i))}))),await Promise.allSettled(e),i}_applySymbolToRenderer(t,e,i){i?t.symbol=e:t.defaultSymbol=e}async _fetchSymbol(t,e){if(!t)throw new Error;if("web-style"===t.type){const i=this._webStyleSymbolCache;try{const n=await("2d"===this.view.type?t.fetchCIMSymbol({cache:i}):t.fetchSymbol({cache:i}));return this._getAppliedCloneSymbol(n,e)}catch{throw jt.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(t,e)}_getAppliedCloneSymbol(t,e){if(!t||!e)return t;const i=t.clone(),n=e&&e.toRgba();return i.type.includes("3d")?this._applyColorTo3dSymbol(i,n):"cim"===i.type?_St(i,e):i.color&&(i.color=new RA(n||i.color)),i}_applyColorTo3dSymbol(t,e){e&&t.symbolLayers.forEach((t=>{t&&(t.material||(t.material={}),t.material.color=new RA(e))}))}async _getVisualVariableLegendElements(t,e){if(!("visualVariables"in t)||"vector-field"===t.type)return null;const i=t.visualVariables??[],n=[],s=[],r=[],o=$Mt(t);if(2===o?.sizeStops?.length&&(DTt(t)||$Tt(t))){const[t,e]=o.sizeStops;s.push(new P9({field:o.field??void 0,normalizationField:o.normalizationField,minSize:t.size,maxSize:e.size,minDataValue:t.value,maxDataValue:e.value}))}for(const t of i)"color"===t.type?n.push(t):"size"===t.type?s.push(t):"opacity"===t.type&&r.push(t);const a=[...n,...s,...r];let l,u;if(0===n.length&&DTt(t)&&t.classBreakInfos&&1===t.classBreakInfos.length){const e=t.classBreakInfos[0];l=e&&e.symbol}if(0===n.length&&FTt(t)&&(l=t.symbol),l)if(l.type.includes("3d")){const t=l.symbolLayers.at(0);"water"===t.type?null!=t.color&&(u=t.color):null!=t.material?.color&&(u=t.material.color)}else l.url||(u=l.color);const c=this.effectList;return(await Promise.all(a.map((async i=>{if(!i.legendOptions||!1!==i.legendOptions.showLegend){const n=OTt(t)?i.field:this._getRampTitle(i,e);let s=null;const r=DMt(e,i,this.view.timeZone);if("color"===i.type){const t=await BMt(i,null,r)??[];s={type:"color-ramp",title:n,infos:t,preview:dMt(t.map((t=>t.color)),{effectList:c,ariaLabel:await uAt("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=t.length>0)}else if("size"===i.type&&"outline"!==i.target)kTt.test(i.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=i):(s=await this._getSizeLegendElement(n,i,t,r),this._hasSizeRamp||(this._hasSizeRamp=!(null==s.infos||!s.infos.length)));else if("opacity"===i.type){const t=await BMt(i,u,r)??[];s={type:"opacity-ramp",title:n,infos:t,preview:dMt(t.map((t=>t.color)),{effectList:c,ariaLabel:await uAt("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=t.length>0)}return s?.infos?s:null}})))).filter(C)}_getDomainName(t,e,i){if(t&&"function"!=typeof t){const n="getField"in i&&i.getField?.(t),s=n&&"getFieldDomain"in i&&i.getFieldDomain?i.getFieldDomain(n.name,{excludeImpliedDomains:u("esri-widget-legacy-field-domain-calculation")}):null;return"coded-value"===s?.type?s.getName(e):null}return null}_getClusterTitle(t){const e=this.layer,i=t.field;if("featureReduction"in e&&e.featureReduction&&"cluster"===e.featureReduction.type){const t=e.featureReduction,n="popupTemplate"in t&&t.popupTemplate,s=n&&n.fieldInfos;if(s)for(const t of s)if(t.fieldName===i)return"cluster_count"===i?t.label||{showCount:!0}:t.label}return{showCount:!0}}_getRampTitle(t,e){let i=t.field,n=t.normalizationField,s=!1,r=!1,o=!1,a=null;i="function"==typeof i?null:i,n="function"==typeof n?null:n;const l=t.legendOptions?.title;if(null!=l)a=l;else if(t.valueExpressionTitle)a=t.valueExpressionTitle;else{if("renderer"in e&&e.renderer&&"authoringInfo"in e.renderer&&e.renderer.authoringInfo?.visualVariables){const t=e.renderer.authoringInfo.visualVariables;for(let e=0;e<t.length;e++){const i=t[e];if("color"===i.type){if("ratio"===i.style){s=!0;break}if("percent"===i.style){r=!0;break}if("percent-of-total"===i.style){o=!0;break}}}}a={field:i&&this._getFieldAlias(i,e),normField:n&&this._getFieldAlias(n,e),ratio:s,ratioPercent:r,ratioPercentTotal:o}}return a}_getRendererTitle(t,e){const i=t;if(i.legendOptions?.title)return i.legendOptions.title;if(i.valueExpressionTitle)return i.valueExpressionTitle;let n=i.field,s=null,r=null;if(DTt(i)&&(s=i.normalizationField,r="percent-of-total"===i.normalizationType),n="function"==typeof n?null:n,s="function"==typeof s?null:s,$Tt(i)){const{field2:t,field3:s,fieldDelimiter:r}=i;let o=n&&this._getFieldAlias(n,e);return t&&(o=`<${o}>${r}<${this._getFieldAlias(t,e)}>`,s&&(o=`${o}${r}<${this._getFieldAlias(s,e)}>`)),o}let o=null;return(n||s)&&(o={field:n&&this._getFieldAlias(n,e),normField:s&&this._getFieldAlias(s,e),normByPct:r}),o}_getFieldAlias(t,e){const i="popupTemplate"in e?e.popupTemplate:null,n=i?.fieldInfos;let s=n?.find((e=>t===e.fieldName)),r=null;"getField"in e&&e.getField?r=e.getField(t):"fieldsIndex"in e&&e.fieldsIndex&&(r=e.fieldsIndex.get(t));let o=null;const a="featureReduction"in e&&e.featureReduction;a&&(s??="popupTemplate"in a?a.popupTemplate?.fieldInfos?.find((e=>t?.toLowerCase()===e.fieldName?.toLowerCase())):void 0,"fields"in a&&a.fields&&(o=a.fields.find((e=>e.name?.toLowerCase()===t?.toLowerCase()))));const l=s||r||o;let u=null;return l&&(u=s?.label||r?.alias||o?.alias||"name"in l&&l.name||"fieldName"in l&&l.fieldName||null),u}_isUnclassedRenderer(t){const e=t.visualVariables;let i=!1;return DTt(t)&&t.classBreakInfos&&1===t.classBreakInfos.length&&e&&(i=t.field?e.some((e=>!(!e||t.field!==e.field||(t.normalizationField||e.normalizationField)&&t.normalizationField!==e.normalizationField))):!!e.length),i}};r([Je()],fAt.prototype,"children",void 0),r([Je({readOnly:!0})],fAt.prototype,"effectList",null),r([Je()],fAt.prototype,"layerView",void 0),r([Je()],fAt.prototype,"layer",void 0),r([Je()],fAt.prototype,"legendElements",void 0),r([Je({readOnly:!0})],fAt.prototype,"opacity",null),r([Je()],fAt.prototype,"parent",void 0),r([Je({readOnly:!0,dependsOn:[]})],fAt.prototype,"ready",null),r([Je()],fAt.prototype,"hideLayersNotInCurrentView",void 0),r([Je()],fAt.prototype,"keepCacheOnDestroy",void 0),r([Je()],fAt.prototype,"respectLayerDefinitionExpression",void 0),r([Je()],fAt.prototype,"respectLayerVisibility",void 0),r([Je({readOnly:!0})],fAt.prototype,"scale",null),r([Je()],fAt.prototype,"sublayerIds",void 0),r([Je({readOnly:!0})],fAt.prototype,"isScaleDriven",null),r([Je()],fAt.prototype,"title",void 0),r([Je({readOnly:!0,dependsOn:["ready"],value:0})],fAt.prototype,"version",null),r([Je()],fAt.prototype,"view",void 0),fAt=r([ln("esri.widgets.Legend.support.ActiveLayerInfo")],fAt);const pAt=fAt;const mAt={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},yAt=Vm.ofType(pAt),gAt=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer","esri.layers.KnowledgeGraphLayer"]),vAt="view.basemapView.baseLayerViews",wAt="view.groundView.layerViews",bAt="view.basemapView.referenceLayerViews",SAt=[vAt,wAt,"view.layerViews",bAt];let _At=class extends ao{constructor(t){super(t),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new Vm,this.activeLayerInfos=new yAt,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerDefinitionExpression=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(ey((()=>this.view),(()=>this._viewHandles()),dy),mAt.view),this.addHandles(Qy((()=>this._refresh())))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles(mAt.state),this.view&&this.addHandles(ey((()=>this.state),(()=>this._stateHandles()),dy),mAt.state)}_stateHandles(){this._resetAll(),"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([mAt.allLayerViews,mAt.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(t){this.removeHandles(t);const e=this._activeLayerInfosByLayerViewId[t];delete this._activeLayerInfosByLayerViewId[t],e?.parent&&e.parent.children.remove(e)}_watchPropertiesAndAllLayerViews(){const{view:t}=this;if(!t)return;const{allLayerViews:e}=t;e.length&&this._refresh(),this.addHandles(e.on("change",(t=>this._allLayerViewsChangeHandle(t))),mAt.allLayerViews),this.addHandles(ey((()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible]),(()=>this._propertiesChangeHandle())),mAt.legendProperties)}_allLayerViewsChangeHandle(t){t.moved.length?this._propertiesChangeHandle():(t.removed.forEach((t=>this._destroyViewActiveLayerInfo(t.uid))),this._refresh())}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(t){const e=this.view;if(t.length<2||!e)return;const i=[];t.forEach((e=>{if(!e.parent){const n=e.layer.parent,s=n&&"uid"in n&&this._layerViewByLayerId[n.uid],r=s&&this._activeLayerInfosByLayerViewId[s.uid];r&&t.includes(r)&&(i.push(e),e.parent=r,r.children.add(e),this._sortActiveLayerInfos(r.children))}})),t.removeMany(i);const n={};e.allLayerViews.forEach(((t,e)=>n[t.layer.uid]=e)),t.sort(((t,e)=>{const i=n[t.layer.uid]||0;return(n[e.layer.uid]||0)-i}))}_generateLayerViews(){const t=[];return SAt.filter(this._filterLayerViews,this).map((t=>Ne(this,t))).filter((t=>null!=t)).forEach(this._collectLayerViews("layerViews",t)),t}_filterLayerViews(t){const e=!this.basemapLegendVisible&&(t===vAt||t===bAt),i=!this.groundLegendVisible&&t===wAt;return!e&&!i}_collectLayerViews(t,e){const i=n=>(n&&n.forEach((n=>{e.push(n),i(n[t])})),e);return i}_filterLayerViewsByLayerInfos(t){const e=this.layerInfos;return!e||!e.length||e.some((e=>this._hasLayerInfo(e,t)))}_hasLayerInfo(t,e){const i=this._isLayerUIDMatching(t.layer,e.layer.uid);return i&&(this._layerInfosByLayerViewId[e.uid]=t),i}_isLayerUIDMatching(t,e){return t&&(t.uid===e||this._hasLayerUID(t.layers,e))}_hasLayerUID(t,e){return t&&t.some((t=>this._isLayerUIDMatching(t,e)))}_isLayerViewSupported(t){return!!gAt.has(t.layer.declaredClass)&&(this._layerViewByLayerId[t.layer.uid]=t,!0)}_generateActiveLayerInfo(t){this._isLayerActive(t)?this._buildActiveLayerInfo(t):(this.removeHandles(t.uid),this.addHandles(ey((()=>[t.legendEnabled,t.layer?.legendEnabled]),(()=>this._layerActiveHandle(t))),t.uid))}_layerActiveHandle(t){this._isLayerActive(t)&&(this.removeHandles(t.uid),this._buildActiveLayerInfo(t))}_isLayerActive(t){return!this.respectLayerVisibility||t.legendEnabled&&t.layer?.legendEnabled}_buildActiveLayerInfo(t){const e=t.layer,i=t.uid,n=this._layerInfosByLayerViewId[i];let s=this._activeLayerInfosByLayerViewId[i];if(!s){const r=void 0!==n?.title&&n.layer.uid===e.uid;s=new pAt({layer:e,layerView:t,title:r?n.title:e.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:n?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[i]=s}const r=e.parent&&"uid"in e.parent?this._layerViewByLayerId[e.parent?.uid]:null;if(s.parent=this._activeLayerInfosByLayerViewId[r?.uid],!this.hasHandles(i)){const n=[ey((()=>e.title),(t=>this._titleHandle(t,s))),ey((()=>[e.opacity,"renderer"in e&&e.renderer,"pointSymbol"in e&&e.pointSymbol,"lineSymbol"in e&&e.lineSymbol,"polygonSymbol"in e&&e.polygonSymbol]),(()=>this._constructLegendElements(s))),iy((()=>!0===this.view?.stationary),(()=>this._scaleHandle(s)),dy),ey((()=>t.layer?Lbt(t.layer,t.view):null),(()=>this._constructLegendElements(s))),ey((()=>t.updating),(()=>{if(null==t.layer)return;null!=Lbt(t.layer,t.view)&&this._constructLegendElements(s)})),ey((()=>"effect"in e&&e.effect),(()=>this._constructLegendElements(s))),iy((()=>this.view?.timeZone),(()=>this._constructLegendElements(s)),dy)];if(this.respectLayerVisibility){const i=ey((()=>t.legendEnabled),(t=>this._legendEnabledHandle(t,s))),r=ey((()=>e.legendEnabled),(t=>this._legendEnabledHandle(t,s)));n.push(i,r)}if(this.respectLayerDefinitionExpression&&"definitionExpression"in e){const t=ey((()=>[e.definitionExpression,this.respectLayerDefinitionExpression]),(()=>{s.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression,this._constructLegendElements(s)}));n.push(t)}this.addHandles(n,i)}s.isScaleDriven||this._constructLegendElements(s),this._addActiveLayerInfo(s)}_titleHandle(t,e){e.title=t,this._constructLegendElements(e)}_legendEnabledHandle(t,e){t?this._addActiveLayerInfo(e):this._removeActiveLayerInfo(e)}_scaleHandle(t){(t.isScaleDriven||t.hideLayersNotInCurrentView)&&this._constructLegendElements(t)}_addActiveLayerInfo(t){const{layerView:e,layer:i}=t;if(this._isLayerActive(e)&&!this.activeLayerInfos.includes(t)){const e=t.parent;if(e)e.children.includes(t)||e.children.push(t),this._sortActiveLayerInfos(e.children);else{const e=this.layerInfos?.some((t=>t.layer.uid===i.uid)),n=i.parent;(n&&"uid"in n?this._layerViewByLayerId[n.uid]:null)&&!e?this._activeLayerInfosWithNoParent.add(t):(this.activeLayerInfos.add(t),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const t=[];this._activeLayerInfosWithNoParent.forEach((e=>{const i=e.layer.parent,n=i&&"uid"in i?this._layerViewByLayerId[i?.uid]:null,s=this._activeLayerInfosByLayerViewId[n?.uid];s&&(t.push(e),e.parent=s)})),t.length&&(this._activeLayerInfosWithNoParent.removeMany(t),t.forEach((t=>this._addActiveLayerInfo(t))))}}}_removeActiveLayerInfo(t){const e=t.parent;e?e.children.remove(t):this.activeLayerInfos.remove(t)}_constructLegendElements(t){const e=t.layer;"featureCollections"in e&&e.featureCollections?t.buildLegendElementsForFeatureCollections(e.featureCollections):"featureReduction"in e&&e.featureReduction&&"renderer"in e.featureReduction&&("binning"===e.featureReduction.type||"cluster"===e.featureReduction.type)&&(!this.view||e.featureReduction.maxScale<=this.view.scale)?t.buildLegendElementsForFeatureReduction(e.featureReduction):"renderer"in e&&e.renderer&&!("sublayers"in e)?t.buildLegendElementsForRenderer(e.renderer):"url"in e&&e.url&&"catalog"!==e.type&&"knowledge-graph"!==e.type?t.buildLegendElementsForTools():t.children.forEach((t=>this._constructLegendElements(t)))}};r([Je({type:yAt})],_At.prototype,"activeLayerInfos",void 0),r([Je()],_At.prototype,"basemapLegendVisible",void 0),r([Je()],_At.prototype,"groundLegendVisible",void 0),r([Je()],_At.prototype,"hideLayersNotInCurrentView",void 0),r([Je()],_At.prototype,"keepCacheOnDestroy",void 0),r([Je()],_At.prototype,"respectLayerDefinitionExpression",void 0),r([Je()],_At.prototype,"respectLayerVisibility",void 0),r([Je()],_At.prototype,"layerInfos",void 0),r([Je({readOnly:!0})],_At.prototype,"state",null),r([Je()],_At.prototype,"view",void 0),_At=r([ln("esri.widgets.Legend.LegendViewModel")],_At);const xAt=_At;const MAt="esri-legend--card",TAt="esri-legend",AAt={activated:`${MAt}__carousel-indicator--activated`,base:MAt,stacked:`${TAt}--stacked`,carouselTitle:`${MAt}__carousel-title`,indicator:`${MAt}__carousel-indicator`,intervalSeparator:`${MAt}__interval-separator`,imageryLayerStretchedImage:`${MAt}__imagery-layer-image--stretched`,imageLabel:`${MAt}__image-label`,layerCaption:`${MAt}__layer-caption`,labelElement:`${MAt}__label-element`,layerRow:`${MAt}__layer-row`,labelCell:`${MAt}__label-cell`,message:`${MAt}__message`,rampLabel:`${MAt}__ramp-label`,section:`${MAt}__section`,relationshipSection:`${MAt}__relationship-section`,serviceCaptionText:`${MAt}__service-caption-text`,serviceContent:`${MAt}__service-content`,service:`${MAt}__service`,groupLayer:`${MAt}__group-layer`,groupLayerChild:`${MAt}__group-layer-child`,symbol:`${MAt}__symbol`,sizeRampRow:`${MAt}__size-ramp-row`,symbolRow:`${MAt}__symbol-row`,symbolCell:`${MAt}__symbol-cell`,indicatorContainer:`${MAt}__carousel-indicator-container`,intervalSeparatorsContainer:`${MAt}__interval-separators-container`,relationshipLabelContainer:`${MAt}__relationship-label-container`,labelContainer:`${MAt}__label-container`,serviceCaptionContainer:`${MAt}__service-caption-container`,symbolContainer:`${MAt}__symbol-container`,sizeRampContainer:`${MAt}__size-ramp-container`,sizeRampPreview:`${MAt}__size-ramp-preview`,pieChartRampPreview:`${MAt}__pie-chart-ramp-preview`,rampContainer:`${TAt}__ramps`,sizeRampHorizontal:`${TAt}__size-ramp--horizontal`,rampLabelsContainer:`${TAt}__ramp-labels`,layerInfo:`${TAt}__layer-cell ${TAt}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};const IAt=qx(),kAt=10,CAt=20,EAt=10,jAt=20,OAt={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function RAt(t="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return"vertical"===t?V3("svg",{height:"4",width:"10"},V3("line",{style:e,x1:"0",x2:"10",y1:"2",y2:"2"})):V3("svg",{height:"10",width:"10"},V3("line",{style:e,x1:"5",x2:"5",y1:"0",y2:"10"}))}function LAt(t,e="vertical"){const i=document.createElement("div");return i.style.height=`${CAt}px`,i.className=OAt.univariateAboveAndBelowSymbol,null!=t&&(i.style.opacity=t.toString()),IAt.append(i,RAt.bind(null,e)),i}function NAt(t,e,i="vertical",n){t.infos.forEach(((t,s)=>{if(n&&2===s)t.preview=LAt(e,i);else{const e=QA(t.size)+("horizontal"===i?jAt:EAt),n=t.preview,s="div"===n?.tagName.toLowerCase(),r=s?n:document.createElement("div");r.className=OAt.univariateAboveAndBelowSymbol,"horizontal"===i?r.style.width=`${e}px`:r.style.height=`${e}px`,!s&&n&&r.appendChild(n),t.preview=r}}))}function PAt(t,e="classic"){const i=t.infos;return"classic"===e?(QA(i[0].size)+EAt)/2:(QA(i[0].size)-QA(i[i.length-1].size))/2}function FAt(t,e){if(!t)return null;const i=t.infos.map((t=>t.color)),n=dMt("full"===e.type?i:"above"===e.type?i.slice(0,3):i.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,effectList:e.effectList,ariaLabel:e.ariaLabel});return n.className=OAt.colorRamp,null!=e.opacity&&(n.style.opacity=e.opacity.toString()),n}function DAt(t,e,i,n="vertical"){let s=0;const r=t.infos,o=Math.floor(r.length/2),a="full"===e||"above"===e?0:o,l="full"===e||"below"===e?r.length-1:o;for(let t=a;t<=l;t++)if(i&&t===o)s+="horizontal"===n?kAt:CAt;else{s+=QA(r[t].size)+("horizontal"===n?jAt:EAt)}return Math.round(s)}function $At(t,e,i,n="vertical"){const s=DAt(t,e,i,n),r=t.infos,o=Math.floor(r.length/2),a="full"===e||"above"===e?0:o,l="full"===e||"below"===e?r.length-1:o,u="full"===e?r[a].size+r[l].size:"above"===e?r[a].size:r[l].size,c=i?"vertical"===n?CAt:kAt:0,h="vertical"===n?EAt*("full"===e?2:1):jAt*("full"===e?2:1);return Math.round(s-(QA(u)/2+c/2+h/2))}function zAt(t,e,i="vertical"){const n=t.infos;let s=n.find((({type:t})=>"size-ramp"===t)),r=n.find((({type:t})=>"color-ramp"===t));return s&&(s={...s},s.infos=[...s.infos],NAt(s,e,i,!0)),r&&(r={...r},r.infos=[...r.infos]),"horizontal"===i&&(s?.infos.reverse(),r?.infos.reverse()),{sizeRampElement:s,colorRampElement:r}}function UAt(t,e="vertical"){const i=t.infos;let n=i.find((({type:t})=>"size-ramp"===t)),s=i.find((({type:t})=>"color-ramp"===t));return n&&(n={...n},n.infos=[...n.infos],NAt(n,null,e,!1)),s&&(s={...s},s.infos=[...s.infos]),"horizontal"===e&&(n?.infos.reverse(),s?.infos.reverse()),{sizeRampElement:n,colorRampElement:s}}function BAt(t,e){return e}function GAt(t){const e=this;t.appendChild(e)}function VAt(t,e,i){if(!e)return;if("number"==typeof e)return e;if("string"==typeof e)return kt(e);if("value"in e||"unit"in e)return Xg(t.dotValue,e);if("colorName"in e&&"bandName"in e)return t[e.colorName]+": "+(t[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?t.clusterCountTitle:void 0;let n=null;return BAt(e,i)?n=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:qAt(e,i)&&(n=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),n?Xg("showField"===n?"{field}":t[n],{field:e.field,normField:e.normField}):void 0}function qAt(t,e){return!e}function HAt(t,e){return!!(e&&"Stretched"===e&&t.version>=10.3&&"esri.layers.ImageryLayer"===t.declaredClass)}function WAt(t,e){return t.label?e[t.label]+": "+("string"==typeof t.value?t.value:Jg(t.value??0,{style:"decimal",notation:t.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}function ZAt({level:t,class:e,...i},n){const s=JAt(t);return V3(`h${s}`,{...i,"aria-level":String(s),class:ex(P3.heading,e),role:"heading"},n)}function JAt(t){return wf(Math.ceil(t),1,6)}function YAt(t,e=1){return JAt(t+e)}const KAt=25,QAt=25,XAt=768,tIt=100,eIt="#ddd",iIt=window.devicePixelRatio;function nIt(t){if(t){if(t.type.includes("3d")){const e=t.symbolLayers?.length;if(!e)return;const i=t.symbolLayers.at(e-1),n=i.resource?.primitive;return"circle"===n||"cross"===n||"kite"===n||"sphere"===n||"cube"===n||"diamond"===n}{const e=t.style;return"circle"===e||"diamond"===e||"cross"===e}}}function sIt(t){if(t){if(t.type.includes("3d")){const e=t.symbolLayers?.length;if(!e)return;const i=t.symbolLayers.at(e-1).get("resource.primitive");return"triangle"===i||"cone"===i||"tetrahedron"===i}return"triangle"===t.style}}let rIt=class extends A3{constructor(t,e){super(t,e),this._hasIndicators=!1,this._selectedSectionName=null,this._sectionNames=[],this._sectionMap=new Map,this.activeLayerInfos=null,this.headingLevel=3,this.layout="stack",this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}initialize(){this.addHandles(ey((()=>this.activeLayerInfos),(t=>{this.removeAllHandles(),this._watchForSectionChanges(t)})))}render(){const{view:t}=this;this._hasIndicators="auto"===this.layout&&t&&t.container.clientWidth<=XAt||"stack"===this.layout;const e=this.activeLayerInfos,i=e?.toArray().map((t=>this._renderLegendForLayer(t))).filter((t=>!!t));this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const n=this._sectionNames.length,s=this._sectionNames.map(((t,e)=>{const i=Xg(this.messagesCommon.pagination.pageText,{index:e+1,total:n});return V3("div",{"aria-controls":`${t}-panel`,"aria-label":i,"aria-selected":(this._selectedSectionName===t).toString(),bind:this,class:this.classes(AAt.indicator,{[AAt.activated]:this._selectedSectionName===t}),"data-section-name":t,id:t,key:t,onclick:this._selectSection,onkeydown:this._focusSection,role:"tab",tabIndex:this._selectedSectionName===t?0:-1,title:i})})),r=this._hasIndicators&&n>1?V3("div",{class:AAt.indicatorContainer,key:"carousel-navigation",role:"tablist"},s):null,o=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):i?.length?i:null,a={[AAt.stacked]:this._hasIndicators};return V3("div",{class:this.classes(AAt.base,a)},o||V3("div",{class:AAt.message},this.messages.noLegend),r)}_selectSection(t){const e=t.target.getAttribute("data-section-name");e&&(this._selectedSectionName=e)}_focusSection(t){switch(t.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(t);break;case"Enter":case" ":this._selectSection(t)}}_switchSectionOnArrowPress(t){const e=t.key,i="ArrowLeft"===e?-1:1,n=t.target.getAttribute("data-section-name"),s=this._sectionNames.indexOf(n),r=this._sectionNames;let o=null;-1!==s&&(r[s+i]?o=document.getElementById(r[s+i]):"ArrowLeft"===e?o=document.getElementById(r[r.length-1]):"ArrowRight"===e&&(o=document.getElementById(r[0])),o?.focus())}_watchForSectionChanges(t){if(this._generateSectionNames(),t){t.forEach((t=>{const e=`activeLayerInfo-${t.layer.uid}-version-change`;this.removeHandles(e),this._watchForSectionChanges(t.children),this.addHandles(ey((()=>t.version),(()=>this._generateSectionNames())),e)}));const e="activeLayerInfos-collection-change";this.removeHandles(e),this.addHandles(t.on("change",(()=>this._watchForSectionChanges(t))),e)}}_generateSectionNames(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(t,e,i){return`${this.id}${t.uid}-type-${e.type}-${i}`}_generateSectionNamesForActiveLayerInfo(t){t.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),t.legendElements&&t.legendElements.forEach(((e,i)=>{this._sectionNames.push(this._getSectionName(t.layer,e,i))}))}_renderLegendForLayer(t){if(!t.ready)return null;if(t.children.length){const e=t.children.map((t=>this._renderLegendForLayer(t))).toArray();return V3("div",{class:this.classes(AAt.service,AAt.groupLayer),key:t.layer.uid},V3("div",{class:AAt.serviceCaptionContainer},t.title),e)}{const e=t.legendElements;if(e&&!e.length)return null;const i=e.some((t=>"relationship-ramp"===t.type)),n=e.map(((e,n)=>this._renderLegendForElement(e,t,n,i))).filter((t=>!!t));if(!n.length)return null;const s={[AAt.groupLayerChild]:!!t.parent};return V3("div",{class:this.classes(AAt.service,s),key:t.layer.uid},V3("div",{class:AAt.serviceCaptionContainer},V3("div",{class:AAt.serviceCaptionText},t.title)),V3("div",{class:AAt.serviceContent},n))}}_renderLegendForElement(t,e,i,n=!1,s=!1){const r="color-ramp"===t.type,o="opacity-ramp"===t.type,a=e.layer;let l=null;if("string"==typeof t.title)l=t.title;else if(t.title){const e=t.title,i=VAt(this.messages,e,r||o);l=e.title?`${e.title} (${i})`:i}const u=this._getSectionName(a,t,i),c=this._hasIndicators&&!s?V3("div",null,V3(ZAt,{class:AAt.carouselTitle,level:this.headingLevel},e.title),V3(ZAt,{class:AAt.layerCaption,level:YAt(this.headingLevel)},l)):l?V3(ZAt,{class:AAt.layerCaption,level:this.headingLevel},l):null,h=e.effectList;let d=null;switch(t.type){case"symbol-table":{const i=t.infos.map(((i,n)=>this._renderLegendForElementInfo(i,e,t.legendType,n))).filter((t=>!!t));if(i.length){const t=i[0].properties.classes?.[AAt.symbolRow],e={[AAt.labelContainer]:!t&&!n,[AAt.relationshipLabelContainer]:n};d=V3("div",{class:this.classes(e)},i)}break}case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":d=this._renderLegendForRamp(t,a.opacity,h);break;case"size-ramp":d=this._renderSizeRamp(t,a.opacity);break;case"pie-chart-ramp":d=this._renderPieChartRamp(t);break;case"relationship-ramp":d=yxt(t,this.id,{opacity:a.opacity,effectList:h,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case"univariate-above-and-below-ramp":d=this._renderUnivariateAboveAndBelowRamp(t,a.opacity,h);break;case"univariate-color-size-ramp":d=this._renderUnivariateColorSizeRamp(t,a.opacity,h)}if(!d)return null;const f=V3("div",{"aria-labelledby":u,class:AAt.section,id:`${u}-panel`,key:u,role:"tabpanel",tabIndex:0},[c,d]);return s||this._sectionMap.set(u,f),f}_renderPieChartRamp(t){return V3("div",{afterCreate:GAt,bind:t.preview,class:AAt.pieChartRampPreview})}_renderUnivariateAboveAndBelowRamp(t,e,i){const{sizeRampElement:n,colorRampElement:s}=zAt(t,e,"horizontal");if(!n)return null;const r=DAt(n,"full",!0,"horizontal"),o=$At(n,"above",!0,"horizontal"),a=$At(n,"below",!0,"horizontal"),l=12,u=this.messages?.previewColorRampAriaLabel,c=FAt(s,{width:o,height:l,rampAlignment:"horizontal",opacity:e,type:"above",effectList:i,ariaLabel:u}),h=FAt(s,{width:a,height:l,rampAlignment:"horizontal",opacity:e,type:"below",effectList:i,ariaLabel:u}),d=PAt(n,"card"),f=n.infos.map((t=>t.label)),p=f.length-1,m=f.map(((t,e)=>0===e||e===p?V3("div",{key:e},t):null)),y={display:"flex",flexDirection:"column"},g={display:"flex",flexDirection:"row"},v={marginTop:"3px",display:"flex"};nx(this.container)?v.marginRight=`${d}px`:v.marginLeft=`${d}px`;const w={width:`${r}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return V3("div",{class:AAt.layerRow,key:"size-ramp-preview",styles:y},V3("div",{class:this.classes(AAt.symbolContainer,AAt.sizeRampHorizontal),styles:g},n.infos.map(((t,e)=>V3("div",{afterCreate:GAt,bind:t.preview,class:AAt.symbol,key:e})))),c?V3("div",{class:AAt.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:v},V3("div",{afterCreate:GAt,bind:c}),V3("div",{afterCreate:GAt,bind:h})):null,V3("div",{class:AAt.layerInfo},V3("div",{class:AAt.rampLabelsContainer,styles:w},m)))}_renderUnivariateColorSizeRamp(t,e,i){const{sizeRampElement:n,colorRampElement:s}=UAt(t,"horizontal");if(!n)return null;const r=DAt(n,"full",!1,"horizontal"),o=$At(n,"full",!1,"horizontal"),a=FAt(s,{width:o,height:12,rampAlignment:"horizontal",opacity:e,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),l=PAt(n,"card"),u=n.infos.length-1,c=n.infos.map(((t,e)=>0===e||e===u?V3("div",{key:e},t.label):null)),h={display:"flex",flexDirection:"column"},d={display:"flex",flexDirection:"row"},f={marginTop:"3px",display:"flex"};nx(this.container)?f.marginRight=`${l}px`:f.marginLeft=`${l}px`;const p={width:`${r}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return V3("div",{class:AAt.layerRow,key:"size-ramp-preview",styles:h},V3("div",{class:this.classes(AAt.symbolContainer,AAt.sizeRampHorizontal),styles:d},n.infos.map(((t,e)=>V3("div",{afterCreate:GAt,bind:t.preview,class:AAt.symbol,key:e})))),V3("div",{class:AAt.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:f},V3("div",{afterCreate:GAt,bind:a})),V3("div",{class:AAt.layerInfo},V3("div",{class:AAt.rampLabelsContainer,styles:p},c)))}_renderLegendForElementInfo(t,e,i,n){const s=e.layer;if(t.type)return this._renderLegendForElement(t,e,n,!1,!0);const r=HAt(s,i),o=VAt(this.messages,t.label,!1)??"";if(t.preview){if(!t.symbol?.type.includes("simple-fill")){if(!t.label)return V3("div",{afterCreate:GAt,bind:t.preview,key:n});const e={[AAt.symbolCell]:this._hasIndicators};return V3("div",{class:this.classes(AAt.layerRow,{[AAt.symbolRow]:this._hasIndicators}),key:n},V3("div",{afterCreate:GAt,bind:t.preview,class:this.classes(e)}),V3("div",{class:this.classes(AAt.imageLabel,{[AAt.labelCell]:this._hasIndicators})},o))}let i=255,r=255,a=255,l=0,u=255,c=255,h=255,d=0;const f=t.symbol.color?.a,p=t.symbol.outline?.color?.a;f&&(i=t.symbol.color.r,r=t.symbol.color.g,a=t.symbol.color.b,l=t.symbol.color.a*s.opacity),p&&(u=t.symbol.outline.color.r,c=t.symbol.outline.color.g,h=t.symbol.outline.color.b,d=t.symbol.outline.color.a*s.opacity);const m=t.symbol.color?.isBright??!0,y=m?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",g={background:f?`rgba(${i}, ${r}, ${a}, ${l})`:"none",color:m?"black":"white",textShadow:`-1px -1px 0 ${y},\n                                              1px -1px 0 ${y},\n                                              -1px 1px 0 ${y},\n                                              1px 1px 0 ${y}`,border:p?`1px solid rgba(${u}, ${c}, ${h}, ${d})`:"none",filter:ext(e.effectList)??void 0};return V3("div",{class:AAt.layerRow,key:n},V3("div",{class:AAt.labelElement,styles:g},o))}if(t.src){const e=this._renderImage(t,s,r);return V3("div",{class:AAt.layerRow,key:n},e,V3("div",{class:AAt.imageLabel},o))}}_renderImage(t,e,i){const{label:n,src:s,opacity:r}=t,o={[AAt.imageryLayerStretchedImage]:i,[AAt.symbol]:!i},a={opacity:`${null!=r?r:e.opacity}`};return V3("img",{alt:VAt(this.messages,n,!1),"aria-label":VAt(this.messages,n,!1),border:0,class:this.classes(o),height:t.height,src:s,styles:a,width:t.width})}_renderSizeRampLines(t){const e=t.infos,i=e[0],n=e[e.length-1],s=i.symbol,r=this._hasIndicators,o=QA(i.size+i.outlineSize)*iIt,a=QA(n.size+n.outlineSize)*iIt,l=r?o:o+50*iIt,u=r?o/2+50*iIt:o,c=sIt(s),h=nIt(s),d=document.createElement("canvas");d.width=l,d.height=u,d.style.width=d.width/iIt+"px",d.style.height=d.height/iIt+"px";const f=d.getContext("2d");if(r){f.beginPath();const t=0,e=0,i=l/2-a/2,n=u;f.moveTo(t,e),f.lineTo(i,n);const s=l,r=0,o=l/2+a/2,c=u;f.moveTo(s,r),f.lineTo(o,c)}else{f.beginPath();const t=0,e=u/2-a/2,i=l,n=0;f.moveTo(t,e),f.lineTo(i,n);const s=0,r=u/2+a/2,o=l,c=u;f.moveTo(s,r),f.lineTo(o,c)}return f.strokeStyle=eIt,f.stroke(),V3("div",{afterCreate:GAt,bind:d,styles:r?{display:"flex",marginTop:`-${c?0:h?o/2:0}px`,marginBottom:`-${c?a:h?a/2:0}px`}:{display:"flex",marginRight:`-${c?0:h?o/2:0}px`,marginLeft:`-${c?0:h?a/2:0}px`}})}_renderSizeRamp(t,e){const i=t.infos,n=i[0].label,s=i[i.length-1].label;let r=i[0].preview,o=i[i.length-1].preview;const a=this._hasIndicators,l={"flex-direction":a?"column":"row-reverse"};r&&(r=r.cloneNode(!0),r.style.display="flex"),o&&(o=o.cloneNode(!0),o.style.display="flex");const u={opacity:null!=e?`${e}`:""};return V3("div",{class:this.classes(AAt.layerRow,{[AAt.sizeRampRow]:a})},V3("div",{class:AAt.rampLabel},a?n:s),V3("div",{class:AAt.sizeRampContainer,styles:l},V3("div",{afterCreate:GAt,bind:r,class:AAt.sizeRampPreview,styles:u}),this._renderSizeRampLines(t),V3("div",{afterCreate:GAt,bind:o,class:AAt.sizeRampContainer,styles:u})),V3("div",{class:AAt.rampLabel},a?s:n))}_getRampStopLabel(t,e){switch(e){case"heatmap-ramp":return this.messages[t.label];case"stretch-ramp":return WAt(t,this.messages);default:return t.label}}_renderLegendForRamp(t,e,i){const n=t.infos,s=t.type,r="heatmap-ramp"===s,o=n.length-1,a=QAt,l=o>2&&!r?KAt*o:tIt,u=l+20,c=10,h=n.slice().reverse(),d=h.length-1,f=h.length%2!=0?h[h.length/2|0]:null,p=f&&V3("div",{class:AAt.intervalSeparatorsContainer},V3("div",{class:AAt.intervalSeparator},"|"),V3("div",{class:AAt.rampLabel},this._getRampStopLabel(f,s))),m=[[{shape:{type:"path",path:`M0 ${a/2} L${c} 0 L${c} ${a} Z`},fill:h[0].color,stroke:{width:0}},{shape:{type:"rect",x:c,y:0,width:l,height:a},fill:{type:"linear",x1:c,y1:0,x2:l+c,y2:0,colors:h.map(((t,e)=>({color:t.color,offset:r&&"ratio"in t?t.ratio:e/o})))},stroke:{width:0}},{shape:{type:"path",path:`M${l+c} 0 L${u} ${a/2} L${l+c} ${a} Z`},fill:h[d].color,stroke:{width:0}}]],y=E_t(m,u,a),g={filter:ext(i)??void 0,opacity:null==e?void 0:`${e}`},v={justifyContent:"center"};return V3("div",{class:AAt.layerRow,styles:v},V3("div",{class:AAt.rampLabel},this._getRampStopLabel(h[0],s)),V3("div",{class:AAt.symbolContainer},V3("div",{styles:g},y),p),V3("div",{class:AAt.rampLabel},this._getRampStopLabel(h[d],s)))}};r([Je()],rIt.prototype,"activeLayerInfos",void 0),r([Je()],rIt.prototype,"headingLevel",void 0),r([Je()],rIt.prototype,"layout",void 0),r([Je(),z3("esri/widgets/Legend/t9n/Legend")],rIt.prototype,"messages",void 0),r([Je(),z3("esri/t9n/common")],rIt.prototype,"messagesCommon",void 0),r([Je({readOnly:!0})],rIt.prototype,"type",void 0),r([Je()],rIt.prototype,"view",void 0),r([F3()],rIt.prototype,"_selectSection",null),rIt=r([ln("esri.widgets.Legend.styles.Card")],rIt);const oIt=rIt;const aIt="esri-legend",lIt={service:`${aIt}__service`,label:`${aIt}__service-label`,layer:`${aIt}__layer`,groupLayer:`${aIt}__group-layer`,groupLayerChild:`${aIt}__group-layer-child`,layerTable:`${aIt}__layer-table`,layerTableSizeRamp:`${aIt}__layer-table--size-ramp`,layerChildTable:`${aIt}__layer-child-table`,layerCaption:`${aIt}__layer-caption`,layerBody:`${aIt}__layer-body`,layerRow:`${aIt}__layer-row`,layerCell:`${aIt}__layer-cell`,layerInfo:`${aIt}__layer-cell ${aIt}__layer-cell--info`,imageryLayerStretchedImage:`${aIt}__imagery-layer-image--stretched`,imageryLayerCellStretched:`${aIt}__imagery-layer-cell--stretched`,imageryLayerInfoStretched:`${aIt}__imagery-layer-info--stretched`,symbolContainer:`${aIt}__layer-cell ${aIt}__layer-cell--symbols`,symbol:`${aIt}__symbol`,rampContainer:`${aIt}__ramps`,sizeRamp:`${aIt}__size-ramp`,colorRamp:`${aIt}__color-ramp`,opacityRamp:`${aIt}__opacity-ramp`,borderlessRamp:`${aIt}__borderless-ramp`,rampTick:`${aIt}__ramp-tick`,rampFirstTick:`${aIt}__ramp-tick-first`,rampLastTick:`${aIt}__ramp-tick-last`,rampLabelsContainer:`${aIt}__ramp-labels`,rampLabel:`${aIt}__ramp-label`,message:`${aIt}__message`,univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};const uIt=`${aIt}__`,cIt=24,hIt={display:"flex",alignItems:"flex-start"},dIt={marginLeft:"3px"},fIt={display:"table-cell",verticalAlign:"middle"};let pIt=class extends A3{constructor(t,e){super(t,e),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const t=this.activeLayerInfos,e=t?.toArray().map((t=>this._renderLegendForLayer(t))).filter((t=>!!t));return V3("div",null,e?.length?e:V3("div",{class:lIt.message},this.messages.noLegend))}_renderLegendForLayer(t,e){if(!t.ready)return null;const i=!!t.children.length,n=`${t.layer.uid}-version-${t.version}`,s=`${uIt}${e?`${e}-`:""}${n}`,r=t.title?ZAt({level:this.headingLevel,class:this.classes(P3.heading,lIt.label)},t.title):null;if(i){const e=t.children.map((t=>this._renderLegendForLayer(t,n))).toArray();return V3("div",{class:this.classes(lIt.service,lIt.groupLayer),key:s},r,e)}{const e=t.legendElements;if(e&&!e.length)return null;const i=e.map((e=>this._renderLegendForElement(e,t.layer,t.effectList,s))).filter((t=>!!t));if(!i.length)return null;const n={[lIt.groupLayerChild]:!!t.parent};return V3("div",{class:this.classes(lIt.service,n),key:s},r,V3("div",{class:lIt.layer},i))}}_renderLegendForElement(t,e,i,n,s){const r="color-ramp"===t.type,o="opacity-ramp"===t.type,a="size-ramp"===t.type;let l=null;const u=`${n}-${t.type}`;if("symbol-table"===t.type||a){const n=t.infos.map((n=>this._renderLegendForElementInfo(n,e,i,a,t.legendType,u))).filter((t=>!!t));n.length&&(l=V3("div",{class:lIt.layerBody},n))}else"color-ramp"===t.type||"opacity-ramp"===t.type||"heatmap-ramp"===t.type||"stretch-ramp"===t.type?l=this._renderLegendForRamp(t,e.opacity,u):"relationship-ramp"===t.type?l=yxt(t,this.id,{opacity:e.opacity,effectList:i,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:u}):"pie-chart-ramp"===t.type?l=this._renderPieChartRamp(t,u):"univariate-above-and-below-ramp"===t.type?l=this._renderUnivariateAboveAndBelowRamp(t,e.opacity,i,u):"univariate-color-size-ramp"===t.type&&(l=this._renderUnivariateColorSizeRamp(t,e.opacity,i,u));if(!l)return null;const c=t.title;let h=null;if("string"==typeof c)h=c;else if(c){const t=VAt(this.messages,c,r||o);h=qAt(c,r||o)&&c.title?`${c.title} (${t})`:t}const d=s?lIt.layerChildTable:lIt.layerTable,f=h?V3("div",{class:lIt.layerCaption},h):null,p={[lIt.layerTableSizeRamp]:a||!s};return V3("div",{class:this.classes(d,p),key:`${n}-table`},f,l)}_renderPieChartRamp(t,e){return V3("div",{afterCreate:GAt,bind:t.preview,key:`${e}-preview`})}_renderUnivariateAboveAndBelowRamp(t,e,i,n){const{sizeRampElement:s,colorRampElement:r}=zAt(t,e);if(!s)return null;const o=this.messages?.previewColorRampAriaLabel,a=$At(s,"above",!0),l=$At(s,"below",!0),u=12,c=FAt(r,{width:u,height:a,rampAlignment:"vertical",opacity:e,type:"above",effectList:i,ariaLabel:o}),h=FAt(r,{width:u,height:l,rampAlignment:"vertical",opacity:e,type:"below",effectList:i,ariaLabel:o}),d=PAt(s),f=s.infos.map((t=>t.label)),p=f.map(((t,e)=>{const i=2===e;return 0===e?V3("div",{class:t?c?lIt.univariateAboveAndBelowLabel:lIt.rampLabel:void 0,key:`${n}-color-ramp-above-label-${t??e}`},t):i?V3("div",null):null})),m=f.length-1,y=Math.floor(f.length/2),g=f.map(((t,e)=>e===y||e===m?V3("div",{class:t?c?lIt.univariateAboveAndBelowLabel:lIt.rampLabel:void 0,key:`${n}-color-ramp-below-label-${t??e}`},t):null)),v={display:"table-cell",verticalAlign:"middle"},w={marginTop:`${d}px`},b={height:`${a}px`},S={height:`${l}px`};return V3("div",{key:`${n}-container`,styles:hIt},V3("div",{class:lIt.layerBody},s.infos.map(((t,e)=>V3("div",{class:this.classes(lIt.layerRow,lIt.sizeRamp),key:`${n}-row-${e}`},V3("div",{afterCreate:GAt,bind:t.preview,class:lIt.symbol,styles:v}),c||e%2!=0?null:V3("div",{class:lIt.layerInfo},f[e]))))),c?V3("div",{styles:w},V3("div",{styles:dIt},V3("div",{styles:fIt},V3("div",{afterCreate:GAt,bind:c,class:lIt.rampContainer})),V3("div",{styles:fIt},V3("div",{class:lIt.rampLabelsContainer,styles:b},p))),V3("div",{styles:dIt},V3("div",{styles:fIt},V3("div",{afterCreate:GAt,bind:h,class:lIt.rampContainer})),V3("div",{styles:fIt},V3("div",{class:lIt.rampLabelsContainer,styles:S},g)))):null)}_renderUnivariateColorSizeRamp(t,e,i,n){const{sizeRampElement:s,colorRampElement:r}=UAt(t);if(!s)return null;const o=PAt(s),a=12,l=$At(s,"full",!1),u=FAt(r,{width:a,height:l,rampAlignment:"vertical",opacity:e,type:"full",effectList:i,ariaLabel:this.messages?.previewColorRampAriaLabel}),c=s.infos.length-1,h=s.infos.map(((t,e)=>0===e||e===c?V3("div",{class:t.label?r?lIt.univariateAboveAndBelowLabel:lIt.rampLabel:void 0,key:`${n}-color-ramp-label-${t.label??e}`},t.label):null)),d={display:"table-cell",verticalAlign:"middle"},f={marginTop:`${o}px`},p={height:`${l}px`};return V3("div",{key:`${n}-container`,styles:hIt},V3("div",{class:lIt.layerBody},s.infos.map(((t,e)=>V3("div",{class:this.classes(lIt.layerRow,lIt.sizeRamp),key:`${n}-row-${e}`},V3("div",{afterCreate:GAt,bind:t.preview,class:lIt.symbol,styles:d}))))),V3("div",{styles:f},V3("div",{styles:dIt},V3("div",{styles:fIt},V3("div",{afterCreate:GAt,bind:u,class:lIt.rampContainer})),V3("div",{styles:fIt},V3("div",{class:lIt.rampLabelsContainer,styles:p},h)))))}_renderLegendForRamp(t,e,i){const n=t.infos,s="opacity-ramp"===t.type,r="heatmap-ramp"===t.type,o="stretch-ramp"===t.type,a=t.preview,l=s?lIt.opacityRamp:"";a.className=`${lIt.colorRamp} ${l}`,null!=e&&(a.style.opacity=e.toString());const u=n.map(((t,e)=>V3("div",{class:t.label?lIt.rampLabel:void 0,key:`${i}-stop-${t.label??e}-label`},r?this.messages[t.label]||t.label:o?WAt(t,this.messages):t.label))),c={width:`${cIt}px`},h={height:a.style.height};return V3("div",{class:lIt.layerRow,key:`${i}-row`},V3("div",{class:lIt.symbolContainer,styles:c},V3("div",{afterCreate:GAt,bind:a,class:lIt.rampContainer})),V3("div",{class:lIt.layerInfo},V3("div",{class:lIt.rampLabelsContainer,styles:h},u)))}_renderLegendForElementInfo(t,e,i,n,s,r){const o=`${r}-${t.label}`;if(t.type)return this._renderLegendForElement(t,e,i,o,!0);let a=null;const l=HAt(e,s);if(t.preview?a=V3("div",{afterCreate:GAt,bind:t.preview,class:lIt.symbol}):t.src&&(a=this._renderImage(t,e,l)),!a)return null;const u={[lIt.imageryLayerInfoStretched]:l},c={[lIt.imageryLayerInfoStretched]:l,[lIt.sizeRamp]:!l&&n};return V3("div",{class:lIt.layerRow,key:`${o}-row`},V3("div",{class:this.classes(lIt.symbolContainer,c)},a),V3("div",{class:this.classes(lIt.layerInfo,u)},VAt(this.messages,t.label,!1)||""))}_renderImage(t,e,i){const{label:n,src:s,opacity:r}=t,o={[lIt.imageryLayerStretchedImage]:i,[lIt.symbol]:!i},a={opacity:`${null!=r?r:e.opacity}`};return V3("img",{alt:VAt(this.messages,n,!1),"aria-label":VAt(this.messages,n,!1),border:0,class:this.classes(o),height:t.height,src:s,styles:a,width:t.width})}};r([Je()],pIt.prototype,"activeLayerInfos",void 0),r([Je()],pIt.prototype,"headingLevel",void 0),r([Je(),z3("esri/widgets/Legend/t9n/Legend")],pIt.prototype,"messages",void 0),r([Je({readOnly:!0})],pIt.prototype,"type",void 0),pIt=r([ln("esri.widgets.Legend.styles.Classic")],pIt);const mIt=pIt;const yIt={base:"esri-legend"};let gIt=class extends A3{constructor(t,e){super(t,e),this.headingLevel=3,this.messages=null,this.style=new mIt,this.viewModel=new xAt}initialize(){this.addHandles([sy((()=>this.view),"resize",(()=>this.scheduleRender())),sy((()=>this.activeLayerInfos),"change",(()=>this._refreshActiveLayerInfos(this.activeLayerInfos))),ey((()=>this.headingLevel),(t=>{const{style:e}=this;e&&(e.headingLevel=t)})),ey((()=>this.style),((t,e)=>{e&&t!==e&&e.destroy(),t&&(t.activeLayerInfos=this.activeLayerInfos,"card"===t.type&&(t.view=this.view),t.headingLevel=this.headingLevel)}),dy)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(t){this.viewModel.activeLayerInfos=t}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(t){this.viewModel.basemapLegendVisible=t}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(t){this.viewModel.groundLegendVisible=t}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(t){this.viewModel.hideLayersNotInCurrentView=t}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(t){this.viewModel.keepCacheOnDestroy=t}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(t){this.viewModel.respectLayerDefinitionExpression=t}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(t){this.viewModel.respectLayerVisibility=t}get icon(){return"legend"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(t){this.viewModel.layerInfos=t}castStyle(t){if(t instanceof oIt||t instanceof mIt)return t;if("string"==typeof t)return"card"===t?new oIt:new mIt;if(t&&"string"==typeof t.type){const e={...t};delete e.type;return new("card"===t.type?oIt:mIt)(e)}return new mIt}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){return V3("div",{class:this.classes(yIt.base,P3.widget,this.style instanceof mIt?P3.panel:null)},this.style.render())}_refreshActiveLayerInfos(t){t.forEach((t=>{this.removeHandles(`version_${t.layer.uid}`),this._renderOnActiveLayerInfoChange(t)})),this.scheduleRender()}_renderOnActiveLayerInfoChange(t){const e=ey((()=>t.version),(()=>this.scheduleRender()));this.addHandles(e,`version_${t.layer.uid}`);const i=sy((()=>t.children),"change",(()=>t.children.forEach((t=>this._renderOnActiveLayerInfoChange(t)))),dy);this.addHandles(i,`version_${t.layer.uid}`),t.children.forEach((t=>this._renderOnActiveLayerInfoChange(t)))}};r([Je()],gIt.prototype,"activeLayerInfos",null),r([Je()],gIt.prototype,"basemapLegendVisible",null),r([Je()],gIt.prototype,"groundLegendVisible",null),r([Je()],gIt.prototype,"headingLevel",void 0),r([Je()],gIt.prototype,"hideLayersNotInCurrentView",null),r([Je()],gIt.prototype,"keepCacheOnDestroy",null),r([Je()],gIt.prototype,"respectLayerDefinitionExpression",null),r([Je()],gIt.prototype,"respectLayerVisibility",null),r([Je()],gIt.prototype,"icon",null),r([Je()],gIt.prototype,"label",null),r([Je()],gIt.prototype,"layerInfos",null),r([Je(),z3("esri/widgets/Legend/t9n/Legend")],gIt.prototype,"messages",void 0),r([Je()],gIt.prototype,"style",void 0),r([Ah("style")],gIt.prototype,"castStyle",null),r([Je()],gIt.prototype,"view",null),r([Je()],gIt.prototype,"viewModel",void 0),gIt=r([ln("esri.widgets.Legend")],gIt);const vIt=gIt;const wIt=Object.freeze({__proto__:null,default:vIt});var bIt;!function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"}(bIt||(bIt={}));function SIt(t,e){return{type:Lc(e),value:t,unit:e}}function _It(t){return{value:t}}function xIt(t,e){return{type:Lc(e),value:t,unit:e}}function MIt(t,e){return{type:Lc(e),value:t,unit:e}}function TIt(t,e,i="arithmetic"){return{type:Lc(e),value:t,unit:e,rotationType:i}}function AIt(t,e){const i=IIt(t,e);return"angle"===t.type?TIt(i,e,t.rotationType):SIt(i,e)}function IIt(t,e){return Pc(t.value,t.unit,e)}function kIt(t,e,i){if(e===i)return t;switch(i){case"arithmetic":case"geographic":return 90-t}}const CIt=xIt(0,"meters"),EIt=MIt(0,"square-meters");TIt(0,"radians");const jIt=TIt(0,"degrees"),OIt=TIt(0,"degrees","geographic");function RIt(t,e,i){return t.units[e][i]}function LIt(t,e,i,n=2,s="abbr"){return`${Jg(e,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:e>0?"never":"exceptZero"})} ${RIt(t,i,s)}`}function NIt(t,e,i,n=2,s="abbr"){return`${Jg(e,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})} ${RIt(t,i,s)}`}function PIt(t,e,i,n=2,s="abbr"){const r=zc(e,i);return LIt(t,Pc(e,i,r),r,n,s)}function FIt(t,e,i,n=2,s="abbr"){const r=zc(e,i);return NIt(t,Pc(e,i,r),r,n,s)}function DIt(t,e,i,n=2,s="abbr"){const r=Uc(e,i);return LIt(t,Pc(e,i,r),r,n,s)}function $It(t,e,i,n=2,s="abbr"){const r=Uc(e,i);return NIt(t,Pc(e,i,r),r,n,s)}function zIt(t,e,i,n=2,s="abbr"){const r=Bc(e,i);return LIt(t,Pc(e,i,r),r,n,s)}function UIt(t,e,i,n=2,s="abbr"){const r=Bc(e,i);return NIt(t,Pc(e,i,r),r,n,s)}function BIt(t,e,i,n=2,s="abbr"){const r=Gc(e,i);return LIt(t,Pc(e,i,r),r,n,s)}function GIt(t,e,i,n=2,s="abbr"){const r=Gc(e,i);return NIt(t,Pc(e,i,r),r,n,s)}function VIt(t,e,i,n=2,s="abbr"){const r=Vc(e,i);return LIt(t,Pc(e,i,r),r,n,s)}function qIt(t,e,i,n=2,s="abbr"){const r=qc(e,i);return LIt(t,Pc(e,i,r),r,n,s)}const HIt=(t,e)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:e,minimumFractionDigits:e,signDisplay:t>0?"never":"exceptZero"});function WIt(t,e,i,n,s,r=gm,o=!0){let a=r.normalize(kIt(Pc(t,e,"degrees"),i,n),0,o);const l=HIt(a,s??2);return a=JIt(a,l),Jg(a,l)}const ZIt=new Map;function JIt(t,e){const i=JSON.stringify(e);let n=ZIt.get(i);return n||(n=new Intl.NumberFormat("en-US",e),ZIt.set(i,n)),/^[-+]?360\.?0*°?$/.test(n.format(t))?0:t}const YIt=["B","kB","MB","GB","TB"];function KIt(t,e){let i=0===(e=Math.round(e))?0:Math.floor(Math.log(e)/Math.log(bIt.KILOBYTES));i=wf(i,0,YIt.length-1);const n=Jg(e/bIt.KILOBYTES**i,{maximumFractionDigits:2});return Mt(t.units.bytes[YIt[i]],{fileSize:n})}function QIt(t){const e=t.toLowerCase();return"image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e}function XIt(t){const e=ru("esri/themes/base/images/files/");return t?"text/plain"===t?`${e}text-32.svg`:"application/pdf"===t?`${e}pdf-32.svg`:"text/csv"===t?`${e}csv-32.svg`:"application/gpx+xml"===t?`${e}gpx-32.svg`:"application/x-dwf"===t?`${e}cad-32.svg`:"application/postscript"===t||"application/json"===t||"text/xml"===t||"model/vrml"===t?`${e}code-32.svg`:"application/x-zip-compressed"===t||"application/x-7z-compressed"===t||"application/x-gzip"===t||"application/x-tar"===t||"application/x-gtar"===t||"application/x-bzip2"===t||"application/gzip"===t||"application/x-compress"===t||"application/x-apple-diskimage"===t||"application/x-rar-compressed"===t||"application/zip"===t?`${e}zip-32.svg`:t.includes("image/")?`${e}image-32.svg`:t.includes("audio/")?`${e}sound-32.svg`:t.includes("video/")?`${e}video-32.svg`:t.includes("msexcel")||t.includes("ms-excel")||t.includes("spreadsheetml")?`${e}excel-32.svg`:t.includes("msword")||t.includes("ms-word")||t.includes("wordprocessingml")?`${e}word-32.svg`:t.includes("powerpoint")||t.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}function tkt(t){return t?"text/plain"===t?"file-text":"application/pdf"===t?"file-pdf":"text/csv"===t?"file-csv":"application/gpx+xml"===t?"file-gpx":"application/x-dwf"===t?"file-cad":"application/postscript"===t||"application/json"===t||"text/xml"===t||"model/vrml"===t?"file-code":"application/x-zip-compressed"===t||"application/x-7z-compressed"===t||"application/x-gzip"===t||"application/x-tar"===t||"application/x-gtar"===t||"application/x-bzip2"===t||"application/gzip"===t||"application/x-compress"===t||"application/x-apple-diskimage"===t||"application/x-rar-compressed"===t||"application/zip"===t?"file-zip":t.includes("image/")?"file-image":t.includes("audio/")?"file-sound":t.includes("video/")?"file-video":t.includes("msexcel")||t.includes("ms-excel")||t.includes("spreadsheetml")?"file-excel":t.includes("msword")||t.includes("ms-word")||t.includes("wordprocessingml")?"file-word":t.includes("powerpoint")||t.includes("presentationml")?"file-ppt":"file":"file"}const ekt={danger:"exclamation-mark-circle",info:"information",success:"check",warning:"exclamation-mark-triangle",brand:void 0,neutral:void 0,inverse:void 0};const ikt="esri-editor__prompt",nkt={base:ikt,header:`${ikt}__header`,heading:`${ikt}__header__heading`,message:`${ikt}__message`,divider:`${ikt}__divider`,actions:`${ikt}__actions`},skt=()=>o3({button:()=>import("./p-5b44be17.js"),icon:()=>import("./p-a8caa0f1.js"),scrim:()=>import("./p-b4a3ac03.js"),label:()=>import("./p-6fa88b99.js"),"radio-button":()=>import("./p-d16eeb83.js"),"radio-button-group":()=>import("./p-2526320f.js")});function rkt({actions:t,context:e,headingLevel:i,message:n,title:s,...r}){const{primary:o,secondary:a}=t;let l;switch(e){case"danger":l="danger";break;case"info":l="brand";break;default:l="neutral"}const u=V3("calcite-button",{afterCreate:t=>hx(t),appearance:"solid","data-testid":"primary-prompt-button",key:"prompt-primary-button",kind:l,onclick:o.action,width:a?"half":"full"},o.label),c=a&&V3("calcite-button",{appearance:"outline","data-testid":"secondary-prompt-button",key:"prompt-secondary-button",kind:l,onclick:a.action,width:"half"},a.label);return V3("calcite-scrim",{"data-testid":"prompt",key:"prompt"},V3("div",{class:`${nkt.base}--${e}`},V3("div",{class:nkt.header},V3("calcite-icon",{icon:ekt.warning}),V3(ZAt,{class:nkt.heading,level:i},s)),V3("div",{class:nkt.message},n),okt(r)??V3("div",{class:nkt.divider}),V3("div",{class:nkt.actions},c,u)))}function okt({radios:t,onRadioSelection:e,defaultRadioSelection:i}){return t?.length?V3("calcite-radio-button-group",{name:"PromptChoiceList"},t.map((t=>V3("calcite-label",{layout:"inline"},V3("calcite-radio-button",{checked:t.value===i,value:t.value,onCalciteRadioButtonChange:()=>e?.(t.value)}),t.label)))):void 0}let akt=class extends ao{constructor(t){super(t),this.sortAscending=!0,this.sortDescending=!0}};r([Je({type:Boolean,nonNullable:!0})],akt.prototype,"sortAscending",void 0),r([Je({type:Boolean,nonNullable:!0})],akt.prototype,"sortDescending",void 0),akt=r([ln("esri.widgets.FeatureTable.ColumnMenuVisibleElements")],akt);const lkt=akt;const ukt="esri-column",ckt={contentFull:`${ukt}__content--full`,sorter:`${ukt}__sorter`,headerContent:`${ukt}__header-content`,headerDescription:`${ukt}__header-description`,headerLabel:`${ukt}__header-label`,headerMenuIcon:`${ukt}__header-menu-icon`};function hkt(t){return null!=t&&"object"==typeof t&&"type"in t&&null!==t.type&&("column"===t.type||"field"===t.type||"group"===t.type||"attachment"===t.type||"relationship"===t.type)}function dkt(t){return!(!t||!("field"in t))}function fkt(t){return!(!t||!("columns"in t))}function pkt(t){return!(!t||!("relationshipId"in t))}function mkt(t){return!(!t||!("onShowAttachments"in t))}const ykt={action:"EsriFeatureTableActionColumn",attachments:"EsriFeatureTableAttachmentsColumn",relationship:"EsriFeatureTableRelationshipColumn"},gkt=()=>o3({action:()=>import("./p-255edeba.js"),button:()=>import("./p-5b44be17.js"),dropdown:()=>import("./p-b0fc8730.js"),"dropdown-item":()=>import("./p-814492c7.js"),"dropdown-group":()=>import("./p-038de826.js"),icon:()=>import("./p-a8caa0f1.js")}),vkt=()=>Promise.all([o3({input:()=>import("./p-0949d63c.js"),option:()=>import("./p-42a142f7.js"),select:()=>import("./p-b1148905.js"),"input-date-picker":()=>import("./p-e7824c6c.js"),"input-time-picker":()=>import("./p-703d6e1e.js")}),gkt()]),wkt=()=>Promise.all([o3({"action-bar":()=>import("./p-1ec4c7b3.js")}),vkt()]);function bkt(t){return null!=t&&"object"==typeof t&&"createQuery"in t&&"getField"in t&&"queryFeatureCount"in t&&"queryFeatures"in t&&"queryObjectIds"in t&&"capabilities"in t&&"fields"in t&&"fieldsIndex"in t&&"id"in t&&"load"in t&&"objectIdField"in t&&"type"in t&&"when"in t}function Skt(t){return bkt(t)&&"queryAttachments"in t}function _kt(t){return Skt(t)&&"addAttachment"in t&&"deleteAttachments"in t&&"updateAttachment"in t}function xkt(t){return bkt(t)&&"editingEnabled"in t&&"applyEdits"in t}function Mkt(t){return bkt(t)&&"relationships"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t}function Tkt(t){return null!=t&&"object"==typeof t&&"type"in t&&"map-image"===t.type}function Akt(t,e,{relatedTableId:i}){if(!e?.map)return;const n="scene"===t.type&&t.associatedLayer?t.associatedLayer.url:t.url,s=e=>!(!Mkt(e)||e===t)&&("sublayer"===e.type&&e.layer?.url===t.url?e.id===i:n===e.url&&e.layerId===i);if("sublayer"===t.type&&Tkt(t.parent)){const e=e=>Mkt(e)&&e!==t&&e.id===i,n=t.parent,s=n.sublayers?.find(e)||n.subtables?.find(e);if(Mkt(s))return s}const r=[...e.map.allLayers,...e.map.allTables];let o=null;for(const t of r)if(Tkt(t)){const e=t.sublayers?.find(s)||t.subtables?.find(s);if(e){o=e;break}}else if(s(t)){o=t;break}return Mkt(o)?o:void 0}function Ikt(t,e){return null!=t&&Number.isInteger(t)&&t>-1&&t<e}function kkt(t){return null==t||0===t.trim().length}function Ckt(t,e){return(t.relationships??[]).filter((t=>!(t.id===e&&"one-to-one"===t.cardinality))).map((({id:t})=>({relationshipId:t})))}function Ekt(t,e){return t.relationships?.find((({id:t})=>t===e))}function jkt(t,e){return null==e?null:t?.fields?.find((t=>e.toLowerCase()===t.name?.toLowerCase()))}function Okt(t,e){return e?.some((e=>!(!fkt(e)||!Okt(t,e.columns))||e.fieldName===t))??!1}const Rkt=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function Lkt(t,e){if("string"!=typeof e||!e)return e;const i=Rkt.find((t=>t.pattern.test(e)));if(!i)return e;const n=e.match(i.pattern),s=n?.[2],r=Mt(Mt(i.label,{messages:t,hierPart:s}),{appName:i.appName}),o=i.target?` target="${i.target}"`:"",a="_blank"===i.target?' rel="noreferrer"':"";return e.replace(i.pattern,`<a${o} href="$1"${a}>${r}</a>`)}let Nkt=class extends Tm.EventedAccessor{constructor(t){super(t),this._menuIsOpen=!1,this.autoWidth=!1,this.cellValueFormatFunction=({root:t,rowData:e,value:i})=>{const{formatFunction:n}=this,s=ux.sanitize(i);if(n&&e){const{index:i,item:{attachments:r,feature:o,relatedRecords:a}}=e;return n({attachments:r,column:this,feature:o,index:i,relatedRecords:a,value:s,virtualIndex:this.getVirtualRowIndex(t)})}return s},this.description=null,this.direction=null,this.fieldName=null,this.flexGrow=1,this.footerRenderFunction=null,this.formatFunction=null,this.frozen=!1,this.frozenToEnd=!1,this.grid=null,this.headerRenderFunction=t=>{const{root:e}=t,i=this.createHeaderContent();this.removeCellContent(e),e.appendChild(i)},this.hidden=!1,this.icon=null,this.initialSortPriority=null,this.label=null,this.menuConfig=null,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.renderFunction=({root:t,rowData:e})=>{const i=this.getCellValue(e),n=this.cellValueFormatFunction({root:t,rowData:e,value:i});let s=null;if(s=n instanceof HTMLElement?n:Lkt(this.messagesURIUtils,n),this.removeCellContent(t),s instanceof HTMLElement)t.removeAttribute("title"),t.appendChild(s);else if(null!=s){const e=s.toString();t.innerHTML=e,t.title=e}},this.resizable=!0,this.sortable=!1,this.store=null,this.tableTimeZone=null,this.textAlign="start",this.textWrap=!1,this.timeZone=null,this.visibleElements=null,this.width=200}initialize(){const{fieldName:t}=this;this._set("sortElement",this.createSortElement()),this.sortElement.setAttribute("path",t),this.addHandles([ey((()=>this.direction),(t=>{const{sortElement:e}=this;this.sortable&&e&&(t?this.sortElement.direction!==t&&e.setAttribute("direction",t):e.removeAttribute("direction"))})),iy((()=>this.grid?.isReady&&this.sortElement),(()=>{const{direction:t,grid:e,hidden:i,sortElement:n}=this;i&&t&&n&&e&&!e.hasSorter(n)&&e.addSorter(n)}),dy),ey((()=>this.timeZone),(()=>this.grid?.requestContentUpdate())),ey((()=>this.hidden),(()=>this.closeMenu())),ey((()=>this.fieldName),(t=>{const{sortElement:e}=this;e&&e.path!==t&&e.setAttribute("path",t)})),ey((()=>this.effectiveLabel),(t=>{const{sortElement:e}=this;e&&e.textContent!==t&&(e.setAttribute("title",t),e.textContent=t)}))])}get _headerRequiresTextContainer(){return!(!this.sortable&&""===this.effectiveLabel&&null==this.effectiveDescription)}get customMenuItems(){return this.menuConfig?.items?.map((({disabled:t,hidden:e,icon:i,iconClass:n,label:s,selected:r,clickFunction:o})=>this.createCalciteDropdownItem({disabled:t,hidden:e,iconClass:n,iconStart:i,selected:r,textContent:s,onclick:t=>o(t)})))??[]}get defaultMenuItems(){if(!this.sortable)return[];const t=this.messages,e=[],i=this.visibleElements?.columnMenuItems;if(!1!==i?.sortAscending){const i=this.createCalciteDropdownItem({iconStart:"sort-ascending-arrow",textContent:t?.sortAsc,onclick:()=>this.direction="asc"});e.push(i)}if(!1!==i?.sortDescending){const i=this.createCalciteDropdownItem({iconStart:"sort-descending-arrow",textContent:t?.sortDesc,onclick:()=>this.direction="desc"});e.push(i)}return e}get effectiveDescription(){const{description:t}=this;return kkt(t)?null:ux.sanitize(t)}get effectiveLabel(){return ux.sanitize(this.label||this.fieldName)}get iconNode(){const{icon:t}=this;return t?this.createCalciteIcon({icon:t}):null}set invalid(t){this._set("invalid",t),this.grid?.generateCellPartNames()}get invalid(){return this._get("invalid")??!1}get menu(){const{customMenuItems:t,defaultMenuItems:e,menuConfig:i}=this,n=!!i?.open,s=this.createCalciteAction({icon:i?.icon??"ellipsis",text:this.messages?.menu??"",slot:"trigger"}),r=document.createElement("calcite-dropdown");if(r.maxItems=i?.maxItems??4,r.placement="top-end",r.overlayPositioning="fixed",r.scale=i?.scale??"m",n&&(r.open=n,this._menuIsOpen=!0),r.appendChild(s),r.addEventListener("calciteDropdownOpen",(()=>this._menuIsOpen=!0)),r.addEventListener("calciteDropdownClose",(()=>this._menuIsOpen=!1)),r.onkeydown=this._stopPropagationOnSelect,r.addEventListener("mousewheel",(t=>{t.stopPropagation()})),e.length){const t=r.appendChild(document.createElement("calcite-dropdown-group"));t.selectionMode="none",t.append(...e)}if(t.length){const e=r.appendChild(document.createElement("calcite-dropdown-group"));e.selectionMode=i?.selectionMode??"none",e.append(...t)}return r}get menuItems(){return[...this.defaultMenuItems,...this.customMenuItems]}get menuIsOpen(){return this._menuIsOpen}get menuIsVisible(){return!(!1===this.visibleElements?.columnMenus||!this.menuItems.length)}closeMenu(){this.menu.open=!1}createSortElement(){const{effectiveLabel:t,direction:e,fieldName:i,initialSortPriority:n}=this,s=document.createElement("vaadin-grid-sorter");return s.classList.add(ckt.sorter),s.setAttribute("path",i),s.setAttribute("title",t),s.textContent=t,e&&s.setAttribute("direction",e),null!=n&&(s._initialOrder=n),s.addEventListener("direction-changed",(()=>{this.direction!==s.direction&&this._set("direction",s.direction)})),s}createCalciteAction(t){const e=document.createElement("calcite-action"),{alignment:i,appearance:n,className:s,disabled:r,icon:o,label:a,scale:l,slot:u,text:c,textEnabled:h,onclick:d}=t;return e.alignment=i??"center",e.appearance=n??"transparent",e.className=s??"",e.disabled=!!r,e.icon=o??"",e.label=a??"",e.scale=l??"s",e.slot=u??"",e.text=e.title=c??"",e.textEnabled=!!h,e.onclick=d??null,e}createCalciteButton(t){const e=document.createElement("calcite-button"),{alignment:i,appearance:n,className:s,disabled:r,iconEnd:o,iconFlipRtl:a,kind:l,loading:u,onclick:c,scale:h,textContent:d,title:f,width:p}=t;return e.alignment=i??"center",e.className=s??"",e.scale=h??"s",e.appearance=n??"transparent",e.disabled=!!r,e.iconEnd=o??"",a&&(e.iconFlipRtl=a),e.kind=l??"brand",e.loading=!!u,e.textContent=d??"",f&&(e.title=f),e.width=p??"auto",e.onclick=c??null,e}createCalciteDropdownItem(t){const e=document.createElement("calcite-dropdown-item"),{disabled:i,hidden:n,iconClass:s,iconStart:r,textContent:o,onclick:a,selected:l}=t,u=o??"";if(s&&!r){const t=document.createElement("span"),i=document.createElement("span");i.classList.add(ckt.headerMenuIcon,s),t.textContent=t.title=u,t.insertBefore(i,t.firstChild),e.appendChild(t)}else e.iconStart=r??"",e.textContent=e.title=u;return e.disabled=!!i,e.hidden="function"==typeof n?n():!!n,e.selected=!!l,a&&(e.addEventListener("calciteDropdownItemSelect",a),e.onkeydown=this._stopPropagationOnSelect),e}createCalciteIcon(t){const{effectiveLabel:e}=this,{icon:i,scale:n,textLabel:s}=t,r=document.createElement("calcite-icon"),o=s??e;return r.icon=i,r.scale=n??"s",r.textLabel=o,r.title=o,r}createHeaderContent(){const{effectiveDescription:t,effectiveLabel:e,iconNode:i}=this,n=document.createElement("div");if(n.classList.add(ckt.headerContent),i&&n.appendChild(i),!this._headerRequiresTextContainer)return n;const s=n.appendChild(document.createElement("div"));return this.sortable?s.appendChild(this.sortElement):""!==e&&s.appendChild(this._createHeaderTextElement(e,ckt.headerLabel)),null!=t&&!1!==this.visibleElements?.columnDescriptions&&s.appendChild(this._createHeaderTextElement(t,ckt.headerDescription)),this.menuIsVisible&&n.appendChild(this.menu),n}getCellValue(t){return t?.item.feature.attributes?.[this.fieldName]}getVirtualRowIndex(t){const e=this.grid?.getRowContainingNode(t);return e?.parentElement?[...e.parentElement.children].indexOf(e):-1}removeCellContent(t){if(t&&t.firstChild)try{for(;t?.firstChild;)t?.removeChild(t.firstChild)}catch(t){}}openMenu(){this.menuIsVisible&&(this.menu.open=!0,hx(this.menuItems[0]))}sort(){this.sortable&&this.sortElement?.click()}_stopPropagationOnSelect(t){"Enter"!==t.key&&" "!==t.key||t.stopPropagation()}_createHeaderTextElement(t,e){const i=document.createElement("span"),n=t??"";i.classList.add(e);const s=i.appendChild(document.createElement("span"));return s.textContent=n,s.setAttribute("title",n),i}};r([Je()],Nkt.prototype,"_headerRequiresTextContainer",null),r([Je()],Nkt.prototype,"_menuIsOpen",void 0),r([Je()],Nkt.prototype,"autoWidth",void 0),r([Je()],Nkt.prototype,"cellValueFormatFunction",void 0),r([Je()],Nkt.prototype,"customMenuItems",null),r([Je()],Nkt.prototype,"defaultMenuItems",null),r([Je()],Nkt.prototype,"description",void 0),r([Je()],Nkt.prototype,"direction",void 0),r([Je()],Nkt.prototype,"effectiveDescription",null),r([Je()],Nkt.prototype,"effectiveLabel",null),r([Je({constructOnly:!0})],Nkt.prototype,"fieldName",void 0),r([Je()],Nkt.prototype,"flexGrow",void 0),r([Je()],Nkt.prototype,"footerRenderFunction",void 0),r([Je()],Nkt.prototype,"formatFunction",void 0),r([Je()],Nkt.prototype,"frozen",void 0),r([Je()],Nkt.prototype,"frozenToEnd",void 0),r([Je()],Nkt.prototype,"grid",void 0),r([Je()],Nkt.prototype,"iconNode",null),r([Je()],Nkt.prototype,"invalid",null),r([Je()],Nkt.prototype,"headerRenderFunction",void 0),r([Je()],Nkt.prototype,"hidden",void 0),r([Je()],Nkt.prototype,"icon",void 0),r([Je({constructOnly:!0})],Nkt.prototype,"initialSortPriority",void 0),r([Je()],Nkt.prototype,"label",void 0),r([Je()],Nkt.prototype,"menu",null),r([Je()],Nkt.prototype,"menuItems",null),r([Je()],Nkt.prototype,"menuConfig",void 0),r([Je()],Nkt.prototype,"menuIsOpen",null),r([Je()],Nkt.prototype,"menuIsVisible",null),r([Je()],Nkt.prototype,"messages",void 0),r([Je()],Nkt.prototype,"messagesCommon",void 0),r([Je()],Nkt.prototype,"messagesURIUtils",void 0),r([Je()],Nkt.prototype,"renderFunction",void 0),r([Je()],Nkt.prototype,"resizable",void 0),r([Je()],Nkt.prototype,"sortable",void 0),r([Je({readOnly:!0})],Nkt.prototype,"sortElement",void 0),r([Je()],Nkt.prototype,"store",void 0),r([Je()],Nkt.prototype,"tableTimeZone",void 0),r([Je()],Nkt.prototype,"textAlign",void 0),r([Je()],Nkt.prototype,"textWrap",void 0),r([Je()],Nkt.prototype,"timeZone",void 0),r([Je()],Nkt.prototype,"visibleElements",void 0),r([Je()],Nkt.prototype,"width",void 0),Nkt=r([ln("esri.widgets.FeatureTable.Grid.Column")],Nkt);const Pkt=Nkt;const Fkt={action:"esri-column__action"};let Dkt=class extends Pkt{constructor(t){super(t),this.autoWidth=!1,this.callback=()=>{},this.fieldName=ykt.action,this.flexGrow=0,this.frozenToEnd=!0,this.disabled=null,this.headerRenderFunction=()=>{},this.icon="pencil",this.renderFunction=({root:t,rowData:e})=>{if(!e)return;const{index:i,item:{feature:n}}=e,{callback:s,disabled:r,icon:o,effectiveLabel:a}=this,l=r instanceof Function?r({feature:n,index:i}):!!r,u=t=>{t.stopPropagation(),s({index:i,feature:n,native:t})};if(t.firstChild){const e=t.firstChild;return e.disabled=l,e.icon=o,e.text=a,void(e.onclick=u)}const c=this.createCalciteAction({alignment:"center",className:`${Fkt.action} ${ckt.contentFull}`,disabled:l,icon:o,text:a,onclick:u});this.removeCellContent(t),t.appendChild(c)},this.resizable=!1,this.sortable=!1,this.width="50px"}};r([Je({readOnly:!0})],Dkt.prototype,"autoWidth",void 0),r([Je()],Dkt.prototype,"callback",void 0),r([Je({readOnly:!0})],Dkt.prototype,"fieldName",void 0),r([Je({readOnly:!0})],Dkt.prototype,"flexGrow",void 0),r([Je()],Dkt.prototype,"frozenToEnd",void 0),r([Je()],Dkt.prototype,"disabled",void 0),r([Je()],Dkt.prototype,"headerRenderFunction",void 0),r([Je()],Dkt.prototype,"icon",void 0),r([Je()],Dkt.prototype,"renderFunction",void 0),r([Je({readOnly:!0})],Dkt.prototype,"resizable",void 0),r([Je({readOnly:!0})],Dkt.prototype,"sortable",void 0),r([Je({readOnly:!0})],Dkt.prototype,"width",void 0),Dkt=r([ln("esri.widgets.FeatureTable.ActionColumn")],Dkt);const $kt=Dkt;const zkt="esri-attachments-column",Ukt={contentContainer:`${zkt}__content`,showAttachmentsButton:`${zkt}__button`};let Bkt=class extends Pkt{constructor(t){super(t),this._buttonElements=new VD,this._thumbnailElements=new VD,this.attachmentsViewEnabled=!0,this.cellValueFormatFunction=({root:t,rowData:e})=>{const{_showAttachmentsViewEnabled:i,formatFunction:n}=this,s=this.getCellValue(e);if(n&&e){const{index:i,item:{attachments:r,feature:o,relatedRecords:a}}=e;return n({attachments:r,column:this,feature:o,index:i,relatedRecords:a,value:s,virtualIndex:this.getVirtualRowIndex(t)})}if(!e)return s;const{index:r,item:{attachments:o,objectId:a}}=e,l=`(${s})`;if(!this.thumbnailsEnabled&&!i)return s;const u=document.createElement("span");u.textContent=u.title=l;let c=null;if(this.thumbnailsEnabled&&(c=this._createOrSyncThumbnails(a,o??[])),this._showAttachmentsViewEnabled){const t=document.createElement("div");c&&t.appendChild(c),t.appendChild(u);const e=this._createOrSyncShowAttachmentsButton(a,r);return e.appendChild(t),e}const h=document.createElement("div");return h.classList.add(Ukt.contentContainer),c&&h.appendChild(c),h.appendChild(u),h},this.icon="attachment",this.layer=null,this.onShowAttachments=null,this.sortable=!1,this.store=null,this.textAlign="center",this.thumbnailAppearance="image",this.thumbnailCount=8,this.thumbnailIconScale="m",this.thumbnailsEnabled=!0}get _showAttachmentsViewEnabled(){return!(!this.attachmentsViewEnabled||!this.onShowAttachments)}get _supportsResize(){return!!this.store?.supportsResizeAttachments}get effectiveLabel(){return ux.sanitize(this.label??(this.messages?.attachments||this.fieldName))}getCellValue(t){return t?.item?.attachments?.length??0}_createOrSyncThumbnails(t,e){const i=document.createElement("div"),n=this._thumbnailElements.get(t);return n?.length&&n.length===e.length?n.forEach((t=>i.appendChild(t))):this._thumbnailElements.set(t,this._createThumbnailElements(e,i)),i}_createOrSyncShowAttachmentsButton(t,e){const i=this._buttonElements.get(t);if(i)return i.textContent="",i.onclick=i=>this._onShowAttachmentsClick({index:e,objectId:t,event:i}),i;const n=this.createCalciteButton({alignment:"icon-end-space-between",className:`${Ukt.showAttachmentsButton} ${ckt.contentFull}`,iconEnd:"chevron-right",iconFlipRtl:"both",scale:this.thumbnailIconScale,textContent:"",title:this.messages?.viewAttachments,width:"full",onclick:i=>this._onShowAttachmentsClick({index:e,objectId:t,event:i})});return this._buttonElements.set(t,n),n}_createThumbnailAnchor({name:t,url:e},i){const n=document.createElement("a");return n.href=`${e}`,n.download=t,n.rel="noreferrer",n.target="_blank",n.appendChild(i),n}_createThumbnailElements(t,e){const{thumbnailAppearance:i,thumbnailCount:n,thumbnailIconScale:s}=this,r=[],o=Math.min(n,t.length),a=!this.onShowAttachments,l="image"===i;for(let i=0;i<o;i++){const n=t[i],{name:o,contentType:u}=n,c=QIt(u)&&l?this._createThumbnailImage(n):this.createCalciteIcon({icon:tkt(u),scale:s,textLabel:o}),h=a?this._createThumbnailAnchor(n,c):c;e&&e.appendChild(h),r.push(h)}return r}_createThumbnailImage(t){const{name:e,size:i,url:n}=t,s=document.createElement("img"),r=`${n}${n?.includes("?")?"&":"?"}${this._supportsResize?"w=24":""}&fs=${i}`;return s.alt=this.messages?.attachmentThumbnail??e,s.src=r,s.title=e,s}_onShowAttachmentsClick({index:t,objectId:e,event:i}){i.preventDefault(),i.stopPropagation(),this.onShowAttachments?.({index:t,objectId:e})}};r([Je()],Bkt.prototype,"_showAttachmentsViewEnabled",null),r([Je()],Bkt.prototype,"_buttonElements",void 0),r([Je()],Bkt.prototype,"_supportsResize",null),r([Je()],Bkt.prototype,"_thumbnailElements",void 0),r([Je()],Bkt.prototype,"attachmentsViewEnabled",void 0),r([Je()],Bkt.prototype,"cellValueFormatFunction",void 0),r([Je()],Bkt.prototype,"effectiveLabel",null),r([Je()],Bkt.prototype,"icon",void 0),r([Je()],Bkt.prototype,"layer",void 0),r([Je()],Bkt.prototype,"onShowAttachments",void 0),r([Je({readOnly:!0})],Bkt.prototype,"sortable",void 0),r([Je()],Bkt.prototype,"store",void 0),r([Je()],Bkt.prototype,"textAlign",void 0),r([Je()],Bkt.prototype,"thumbnailAppearance",void 0),r([Je()],Bkt.prototype,"thumbnailCount",void 0),r([Je()],Bkt.prototype,"thumbnailIconScale",void 0),r([Je()],Bkt.prototype,"thumbnailsEnabled",void 0),Bkt=r([ln("esri.widgets.FeatureTable.AttachmentsColumn")],Bkt);const Gkt=Bkt;const Vkt="esri.widgets.Feature.support.featureUtils",qkt=()=>jt.getLogger(Vkt),Hkt=/href=(""|'')/gi,Wkt=/(\{([^{\r\n]+)\})/g,Zkt=/'/g,Jkt=/^\s*expression\//i,Ykt=/(\n)/gi,Kkt=/[\u00A0-\u9999<>&]/gim,Qkt=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,Xkt=/^(?:mailto:|tel:)/,tCt="relationships/",eCt=Dg("short-date-short-time");function iCt(t){if(null!=t)return(t.sourceLayer||t.layer)??void 0}async function nCt({type:t,value:e,event:i}){try{return"function"==typeof e?e(i):await e}catch(n){return void qkt().error("error",`An error occurred when calling the "${t}" function`,{error:n,graphic:i.graphic,value:e})}}function sCt(t=""){if(t)return!Xkt.test(t.trim().toLowerCase())}function rCt(t){return!!t&&Jkt.test(t)}function oCt(t,e){if(!e||!rCt(e)||!t)return;const i=e.replace(Jkt,"").toLowerCase();return t.find((({name:t})=>t.toLowerCase()===i))}function aCt(t,e){const i=oCt(e,t?.fieldName);return i?i.title||null:t?t.label||t.fieldName:null}function lCt(t,e){const i=e.get(t.toLowerCase());return`{${i?.fieldName||t}}`}function uCt(t){return t.replaceAll(Hkt,"")}function cCt(t,e){const i=dCt(e,t);return i?i.name:t}function hCt(t,e){return t&&t.map((t=>cCt(t,e)))}function dCt(t,e){return t&&"function"==typeof t.getField&&e?t.getField(e)??null:null}function fCt(t){return`${t}`.trim()}function pCt({attributes:t,globalAttributes:e,layer:i,text:n,expressionAttributes:s,fieldInfoMap:r}){return n?mCt({formattedAttributes:e,template:bCt(n,{...e,...s,...t},i),fieldInfoMap:r}):""}function mCt({formattedAttributes:t,template:e,fieldInfoMap:i}){return fCt(uCt(Mt(Mt(e,(t=>lCt(t,i))),t)))}function yCt(t,e,i=!1){const n=e[t];if("string"==typeof n){const s="%27",r=(i?encodeURIComponent(n):n).replaceAll(Zkt,s);e[t]=r}}function gCt(t,e=!1){const i={...t};return Object.keys(i).forEach((t=>yCt(t,i,e))),i}function vCt(t,e,i){const n=(e=fCt(e))&&"{"!==e[0];return Mt(t,gCt(i,n||!1))}function wCt(t,e){return t.replaceAll(Wkt,((t,i,n)=>{const s=dCt(e,n);return s?`{${s.name}}`:i}))}function bCt(t,e,i){const n=wCt(t,i);return n?n.replaceAll(Qkt,((t,i,n)=>vCt(t,i||n,e))):n}function SCt(t,e){if("string"==typeof t&&e&&null==e.dateFormat&&(null!=e.places||null!=e.digitSeparator)){const e=Number(t);if(!isNaN(e))return e}return t}function _Ct(t){return null!=t&&"object"==typeof t&&"fieldsIndex"in t&&"geometryType"in t&&"getField"in t&&"load"in t&&"loaded"in t&&"objectIdField"in t&&"spatialReference"in t&&"type"in t&&("feature"===t.type||"scene"===t.type||"subtype-sublayer"===t.type||"sublayer"===t.type)&&"when"in t}function xCt(t){return null!=t&&"object"==typeof t&&"createQuery"in t&&"queryFeatureCount"in t&&"queryObjectIds"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t&&"relationships"in t}function MCt(t){return!!(t&&"object"==typeof t&&"createQuery"in t&&"queryFeatureCount"in t&&"type"in t)&&("subtype-sublayer"===t.type&&"parent"in t&&t.parent&&"object"==typeof t.parent?"globalIdField"in t.parent:"globalIdField"in t)}function TCt(t){return _Ct(t)&&xCt(t)}function ACt(t){return _Ct(t)&&MCt(t)}function ICt(t,e){const{fieldInfos:i,fieldName:n,preventPlacesFormatting:s,layer:r,timeZone:o}=e,a=ECt(i,n),l=dCt(r,n);if(a&&!hO(n)){const e=l?.type,i=a.format?.dateFormat;if("date"===e||"date-only"===e||"time-only"===e||"timestamp-offset"===e||i)return CMt(t,{format:i,fieldType:e,timeZoneOptions:{layerTimeZone:r&&"preferredTimeZone"in r?r.preferredTimeZone:null,viewTimeZone:o,datesInUnknownTimezone:!(!r||!("datesInUnknownTimezone"in r))&&!!r.datesInUnknownTimezone}})}const u=a?.format;return"string"==typeof t&&hO(n)&&u?kCt(t,u):"string"==typeof(t=SCt(t,u))||null==t||null==u?FCt(t):Jg(t,s?{...Zg(u),minimumFractionDigits:0,maximumFractionDigits:20}:Zg(u))}function kCt(t,e){return t=t.trim(),/\d{2}-\d{2}/.test(t)?t:t.includes(",")?CCt(t,",",", ",e):t.includes(";")?CCt(t,";","; ",e):t.includes(" ")?CCt(t," "," ",e):Jg(Number(t),Zg(e))}function CCt(t,e,i,n){return t.trim().split(e).map((t=>Jg(Number(t),Zg(n)))).join(i)}function ECt(t,e){if(t?.length&&e)return t.find((t=>t.fieldName?.toLowerCase()===e.toLowerCase()))}function jCt({fieldName:t,graphic:e,layer:i}){if(GCt(t))return null;if(!i||"function"!=typeof i.getFeatureType)return null;const{typeIdField:n}=i;if(!n||t!==n)return null;const s=i.getFeatureType(e);return s?s.name:null}function OCt({fieldName:t,value:e,graphic:i,layer:n}){if(GCt(t))return null;if(!n||"function"!=typeof n.getFieldDomain)return null;const s=i&&n.getFieldDomain(t,{feature:i,excludeImpliedDomains:u("esri-widget-legacy-field-domain-calculation")});return s&&"coded-value"===s.type?s.getName(e):null}function RCt(t,e,i,n){const{creatorField:s,creationDateField:r,editorField:o,editDateField:a}=t;if(!e)return;const l=vg(n&&"preferredTimeZone"in n?n.preferredTimeZone:null,!(!n||!("datesInUnknownTimezone"in n))&&!!n.datesInUnknownTimezone,i,eCt,"date"),u={...eCt,...l},c=e[a];if("number"==typeof c){const t=e[o];return{type:"edit",date:$g(c,u),user:t}}const h=e[r];if("number"==typeof h){const t=e[s];return{type:"create",date:$g(h,u),user:t}}return null}function LCt(t,e){const i=new Map;if(!t)return i;for(const n of t){if(!n.fieldName)continue;const t=cCt(n.fieldName,e);n.fieldName=t,i.set(t.toLowerCase(),n)}return i}function NCt(t){const e=[];if(!t)return e;const{fieldInfos:i,content:n}=t;return i&&e.push(...i),n&&Array.isArray(n)?(n.forEach((t=>{if("fields"===t.type){const i=t?.fieldInfos;i&&e.push(...i)}})),e):e}function PCt(t){return t.replaceAll(Kkt,(t=>`&#${t.charCodeAt(0)};`))}function FCt(t){return"string"==typeof t?t.replaceAll(Ykt,'<br class="esri-text-new-line" />'):t}function DCt(t){const{value:e,fieldName:i,fieldInfos:n,fieldInfoMap:s,layer:r,graphic:o,timeZone:a}=t;if(null==e)return"";const l=OCt({fieldName:i,value:e,graphic:o,layer:r});if(l)return l;const u=jCt({fieldName:i,graphic:o,layer:r});if(u)return u;if(s.get(i.toLowerCase()))return ICt(e,{fieldInfos:n||Array.from(s.values()),fieldName:i,layer:r,timeZone:a});const c=r?.fieldsIndex?.get(i);return c&&(kMt(c)||Hj(c))?CMt(e,{fieldType:c.type,timeZoneOptions:{layerTimeZone:r&&"preferredTimeZone"in r?r.preferredTimeZone:null,viewTimeZone:a,datesInUnknownTimezone:!(!r||!("datesInUnknownTimezone"in r))&&!!r.datesInUnknownTimezone}}):FCt(e)}function $Ct({fieldInfos:t,attributes:e,layer:i,graphic:n,fieldInfoMap:s,relatedInfos:r,timeZone:o}){const a={};return r?.forEach((e=>HCt({attributes:a,relatedInfo:e,fieldInfoMap:s,fieldInfos:t,layer:i,timeZone:o}))),e&&Object.keys(e).forEach((r=>{const l=e[r];a[r]=DCt({fieldName:r,fieldInfos:t,fieldInfoMap:s,layer:i,value:l,graphic:n,timeZone:o})})),a}async function zCt(t,e){const{layer:i,graphic:n,outFields:s,objectIds:r,returnGeometry:o,spatialReference:a}=t,l=r[0];if("number"!=typeof l&&"string"!=typeof l){const t="Could not query required fields for the specified feature. The feature's ID is invalid.",e={layer:i,graphic:n,objectId:l,requiredFields:s};return qkt().warn(t,e),null}if(!nA(i)?.operations?.supportsQuery){const t="The specified layer cannot be queried. The following fields will not be available.",e={layer:i,graphic:n,requiredFields:s,returnGeometry:o};return qkt().warn(t,e),null}const u=i.createQuery();u.objectIds=r,u.outFields=s?.length?s:[i.objectIdField],u.returnGeometry=!!o,u.returnZ=!!o,u.returnM=!!o,u.outSpatialReference=a;return(await i.queryFeatures(u,e)).features[0]}async function UCt(t){if(!t.expressionInfos?.length)return!1;const e=await PE(),{arcadeUtils:{hasGeometryFunctions:i}}=e;return i(t)}async function BCt({graphic:t,popupTemplate:e,layer:i,spatialReference:n},s){if(!i||!e)return;if("function"==typeof i.load&&await i.load(s),!t.attributes)return;const r=i.objectIdField,o=t.attributes[r];if(null==o)return;const a=[o],l=await e.getRequiredFields(i.fieldsIndex),u=uO(l,t),c=u?[]:l.includes(r)?l:[...l,r],h=e.returnGeometry||await UCt(e);if(u&&!h)return;const d=await zCt({layer:i,graphic:t,outFields:c,objectIds:a,returnGeometry:h,spatialReference:n},s);d&&(d.geometry&&(t.geometry=d.geometry),d.attributes&&(t.attributes={...t.attributes,...d.attributes}))}function GCt(t=""){return!!t&&t.includes(tCt)}function VCt(t){return t?`${tCt}${t.layerId}/${t.fieldName}`:""}function qCt({attributes:t,graphic:e,relatedInfo:i,fieldInfos:n,fieldInfoMap:s,layer:r,timeZone:o}){t&&e&&i&&Object.keys(e.attributes).forEach((a=>{const l=VCt({layerId:i.relation.id.toString(),fieldName:a}),u=e.attributes[a];t[l]=DCt({fieldName:l,fieldInfos:n,fieldInfoMap:s,layer:r,value:u,graphic:e,timeZone:o})}))}function HCt({attributes:t,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:s,timeZone:r}){t&&e&&(e.relatedFeatures?.forEach((o=>qCt({attributes:t,graphic:o,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:s,timeZone:r}))),e.relatedStatsFeatures?.forEach((o=>qCt({attributes:t,graphic:o,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:s,timeZone:r}))))}const WCt=t=>{if(!t)return!1;const e=t.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},ZCt=({layer:t,method:e,query:i,definitionExpression:n})=>{if(!t.capabilities?.query?.supportsCacheHint||"attachments"===e)return;const s=null!=i.where?i.where:null,r=null!=i.geometry?i.geometry:null;WCt(n)||WCt(s)||"extent"===r?.type||"tile"===i.resultType||(i.cacheHint=!0)},JCt=({query:t,layer:e,method:i})=>{ZCt({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression??""}`})},YCt=({queryPayload:t,layer:e,method:i})=>{ZCt({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression??""}`})};function KCt(t,e,i){return t&&e&&i?"sublayer"===e.type?tEt({layers:e.layer?.sublayers,map:t,relatedLayer:e,relationship:i})||tEt({layers:e.layer?.subtables,map:t,relatedLayer:e,relationship:i}):tEt({layers:t.allLayers,map:t,relatedLayer:e,relationship:i})||tEt({layers:t.allTables,map:t,relatedLayer:e,relationship:i}):null}function QCt(t,e){return t&&"utilityNetworks"in t&&e?t.utilityNetworks?.find((t=>t.isUtilityLayer(e))):null}function XCt(t,e){return t?.allTables.find((t=>"feature"===t.type&&t.layerId===e.id&&t.url===e.layer?.url))}function tEt({map:t,relationship:e,relationship:{relatedTableId:i},relatedLayer:n,layers:s}){if(!s)return null;for(const r of s){if("map-image"===r.type){const i=tEt({layers:r.sublayers,map:t,relatedLayer:n,relationship:e})||tEt({layers:r.subtables,map:t,relatedLayer:n,relationship:e});if(i)return i;continue}if(!TCt(r))continue;if("sublayer"===n.type){if(r!==n&&r.id===i)return r.isTable?XCt(t,r):r;continue}const s="scene"===n.type&&n.associatedLayer?n.associatedLayer.url:n.url;if(!s)return null;if("sublayer"!==r.type){if(r!==n&&r.url===s&&r.layerId===i)return r}else if(r!==n&&r.layer?.url===s&&r.id===i)return r.isTable?XCt(t,r):r}return null}const eEt=t=>null!=t&&(iEt(t,"combo-box")||iEt(t,"radio-buttons")),iEt=(t,e)=>null!=t&&t.input?.type===e,nEt=t=>null!=t&&(iEt(t,"text-box")||iEt(t,"text-area"));function sEt(t){const{attributes:e,fieldsIndex:i,label:n,timeZone:s}=t;if(!e||"object"!=typeof e)return n;const r=Object.keys(e).filter((t=>Ct(n,t))),o=r.map((t=>e[t])),a=r.map((t=>i.get(t))).filter(C);return oEt(n,rEt({values:o,fields:a,timeZone:s}))}function rEt(t){const{fields:e,values:i}=t,n=t.timeZone??void 0,s=e.map(((t,e)=>{let s=i[e];if(t.domain&&"coded-value"===t.domain.type){const e=t.domain.codedValues.find((t=>t.code===s));e?.name&&(s=e.name)}return(kMt(t)||Hj(t))&&(s=dE(t,s,{timeZone:n,...hE(t)})),[t.name,s]}));return Object.fromEntries(s)}function oEt(t,e){return Mt(Mt(t,(t=>`{${t.toLowerCase()}}`)),Object.fromEntries(Object.entries(e).map((([t,e])=>[t.toLowerCase(),e]))))}var aEt;!function(t){t.TOO_SHORT="length-validation-error::too-short",t.TOO_LONG="length-validation-error::too-long"}(aEt||(aEt={}));const lEt=t=>{const e=[];if(t.formTemplate){const{description:i,title:n}=t.formTemplate;t.fields?.forEach((t=>{const s=n&&Ct(n,t.name),r=i&&Ct(i,t.name);(s||r)&&e.push(t.name)}))}return e};function uEt(t,e){return null==t||e.onValue!==t&&e.offValue!==t}let cEt=class extends ao{constructor(t){super(t),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){return this.getFormattedLabel(this.element?.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get label(){return this.getFormattedLabel(this.element?.label)}get updating(){return!1}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}getFormattedLabel(t){const{feature:e,layer:i,timeZone:n}=this;return null==i||null==t?t:sEt({label:t,attributes:e.attributes,fieldsIndex:i.fieldsIndex,timeZone:n})}};r([Je({readOnly:!0})],cEt.prototype,"description",null),r([Je({constructOnly:!0})],cEt.prototype,"element",void 0),r([Je()],cEt.prototype,"evaluatedVisibilityExpression",null),r([Je()],cEt.prototype,"feature",void 0),r([Je()],cEt.prototype,"label",null),r([Je()],cEt.prototype,"layer",void 0),r([Je()],cEt.prototype,"timeZone",void 0),r([Je()],cEt.prototype,"type",void 0),r([Je()],cEt.prototype,"updating",null),r([Je()],cEt.prototype,"visible",null),r([Je()],cEt.prototype,"visibilityExpressionExecutor",void 0),cEt=r([ln("esri.widgets.FeatureForm.InputBase")],cEt);const hEt=cEt;var dEt;!function(t){t.Text="text",t.Number="number",t.Date="date",t.Unsupported="unsupported"}(dEt||(dEt={}));const fEt=(t,e)=>{if(!t)return!0;const{operations:i}=t;switch(e){case"INSERT":return i.supportsAdd;case"UPDATE":case"DELETE":return i.supportsUpdate;default:return!0}};let pEt=class extends hEt{constructor(t){super(t),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:t}=this;if(!t)return!1;const e=nA(t),i=e?.operations.supportsEditing,n=fEt(e,this.arcadeEditType);return!(!i||!n)}};r([Je()],pEt.prototype,"arcadeEditType",void 0),r([Je()],pEt.prototype,"editable",null),r([Je()],pEt.prototype,"editableExpressionExecutor",void 0),r([Je()],pEt.prototype,"evaluatedEditableExpression",null),r([Je()],pEt.prototype,"layerAllowsEdits",null),pEt=r([ln("esri.widgets.FeatureForm.EditableInput")],pEt);const mEt=pEt;let yEt=class extends mEt{constructor(t){super(t),this._storedValue=null,this.error=null,this.preservesValueWhenHidden=!0,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this._fieldInputWasVisibleDuringLifetime=!1,this.valueExpressionExecutor=null}initialize(){this.addHandles(ey((()=>this.feature),(()=>this._fieldInputWasVisibleDuringLifetime=!1),hy))}get _dateFormRange(){const{element:t,field:e}=this;if("date"!==this.dataType)return{};const i=t?.domain?OE(e,t.domain):null;if(!t?.input)return i??{};const n=t.input,{type:s}=n;let r={};if("date-picker"!==s&&"time-picker"!==s&&"datetimeoffset-picker"!==s||(r=RE(e,n.max,n.min)),"datetime-picker"===s){const{max:t,min:e}=n;r={max:null!=t&&gEt(t)?t.getTime():null,min:null!=e&&gEt(e)?e.getTime():null}}const{max:o,min:a}=r;if(i){const{max:t,min:e}=i,n=JC(t)&&(null==o||null!=o&&t<o),s=JC(e)&&(null==a||null!=a&&e>a);return{max:n?t:o??null,min:s?e:a??null,rawMax:n?i.rawMax:r?.rawMax??null,rawMin:s?i.rawMin:r?.rawMin??null}}return{min:a,max:o,rawMax:r?.rawMax??null,rawMin:r?.rawMin??null}}get _dateRange(){const{_dateFormRange:t,field:e}=this;if("date"!==this.dataType)return{};const i=OE(e);if(!i)return t;const{max:n,min:s,rawMax:r,rawMin:o}=t;if("date"===e.type){const{max:t,min:e}=i;return{max:JC(n)&&(null===t||null!=t&&n<t)?n:t??null,min:JC(s)&&(null===e||null!=e&&s>e)?s:e??null}}if("date-only"===e.type||"time-only"===e.type||"timestamp-offset"===e.type){const{max:t,min:e,rawMax:a,rawMin:l}=i,u=JC(n)&&r&&(null==t||n<t);return{max:u?n:t,min:JC(s)&&o&&(null==e||s>e)?s:e,rawMax:u?r:a,rawMin:u?o:l}}return{max:null,min:null}}get _configAllowsEdits(){const{element:t,layer:e,name:i}=this;if(null!=t)return t.editableExpression?!!this.evaluatedEditableExpression:!1!==t.editable;if(e?.userHasUpdateItemPrivileges)return!0;const n=e&&"popupTemplate"in e?e?.popupTemplate?.fieldInfos?.find((({fieldName:t})=>t===i)):null;return n?.isEditable??!0}get _layerAndFieldAllowEdits(){return this.layerAllowsEdits&&this.field?.editable}get _isVisibleByDefault(){const{field:t,layer:e}=this;return!!t?.visible&&Sj(t,e)}get _isEditTrackingField(){return wj(this.layer).includes(this.name?.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&null!=this.valueExpressionExecutor}get isSubtypeField(){const{layer:t}=this;if(t&&"subtypeField"in t){const{subtypeField:e,fieldsIndex:i}=t;return(i.get(e)?.name??e)===this.name}return!1}get valueIsOutOfDomain(){const{domain:t,value:e,field:i}=this;return!(!t||null==e)&&null!==jE(i,e,t)}get dataType(){const{field:t}=this;return Uj(t)?dEt.Number:Bj(t)?dEt.Text:kMt(t)||Hj(t)?dEt.Date:dEt.Unsupported}get dateDataType(){if(this.dataType===dEt.Date)return"date"!==this.field.type?"string":"number"}get domain(){const{layer:t,feature:e,name:i,element:n}=this,s=n?.domain;return null!=s&&this._isDomainCompatible(s)?s:t.getFieldDomain(i,{feature:e})}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:t}=this;return null!=t?t.lastEvaluatedValue:null}get hint(){return this.element?.hint}get includeDate(){return!(this.dataType!==dEt.Date||"time-only"===this.field.type)}get includeTime(){const{element:t,field:e}=this;if(this.dataType!==dEt.Date)return!1;if("time-only"===e.type)return!0;if("date-only"===e.type)return!1;const i="datetime-picker"===t?.input?.type?t.input.includeTime:void 0;return void 0===i||i}get includeTimeOffset(){if("timestamp-offset"!==this.field.type)return!1;const t=this.element?.input;return!t||"datetimeoffset-picker"===t.type&&t.includeTimeOffset}set initialFeature(t){this._set("initialFeature",t),this.notifyChange("valid")}get inputType(){return this.element?.input?.type}get hasInvalidSwitchValue(){const{element:t}=this,e=iEt(t,"switch")?t.input:null;return!e||uEt(this.value,e)}get isRelationshipKeyField(){const{field:t,layer:e}=this;return TCt(e)&&!!e.relationships?.some((e=>e.keyField===t.name))}get label(){const{field:t}=this;return this.getFormattedLabel(this.element?.label)??t.alias??t.name}get maxLength(){const t=-1;if(this.dataType===dEt.Date)return t;const{field:e,element:i}=this,n=e?.length??-1,s=nEt(i)?i.input.maxLength:NaN;return null!=s&&!isNaN(s)&&s>=t&&(n===t||s<=n)?s:n}get minLength(){const t=-1;if(this.dataType===dEt.Date)return t;const{field:e,element:i}=this,n=e?.length??-1,s=nEt(i)?i.input.minLength:NaN;return null!=s&&!isNaN(s)&&s>=t&&(n===t||s<=n)?s:t}get name(){return this.field?.name}get range(){const{domain:t,element:e,field:i}=this;if("date"===this.dataType)return this._dateRange;const n=OE(i,t)||eO(i,t),s=n?.max===Number.MAX_VALUE?null:n?.max??null,r=n?.min===-Number.MAX_VALUE?null:n?.min??null;if(!e?.domain||"range"!==e.domain.type)return{max:s,min:r};const{max:o,min:a}=OE(i)||{};return{max:null!=o&&(null===s||null!=s&&o<s)?o:s,min:null!=a&&(null===r||null!=r&&a>r)?a:r}}get required(){const{editable:t,evaluatedRequiredExpression:e,field:i,visible:n,isSubtypeField:s}=this;if(!t)return!1;if(!1===i?.nullable)return!0;if(s)return!0;return!(!n||!1===this.group?.visible||null==e)&&e}set required(t){this._overrideIfSome("required",t)}get showNoValueOptionEnabled(){const{element:t}=this;return!this.required&&(!eEt(t)||t.input.showNoValueOption)}get showNoValueLabel(){const{element:t}=this;return eEt(t)?t.input.noValueOptionLabel:null}get submittable(){const{field:t,required:e,valid:i,value:n}=this;return(!e||null!=n)&&(!!i||this.initialFeature.getAttribute(t.name)===n)}get timeResolution(){const t=this.element?.input;if(t&&("datetimeoffset-picker"===t.type||"time-picker"===t.type))return t.timeResolution??"minutes"}get timeStep(){return null!=this.timeResolution?XC.get(this.timeResolution):void 0}get updating(){const{editableExpressionExecutor:t,valueExpressionExecutor:e,visibilityExpressionExecutor:i,preservesValueWhenHidden:n}=this;return null!=e&&e.updating||null!=t&&t.updating||!1===n&&null!=i&&i.updating}get valid(){const t=this.editable?this._validate():null;return this._set("error",t),null===t}get value(){if(this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&!1!==this.group?.visible,!1===this.preservesValueWhenHidden&&this._fieldInputWasVisibleDuringLifetime&&(!1===this.visibilityExpressionExecutor?.lastEvaluatedValue||!1===this.group?.visibilityExpressionExecutor?.lastEvaluatedValue))return null!==this._storedValue&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const t=this.evaluatedValueExpression;return this.dataType===dEt.Date?this._arcadeOutputToDateFieldValue(t):null!=t&&"object"==typeof t?t.toString():t}return this._storedValue}set value(t){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",t)}get visible(){return!this._isEditTrackingField&&(null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element&&!1!==this.field?.visible||this._isVisibleByDefault)}_arcadeOutputToDateFieldValue(t){const e=this.field.type;try{if("object"==typeof t){if(null===t)throw new Ve("feature-form:invalid-date-value");if(bE(t))return wE(t,e);if("getTime"in t&&"function"==typeof t.getTime&&"date"===e)return parseInt(t.getTime(),10);if("date-only"===e||"time-only"===e||"timestamp-offset"===e)return t.toString()}else{if("string"==typeof t)return"date"===e?parseInt(t,10):t;if("number"==typeof t&&"date"===e)return t}throw new Ve("feature-form:invalid-date-value")}catch{return"date"===e?NaN:""}}_isDomainCompatible(t){const{field:e}=this;if("coded-value"===t?.type){const i=typeof t.codedValues[0].code;if("string"===i&&Bj(e)||"number"===i&&Uj(e))return!0}return!!("range"===t?.type&&Uj(e)||kMt(e)||Hj(e))}_validate(){const{dataType:t,domain:e,field:i,initialFeature:n,minLength:s,range:r,required:o,valid:a,value:l,maxLength:u}=this,c=o&&null==l,h=void 0!==a;if(!c&&n.getAttribute(i.name)===l&&h)return null;if(c)return Kj.INVALID_TYPE;if("text"===t&&"string"==typeof l){if(s>-1&&l.length<s)return aEt.TOO_SHORT;if(u>-1&&l.length>u)return aEt.TOO_LONG}return"date"!==t||null==l||ME({type:i.type,range:r,value:l})?e?null!==l||o?jE(i,l,e):null:Xj(i,l):Yj.OUT_OF_RANGE}};r([Je()],yEt.prototype,"_dateFormRange",null),r([Je()],yEt.prototype,"_dateRange",null),r([Je()],yEt.prototype,"_storedValue",void 0),r([Je()],yEt.prototype,"_configAllowsEdits",null),r([Je()],yEt.prototype,"_layerAndFieldAllowEdits",null),r([Je()],yEt.prototype,"_isVisibleByDefault",null),r([Je()],yEt.prototype,"_isEditTrackingField",null),r([Je()],yEt.prototype,"_shouldUseValueExpression",null),r([Je()],yEt.prototype,"isSubtypeField",null),r([Je()],yEt.prototype,"valueIsOutOfDomain",null),r([Je()],yEt.prototype,"dataType",null),r([Je()],yEt.prototype,"dateDataType",null),r([Je()],yEt.prototype,"domain",null),r([Je()],yEt.prototype,"editable",null),r([Je({readOnly:!0})],yEt.prototype,"error",void 0),r([Je({constructOnly:!0})],yEt.prototype,"preservesValueWhenHidden",void 0),r([Je()],yEt.prototype,"evaluatedRequiredExpression",null),r([Je()],yEt.prototype,"evaluatedValueExpression",null),r([Je()],yEt.prototype,"field",void 0),r([Je()],yEt.prototype,"group",void 0),r([Je({readOnly:!0})],yEt.prototype,"hint",null),r([Je()],yEt.prototype,"includeDate",null),r([Je()],yEt.prototype,"includeTime",null),r([Je()],yEt.prototype,"includeTimeOffset",null),r([Je()],yEt.prototype,"initialFeature",null),r([Je({readOnly:!0})],yEt.prototype,"inputType",null),r([Je()],yEt.prototype,"hasInvalidSwitchValue",null),r([Je()],yEt.prototype,"isRelationshipKeyField",null),r([Je()],yEt.prototype,"label",null),r([Je()],yEt.prototype,"maxLength",null),r([Je()],yEt.prototype,"minLength",null),r([Je({readOnly:!0})],yEt.prototype,"name",null),r([Je()],yEt.prototype,"range",null),r([Je()],yEt.prototype,"required",null),r([Je()],yEt.prototype,"requiredExpressionExecutor",void 0),r([Je()],yEt.prototype,"showNoValueOptionEnabled",null),r([Je()],yEt.prototype,"submittable",null),r([Je()],yEt.prototype,"timeResolution",null),r([Je()],yEt.prototype,"timeStep",null),r([Je({readOnly:!0})],yEt.prototype,"type",void 0),r([Je()],yEt.prototype,"updating",null),r([Je()],yEt.prototype,"valid",null),r([Je({value:null})],yEt.prototype,"value",null),r([Je()],yEt.prototype,"valueExpressionExecutor",void 0),r([Je()],yEt.prototype,"visible",null),yEt=r([ln("esri.widgets.FeatureForm.FieldInput")],yEt);const gEt=t=>t&&!Number.isNaN(t.valueOf()),vEt=yEt;const wEt={showInput:"Enter",hideInput:"Escape"};let bEt=class extends Pkt{constructor(t){super(t),this.editInfo=null,this.cellValueValidatorFunction=({oldValue:t,value:e})=>t!==e,this.editable=!0,this.headerRenderFunction=t=>{const{root:e}=t,i=this.createHeaderContent();this.tableEditingEnabled&&!this.effectiveEditable&&i.prepend(this._lockIconNode),this.removeCellContent(e),e.appendChild(i)},this.inputRenderFunction=({root:t,column:e,rowData:i})=>{if(this.editInfo||!this.effectiveEditable||!i)return;const n=this.getCellValue(i),s=this.createInputElement({value:n});this._set("editInfo",{column:e,inputs:[s],root:t,rowData:i,oldValue:n});const r=document.createElement("div");r.appendChild(s),this.removeCellContent(t),t.appendChild(r),s.focus(),s instanceof HTMLInputElement&&s.select()},this.loadingMessage="",this.inputType="text",this.maxLength=null,this.onShowPromptCallback=()=>{},this.parseInputValueFunction=({inputs:t})=>t?.length||1!==t.length||Array.isArray(t[0].value)?null:t[0].value,this.renderFunction=t=>{const{root:e,rowData:i}=t,{editInfo:n}=this;if(n)return;const s=this.getCellValue(i),r=this.cellValueFormatFunction({root:e,rowData:i,value:s});let o=null;e.onclick=()=>e.focus(),e.ondblclick=()=>this.inputRenderFunction(t),e.ontouchend=()=>this.inputRenderFunction(t);const a=this.grid?.getSlotElementByName(e.slot),l=a?.parentElement;l&&!l.onkeydown&&(l.onkeydown=e=>{e.key!==wEt.showInput||this.editInfo||this.inputRenderFunction(t),e.key===wEt.hideInput&&this.editInfo&&this.cancel()}),null!=s&&null!=r?e.title=r.toString():e.title&&e.removeAttribute("title"),o=r instanceof HTMLElement?r:Lkt(this.messagesURIUtils,r),this.removeCellContent(e),o instanceof HTMLElement?e.appendChild(o):null!=o&&(e.innerHTML=o.toString())},this.required=!1,this.tableEditingEnabled=!1}get _lockIconNode(){return this.createCalciteIcon({icon:"lock",textLabel:this.messages?.editingPreventedColumn})}get effectiveEditable(){return this.tableEditingEnabled&&this.editable}get effectiveRequired(){return this.required}get editing(){return!!this.editInfo}get shouldShowPrompt(){return!1}cancel(){const{editInfo:t}=this;if(!t)return;const{column:e,root:i,rowData:n}=t;this.onEditComplete(),this.renderFunction({column:e,root:i,rowData:n})}createCalciteOption(t,e,i=!1){const n=document.createElement("calcite-option");return n.label=t,n.value=`${e}`,n.selected=i,n}createCalciteSelect(t,e){const{effectiveRequired:i,messages:n}=this;let s=!1;const r=e.map((({name:e,value:i})=>{const n=i===t;return n&&(s=!0),this.createCalciteOption(e,i,n)}));if(null!=t&&""!==t&&!s){const e=t.toString(),i=this.createCalciteOption(e,e);r.unshift(i)}i||r.unshift(this.createCalciteOption(`<${n?.noValue}>`,""));const o=document.createElement("calcite-select");return r.forEach((t=>o.appendChild(t))),o}createInputElement({value:t}){const{effectiveRequired:e,maxLength:i}=this,n=document.createElement("calcite-input");return null!=i&&(n.maxLength=i),n.required=e,n.value=t,n.addEventListener("calciteInputChange",(()=>this.onInputBlur(n))),n.onkeydown=t=>{t.key===wEt.hideInput&&this.onInputBlur(n,!0)},n.onblur=()=>this.onInputBlur(n),n}createDateComponent(){const t=document.createElement("calcite-input-date-picker");return t.focusTrapDisabled=!0,t.overlayPositioning="fixed",t}createTimeComponent(){const t=document.createElement("calcite-input-time-picker");return t.overlayPositioning="fixed",t.placement="auto-start",t.step=1,t}createTimeZoneComponent(){const t=document.createElement("calcite-input-time-zone");return t.maxItems=4,t.overlayPositioning="fixed",t}onEditComplete(){this._set("editInfo",null),this.grid?.generateCellPartNames()}onInputBlur(t,e=!1){t.onblur=null,e?this.cancel():this.submit()}async submit(){const{editInfo:t}=this;if(!t)return void this.cancel();const{inputs:e,rowData:i,oldValue:n}=t,s=this.parseInputValueFunction({inputs:e});if(!this.cellValueValidatorFunction({value:s,oldValue:n}))return void this.cancel();const{root:r}=t,o=i.item.objectId,{fieldName:a}=this;r.textContent=this.loadingMessage,this.shouldShowPrompt?this.onShowPromptCallback({column:this,objectId:o,oldValue:n,value:s}):await this.updateItems({objectId:o,updates:[{fieldName:a,value:s}]})}async updateItems(t){const{store:e}=this;if(e)try{await e.updateItem(t),this.onEditComplete()}catch{this.cancel()}else this.cancel()}};r([Je()],bEt.prototype,"_lockIconNode",null),r([Je({readOnly:!0})],bEt.prototype,"editInfo",void 0),r([Je()],bEt.prototype,"cellValueValidatorFunction",void 0),r([Je()],bEt.prototype,"editable",void 0),r([Je()],bEt.prototype,"effectiveEditable",null),r([Je()],bEt.prototype,"effectiveRequired",null),r([Je()],bEt.prototype,"editing",null),r([Je()],bEt.prototype,"headerRenderFunction",void 0),r([Je()],bEt.prototype,"inputRenderFunction",void 0),r([Je({constructOnly:!0})],bEt.prototype,"loadingMessage",void 0),r([Je()],bEt.prototype,"inputType",void 0),r([Je()],bEt.prototype,"maxLength",void 0),r([Je()],bEt.prototype,"onShowPromptCallback",void 0),r([Je()],bEt.prototype,"parseInputValueFunction",void 0),r([Je()],bEt.prototype,"renderFunction",void 0),r([Je()],bEt.prototype,"required",void 0),r([Je()],bEt.prototype,"shouldShowPrompt",null),r([Je()],bEt.prototype,"tableEditingEnabled",void 0),bEt=r([ln("esri.widgets.FeatureTable.Grid.EditorColumn")],bEt);const SEt=bEt;const _Et={cancelEdit:"Escape"},xEt="esri-column",MEt={input:`${xEt}__cell-input`,inputContainer:`${xEt}__cell__input-container`},TEt=Dg("short-date-short-time"),AEt=Dg("short-date"),IEt={useGrouping:!0,maximumFractionDigits:20};let kEt=class extends SEt{constructor(t){super(t),this._activeFieldInput=null,this.cellValueFormatFunction=({root:t,rowData:e,value:i})=>{const{formatFunction:n}=this;if(n&&e){const{index:s,item:{attachments:r,feature:o,relatedRecords:a}}=e;return n({attachments:r,column:this,feature:o,field:this.field,index:s,relatedRecords:a,value:ux.sanitize(i),virtualIndex:this.getVirtualRowIndex(t)})}if(null===i)return"&nbsp;";const{field:s}=this,r=this._getDomainForFeature(e?.item?.feature);if(r){const t=this._getComputedDomain(i,r);if("date"===s.type&&"range"===r.type)return this._formatDateValueForDisplay(s,t);if(this._isNumericField&&"range"===r.type){const t=this.template?.format,e=t?Zg(t):IEt;return Jg(parseFloat(i),e)}return rE.has(s.type)?"range"===r.type?ux.sanitize(dE(s,t)):ux.sanitize(t):t}if("date"===s.type||rE.has(s.type))return this._formatDateValueForDisplay(s,i);if(this._isNumericField){const t=this.template?.format,e=t?Zg(t):IEt;return Jg(parseFloat(i),e)}return ux.sanitize(i)},this.cellValueValidatorFunction=({oldValue:t,value:e})=>{const{_effectiveRange:i,field:n}=this,{max:s,min:r}=i;if(this.effectiveRequired&&(null==e||""===e))return!1;if(this._isNumericField&&(Xj(n,e)||!yE({max:s,min:r,value:e})))return jt.getLogger(this).warn("value-exceeds-valid-range","Field value exceeds valid range. Attempted edit was rejected."),!1;if(this._isAnyDateOrTimeField){const t=n.type;if(!ME({type:t,range:i,value:e}))return!1}return t!==e},this.field=null,this.formatFunction=null,this.inputRenderFunction=async({root:t,column:e,rowData:i})=>{if(this.editInfo||!this.effectiveEditable)return;const n=this.getCellValue(i),{field:s}=this;if("big-integer"===s.type&&Xj(s,n))return void jt.getLogger(this).warn("value-exceeds-valid-range","Field value is beyond supported limit. Editing is disabled for this field value.");const r=i?.item.feature;if(!r)return;this._activeFieldInput=this._setUpFieldInput(r,n);const o=document.createElement("div");o.classList.add(MEt.inputContainer);const a=[],l="coded-value"===this._effectiveDomain?.type;if(this._isAnyDateOrTimeField&&!l){const t=document.createElement("div"),e=this._setUpDateComponents(n),i=this._setUpDateActionBar();e.forEach((e=>t.appendChild(e))),o.appendChild(t),o.appendChild(i),a.push(...e)}else{const t=this.createInputElement({value:n});o.appendChild(t),a.push(t)}this._set("editInfo",{column:e,inputs:a,root:t,rowData:i,oldValue:n}),this.removeCellContent(t),t.appendChild(o),this._syncRowEditingState(t,!0),this.grid?.generateCellPartNames();const u=a[0];await hx(u),"selectText"in u&&await u.selectText()},this.layer=null,this.parseInputValueFunction=({inputs:t})=>{const{editInfo:e,field:i,includeTime:n}=this;if(!e||!t.length)return null;const s=t[0];if(this._isAnyDateOrTimeField){const{timeZone:r}=this.effectiveTimeZoneOptions,o=e.oldValue??void 0;if("coded-value"===this._effectiveDomain?.type)return null!=s.value?parseFloat(s.value):null;switch(i.type){case"date-only":{const t=s.value;return""!==t?t:null}case"time-only":{const t=vE(s.value);return""!==t?t:null}case"timestamp-offset":{const e=n?t[1]:void 0,i=t.at(-1);return fE({oldValue:o,dateComponent:s,timeComponent:e,timeZoneComponent:i,defaultTimeZone:r})}case"date":{const{max:e,min:i}=this._effectiveRange;return pE({oldValue:o,dateComponent:s,timeComponent:t[1],timeZone:r,max:e,min:i})}}return null}const r=s.value,{effectiveRequired:o}=this;return o||null!=r&&""!==r?this._isNumericField?parseFloat(r):this._isStringField?r.trim():r:null},this.sortable=!0,this.store=null,this.template=null,this.view=null}get _effectiveDomain(){const t=this._activeFieldInput?.feature;return t?this._getDomainForFeature(t):null}get _effectiveRange(){return this._activeFieldInput?.range??{max:null,min:null}}get _isAnyDateOrTimeField(){const{field:t}=this;return kMt(t)||Hj(t)}get _isIntegerField(){return zj(this.field)}get _isNumericField(){return Uj(this.field)}get _isStringField(){return Bj(this.field)}get _isSubtypeField(){const{layer:t}=this;if(t?.subtypeField){const{subtypeField:e,fieldsIndex:i}=t;return(i.get(e)?.name??e)===this.fieldName}return!1}get alias(){return this.field?.alias}get defaultValue(){return this.field?.defaultValue}get effectiveDescription(){const{description:t,field:e}=this,i=e.description,n=kkt(t)?kkt(i)?null:i:t;return null==n?null:ux.sanitize(n)}get effectiveEditable(){const{editable:t,field:e,layer:i,tableEditingEnabled:n}=this;if(!e||!i)return!1;const s=ZA(i),r=i.effectiveCapabilities??i.capabilities,o=r?.operations?.supportsUpdate;return!!(e.editable&&s&&o&&"oid"!==e.type&&n)&&t}get effectiveLabel(){return ux.sanitize(this.label||this.alias||this.fieldName)}get effectiveRequired(){return!this.nullable||this._isSubtypeField||this._activeFieldInput?.required||this.required}get effectiveTimeZoneOptions(){const{layer:t,field:e}=this;if(!t||"date"!==e?.type&&"timestamp-offset"!==e?.type)return{timeZone:void 0,timeZoneName:void 0};const{tableTimeZone:i,timeZone:n,view:s}=this;return vg(t.preferredTimeZone||null,!!t.datesInUnknownTimezone,n??i??s?.timeZone??og,Dg("short-time"),e.type)}get includeTime(){const{field:t,template:e}=this;return"time-only"===t.type||"date-only"!==t.type&&(!e?.input||"includeTime"in e.input&&!1!==e.input.includeTime)}get loadingMessage(){return this.messages?.loading||"..."}get maxLength(){const{field:t,template:e}=this,i=t?.length??-1,n=e?.input&&"maxLength"in e.input?e.input.maxLength:null;return null!=n&&!isNaN(n)&&n>=-1&&(-1===i||n<=i)?n:i}get minLength(){const{template:t,maxLength:e}=this,i=t?.input&&"minLength"in t.input?t.input.minLength:null;return e&&i<=e?i:null}get name(){return this.field?.name}get nullable(){return!1!==this.field.nullable}get shouldShowPrompt(){return this._isSubtypeField}createInputElement({value:t}){const{_effectiveDomain:e,maxLength:i,minLength:n,effectiveRequired:s}=this;let r;if("coded-value"===e?.type)r=this.createCalciteSelect(t,e.codedValues.map((({code:t,name:e})=>({value:t,name:e})))),r.addEventListener("calciteSelectChange",(()=>this.onInputBlur(r)));else if(this._isNumericField){const{_effectiveRange:{max:e,min:i}}=this;r=document.createElement("calcite-input"),r.type="number",this._isIntegerField&&(r.step=1),null!=e&&(r.max=e),null!=i&&(r.min=i),r.status=yE({max:e,min:i,value:t})?"idle":"invalid"}else r=document.createElement("calcite-input"),r.addEventListener("calciteInputChange",(()=>this.onInputBlur(r))),i>-1&&(r.maxLength=i),n>0&&(r.minLength=n);return r.classList.add(MEt.input),r.required=s,r.value=t,r.onkeydown=t=>{t.key===_Et.cancelEdit&&this.onInputBlur(r,!0)},r.onblur=()=>this.onInputBlur(r),r}onEditComplete(){const t=this.editInfo?.root;t&&this._syncRowEditingState(t,!1),this._activeFieldInput=null,super.onEditComplete()}_clearActiveEditValues(){this.editInfo?.inputs?.forEach((t=>t.value=""))}_setUpDateActionBar(){const{messagesCommon:t}=this,e=t?.cancel??"",i=t?.clear??"",n=t?.save??"",s=document.createElement("calcite-action-bar");return s.expandDisabled=!0,s.layout="horizontal",s.appendChild(this.createCalciteAction({text:n,icon:"save",onclick:()=>this.submit()})),this.effectiveRequired||s.appendChild(this.createCalciteAction({text:i,icon:"trash",onclick:()=>{this._clearActiveEditValues(),this.submit()}})),s.appendChild(this.createCalciteAction({text:e,icon:"x",onclick:()=>this.cancel()})),s}_formatDateValueForDisplay(t,e){const{timeZone:i,timeZoneName:n}=this.effectiveTimeZoneOptions;return null!=e?dE(t,e,{...this._getDateFormatOptions(),timeZone:i,timeZoneName:n}):null}_setUpDateComponents(t){const{_effectiveRange:{max:e,min:i,rawMax:n,rawMin:s},field:r,effectiveRequired:o}=this,a=this._getDateFieldValuesForComponents(r,t),l=[];if(kMt(r)){const t=this.createDateComponent(),u=Vj(r)||qj(r)?n:e,c=Vj(r)||qj(r)?s:i,h=this._getDateFieldValuesForComponents(r,u??null),d=this._getDateFieldValuesForComponents(r,c??null);t.value=a.date??"",t.max=h.date??"",t.min=d.date??"",t.required=o,t.addEventListener("calciteInputDatePickerOpen",(()=>this._onDateComponentOpen(t))),l.push(t)}if(this.includeTime){const t=this.createTimeComponent();t.value=a.time??"",t.required=o,t.addEventListener("calciteInputTimePickerOpen",(()=>this._onDateComponentOpen(t))),l.push(t)}if("timestamp-offset"===r.type){const t=this.createTimeZoneComponent();t.value=a.timeZoneOffset??"0",t.addEventListener("calciteInputTimeZoneOpen",(()=>this._onDateComponentOpen(t))),l.push(t)}return l}_onDateComponentOpen(t){this.editInfo?.inputs.forEach((e=>{e!==t&&"open"in e&&(e.open=!1)}))}_syncRowEditingState(t,e=!1){const i=this.grid?.getRowContainingNode(t);i&&(e?i.setAttribute("editing","true"):i.removeAttribute("editing"))}_getDateFieldValuesForComponents(t,e){switch(t.type){case"date":return cE(e,this.effectiveTimeZoneOptions.timeZone);case"date-only":return{date:e};case"time-only":return{time:e};case"timestamp-offset":return uE(e);default:return{}}}_setUpFieldInput(t,e){const{field:i,layer:n,effectiveTimeZoneOptions:{timeZone:s}}=this,r=new vEt({feature:t,field:i,initialFeature:t.clone(),layer:n,timeZone:s});return r.set("value",e),r}_isDomainCompatible(t){if(!t)return!1;const{_isNumericField:e,_isStringField:i}=this,{type:n}=t;if("coded-value"===n){const n=typeof t.codedValues[0].code;if("string"===n&&i||"number"===n&&e)return!0}return!("range"!==n||!e)}_getDomainForFeature(t){const{fieldName:e,layer:i,template:n}=this;return t&&i?.getFieldDomain?"wfs"===i.type||"geojson"===i.type||"csv"===i.type||"knowledge-graph-sublayer"===i.type?null:n?.domain&&this._isDomainCompatible(n.domain)?n.domain:i.getFieldDomain(e,{feature:t}):null}_getComputedDomain(t,e){if(!e)return null;if("range"===e.type)return t;if("coded-value"===e.type){const i=e.codedValues.filter((e=>e.hasOwnProperty("code")&&e.code===t));return i&&i.length?i[0].name:t}return null}_getDateFormatOptions(){const{template:t}=this,e=t?.format?.dateFormat;return e?Dg(e):t?.input&&"includeTime"in t.input&&!1===t.input.includeTime?AEt:TEt}};r([Je()],kEt.prototype,"_effectiveDomain",null),r([Je()],kEt.prototype,"_activeFieldInput",void 0),r([Je()],kEt.prototype,"_effectiveRange",null),r([Je()],kEt.prototype,"_isAnyDateOrTimeField",null),r([Je()],kEt.prototype,"_isIntegerField",null),r([Je()],kEt.prototype,"_isNumericField",null),r([Je()],kEt.prototype,"_isStringField",null),r([Je()],kEt.prototype,"_isSubtypeField",null),r([Je({readOnly:!0})],kEt.prototype,"alias",null),r([Je()],kEt.prototype,"cellValueFormatFunction",void 0),r([Je()],kEt.prototype,"cellValueValidatorFunction",void 0),r([Je({readOnly:!0})],kEt.prototype,"defaultValue",null),r([Je()],kEt.prototype,"effectiveDescription",null),r([Je()],kEt.prototype,"effectiveEditable",null),r([Je()],kEt.prototype,"effectiveLabel",null),r([Je()],kEt.prototype,"effectiveRequired",null),r([Je()],kEt.prototype,"effectiveTimeZoneOptions",null),r([Je()],kEt.prototype,"field",void 0),r([Je()],kEt.prototype,"formatFunction",void 0),r([Je()],kEt.prototype,"includeTime",null),r([Je()],kEt.prototype,"inputRenderFunction",void 0),r([Je()],kEt.prototype,"layer",void 0),r([Je({readOnly:!0})],kEt.prototype,"loadingMessage",null),r([Je()],kEt.prototype,"maxLength",null),r([Je()],kEt.prototype,"minLength",null),r([Je({readOnly:!0})],kEt.prototype,"name",null),r([Je({readOnly:!0})],kEt.prototype,"nullable",null),r([Je()],kEt.prototype,"parseInputValueFunction",void 0),r([Je()],kEt.prototype,"shouldShowPrompt",null),r([Je()],kEt.prototype,"sortable",void 0),r([Je()],kEt.prototype,"store",void 0),r([Je()],kEt.prototype,"template",void 0),r([Je()],kEt.prototype,"view",void 0),kEt=r([ln("esri.widgets.FeatureTable.FieldColumn")],kEt);const CEt=kEt;const EEt={showRecordsButton:"esri-column__show-related-records-button"};let jEt=class extends Pkt{constructor(t){super(t),this.flexGrow=1,this.icon="link",this.layer=null,this.relatedLayer=null,this.relationshipId=null,this.renderFunction=({root:t,rowData:e})=>{if(!e)return;const i=e.item,{layer:n,relatedLayer:s}=this;if(!i?.feature||!Mkt(n)||!Mkt(s))return;const{messages:r}=this,{index:o}=e,{feature:a,objectId:l}=i,{collapsed:u,showRelatedTableCallback:c,relationshipId:h}=this,d=i.relatedRecords,f=d?.find((t=>t.relationshipId===h))?.count??0,p=!u&&c&&r?.recordsCount?Xg(r.recordsCount,{count:f}):`${f}`,m=t=>{t.preventDefault(),u||this.showRelatedTableCallback?.({feature:a,index:o,layer:n,objectId:l,relatedLayer:s,relationshipId:h})},y=u?"":"chevron-right";if(t.firstChild){const e=t.firstChild;return e.textContent=p,e.onclick=m,void(e.iconEnd=y)}const g=this.createCalciteButton({className:`${EEt.showRecordsButton} ${ckt.contentFull}`,iconEnd:y,iconFlipRtl:"both",scale:"m",textContent:p,title:p,onclick:m});this.removeCellContent(t),t.appendChild(g)},this.resizable=!0,this.showRelatedTableCallback=null,this.textAlign="center",this.width="200px"}get _relationshipLabel(){return this.label||this.originRelationship?.name||this.layer.title||""}get collapsed(){return this._get("collapsed")||!1}set collapsed(t){t?this.set({flexGrow:0,resizable:!1,width:"80px"}):this.set({flexGrow:1,resizable:!0,width:"200px"}),this._set("collapsed",t)}get effectiveLabel(){return this.collapsed?"":this._relationshipLabel}get iconNode(){const{icon:t}=this;return t?this.createCalciteIcon({icon:t,textLabel:this._relationshipLabel}):null}get originRelationship(){const t=this.relationshipId;return this.relatedLayer.relationships?.find((({id:e})=>e===t))}get relationship(){return Ekt(this.layer,this.relationshipId)}};r([Je()],jEt.prototype,"_relationshipLabel",null),r([Je()],jEt.prototype,"collapsed",null),r([Je()],jEt.prototype,"effectiveLabel",null),r([Je()],jEt.prototype,"flexGrow",void 0),r([Je()],jEt.prototype,"icon",void 0),r([Je()],jEt.prototype,"iconNode",null),r([Je()],jEt.prototype,"layer",void 0),r([Je()],jEt.prototype,"originRelationship",null),r([Je()],jEt.prototype,"relatedLayer",void 0),r([Je()],jEt.prototype,"relationship",null),r([Je()],jEt.prototype,"relationshipId",void 0),r([Je()],jEt.prototype,"renderFunction",void 0),r([Je()],jEt.prototype,"resizable",void 0),r([Je()],jEt.prototype,"showRelatedTableCallback",void 0),r([Je()],jEt.prototype,"textAlign",void 0),r([Je()],jEt.prototype,"width",void 0),jEt=r([ln("esri.widgets.FeatureTable.RelationshipColumn")],jEt);const OEt=jEt;
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function REt(t,e="24.5.3"){Object.defineProperty(t,"version",{get(){return e}});const i=customElements.get(t.is);if(!i){customElements.define(t.is,t)}else{const e=i.version;if(e&&t.version&&e===t.version){console.warn(`The component ${t.is} has been loaded twice`)}else{console.error(`Tried to define ${t.is} version ${t.version} when version ${i.version} is already in use. Something will probably break.`)}}}
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class LEt extends HTMLElement{static get is(){return"vaadin-lumo-styles"}}REt(LEt);
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const NEt=globalThis,PEt=NEt.ShadowRoot&&(void 0===NEt.ShadyCSS||NEt.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,FEt=Symbol(),DEt=new WeakMap;class $Et{constructor(t,e,i){if(this._$cssResult$=!0,i!==FEt)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(PEt&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=DEt.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&DEt.set(e,t))}return t}toString(){return this.cssText}}const zEt=t=>new $Et("string"==typeof t?t:t+"",void 0,FEt),UEt=(t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,i,n)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[n+1]),t[0]);return new $Et(i,t,FEt)},BEt=(t,e)=>{if(PEt)t.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const i of e){const e=document.createElement("style"),n=NEt.litNonce;void 0!==n&&e.setAttribute("nonce",n),e.textContent=i.cssText,t.appendChild(e)}},GEt=PEt?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return zEt(e)})(t):t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;const{is:VEt,defineProperty:qEt,getOwnPropertyDescriptor:HEt,getOwnPropertyNames:WEt,getOwnPropertySymbols:ZEt,getPrototypeOf:JEt}=Object,YEt=globalThis,KEt=YEt.trustedTypes,QEt=KEt?KEt.emptyScript:"",XEt=YEt.reactiveElementPolyfillSupport,tjt=(t,e)=>t,ejt={toAttribute(t,e){switch(e){case Boolean:t=t?QEt:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},ijt=(t,e)=>!VEt(t,e),njt={attribute:!0,type:String,converter:ejt,reflect:!1,hasChanged:ijt};Symbol.metadata??=Symbol("metadata"),YEt.litPropertyMetadata??=new WeakMap;class sjt extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=njt){if(e.state&&(e.attribute=!1),this._$Ei(),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),n=this.getPropertyDescriptor(t,i,e);void 0!==n&&qEt(this.prototype,t,n)}}static getPropertyDescriptor(t,e,i){const{get:n,set:s}=HEt(this.prototype,t)??{get(){return this[e]},set(t){this[e]=t}};return{get(){return n?.call(this)},set(e){const r=n?.call(this);s.call(this,e),this.requestUpdate(t,r,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??njt}static _$Ei(){if(this.hasOwnProperty(tjt("elementProperties")))return;const t=JEt(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(tjt("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(tjt("properties"))){const t=this.properties,e=[...WEt(t),...ZEt(t)];for(const i of e)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const e=litPropertyMetadata.get(t);if(void 0!==e)for(const[t,i]of e)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,e]of this.elementProperties){const i=this._$Eu(t,e);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(GEt(t))}else void 0!==t&&e.push(GEt(t));return e}static _$Eu(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return BEt(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EC(t,e){const i=this.constructor.elementProperties.get(t),n=this.constructor._$Eu(t,i);if(void 0!==n&&!0===i.reflect){const s=(void 0!==i.converter?.toAttribute?i.converter:ejt).toAttribute(e,i.type);this._$Em=t,null==s?this.removeAttribute(n):this.setAttribute(n,s),this._$Em=null}}_$AK(t,e){const i=this.constructor,n=i._$Eh.get(t);if(void 0!==n&&this._$Em!==n){const t=i.getPropertyOptions(n),s="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:ejt;this._$Em=n,this[n]=s.fromAttribute(e,t.type),this._$Em=null}}requestUpdate(t,e,i){if(void 0!==t){if(i??=this.constructor.getPropertyOptions(t),!(i.hasChanged??ijt)(this[t],e))return;this.P(t,e,i)}!1===this.isUpdatePending&&(this._$ES=this._$ET())}P(t,e,i){this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$Em!==t&&(this._$Ej??=new Set).add(t)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,e]of this._$Ep)this[t]=e;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[e,i]of t)!0!==i.wrapped||this._$AL.has(e)||void 0===this[e]||this.P(e,this[e],i)}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(e)):this._$EU()}catch(e){throw t=!1,this._$EU(),e}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Ej&&=this._$Ej.forEach((t=>this._$EC(t,this[t]))),this._$EU()}updated(t){}firstUpdated(t){}}sjt.elementStyles=[],sjt.shadowRootOptions={mode:"open"},sjt[tjt("elementProperties")]=new Map,sjt[tjt("finalized")]=new Map,XEt?.({ReactiveElement:sjt}),(YEt.reactiveElementVersions??=[]).push("2.0.4");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const rjt=globalThis,ojt=rjt.trustedTypes,ajt=ojt?ojt.createPolicy("lit-html",{createHTML:t=>t}):void 0,ljt="$lit$",ujt=`lit$${Math.random().toFixed(9).slice(2)}$`,cjt="?"+ujt,hjt=`<${cjt}>`,djt=document,fjt=()=>djt.createComment(""),pjt=t=>null===t||"object"!=typeof t&&"function"!=typeof t,mjt=Array.isArray,yjt=t=>mjt(t)||"function"==typeof t?.[Symbol.iterator],gjt="[ \t\n\f\r]",vjt=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,wjt=/-->/g,bjt=/>/g,Sjt=RegExp(`>|${gjt}(?:([^\\s"'>=/]+)(${gjt}*=${gjt}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),_jt=/'/g,xjt=/"/g,Mjt=/^(?:script|style|textarea|title)$/i,Tjt=Symbol.for("lit-noChange"),Ajt=Symbol.for("lit-nothing"),Ijt=new WeakMap,kjt=djt.createTreeWalker(djt,129);function Cjt(t,e){if(!mjt(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==ajt?ajt.createHTML(e):e}const Ejt=(t,e)=>{const i=t.length-1,n=[];let s,r=2===e?"<svg>":3===e?"<math>":"",o=vjt;for(let e=0;e<i;e++){const i=t[e];let a,l,u=-1,c=0;for(;c<i.length&&(o.lastIndex=c,l=o.exec(i),null!==l);)c=o.lastIndex,o===vjt?"!--"===l[1]?o=wjt:void 0!==l[1]?o=bjt:void 0!==l[2]?(Mjt.test(l[2])&&(s=RegExp("</"+l[2],"g")),o=Sjt):void 0!==l[3]&&(o=Sjt):o===Sjt?">"===l[0]?(o=s??vjt,u=-1):void 0===l[1]?u=-2:(u=o.lastIndex-l[2].length,a=l[1],o=void 0===l[3]?Sjt:'"'===l[3]?xjt:_jt):o===xjt||o===_jt?o=Sjt:o===wjt||o===bjt?o=vjt:(o=Sjt,s=void 0);const h=o===Sjt&&t[e+1].startsWith("/>")?" ":"";r+=o===vjt?i+hjt:u>=0?(n.push(a),i.slice(0,u)+ljt+i.slice(u)+ujt+h):i+ujt+(-2===u?e:h)}return[Cjt(t,r+(t[i]||"<?>")+(2===e?"</svg>":3===e?"</math>":"")),n]};class jjt{constructor({strings:t,_$litType$:e},i){let n;this.parts=[];let s=0,r=0;const o=t.length-1,a=this.parts,[l,u]=Ejt(t,e);if(this.el=jjt.createElement(l,i),kjt.currentNode=this.el.content,2===e||3===e){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(n=kjt.nextNode())&&a.length<o;){if(1===n.nodeType){if(n.hasAttributes())for(const t of n.getAttributeNames())if(t.endsWith(ljt)){const e=u[r++],i=n.getAttribute(t).split(ujt),o=/([.?@])?(.*)/.exec(e);a.push({type:1,index:s,name:o[2],strings:i,ctor:"."===o[1]?Pjt:"?"===o[1]?Fjt:"@"===o[1]?Djt:Njt}),n.removeAttribute(t)}else t.startsWith(ujt)&&(a.push({type:6,index:s}),n.removeAttribute(t));if(Mjt.test(n.tagName)){const t=n.textContent.split(ujt),e=t.length-1;if(e>0){n.textContent=ojt?ojt.emptyScript:"";for(let i=0;i<e;i++)n.append(t[i],fjt()),kjt.nextNode(),a.push({type:2,index:++s});n.append(t[e],fjt())}}}else if(8===n.nodeType)if(n.data===cjt)a.push({type:2,index:s});else{let t=-1;for(;-1!==(t=n.data.indexOf(ujt,t+1));)a.push({type:7,index:s}),t+=ujt.length-1}s++}}static createElement(t,e){const i=djt.createElement("template");return i.innerHTML=t,i}}function Ojt(t,e,i=t,n){if(e===Tjt)return e;let s=void 0!==n?i._$Co?.[n]:i._$Cl;const r=pjt(e)?void 0:e._$litDirective$;return s?.constructor!==r&&(s?._$AO?.(!1),void 0===r?s=void 0:(s=new r(t),s._$AT(t,i,n)),void 0!==n?(i._$Co??=[])[n]=s:i._$Cl=s),void 0!==s&&(e=Ojt(t,s._$AS(t,e.values),s,n)),e}class Rjt{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:i}=this._$AD,n=(t?.creationScope??djt).importNode(e,!0);kjt.currentNode=n;let s=kjt.nextNode(),r=0,o=0,a=i[0];for(;void 0!==a;){if(r===a.index){let e;2===a.type?e=new Ljt(s,s.nextSibling,this,t):1===a.type?e=new a.ctor(s,a.name,a.strings,this,t):6===a.type&&(e=new $jt(s,this,t)),this._$AV.push(e),a=i[++o]}r!==a?.index&&(s=kjt.nextNode(),r++)}return kjt.currentNode=djt,n}p(t){let e=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class Ljt{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,e,i,n){this.type=2,this._$AH=Ajt,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=n,this._$Cv=n?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t?.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=Ojt(this,t,e),pjt(t)?t===Ajt||null==t||""===t?(this._$AH!==Ajt&&this._$AR(),this._$AH=Ajt):t!==this._$AH&&t!==Tjt&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):yjt(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==Ajt&&pjt(this._$AH)?this._$AA.nextSibling.data=t:this.T(djt.createTextNode(t)),this._$AH=t}$(t){const{values:e,_$litType$:i}=t,n="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=jjt.createElement(Cjt(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===n)this._$AH.p(e);else{const t=new Rjt(n,this),i=t.u(this.options);t.p(e),this.T(i),this._$AH=t}}_$AC(t){let e=Ijt.get(t.strings);return void 0===e&&Ijt.set(t.strings,e=new jjt(t)),e}k(t){mjt(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,n=0;for(const s of t)n===e.length?e.push(i=new Ljt(this.O(fjt()),this.O(fjt()),this,this.options)):i=e[n],i._$AI(s),n++;n<e.length&&(this._$AR(i&&i._$AB.nextSibling,n),e.length=n)}_$AR(t=this._$AA.nextSibling,e){for(this._$AP?.(!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class Njt{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,i,n,s){this.type=1,this._$AH=Ajt,this._$AN=void 0,this.element=t,this.name=e,this._$AM=n,this.options=s,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Ajt}_$AI(t,e=this,i,n){const s=this.strings;let r=!1;if(void 0===s)t=Ojt(this,t,e,0),r=!pjt(t)||t!==this._$AH&&t!==Tjt,r&&(this._$AH=t);else{const n=t;let o,a;for(t=s[0],o=0;o<s.length-1;o++)a=Ojt(this,n[i+o],e,o),a===Tjt&&(a=this._$AH[o]),r||=!pjt(a)||a!==this._$AH[o],a===Ajt?t=Ajt:t!==Ajt&&(t+=(a??"")+s[o+1]),this._$AH[o]=a}r&&!n&&this.j(t)}j(t){t===Ajt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class Pjt extends Njt{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===Ajt?void 0:t}}class Fjt extends Njt{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==Ajt)}}class Djt extends Njt{constructor(t,e,i,n,s){super(t,e,i,n,s),this.type=5}_$AI(t,e=this){if((t=Ojt(this,t,e,0)??Ajt)===Tjt)return;const i=this._$AH,n=t===Ajt&&i!==Ajt||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,s=t!==Ajt&&(i===Ajt||n);n&&this.element.removeEventListener(this.name,this,i),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class $jt{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){Ojt(this,t)}}const zjt=rjt.litHtmlPolyfillSupport;zjt?.(jjt,Ljt),(rjt.litHtmlVersions??=[]).push("3.2.1");const Ujt=(t,e,i)=>{const n=i?.renderBefore??e;let s=n._$litPart$;if(void 0===s){const t=i?.renderBefore??null;n._$litPart$=s=new Ljt(e.insertBefore(fjt(),t),t,void 0,i??{})}return s._$AI(t),s
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */};class Bjt extends sjt{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=Ujt(e,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Tjt}}Bjt._$litElement$=!0,Bjt["finalized"]=!0,globalThis.litElementHydrateSupport?.({LitElement:Bjt});const Gjt=globalThis.litElementPolyfillSupport;Gjt?.({LitElement:Bjt});(globalThis.litElementVersions??=[]).push("4.1.1");
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const Vjt=t=>class e extends t{static get properties(){return{_theme:{type:String,readOnly:true}}}static get observedAttributes(){return[...super.observedAttributes,"theme"]}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i);if(t==="theme"){this._set_theme(i)}}}
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const qjt=[];const Hjt=new Set;const Wjt=new Set;function Zjt(t){return t&&Object.prototype.hasOwnProperty.call(t,"__themes")}function Jjt(t){return Zjt(customElements.get(t))}function Yjt(t=[]){return[t].flat(Infinity).filter((t=>{if(t instanceof $Et){return true}console.warn("An item in styles is not of type CSSResult. Use `unsafeCSS` or `css`.");return false}))}function Kjt(t,e){return(t||"").split(" ").some((t=>new RegExp(`^${t.split("*").join(".*")}$`,"u").test(e)))}function Qjt(t){return t.map((t=>t.cssText)).join("\n")}const Xjt="vaadin-themable-mixin-style";function tOt(t,e){const i=document.createElement("style");i.id=Xjt;i.textContent=Qjt(t);e.content.appendChild(i)}function eOt(t){if(!t.shadowRoot){return}const e=t.constructor;if(t instanceof Bjt){[...t.shadowRoot.querySelectorAll("style")].forEach((t=>t.remove()));BEt(t.shadowRoot,e.elementStyles)}else{const i=t.shadowRoot.getElementById(Xjt);const n=e.prototype._template;i.textContent=n.content.getElementById(Xjt).textContent}}function iOt(t){Hjt.forEach((e=>{const i=e.deref();if(i instanceof t){eOt(i)}else if(!i){Hjt.delete(e)}}))}function nOt(t){if(t.prototype instanceof Bjt){t.elementStyles=t.finalizeStyles(t.styles)}else{const e=t.prototype._template;e.content.getElementById(Xjt).textContent=Qjt(t.getStylesForThis())}Wjt.forEach((e=>{const i=customElements.get(e);if(i!==t&&i.prototype instanceof t){nOt(i)}}))}function sOt(t,e){const i=t.__themes;if(!i||!e){return false}return i.some((t=>t.styles.some((t=>e.some((e=>e.cssText===t.cssText))))))}function rOt(t,e,i={}){e=Yjt(e);if(window.Vaadin&&window.Vaadin.styleModules){window.Vaadin.styleModules.registerStyles(t,e,i)}else{qjt.push({themeFor:t,styles:e,include:i.include,moduleId:i.moduleId})}if(t){Wjt.forEach((i=>{if(Kjt(t,i)&&Jjt(i)){const t=customElements.get(i);if(sOt(t,e)){console.warn(`Registering styles that already exist for ${i}`)}else if(!window.Vaadin||!window.Vaadin.suppressPostFinalizeStylesWarning){console.warn(`The custom element definition for "${i}" `+`was finalized before a style module was registered. `+`Ideally, import component specific style modules before `+`importing the corresponding custom element. `+`This warning can be suppressed by setting "window.Vaadin.suppressPostFinalizeStylesWarning = true".`)}nOt(t);iOt(t)}}))}}function oOt(){if(window.Vaadin&&window.Vaadin.styleModules){return window.Vaadin.styleModules.getAllThemes()}return qjt}function aOt(t=""){let e=0;if(t.startsWith("lumo-")||t.startsWith("material-")){e=1}else if(t.startsWith("vaadin-")){e=2}return e}function lOt(t){const e=[];if(t.include){[].concat(t.include).forEach((t=>{const i=oOt().find((e=>e.moduleId===t));if(i){e.push(...lOt(i),...i.styles)}else{console.warn(`Included moduleId ${t} not found in style registry`)}}),t.styles)}return e}function uOt(t){const e=`${t}-default-theme`;const i=oOt().filter((i=>i.moduleId!==e&&Kjt(i.themeFor,t))).map((t=>({...t,styles:[...lOt(t),...t.styles],includePriority:aOt(t.moduleId)}))).sort(((t,e)=>e.includePriority-t.includePriority));if(i.length>0){return i}return oOt().filter((t=>t.moduleId===e))}const cOt=t=>class e extends(Vjt(t)){constructor(){super();Hjt.add(new WeakRef(this))}static finalize(){super.finalize();if(this.is){Wjt.add(this.is)}if(this.elementStyles){return}const t=this.prototype._template;if(!t||Zjt(this)){return}tOt(this.getStylesForThis(),t)}static finalizeStyles(t){const e=this.getStylesForThis();return t?[...[t].flat(Infinity),...e]:e}static getStylesForThis(){const e=t.__themes||[];const i=Object.getPrototypeOf(this.prototype);const n=(i?i.constructor.__themes:[])||[];this.__themes=[...e,...n,...uOt(this.is)];const s=this.__themes.flatMap((t=>t.styles));return s.filter(((t,e)=>e===s.lastIndexOf(t)))}}
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const hOt=(t,...e)=>{const i=document.createElement("style");i.id=t;i.textContent=e.map((t=>t.toString())).join("\n").replace(":host","html");document.head.insertAdjacentElement("afterbegin",i)};const dOt=(t,...e)=>{hOt(`lumo-${t}`,e)};
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const fOt=UEt`
  :host {
    /* Base (background) */
    --lumo-base-color: #fff;

    /* Tint */
    --lumo-tint-5pct: hsla(0, 0%, 100%, 0.3);
    --lumo-tint-10pct: hsla(0, 0%, 100%, 0.37);
    --lumo-tint-20pct: hsla(0, 0%, 100%, 0.44);
    --lumo-tint-30pct: hsla(0, 0%, 100%, 0.5);
    --lumo-tint-40pct: hsla(0, 0%, 100%, 0.57);
    --lumo-tint-50pct: hsla(0, 0%, 100%, 0.64);
    --lumo-tint-60pct: hsla(0, 0%, 100%, 0.7);
    --lumo-tint-70pct: hsla(0, 0%, 100%, 0.77);
    --lumo-tint-80pct: hsla(0, 0%, 100%, 0.84);
    --lumo-tint-90pct: hsla(0, 0%, 100%, 0.9);
    --lumo-tint: #fff;

    /* Shade */
    --lumo-shade-5pct: hsla(214, 61%, 25%, 0.05);
    --lumo-shade-10pct: hsla(214, 57%, 24%, 0.1);
    --lumo-shade-20pct: hsla(214, 53%, 23%, 0.16);
    --lumo-shade-30pct: hsla(214, 50%, 22%, 0.26);
    --lumo-shade-40pct: hsla(214, 47%, 21%, 0.38);
    --lumo-shade-50pct: hsla(214, 45%, 20%, 0.52);
    --lumo-shade-60pct: hsla(214, 43%, 19%, 0.6);
    --lumo-shade-70pct: hsla(214, 42%, 18%, 0.69);
    --lumo-shade-80pct: hsla(214, 41%, 17%, 0.83);
    --lumo-shade-90pct: hsla(214, 40%, 16%, 0.94);
    --lumo-shade: hsl(214, 35%, 15%);

    /* Contrast */
    --lumo-contrast-5pct: var(--lumo-shade-5pct);
    --lumo-contrast-10pct: var(--lumo-shade-10pct);
    --lumo-contrast-20pct: var(--lumo-shade-20pct);
    --lumo-contrast-30pct: var(--lumo-shade-30pct);
    --lumo-contrast-40pct: var(--lumo-shade-40pct);
    --lumo-contrast-50pct: var(--lumo-shade-50pct);
    --lumo-contrast-60pct: var(--lumo-shade-60pct);
    --lumo-contrast-70pct: var(--lumo-shade-70pct);
    --lumo-contrast-80pct: var(--lumo-shade-80pct);
    --lumo-contrast-90pct: var(--lumo-shade-90pct);
    --lumo-contrast: var(--lumo-shade);

    /* Text */
    --lumo-header-text-color: var(--lumo-contrast);
    --lumo-body-text-color: var(--lumo-contrast-90pct);
    --lumo-secondary-text-color: var(--lumo-contrast-70pct);
    --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
    --lumo-disabled-text-color: var(--lumo-contrast-30pct);

    /* Primary */
    --lumo-primary-color: hsl(214, 100%, 48%);
    --lumo-primary-color-50pct: hsla(214, 100%, 49%, 0.76);
    --lumo-primary-color-10pct: hsla(214, 100%, 60%, 0.13);
    --lumo-primary-text-color: hsl(214, 100%, 43%);
    --lumo-primary-contrast-color: #fff;

    /* Error */
    --lumo-error-color: hsl(3, 85%, 48%);
    --lumo-error-color-50pct: hsla(3, 85%, 49%, 0.5);
    --lumo-error-color-10pct: hsla(3, 85%, 49%, 0.1);
    --lumo-error-text-color: hsl(3, 89%, 42%);
    --lumo-error-contrast-color: #fff;

    /* Success */
    --lumo-success-color: hsl(145, 72%, 30%);
    --lumo-success-color-50pct: hsla(145, 72%, 31%, 0.5);
    --lumo-success-color-10pct: hsla(145, 72%, 31%, 0.1);
    --lumo-success-text-color: hsl(145, 85%, 25%);
    --lumo-success-contrast-color: #fff;

    /* Warning */
    --lumo-warning-color: hsl(48, 100%, 50%);
    --lumo-warning-color-10pct: hsla(48, 100%, 50%, 0.25);
    --lumo-warning-text-color: hsl(32, 100%, 30%);
    --lumo-warning-contrast-color: var(--lumo-shade-90pct);
  }

  /* forced-colors mode adjustments */
  @media (forced-colors: active) {
    html {
      --lumo-disabled-text-color: GrayText;
    }
  }
`;dOt("color-props",fOt);const pOt=UEt`
  [theme~='dark'] {
    /* Base (background) */
    --lumo-base-color: hsl(214, 35%, 21%);

    /* Tint */
    --lumo-tint-5pct: hsla(214, 65%, 85%, 0.06);
    --lumo-tint-10pct: hsla(214, 60%, 80%, 0.14);
    --lumo-tint-20pct: hsla(214, 64%, 82%, 0.23);
    --lumo-tint-30pct: hsla(214, 69%, 84%, 0.32);
    --lumo-tint-40pct: hsla(214, 73%, 86%, 0.41);
    --lumo-tint-50pct: hsla(214, 78%, 88%, 0.5);
    --lumo-tint-60pct: hsla(214, 82%, 90%, 0.58);
    --lumo-tint-70pct: hsla(214, 87%, 92%, 0.69);
    --lumo-tint-80pct: hsla(214, 91%, 94%, 0.8);
    --lumo-tint-90pct: hsla(214, 96%, 96%, 0.9);
    --lumo-tint: hsl(214, 100%, 98%);

    /* Shade */
    --lumo-shade-5pct: hsla(214, 0%, 0%, 0.07);
    --lumo-shade-10pct: hsla(214, 4%, 2%, 0.15);
    --lumo-shade-20pct: hsla(214, 8%, 4%, 0.23);
    --lumo-shade-30pct: hsla(214, 12%, 6%, 0.32);
    --lumo-shade-40pct: hsla(214, 16%, 8%, 0.41);
    --lumo-shade-50pct: hsla(214, 20%, 10%, 0.5);
    --lumo-shade-60pct: hsla(214, 24%, 12%, 0.6);
    --lumo-shade-70pct: hsla(214, 28%, 13%, 0.7);
    --lumo-shade-80pct: hsla(214, 32%, 13%, 0.8);
    --lumo-shade-90pct: hsla(214, 33%, 13%, 0.9);
    --lumo-shade: hsl(214, 33%, 13%);

    /* Contrast */
    --lumo-contrast-5pct: var(--lumo-tint-5pct);
    --lumo-contrast-10pct: var(--lumo-tint-10pct);
    --lumo-contrast-20pct: var(--lumo-tint-20pct);
    --lumo-contrast-30pct: var(--lumo-tint-30pct);
    --lumo-contrast-40pct: var(--lumo-tint-40pct);
    --lumo-contrast-50pct: var(--lumo-tint-50pct);
    --lumo-contrast-60pct: var(--lumo-tint-60pct);
    --lumo-contrast-70pct: var(--lumo-tint-70pct);
    --lumo-contrast-80pct: var(--lumo-tint-80pct);
    --lumo-contrast-90pct: var(--lumo-tint-90pct);
    --lumo-contrast: var(--lumo-tint);

    /* Text */
    --lumo-header-text-color: var(--lumo-contrast);
    --lumo-body-text-color: var(--lumo-contrast-90pct);
    --lumo-secondary-text-color: var(--lumo-contrast-70pct);
    --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
    --lumo-disabled-text-color: var(--lumo-contrast-30pct);

    /* Primary */
    --lumo-primary-color: hsl(214, 90%, 48%);
    --lumo-primary-color-50pct: hsla(214, 90%, 70%, 0.69);
    --lumo-primary-color-10pct: hsla(214, 90%, 55%, 0.13);
    --lumo-primary-text-color: hsl(214, 90%, 77%);
    --lumo-primary-contrast-color: #fff;

    /* Error */
    --lumo-error-color: hsl(3, 79%, 49%);
    --lumo-error-color-50pct: hsla(3, 75%, 62%, 0.5);
    --lumo-error-color-10pct: hsla(3, 75%, 62%, 0.14);
    --lumo-error-text-color: hsl(3, 100%, 80%);

    /* Success */
    --lumo-success-color: hsl(145, 72%, 30%);
    --lumo-success-color-50pct: hsla(145, 92%, 51%, 0.5);
    --lumo-success-color-10pct: hsla(145, 92%, 51%, 0.1);
    --lumo-success-text-color: hsl(145, 85%, 46%);

    /* Warning */
    --lumo-warning-color: hsl(43, 100%, 48%);
    --lumo-warning-color-10pct: hsla(40, 100%, 50%, 0.2);
    --lumo-warning-text-color: hsl(45, 100%, 60%);
    --lumo-warning-contrast-color: var(--lumo-shade-90pct);
  }

  html {
    color: var(--lumo-body-text-color);
    background-color: var(--lumo-base-color);
    color-scheme: light;
  }

  [theme~='dark'] {
    color: var(--lumo-body-text-color);
    background-color: var(--lumo-base-color);
    color-scheme: dark;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: var(--lumo-header-text-color);
  }

  a:where(:any-link) {
    color: var(--lumo-primary-text-color);
  }

  a:not(:any-link) {
    color: var(--lumo-disabled-text-color);
  }

  blockquote {
    color: var(--lumo-secondary-text-color);
  }

  code,
  pre {
    background-color: var(--lumo-contrast-10pct);
    border-radius: var(--lumo-border-radius-m);
  }
  pre code {
    background: transparent;
  }
`;rOt("",pOt,{moduleId:"lumo-color"});
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const mOt=UEt`
  @font-face {
    font-family: 'lumo-icons';
    src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABEgAAsAAAAAIjQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAQwAAAFZAIUuKY21hcAAAAYgAAAD4AAADrsCU8d5nbHlmAAACgAAAC2cAABeAWri7U2hlYWQAAA3oAAAAMAAAADZa/6SsaGhlYQAADhgAAAAdAAAAJAbpA35obXR4AAAOOAAAABAAAACspBAAAGxvY2EAAA5IAAAAWAAAAFh57oA4bWF4cAAADqAAAAAfAAAAIAFKAXBuYW1lAAAOwAAAATEAAAIuUUJZCHBvc3QAAA/0AAABKwAAAelm8SzVeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGS+yDiBgZWBgamKaQ8DA0MPhGZ8wGDIyAQUZWBlZsAKAtJcUxgcXjG+0mIO+p/FEMUcxDANKMwIkgMABn8MLQB4nO3SWW6DMABF0UtwCEnIPM/zhLK8LqhfXRybSP14XUYtHV9hGYQwQBNIo3cUIPkhQeM7rib1ekqnXg981XuC1qvy84lzojleh3puxL0hPjGjRU473teloEefAUNGjJkwZcacBUtWrNmwZceeA0dOnLlw5cadB09elPGhGf+j0NTI/65KfXerT6JhqKnpRKtgOpuqaTrtKjPUlqHmhto21I7pL6i6hlqY3q7qGWrfUAeGOjTUkaGODXViqFNDnRnq3FAXhro01JWhrg11Y6hbQ90Z6t5QD4Z6NNSToZ4N9WKoV0O9GerdUB+G+jTUl6GWRvkL24BkEXictVh9bFvVFb/nxvbz+7Rf/N6zHcd2bCfP+Wic1Z9N0jpNHCD9SNqqoVBgbQoMjY+pjA4hNnWa2pV1rHSIif0DGkyT2k10Kmu1Cag6huj4ZpqYBHSqJsTEJgZCG3TaVBFv595nO3ZIv4RIrPPuvefe884599zzO/cRF8G/tgn6CFFImNgkR0ggX8wlspbhSSWSdrC5ozd30s2dw5afzvgtyz9/zG9t1hV4RtF1pXolowvtzc2z6L2aYUQM45jKH9WDTvd1LRDoDASYWhfTzTyvboXz6uZX4ARX5wrF39y+HM2+CJ8d0pkyqBIqoze3D12ez4DrFoYzxI8dWwMrDlZ2DMqQAR9AROsJU+2smlTPaTTco52BVxXa2a2+I8vvqd2dVHm1LoPeTn/AZPRYGthDYOeZjBjKoFsVGulR3lGU95SeCK44oHU7MhWUGUKZDT3oSUcG2GWuh+EDDfUYA/jhIhl0TOsJNYSEu7mQmi3UzfXwZKA4BsVsHLXQYGgJW95qEtpJ1VcW9HiTriZBlFEqxsDjA09yCNUoQxxwd7KWSTt2y3GTKifkqHRCoWZc3m11Wa/dKdFgXD4kSYfkeJBKd8KMz7J8dZn/cGRCcLGDnA2Ge3bKzcvlnTDNthFWLH7Xt80ua5FMjA4WKelWv5Xo16vHuYzpRbJhhdVlftuRK0VlR27D9lu5TF0DPBi60OrHNO0AfP/uRWvhn/U3LXICE+nh+3IHPUJ8JE6GyBjZQLbjGchlrSgYngF8zyrIF4NJD3atUcgWsWunGN/UHX5B5/yg7uF87Nqp4Gf52F3gH73DjEZNRoqCKAr9giQJp5rGJABpiVE2htNhW9R8nw0jqYjCYcY4LIjwYNScf4WN06IZnZCEqsI4cFaQbo4Z1TsZBx40YhXkHOecaYE5oY37IIQ+iJJ+UsDYSun5MuRSBRZRUUhlY2DqOGajOR6zrSU/5My6l2DnusH1GQgnw5BZP7iuYM/ahcfQ7Z8y51ddfutvuwNqWQ0cBYr8fj0U0vsHpwerVaB2sWhXT2NExi2r1KUE2tUuVMnkepVQrxTmpQrZTG4iu8he8iPyM3KcPE/+RP5KPoE2CEAKclCBzXATxkYOtUY/o961PWRqsj0chRrHFBbtrjP9/P0ven5pcbRdpL94vfsy33e5+izuwz3nFLFPVNayPZx/jdG1fOChflFRvYzsW6L18efgLrSWIgvcqnGJYi4skO4xREURjbDuxKke5v0T3Mrzkt2fi31uyZlLLrqIpEuXXsMlgw442Jb0GAxjS1DM20kBoCzHLXm/jEm0IltdcvU0fEW24jgiwwRjVd9u4NJHcIyoHJcwvyVqgqj5hqBJ1ZWSJryh9p56UWhX1XbhRbW2ZopuZWsQd5y8mEQ8M+C6xjRYxZbDKWf5AgY+Qq/l6wSPk16zDFjowYuu+wjx13mfkxbyDDxadYT/LijZyI0THB+6yfLaWsRcO82zo9mWTNtpO18qlorZoIVMwSN40tky5DOQ1MCIAe24mvlsuwIIxPb10+uXDQ4uWz/9m3rj+ql7p6bufZARuPVq5tXtsn6KwfP8Jy0TeWOyNhUJN6mhX5rkUTtUppQWEMNTqEdaCGKFYKJaQrCE4JtDLYOlNEKmO5kBTPGY2A0N2sY3+dVlo1N9ycBsIGtOjQ2p/tlZvzo0ur4v6cOh8NTospB7U/X40KahoU3bGIH97dnwmtHlYffVG3R1YOwKM2vNhrPhCT5zk64sG53oS4b31aYjqe/B7+kQiXBN+b6h21hNUPMq29B8CU4elINdygMPKF1B+WBTG7Z9ZshpN/xwEuuDQZR+nuoo4CDaAiiwXmLpmukMQyPf/JMclqgL1ixZQ/nnP2VbdUODFGt2fgBvL123rlLYu/6A9ckb7F3K0/CyBMEu6aQoPscroCcacVehvyQyCZAsizsWWBkoLC+WAiWnOksLKaeuQDzGuqSk42aiYTiJ4zf9afl17SrqaTO1f+XlZAfIuYcq7/IqYMaMrksOJ6vHkOCPDq943xcCnHqVD9pHFRpMqSPXrIua1WNs+tOz1U+ciTCDpPk+c4QYJIHnYhxP/kVPAq+ahFpVhPcHp8qyarhiF+HsBU9Hrl+UZa876fbKipL0KqB6OdUveErgtOI97fZ63ae9SvWU6k2w1JfwqnUbHsYcFCJFrC/W12zIMMirWYEHxMPs6LGYSdkSZ5TsNP9PCpwnWC3HKZ1lydNjWHC2Mn3l6vL0dHn1ldP3LTSrX+vKrBqv7KmMr8p0SR6P1NqF63or6XRlIyO90f7+kf7+myOhvt4tq7f09oUiTc2/dycGgqFQcCDRLYmi1NL7fk0CknVMxEg/cdfs/TnpJMNkgqwj17B8beVazSrVbU4lG67IZYOCnWrYy3yBR9cyWcChywos3LJBEdhhFoAdYjiw0rLGm0xU5OzoGm5/ZfmHjVZpNNg6SznzGKDdwv2cCtVn6Eaxo12cfxLprpVtTcZ6hVx6dow7Yq7e8LXO8PY9Jgjoze9yCtU5FNbegcKkQMdCbt9au/te4Ebe0jkc0ukUL32eYnTpNs20h0KpUOhZPYwVcfhZnfdqeCvDfXiuCbAoYWcXERPc/mDQD3/hdF+wK4i/xv3kYfprIpAuMkk2kW3kdtS0kBIKpZwp8KxmsCyfM1MFzAss9LBkDxRyThiaqTLwKYKJVTwmWTudMyz+yks09346MDh4m72yOxCKrt1XMlQ1qPVlTEVVQ1ofdK/sCWjtZu9qGwZ8YZ9PPWlo1IV3eW3+U0aXblP39zrt+JPf6UhEQ1rUjNBULN+utyuaDNW34kpAVuSOeMTyWbSNWnooFu+QFNWQ4d/Ox4IPWx41fP/fB/Rjeoz08ezPA9TysMtmnOXfGN7Ui3xIYLDALrlDLOP09qtJuY2OeL0+QZXdRnR1nxRVBF/SOyKKPpcrn9mWzH4rH9IidE+PTNU2182+hOgSItrE1slByS24vaLvJpxOqe4Pduf3HJkZ+jLqUz9rRzB7p8gKcgWZwV1L8JtUS5Z2JxZSOCuBoMTQihMzLbCPA0KqGMAljRQjONklW/wjnXKy8vxT/Elvm3/KiMUMOoV0/vnDYlhec0SMKtt3/kKMyOt33tj2bqxQLsTjSGLl+EAsNhCnTyRGktW55EgCn/A4PlnWn+Mg8bgZrWqHxTbPwMuyy1u5YeZF2SUM7JRhddwRgiRuxpmgJmxn9ZW7XpcF3ViX/ar6ptRpGJ0S9Adg4qhb9sI3vbL7qNJV/y4i07t5TZBiho1imFoMz3gED+CtjYUxvP4SOxov4bFoNPg5aR1e+G4UgDPoedJTpogyCJ7oYvRqoVS0MQAy+CoNEdTDUjok5ZHZL/WtjV7rFj3PKQE3iKp7ou+rIxN3b9LB1dGjeT4cvKo3FrnWpYpuaFd/h3dtV8UeKN1Y9hpR3dt4p0H/zKuPQq0kZQUIIpuDfoiETsnIk+gCWMJZUXHtE8V9LkUc2TE8vOMbO4ax/MACabzyaGXc7u3FBr11ThBdB8SIeMAlCntG2KThHSPsaj2Dc9KNyY2a0KZ7ODaTHoRiFkeYz+shZBpCS4X6471KKKnuHd84edfk5F37d1XO5bbkcltu2ZLNbvnPXiUVAnVvprJrP+NObryjxrllS65md6Tm6wzFHRR4dY3QUUjb7MgxaIixU8hspi98fl/Xc+IB4iU66eCVL9YfAfahiSUt4TONS8x0D8W7u8vd3fGWx6OXlM/U1IoU/s61PGhpyXRFa3eReq2qG56lvmYtXavCC1iN7lbiBpWxXHU+cSlztVLVz0tVN600fVsLxaVDknhYioeoXP3t4lqV1r79MAw0GCI1FTL1YIGzPL1MMlJ9ZsN9P7lvA2yr9ZFUzwzPrVgxN/x/SS+chwB4nGNgZGBgAOLPrYdY4vltvjJwM78AijDUqG5oRND/XzNPZboF5HIwMIFEAU/lC+J4nGNgZGBgDvqfBSRfMAAB81QGRgZUoA0AVvYDbwAAAHicY2BgYGB+MTQwAM8EJo8AAAAAAE4AmgDoAQoBLAFOAXABmgHEAe4CGgKcAugEmgS8BNYE8gUOBSoFegXQBf4GRAZmBrYHGAeQCBgIUghqCP4JRgm+CdoKBAo+CoQKugr0C1QLmgvAeJxjYGRgYNBmTGEQZQABJiDmAkIGhv9gPgMAGJQBvAB4nG2RPU7DMBiG3/QP0UoIBGJh8QILavozdmRo9w7d09RpUzlx5LgVvQMn4BAcgoEzcAgOwVvzSZVQbcnf48fvFysJgGt8IcJxROiG9TgauODuj5ukG+EW+UG4jR4ehTv0Q+EunjER7uEWmk+IWpc0d3gVbuAKb8JN+nfhFvlDuI17fAp36L+Fu1jgR7iHp+jF7Arbz1Nb1nO93pnEncSJFtrVuS3VKB6e5EyX2iVer9TyoOr9eux9pjJnCzW1pdfGWFU5u9WpjzfeV5PBIBMfp7aAwQ4FLPrIkbKWqDHn+67pDRK4s4lzbsEux5qHvcIIMb/nueSMyTKkE3jWFdNLHLjW2PPmMa1Hxn3GjGW/wjT0HtOG09JU4WxLk9LH2ISuiv9twJn9y8fh9uIXI+BknAAAAHicbY7ZboMwEEW5CVBCSLrv+76kfJRjTwHFsdGAG+Xvy5JUfehIHp0rnxmNN/D6ir3/a4YBhvARIMQOIowQY4wEE0yxiz3s4wCHOMIxTnCKM5zjApe4wjVucIs73OMBj3jCM17wije84wMzfHqJ0EVmUkmmJo77oOmrHvfIRZbXsTCZplTZldlgb3TYGVHProwFs11t1A57tcON2rErR3PBqcwF1/6ctI6k0GSU4JHMSS6WghdJQ99sTbfuN7QLJ9vQ37dNrgyktnIxlDYLJNuqitpRbYWKFNuyDT6pog6oOYKHtKakeakqKjHXpPwlGRcsC+OqxLIiJpXqoqqDMreG2l5bv9Ri3TRX+c23DZna9WFFgmXuO6Ps1Jm/w6ErW8N3FbHn/QC444j0AA==)
      format('woff');
    font-weight: normal;
    font-style: normal;
  }

  html {
    --lumo-icons-align-center: '\\ea01';
    --lumo-icons-align-left: '\\ea02';
    --lumo-icons-align-right: '\\ea03';
    --lumo-icons-angle-down: '\\ea04';
    --lumo-icons-angle-left: '\\ea05';
    --lumo-icons-angle-right: '\\ea06';
    --lumo-icons-angle-up: '\\ea07';
    --lumo-icons-arrow-down: '\\ea08';
    --lumo-icons-arrow-left: '\\ea09';
    --lumo-icons-arrow-right: '\\ea0a';
    --lumo-icons-arrow-up: '\\ea0b';
    --lumo-icons-bar-chart: '\\ea0c';
    --lumo-icons-bell: '\\ea0d';
    --lumo-icons-calendar: '\\ea0e';
    --lumo-icons-checkmark: '\\ea0f';
    --lumo-icons-chevron-down: '\\ea10';
    --lumo-icons-chevron-left: '\\ea11';
    --lumo-icons-chevron-right: '\\ea12';
    --lumo-icons-chevron-up: '\\ea13';
    --lumo-icons-clock: '\\ea14';
    --lumo-icons-cog: '\\ea15';
    --lumo-icons-cross: '\\ea16';
    --lumo-icons-download: '\\ea17';
    --lumo-icons-dropdown: '\\ea18';
    --lumo-icons-edit: '\\ea19';
    --lumo-icons-error: '\\ea1a';
    --lumo-icons-eye: '\\ea1b';
    --lumo-icons-eye-disabled: '\\ea1c';
    --lumo-icons-menu: '\\ea1d';
    --lumo-icons-minus: '\\ea1e';
    --lumo-icons-ordered-list: '\\ea1f';
    --lumo-icons-phone: '\\ea20';
    --lumo-icons-photo: '\\ea21';
    --lumo-icons-play: '\\ea22';
    --lumo-icons-plus: '\\ea23';
    --lumo-icons-redo: '\\ea24';
    --lumo-icons-reload: '\\ea25';
    --lumo-icons-search: '\\ea26';
    --lumo-icons-undo: '\\ea27';
    --lumo-icons-unordered-list: '\\ea28';
    --lumo-icons-upload: '\\ea29';
    --lumo-icons-user: '\\ea2a';
  }
`;dOt("font-icons",mOt);
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const yOt=UEt`
  :host {
    --lumo-size-xs: 1.625rem;
    --lumo-size-s: 1.875rem;
    --lumo-size-m: 2.25rem;
    --lumo-size-l: 2.75rem;
    --lumo-size-xl: 3.5rem;

    /* Icons */
    --lumo-icon-size-s: 1.25em;
    --lumo-icon-size-m: 1.5em;
    --lumo-icon-size-l: 2.25em;
    /* For backwards compatibility */
    --lumo-icon-size: var(--lumo-icon-size-m);
  }
`;dOt("sizing-props",yOt);
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const gOt=UEt`
  :host {
    /* Square */
    --lumo-space-xs: 0.25rem;
    --lumo-space-s: 0.5rem;
    --lumo-space-m: 1rem;
    --lumo-space-l: 1.5rem;
    --lumo-space-xl: 2.5rem;

    /* Wide */
    --lumo-space-wide-xs: calc(var(--lumo-space-xs) / 2) var(--lumo-space-xs);
    --lumo-space-wide-s: calc(var(--lumo-space-s) / 2) var(--lumo-space-s);
    --lumo-space-wide-m: calc(var(--lumo-space-m) / 2) var(--lumo-space-m);
    --lumo-space-wide-l: calc(var(--lumo-space-l) / 2) var(--lumo-space-l);
    --lumo-space-wide-xl: calc(var(--lumo-space-xl) / 2) var(--lumo-space-xl);

    /* Tall */
    --lumo-space-tall-xs: var(--lumo-space-xs) calc(var(--lumo-space-xs) / 2);
    --lumo-space-tall-s: var(--lumo-space-s) calc(var(--lumo-space-s) / 2);
    --lumo-space-tall-m: var(--lumo-space-m) calc(var(--lumo-space-m) / 2);
    --lumo-space-tall-l: var(--lumo-space-l) calc(var(--lumo-space-l) / 2);
    --lumo-space-tall-xl: var(--lumo-space-xl) calc(var(--lumo-space-xl) / 2);
  }
`;dOt("spacing-props",gOt);
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const vOt=UEt`
  :host {
    /* Border radius */
    --lumo-border-radius-s: 0.25em; /* Checkbox, badge, date-picker year indicator, etc */
    --lumo-border-radius-m: var(--lumo-border-radius, 0.25em); /* Button, text field, menu overlay, etc */
    --lumo-border-radius-l: 0.5em; /* Dialog, notification, etc */

    /* Shadow */
    --lumo-box-shadow-xs: 0 1px 4px -1px var(--lumo-shade-50pct);
    --lumo-box-shadow-s: 0 2px 4px -1px var(--lumo-shade-20pct), 0 3px 12px -1px var(--lumo-shade-30pct);
    --lumo-box-shadow-m: 0 2px 6px -1px var(--lumo-shade-20pct), 0 8px 24px -4px var(--lumo-shade-40pct);
    --lumo-box-shadow-l: 0 3px 18px -2px var(--lumo-shade-20pct), 0 12px 48px -6px var(--lumo-shade-40pct);
    --lumo-box-shadow-xl: 0 4px 24px -3px var(--lumo-shade-20pct), 0 18px 64px -8px var(--lumo-shade-40pct);

    /* Clickable element cursor */
    --lumo-clickable-cursor: default;
  }
`;UEt`
  html {
    /* Button */
    --vaadin-button-background: var(--lumo-contrast-5pct);
    --vaadin-button-border: none;
    --vaadin-button-border-radius: var(--lumo-border-radius-m);
    --vaadin-button-font-size: var(--lumo-font-size-m);
    --vaadin-button-font-weight: 500;
    --vaadin-button-height: var(--lumo-size-m);
    --vaadin-button-margin: var(--lumo-space-xs) 0;
    --vaadin-button-min-width: calc(var(--vaadin-button-height) * 2);
    --vaadin-button-padding: 0 calc(var(--vaadin-button-height) / 3 + var(--lumo-border-radius-m) / 2);
    --vaadin-button-text-color: var(--lumo-primary-text-color);
    --vaadin-button-primary-background: var(--lumo-primary-color);
    --vaadin-button-primary-border: none;
    --vaadin-button-primary-font-weight: 600;
    --vaadin-button-primary-text-color: var(--lumo-primary-contrast-color);
    --vaadin-button-tertiary-background: transparent !important;
    --vaadin-button-tertiary-text-color: var(--lumo-primary-text-color);
    --vaadin-button-tertiary-font-weight: 500;
    --vaadin-button-tertiary-padding: 0 calc(var(--vaadin-button-height) / 6);
    /* Checkbox */
    --vaadin-checkbox-background: var(--lumo-contrast-20pct);
    --vaadin-checkbox-background-hover: var(--lumo-contrast-30pct);
    --vaadin-checkbox-border-radius: var(--lumo-border-radius-s);
    --vaadin-checkbox-checkmark-char: var(--lumo-icons-checkmark);
    --vaadin-checkbox-checkmark-char-indeterminate: '';
    --vaadin-checkbox-checkmark-color: var(--lumo-primary-contrast-color);
    --vaadin-checkbox-checkmark-size: calc(var(--vaadin-checkbox-size) + 2px);
    --vaadin-checkbox-label-color: var(--lumo-body-text-color);
    --vaadin-checkbox-label-font-size: var(--lumo-font-size-m);
    --vaadin-checkbox-label-padding: var(--lumo-space-xs) var(--lumo-space-s) var(--lumo-space-xs) var(--lumo-space-xs);
    --vaadin-checkbox-size: calc(var(--lumo-size-m) / 2);
    --vaadin-checkbox-disabled-checkmark-color: var(--lumo-contrast-30pct);
    --vaadin-checkbox-disabled-background: var(--lumo-contrast-10pct);
    /* Radio button */
    --vaadin-radio-button-background: var(--lumo-contrast-20pct);
    --vaadin-radio-button-background-hover: var(--lumo-contrast-30pct);
    --vaadin-radio-button-dot-color: var(--lumo-primary-contrast-color);
    --vaadin-radio-button-dot-size: 3px;
    --vaadin-radio-button-label-color: var(--lumo-body-text-color);
    --vaadin-radio-button-label-font-size: var(--lumo-font-size-m);
    --vaadin-radio-button-label-padding: var(--lumo-space-xs) var(--lumo-space-s) var(--lumo-space-xs)
      var(--lumo-space-xs);
    --vaadin-radio-button-size: calc(var(--lumo-size-m) / 2);
    --vaadin-radio-button-disabled-background: var(--lumo-contrast-10pct);
    --vaadin-radio-button-disabled-dot-color: var(--lumo-contrast-30pct);
    --vaadin-selection-color: var(--lumo-primary-color);
    --vaadin-selection-color-text: var(--lumo-primary-text-color);
    --vaadin-input-field-border-radius: var(--lumo-border-radius-m);
    --vaadin-focus-ring-color: var(--lumo-primary-color-50pct);
    --vaadin-focus-ring-width: 2px;
    /* Label */
    --vaadin-input-field-label-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-focused-label-color: var(--lumo-primary-text-color);
    --vaadin-input-field-hovered-label-color: var(--lumo-body-text-color);
    --vaadin-input-field-label-font-size: var(--lumo-font-size-s);
    --vaadin-input-field-label-font-weight: 500;
    /* Helper */
    --vaadin-input-field-helper-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-helper-font-size: var(--lumo-font-size-xs);
    --vaadin-input-field-helper-font-weight: 400;
    --vaadin-input-field-helper-spacing: 0.4em;
    /* Error message */
    --vaadin-input-field-error-color: var(--lumo-error-text-color);
    --vaadin-input-field-error-font-size: var(--lumo-font-size-xs);
    --vaadin-input-field-error-font-weight: 400;
    /* Input field */
    --vaadin-input-field-background: var(--lumo-contrast-10pct);
    --vaadin-input-field-icon-color: var(--lumo-contrast-60pct);
    --vaadin-input-field-icon-size: var(--lumo-icon-size-m);
    --vaadin-input-field-invalid-background: var(--lumo-error-color-10pct);
    --vaadin-input-field-invalid-hover-highlight: var(--lumo-error-color-50pct);
    --vaadin-input-field-disabled-background: var(--lumo-contrast-5pct);
    --vaadin-input-field-disabled-value-color: var(--lumo-disabled-text-color);
    --vaadin-input-field-height: var(--lumo-size-m);
    --vaadin-input-field-hover-highlight: var(--lumo-contrast-50pct);
    --vaadin-input-field-placeholder-color: var(--lumo-secondary-text-color);
    --vaadin-input-field-readonly-border: 1px dashed var(--lumo-contrast-30pct);
    --vaadin-input-field-value-color: var(--lumo-body-text-color);
    --vaadin-input-field-value-font-size: var(--lumo-font-size-m);
    --vaadin-input-field-value-font-weight: 400;
  }
`;dOt("style-props",vOt);
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const wOt=UEt`
  :host {
    /* prettier-ignore */
    --lumo-font-family: -apple-system, BlinkMacSystemFont, 'Roboto', 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';

    /* Font sizes */
    --lumo-font-size-xxs: 0.75rem;
    --lumo-font-size-xs: 0.8125rem;
    --lumo-font-size-s: 0.875rem;
    --lumo-font-size-m: 1rem;
    --lumo-font-size-l: 1.125rem;
    --lumo-font-size-xl: 1.375rem;
    --lumo-font-size-xxl: 1.75rem;
    --lumo-font-size-xxxl: 2.5rem;

    /* Line heights */
    --lumo-line-height-xs: 1.25;
    --lumo-line-height-s: 1.375;
    --lumo-line-height-m: 1.625;
  }
`;const bOt=UEt`
  body,
  :host {
    font-family: var(--lumo-font-family);
    font-size: var(--lumo-font-size-m);
    line-height: var(--lumo-line-height-m);
    -webkit-text-size-adjust: 100%;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  small,
  [theme~='font-size-s'] {
    font-size: var(--lumo-font-size-s);
    line-height: var(--lumo-line-height-s);
  }

  [theme~='font-size-xs'] {
    font-size: var(--lumo-font-size-xs);
    line-height: var(--lumo-line-height-xs);
  }

  :where(h1, h2, h3, h4, h5, h6) {
    font-weight: 600;
    line-height: var(--lumo-line-height-xs);
    margin-block: 0;
  }

  :where(h1) {
    font-size: var(--lumo-font-size-xxxl);
  }

  :where(h2) {
    font-size: var(--lumo-font-size-xxl);
  }

  :where(h3) {
    font-size: var(--lumo-font-size-xl);
  }

  :where(h4) {
    font-size: var(--lumo-font-size-l);
  }

  :where(h5) {
    font-size: var(--lumo-font-size-m);
  }

  :where(h6) {
    font-size: var(--lumo-font-size-xs);
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  p,
  blockquote {
    margin-top: 0.5em;
    margin-bottom: 0.75em;
  }

  a {
    text-decoration: none;
  }

  a:where(:any-link):hover {
    text-decoration: underline;
  }

  hr {
    display: block;
    align-self: stretch;
    height: 1px;
    border: 0;
    padding: 0;
    margin: var(--lumo-space-s) calc(var(--lumo-border-radius-m) / 2);
    background-color: var(--lumo-contrast-10pct);
  }

  blockquote {
    border-left: 2px solid var(--lumo-contrast-30pct);
  }

  b,
  strong {
    font-weight: 600;
  }

  /* RTL specific styles */
  blockquote[dir='rtl'] {
    border-left: none;
    border-right: 2px solid var(--lumo-contrast-30pct);
  }
`;rOt("",bOt,{moduleId:"lumo-typography"});dOt("typography-props",wOt);rOt("vaadin-grid",UEt`
    :host {
      font-family: var(--lumo-font-family);
      font-size: var(--lumo-font-size-m);
      line-height: var(--lumo-line-height-s);
      color: var(--lumo-body-text-color);
      background-color: var(--lumo-base-color);
      box-sizing: border-box;
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
      --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
      /* For internal use only */
      --_lumo-grid-border-color: var(--lumo-contrast-20pct);
      --_lumo-grid-secondary-border-color: var(--lumo-contrast-10pct);
      --_lumo-grid-border-width: 1px;
      --_lumo-grid-selected-row-color: var(--lumo-primary-color-10pct);
    }

    /* No (outer) border */

    :host(:not([theme~='no-border'])) {
      border: var(--_lumo-grid-border-width) solid var(--_lumo-grid-border-color);
    }

    :host([disabled]) {
      opacity: 0.7;
    }

    /* Cell styles */

    [part~='cell'] {
      min-height: var(--lumo-size-m);
      background-color: var(--vaadin-grid-cell-background, var(--lumo-base-color));
      cursor: default;
      --_cell-padding: var(--vaadin-grid-cell-padding, var(--_cell-default-padding));
      --_cell-default-padding: var(--lumo-space-xs) var(--lumo-space-m);
    }

    [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      cursor: inherit;
      padding: var(--_cell-padding);
    }

    /* Apply row borders by default and introduce the "no-row-borders" variant */
    :host(:not([theme~='no-row-borders'])) [part~='cell']:not([part~='details-cell']) {
      border-top: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    /* Hide first body row top border */
    :host(:not([theme~='no-row-borders'])) [part~='first-row'] [part~='cell']:not([part~='details-cell']) {
      border-top: 0;
      min-height: calc(var(--lumo-size-m) - var(--_lumo-grid-border-width));
    }

    /* Focus-ring */

    [part~='row'] {
      position: relative;
    }

    [part~='row']:focus,
    [part~='focused-cell']:focus {
      outline: none;
    }

    :host([navigating]) [part~='row']:focus::before,
    :host([navigating]) [part~='focused-cell']:focus::before {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
    }

    :host([navigating]) [part~='row']:focus::before {
      transform: translateX(calc(-1 * var(--_grid-horizontal-scroll-position)));
      z-index: 3;
    }

    /* Empty state */
    [part~='empty-state'] {
      padding: var(--lumo-space-m);
      color: var(--lumo-secondary-text-color);
    }

    /* Drag and Drop styles */
    :host([dragover])::after {
      content: '';
      position: absolute;
      z-index: 100;
      inset: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 var(--_focus-ring-width) var(--_focus-ring-color);
    }

    [part~='row'][dragover] {
      z-index: 100 !important;
    }

    [part~='row'][dragover] [part~='cell'] {
      overflow: visible;
    }

    [part~='row'][dragover] [part~='cell']::after {
      content: '';
      position: absolute;
      inset: 0;
      height: calc(var(--_lumo-grid-border-width) + 2px);
      pointer-events: none;
      background: var(--lumo-primary-color-50pct);
    }

    [part~='row'][dragover] [part~='cell'][last-frozen]::after {
      right: -1px;
    }

    :host([theme~='no-row-borders']) [dragover] [part~='cell']::after {
      height: 2px;
    }

    [part~='row'][dragover='below'] [part~='cell']::after {
      top: 100%;
      bottom: auto;
      margin-top: -1px;
    }

    :host([all-rows-visible]) [part~='last-row'][dragover='below'] [part~='cell']::after {
      height: 1px;
    }

    [part~='row'][dragover='above'] [part~='cell']::after {
      top: auto;
      bottom: 100%;
      margin-bottom: -1px;
    }

    [part~='row'][details-opened][dragover='below'] [part~='cell']:not([part~='details-cell'])::after,
    [part~='row'][details-opened][dragover='above'] [part~='details-cell']::after {
      display: none;
    }

    [part~='row'][dragover][dragover='on-top'] [part~='cell']::after {
      height: 100%;
      opacity: 0.5;
    }

    [part~='row'][dragstart] [part~='cell'] {
      border: none !important;
      box-shadow: none !important;
    }

    [part~='row'][dragstart] [part~='cell'][last-column] {
      border-radius: 0 var(--lumo-border-radius-s) var(--lumo-border-radius-s) 0;
    }

    [part~='row'][dragstart] [part~='cell'][first-column] {
      border-radius: var(--lumo-border-radius-s) 0 0 var(--lumo-border-radius-s);
    }

    #scroller [part~='row'][dragstart]:not([dragstart=''])::after {
      display: block;
      position: absolute;
      left: var(--_grid-drag-start-x);
      top: var(--_grid-drag-start-y);
      z-index: 100;
      content: attr(dragstart);
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      padding: calc(var(--lumo-space-xs) * 0.8);
      color: var(--lumo-error-contrast-color);
      background-color: var(--lumo-error-color);
      border-radius: var(--lumo-border-radius-m);
      font-family: var(--lumo-font-family);
      font-size: var(--lumo-font-size-xxs);
      line-height: 1;
      font-weight: 500;
      text-transform: initial;
      letter-spacing: initial;
      min-width: calc(var(--lumo-size-s) * 0.7);
      text-align: center;
    }

    /* Headers and footers */

    [part~='header-cell'],
    [part~='footer-cell'],
    [part~='reorder-ghost'] {
      font-size: var(--lumo-font-size-s);
      font-weight: 500;
    }

    [part~='footer-cell'] {
      font-weight: 400;
    }

    [part~='row']:only-child [part~='header-cell'] {
      min-height: var(--lumo-size-xl);
    }

    /* Header borders */

    /* Hide first header row top border */
    :host(:not([theme~='no-row-borders'])) [part~='row']:first-child [part~='header-cell'] {
      border-top: 0;
    }

    /* Hide header row top border if previous row is hidden */
    [part~='row'][hidden] + [part~='row'] [part~='header-cell'] {
      border-top: 0;
    }

    [part~='row']:last-child [part~='header-cell'] {
      border-bottom: var(--_lumo-grid-border-width) solid transparent;
    }

    :host(:not([theme~='no-row-borders'])) [part~='row']:last-child [part~='header-cell'] {
      border-bottom-color: var(--_lumo-grid-secondary-border-color);
    }

    /* Overflow uses a stronger border color */
    :host([overflow~='top']) [part~='row']:last-child [part~='header-cell'] {
      border-bottom-color: var(--_lumo-grid-border-color);
    }

    /* Footer borders */

    [part~='row']:first-child [part~='footer-cell'] {
      border-top: var(--_lumo-grid-border-width) solid transparent;
    }

    :host(:not([theme~='no-row-borders'])) [part~='row']:first-child [part~='footer-cell'] {
      border-top-color: var(--_lumo-grid-secondary-border-color);
    }

    /* Overflow uses a stronger border color */
    :host([overflow~='bottom']) [part~='row']:first-child [part~='footer-cell'] {
      border-top-color: var(--_lumo-grid-border-color);
    }

    /* Column reordering */

    :host([reordering]) [part~='cell'] {
      background: linear-gradient(var(--lumo-shade-20pct), var(--lumo-shade-20pct)) var(--lumo-base-color);
    }

    :host([reordering]) [part~='cell'][reorder-status='allowed'] {
      background: var(--lumo-base-color);
    }

    :host([reordering]) [part~='cell'][reorder-status='dragging'] {
      background: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct)) var(--lumo-base-color);
    }

    [part~='reorder-ghost'] {
      opacity: 0.85;
      box-shadow: var(--lumo-box-shadow-s);
      /* TODO Use the same styles as for the cell element (reorder-ghost copies styles from the cell element) */
      padding: var(--lumo-space-s) var(--lumo-space-m) !important;
    }

    /* Column resizing */

    [part='resize-handle'] {
      --_resize-handle-width: 3px;
      width: var(--_resize-handle-width);
      background-color: var(--lumo-primary-color-50pct);
      opacity: 0;
      transition: opacity 0.2s;
    }

    [part='resize-handle']::before {
      transform: translateX(calc(-50% + var(--_resize-handle-width) / 2));
      width: var(--lumo-size-s);
    }

    :host(:not([reordering])) *:not([column-resizing]) [part~='cell']:hover [part='resize-handle'],
    [part='resize-handle']:active {
      opacity: 1;
      transition-delay: 0.15s;
    }

    /* Column borders */

    :host([theme~='column-borders']) [part~='cell']:not([last-column]):not([part~='details-cell']) {
      border-right: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    /* Frozen columns */

    [last-frozen] {
      border-right: var(--_lumo-grid-border-width) solid transparent;
      overflow: hidden;
    }

    :host([overflow~='start']) [part~='cell'][last-frozen]:not([part~='details-cell']) {
      border-right-color: var(--_lumo-grid-border-color);
    }

    [first-frozen-to-end] {
      border-left: var(--_lumo-grid-border-width) solid transparent;
    }

    :host([overflow~='end']) [part~='cell'][first-frozen-to-end]:not([part~='details-cell']) {
      border-left-color: var(--_lumo-grid-border-color);
    }

    /* Row stripes */

    :host([theme~='row-stripes']) [part~='even-row'] [part~='body-cell'],
    :host([theme~='row-stripes']) [part~='even-row'] [part~='details-cell'] {
      background-image: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct));
      background-repeat: repeat-x;
    }

    /* Selected row */

    /* Raise the selected rows above unselected rows (so that box-shadow can cover unselected rows) */
    :host(:not([reordering])) [part~='row'][selected] {
      z-index: 1;
    }

    :host(:not([reordering])) [part~='row'][selected] [part~='body-cell']:not([part~='details-cell']) {
      background-image: linear-gradient(var(--_lumo-grid-selected-row-color), var(--_lumo-grid-selected-row-color));
      background-repeat: repeat;
    }

    /* Cover the border of an unselected row */
    :host(:not([theme~='no-row-borders'])) [part~='row'][selected] [part~='cell']:not([part~='details-cell']) {
      box-shadow: 0 var(--_lumo-grid-border-width) 0 0 var(--_lumo-grid-selected-row-color);
    }

    /* Compact */

    :host([theme~='compact']) [part~='row']:only-child [part~='header-cell'] {
      min-height: var(--lumo-size-m);
    }

    :host([theme~='compact']) [part~='cell'] {
      min-height: var(--lumo-size-s);
      --_cell-default-padding: var(--lumo-space-xs) var(--lumo-space-s);
    }

    :host([theme~='compact']) [part~='first-row'] [part~='cell']:not([part~='details-cell']) {
      min-height: calc(var(--lumo-size-s) - var(--_lumo-grid-border-width));
    }

    :host([theme~='compact']) [part~='empty-state'] {
      padding: var(--lumo-space-s);
    }

    /* Wrap cell contents */

    :host([theme~='wrap-cell-content']) [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      white-space: normal;
    }

    /* RTL specific styles */

    :host([dir='rtl']) [part~='row'][dragstart] [part~='cell'][last-column] {
      border-radius: var(--lumo-border-radius-s) 0 0 var(--lumo-border-radius-s);
    }

    :host([dir='rtl']) [part~='row'][dragstart] [part~='cell'][first-column] {
      border-radius: 0 var(--lumo-border-radius-s) var(--lumo-border-radius-s) 0;
    }

    :host([dir='rtl'][theme~='column-borders']) [part~='cell']:not([last-column]):not([part~='details-cell']) {
      border-right: none;
      border-left: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    :host([dir='rtl']) [last-frozen] {
      border-right: none;
      border-left: var(--_lumo-grid-border-width) solid transparent;
    }

    :host([dir='rtl']) [first-frozen-to-end] {
      border-left: none;
      border-right: var(--_lumo-grid-border-width) solid transparent;
    }

    :host([dir='rtl'][overflow~='start']) [part~='cell'][last-frozen]:not([part~='details-cell']) {
      border-left-color: var(--_lumo-grid-border-color);
    }

    :host([dir='rtl'][overflow~='end']) [part~='cell'][first-frozen-to-end]:not([part~='details-cell']) {
      border-right-color: var(--_lumo-grid-border-color);
    }
  `,{moduleId:"lumo-grid"});
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/window.JSCompiler_renameProperty=function(t,e){return t};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let SOt=/(url\()([^)]*)(\))/g;let _Ot=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/;let xOt;let MOt;function TOt(t,e){if(t&&_Ot.test(t)){return t}if(t==="//"){return t}if(xOt===undefined){xOt=false;try{const t=new URL("b","http://a");t.pathname="c%20d";xOt=t.href==="http://a/c%20d"}catch(t){}}if(!e){e=document.baseURI||window.location.href}if(xOt){try{return new URL(t,e).href}catch(e){return t}}if(!MOt){MOt=document.implementation.createHTMLDocument("temp");MOt.base=MOt.createElement("base");MOt.head.appendChild(MOt.base);MOt.anchor=MOt.createElement("a");MOt.body.appendChild(MOt.anchor)}MOt.base.href=e;MOt.anchor.href=t;return MOt.anchor.href||t}function AOt(t,e){return t.replace(SOt,(function(t,i,n,s){return i+"'"+TOt(n.replace(/["']/g,""),e)+"'"+s}))}function IOt(t){return t.substring(0,t.lastIndexOf("/")+1)}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const kOt=!window.ShadyDOM||!window.ShadyDOM.inUse;const COt=kOt&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{const t=new CSSStyleSheet;t.replaceSync("");const e=document.createElement("div");e.attachShadow({mode:"open"});e.shadowRoot.adoptedStyleSheets=[t];return e.shadowRoot.adoptedStyleSheets[0]===t}catch(t){return false}})();let EOt=window.Polymer&&window.Polymer.rootPath||IOt(document.baseURI||window.location.href);let jOt=window.Polymer&&window.Polymer.sanitizeDOMValue||undefined;let OOt=window.Polymer&&window.Polymer.strictTemplatePolicy||false;let ROt=window.Polymer&&window.Polymer.allowTemplateFromDomModule||false;let LOt=window.Polymer&&window.Polymer.legacyOptimizations||false;let NOt=window.Polymer&&window.Polymer.legacyWarnings||false;let POt=window.Polymer&&window.Polymer.syncInitialRender||false;let FOt=window.Polymer&&window.Polymer.legacyUndefined||false;let DOt=window.Polymer&&window.Polymer.orderedComputed||false;let $Ot=window.Polymer&&window.Polymer.removeNestedTemplates||false;let zOt=window.Polymer&&window.Polymer.fastDomIf||false;let UOt=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||false;
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let BOt=0;const GOt=function(t){let e=t.__mixinApplications;if(!e){e=new WeakMap;t.__mixinApplications=e}let i=BOt++;function n(n){let s=n.__mixinSet;if(s&&s[i]){return n}let r=e;let o=r.get(n);if(!o){o=t(n);r.set(n,o);let e=Object.create(o.__mixinSet||s||null);e[i]=true;o.__mixinSet=e}return o}return n};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let VOt={};let qOt={};function HOt(t,e){VOt[t]=qOt[t.toLowerCase()]=e}function WOt(t){return VOt[t]||qOt[t.toLowerCase()]}function ZOt(t){if(t.querySelector("style")){console.warn("dom-module %s has style outside template",t.id)}}class JOt extends HTMLElement{static get observedAttributes(){return["id"]}static import(t,e){if(t){let i=WOt(t);if(i&&e){return i.querySelector(e)}return i}return null}attributeChangedCallback(t,e,i,n){if(e!==i){this.register()}}get assetpath(){if(!this.__assetpath){const t=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument;const e=TOt(this.getAttribute("assetpath")||"",t.baseURI);this.__assetpath=IOt(e)}return this.__assetpath}register(t){t=t||this.id;if(t){if(OOt&&WOt(t)!==undefined){HOt(t,null);throw new Error(`strictTemplatePolicy: dom-module ${t} re-registered`)}this.id=t;HOt(t,this);ZOt(this)}}}JOt.prototype["modules"]=VOt;customElements.define("dom-module",JOt);
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const YOt="link[rel=import][type~=css]";const KOt="include";const QOt="shady-unscoped";function XOt(t){return JOt.import(t)}function tRt(t){let e=t.body?t.body:t;const i=AOt(e.textContent,t.baseURI);const n=document.createElement("style");n.textContent=i;return n}function eRt(t){const e=t.trim().split(/\s+/);const i=[];for(let t=0;t<e.length;t++){i.push(...iRt(e[t]))}return i}function iRt(t){const e=XOt(t);if(!e){console.warn("Could not find style data in module named",t);return[]}if(e._styles===undefined){const t=[];t.push(...rRt(e));const i=e.querySelector("template");if(i){t.push(...nRt(i,e.assetpath))}e._styles=t}return e._styles}function nRt(t,e){if(!t._styles){const i=[];const n=t.content.querySelectorAll("style");for(let t=0;t<n.length;t++){let s=n[t];let r=s.getAttribute(KOt);if(r){i.push(...eRt(r).filter((function(t,e,i){return i.indexOf(t)===e})))}if(e){s.textContent=AOt(s.textContent,e)}i.push(s)}t._styles=i}return t._styles}function sRt(t){let e=XOt(t);return e?rRt(e):[]}function rRt(t){const e=[];const i=t.querySelectorAll(YOt);for(let t=0;t<i.length;t++){let n=i[t];if(n.import){const t=n.import;const i=n.hasAttribute(QOt);if(i&&!t._unscopedStyle){const e=tRt(t);e.setAttribute(QOt,"");t._unscopedStyle=e}else if(!t._style){t._style=tRt(t)}e.push(i?t._unscopedStyle:t._style)}}return e}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const oRt=window["ShadyDOM"]&&window["ShadyDOM"]["noPatch"]&&window["ShadyDOM"]["wrap"]?window["ShadyDOM"]["wrap"]:window["ShadyDOM"]?t=>ShadyDOM["patch"](t):t=>t;
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function aRt(t){return t.indexOf(".")>=0}function lRt(t){let e=t.indexOf(".");if(e===-1){return t}return t.slice(0,e)}function uRt(t,e){return t.indexOf(e+".")===0}function cRt(t,e){return e.indexOf(t+".")===0}function hRt(t,e,i){return e+i.slice(t.length)}function dRt(t){if(Array.isArray(t)){let e=[];for(let i=0;i<t.length;i++){let n=t[i].toString().split(".");for(let t=0;t<n.length;t++){e.push(n[t])}}return e.join(".")}else{return t}}function fRt(t){if(Array.isArray(t)){return dRt(t).split(".")}return t.toString().split(".")}function pRt(t,e,i){let n=t;let s=fRt(e);for(let t=0;t<s.length;t++){if(!n){return}let e=s[t];n=n[e]}if(i){i.path=s.join(".")}return n}function mRt(t,e,i){let n=t;let s=fRt(e);let r=s[s.length-1];if(s.length>1){for(let t=0;t<s.length-1;t++){let e=s[t];n=n[e];if(!n){return}}n[r]=i}else{n[e]=i}return s.join(".")}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const yRt={};const gRt=/-[a-z]/g;const vRt=/([A-Z])/g;function wRt(t){return yRt[t]||(yRt[t]=t.indexOf("-")<0?t:t.replace(gRt,(t=>t[1].toUpperCase())))}function bRt(t){return yRt[t]||(yRt[t]=t.replace(vRt,"-$1").toLowerCase())}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/let SRt=0;let _Rt=0;let xRt=[];let MRt=0;let TRt=false;let ARt=document.createTextNode("");new window.MutationObserver(IRt).observe(ARt,{characterData:true});function IRt(){TRt=false;const t=xRt.length;for(let e=0;e<t;e++){let t=xRt[e];if(t){try{t()}catch(t){setTimeout((()=>{throw t}))}}}xRt.splice(0,t);_Rt+=t}const kRt={run(t){if(!TRt){TRt=true;ARt.textContent=MRt++}xRt.push(t);return SRt++},cancel(t){const e=t-_Rt;if(e>=0){if(!xRt[e]){throw new Error("invalid async handle: "+t)}xRt[e]=null}}};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const CRt=kRt;const ERt=GOt((t=>{class e extends t{static createProperties(t){const e=this.prototype;for(let i in t){if(!(i in e)){e._createPropertyAccessor(i)}}}static attributeNameForProperty(t){return t.toLowerCase()}static typeForProperty(t){}_createPropertyAccessor(t,e){this._addPropertyToAttributeMap(t);if(!this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))){this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)}if(!this.__dataHasAccessor[t]){this.__dataHasAccessor[t]=true;this._definePropertyAccessor(t,e)}}_addPropertyToAttributeMap(t){if(!this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))){this.__dataAttributes=Object.assign({},this.__dataAttributes)}let e=this.__dataAttributes[t];if(!e){e=this.constructor.attributeNameForProperty(t);this.__dataAttributes[e]=t}return e}_definePropertyAccessor(t,e){Object.defineProperty(this,t,{get(){return this.__data[t]},set:e?function(){}:function(e){if(this._setPendingProperty(t,e,true)){this._invalidateProperties()}}})}constructor(){super();this.__dataEnabled=false;this.__dataReady=false;this.__dataInvalid=false;this.__data={};this.__dataPending=null;this.__dataOld=null;this.__dataInstanceProps=null;this.__dataCounter=0;this.__serializing=false;this._initializeProperties()}ready(){this.__dataReady=true;this._flushProperties()}_initializeProperties(){for(let t in this.__dataHasAccessor){if(this.hasOwnProperty(t)){this.__dataInstanceProps=this.__dataInstanceProps||{};this.__dataInstanceProps[t]=this[t];delete this[t]}}}_initializeInstanceProperties(t){Object.assign(this,t)}_setProperty(t,e){if(this._setPendingProperty(t,e)){this._invalidateProperties()}}_getProperty(t){return this.__data[t]}_setPendingProperty(t,e,i){let n=this.__data[t];let s=this._shouldPropertyChange(t,e,n);if(s){if(!this.__dataPending){this.__dataPending={};this.__dataOld={}}if(this.__dataOld&&!(t in this.__dataOld)){this.__dataOld[t]=n}this.__data[t]=e;this.__dataPending[t]=e}return s}_isPropertyPending(t){return!!(this.__dataPending&&this.__dataPending.hasOwnProperty(t))}_invalidateProperties(){if(!this.__dataInvalid&&this.__dataReady){this.__dataInvalid=true;CRt.run((()=>{if(this.__dataInvalid){this.__dataInvalid=false;this._flushProperties()}}))}}_enableProperties(){if(!this.__dataEnabled){this.__dataEnabled=true;if(this.__dataInstanceProps){this._initializeInstanceProperties(this.__dataInstanceProps);this.__dataInstanceProps=null}this.ready()}}_flushProperties(){this.__dataCounter++;const t=this.__data;const e=this.__dataPending;const i=this.__dataOld;if(this._shouldPropertiesChange(t,e,i)){this.__dataPending=null;this.__dataOld=null;this._propertiesChanged(t,e,i)}this.__dataCounter--}_shouldPropertiesChange(t,e,i){return Boolean(e)}_propertiesChanged(t,e,i){}_shouldPropertyChange(t,e,i){return i!==e&&(i===i||e===e)}attributeChangedCallback(t,e,i,n){if(e!==i){this._attributeToProperty(t,i)}if(super.attributeChangedCallback){super.attributeChangedCallback(t,e,i,n)}}_attributeToProperty(t,e,i){if(!this.__serializing){const n=this.__dataAttributes;const s=n&&n[t]||t;this[s]=this._deserializeValue(e,i||this.constructor.typeForProperty(s))}}_propertyToAttribute(t,e,i){this.__serializing=true;i=arguments.length<3?this[t]:i;this._valueToNodeAttribute(this,i,e||this.constructor.attributeNameForProperty(t));this.__serializing=false}_valueToNodeAttribute(t,e,i){const n=this._serializeValue(e);if(i==="class"||i==="name"||i==="slot"){t=oRt(t)}if(n===undefined){t.removeAttribute(i)}else{t.setAttribute(i,n===""&&window.trustedTypes?window.trustedTypes.emptyScript:n)}}_serializeValue(t){switch(typeof t){case"boolean":return t?"":undefined;default:return t!=null?t.toString():undefined}}_deserializeValue(t,e){switch(e){case Boolean:return t!==null;case Number:return Number(t);default:return t}}}return e}));
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const jRt={};let ORt=HTMLElement.prototype;while(ORt){let t=Object.getOwnPropertyNames(ORt);for(let e=0;e<t.length;e++){jRt[t[e]]=true}ORt=Object.getPrototypeOf(ORt)}const RRt=(()=>{if(!window.trustedTypes){return()=>false}return t=>trustedTypes.isHTML(t)||trustedTypes.isScript(t)||trustedTypes.isScriptURL(t)})();function LRt(t,e){if(!jRt[e]){let i=t[e];if(i!==undefined){if(t.__data){t._setPendingProperty(e,i)}else{if(!t.__dataProto){t.__dataProto={}}else if(!t.hasOwnProperty(JSCompiler_renameProperty("__dataProto",t))){t.__dataProto=Object.create(t.__dataProto)}t.__dataProto[e]=i}}}}const NRt=GOt((t=>{const e=ERt(t);class i extends e{static createPropertiesForAttributes(){let t=this.observedAttributes;for(let e=0;e<t.length;e++){this.prototype._createPropertyAccessor(wRt(t[e]))}}static attributeNameForProperty(t){return bRt(t)}_initializeProperties(){if(this.__dataProto){this._initializeProtoProperties(this.__dataProto);this.__dataProto=null}super._initializeProperties()}_initializeProtoProperties(t){for(let e in t){this._setProperty(e,t[e])}}_ensureAttribute(t,e){const i=this;if(!i.hasAttribute(t)){this._valueToNodeAttribute(i,e,t)}}_serializeValue(t){switch(typeof t){case"object":if(t instanceof Date){return t.toString()}else if(t){if(RRt(t)){return t}try{return JSON.stringify(t)}catch(t){return""}}default:return super._serializeValue(t)}}_deserializeValue(t,e){let i;switch(e){case Object:try{i=JSON.parse(t)}catch(e){i=t}break;case Array:try{i=JSON.parse(t)}catch(e){i=null;console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${t}`)}break;case Date:i=isNaN(t)?String(t):Number(t);i=new Date(i);break;default:i=super._deserializeValue(t,e);break}return i}_definePropertyAccessor(t,e){LRt(this,t);super._definePropertyAccessor(t,e)}_hasAccessor(t){return this.__dataHasAccessor&&this.__dataHasAccessor[t]}_isPropertyPending(t){return Boolean(this.__dataPending&&t in this.__dataPending)}}return i}));
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const PRt={"dom-if":true,"dom-repeat":true};let FRt=false;let DRt=false;function $Rt(){if(!FRt){FRt=true;const t=document.createElement("textarea");t.placeholder="a";DRt=t.placeholder===t.textContent}return DRt}function zRt(t){if($Rt()&&t.localName==="textarea"&&t.placeholder&&t.placeholder===t.textContent){t.textContent=null}}const URt=(()=>{const t=window.trustedTypes&&window.trustedTypes.createPolicy("polymer-template-event-attribute-policy",{createScript:t=>t});return(e,i,n)=>{const s=i.getAttribute(n);if(t&&n.startsWith("on-")){e.setAttribute(n,t.createScript(s,n));return}e.setAttribute(n,s)}})();function BRt(t){let e=t.getAttribute("is");if(e&&PRt[e]){let i=t;i.removeAttribute("is");t=i.ownerDocument.createElement(e);i.parentNode.replaceChild(t,i);t.appendChild(i);while(i.attributes.length){const{name:e}=i.attributes[0];URt(t,i,e);i.removeAttribute(e)}}return t}function GRt(t,e){let i=e.parentInfo&&GRt(t,e.parentInfo);if(i){for(let t=i.firstChild,n=0;t;t=t.nextSibling){if(e.parentIndex===n++){return t}}}else{return t}}function VRt(t,e,i,n){if(n.id){e[n.id]=i}}function qRt(t,e,i){if(i.events&&i.events.length){for(let n=0,s=i.events,r;n<s.length&&(r=s[n]);n++){t._addMethodEventListenerToNode(e,r.name,r.value,t)}}}function HRt(t,e,i,n){if(i.templateInfo){e._templateInfo=i.templateInfo;e._parentTemplateInfo=n}}function WRt(t,e,i){t=t._methodHost||t;let n=function(e){if(t[i]){t[i](e,e.detail)}else{console.warn("listener method `"+i+"` not defined")}};return n}const ZRt=GOt((t=>{class e extends t{static _parseTemplate(t,e){if(!t._templateInfo){let i=t._templateInfo={};i.nodeInfoList=[];i.nestedTemplate=Boolean(e);i.stripWhiteSpace=e&&e.stripWhiteSpace||t.hasAttribute&&t.hasAttribute("strip-whitespace");this._parseTemplateContent(t,i,{parent:null})}return t._templateInfo}static _parseTemplateContent(t,e,i){return this._parseTemplateNode(t.content,e,i)}static _parseTemplateNode(t,e,i){let n=false;let s=t;if(s.localName=="template"&&!s.hasAttribute("preserve-content")){n=this._parseTemplateNestedTemplate(s,e,i)||n}else if(s.localName==="slot"){e.hasInsertionPoint=true}zRt(s);if(s.firstChild){this._parseTemplateChildNodes(s,e,i)}if(s.hasAttributes&&s.hasAttributes()){n=this._parseTemplateNodeAttributes(s,e,i)||n}return n||i.noted}static _parseTemplateChildNodes(t,e,i){if(t.localName==="script"||t.localName==="style"){return}for(let n=t.firstChild,s=0,r;n;n=r){if(n.localName=="template"){n=BRt(n)}r=n.nextSibling;if(n.nodeType===Node.TEXT_NODE){let i=r;while(i&&i.nodeType===Node.TEXT_NODE){n.textContent+=i.textContent;r=i.nextSibling;t.removeChild(i);i=r}if(e.stripWhiteSpace&&!n.textContent.trim()){t.removeChild(n);continue}}let o={parentIndex:s,parentInfo:i};if(this._parseTemplateNode(n,e,o)){o.infoIndex=e.nodeInfoList.push(o)-1}if(n.parentNode){s++}}}static _parseTemplateNestedTemplate(t,e,i){let n=t;let s=this._parseTemplate(n,e);let r=s.content=n.content.ownerDocument.createDocumentFragment();r.appendChild(n.content);i.templateInfo=s;return true}static _parseTemplateNodeAttributes(t,e,i){let n=false;let s=Array.from(t.attributes);for(let r=s.length-1,o;o=s[r];r--){n=this._parseTemplateNodeAttribute(t,e,i,o.name,o.value)||n}return n}static _parseTemplateNodeAttribute(t,e,i,n,s){if(n.slice(0,3)==="on-"){t.removeAttribute(n);i.events=i.events||[];i.events.push({name:n.slice(3),value:s});return true}else if(n==="id"){i.id=s;return true}return false}static _contentForTemplate(t){let e=t._templateInfo;return e&&e.content||t.content}_stampTemplate(t,e){if(t&&!t.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate){HTMLTemplateElement.decorate(t)}e=e||this.constructor._parseTemplate(t);let i=e.nodeInfoList;let n=e.content||t.content;let s=document.importNode(n,true);s.__noInsertionPoint=!e.hasInsertionPoint;let r=s.nodeList=new Array(i.length);s.$={};for(let t=0,n=i.length,o;t<n&&(o=i[t]);t++){let i=r[t]=GRt(s,o);VRt(this,s.$,i,o);HRt(this,i,o,e);qRt(this,i,o)}s=s;return s}_addMethodEventListenerToNode(t,e,i,n){n=n||t;let s=WRt(n,e,i);this._addEventListenerToNode(t,e,s);return s}_addEventListenerToNode(t,e,i){t.addEventListener(e,i)}_removeEventListenerFromNode(t,e,i){t.removeEventListener(e,i)}}return e}));
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */let JRt=0;const YRt=[];const KRt={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"};const QRt="__computeInfo";const XRt=/[A-Z]/;function tLt(t,e,i){let n=t[e];if(!n){n=t[e]={}}else if(!t.hasOwnProperty(e)){n=t[e]=Object.create(t[e]);if(i){for(let t in n){let e=n[t];let i=n[t]=Array(e.length);for(let t=0;t<e.length;t++){i[t]=e[t]}}}}return n}function eLt(t,e,i,n,s,r){if(e){let o=false;const a=JRt++;for(let l in i){let u=s?lRt(l):l;let c=e[u];if(c){for(let e=0,u=c.length,h;e<u&&(h=c[e]);e++){if((!h.info||h.info.lastRun!==a)&&(!s||nLt(l,h.trigger))){if(h.info){h.info.lastRun=a}h.fn(t,l,i,n,h.info,s,r);o=true}}}}return o}return false}function iLt(t,e,i,n,s,r,o,a){let l=false;let u=o?lRt(n):n;let c=e[u];if(c){for(let e=0,u=c.length,h;e<u&&(h=c[e]);e++){if((!h.info||h.info.lastRun!==i)&&(!o||nLt(n,h.trigger))){if(h.info){h.info.lastRun=i}h.fn(t,n,s,r,h.info,o,a);l=true}}}return l}function nLt(t,e){if(e){let i=e.name;return i==t||!!(e.structured&&uRt(i,t))||!!(e.wildcard&&cRt(i,t))}else{return true}}function sLt(t,e,i,n,s){let r=typeof s.method==="string"?t[s.method]:s.method;let o=s.property;if(r){r.call(t,t.__data[o],n[o])}else if(!s.dynamicFn){console.warn("observer method `"+s.method+"` not defined")}}function rLt(t,e,i,n,s){let r=t[KRt.NOTIFY];let o;let a=JRt++;for(let l in e){if(e[l]){if(r&&iLt(t,r,a,l,i,n,s)){o=true}else if(s&&oLt(t,l,i)){o=true}}}let l;if(o&&(l=t.__dataHost)&&l._invalidateProperties){l._invalidateProperties()}}function oLt(t,e,i){let n=lRt(e);if(n!==e){let s=bRt(n)+"-changed";aLt(t,s,i[e],e);return true}return false}function aLt(t,e,i,n){let s={value:i,queueProperty:true};if(n){s.path=n}oRt(t).dispatchEvent(new CustomEvent(e,{detail:s}))}function lLt(t,e,i,n,s,r){let o=r?lRt(e):e;let a=o!=e?e:null;let l=a?pRt(t,a):t.__data[e];if(a&&l===undefined){l=i[e]}aLt(t,s.eventName,l,a)}function uLt(t,e,i,n,s){let r;let o=t.detail;let a=o&&o.path;if(a){n=hRt(i,n,a);r=o&&o.value}else{r=t.currentTarget[i]}r=s?!r:r;if(!e[KRt.READ_ONLY]||!e[KRt.READ_ONLY][n]){if(e._setPendingPropertyOrPath(n,r,true,Boolean(a))&&(!o||!o.queueProperty)){e._invalidateProperties()}}}function cLt(t,e,i,n,s){let r=t.__data[e];if(jOt){r=jOt(r,s.attrName,"attribute",t)}t._propertyToAttribute(e,s.attrName,r)}function hLt(t,e,i,n){let s=t[KRt.COMPUTE];if(s){if(DOt){JRt++;const r=pLt(t);const o=[];for(let t in e){fLt(t,s,o,r,n)}let a;while(a=o.shift()){if(yLt(t,"",e,i,a)){fLt(a.methodInfo,s,o,r,n)}}Object.assign(i,t.__dataOld);Object.assign(e,t.__dataPending);t.__dataPending=null}else{let r=e;while(eLt(t,s,r,i,n)){Object.assign(i,t.__dataOld);Object.assign(e,t.__dataPending);r=t.__dataPending;t.__dataPending=null}}}}const dLt=(t,e,i)=>{let n=0;let s=e.length-1;let r=-1;while(n<=s){const o=n+s>>1;const a=i.get(e[o].methodInfo)-i.get(t.methodInfo);if(a<0){n=o+1}else if(a>0){s=o-1}else{r=o;break}}if(r<0){r=s+1}e.splice(r,0,t)};const fLt=(t,e,i,n,s)=>{const r=s?lRt(t):t;const o=e[r];if(o){for(let e=0;e<o.length;e++){const r=o[e];if(r.info.lastRun!==JRt&&(!s||nLt(t,r.trigger))){r.info.lastRun=JRt;dLt(r.info,i,n)}}}};function pLt(t){let e=t.constructor.__orderedComputedDeps;if(!e){e=new Map;const i=t[KRt.COMPUTE];let{counts:n,ready:s,total:r}=mLt(t);let o;while(o=s.shift()){e.set(o,e.size);const t=i[o];if(t){t.forEach((t=>{const e=t.info.methodInfo;--r;if(--n[e]===0){s.push(e)}}))}}if(r!==0){const e=t;console.warn(`Computed graph for ${e.localName} incomplete; circular?`)}t.constructor.__orderedComputedDeps=e}return e}function mLt(t){const e=t[QRt];const i={};const n=t[KRt.COMPUTE];const s=[];let r=0;for(let t in e){const n=e[t];r+=i[t]=n.args.filter((t=>!t.literal)).length+(n.dynamicFn?1:0)}for(let t in n){if(!e[t]){s.push(t)}}return{counts:i,ready:s,total:r}}function yLt(t,e,i,n,s){let r=kLt(t,e,i,n,s);if(r===YRt){return false}let o=s.methodInfo;if(t.__dataHasAccessor&&t.__dataHasAccessor[o]){return t._setPendingProperty(o,r,true)}else{t[o]=r;return false}}function gLt(t,e,i){let n=t.__dataLinkedPaths;if(n){let s;for(let r in n){let o=n[r];if(cRt(r,e)){s=hRt(r,o,e);t._setPendingPropertyOrPath(s,i,true,true)}else if(cRt(o,e)){s=hRt(o,r,e);t._setPendingPropertyOrPath(s,i,true,true)}}}}function vLt(t,e,i,n,s,r,o){i.bindings=i.bindings||[];let a={kind:n,target:s,parts:r,literal:o,isCompound:r.length!==1};i.bindings.push(a);if(xLt(a)){let{event:t,negate:e}=a.parts[0];a.listenerEvent=t||bRt(s)+"-changed";a.listenerNegate=e}let l=e.nodeInfoList.length;for(let i=0;i<a.parts.length;i++){let n=a.parts[i];n.compoundIndex=i;wLt(t,e,a,n,l)}}function wLt(t,e,i,n,s){if(!n.literal){if(i.kind==="attribute"&&i.target[0]==="-"){console.warn("Cannot set attribute "+i.target+' because "-" is not a valid attribute starting character')}else{let r=n.dependencies;let o={index:s,binding:i,part:n,evaluator:t};for(let i=0;i<r.length;i++){let n=r[i];if(typeof n=="string"){n=WLt(n);n.wildcard=true}t._addTemplatePropertyEffect(e,n.rootProperty,{fn:bLt,info:o,trigger:n})}}}}function bLt(t,e,i,n,s,r,o){let a=o[s.index];let l=s.binding;let u=s.part;if(r&&u.source&&e.length>u.source.length&&l.kind=="property"&&!l.isCompound&&a.__isPropertyEffectsClient&&a.__dataHasAccessor&&a.__dataHasAccessor[l.target]){let n=i[e];e=hRt(u.source,l.target,e);if(a._setPendingPropertyOrPath(e,n,false,true)){t._enqueueClient(a)}}else{let o=s.evaluator._evaluateBinding(t,u,e,i,n,r);if(o!==YRt){SLt(t,a,l,u,o)}}}function SLt(t,e,i,n,s){s=_Lt(e,s,i,n);if(jOt){s=jOt(s,i.target,i.kind,e)}if(i.kind=="attribute"){t._valueToNodeAttribute(e,s,i.target)}else{let n=i.target;if(e.__isPropertyEffectsClient&&e.__dataHasAccessor&&e.__dataHasAccessor[n]){if(!e[KRt.READ_ONLY]||!e[KRt.READ_ONLY][n]){if(e._setPendingProperty(n,s)){t._enqueueClient(e)}}}else{t._setUnmanagedPropertyToNode(e,n,s)}}}function _Lt(t,e,i,n){if(i.isCompound){let s=t.__dataCompoundStorage[i.target];s[n.compoundIndex]=e;e=s.join("")}if(i.kind!=="attribute"){if(i.target==="textContent"||i.target==="value"&&(t.localName==="input"||t.localName==="textarea")){e=e==undefined?"":e}}return e}function xLt(t){return Boolean(t.target)&&t.kind!="attribute"&&t.kind!="text"&&!t.isCompound&&t.parts[0].mode==="{"}function MLt(t,e){let{nodeList:i,nodeInfoList:n}=e;if(n.length){for(let e=0;e<n.length;e++){let s=n[e];let r=i[e];let o=s.bindings;if(o){for(let e=0;e<o.length;e++){let i=o[e];TLt(r,i);ALt(r,t,i)}}r.__dataHost=t}}}function TLt(t,e){if(e.isCompound){let i=t.__dataCompoundStorage||(t.__dataCompoundStorage={});let n=e.parts;let s=new Array(n.length);for(let t=0;t<n.length;t++){s[t]=n[t].literal}let r=e.target;i[r]=s;if(e.literal&&e.kind=="property"){if(r==="className"){t=oRt(t)}t[r]=e.literal}}}function ALt(t,e,i){if(i.listenerEvent){let n=i.parts[0];t.addEventListener(i.listenerEvent,(function(t){uLt(t,e,i.target,n.source,n.negate)}))}}function ILt(t,e,i,n,s,r){r=e.static||r&&(typeof r!=="object"||r[e.methodName]);let o={methodName:e.methodName,args:e.args,methodInfo:s,dynamicFn:r};for(let s=0,r;s<e.args.length&&(r=e.args[s]);s++){if(!r.literal){t._addPropertyEffect(r.rootProperty,i,{fn:n,info:o,trigger:r})}}if(r){t._addPropertyEffect(e.methodName,i,{fn:n,info:o})}return o}function kLt(t,e,i,n,s){let r=t._methodHost||t;let o=r[s.methodName];if(o){let n=t._marshalArgs(s.args,e,i);return n===YRt?YRt:o.apply(r,n)}else if(!s.dynamicFn){console.warn("method `"+s.methodName+"` not defined")}}const CLt=[];const ELt="(?:"+"[a-zA-Z_$][\\w.:$\\-*]*"+")";const jLt="(?:"+"[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?"+")";const OLt="(?:"+"'(?:[^'\\\\]|\\\\.)*'"+")";const RLt="(?:"+'"(?:[^"\\\\]|\\\\.)*"'+")";const LLt="(?:"+OLt+"|"+RLt+")";const NLt="(?:("+ELt+"|"+jLt+"|"+LLt+")\\s*"+")";const PLt="(?:"+NLt+"(?:,\\s*"+NLt+")*"+")";const FLt="(?:"+"\\(\\s*"+"(?:"+PLt+"?"+")"+"\\)\\s*"+")";const DLt="("+ELt+"\\s*"+FLt+"?"+")";const $Lt="(\\[\\[|{{)"+"\\s*";const zLt="(?:]]|}})";const ULt="(?:(!)\\s*)?";const BLt=$Lt+ULt+DLt+zLt;const GLt=new RegExp(BLt,"g");function VLt(t){let e="";for(let i=0;i<t.length;i++){let n=t[i].literal;e+=n||""}return e}function qLt(t){let e=t.match(/([^\s]+?)\(([\s\S]*)\)/);if(e){let t=e[1];let i={methodName:t,static:true,args:CLt};if(e[2].trim()){let t=e[2].replace(/\\,/g,"&comma;").split(",");return HLt(t,i)}else{return i}}return null}function HLt(t,e){e.args=t.map((function(t){let i=WLt(t);if(!i.literal){e.static=false}return i}),this);return e}function WLt(t){let e=t.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1");let i={name:e,value:"",literal:false};let n=e[0];if(n==="-"){n=e[1]}if(n>="0"&&n<="9"){n="#"}switch(n){case"'":case'"':i.value=e.slice(1,-1);i.literal=true;break;case"#":i.value=Number(e);i.literal=true;break}if(!i.literal){i.rootProperty=lRt(e);i.structured=aRt(e);if(i.structured){i.wildcard=e.slice(-2)==".*";if(i.wildcard){i.name=e.slice(0,-2)}}}return i}function ZLt(t,e,i){let n=pRt(t,i);if(n===undefined){n=e[i]}return n}function JLt(t,e,i,n){const s={indexSplices:n};if(FOt&&!t._overrideLegacyUndefined){e.splices=s}t.notifyPath(i+".splices",s);t.notifyPath(i+".length",e.length);if(FOt&&!t._overrideLegacyUndefined){s.indexSplices=[]}}function YLt(t,e,i,n,s,r){JLt(t,e,i,[{index:n,addedCount:s,removed:r,object:e,type:"splice"}])}function KLt(t){return t[0].toUpperCase()+t.substring(1)}const QLt=GOt((t=>{const e=ZRt(NRt(t));class i extends e{constructor(){super();this.__isPropertyEffectsClient=true}get PROPERTY_EFFECT_TYPES(){return KRt}_initializeProperties(){super._initializeProperties();this._registerHost();this.__dataClientsReady=false;this.__dataPendingClients=null;this.__dataToNotify=null;this.__dataLinkedPaths=null;this.__dataHasPaths=false;this.__dataCompoundStorage=this.__dataCompoundStorage||null;this.__dataHost=this.__dataHost||null;this.__dataTemp={};this.__dataClientsInitialized=false}_registerHost(){if(XLt.length){let t=XLt[XLt.length-1];t._enqueueClient(this);this.__dataHost=t}}_initializeProtoProperties(t){this.__data=Object.create(t);this.__dataPending=Object.create(t);this.__dataOld={}}_initializeInstanceProperties(t){let e=this[KRt.READ_ONLY];for(let i in t){if(!e||!e[i]){this.__dataPending=this.__dataPending||{};this.__dataOld=this.__dataOld||{};this.__data[i]=this.__dataPending[i]=t[i]}}}_addPropertyEffect(t,e,i){this._createPropertyAccessor(t,e==KRt.READ_ONLY);let n=tLt(this,e,true)[t];if(!n){n=this[e][t]=[]}n.push(i)}_removePropertyEffect(t,e,i){let n=tLt(this,e,true)[t];let s=n.indexOf(i);if(s>=0){n.splice(s,1)}}_hasPropertyEffect(t,e){let i=this[e];return Boolean(i&&i[t])}_hasReadOnlyEffect(t){return this._hasPropertyEffect(t,KRt.READ_ONLY)}_hasNotifyEffect(t){return this._hasPropertyEffect(t,KRt.NOTIFY)}_hasReflectEffect(t){return this._hasPropertyEffect(t,KRt.REFLECT)}_hasComputedEffect(t){return this._hasPropertyEffect(t,KRt.COMPUTE)}_setPendingPropertyOrPath(t,e,i,n){if(n||lRt(Array.isArray(t)?t[0]:t)!==t){if(!n){let i=pRt(this,t);t=mRt(this,t,e);if(!t||!super._shouldPropertyChange(t,e,i)){return false}}this.__dataHasPaths=true;if(this._setPendingProperty(t,e,i)){gLt(this,t,e);return true}}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[t]){return this._setPendingProperty(t,e,i)}else{this[t]=e}}return false}_setUnmanagedPropertyToNode(t,e,i){if(i!==t[e]||typeof i=="object"){if(e==="className"){t=oRt(t)}t[e]=i}}_setPendingProperty(t,e,i){let n=this.__dataHasPaths&&aRt(t);let s=n?this.__dataTemp:this.__data;if(this._shouldPropertyChange(t,e,s[t])){if(!this.__dataPending){this.__dataPending={};this.__dataOld={}}if(!(t in this.__dataOld)){this.__dataOld[t]=this.__data[t]}if(n){this.__dataTemp[t]=e}else{this.__data[t]=e}this.__dataPending[t]=e;if(n||this[KRt.NOTIFY]&&this[KRt.NOTIFY][t]){this.__dataToNotify=this.__dataToNotify||{};this.__dataToNotify[t]=i}return true}return false}_setProperty(t,e){if(this._setPendingProperty(t,e,true)){this._invalidateProperties()}}_invalidateProperties(){if(this.__dataReady){this._flushProperties()}}_enqueueClient(t){this.__dataPendingClients=this.__dataPendingClients||[];if(t!==this){this.__dataPendingClients.push(t)}}_flushClients(){if(!this.__dataClientsReady){this.__dataClientsReady=true;this._readyClients();this.__dataReady=true}else{this.__enableOrFlushClients()}}__enableOrFlushClients(){let t=this.__dataPendingClients;if(t){this.__dataPendingClients=null;for(let e=0;e<t.length;e++){let i=t[e];if(!i.__dataEnabled){i._enableProperties()}else if(i.__dataPending){i._flushProperties()}}}}_readyClients(){this.__enableOrFlushClients()}setProperties(t,e){for(let i in t){if(e||!this[KRt.READ_ONLY]||!this[KRt.READ_ONLY][i]){this._setPendingPropertyOrPath(i,t[i],true)}}this._invalidateProperties()}ready(){this._flushProperties();if(!this.__dataClientsReady){this._flushClients()}if(this.__dataPending){this._flushProperties()}}_propertiesChanged(t,e,i){let n=this.__dataHasPaths;this.__dataHasPaths=false;let s;hLt(this,e,i,n);s=this.__dataToNotify;this.__dataToNotify=null;this._propagatePropertyChanges(e,i,n);this._flushClients();eLt(this,this[KRt.REFLECT],e,i,n);eLt(this,this[KRt.OBSERVE],e,i,n);if(s){rLt(this,s,e,i,n)}if(this.__dataCounter==1){this.__dataTemp={}}}_propagatePropertyChanges(t,e,i){if(this[KRt.PROPAGATE]){eLt(this,this[KRt.PROPAGATE],t,e,i)}if(this.__templateInfo){this._runEffectsForTemplate(this.__templateInfo,t,e,i)}}_runEffectsForTemplate(t,e,i,n){const s=(e,n)=>{eLt(this,t.propertyEffects,e,i,n,t.nodeList);for(let s=t.firstChild;s;s=s.nextSibling){this._runEffectsForTemplate(s,e,i,n)}};if(t.runEffects){t.runEffects(s,e,n)}else{s(e,n)}}linkPaths(t,e){t=dRt(t);e=dRt(e);this.__dataLinkedPaths=this.__dataLinkedPaths||{};this.__dataLinkedPaths[t]=e}unlinkPaths(t){t=dRt(t);if(this.__dataLinkedPaths){delete this.__dataLinkedPaths[t]}}notifySplices(t,e){let i={path:""};let n=pRt(this,t,i);JLt(this,n,i.path,e)}get(t,e){return pRt(e||this,t)}set(t,e,i){if(i){mRt(i,t,e)}else{if(!this[KRt.READ_ONLY]||!this[KRt.READ_ONLY][t]){if(this._setPendingPropertyOrPath(t,e,true)){this._invalidateProperties()}}}}push(t,...e){let i={path:""};let n=pRt(this,t,i);let s=n.length;let r=n.push(...e);if(e.length){YLt(this,n,i.path,s,e.length,[])}return r}pop(t){let e={path:""};let i=pRt(this,t,e);let n=Boolean(i.length);let s=i.pop();if(n){YLt(this,i,e.path,i.length,0,[s])}return s}splice(t,e,i,...n){let s={path:""};let r=pRt(this,t,s);if(e<0){e=r.length-Math.floor(-e)}else if(e){e=Math.floor(e)}let o;if(arguments.length===2){o=r.splice(e)}else{o=r.splice(e,i,...n)}if(n.length||o.length){YLt(this,r,s.path,e,n.length,o)}return o}shift(t){let e={path:""};let i=pRt(this,t,e);let n=Boolean(i.length);let s=i.shift();if(n){YLt(this,i,e.path,0,0,[s])}return s}unshift(t,...e){let i={path:""};let n=pRt(this,t,i);let s=n.unshift(...e);if(e.length){YLt(this,n,i.path,0,e.length,[])}return s}notifyPath(t,e){let i;if(arguments.length==1){let n={path:""};e=pRt(this,t,n);i=n.path}else if(Array.isArray(t)){i=dRt(t)}else{i=t}if(this._setPendingPropertyOrPath(i,e,true,true)){this._invalidateProperties()}}_createReadOnlyProperty(t,e){this._addPropertyEffect(t,KRt.READ_ONLY);if(e){this["_set"+KLt(t)]=function(e){this._setProperty(t,e)}}}_createPropertyObserver(t,e,i){let n={property:t,method:e,dynamicFn:Boolean(i)};this._addPropertyEffect(t,KRt.OBSERVE,{fn:sLt,info:n,trigger:{name:t}});if(i){this._addPropertyEffect(e,KRt.OBSERVE,{fn:sLt,info:n,trigger:{name:e}})}}_createMethodObserver(t,e){let i=qLt(t);if(!i){throw new Error("Malformed observer expression '"+t+"'")}ILt(this,i,KRt.OBSERVE,kLt,null,e)}_createNotifyingProperty(t){this._addPropertyEffect(t,KRt.NOTIFY,{fn:lLt,info:{eventName:bRt(t)+"-changed",property:t}})}_createReflectedProperty(t){let e=this.constructor.attributeNameForProperty(t);if(e[0]==="-"){console.warn("Property "+t+" cannot be reflected to attribute "+e+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.')}else{this._addPropertyEffect(t,KRt.REFLECT,{fn:cLt,info:{attrName:e}})}}_createComputedProperty(t,e,i){let n=qLt(e);if(!n){throw new Error("Malformed computed expression '"+e+"'")}const s=ILt(this,n,KRt.COMPUTE,yLt,t,i);tLt(this,QRt)[t]=s}_marshalArgs(t,e,i){const n=this.__data;const s=[];for(let r=0,o=t.length;r<o;r++){let{name:o,structured:a,wildcard:l,value:u,literal:c}=t[r];if(!c){if(l){const t=cRt(o,e);const s=ZLt(n,i,t?e:o);u={path:t?e:o,value:s,base:t?pRt(n,o):s}}else{u=a?ZLt(n,i,o):n[o]}}if(FOt&&!this._overrideLegacyUndefined&&u===undefined&&t.length>1){return YRt}s[r]=u}return s}static addPropertyEffect(t,e,i){this.prototype._addPropertyEffect(t,e,i)}static createPropertyObserver(t,e,i){this.prototype._createPropertyObserver(t,e,i)}static createMethodObserver(t,e){this.prototype._createMethodObserver(t,e)}static createNotifyingProperty(t){this.prototype._createNotifyingProperty(t)}static createReadOnlyProperty(t,e){this.prototype._createReadOnlyProperty(t,e)}static createReflectedProperty(t){this.prototype._createReflectedProperty(t)}static createComputedProperty(t,e,i){this.prototype._createComputedProperty(t,e,i)}static bindTemplate(t){return this.prototype._bindTemplate(t)}_bindTemplate(t,e){let i=this.constructor._parseTemplate(t);let n=this.__preBoundTemplateInfo==i;if(!n){for(let t in i.propertyEffects){this._createPropertyAccessor(t)}}if(e){i=Object.create(i);i.wasPreBound=n;if(!this.__templateInfo){this.__templateInfo=i}else{const e=t._parentTemplateInfo||this.__templateInfo;const n=e.lastChild;i.parent=e;e.lastChild=i;i.previousSibling=n;if(n){n.nextSibling=i}else{e.firstChild=i}}}else{this.__preBoundTemplateInfo=i}return i}static _addTemplatePropertyEffect(t,e,i){let n=t.hostProps=t.hostProps||{};n[e]=true;let s=t.propertyEffects=t.propertyEffects||{};let r=s[e]=s[e]||[];r.push(i)}_stampTemplate(t,e){e=e||this._bindTemplate(t,true);XLt.push(this);let i=super._stampTemplate(t,e);XLt.pop();e.nodeList=i.nodeList;if(!e.wasPreBound){let t=e.childNodes=[];for(let e=i.firstChild;e;e=e.nextSibling){t.push(e)}}i.templateInfo=e;MLt(this,e);if(this.__dataClientsReady){this._runEffectsForTemplate(e,this.__data,null,false);this._flushClients()}return i}_removeBoundDom(t){const e=t.templateInfo;const{previousSibling:i,nextSibling:n,parent:s}=e;if(i){i.nextSibling=n}else if(s){s.firstChild=n}if(n){n.previousSibling=i}else if(s){s.lastChild=i}e.nextSibling=e.previousSibling=null;let r=e.childNodes;for(let t=0;t<r.length;t++){let e=r[t];oRt(oRt(e).parentNode).removeChild(e)}}static _parseTemplateNode(t,i,n){let s=e._parseTemplateNode.call(this,t,i,n);if(t.nodeType===Node.TEXT_NODE){let e=this._parseBindings(t.textContent,i);if(e){t.textContent=VLt(e)||" ";vLt(this,i,n,"text","textContent",e);s=true}}return s}static _parseTemplateNodeAttribute(t,i,n,s,r){let o=this._parseBindings(r,i);if(o){let e=s;let r="property";if(XRt.test(s)){r="attribute"}else if(s[s.length-1]=="$"){s=s.slice(0,-1);r="attribute"}let a=VLt(o);if(a&&r=="attribute"){if(s=="class"&&t.hasAttribute("class")){a+=" "+t.getAttribute(s)}t.setAttribute(s,a)}if(r=="attribute"&&e=="disable-upgrade$"){t.setAttribute(s,"")}if(t.localName==="input"&&e==="value"){t.setAttribute(e,"")}t.removeAttribute(e);if(r==="property"){s=wRt(s)}vLt(this,i,n,r,s,o,a);return true}else{return e._parseTemplateNodeAttribute.call(this,t,i,n,s,r)}}static _parseTemplateNestedTemplate(t,i,n){let s=e._parseTemplateNestedTemplate.call(this,t,i,n);const r=t.parentNode;const o=n.templateInfo;const a=r.localName==="dom-if";const l=r.localName==="dom-repeat";if($Ot&&(a||l)){r.removeChild(t);n=n.parentInfo;n.templateInfo=o;n.noted=true;s=false}let u=o.hostProps;if(zOt&&a){if(u){i.hostProps=Object.assign(i.hostProps||{},u);if(!$Ot){n.parentInfo.noted=true}}}else{let t="{";for(let e in u){let s=[{mode:t,source:e,dependencies:[e],hostProp:true}];vLt(this,i,n,"property","_host_"+e,s)}}return s}static _parseBindings(t,e){let i=[];let n=0;let s;while((s=GLt.exec(t))!==null){if(s.index>n){i.push({literal:t.slice(n,s.index)})}let r=s[1][0];let o=Boolean(s[2]);let a=s[3].trim();let l=false,u="",c=-1;if(r=="{"&&(c=a.indexOf("::"))>0){u=a.substring(c+2);a=a.substring(0,c);l=true}let h=qLt(a);let d=[];if(h){let{args:t,methodName:i}=h;for(let e=0;e<t.length;e++){let i=t[e];if(!i.literal){d.push(i)}}let n=e.dynamicFns;if(n&&n[i]||h.static){d.push(i);h.dynamicFn=true}}else{d.push(a)}i.push({source:a,mode:r,negate:o,customEvent:l,signature:h,dependencies:d,event:u});n=GLt.lastIndex}if(n&&n<t.length){let e=t.substring(n);if(e){i.push({literal:e})}}if(i.length){return i}else{return null}}static _evaluateBinding(t,e,i,n,s,r){let o;if(e.signature){o=kLt(t,i,n,s,e.signature)}else if(i!=e.source){o=pRt(t,e.source)}else{if(r&&aRt(i)){o=pRt(t,i)}else{o=t.__data[i]}}if(e.negate){o=!o}return o}}return i}));const XLt=[];
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/function tNt(t){const e={};for(let i in t){const n=t[i];e[i]=typeof n==="function"?{type:n}:n}return e}const eNt=GOt((t=>{const e=ERt(t);function i(t){const e=Object.getPrototypeOf(t);return e.prototype instanceof s?e:null}function n(t){if(!t.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",t))){let e=null;if(t.hasOwnProperty(JSCompiler_renameProperty("properties",t))){const i=t.properties;if(i){e=tNt(i)}}t.__ownProperties=e}return t.__ownProperties}class s extends e{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){const t=this._properties;this.__observedAttributes=t?Object.keys(t).map((t=>this.prototype._addPropertyToAttributeMap(t))):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const t=i(this);if(t){t.finalize()}this.__finalized=true;this._finalizeClass()}}static _finalizeClass(){const t=n(this);if(t){this.createProperties(t)}}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const t=i(this);this.__properties=Object.assign({},t&&t._properties,n(this))}return this.__properties}static typeForProperty(t){const e=this._properties[t];return e&&e.type}_initializeProperties(){this.constructor.finalize();super._initializeProperties()}connectedCallback(){if(super.connectedCallback){super.connectedCallback()}this._enableProperties()}disconnectedCallback(){if(super.disconnectedCallback){super.disconnectedCallback()}}}return s}));
/**
 * @fileoverview
 * @suppress {checkPrototypalTypes}
 * @license Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt The complete set of authors may be found
 * at http://polymer.github.io/AUTHORS.txt The complete set of contributors may
 * be found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by
 * Google as part of the polymer project is also subject to an additional IP
 * rights grant found at http://polymer.github.io/PATENTS.txt
 */const iNt="3.5.2";const nNt=window.ShadyCSS&&window.ShadyCSS["cssBuild"];const sNt=GOt((t=>{const e=eNt(QLt(t));function i(t){if(!t.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",t))){t.__propertyDefaults=null;let e=t._properties;for(let i in e){let n=e[i];if("value"in n){t.__propertyDefaults=t.__propertyDefaults||{};t.__propertyDefaults[i]=n}}}return t.__propertyDefaults}function n(t){if(!t.hasOwnProperty(JSCompiler_renameProperty("__ownObservers",t))){t.__ownObservers=t.hasOwnProperty(JSCompiler_renameProperty("observers",t))?t.observers:null}return t.__ownObservers}function s(t,e,i,n){if(i.computed){i.readOnly=true}if(i.computed){if(t._hasReadOnlyEffect(e)){console.warn(`Cannot redefine computed property '${e}'.`)}else{t._createComputedProperty(e,i.computed,n)}}if(i.readOnly&&!t._hasReadOnlyEffect(e)){t._createReadOnlyProperty(e,!i.computed)}else if(i.readOnly===false&&t._hasReadOnlyEffect(e)){console.warn(`Cannot make readOnly property '${e}' non-readOnly.`)}if(i.reflectToAttribute&&!t._hasReflectEffect(e)){t._createReflectedProperty(e)}else if(i.reflectToAttribute===false&&t._hasReflectEffect(e)){console.warn(`Cannot make reflected property '${e}' non-reflected.`)}if(i.notify&&!t._hasNotifyEffect(e)){t._createNotifyingProperty(e)}else if(i.notify===false&&t._hasNotifyEffect(e)){console.warn(`Cannot make notify property '${e}' non-notify.`)}if(i.observer){t._createPropertyObserver(e,i.observer,n[i.observer])}t._addPropertyToAttributeMap(e)}function r(t,e,i,n){if(!nNt){const s=e.content.querySelectorAll("style");const r=nRt(e);const o=sRt(i);const a=e.content.firstElementChild;for(let i=0;i<o.length;i++){let s=o[i];s.textContent=t._processStyleText(s.textContent,n);e.content.insertBefore(s,a)}let l=0;for(let e=0;e<r.length;e++){let i=r[e];let o=s[l];if(o!==i){i=i.cloneNode(true);o.parentNode.insertBefore(i,o)}else{l++}i.textContent=t._processStyleText(i.textContent,n)}}if(window.ShadyCSS){window.ShadyCSS.prepareTemplate(e,i)}if(UOt&&nNt&&COt){const i=e.content.querySelectorAll("style");if(i){let e="";Array.from(i).forEach((t=>{e+=t.textContent;t.parentNode.removeChild(t)}));t._styleSheet=new CSSStyleSheet;t._styleSheet.replaceSync(e)}}}function o(t){let e=null;if(t&&(!OOt||ROt)){e=JOt.import(t,"template");if(OOt&&!e){throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${t}`)}}return e}class a extends e{static get polymerElementVersion(){return iNt}static _finalizeClass(){e._finalizeClass.call(this);const t=n(this);if(t){this.createObservers(t,this._properties)}this._prepareTemplate()}static _prepareTemplate(){let t=this.template;if(t){if(typeof t==="string"){console.error("template getter must return HTMLTemplateElement");t=null}else if(!LOt){t=t.cloneNode(true)}}this.prototype._template=t}static createProperties(t){for(let e in t){s(this.prototype,e,t[e],t)}}static createObservers(t,e){const i=this.prototype;for(let n=0;n<t.length;n++){i._createMethodObserver(t[n],e)}}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){let t=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:undefined;if(typeof t==="function"){t=t()}this._template=t!==undefined?t:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&o(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(t){this._template=t}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const t=this.importMeta;if(t){this._importPath=IOt(t.url)}else{const t=JOt.import(this.is);this._importPath=t&&t.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super()}_initializeProperties(){this.constructor.finalize();this.constructor._finalizeTemplate(this.localName);super._initializeProperties();this.rootPath=EOt;this.importPath=this.constructor.importPath;let t=i(this.constructor);if(!t){return}for(let e in t){let i=t[e];if(this._canApplyPropertyDefault(e)){let t=typeof i.value=="function"?i.value.call(this):i.value;if(this._hasAccessor(e)){this._setPendingProperty(e,t,true)}else{this[e]=t}}}}_canApplyPropertyDefault(t){return!this.hasOwnProperty(t)}static _processStyleText(t,e){return AOt(t,e)}static _finalizeTemplate(t){const e=this.prototype._template;if(e&&!e.__polymerFinalized){e.__polymerFinalized=true;const i=this.importPath;const n=i?TOt(i):"";r(this,e,t,n);this.prototype._bindTemplate(e)}}connectedCallback(){if(window.ShadyCSS&&this._template){window.ShadyCSS.styleElement(this)}super.connectedCallback()}ready(){if(this._template){this.root=this._stampTemplate(this._template);this.$=this.root.$}super.ready()}_readyClients(){if(this._template){this.root=this._attachDom(this.root)}super._readyClients()}_attachDom(t){const e=oRt(this);if(e.attachShadow){if(t){if(!e.shadowRoot){e.attachShadow({mode:"open",shadyUpgradeFragment:t});e.shadowRoot.appendChild(t);if(this.constructor._styleSheet){e.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet]}}if(POt&&window.ShadyDOM){window.ShadyDOM.flushInitial(e.shadowRoot)}return e.shadowRoot}return null}else{throw new Error("ShadowDOM not available. "+"PolymerElement can create dom as children instead of in "+"ShadowDOM by setting `this.root = this;` before `ready`.")}}updateStyles(t){if(window.ShadyCSS){window.ShadyCSS.styleSubtree(this,t)}}resolveUrl(t,e){if(!e&&this.importPath){e=TOt(this.importPath)}return TOt(t,e)}static _parseTemplateContent(t,i,n){i.dynamicFns=i.dynamicFns||this._properties;return e._parseTemplateContent.call(this,t,i,n)}static _addTemplatePropertyEffect(t,i,n){if(NOt&&!(i in this._properties)&&!(n.info.part.signature&&n.info.part.signature.static)&&!n.info.part.hostProp&&!t.nestedTemplate){console.warn(`Property '${i}' used in template but not declared in 'properties'; `+`attribute will not be observed.`)}return e._addTemplatePropertyEffect.call(this,t,i,n)}}return a}));
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const rNt=window.trustedTypes&&trustedTypes.createPolicy("polymer-html-literal",{createHTML:t=>t});class oNt{constructor(t,e){cNt(t,e);const i=e.reduce(((e,i,n)=>e+aNt(i)+t[n+1]),t[0]);this.value=i.toString()}toString(){return this.value}}function aNt(t){if(t instanceof oNt){return t.value}else{throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${t}`)}}function lNt(t){if(t instanceof HTMLTemplateElement){return t.innerHTML}else if(t instanceof oNt){return aNt(t)}else{throw new Error(`non-template value passed to Polymer's html function: ${t}`)}}const uNt=function t(e,...i){cNt(e,i);const n=document.createElement("template");let s=i.reduce(((t,i,n)=>t+lNt(i)+e[n+1]),e[0]);if(rNt){s=rNt.createHTML(s)}n.innerHTML=s;return n};const cNt=(t,e)=>{if(!Array.isArray(t)||!Array.isArray(t.raw)||e.length!==t.length-1){throw new TypeError("Invalid call to the html template tag")}};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const hNt=sNt(HTMLElement);
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */let dNt=0;let fNt=0;const pNt=[];let mNt=false;function yNt(){mNt=false;const t=pNt.length;for(let e=0;e<t;e++){const t=pNt[e];if(t){try{t()}catch(t){setTimeout((()=>{throw t}))}}}pNt.splice(0,t);fNt+=t}const gNt={after(t){return{run(e){return window.setTimeout(e,t)},cancel(t){window.clearTimeout(t)}}},run(t,e){return window.setTimeout(t,e)},cancel(t){window.clearTimeout(t)}};const vNt={run(t){return window.requestAnimationFrame(t)},cancel(t){window.cancelAnimationFrame(t)}};const wNt={run(t){return window.requestIdleCallback?window.requestIdleCallback(t):window.setTimeout(t,16)},cancel(t){if(window.cancelIdleCallback){window.cancelIdleCallback(t)}else{window.clearTimeout(t)}}};const bNt={run(t){if(!mNt){mNt=true;queueMicrotask((()=>yNt()))}pNt.push(t);const e=dNt;dNt+=1;return e},cancel(t){const e=t-fNt;if(e>=0){if(!pNt[e]){throw new Error(`invalid async handle: ${t}`)}pNt[e]=null}}};
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/const SNt=new Set;class _Nt{static debounce(t,e,i){if(t instanceof _Nt){t._cancelAsync()}else{t=new _Nt}t.setConfig(e,i);return t}constructor(){this._asyncModule=null;this._callback=null;this._timer=null}setConfig(t,e){this._asyncModule=t;this._callback=e;this._timer=this._asyncModule.run((()=>{this._timer=null;SNt.delete(this);this._callback()}))}cancel(){if(this.isActive()){this._cancelAsync();SNt.delete(this)}}_cancelAsync(){if(this.isActive()){this._asyncModule.cancel(this._timer);this._timer=null}}flush(){if(this.isActive()){this.cancel();this._callback()}}isActive(){return this._timer!=null}}function xNt(t){SNt.add(t)}function MNt(){const t=Boolean(SNt.size);SNt.forEach((t=>{try{t.flush()}catch(t){setTimeout((()=>{throw t}))}}));return t}const TNt=()=>{let t;do{t=MNt()}while(t)};
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const ANt=[];function INt(t,e,i=t.getAttribute("dir")){if(e){t.setAttribute("dir",e)}else if(i!=null){t.removeAttribute("dir")}}function kNt(){return document.documentElement.getAttribute("dir")}function CNt(){const t=kNt();ANt.forEach((e=>{INt(e,t)}))}const ENt=new MutationObserver(CNt);ENt.observe(document.documentElement,{attributes:true,attributeFilter:["dir"]});const jNt=t=>class e extends t{static get properties(){return{dir:{type:String,value:"",reflectToAttribute:true,converter:{fromAttribute:t=>!t?"":t,toAttribute:t=>t===""?null:t}}}}get __isRTL(){return this.getAttribute("dir")==="rtl"}connectedCallback(){super.connectedCallback();if(!this.hasAttribute("dir")||this.__restoreSubscription){this.__subscribe();INt(this,kNt(),null)}}attributeChangedCallback(t,e,i){super.attributeChangedCallback(t,e,i);if(t!=="dir"){return}const n=kNt();const s=i===n&&ANt.indexOf(this)===-1;const r=!i&&e&&ANt.indexOf(this)===-1;const o=i!==n&&e===n;if(s||r){this.__subscribe();INt(this,n,i)}else if(o){this.__unsubscribe()}}disconnectedCallback(){super.disconnectedCallback();this.__restoreSubscription=ANt.includes(this);this.__unsubscribe()}_valueToNodeAttribute(t,e,i){if(i==="dir"&&e===""&&!t.hasAttribute("dir")){return}super._valueToNodeAttribute(t,e,i)}_attributeToProperty(t,e,i){if(t==="dir"&&!e){this.dir=""}else{super._attributeToProperty(t,e,i)}}__subscribe(){if(!ANt.includes(this)){ANt.push(this)}}__unsubscribe(){if(ANt.includes(this)){ANt.splice(ANt.indexOf(this),1)}}}
/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;function ONt(t,e){return t.split(".").reduce(((t,e)=>t?t[e]:undefined),e)}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function RNt(t){if(window.Vaadin&&window.Vaadin.templateRendererCallback){window.Vaadin.templateRendererCallback(t);return}if(t.querySelector("template")){console.warn(`WARNING: <template> inside <${t.localName}> is no longer supported. Import @vaadin/polymer-legacy-adapter/template-renderer.js to enable compatibility.`)}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function LNt(t,e){if(!e){return null}return e.closest(t)||LNt(t,e.getRootNode().host)}function NNt(t){if(!t){return new Set}return new Set(t.split(" "))}function PNt(t){return t?[...t].join(" "):""}function FNt(t,e,i){const n=NNt(t.getAttribute(e));n.add(i);t.setAttribute(e,PNt(n))}function DNt(t,e,i){const n=NNt(t.getAttribute(e));n.delete(i);if(n.size===0){t.removeAttribute(e);return}t.setAttribute(e,PNt(n))}function $Nt(t){return t.nodeType===Node.TEXT_NODE&&t.textContent.trim()===""}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function zNt(t){return t.__cells||Array.from(t.querySelectorAll('[part~="cell"]:not([part~="details-cell"])'))}function UNt(t,e){[...t.children].forEach(e)}function BNt(t,e){zNt(t).forEach(e);if(t.__detailsCell){e(t.__detailsCell)}}function GNt(t,e,i){let n=1;t.forEach((t=>{if(n%10===0){n+=1}t._order=i+n*e;n+=1}))}function VNt(t,e,i){switch(typeof i){case"boolean":t.toggleAttribute(e,i);break;case"string":t.setAttribute(e,i);break;default:t.removeAttribute(e);break}}function qNt(t,e,i){if(e||e===""){FNt(t,"part",i)}else{DNt(t,"part",i)}}function HNt(t,e,i){t.forEach((t=>{qNt(t,i,e)}))}function WNt(t,e){const i=zNt(t);Object.entries(e).forEach((([e,n])=>{VNt(t,e,n);const s=`${e}-row`;qNt(t,n,s);HNt(i,`${s}-cell`,n)}))}function ZNt(t,e){const i=zNt(t);Object.entries(e).forEach((([e,n])=>{const s=t.getAttribute(e);VNt(t,e,n);if(s){const n=`${e}-${s}-row`;qNt(t,false,n);HNt(i,`${n}-cell`,false)}if(n){const s=`${e}-${n}-row`;qNt(t,n,s);HNt(i,`${s}-cell`,n)}}))}function JNt(t,e,i,n,s){VNt(t,e,i);if(s){qNt(t,false,s)}qNt(t,i,n||`${e}-cell`)}class YNt{constructor(t,e){this.__host=t;this.__callback=e;this.__currentSlots=[];this.__onMutation=this.__onMutation.bind(this);this.__observer=new MutationObserver(this.__onMutation);this.__observer.observe(t,{childList:true});this.__initialCallDebouncer=_Nt.debounce(this.__initialCallDebouncer,bNt,(()=>this.__onMutation()))}disconnect(){this.__observer.disconnect();this.__initialCallDebouncer.cancel();this.__toggleSlotChangeListeners(false)}flush(){this.__onMutation()}__toggleSlotChangeListeners(t){this.__currentSlots.forEach((e=>{if(t){e.addEventListener("slotchange",this.__onMutation)}else{e.removeEventListener("slotchange",this.__onMutation)}}))}__onMutation(){const t=!this.__currentColumns;this.__currentColumns||=[];const e=YNt.getColumns(this.__host);const i=e.filter((t=>!this.__currentColumns.includes(t)));const n=this.__currentColumns.filter((t=>!e.includes(t)));const s=this.__currentColumns.some(((t,i)=>t!==e[i]));this.__currentColumns=e;this.__toggleSlotChangeListeners(false);this.__currentSlots=[...this.__host.children].filter((t=>t instanceof HTMLSlotElement));this.__toggleSlotChangeListeners(true);const r=t||i.length||n.length||s;if(r){this.__callback(i,n)}}static __isColumnElement(t){return t.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/u.test(t.localName)}static getColumns(t){const e=[];const i=t._isColumnElement||YNt.__isColumnElement;[...t.children].forEach((t=>{if(i(t)){e.push(t)}else if(t instanceof HTMLSlotElement){[...t.assignedElements({flatten:true})].filter((t=>i(t))).forEach((t=>e.push(t)))}}));return e}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const KNt=t=>class e extends t{static get properties(){return{resizable:{type:Boolean,sync:true,value(){if(this.localName==="vaadin-grid-column-group"){return}const t=this.parentNode;if(t&&t.localName==="vaadin-grid-column-group"){return t.resizable||false}return false}},frozen:{type:Boolean,value:false,sync:true},frozenToEnd:{type:Boolean,value:false,sync:true},rowHeader:{type:Boolean,value:false,sync:true},hidden:{type:Boolean,value:false,sync:true},header:{type:String,sync:true},textAlign:{type:String,sync:true},headerPartName:{type:String,sync:true},footerPartName:{type:String,sync:true},_lastFrozen:{type:Boolean,value:false,sync:true},_bodyContentHidden:{type:Boolean,value:false,sync:true},_firstFrozenToEnd:{type:Boolean,value:false,sync:true},_order:{type:Number,sync:true},_reorderStatus:{type:Boolean,sync:true},_emptyCells:Array,_headerCell:Object,_footerCell:Object,_grid:Object,__initialized:{type:Boolean,value:true},headerRenderer:{type:Function,sync:true},_headerRenderer:{type:Function,computed:"_computeHeaderRenderer(headerRenderer, header, __initialized)",sync:true},footerRenderer:{type:Function,sync:true},_footerRenderer:{type:Function,computed:"_computeFooterRenderer(footerRenderer, __initialized)",sync:true},__gridColumnElement:{type:Boolean,value:true}}}static get observers(){return["_widthChanged(width, _headerCell, _footerCell, _cells)","_frozenChanged(frozen, _headerCell, _footerCell, _cells)","_frozenToEndChanged(frozenToEnd, _headerCell, _footerCell, _cells)","_flexGrowChanged(flexGrow, _headerCell, _footerCell, _cells)","_textAlignChanged(textAlign, _cells, _headerCell, _footerCell)","_orderChanged(_order, _headerCell, _footerCell, _cells)","_lastFrozenChanged(_lastFrozen)","_firstFrozenToEndChanged(_firstFrozenToEnd)","_onRendererOrBindingChanged(_renderer, _cells, _bodyContentHidden, path)","_onHeaderRendererOrBindingChanged(_headerRenderer, _headerCell, path, header)","_onFooterRendererOrBindingChanged(_footerRenderer, _footerCell)","_resizableChanged(resizable, _headerCell)","_reorderStatusChanged(_reorderStatus, _headerCell, _footerCell, _cells)","_hiddenChanged(hidden, _headerCell, _footerCell, _cells)","_rowHeaderChanged(rowHeader, _cells)","__headerFooterPartNameChanged(_headerCell, _footerCell, headerPartName, footerPartName)"]}get _grid(){if(!this._gridValue){this._gridValue=this._findHostGrid()}return this._gridValue}get _allCells(){return[].concat(this._cells||[]).concat(this._emptyCells||[]).concat(this._headerCell).concat(this._footerCell).filter((t=>t))}connectedCallback(){super.connectedCallback();requestAnimationFrame((()=>{if(!this._grid){return}this._allCells.forEach((t=>{if(!t._content.parentNode){this._grid.appendChild(t._content)}}))}))}disconnectedCallback(){super.disconnectedCallback();requestAnimationFrame((()=>{if(this._grid){return}this._allCells.forEach((t=>{if(t._content.parentNode){t._content.parentNode.removeChild(t._content)}}))}));this._gridValue=undefined}ready(){super.ready();RNt(this)}_findHostGrid(){let t=this;while(t&&!/^vaadin.*grid(-pro)?$/u.test(t.localName)){t=t.assignedSlot?t.assignedSlot.parentNode:t.parentNode}return t||undefined}_renderHeaderAndFooter(){this._renderHeaderCellContent(this._headerRenderer,this._headerCell);this._renderFooterCellContent(this._footerRenderer,this._footerCell)}_flexGrowChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("flexGrow")}this._allCells.forEach((e=>{e.style.flexGrow=t}))}_orderChanged(t){this._allCells.forEach((e=>{e.style.order=t}))}_widthChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("width")}this._allCells.forEach((e=>{e.style.width=t}))}_frozenChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("frozen",t)}this._allCells.forEach((e=>{JNt(e,"frozen",t)}));if(this._grid&&this._grid._frozenCellsChanged){this._grid._frozenCellsChanged()}}_frozenToEndChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("frozenToEnd",t)}this._allCells.forEach((e=>{if(this._grid&&e.parentElement===this._grid.$.sizer){return}JNt(e,"frozen-to-end",t)}));if(this._grid&&this._grid._frozenCellsChanged){this._grid._frozenCellsChanged()}}_lastFrozenChanged(t){this._allCells.forEach((e=>{JNt(e,"last-frozen",t)}));if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._lastFrozen=t}}_firstFrozenToEndChanged(t){this._allCells.forEach((e=>{if(this._grid&&e.parentElement===this._grid.$.sizer){return}JNt(e,"first-frozen-to-end",t)}));if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._firstFrozenToEnd=t}}_rowHeaderChanged(t,e){if(!e){return}e.forEach((e=>{e.setAttribute("role",t?"rowheader":"gridcell")}))}_generateHeader(t){return t.substr(t.lastIndexOf(".")+1).replace(/([A-Z])/gu,"-$1").toLowerCase().replace(/-/gu," ").replace(/^./u,(t=>t.toUpperCase()))}_reorderStatusChanged(t){const e=this.__previousReorderStatus;const i=e?`reorder-${e}-cell`:"";const n=`reorder-${t}-cell`;this._allCells.forEach((e=>{JNt(e,"reorder-status",t,n,i)}));this.__previousReorderStatus=t}_resizableChanged(t,e){if(t===undefined||e===undefined){return}if(e){[e].concat(this._emptyCells).forEach((e=>{if(e){const i=e.querySelector('[part~="resize-handle"]');if(i){e.removeChild(i)}if(t){const t=document.createElement("div");t.setAttribute("part","resize-handle");e.appendChild(t)}}}))}}_textAlignChanged(t){if(t===undefined||this._grid===undefined){return}if(["start","end","center"].indexOf(t)===-1){console.warn('textAlign can only be set as "start", "end" or "center"');return}let e;if(getComputedStyle(this._grid).direction==="ltr"){if(t==="start"){e="left"}else if(t==="end"){e="right"}}else if(t==="start"){e="right"}else if(t==="end"){e="left"}this._allCells.forEach((i=>{i._content.style.textAlign=t;if(getComputedStyle(i._content).textAlign!==t){i._content.style.textAlign=e}}))}_hiddenChanged(t){if(this.parentElement&&this.parentElement._columnPropChanged){this.parentElement._columnPropChanged("hidden",t)}if(!!t!==!!this._previousHidden&&this._grid){if(t===true){this._allCells.forEach((t=>{if(t._content.parentNode){t._content.parentNode.removeChild(t._content)}}))}this._grid._debouncerHiddenChanged=_Nt.debounce(this._grid._debouncerHiddenChanged,vNt,(()=>{if(this._grid&&this._grid._renderColumnTree){this._grid._renderColumnTree(this._grid._columnTree)}}));if(this._grid._debounceUpdateFrozenColumn){this._grid._debounceUpdateFrozenColumn()}if(this._grid._resetKeyboardNavigation){this._grid._resetKeyboardNavigation()}}this._previousHidden=t}_runRenderer(t,e,i){const n=i&&i.item&&!e.parentElement.hidden;const s=n||t===this._headerRenderer||t===this._footerRenderer;if(!s){return}const r=[e._content,this];if(n){r.push(i)}t.apply(this,r)}__renderCellsContent(t,e){if(this.hidden||!this._grid){return}e.forEach((e=>{if(!e.parentElement){return}const i=this._grid.__getRowModel(e.parentElement);if(!t){return}if(e._renderer!==t){this._clearCellContent(e)}e._renderer=t;this._runRenderer(t,e,i)}))}_clearCellContent(t){t._content.innerHTML="";delete t._content._$litPart$}_renderHeaderCellContent(t,e){if(!e||!t){return}this.__renderCellsContent(t,[e]);if(this._grid&&e.parentElement){this._grid.__debounceUpdateHeaderFooterRowVisibility(e.parentElement)}}_onHeaderRendererOrBindingChanged(t,e,...i){this._renderHeaderCellContent(t,e)}__headerFooterPartNameChanged(t,e,i,n){[{cell:t,partName:i},{cell:e,partName:n}].forEach((({cell:t,partName:e})=>{if(t){const i=t.__customParts||[];t.part.remove(...i);t.__customParts=e?e.trim().split(" "):[];t.part.add(...t.__customParts)}}))}_renderBodyCellsContent(t,e){if(!e||!t){return}this.__renderCellsContent(t,e)}_onRendererOrBindingChanged(t,e,...i){this._renderBodyCellsContent(t,e)}_renderFooterCellContent(t,e){if(!e||!t){return}this.__renderCellsContent(t,[e]);if(this._grid&&e.parentElement){this._grid.__debounceUpdateHeaderFooterRowVisibility(e.parentElement)}}_onFooterRendererOrBindingChanged(t,e){this._renderFooterCellContent(t,e)}__setTextContent(t,e){if(t.textContent!==e){t.textContent=e}}__textHeaderRenderer(){this.__setTextContent(this._headerCell._content,this.header)}_defaultHeaderRenderer(){if(!this.path){return}this.__setTextContent(this._headerCell._content,this._generateHeader(this.path))}_defaultRenderer(t,e,{item:i}){if(!this.path){return}this.__setTextContent(t,ONt(this.path,i))}_defaultFooterRenderer(){}_computeHeaderRenderer(t,e){if(t){return t}if(e!==undefined&&e!==null){return this.__textHeaderRenderer}return this._defaultHeaderRenderer}_computeRenderer(t){if(t){return t}return this._defaultRenderer}_computeFooterRenderer(t){if(t){return t}return this._defaultFooterRenderer}};const QNt=t=>class extends(KNt(jNt(t))){static get properties(){return{width:{type:String,value:"100px",sync:true},flexGrow:{type:Number,value:1,sync:true},renderer:{type:Function,sync:true},_renderer:{type:Function,computed:"_computeRenderer(renderer, __initialized)",sync:true},path:{type:String,sync:true},autoWidth:{type:Boolean,value:false},_focusButtonMode:{type:Boolean,value:false},_cells:{type:Array,sync:true}}}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class XNt extends(QNt(hNt)){static get is(){return"vaadin-grid-column"}}REt(XNt);
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const tPt=GOt((t=>{if(typeof t.prototype.addController==="function"){return t}return class e extends t{constructor(){super();this.__controllers=new Set}connectedCallback(){super.connectedCallback();this.__controllers.forEach((t=>{if(t.hostConnected){t.hostConnected()}}))}disconnectedCallback(){super.disconnectedCallback();this.__controllers.forEach((t=>{if(t.hostDisconnected){t.hostDisconnected()}}))}addController(t){this.__controllers.add(t);if(this.$!==undefined&&this.isConnected&&t.hostConnected){t.hostConnected()}}removeController(t){this.__controllers.delete(t)}}}));const ePt=/\/\*[\*!]\s+vaadin-dev-mode:start([\s\S]*)vaadin-dev-mode:end\s+\*\*\//i;const iPt=window.Vaadin&&window.Vaadin.Flow&&window.Vaadin.Flow.clients;function nPt(){function t(){return true}return lPt(t)}function sPt(){try{if(rPt()){return true}if(!oPt()){return false}if(iPt){return!aPt()}return!nPt()}catch(t){return false}}function rPt(){return localStorage.getItem("vaadin.developmentmode.force")}function oPt(){return["localhost","127.0.0.1"].indexOf(window.location.hostname)>=0}function aPt(){if(iPt){const t=Object.keys(iPt).map((t=>iPt[t])).filter((t=>t.productionMode));if(t.length>0){return true}}return false}function lPt(t,e){if(typeof t!=="function"){return}const i=ePt.exec(t.toString());if(i){try{t=new Function(i[1])}catch(t){console.log("vaadin-development-mode-detector: uncommentAndRun() failed",t)}}return t(e)}window["Vaadin"]=window["Vaadin"]||{};const uPt=function(t,e){if(window.Vaadin.developmentMode){return lPt(t,e)}};if(window.Vaadin.developmentMode===undefined){window.Vaadin.developmentMode=sPt()}function cPt(){
/*! vaadin-dev-mode:start
  (function () {
'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};

var classCallCheck = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

var createClass = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();

var getPolymerVersion = function getPolymerVersion() {
  return window.Polymer && window.Polymer.version;
};

var StatisticsGatherer = function () {
  function StatisticsGatherer(logger) {
    classCallCheck(this, StatisticsGatherer);

    this.now = new Date().getTime();
    this.logger = logger;
  }

  createClass(StatisticsGatherer, [{
    key: 'frameworkVersionDetectors',
    value: function frameworkVersionDetectors() {
      return {
        'Flow': function Flow() {
          if (window.Vaadin && window.Vaadin.Flow && window.Vaadin.Flow.clients) {
            var flowVersions = Object.keys(window.Vaadin.Flow.clients).map(function (key) {
              return window.Vaadin.Flow.clients[key];
            }).filter(function (client) {
              return client.getVersionInfo;
            }).map(function (client) {
              return client.getVersionInfo().flow;
            });
            if (flowVersions.length > 0) {
              return flowVersions[0];
            }
          }
        },
        'Vaadin Framework': function VaadinFramework() {
          if (window.vaadin && window.vaadin.clients) {
            var frameworkVersions = Object.values(window.vaadin.clients).filter(function (client) {
              return client.getVersionInfo;
            }).map(function (client) {
              return client.getVersionInfo().vaadinVersion;
            });
            if (frameworkVersions.length > 0) {
              return frameworkVersions[0];
            }
          }
        },
        'AngularJs': function AngularJs() {
          if (window.angular && window.angular.version && window.angular.version) {
            return window.angular.version.full;
          }
        },
        'Angular': function Angular() {
          if (window.ng) {
            var tags = document.querySelectorAll("[ng-version]");
            if (tags.length > 0) {
              return tags[0].getAttribute("ng-version");
            }
            return "Unknown";
          }
        },
        'Backbone.js': function BackboneJs() {
          if (window.Backbone) {
            return window.Backbone.VERSION;
          }
        },
        'React': function React() {
          var reactSelector = '[data-reactroot], [data-reactid]';
          if (!!document.querySelector(reactSelector)) {
            // React does not publish the version by default
            return "unknown";
          }
        },
        'Ember': function Ember() {
          if (window.Em && window.Em.VERSION) {
            return window.Em.VERSION;
          } else if (window.Ember && window.Ember.VERSION) {
            return window.Ember.VERSION;
          }
        },
        'jQuery': function (_jQuery) {
          function jQuery() {
            return _jQuery.apply(this, arguments);
          }

          jQuery.toString = function () {
            return _jQuery.toString();
          };

          return jQuery;
        }(function () {
          if (typeof jQuery === 'function' && jQuery.prototype.jquery !== undefined) {
            return jQuery.prototype.jquery;
          }
        }),
        'Polymer': function Polymer() {
          var version = getPolymerVersion();
          if (version) {
            return version;
          }
        },
        'LitElement': function LitElement() {
          var version = window.litElementVersions && window.litElementVersions[0];
          if (version) {
            return version;
          }
        },
        'LitHtml': function LitHtml() {
          var version = window.litHtmlVersions && window.litHtmlVersions[0];
          if (version) {
            return version;
          }
        },
        'Vue.js': function VueJs() {
          if (window.Vue) {
            return window.Vue.version;
          }
        }
      };
    }
  }, {
    key: 'getUsedVaadinElements',
    value: function getUsedVaadinElements(elements) {
      var version = getPolymerVersion();
      var elementClasses = void 0;
      // NOTE: In case you edit the code here, YOU MUST UPDATE any statistics reporting code in Flow.
      // Check all locations calling the method getEntries() in
      // https://github.com/vaadin/flow/blob/master/flow-server/src/main/java/com/vaadin/flow/internal/UsageStatistics.java#L106
      // Currently it is only used by BootstrapHandler.
      if (version && version.indexOf('2') === 0) {
        // Polymer 2: components classes are stored in window.Vaadin
        elementClasses = Object.keys(window.Vaadin).map(function (c) {
          return window.Vaadin[c];
        }).filter(function (c) {
          return c.is;
        });
      } else {
        // Polymer 3: components classes are stored in window.Vaadin.registrations
        elementClasses = window.Vaadin.registrations || [];
      }
      elementClasses.forEach(function (klass) {
        var version = klass.version ? klass.version : "0.0.0";
        elements[klass.is] = { version: version };
      });
    }
  }, {
    key: 'getUsedVaadinThemes',
    value: function getUsedVaadinThemes(themes) {
      ['Lumo', 'Material'].forEach(function (themeName) {
        var theme;
        var version = getPolymerVersion();
        if (version && version.indexOf('2') === 0) {
          // Polymer 2: themes are stored in window.Vaadin
          theme = window.Vaadin[themeName];
        } else {
          // Polymer 3: themes are stored in custom element registry
          theme = customElements.get('vaadin-' + themeName.toLowerCase() + '-styles');
        }
        if (theme && theme.version) {
          themes[themeName] = { version: theme.version };
        }
      });
    }
  }, {
    key: 'getFrameworks',
    value: function getFrameworks(frameworks) {
      var detectors = this.frameworkVersionDetectors();
      Object.keys(detectors).forEach(function (framework) {
        var detector = detectors[framework];
        try {
          var version = detector();
          if (version) {
            frameworks[framework] = { version: version };
          }
        } catch (e) {}
      });
    }
  }, {
    key: 'gather',
    value: function gather(storage) {
      var storedStats = storage.read();
      var gatheredStats = {};
      var types = ["elements", "frameworks", "themes"];

      types.forEach(function (type) {
        gatheredStats[type] = {};
        if (!storedStats[type]) {
          storedStats[type] = {};
        }
      });

      var previousStats = JSON.stringify(storedStats);

      this.getUsedVaadinElements(gatheredStats.elements);
      this.getFrameworks(gatheredStats.frameworks);
      this.getUsedVaadinThemes(gatheredStats.themes);

      var now = this.now;
      types.forEach(function (type) {
        var keys = Object.keys(gatheredStats[type]);
        keys.forEach(function (key) {
          if (!storedStats[type][key] || _typeof(storedStats[type][key]) != _typeof({})) {
            storedStats[type][key] = { firstUsed: now };
          }
          // Discards any previously logged version number
          storedStats[type][key].version = gatheredStats[type][key].version;
          storedStats[type][key].lastUsed = now;
        });
      });

      var newStats = JSON.stringify(storedStats);
      storage.write(newStats);
      if (newStats != previousStats && Object.keys(storedStats).length > 0) {
        this.logger.debug("New stats: " + newStats);
      }
    }
  }]);
  return StatisticsGatherer;
}();

var StatisticsStorage = function () {
  function StatisticsStorage(key) {
    classCallCheck(this, StatisticsStorage);

    this.key = key;
  }

  createClass(StatisticsStorage, [{
    key: 'read',
    value: function read() {
      var localStorageStatsString = localStorage.getItem(this.key);
      try {
        return JSON.parse(localStorageStatsString ? localStorageStatsString : '{}');
      } catch (e) {
        return {};
      }
    }
  }, {
    key: 'write',
    value: function write(data) {
      localStorage.setItem(this.key, data);
    }
  }, {
    key: 'clear',
    value: function clear() {
      localStorage.removeItem(this.key);
    }
  }, {
    key: 'isEmpty',
    value: function isEmpty() {
      var storedStats = this.read();
      var empty = true;
      Object.keys(storedStats).forEach(function (key) {
        if (Object.keys(storedStats[key]).length > 0) {
          empty = false;
        }
      });

      return empty;
    }
  }]);
  return StatisticsStorage;
}();

var StatisticsSender = function () {
  function StatisticsSender(url, logger) {
    classCallCheck(this, StatisticsSender);

    this.url = url;
    this.logger = logger;
  }

  createClass(StatisticsSender, [{
    key: 'send',
    value: function send(data, errorHandler) {
      var logger = this.logger;

      if (navigator.onLine === false) {
        logger.debug("Offline, can't send");
        errorHandler();
        return;
      }
      logger.debug("Sending data to " + this.url);

      var req = new XMLHttpRequest();
      req.withCredentials = true;
      req.addEventListener("load", function () {
        // Stats sent, nothing more to do
        logger.debug("Response: " + req.responseText);
      });
      req.addEventListener("error", function () {
        logger.debug("Send failed");
        errorHandler();
      });
      req.addEventListener("abort", function () {
        logger.debug("Send aborted");
        errorHandler();
      });
      req.open("POST", this.url);
      req.setRequestHeader("Content-Type", "application/json");
      req.send(data);
    }
  }]);
  return StatisticsSender;
}();

var StatisticsLogger = function () {
  function StatisticsLogger(id) {
    classCallCheck(this, StatisticsLogger);

    this.id = id;
  }

  createClass(StatisticsLogger, [{
    key: '_isDebug',
    value: function _isDebug() {
      return localStorage.getItem("vaadin." + this.id + ".debug");
    }
  }, {
    key: 'debug',
    value: function debug(msg) {
      if (this._isDebug()) {
        console.info(this.id + ": " + msg);
      }
    }
  }]);
  return StatisticsLogger;
}();

var UsageStatistics = function () {
  function UsageStatistics() {
    classCallCheck(this, UsageStatistics);

    this.now = new Date();
    this.timeNow = this.now.getTime();
    this.gatherDelay = 10; // Delay between loading this file and gathering stats
    this.initialDelay = 24 * 60 * 60;

    this.logger = new StatisticsLogger("statistics");
    this.storage = new StatisticsStorage("vaadin.statistics.basket");
    this.gatherer = new StatisticsGatherer(this.logger);
    this.sender = new StatisticsSender("https://tools.vaadin.com/usage-stats/submit", this.logger);
  }

  createClass(UsageStatistics, [{
    key: 'maybeGatherAndSend',
    value: function maybeGatherAndSend() {
      var _this = this;

      if (localStorage.getItem(UsageStatistics.optOutKey)) {
        return;
      }
      this.gatherer.gather(this.storage);
      setTimeout(function () {
        _this.maybeSend();
      }, this.gatherDelay * 1000);
    }
  }, {
    key: 'lottery',
    value: function lottery() {
      return true;
    }
  }, {
    key: 'currentMonth',
    value: function currentMonth() {
      return this.now.getYear() * 12 + this.now.getMonth();
    }
  }, {
    key: 'maybeSend',
    value: function maybeSend() {
      var firstUse = Number(localStorage.getItem(UsageStatistics.firstUseKey));
      var monthProcessed = Number(localStorage.getItem(UsageStatistics.monthProcessedKey));

      if (!firstUse) {
        // Use a grace period to avoid interfering with tests, incognito mode etc
        firstUse = this.timeNow;
        localStorage.setItem(UsageStatistics.firstUseKey, firstUse);
      }

      if (this.timeNow < firstUse + this.initialDelay * 1000) {
        this.logger.debug("No statistics will be sent until the initial delay of " + this.initialDelay + "s has passed");
        return;
      }
      if (this.currentMonth() <= monthProcessed) {
        this.logger.debug("This month has already been processed");
        return;
      }
      localStorage.setItem(UsageStatistics.monthProcessedKey, this.currentMonth());
      // Use random sampling
      if (this.lottery()) {
        this.logger.debug("Congratulations, we have a winner!");
      } else {
        this.logger.debug("Sorry, no stats from you this time");
        return;
      }

      this.send();
    }
  }, {
    key: 'send',
    value: function send() {
      // Ensure we have the latest data
      this.gatherer.gather(this.storage);

      // Read, send and clean up
      var data = this.storage.read();
      data["firstUse"] = Number(localStorage.getItem(UsageStatistics.firstUseKey));
      data["usageStatisticsVersion"] = UsageStatistics.version;
      var info = 'This request contains usage statistics gathered from the application running in development mode. \n\nStatistics gathering is automatically disabled and excluded from production builds.\n\nFor details and to opt-out, see https://github.com/vaadin/vaadin-usage-statistics.\n\n\n\n';
      var self = this;
      this.sender.send(info + JSON.stringify(data), function () {
        // Revert the 'month processed' flag
        localStorage.setItem(UsageStatistics.monthProcessedKey, self.currentMonth() - 1);
      });
    }
  }], [{
    key: 'version',
    get: function get$1() {
      return '2.1.2';
    }
  }, {
    key: 'firstUseKey',
    get: function get$1() {
      return 'vaadin.statistics.firstuse';
    }
  }, {
    key: 'monthProcessedKey',
    get: function get$1() {
      return 'vaadin.statistics.monthProcessed';
    }
  }, {
    key: 'optOutKey',
    get: function get$1() {
      return 'vaadin.statistics.optout';
    }
  }]);
  return UsageStatistics;
}();

try {
  window.Vaadin = window.Vaadin || {};
  window.Vaadin.usageStatsChecker = window.Vaadin.usageStatsChecker || new UsageStatistics();
  window.Vaadin.usageStatsChecker.maybeGatherAndSend();
} catch (e) {
  // Intentionally ignored as this is not a problem in the app being developed
}

}());

  vaadin-dev-mode:end **/}const hPt=function(){if(typeof uPt==="function"){return uPt(cPt)}};
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */if(!window.Vaadin){window.Vaadin={}}if(!window.Vaadin.registrations){window.Vaadin.registrations=[]}if(!window.Vaadin.developmentModeCallback){window.Vaadin.developmentModeCallback={}}window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]=function(){hPt()};let dPt;const fPt=new Set;const pPt=t=>class e extends(jNt(t)){static finalize(){super.finalize();const{is:t}=this;if(t&&!fPt.has(t)){window.Vaadin.registrations.push(this);fPt.add(t);if(window.Vaadin.developmentModeCallback){dPt=_Nt.debounce(dPt,wNt,(()=>{window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]()}));xNt(dPt)}}}constructor(){super();if(document.doctype===null){console.warn('Vaadin components require the "standards mode" declaration. Please add <!DOCTYPE html> to the HTML document.')}}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;let mPt=false;window.addEventListener("keydown",(()=>{mPt=true}),{capture:true});window.addEventListener("mousedown",(()=>{mPt=false}),{capture:true});function yPt(){return mPt}function gPt(t){const e=t.style;if(e.visibility==="hidden"||e.display==="none"){return true}const i=window.getComputedStyle(t);if(i.visibility==="hidden"||i.display==="none"){return true}return false}function vPt(t){if(t.offsetParent===null&&t.clientWidth===0&&t.clientHeight===0){return true}return gPt(t)}function wPt(t){if(t.matches('[tabindex="-1"]')){return false}if(t.matches("input, select, textarea, button, object")){return t.matches(":not([disabled])")}return t.matches("a[href], area[href], iframe, [tabindex], [contentEditable]")}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const bPt=GOt((t=>class e extends t{static get properties(){return{disabled:{type:Boolean,value:false,observer:"_disabledChanged",reflectToAttribute:true}}}_disabledChanged(t){this._setAriaDisabled(t)}_setAriaDisabled(t){if(t){this.setAttribute("aria-disabled","true")}else{this.removeAttribute("aria-disabled")}}click(){if(!this.disabled){super.click()}}}));
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const SPt=t=>class e extends(bPt(t)){static get properties(){return{tabindex:{type:Number,reflectToAttribute:true,observer:"_tabindexChanged"},_lastTabIndex:{type:Number}}}_disabledChanged(t,e){super._disabledChanged(t,e);if(t){if(this.tabindex!==undefined){this._lastTabIndex=this.tabindex}this.tabindex=-1}else if(e){this.tabindex=this._lastTabIndex}}_tabindexChanged(t){if(this.disabled&&t!==-1){this._lastTabIndex=t;this.tabindex=-1}}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const _Pt=t=>t.test(navigator.userAgent);const xPt=t=>t.test(navigator.platform);const MPt=t=>t.test(navigator.vendor);const TPt=_Pt(/Android/u);const APt=_Pt(/Chrome/u)&&MPt(/Google Inc/u);const IPt=_Pt(/Firefox/u);const kPt=xPt(/^iPad/u)||xPt(/^Mac/u)&&navigator.maxTouchPoints>1;const CPt=xPt(/^iPhone/u);const EPt=CPt||kPt;const jPt=_Pt(/^((?!chrome|android).)*safari/iu);const OPt=(()=>{try{document.createEvent("TouchEvent");return true}catch(t){return false}})();
/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class RPt{constructor(t,e){this.slot=t;this.callback=e;this._storedNodes=[];this._connected=false;this._scheduled=false;this._boundSchedule=()=>{this._schedule()};this.connect();this._schedule()}connect(){this.slot.addEventListener("slotchange",this._boundSchedule);this._connected=true}disconnect(){this.slot.removeEventListener("slotchange",this._boundSchedule);this._connected=false}_schedule(){if(!this._scheduled){this._scheduled=true;queueMicrotask((()=>{this.flush()}))}}flush(){if(!this._connected){return}this._scheduled=false;this._processNodes()}_processNodes(){const t=this.slot.assignedNodes({flatten:true});let e=[];const i=[];const n=[];if(t.length){e=t.filter((t=>!this._storedNodes.includes(t)))}if(this._storedNodes.length){this._storedNodes.forEach(((e,s)=>{const r=t.indexOf(e);if(r===-1){i.push(e)}else if(r!==s){n.push(e)}}))}if(e.length||i.length||n.length){this.callback({addedNodes:e,currentNodes:t,movedNodes:n,removedNodes:i})}this._storedNodes=t}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */let LPt=0;function NPt(){return LPt++}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class PPt extends EventTarget{static generateId(t,e="default"){return`${e}-${t.localName}-${NPt()}`}constructor(t,e,i,n={}){super();const{initializer:s,multiple:r,observe:o,useUniqueId:a,uniqueIdPrefix:l}=n;this.host=t;this.slotName=e;this.tagName=i;this.observe=typeof o==="boolean"?o:true;this.multiple=typeof r==="boolean"?r:false;this.slotInitializer=s;if(r){this.nodes=[]}if(a){this.defaultId=this.constructor.generateId(t,l||e)}}hostConnected(){if(!this.initialized){if(this.multiple){this.initMultiple()}else{this.initSingle()}if(this.observe){this.observeSlot()}this.initialized=true}}initSingle(){let t=this.getSlotChild();if(!t){t=this.attachDefaultNode();this.initNode(t)}else{this.node=t;this.initAddedNode(t)}}initMultiple(){const t=this.getSlotChildren();if(t.length===0){const t=this.attachDefaultNode();if(t){this.nodes=[t];this.initNode(t)}}else{this.nodes=t;t.forEach((t=>{this.initAddedNode(t)}))}}attachDefaultNode(){const{host:t,slotName:e,tagName:i}=this;let n=this.defaultNode;if(!n&&i){n=document.createElement(i);if(n instanceof Element){if(e!==""){n.setAttribute("slot",e)}this.defaultNode=n}}if(n){this.node=n;t.appendChild(n)}return n}getSlotChildren(){const{slotName:t}=this;return Array.from(this.host.childNodes).filter((e=>e.nodeType===Node.ELEMENT_NODE&&e.slot===t||e.nodeType===Node.TEXT_NODE&&e.textContent.trim()&&t===""))}getSlotChild(){return this.getSlotChildren()[0]}initNode(t){const{slotInitializer:e}=this;if(e){e(t,this.host)}}initCustomNode(t){}teardownNode(t){}initAddedNode(t){if(t!==this.defaultNode){this.initCustomNode(t);this.initNode(t)}}observeSlot(){const{slotName:t}=this;const e=t===""?"slot:not([name])":`slot[name=${t}]`;const i=this.host.shadowRoot.querySelector(e);this.__slotObserver=new RPt(i,(({addedNodes:t,removedNodes:e})=>{const i=this.multiple?this.nodes:[this.node];const n=t.filter((t=>!$Nt(t)&&!i.includes(t)));if(e.length){this.nodes=i.filter((t=>!e.includes(t)));e.forEach((t=>{this.teardownNode(t)}))}if(n&&n.length>0){if(this.multiple){if(this.defaultNode){this.defaultNode.remove()}this.nodes=[...i,...n].filter((t=>t!==this.defaultNode));n.forEach((t=>{this.initAddedNode(t)}))}else{if(this.node){this.node.remove()}this.node=n[0];this.initAddedNode(this.node)}}}))}}
/**
 * @license
 * Copyright (c) 2022 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class FPt extends PPt{constructor(t){super(t,"tooltip");this.setTarget(t)}initCustomNode(t){t.target=this.target;if(this.ariaTarget!==undefined){t.ariaTarget=this.ariaTarget}if(this.context!==undefined){t.context=this.context}if(this.manual!==undefined){t.manual=this.manual}if(this.opened!==undefined){t.opened=this.opened}if(this.position!==undefined){t._position=this.position}if(this.shouldShow!==undefined){t.shouldShow=this.shouldShow}this.__notifyChange()}teardownNode(){this.__notifyChange()}setAriaTarget(t){this.ariaTarget=t;const e=this.node;if(e){e.ariaTarget=t}}setContext(t){this.context=t;const e=this.node;if(e){e.context=t}}setManual(t){this.manual=t;const e=this.node;if(e){e.manual=t}}setOpened(t){this.opened=t;const e=this.node;if(e){e.opened=t}}setPosition(t){this.position=t;const e=this.node;if(e){e._position=t}}setShouldShow(t){this.shouldShow=t;const e=this.node;if(e){e.shouldShow=t}}setTarget(t){this.target=t;const e=this.node;if(e){e.target=t}}__notifyChange(){this.dispatchEvent(new CustomEvent("tooltip-changed",{detail:{node:this.node}}))}}
/**
 * @license
 * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */const DPt=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/u);const $Pt=DPt&&DPt[1]>=8;const zPt=3;const UPt={_ratio:.5,_scrollerPaddingTop:0,_scrollPosition:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_estScrollHeight:0,_scrollHeight:0,_viewportHeight:0,_viewportWidth:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_lastVisibleIndexVal:null,_maxPages:2,_templateCost:0,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportHeight},get _virtualEnd(){return this._virtualStart+this._physicalCount-1},get _hiddenContentSize(){return this._physicalSize-this._viewportHeight},get _maxScrollTop(){return this._estScrollHeight-this._viewportHeight+this._scrollOffset},get _maxVirtualStart(){const t=this._virtualCount;return Math.max(0,t-this._physicalCount)},get _virtualStart(){return this._virtualStartVal||0},set _virtualStart(t){t=this._clamp(t,0,this._maxVirtualStart);this._virtualStartVal=t},get _physicalStart(){return this._physicalStartVal||0},set _physicalStart(t){t%=this._physicalCount;if(t<0){t=this._physicalCount+t}this._physicalStartVal=t},get _physicalEnd(){return(this._physicalStart+this._physicalCount-1)%this._physicalCount},get _physicalCount(){return this._physicalCountVal||0},set _physicalCount(t){this._physicalCountVal=t},get _optPhysicalSize(){return this._viewportHeight===0?Infinity:this._viewportHeight*this._maxPages},get _isVisible(){return Boolean(this.offsetWidth||this.offsetHeight)},get firstVisibleIndex(){let t=this._firstVisibleIndexVal;if(t==null){let e=this._physicalTop+this._scrollOffset;t=this._iterateItems(((t,i)=>{e+=this._getPhysicalSizeIncrement(t);if(e>this._scrollPosition){return i}}))||0;this._firstVisibleIndexVal=t}return t},get lastVisibleIndex(){let t=this._lastVisibleIndexVal;if(t==null){let e=this._physicalTop+this._scrollOffset;this._iterateItems(((i,n)=>{if(e<this._scrollBottom){t=n}e+=this._getPhysicalSizeIncrement(i)}));this._lastVisibleIndexVal=t}return t},get _scrollOffset(){return this._scrollerPaddingTop+this.scrollOffset},_scrollHandler(){const t=Math.max(0,Math.min(this._maxScrollTop,this._scrollTop));let e=t-this._scrollPosition;const i=e>=0;this._scrollPosition=t;this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null;if(Math.abs(e)>this._physicalSize&&this._physicalSize>0){e-=this._scrollOffset;const t=Math.round(e/this._physicalAverage);this._virtualStart+=t;this._physicalStart+=t;this._physicalTop=Math.min(Math.floor(this._virtualStart)*this._physicalAverage,this._scrollPosition);this._update()}else if(this._physicalCount>0){const t=this._getReusables(i);if(i){this._physicalTop=t.physicalTop;this._virtualStart+=t.indexes.length;this._physicalStart+=t.indexes.length}else{this._virtualStart-=t.indexes.length;this._physicalStart-=t.indexes.length}this._update(t.indexes,i?null:t.indexes);this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,0),bNt)}},_getReusables(t){let e,i,n;const s=[];const r=this._hiddenContentSize*this._ratio;const o=this._virtualStart;const a=this._virtualEnd;const l=this._physicalCount;let u=this._physicalTop+this._scrollOffset;const c=this._physicalBottom+this._scrollOffset;const h=this._scrollPosition;const d=this._scrollBottom;if(t){e=this._physicalStart;i=h-u}else{e=this._physicalEnd;i=c-d}while(true){n=this._getPhysicalSizeIncrement(e);i-=n;if(s.length>=l||i<=r){break}if(t){if(a+s.length+1>=this._virtualCount){break}if(u+n>=h-this._scrollOffset){break}s.push(e);u+=n;e=(e+1)%l}else{if(o-s.length<=0){break}if(u+this._physicalSize-n<=d){break}s.push(e);u-=n;e=e===0?l-1:e-1}}return{indexes:s,physicalTop:u-this._scrollOffset}},_update(t,e){if(t&&t.length===0||this._physicalCount===0){return}this._assignModels(t);this._updateMetrics(t);if(e){while(e.length){const t=e.pop();this._physicalTop-=this._getPhysicalSizeIncrement(t)}}this._positionItems();this._updateScrollerSize()},_isClientFull(){return this._scrollBottom!==0&&this._physicalBottom-1>=this._scrollBottom&&this._physicalTop<=this._scrollPosition},_increasePoolIfNeeded(t){const e=this._clamp(this._physicalCount+t,zPt,this._virtualCount-this._virtualStart);const i=e-this._physicalCount;let n=Math.round(this._physicalCount*.5);if(i<0){return}if(i>0){const t=window.performance.now();[].push.apply(this._physicalItems,this._createPool(i));for(let t=0;t<i;t++){this._physicalSizes.push(0)}this._physicalCount+=i;if(this._physicalStart>this._physicalEnd&&this._isIndexRendered(this._focusedVirtualIndex)&&this._getPhysicalIndex(this._focusedVirtualIndex)<this._physicalEnd){this._physicalStart+=i}this._update();this._templateCost=(window.performance.now()-t)/i;n=Math.round(this._physicalCount*.5)}if(this._virtualEnd>=this._virtualCount-1||n===0);else if(!this._isClientFull()){this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,n),bNt)}else if(this._physicalSize<this._optPhysicalSize){this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,this._clamp(Math.round(50/this._templateCost),1,n)),wNt)}},_render(){if(!this.isAttached||!this._isVisible){return}if(this._physicalCount!==0){const t=this._getReusables(true);this._physicalTop=t.physicalTop;this._virtualStart+=t.indexes.length;this._physicalStart+=t.indexes.length;this._update(t.indexes);this._update();this._increasePoolIfNeeded(0)}else if(this._virtualCount>0){this.updateViewportBoundaries();this._increasePoolIfNeeded(zPt)}},_itemsChanged(t){if(t.path==="items"){this._virtualStart=0;this._physicalTop=0;this._virtualCount=this.items?this.items.length:0;this._physicalIndexForKey={};this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null;if(!this._physicalItems){this._physicalItems=[]}if(!this._physicalSizes){this._physicalSizes=[]}this._physicalStart=0;if(this._scrollTop>this._scrollOffset){this._resetScrollPosition(0)}this._debounce("_render",this._render,vNt)}},_iterateItems(t,e){let i,n,s,r;if(arguments.length===2&&e){for(r=0;r<e.length;r++){i=e[r];n=this._computeVidx(i);if((s=t.call(this,i,n))!=null){return s}}}else{i=this._physicalStart;n=this._virtualStart;for(;i<this._physicalCount;i++,n++){if((s=t.call(this,i,n))!=null){return s}}for(i=0;i<this._physicalStart;i++,n++){if((s=t.call(this,i,n))!=null){return s}}}},_computeVidx(t){if(t>=this._physicalStart){return this._virtualStart+(t-this._physicalStart)}return this._virtualStart+(this._physicalCount-this._physicalStart)+t},_positionItems(){this._adjustScrollPosition();let t=this._physicalTop;this._iterateItems((e=>{this.translate3d(0,`${t}px`,0,this._physicalItems[e]);t+=this._physicalSizes[e]}))},_getPhysicalSizeIncrement(t){return this._physicalSizes[t]},_adjustScrollPosition(){const t=this._virtualStart===0?this._physicalTop:Math.min(this._scrollPosition+this._physicalTop,0);if(t!==0){this._physicalTop-=t;const e=this._scrollPosition;if(!$Pt&&e>0){this._resetScrollPosition(e-t)}}},_resetScrollPosition(t){if(this.scrollTarget&&t>=0){this._scrollTop=t;this._scrollPosition=this._scrollTop}},_updateScrollerSize(t){const e=this._physicalBottom+Math.max(this._virtualCount-this._physicalCount-this._virtualStart,0)*this._physicalAverage;this._estScrollHeight=e;if(t||this._scrollHeight===0||this._scrollPosition>=e-this._physicalSize||Math.abs(e-this._scrollHeight)>=this._viewportHeight){this.$.items.style.height=`${e}px`;this._scrollHeight=e}},scrollToIndex(t){if(typeof t!=="number"||t<0||t>this.items.length-1){return}TNt();if(this._physicalCount===0){return}t=this._clamp(t,0,this._virtualCount-1);if(!this._isIndexRendered(t)||t>=this._maxVirtualStart){this._virtualStart=t-1}this._assignModels();this._updateMetrics();this._physicalTop=this._virtualStart*this._physicalAverage;let e=this._physicalStart;let i=this._virtualStart;let n=0;const s=this._hiddenContentSize;while(i<t&&n<=s){n+=this._getPhysicalSizeIncrement(e);e=(e+1)%this._physicalCount;i+=1}this._updateScrollerSize(true);this._positionItems();this._resetScrollPosition(this._physicalTop+this._scrollOffset+n);this._increasePoolIfNeeded(0);this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null},_resetAverage(){this._physicalAverage=0;this._physicalAverageCount=0},_resizeHandler(){this._debounce("_render",(()=>{this._firstVisibleIndexVal=null;this._lastVisibleIndexVal=null;if(this._isVisible){this.updateViewportBoundaries();this.toggleScrollListener(true);this._resetAverage();this._render()}else{this.toggleScrollListener(false)}}),vNt)},_isIndexRendered(t){return t>=this._virtualStart&&t<=this._virtualEnd},_getPhysicalIndex(t){return(this._physicalStart+(t-this._virtualStart))%this._physicalCount},_clamp(t,e,i){return Math.min(i,Math.max(e,t))},_debounce(t,e,i){if(!this._debouncers){this._debouncers={}}this._debouncers[t]=_Nt.debounce(this._debouncers[t],i,e.bind(this));xNt(this._debouncers[t])}};
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const BPt=1e5;const GPt=1e3;class VPt{constructor({createElements:t,updateElement:e,scrollTarget:i,scrollContainer:n,elementsContainer:s,reorderElements:r}){this.isAttached=true;this._vidxOffset=0;this.createElements=t;this.updateElement=e;this.scrollTarget=i;this.scrollContainer=n;this.elementsContainer=s||n;this.reorderElements=r;this._maxPages=1.3;this.__placeholderHeight=200;this.__elementHeightQueue=Array(10);this.timeouts={SCROLL_REORDER:500,IGNORE_WHEEL:500,FIX_INVALID_ITEM_POSITIONING:100};this.__resizeObserver=new ResizeObserver((()=>this._resizeHandler()));if(getComputedStyle(this.scrollTarget).overflow==="visible"){this.scrollTarget.style.overflow="auto"}if(getComputedStyle(this.scrollContainer).position==="static"){this.scrollContainer.style.position="relative"}this.__resizeObserver.observe(this.scrollTarget);this.scrollTarget.addEventListener("scroll",(()=>this._scrollHandler()));this._scrollLineHeight=this._getScrollLineHeight();this.scrollTarget.addEventListener("wheel",(t=>this.__onWheel(t)));this.scrollTarget.addEventListener("virtualizer-element-focused",(t=>this.__onElementFocused(t)));this.elementsContainer.addEventListener("focusin",(()=>{this.scrollTarget.dispatchEvent(new CustomEvent("virtualizer-element-focused",{detail:{element:this.__getFocusedElement()}}))}));if(this.reorderElements){this.scrollTarget.addEventListener("mousedown",(()=>{this.__mouseDown=true}));this.scrollTarget.addEventListener("mouseup",(()=>{this.__mouseDown=false;if(this.__pendingReorder){this.__reorderElements()}}))}}get scrollOffset(){return 0}get adjustedFirstVisibleIndex(){return this.firstVisibleIndex+this._vidxOffset}get adjustedLastVisibleIndex(){return this.lastVisibleIndex+this._vidxOffset}get _maxVirtualIndexOffset(){return this.size-this._virtualCount}__hasPlaceholders(){return this.__getVisibleElements().some((t=>t.__virtualizerPlaceholder))}scrollToIndex(t){if(typeof t!=="number"||isNaN(t)||this.size===0||!this.scrollTarget.offsetHeight){return}delete this.__pendingScrollToIndex;if(this._physicalCount<=3){this.flush()}t=this._clamp(t,0,this.size-1);const e=this.__getVisibleElements().length;let i=Math.floor(t/this.size*this._virtualCount);if(this._virtualCount-i<e){i=this._virtualCount-(this.size-t);this._vidxOffset=this._maxVirtualIndexOffset}else if(i<e){if(t<GPt){i=t;this._vidxOffset=0}else{i=GPt;this._vidxOffset=t-i}}else{this._vidxOffset=t-i}this.__skipNextVirtualIndexAdjust=true;super.scrollToIndex(i);if(this.adjustedFirstVisibleIndex!==t&&this._scrollTop<this._maxScrollTop&&!this.grid){this._scrollTop-=this.__getIndexScrollOffset(t)||0}this._scrollHandler();if(this.__hasPlaceholders()){this.__pendingScrollToIndex=t}}flush(){if(this.scrollTarget.offsetHeight===0){return}this._resizeHandler();TNt();this._scrollHandler();if(this.__fixInvalidItemPositioningDebouncer){this.__fixInvalidItemPositioningDebouncer.flush()}if(this.__scrollReorderDebouncer){this.__scrollReorderDebouncer.flush()}if(this.__debouncerWheelAnimationFrame){this.__debouncerWheelAnimationFrame.flush()}}update(t=0,e=this.size-1){const i=[];this.__getVisibleElements().forEach((n=>{if(n.__virtualIndex>=t&&n.__virtualIndex<=e){this.__updateElement(n,n.__virtualIndex,true);i.push(n)}}));this.__afterElementsUpdated(i)}_updateMetrics(t){TNt();let e=0;let i=0;const n=this._physicalAverageCount;const s=this._physicalAverage;this._iterateItems(((t,n)=>{i+=this._physicalSizes[t];this._physicalSizes[t]=Math.ceil(this.__getBorderBoxHeight(this._physicalItems[t]));e+=this._physicalSizes[t];this._physicalAverageCount+=this._physicalSizes[t]?1:0}),t);this._physicalSize=this._physicalSize+e-i;if(this._physicalAverageCount!==n){this._physicalAverage=Math.round((s*n+e)/this._physicalAverageCount)}}__getBorderBoxHeight(t){const e=getComputedStyle(t);const i=parseFloat(e.height)||0;if(e.boxSizing==="border-box"){return i}const n=parseFloat(e.paddingBottom)||0;const s=parseFloat(e.paddingTop)||0;const r=parseFloat(e.borderBottomWidth)||0;const o=parseFloat(e.borderTopWidth)||0;return i+n+s+r+o}__updateElement(t,e,i){if(t.__virtualizerPlaceholder){t.style.paddingTop="";t.style.opacity="";t.__virtualizerPlaceholder=false}if(!this.__preventElementUpdates&&(t.__lastUpdatedIndex!==e||i)){this.updateElement(t,e);t.__lastUpdatedIndex=e}}__afterElementsUpdated(t){t.forEach((t=>{const e=t.offsetHeight;if(e===0){t.style.paddingTop=`${this.__placeholderHeight}px`;t.style.opacity="0";t.__virtualizerPlaceholder=true;this.__placeholderClearDebouncer=_Nt.debounce(this.__placeholderClearDebouncer,vNt,(()=>this._resizeHandler()))}else{this.__elementHeightQueue.push(e);this.__elementHeightQueue.shift();const t=this.__elementHeightQueue.filter((t=>t!==undefined));this.__placeholderHeight=Math.round(t.reduce(((t,e)=>t+e),0)/t.length)}}));if(this.__pendingScrollToIndex!==undefined&&!this.__hasPlaceholders()){this.scrollToIndex(this.__pendingScrollToIndex)}}__getIndexScrollOffset(t){const e=this.__getVisibleElements().find((e=>e.__virtualIndex===t));return e?this.scrollTarget.getBoundingClientRect().top-e.getBoundingClientRect().top:undefined}get size(){return this.__size}set size(t){if(t===this.size){return}if(this.__fixInvalidItemPositioningDebouncer){this.__fixInvalidItemPositioningDebouncer.cancel()}if(this._debouncers&&this._debouncers._increasePoolIfNeeded){this._debouncers._increasePoolIfNeeded.cancel()}this.__preventElementUpdates=true;let e;let i;if(t>0){e=this.adjustedFirstVisibleIndex;i=this.__getIndexScrollOffset(e)}this.__size=t;this._itemsChanged({path:"items"});TNt();if(t>0){e=Math.min(e,t-1);this.scrollToIndex(e);const n=this.__getIndexScrollOffset(e);if(i!==undefined&&n!==undefined){this._scrollTop+=i-n}}this.__preventElementUpdates=false;if(!this._isVisible){this._assignModels()}if(!this.elementsContainer.children.length){requestAnimationFrame((()=>this._resizeHandler()))}this._resizeHandler();TNt();this._debounce("_update",this._update,bNt)}get _scrollTop(){return this.scrollTarget.scrollTop}set _scrollTop(t){this.scrollTarget.scrollTop=t}get items(){return{length:Math.min(this.size,BPt)}}get offsetHeight(){return this.scrollTarget.offsetHeight}get $(){return{items:this.scrollContainer}}updateViewportBoundaries(){const t=window.getComputedStyle(this.scrollTarget);this._scrollerPaddingTop=this.scrollTarget===this?0:parseInt(t["padding-top"],10);this._isRTL=Boolean(t.direction==="rtl");this._viewportWidth=this.elementsContainer.offsetWidth;this._viewportHeight=this.scrollTarget.offsetHeight;this._scrollPageHeight=this._viewportHeight-this._scrollLineHeight;if(this.grid){this._updateGridMetrics()}}setAttribute(){}_createPool(t){const e=this.createElements(t);const i=document.createDocumentFragment();e.forEach((t=>{t.style.position="absolute";i.appendChild(t);this.__resizeObserver.observe(t)}));this.elementsContainer.appendChild(i);return e}_assignModels(t){const e=[];this._iterateItems(((t,i)=>{const n=this._physicalItems[t];n.hidden=i>=this.size;if(!n.hidden){n.__virtualIndex=i+(this._vidxOffset||0);this.__updateElement(n,n.__virtualIndex);e.push(n)}else{delete n.__lastUpdatedIndex}}),t);this.__afterElementsUpdated(e)}_isClientFull(){setTimeout((()=>{this.__clientFull=true}));return this.__clientFull||super._isClientFull()}translate3d(t,e,i,n){n.style.transform=`translateY(${e})`}toggleScrollListener(){}__getFocusedElement(t=this.__getVisibleElements()){return t.find((t=>t.contains(this.elementsContainer.getRootNode().activeElement)||t.contains(this.scrollTarget.getRootNode().activeElement)))}__nextFocusableSiblingMissing(t,e){return e.indexOf(t)===e.length-1&&this.size>t.__virtualIndex+1}__previousFocusableSiblingMissing(t,e){return e.indexOf(t)===0&&t.__virtualIndex>0}__onElementFocused(t){if(!this.reorderElements){return}const e=t.detail.element;if(!e){return}const i=this.__getVisibleElements();if(this.__previousFocusableSiblingMissing(e,i)||this.__nextFocusableSiblingMissing(e,i)){this.flush()}const n=this.__getVisibleElements();if(this.__nextFocusableSiblingMissing(e,n)){this._scrollTop+=Math.ceil(e.getBoundingClientRect().bottom)-Math.floor(this.scrollTarget.getBoundingClientRect().bottom-1);this.flush()}else if(this.__previousFocusableSiblingMissing(e,n)){this._scrollTop-=Math.ceil(this.scrollTarget.getBoundingClientRect().top+1)-Math.floor(e.getBoundingClientRect().top);this.flush()}}_scrollHandler(){if(this.scrollTarget.offsetHeight===0){return}this._adjustVirtualIndexOffset(this._scrollTop-(this.__previousScrollTop||0));const t=this.scrollTarget.scrollTop-this._scrollPosition;super._scrollHandler();if(this._physicalCount!==0){const e=t>=0;const i=this._getReusables(!e);if(i.indexes.length){this._physicalTop=i.physicalTop;if(e){this._virtualStart-=i.indexes.length;this._physicalStart-=i.indexes.length}else{this._virtualStart+=i.indexes.length;this._physicalStart+=i.indexes.length}this._resizeHandler()}}if(t){this.__fixInvalidItemPositioningDebouncer=_Nt.debounce(this.__fixInvalidItemPositioningDebouncer,gNt.after(this.timeouts.FIX_INVALID_ITEM_POSITIONING),(()=>this.__fixInvalidItemPositioning()))}if(this.reorderElements){this.__scrollReorderDebouncer=_Nt.debounce(this.__scrollReorderDebouncer,gNt.after(this.timeouts.SCROLL_REORDER),(()=>this.__reorderElements()))}this.__previousScrollTop=this._scrollTop;if(this._scrollTop===0&&this.firstVisibleIndex!==0&&Math.abs(t)>0){this.scrollToIndex(0)}}__fixInvalidItemPositioning(){if(!this.scrollTarget.isConnected){return}const t=this._physicalTop>this._scrollTop;const e=this._physicalBottom<this._scrollBottom;const i=this.adjustedFirstVisibleIndex===0;const n=this.adjustedLastVisibleIndex===this.size-1;if(t&&!i||e&&!n){const t=e;const i=this._ratio;this._ratio=0;this._scrollPosition=this._scrollTop+(t?-1:1);this._scrollHandler();this._ratio=i}}__onWheel(t){if(t.ctrlKey||this._hasScrolledAncestor(t.target,t.deltaX,t.deltaY)){return}let e=t.deltaY;if(t.deltaMode===WheelEvent.DOM_DELTA_LINE){e*=this._scrollLineHeight}else if(t.deltaMode===WheelEvent.DOM_DELTA_PAGE){e*=this._scrollPageHeight}if(!this._deltaYAcc){this._deltaYAcc=0}if(this._wheelAnimationFrame){this._deltaYAcc+=e;t.preventDefault();return}e+=this._deltaYAcc;this._deltaYAcc=0;this._wheelAnimationFrame=true;this.__debouncerWheelAnimationFrame=_Nt.debounce(this.__debouncerWheelAnimationFrame,vNt,(()=>{this._wheelAnimationFrame=false}));const i=Math.abs(t.deltaX)+Math.abs(e);if(this._canScroll(this.scrollTarget,t.deltaX,e)){t.preventDefault();this.scrollTarget.scrollTop+=e;this.scrollTarget.scrollLeft+=t.deltaX;this._hasResidualMomentum=true;this._ignoreNewWheel=true;this._debouncerIgnoreNewWheel=_Nt.debounce(this._debouncerIgnoreNewWheel,gNt.after(this.timeouts.IGNORE_WHEEL),(()=>{this._ignoreNewWheel=false}))}else if(this._hasResidualMomentum&&i<=this._previousMomentum||this._ignoreNewWheel){t.preventDefault()}else if(i>this._previousMomentum){this._hasResidualMomentum=false}this._previousMomentum=i}_hasScrolledAncestor(t,e,i){if(t===this.scrollTarget||t===this.scrollTarget.getRootNode().host){return false}else if(this._canScroll(t,e,i)&&["auto","scroll"].indexOf(getComputedStyle(t).overflow)!==-1){return true}else if(t!==this&&t.parentElement){return this._hasScrolledAncestor(t.parentElement,e,i)}}_canScroll(t,e,i){return i>0&&t.scrollTop<t.scrollHeight-t.offsetHeight||i<0&&t.scrollTop>0||e>0&&t.scrollLeft<t.scrollWidth-t.offsetWidth||e<0&&t.scrollLeft>0}_increasePoolIfNeeded(t){if(this._physicalCount>2&&t){const e=Math.ceil(this._optPhysicalSize/this._physicalAverage);const i=e-this._physicalCount;super._increasePoolIfNeeded(Math.max(t,Math.min(100,i)))}else{super._increasePoolIfNeeded(t)}}get _optPhysicalSize(){const t=super._optPhysicalSize;if(t<=0||this.__hasPlaceholders()){return t}return t+this.__getItemHeightBuffer()}__getItemHeightBuffer(){if(this._physicalCount===0){return 0}const t=Math.ceil(this._viewportHeight*(this._maxPages-1)/2);const e=Math.max(...this._physicalSizes);if(e>Math.min(...this._physicalSizes)){return Math.max(0,e-t)}return 0}_getScrollLineHeight(){const t=document.createElement("div");t.style.fontSize="initial";t.style.display="none";document.body.appendChild(t);const e=window.getComputedStyle(t).fontSize;document.body.removeChild(t);return e?window.parseInt(e):undefined}__getVisibleElements(){return Array.from(this.elementsContainer.children).filter((t=>!t.hidden))}__reorderElements(){if(this.__mouseDown){this.__pendingReorder=true;return}this.__pendingReorder=false;const t=this._virtualStart+(this._vidxOffset||0);const e=this.__getVisibleElements();const i=this.__getFocusedElement(e)||e[0];if(!i){return}const n=i.__virtualIndex-t;const s=e.indexOf(i)-n;if(s>0){for(let t=0;t<s;t++){this.elementsContainer.appendChild(e[t])}}else if(s<0){for(let t=e.length+s;t<e.length;t++){this.elementsContainer.insertBefore(e[t],e[0])}}if(jPt){const{transform:t}=this.scrollTarget.style;this.scrollTarget.style.transform="translateZ(0)";setTimeout((()=>{this.scrollTarget.style.transform=t}))}}_adjustVirtualIndexOffset(t){const e=this._maxVirtualIndexOffset;if(this._virtualCount>=this.size){this._vidxOffset=0}else if(this.__skipNextVirtualIndexAdjust){this.__skipNextVirtualIndexAdjust=false}else if(Math.abs(t)>1e4){const t=this._scrollTop/(this.scrollTarget.scrollHeight-this.scrollTarget.clientHeight);this._vidxOffset=Math.round(t*e)}else{const t=this._vidxOffset;const i=GPt;const n=100;if(this._scrollTop===0){this._vidxOffset=0;if(t!==this._vidxOffset){super.scrollToIndex(0)}}else if(this.firstVisibleIndex<i&&this._vidxOffset>0){this._vidxOffset-=Math.min(this._vidxOffset,n);super.scrollToIndex(this.firstVisibleIndex+(t-this._vidxOffset))}if(this._scrollTop>=this._maxScrollTop&&this._maxScrollTop>0){this._vidxOffset=e;if(t!==this._vidxOffset){super.scrollToIndex(this._virtualCount-1)}}else if(this.firstVisibleIndex>this._virtualCount-i&&this._vidxOffset<e){this._vidxOffset+=Math.min(e-this._vidxOffset,n);super.scrollToIndex(this.firstVisibleIndex-(this._vidxOffset-t))}}}}Object.setPrototypeOf(VPt.prototype,UPt);class qPt{constructor(t){this.__adapter=new VPt(t)}get firstVisibleIndex(){return this.__adapter.adjustedFirstVisibleIndex}get lastVisibleIndex(){return this.__adapter.adjustedLastVisibleIndex}get size(){return this.__adapter.size}set size(t){this.__adapter.size=t}scrollToIndex(t){this.__adapter.scrollToIndex(t)}update(t=0,e=this.size-1){this.__adapter.update(t,e)}flush(){this.__adapter.flush()}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const HPt=t=>class e extends t{static get observers(){return["_a11yUpdateGridSize(size, _columnTree)"]}_a11yGetHeaderRowCount(t){return t.filter((t=>t.some((t=>t.headerRenderer||t.path&&t.header!==null||t.header)))).length}_a11yGetFooterRowCount(t){return t.filter((t=>t.some((t=>t.headerRenderer)))).length}_a11yUpdateGridSize(t,e){if(t===undefined||e===undefined){return}const i=e[e.length-1];this.$.table.setAttribute("aria-rowcount",t+this._a11yGetHeaderRowCount(e)+this._a11yGetFooterRowCount(e));this.$.table.setAttribute("aria-colcount",i&&i.length||0);this._a11yUpdateHeaderRows();this._a11yUpdateFooterRows()}_a11yUpdateHeaderRows(){UNt(this.$.header,((t,e)=>{t.setAttribute("aria-rowindex",e+1)}))}_a11yUpdateFooterRows(){UNt(this.$.footer,((t,e)=>{t.setAttribute("aria-rowindex",this._a11yGetHeaderRowCount(this._columnTree)+this.size+e+1)}))}_a11yUpdateRowRowindex(t,e){t.setAttribute("aria-rowindex",e+this._a11yGetHeaderRowCount(this._columnTree)+1)}_a11yUpdateRowSelected(t,e){t.setAttribute("aria-selected",Boolean(e));BNt(t,(t=>{t.setAttribute("aria-selected",Boolean(e))}))}_a11yUpdateRowExpanded(t){if(this.__isRowExpandable(t)){t.setAttribute("aria-expanded","false")}else if(this.__isRowCollapsible(t)){t.setAttribute("aria-expanded","true")}else{t.removeAttribute("aria-expanded")}}_a11yUpdateRowLevel(t,e){if(e>0||this.__isRowCollapsible(t)||this.__isRowExpandable(t)){t.setAttribute("aria-level",e+1)}else{t.removeAttribute("aria-level")}}_a11ySetRowDetailsCell(t,e){BNt(t,(t=>{if(t!==e){t.setAttribute("aria-controls",e.id)}}))}_a11yUpdateCellColspan(t,e){t.setAttribute("aria-colspan",Number(e))}_a11yUpdateSorters(){Array.from(this.querySelectorAll("vaadin-grid-sorter")).forEach((t=>{let e=t.parentNode;while(e&&e.localName!=="vaadin-grid-cell-content"){e=e.parentNode}if(e&&e.assignedSlot){const i=e.assignedSlot.parentNode;i.setAttribute("aria-sort",{asc:"ascending",desc:"descending"}[String(t.direction)]||"none")}}))}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const WPt=t=>t.offsetParent&&!t.part.contains("body-cell")&&wPt(t)&&getComputedStyle(t).visibility!=="hidden";const ZPt=t=>class e extends t{static get properties(){return{activeItem:{type:Object,notify:true,value:null,sync:true}}}ready(){super.ready();this.$.scroller.addEventListener("click",this._onClick.bind(this));this.addEventListener("cell-activate",this._activateItem.bind(this));this.addEventListener("row-activate",this._activateItem.bind(this))}_activateItem(t){const e=t.detail.model;const i=e?e.item:null;if(i){this.activeItem=!this._itemsEqual(this.activeItem,i)?i:null}}_shouldPreventCellActivationOnClick(t){const{cell:e}=this._getGridEventLocation(t);return t.defaultPrevented||!e||e.getAttribute("part").includes("details-cell")||e===this.$.emptystatecell||e._content.contains(this.getRootNode().activeElement)||this._isFocusable(t.target)||t.target instanceof HTMLLabelElement}_onClick(t){if(this._shouldPreventCellActivationOnClick(t)){return}const{cell:e}=this._getGridEventLocation(t);if(e){this.dispatchEvent(new CustomEvent("cell-activate",{detail:{model:this.__getRowModel(e.parentElement)}}))}}_isFocusable(t){return WPt(t)}};function JPt(t,e){return t.split(".").reduce(((t,e)=>t[e]),e)}function YPt(t,e,i){if(i.length===0){return false}let n=true;t.forEach((({path:t})=>{if(!t||t.indexOf(".")===-1){return}const s=t.replace(/\.[^.]*$/u,"");if(JPt(s,i[0])===undefined){console.warn(`Path "${t}" used for ${e} does not exist in all of the items, ${e} is disabled.`);n=false}}));return n}function KPt(t){if([undefined,null].indexOf(t)>=0){return""}else if(isNaN(t)){return t.toString()}return t}function QPt(t,e){t=KPt(t);e=KPt(e);if(t<e){return-1}if(t>e){return 1}return 0}function XPt(t,e){return t.sort(((t,i)=>e.map((e=>{if(e.direction==="asc"){return QPt(JPt(e.path,t),JPt(e.path,i))}else if(e.direction==="desc"){return QPt(JPt(e.path,i),JPt(e.path,t))}return 0})).reduce(((t,e)=>t!==0?t:e),0)))}function tFt(t,e){return t.filter((t=>e.every((e=>{const i=KPt(JPt(e.path,t));const n=KPt(e.value).toString().toLowerCase();return i.toString().toLowerCase().includes(n)}))))}const eFt=t=>(e,i)=>{let n=t?[...t]:[];if(e.filters&&YPt(e.filters,"filtering",n)){n=tFt(n,e.filters)}if(Array.isArray(e.sortOrders)&&e.sortOrders.length&&YPt(e.sortOrders,"sorting",n)){n=XPt(n,e.sortOrders)}const s=Math.min(n.length,e.pageSize);const r=e.page*s;const o=r+s;const a=n.slice(r,o);i(a,n.length)};
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const iFt=t=>class e extends t{static get properties(){return{items:{type:Array,sync:true}}}static get observers(){return["__dataProviderOrItemsChanged(dataProvider, items, isAttached, items.*)"]}__setArrayDataProvider(t){const e=eFt(this.items);e.__items=t;this._arrayDataProvider=e;this.size=t.length;this.dataProvider=e}_onDataProviderPageReceived(){super._onDataProviderPageReceived();if(this._arrayDataProvider){this.size=this._flatSize}}__dataProviderOrItemsChanged(t,e,i){if(!i){return}if(this._arrayDataProvider){if(t!==this._arrayDataProvider){this._arrayDataProvider=undefined;this.items=undefined}else if(!e){this._arrayDataProvider=undefined;this.dataProvider=undefined;this.size=0;this.clearCache()}else if(this._arrayDataProvider.__items===e){this.clearCache()}else{this.__setArrayDataProvider(e)}}else if(e){this.__setArrayDataProvider(e)}}}
/**
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/;const nFt=false;const sFt=t=>t;const rFt=typeof document.head.style.touchAction==="string";const oFt="__polymerGestures";const aFt="__polymerGesturesHandled";const lFt="__polymerGesturesTouchAction";const uFt=25;const cFt=5;const hFt=2;const dFt=["mousedown","mousemove","mouseup","click"];const fFt=[0,1,4,2];const pFt=function(){try{return new MouseEvent("test",{buttons:1}).buttons===1}catch(t){return false}}();function mFt(t){return dFt.indexOf(t)>-1}let yFt=false;(function(){try{const t=Object.defineProperty({},"passive",{get(){yFt=true}});window.addEventListener("test",null,t);window.removeEventListener("test",null,t)}catch(t){}})();function gFt(t){if(mFt(t)||t==="touchend"){return}if(rFt&&yFt&&nFt){return{passive:true}}}const vFt=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/u);const wFt={button:true,command:true,fieldset:true,input:true,keygen:true,optgroup:true,option:true,select:true,textarea:true};function bFt(t){const e=t.type;if(!mFt(e)){return false}if(e==="mousemove"){let e=t.buttons===undefined?1:t.buttons;if(t instanceof window.MouseEvent&&!pFt){e=fFt[t.which]||0}return Boolean(e&1)}const i=t.button===undefined?0:t.button;return i===0}function SFt(t){if(t.type==="click"){if(t.detail===0){return true}const e=EFt(t);if(!e.nodeType||e.nodeType!==Node.ELEMENT_NODE){return true}const i=e.getBoundingClientRect();const n=t.pageX,s=t.pageY;return!(n>=i.left&&n<=i.right&&s>=i.top&&s<=i.bottom)}return false}const _Ft={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:false}};function xFt(t){let e="auto";const i=AFt(t);for(let t=0,n;t<i.length;t++){n=i[t];if(n[lFt]){e=n[lFt];break}}return e}function MFt(t,e,i){t.movefn=e;t.upfn=i;document.addEventListener("mousemove",e);document.addEventListener("mouseup",i)}function TFt(t){document.removeEventListener("mousemove",t.movefn);document.removeEventListener("mouseup",t.upfn);t.movefn=null;t.upfn=null}const AFt=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:t=>t.composedPath&&t.composedPath()||[];const IFt={};const kFt=[];function CFt(t,e){let i=document.elementFromPoint(t,e);let n=i;while(n&&n.shadowRoot&&!window.ShadyDOM){const s=n;n=n.shadowRoot.elementFromPoint(t,e);if(s===n){break}if(n){i=n}}return i}function EFt(t){const e=AFt(t);return e.length>0?e[0]:t.target}function jFt(t){const e=t.type;const i=t.currentTarget;const n=i[oFt];if(!n){return}const s=n[e];if(!s){return}if(!t[aFt]){t[aFt]={};if(e.startsWith("touch")){const i=t.changedTouches[0];if(e==="touchstart"){if(t.touches.length===1){_Ft.touch.id=i.identifier}}if(_Ft.touch.id!==i.identifier){return}if(!rFt){if(e==="touchstart"||e==="touchmove"){OFt(t)}}}}const r=t[aFt];if(r.skip){return}for(let e=0,i;e<kFt.length;e++){i=kFt[e];if(s[i.name]&&!r[i.name]){if(i.flow&&i.flow.start.indexOf(t.type)>-1&&i.reset){i.reset()}}}for(let i=0,n;i<kFt.length;i++){n=kFt[i];if(s[n.name]&&!r[n.name]){r[n.name]=true;n[e](t)}}}function OFt(t){const e=t.changedTouches[0];const i=t.type;if(i==="touchstart"){_Ft.touch.x=e.clientX;_Ft.touch.y=e.clientY;_Ft.touch.scrollDecided=false}else if(i==="touchmove"){if(_Ft.touch.scrollDecided){return}_Ft.touch.scrollDecided=true;const i=xFt(t);let n=false;const s=Math.abs(_Ft.touch.x-e.clientX);const r=Math.abs(_Ft.touch.y-e.clientY);if(!t.cancelable);else if(i==="none"){n=true}else if(i==="pan-x"){n=r>s}else if(i==="pan-y"){n=s>r}if(n){t.preventDefault()}else{$Ft("track")}}}function RFt(t,e,i){if(IFt[e]){LFt(t,e,i);return true}return false}function LFt(t,e,i){const n=IFt[e];const s=n.deps;const r=n.name;let o=t[oFt];if(!o){t[oFt]=o={}}for(let e=0,i,n;e<s.length;e++){i=s[e];if(vFt&&mFt(i)&&i!=="click"){continue}n=o[i];if(!n){o[i]=n={_count:0}}if(n._count===0){t.addEventListener(i,jFt,gFt(i))}n[r]=(n[r]||0)+1;n._count=(n._count||0)+1}t.addEventListener(e,i);if(n.touchAction){FFt(t,n.touchAction)}}function NFt(t){kFt.push(t);t.emits.forEach((e=>{IFt[e]=t}))}function PFt(t){for(let e=0,i;e<kFt.length;e++){i=kFt[e];for(let e=0,n;e<i.emits.length;e++){n=i.emits[e];if(n===t){return i}}}return null}function FFt(t,e){if(rFt&&t instanceof HTMLElement){bNt.run((()=>{t.style.touchAction=e}))}t[lFt]=e}function DFt(t,e,i){const n=new Event(e,{bubbles:true,cancelable:true,composed:true});n.detail=i;sFt(t).dispatchEvent(n);if(n.defaultPrevented){const t=i.preventer||i.sourceEvent;if(t&&t.preventDefault){t.preventDefault()}}}function $Ft(t){const e=PFt(t);if(e.info){e.info.prevent=true}}NFt({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset(){TFt(this.info)},mousedown(t){if(!bFt(t)){return}const e=EFt(t);const i=this;const n=t=>{if(!bFt(t)){zFt("up",e,t);TFt(i.info)}};const s=t=>{if(bFt(t)){zFt("up",e,t)}TFt(i.info)};MFt(this.info,n,s);zFt("down",e,t)},touchstart(t){zFt("down",EFt(t),t.changedTouches[0],t)},touchend(t){zFt("up",EFt(t),t.changedTouches[0],t)}});function zFt(t,e,i,n){if(!e){return}DFt(e,t,{x:i.clientX,y:i.clientY,sourceEvent:i,preventer:n,prevent(t){return $Ft(t)}})}NFt({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:false,moves:[],addMove(t){if(this.moves.length>hFt){this.moves.shift()}this.moves.push(t)},movefn:null,upfn:null,prevent:false},reset(){this.info.state="start";this.info.started=false;this.info.moves=[];this.info.x=0;this.info.y=0;this.info.prevent=false;TFt(this.info)},mousedown(t){if(!bFt(t)){return}const e=EFt(t);const i=this;const n=t=>{const n=t.clientX,s=t.clientY;if(UFt(i.info,n,s)){i.info.state=i.info.started?t.type==="mouseup"?"end":"track":"start";if(i.info.state==="start"){$Ft("tap")}i.info.addMove({x:n,y:s});if(!bFt(t)){i.info.state="end";TFt(i.info)}if(e){BFt(i.info,e,t)}i.info.started=true}};const s=t=>{if(i.info.started){n(t)}TFt(i.info)};MFt(this.info,n,s);this.info.x=t.clientX;this.info.y=t.clientY},touchstart(t){const e=t.changedTouches[0];this.info.x=e.clientX;this.info.y=e.clientY},touchmove(t){const e=EFt(t);const i=t.changedTouches[0];const n=i.clientX,s=i.clientY;if(UFt(this.info,n,s)){if(this.info.state==="start"){$Ft("tap")}this.info.addMove({x:n,y:s});BFt(this.info,e,i);this.info.state="track";this.info.started=true}},touchend(t){const e=EFt(t);const i=t.changedTouches[0];if(this.info.started){this.info.state="end";this.info.addMove({x:i.clientX,y:i.clientY});BFt(this.info,e,i)}}});function UFt(t,e,i){if(t.prevent){return false}if(t.started){return true}const n=Math.abs(t.x-e);const s=Math.abs(t.y-i);return n>=cFt||s>=cFt}function BFt(t,e,i){if(!e){return}const n=t.moves[t.moves.length-2];const s=t.moves[t.moves.length-1];const r=s.x-t.x;const o=s.y-t.y;let a,l=0;if(n){a=s.x-n.x;l=s.y-n.y}DFt(e,"track",{state:t.state,x:i.clientX,y:i.clientY,dx:r,dy:o,ddx:a,ddy:l,sourceEvent:i,hover(){return CFt(i.clientX,i.clientY)}})}NFt({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:false},reset(){this.info.x=NaN;this.info.y=NaN;this.info.prevent=false},mousedown(t){if(bFt(t)){this.info.x=t.clientX;this.info.y=t.clientY}},click(t){if(bFt(t)){GFt(this.info,t)}},touchstart(t){const e=t.changedTouches[0];this.info.x=e.clientX;this.info.y=e.clientY},touchend(t){GFt(this.info,t.changedTouches[0],t)}});function GFt(t,e,i){const n=Math.abs(e.clientX-t.x);const s=Math.abs(e.clientY-t.y);const r=EFt(i||e);if(!r||wFt[r.localName]&&r.hasAttribute("disabled")){return}if(isNaN(n)||isNaN(s)||n<=uFt&&s<=uFt||SFt(e)){if(!t.prevent){DFt(r,"tap",{x:e.clientX,y:e.clientY,sourceEvent:e,preventer:i})}}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const VFt=t=>class e extends t{static get properties(){return{columnReorderingAllowed:{type:Boolean,value:false},_orderBaseScope:{type:Number,value:1e7}}}static get observers(){return["_updateOrders(_columnTree)"]}ready(){super.ready();RFt(this,"track",this._onTrackEvent);this._reorderGhost=this.shadowRoot.querySelector('[part="reorder-ghost"]');this.addEventListener("touchstart",this._onTouchStart.bind(this));this.addEventListener("touchmove",this._onTouchMove.bind(this));this.addEventListener("touchend",this._onTouchEnd.bind(this));this.addEventListener("contextmenu",this._onContextMenu.bind(this))}_onContextMenu(t){if(this.hasAttribute("reordering")){t.preventDefault();if(!OPt){this._onTrackEnd()}}}_onTouchStart(t){this._startTouchReorderTimeout=setTimeout((()=>{this._onTrackStart({detail:{x:t.touches[0].clientX,y:t.touches[0].clientY}})}),100)}_onTouchMove(t){if(this._draggedColumn){t.preventDefault()}clearTimeout(this._startTouchReorderTimeout)}_onTouchEnd(){clearTimeout(this._startTouchReorderTimeout);this._onTrackEnd()}_onTrackEvent(t){if(t.detail.state==="start"){const e=t.composedPath();const i=e[e.indexOf(this.$.header)-2];if(!i||!i._content){return}if(i._content.contains(this.getRootNode().activeElement)){return}if(this.$.scroller.hasAttribute("column-resizing")){return}if(!this._touchDevice){this._onTrackStart(t)}}else if(t.detail.state==="track"){this._onTrack(t)}else if(t.detail.state==="end"){this._onTrackEnd(t)}}_onTrackStart(t){if(!this.columnReorderingAllowed){return}const e=t.composedPath&&t.composedPath();if(e&&e.some((t=>t.hasAttribute&&t.hasAttribute("draggable")))){return}const i=this._cellFromPoint(t.detail.x,t.detail.y);if(!i||!i.getAttribute("part").includes("header-cell")){return}this.toggleAttribute("reordering",true);this._draggedColumn=i._column;while(this._draggedColumn.parentElement.childElementCount===1){this._draggedColumn=this._draggedColumn.parentElement}this._setSiblingsReorderStatus(this._draggedColumn,"allowed");this._draggedColumn._reorderStatus="dragging";this._updateGhost(i);this._reorderGhost.style.visibility="visible";this._updateGhostPosition(t.detail.x,this._touchDevice?t.detail.y-50:t.detail.y);this._autoScroller()}_onTrack(t){if(!this._draggedColumn){return}const e=this._cellFromPoint(t.detail.x,t.detail.y);if(!e){return}const i=this._getTargetColumn(e,this._draggedColumn);if(this._isSwapAllowed(this._draggedColumn,i)&&this._isSwappableByPosition(i,t.detail.x)){const t=this._columnTree.findIndex((t=>t.includes(i)));const e=this._getColumnsInOrder(t);const n=e.indexOf(this._draggedColumn);const s=e.indexOf(i);const r=n<s?1:-1;for(let t=n;t!==s;t+=r){this._swapColumnOrders(this._draggedColumn,e[t+r])}}this._updateGhostPosition(t.detail.x,this._touchDevice?t.detail.y-50:t.detail.y);this._lastDragClientX=t.detail.x}_onTrackEnd(){if(!this._draggedColumn){return}this.toggleAttribute("reordering",false);this._draggedColumn._reorderStatus="";this._setSiblingsReorderStatus(this._draggedColumn,"");this._draggedColumn=null;this._lastDragClientX=null;this._reorderGhost.style.visibility="hidden";this.dispatchEvent(new CustomEvent("column-reorder",{detail:{columns:this._getColumnsInOrder()}}))}_getColumnsInOrder(t=this._columnTree.length-1){return this._columnTree[t].filter((t=>!t.hidden)).sort(((t,e)=>t._order-e._order))}_cellFromPoint(t=0,e=0){if(!this._draggedColumn){this.$.scroller.toggleAttribute("no-content-pointer-events",true)}const i=this.shadowRoot.elementFromPoint(t,e);this.$.scroller.toggleAttribute("no-content-pointer-events",false);return this._getCellFromElement(i)}_getCellFromElement(t){if(t){if(t._column){return t}const{parentElement:e}=t;if(e&&e._focusButton===t){return e}}return null}_updateGhostPosition(t,e){const i=this._reorderGhost.getBoundingClientRect();const n=t-i.width/2;const s=e-i.height/2;const r=parseInt(this._reorderGhost._left||0);const o=parseInt(this._reorderGhost._top||0);this._reorderGhost._left=r-(i.left-n);this._reorderGhost._top=o-(i.top-s);this._reorderGhost.style.transform=`translate(${this._reorderGhost._left}px, ${this._reorderGhost._top}px)`}_updateGhost(t){const e=this._reorderGhost;e.textContent=t._content.innerText;const i=window.getComputedStyle(t);["boxSizing","display","width","height","background","alignItems","padding","border","flex-direction","overflow"].forEach((t=>{e.style[t]=i[t]}));return e}_updateOrders(t){if(t===undefined){return}t[0].forEach((t=>{t._order=0}));GNt(t[0],this._orderBaseScope,0)}_setSiblingsReorderStatus(t,e){UNt(t.parentNode,(i=>{if(/column/u.test(i.localName)&&this._isSwapAllowed(i,t)){i._reorderStatus=e}}))}_autoScroller(){if(this._lastDragClientX){const t=this._lastDragClientX-this.getBoundingClientRect().right+50;const e=this.getBoundingClientRect().left-this._lastDragClientX+50;if(t>0){this.$.table.scrollLeft+=t/10}else if(e>0){this.$.table.scrollLeft-=e/10}}if(this._draggedColumn){setTimeout((()=>this._autoScroller()),10)}}_isSwapAllowed(t,e){if(t&&e){const i=t!==e;const n=t.parentElement===e.parentElement;const s=t.frozen&&e.frozen||t.frozenToEnd&&e.frozenToEnd||!t.frozen&&!t.frozenToEnd&&!e.frozen&&!e.frozenToEnd;return i&&n&&s}}_isSwappableByPosition(t,e){const i=Array.from(this.$.header.querySelectorAll('tr:not([hidden]) [part~="cell"]')).find((e=>t.contains(e._column)));const n=this.$.header.querySelector("tr:not([hidden]) [reorder-status=dragging]").getBoundingClientRect();const s=i.getBoundingClientRect();if(s.left>n.left){return e>s.right-n.width}return e<s.left+n.width}_swapColumnOrders(t,e){[t._order,e._order]=[e._order,t._order];this._debounceUpdateFrozenColumn();this._updateFirstAndLastColumn()}_getTargetColumn(t,e){if(t&&e){let i=t._column;while(i.parentElement!==e.parentElement&&i!==this){i=i.parentElement}if(i.parentElement===e.parentElement){return i}return t._column}}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const qFt=t=>class e extends t{ready(){super.ready();const t=this.$.scroller;RFt(t,"track",this._onHeaderTrack.bind(this));t.addEventListener("touchmove",(e=>t.hasAttribute("column-resizing")&&e.preventDefault()));t.addEventListener("contextmenu",(t=>t.target.getAttribute("part")==="resize-handle"&&t.preventDefault()));t.addEventListener("mousedown",(t=>t.target.getAttribute("part")==="resize-handle"&&t.preventDefault()))}_onHeaderTrack(t){const e=t.target;if(e.getAttribute("part")==="resize-handle"){const i=e.parentElement;let n=i._column;this.$.scroller.toggleAttribute("column-resizing",true);while(n.localName==="vaadin-grid-column-group"){n=n._childColumns.slice(0).sort(((t,e)=>t._order-e._order)).filter((t=>!t.hidden)).pop()}const s=this.__isRTL;const r=t.detail.x;const o=Array.from(this.$.header.querySelectorAll('[part~="row"]:last-child [part~="cell"]'));const a=o.find((t=>t._column===n));if(a.offsetWidth){const t=getComputedStyle(a._content);const e=10+parseInt(t.paddingLeft)+parseInt(t.paddingRight)+parseInt(t.borderLeftWidth)+parseInt(t.borderRightWidth)+parseInt(t.marginLeft)+parseInt(t.marginRight);let i;const o=a.offsetWidth;const l=a.getBoundingClientRect();if(a.hasAttribute("frozen-to-end")){i=o+(s?r-l.right:l.left-r)}else{i=o+(s?l.left-r:r-l.right)}n.width=`${Math.max(e,i)}px`;n.flexGrow=0}o.sort(((t,e)=>t._column._order-e._column._order)).forEach(((t,e,i)=>{if(e<i.indexOf(a)){t._column.width=`${t.offsetWidth}px`;t._column.flexGrow=0}}));const l=this._frozenToEndCells[0];if(l&&this.$.table.scrollWidth>this.$.table.offsetWidth){const t=l.getBoundingClientRect();const e=r-(s?t.right:t.left);if(s&&e<=0||!s&&e>=0){this.$.table.scrollLeft+=e}}if(t.detail.state==="end"){this.$.scroller.toggleAttribute("column-resizing",false);this.dispatchEvent(new CustomEvent("column-resize",{detail:{resizedColumn:n}}))}this._resizeHandler()}}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;function HFt(t,e,i=0){let n=e;for(const e of t.subCaches){const t=e.parentCacheIndex;if(n<=t){break}else if(n<=t+e.flatSize){return HFt(e,n-t-1,i+1)}n-=e.flatSize}return{cache:t,item:t.items[n],index:n,page:Math.floor(n/t.pageSize),level:i}}function WFt({getItemId:t},e,i,n=0,s=0){for(let r=0;r<e.items.length;r++){const o=e.items[r];if(!!o&&t(o)===t(i)){return{cache:e,level:n,item:o,index:r,page:Math.floor(r/e.pageSize),subCache:e.getSubCache(r),flatIndex:s+e.getFlatIndex(r)}}}for(const r of e.subCaches){const o=s+e.getFlatIndex(r.parentCacheIndex);const a=WFt({getItemId:t},r,i,n+1,o+1);if(a){return a}}}function ZFt(t,[e,...i],n=0){if(e===Infinity){e=t.size-1}const s=t.getFlatIndex(e);const r=t.getSubCache(e);if(r&&r.flatSize>0&&i.length){return ZFt(r,i,n+s+1)}return n+s}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class JFt{context;pageSize;items=[];pendingRequests={};__subCacheByIndex={};__size=0;__flatSize=0;constructor(t,e,i,n,s){this.context=t;this.pageSize=e;this.size=i;this.parentCache=n;this.parentCacheIndex=s;this.__flatSize=i||0}get parentItem(){return this.parentCache&&this.parentCache.items[this.parentCacheIndex]}get subCaches(){return Object.values(this.__subCacheByIndex)}get isLoading(){if(Object.keys(this.pendingRequests).length>0){return true}return this.subCaches.some((t=>t.isLoading))}get flatSize(){return this.__flatSize}get effectiveSize(){console.warn("<vaadin-grid> The `effectiveSize` property of ItemCache is deprecated and will be removed in Vaadin 25.");return this.flatSize}get size(){return this.__size}set size(t){const e=this.__size;if(e===t){return}this.__size=t;if(this.context.placeholder!==undefined){this.items.length=t||0;for(let e=0;e<t||0;e++){this.items[e]||=this.context.placeholder}}Object.keys(this.pendingRequests).forEach((t=>{const e=parseInt(t)*this.pageSize;if(e>=this.size||0){delete this.pendingRequests[t]}}))}recalculateFlatSize(){this.__flatSize=!this.parentItem||this.context.isExpanded(this.parentItem)?this.size+this.subCaches.reduce(((t,e)=>{e.recalculateFlatSize();return t+e.flatSize}),0):0}setPage(t,e){const i=t*this.pageSize;e.forEach(((t,e)=>{const n=i+e;if(this.size===undefined||n<this.size){this.items[n]=t}}))}getSubCache(t){return this.__subCacheByIndex[t]}removeSubCache(t){delete this.__subCacheByIndex[t]}removeSubCaches(){this.__subCacheByIndex={}}createSubCache(t){const e=new JFt(this.context,this.pageSize,0,this,t);this.__subCacheByIndex[t]=e;return e}getFlatIndex(t){const e=Math.max(0,Math.min(this.size-1,t));return this.subCaches.reduce(((t,i)=>{const n=i.parentCacheIndex;return e>n?t+i.flatSize:t}),e)}getItemForIndex(t){console.warn("<vaadin-grid> The `getItemForIndex` method of ItemCache is deprecated and will be removed in Vaadin 25.");const{item:e}=HFt(this,t);return e}getCacheAndIndex(t){console.warn("<vaadin-grid> The `getCacheAndIndex` method of ItemCache is deprecated and will be removed in Vaadin 25.");const{cache:e,index:i}=HFt(this,t);return{cache:e,scaledIndex:i}}updateSize(){console.warn("<vaadin-grid> The `updateSize` method of ItemCache is deprecated and will be removed in Vaadin 25.");this.recalculateFlatSize()}ensureSubCacheForScaledIndex(t){console.warn("<vaadin-grid> The `ensureSubCacheForScaledIndex` method of ItemCache is deprecated and will be removed in Vaadin 25.");if(!this.getSubCache(t)){const e=this.createSubCache(t);this.context.__controller.__loadCachePage(e,0)}}get grid(){console.warn("<vaadin-grid> The `grid` property of ItemCache is deprecated and will be removed in Vaadin 25.");return this.context.__controller.host}get itemCaches(){console.warn("<vaadin-grid> The `itemCaches` property of ItemCache is deprecated and will be removed in Vaadin 25.");return this.__subCacheByIndex}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class YFt extends EventTarget{host;dataProvider;dataProviderParams;pageSize;isExpanded;getItemId;rootCache;placeholder;isPlaceholder;constructor(t,{size:e,pageSize:i,isExpanded:n,getItemId:s,isPlaceholder:r,placeholder:o,dataProvider:a,dataProviderParams:l}){super();this.host=t;this.pageSize=i;this.getItemId=s;this.isExpanded=n;this.placeholder=o;this.isPlaceholder=r;this.dataProvider=a;this.dataProviderParams=l;this.rootCache=this.__createRootCache(e)}get flatSize(){return this.rootCache.flatSize}get __cacheContext(){return{isExpanded:this.isExpanded,placeholder:this.placeholder,__controller:this}}isLoading(){return this.rootCache.isLoading}setPageSize(t){this.pageSize=t;this.clearCache()}setDataProvider(t){this.dataProvider=t;this.clearCache()}recalculateFlatSize(){this.rootCache.recalculateFlatSize()}clearCache(){this.rootCache=this.__createRootCache(this.rootCache.size)}getFlatIndexContext(t){return HFt(this.rootCache,t)}getItemContext(t){return WFt({getItemId:this.getItemId},this.rootCache,t)}getFlatIndexByPath(t){return ZFt(this.rootCache,t)}ensureFlatIndexLoaded(t){const{cache:e,page:i,item:n}=this.getFlatIndexContext(t);if(!this.__isItemLoaded(n)){this.__loadCachePage(e,i)}}ensureFlatIndexHierarchy(t){const{cache:e,item:i,index:n}=this.getFlatIndexContext(t);if(this.__isItemLoaded(i)&&this.isExpanded(i)&&!e.getSubCache(n)){const t=e.createSubCache(n);this.__loadCachePage(t,0)}}loadFirstPage(){this.__loadCachePage(this.rootCache,0)}__createRootCache(t){return new JFt(this.__cacheContext,this.pageSize,t)}__loadCachePage(t,e){if(!this.dataProvider||t.pendingRequests[e]){return}let i={page:e,pageSize:this.pageSize,parentItem:t.parentItem};if(this.dataProviderParams){i={...i,...this.dataProviderParams()}}const n=(s,r)=>{if(t.pendingRequests[e]!==n){return}if(r!==undefined){t.size=r}else if(i.parentItem){t.size=s.length}t.setPage(e,s);this.recalculateFlatSize();this.dispatchEvent(new CustomEvent("page-received"));delete t.pendingRequests[e];this.dispatchEvent(new CustomEvent("page-loaded"))};t.pendingRequests[e]=n;this.dispatchEvent(new CustomEvent("page-requested"));this.dataProvider(i,n)}__isItemLoaded(t){if(this.isPlaceholder){return!this.isPlaceholder(t)}else if(this.placeholder){return t!==this.placeholder}return!!t}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const KFt=t=>class e extends t{static get properties(){return{size:{type:Number,notify:true,sync:true},_flatSize:{type:Number,sync:true},pageSize:{type:Number,value:50,observer:"_pageSizeChanged",sync:true},dataProvider:{type:Object,notify:true,observer:"_dataProviderChanged",sync:true},loading:{type:Boolean,notify:true,readOnly:true,reflectToAttribute:true},_hasData:{type:Boolean,value:false,sync:true},itemHasChildrenPath:{type:String,value:"children",observer:"__itemHasChildrenPathChanged",sync:true},itemIdPath:{type:String,value:null,sync:true},expandedItems:{type:Object,notify:true,value:()=>[],sync:true},__expandedKeys:{type:Object,computed:"__computeExpandedKeys(itemIdPath, expandedItems)"}}}static get observers(){return["_sizeChanged(size)","_expandedItemsChanged(expandedItems)"]}constructor(){super();this._dataProviderController=new YFt(this,{size:this.size||0,pageSize:this.pageSize,getItemId:this.getItemId.bind(this),isExpanded:this._isExpanded.bind(this),dataProvider:this.dataProvider?this.dataProvider.bind(this):null,dataProviderParams:()=>({sortOrders:this._mapSorters(),filters:this._mapFilters()})});this._dataProviderController.addEventListener("page-requested",this._onDataProviderPageRequested.bind(this));this._dataProviderController.addEventListener("page-received",this._onDataProviderPageReceived.bind(this));this._dataProviderController.addEventListener("page-loaded",this._onDataProviderPageLoaded.bind(this))}get _cache(){console.warn("<vaadin-grid> The `_cache` property is deprecated and will be removed in Vaadin 25.");return this._dataProviderController.rootCache}get _effectiveSize(){console.warn("<vaadin-grid> The `_effectiveSize` property is deprecated and will be removed in Vaadin 25.");return this._flatSize}_sizeChanged(t){this._dataProviderController.rootCache.size=t;this._dataProviderController.recalculateFlatSize();this._flatSize=this._dataProviderController.flatSize}__itemHasChildrenPathChanged(t,e){if(!e&&t==="children"){return}this.requestContentUpdate()}_getItem(t,e){e.index=t;const{item:i}=this._dataProviderController.getFlatIndexContext(t);if(i){this.__updateLoading(e,false);this._updateItem(e,i);if(this._isExpanded(i)){this._dataProviderController.ensureFlatIndexHierarchy(t)}}else{this.__updateLoading(e,true);this._dataProviderController.ensureFlatIndexLoaded(t)}}__updateLoading(t,e){const i=zNt(t);VNt(t,"loading",e);HNt(i,"loading-row-cell",e);if(e){this._generateCellClassNames(t);this._generateCellPartNames(t)}}getItemId(t){return this.itemIdPath?ONt(this.itemIdPath,t):t}_isExpanded(t){return this.__expandedKeys&&this.__expandedKeys.has(this.getItemId(t))}_expandedItemsChanged(){this._dataProviderController.recalculateFlatSize();this._flatSize=this._dataProviderController.flatSize;this.__updateVisibleRows()}__computeExpandedKeys(t,e){const i=e||[];const n=new Set;i.forEach((t=>{n.add(this.getItemId(t))}));return n}expandItem(t){if(!this._isExpanded(t)){this.expandedItems=[...this.expandedItems,t]}}collapseItem(t){if(this._isExpanded(t)){this.expandedItems=this.expandedItems.filter((e=>!this._itemsEqual(e,t)))}}_getIndexLevel(t=0){const{level:e}=this._dataProviderController.getFlatIndexContext(t);return e}_loadPage(t,e){console.warn("<vaadin-grid> The `_loadPage` method is deprecated and will be removed in Vaadin 25.");this._dataProviderController.__loadCachePage(e,t)}_onDataProviderPageRequested(){this._setLoading(true)}_onDataProviderPageReceived(){if(this._flatSize!==this._dataProviderController.flatSize){this._shouldUpdateAllRenderedRowsAfterPageLoad=true;this._flatSize=this._dataProviderController.flatSize}this._getRenderedRows().forEach((t=>{this._dataProviderController.ensureFlatIndexHierarchy(t.index)}));this._hasData=true}_onDataProviderPageLoaded(){this._debouncerApplyCachedData=_Nt.debounce(this._debouncerApplyCachedData,gNt.after(0),(()=>{this._setLoading(false);const t=this._shouldUpdateAllRenderedRowsAfterPageLoad;this._shouldUpdateAllRenderedRowsAfterPageLoad=false;this._getRenderedRows().forEach((e=>{const{item:i}=this._dataProviderController.getFlatIndexContext(e.index);if(i||t){this._getItem(e.index,e)}}));this.__scrollToPendingIndexes();this.__dispatchPendingBodyCellFocus()}));if(!this._dataProviderController.isLoading()){this._debouncerApplyCachedData.flush()}}__debounceClearCache(){this.__clearCacheDebouncer=_Nt.debounce(this.__clearCacheDebouncer,bNt,(()=>this.clearCache()))}clearCache(){this._dataProviderController.clearCache();this._dataProviderController.rootCache.size=this.size;this._dataProviderController.recalculateFlatSize();this._hasData=false;this.__updateVisibleRows();if(!this.__virtualizer||!this.__virtualizer.size){this._dataProviderController.loadFirstPage()}}_pageSizeChanged(t,e){this._dataProviderController.setPageSize(t);if(e!==undefined&&t!==e){this.clearCache()}}_checkSize(){if(this.size===undefined&&this._flatSize===0){console.warn("The <vaadin-grid> needs the total number of items in"+" order to display rows, which you can specify either by setting"+" the `size` property, or by providing it to the second argument"+" of the `dataProvider` function `callback` call.")}}_dataProviderChanged(t,e){this._dataProviderController.setDataProvider(t?t.bind(this):null);if(e!==undefined){this.clearCache()}this._ensureFirstPageLoaded();this._debouncerCheckSize=_Nt.debounce(this._debouncerCheckSize,gNt.after(2e3),this._checkSize.bind(this))}_ensureFirstPageLoaded(){if(!this._hasData){this._dataProviderController.loadFirstPage()}}_itemsEqual(t,e){return this.getItemId(t)===this.getItemId(e)}_getItemIndexInArray(t,e){let i=-1;e.forEach(((e,n)=>{if(this._itemsEqual(e,t)){i=n}}));return i}scrollToIndex(...t){let e;while(e!==(e=this._dataProviderController.getFlatIndexByPath(t))){this._scrollToFlatIndex(e)}if(this._dataProviderController.isLoading()||!this.clientHeight){this.__pendingScrollToIndexes=t}}__scrollToPendingIndexes(){if(this.__pendingScrollToIndexes&&this.$.items.children.length){const t=this.__pendingScrollToIndexes;delete this.__pendingScrollToIndexes;this.scrollToIndex(...t)}}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const QFt={BETWEEN:"between",ON_TOP:"on-top",ON_TOP_OR_BETWEEN:"on-top-or-between",ON_GRID:"on-grid"};const XFt={ON_TOP:"on-top",ABOVE:"above",BELOW:"below",EMPTY:"empty"};const tDt=!("draggable"in document.createElement("div"));const eDt=t=>class e extends t{static get properties(){return{dropMode:{type:String,sync:true},rowsDraggable:{type:Boolean,sync:true},dragFilter:{type:Function,sync:true},dropFilter:{type:Function,sync:true},__dndAutoScrollThreshold:{value:50},__draggedItems:{value:()=>[]}}}static get observers(){return["_dragDropAccessChanged(rowsDraggable, dropMode, dragFilter, dropFilter, loading)"]}constructor(){super();this.__onDocumentDragStart=this.__onDocumentDragStart.bind(this)}ready(){super.ready();this.$.table.addEventListener("dragstart",this._onDragStart.bind(this));this.$.table.addEventListener("dragend",this._onDragEnd.bind(this));this.$.table.addEventListener("dragover",this._onDragOver.bind(this));this.$.table.addEventListener("dragleave",this._onDragLeave.bind(this));this.$.table.addEventListener("drop",this._onDrop.bind(this));this.$.table.addEventListener("dragenter",(t=>{if(this.dropMode){t.preventDefault();t.stopPropagation()}}))}connectedCallback(){super.connectedCallback();document.addEventListener("dragstart",this.__onDocumentDragStart,{capture:true})}disconnectedCallback(){super.disconnectedCallback();document.removeEventListener("dragstart",this.__onDocumentDragStart,{capture:true})}_onDragStart(t){if(this.rowsDraggable){let e=t.target;if(e.localName==="vaadin-grid-cell-content"){e=e.assignedSlot.parentNode.parentNode}if(e.parentNode!==this.$.items){return}t.stopPropagation();this.toggleAttribute("dragging-rows",true);if(this._safari){const t=e.style.transform;e.style.top=/translateY\((.*)\)/u.exec(t)[1];e.style.transform="none";requestAnimationFrame((()=>{e.style.top="";e.style.transform=t}))}const i=e.getBoundingClientRect();if(tDt){t.dataTransfer.setDragImage(e)}else{t.dataTransfer.setDragImage(e,t.clientX-i.left,t.clientY-i.top)}let n=[e];if(this._isSelected(e._item)){n=this.__getViewportRows().filter((t=>this._isSelected(t._item))).filter((t=>!this.dragFilter||this.dragFilter(this.__getRowModel(t))))}this.__draggedItems=n.map((t=>t._item));t.dataTransfer.setData("text",this.__formatDefaultTransferData(n));WNt(e,{dragstart:n.length>1?`${n.length}`:""});this.style.setProperty("--_grid-drag-start-x",`${t.clientX-i.left+20}px`);this.style.setProperty("--_grid-drag-start-y",`${t.clientY-i.top+10}px`);requestAnimationFrame((()=>{WNt(e,{dragstart:false});this.style.setProperty("--_grid-drag-start-x","");this.style.setProperty("--_grid-drag-start-y","");this.requestContentUpdate()}));const s=new CustomEvent("grid-dragstart",{detail:{draggedItems:[...this.__draggedItems],setDragData:(e,i)=>t.dataTransfer.setData(e,i),setDraggedItemsCount:t=>e.setAttribute("dragstart",t)}});s.originalEvent=t;this.dispatchEvent(s)}}_onDragEnd(t){this.toggleAttribute("dragging-rows",false);t.stopPropagation();const e=new CustomEvent("grid-dragend");e.originalEvent=t;this.dispatchEvent(e);this.__draggedItems=[];this.requestContentUpdate()}_onDragLeave(t){t.stopPropagation();this._clearDragStyles()}_onDragOver(t){if(this.dropMode){this._dropLocation=undefined;this._dragOverItem=undefined;if(this.__dndAutoScroll(t.clientY)){this._clearDragStyles();return}let e=t.composedPath().find((t=>t.localName==="tr"));if(!this._flatSize||this.dropMode===QFt.ON_GRID){this._dropLocation=XFt.EMPTY}else if(!e||e.parentNode!==this.$.items){if(e){return}else if(this.dropMode===QFt.BETWEEN||this.dropMode===QFt.ON_TOP_OR_BETWEEN){e=Array.from(this.$.items.children).filter((t=>!t.hidden)).pop();this._dropLocation=XFt.BELOW}else{return}}else{const i=e.getBoundingClientRect();this._dropLocation=XFt.ON_TOP;if(this.dropMode===QFt.BETWEEN){const e=t.clientY-i.top<i.bottom-t.clientY;this._dropLocation=e?XFt.ABOVE:XFt.BELOW}else if(this.dropMode===QFt.ON_TOP_OR_BETWEEN){if(t.clientY-i.top<i.height/3){this._dropLocation=XFt.ABOVE}else if(t.clientY-i.top>i.height/3*2){this._dropLocation=XFt.BELOW}}}if(e&&e.hasAttribute("drop-disabled")){this._dropLocation=undefined;return}t.stopPropagation();t.preventDefault();if(this._dropLocation===XFt.EMPTY){this.toggleAttribute("dragover",true)}else if(e){this._dragOverItem=e._item;if(e.getAttribute("dragover")!==this._dropLocation){ZNt(e,{dragover:this._dropLocation})}}else{this._clearDragStyles()}}}__onDocumentDragStart(t){if(!t.target.contains(this)){return}if(this.$.items.offsetHeight>2e4){const t=this.$.items.style.maxHeight;const e=this.$.table.style.overflow;this.$.items.style.maxHeight="0";this.$.table.style.overflow="hidden";requestAnimationFrame((()=>{this.$.items.style.maxHeight=t;this.$.table.style.overflow=e}))}}__dndAutoScroll(t){if(this.__dndAutoScrolling){return true}const e=this.$.header.getBoundingClientRect().bottom;const i=this.$.footer.getBoundingClientRect().top;const n=e-t+this.__dndAutoScrollThreshold;const s=t-i+this.__dndAutoScrollThreshold;let r=0;if(s>0){r=s*2}else if(n>0){r=-n*2}if(r){const t=this.$.table.scrollTop;this.$.table.scrollTop+=r;const e=t!==this.$.table.scrollTop;if(e){this.__dndAutoScrolling=true;setTimeout((()=>{this.__dndAutoScrolling=false}),20);return true}}}__getViewportRows(){const t=this.$.header.getBoundingClientRect().bottom;const e=this.$.footer.getBoundingClientRect().top;return Array.from(this.$.items.children).filter((i=>{const n=i.getBoundingClientRect();return n.bottom>t&&n.top<e}))}_clearDragStyles(){this.removeAttribute("dragover");UNt(this.$.items,(t=>{ZNt(t,{dragover:null})}))}__updateDragSourceParts(t,e){WNt(t,{"drag-source":this.__draggedItems.includes(e.item)})}_onDrop(t){if(this.dropMode){t.stopPropagation();t.preventDefault();const e=t.dataTransfer.types&&Array.from(t.dataTransfer.types).map((e=>({type:e,data:t.dataTransfer.getData(e)})));this._clearDragStyles();const i=new CustomEvent("grid-drop",{bubbles:t.bubbles,cancelable:t.cancelable,detail:{dropTargetItem:this._dragOverItem,dropLocation:this._dropLocation,dragData:e}});i.originalEvent=t;this.dispatchEvent(i)}}__formatDefaultTransferData(t){return t.map((t=>Array.from(t.children).filter((t=>!t.hidden&&t.getAttribute("part").indexOf("details-cell")===-1)).sort(((t,e)=>t._column._order>e._column._order?1:-1)).map((t=>t._content.textContent.trim())).filter((t=>t)).join("\t"))).join("\n")}_dragDropAccessChanged(){this.filterDragAndDrop()}filterDragAndDrop(){UNt(this.$.items,(t=>{if(!t.hidden){this._filterDragAndDrop(t,this.__getRowModel(t))}}))}_filterDragAndDrop(t,e){const i=this.loading||t.hasAttribute("loading");const n=!this.rowsDraggable||i||this.dragFilter&&!this.dragFilter(e);const s=!this.dropMode||i||this.dropFilter&&!this.dropFilter(e);BNt(t,(t=>{if(n){t._content.removeAttribute("draggable")}else{t._content.setAttribute("draggable",true)}}));WNt(t,{"drag-disabled":!!n,"drop-disabled":!!s})}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;function iDt(t,e){if(!t||!e||t.length!==e.length){return false}for(let i=0,n=t.length;i<n;i++){if(t[i]instanceof Array&&e[i]instanceof Array){if(!iDt(t[i],e[i])){return false}}else if(t[i]!==e[i]){return false}}return true}const nDt=t=>class e extends t{static get properties(){return{_columnTree:Object}}ready(){super.ready();this._addNodeObserver()}_hasColumnGroups(t){return t.some((t=>t.localName==="vaadin-grid-column-group"))}_getChildColumns(t){return YNt.getColumns(t)}_flattenColumnGroups(t){return t.map((t=>{if(t.localName==="vaadin-grid-column-group"){return this._getChildColumns(t)}return[t]})).reduce(((t,e)=>t.concat(e)),[])}_getColumnTree(){const t=YNt.getColumns(this);const e=[t];let i=t;while(this._hasColumnGroups(i)){i=this._flattenColumnGroups(i);e.push(i)}return e}_debounceUpdateColumnTree(){this.__updateColumnTreeDebouncer=_Nt.debounce(this.__updateColumnTreeDebouncer,bNt,(()=>this._updateColumnTree()))}_updateColumnTree(){const t=this._getColumnTree();if(!iDt(t,this._columnTree)){t.forEach((t=>{t.forEach((t=>{if(t.performUpdate){t.performUpdate()}}))}));this._columnTree=t}}_addNodeObserver(){this._observer=new YNt(this,((t,e)=>{const i=e.flatMap((t=>t._allCells));const n=t=>i.filter((e=>e&&e._content.contains(t))).length;this.__removeSorters(this._sorters.filter(n));this.__removeFilters(this._filters.filter(n));this._debounceUpdateColumnTree();this._debouncerCheckImports=_Nt.debounce(this._debouncerCheckImports,gNt.after(2e3),this._checkImports.bind(this));this._ensureFirstPageLoaded()}))}_checkImports(){["vaadin-grid-column-group","vaadin-grid-filter","vaadin-grid-filter-column","vaadin-grid-tree-toggle","vaadin-grid-selection-column","vaadin-grid-sort-column","vaadin-grid-sorter"].forEach((t=>{const e=this.querySelector(t);if(e&&!customElements.get(t)){console.warn(`Make sure you have imported the required module for <${t}> element.`)}}))}_updateFirstAndLastColumn(){Array.from(this.shadowRoot.querySelectorAll("tr")).forEach((t=>this._updateFirstAndLastColumnForRow(t)))}_updateFirstAndLastColumnForRow(t){Array.from(t.querySelectorAll('[part~="cell"]:not([part~="details-cell"])')).sort(((t,e)=>t._column._order-e._column._order)).forEach(((t,e,i)=>{JNt(t,"first-column",e===0);JNt(t,"last-column",e===i.length-1)}))}_isColumnElement(t){return t.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/u.test(t.localName)}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const sDt=t=>class e extends t{getEventContext(t){const e={};const{cell:i}=this._getGridEventLocation(t);if(!i){return e}e.section=["body","header","footer","details"].find((t=>i.getAttribute("part").indexOf(t)>-1));if(i._column){e.column=i._column}if(e.section==="body"||e.section==="details"){Object.assign(e,this.__getRowModel(i.parentElement))}return e}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const rDt=t=>class e extends t{static get properties(){return{_filters:{type:Array,value:()=>[]}}}constructor(){super();this._filterChanged=this._filterChanged.bind(this);this.addEventListener("filter-changed",this._filterChanged)}_filterChanged(t){t.stopPropagation();this.__addFilter(t.target);this.__applyFilters()}__removeFilters(t){if(t.length===0){return}this._filters=this._filters.filter((e=>t.indexOf(e)<0));this.__applyFilters()}__addFilter(t){const e=this._filters.indexOf(t);if(e===-1){this._filters.push(t)}}__applyFilters(){if(this.dataProvider&&this.isAttached){this.clearCache()}}_mapFilters(){return this._filters.map((t=>({path:t.path,value:t.value})))}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;function oDt(t){return t instanceof HTMLTableRowElement}function aDt(t){return t instanceof HTMLTableCellElement}function lDt(t){return t.matches('[part~="details-cell"]')}const uDt=t=>class e extends t{static get properties(){return{_headerFocusable:{type:Object,observer:"_focusableChanged",sync:true},_itemsFocusable:{type:Object,observer:"_focusableChanged",sync:true},_footerFocusable:{type:Object,observer:"_focusableChanged",sync:true},_navigatingIsHidden:Boolean,_focusedItemIndex:{type:Number,value:0},_focusedColumnOrder:Number,_focusedCell:{type:Object,observer:"_focusedCellChanged",sync:true},interacting:{type:Boolean,value:false,reflectToAttribute:true,readOnly:true,observer:"_interactingChanged"}}}get __rowFocusMode(){return[this._headerFocusable,this._itemsFocusable,this._footerFocusable].some(oDt)}set __rowFocusMode(t){["_itemsFocusable","_footerFocusable","_headerFocusable"].forEach((e=>{const i=this[e];if(t){const t=i&&i.parentElement;if(aDt(i)){this[e]=t}else if(aDt(t)){this[e]=t.parentElement}}else if(!t&&oDt(i)){const t=i.firstElementChild;this[e]=t._focusButton||t}}))}get _visibleItemsCount(){return this._lastVisibleIndex-this._firstVisibleIndex-1}ready(){super.ready();if(this._ios||this._android){return}this.addEventListener("keydown",this._onKeyDown);this.addEventListener("keyup",this._onKeyUp);this.addEventListener("focusin",this._onFocusIn);this.addEventListener("focusout",this._onFocusOut);this.$.table.addEventListener("focusin",this._onContentFocusIn.bind(this));this.addEventListener("mousedown",(()=>{this.toggleAttribute("navigating",false);this._isMousedown=true;this._focusedColumnOrder=undefined}));this.addEventListener("mouseup",(()=>{this._isMousedown=false}))}_focusableChanged(t,e){if(e){e.setAttribute("tabindex","-1")}if(t){this._updateGridSectionFocusTarget(t)}}_focusedCellChanged(t,e){if(e){DNt(e,"part","focused-cell")}if(t){FNt(t,"part","focused-cell")}}_interactingChanged(){this._updateGridSectionFocusTarget(this._headerFocusable);this._updateGridSectionFocusTarget(this._itemsFocusable);this._updateGridSectionFocusTarget(this._footerFocusable)}__updateItemsFocusable(){if(!this._itemsFocusable){return}const t=this.shadowRoot.activeElement===this._itemsFocusable;this._getRenderedRows().forEach((t=>{if(t.index===this._focusedItemIndex){if(this.__rowFocusMode){this._itemsFocusable=t}else{let e=this._itemsFocusable.parentElement;let i=this._itemsFocusable;if(e){if(aDt(e)){i=e;e=e.parentElement}const n=[...e.children].indexOf(i);this._itemsFocusable=this.__getFocusable(t,t.children[n])}}}}));if(t){this._itemsFocusable.focus()}}_onKeyDown(t){const e=t.key;let i;switch(e){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"PageUp":case"PageDown":case"Home":case"End":i="Navigation";break;case"Enter":case"Escape":case"F2":i="Interaction";break;case"Tab":i="Tab";break;case" ":i="Space";break}this._detectInteracting(t);if(this.interacting&&i!=="Interaction"){i=undefined}if(i){this[`_on${i}KeyDown`](t,e)}}__ensureFlatIndexInViewport(t){const e=[...this.$.items.children].find((e=>e.index===t));if(!e){this._scrollToFlatIndex(t)}else{this.__scrollIntoViewport(t)}}__isRowExpandable(t){if(this.itemHasChildrenPath){const e=t._item;return!!(e&&ONt(this.itemHasChildrenPath,e)&&!this._isExpanded(e))}}__isRowCollapsible(t){return this._isExpanded(t._item)}_onNavigationKeyDown(t,e){t.preventDefault();const i=this.__isRTL;const n=t.composedPath().find(oDt);const s=t.composedPath().find(aDt);let r=0,o=0;switch(e){case"ArrowRight":r=i?-1:1;break;case"ArrowLeft":r=i?1:-1;break;case"Home":if(this.__rowFocusMode){o=-Infinity}else if(t.ctrlKey){o=-Infinity}else{r=-Infinity}break;case"End":if(this.__rowFocusMode){o=Infinity}else if(t.ctrlKey){o=Infinity}else{r=Infinity}break;case"ArrowDown":o=1;break;case"ArrowUp":o=-1;break;case"PageDown":if(this.$.items.contains(n)){const t=this.__getIndexInGroup(n,this._focusedItemIndex);this._scrollToFlatIndex(t)}o=this._visibleItemsCount;break;case"PageUp":o=-this._visibleItemsCount;break}if(this.__rowFocusMode&&!n||!this.__rowFocusMode&&!s){return}const a=i?"ArrowLeft":"ArrowRight";const l=i?"ArrowRight":"ArrowLeft";if(e===a){if(this.__rowFocusMode){if(this.__isRowExpandable(n)){this.expandItem(n._item);return}this.__rowFocusMode=false;this._onCellNavigation(n.firstElementChild,0,0);return}}else if(e===l){if(this.__rowFocusMode){if(this.__isRowCollapsible(n)){this.collapseItem(n._item);return}}else{const t=[...n.children].sort(((t,e)=>t._order-e._order));if(s===t[0]||lDt(s)){this.__rowFocusMode=true;this._onRowNavigation(n,0);return}}}if(this.__rowFocusMode){this._onRowNavigation(n,o)}else{this._onCellNavigation(s,r,o)}}_onRowNavigation(t,e){const{dstRow:i}=this.__navigateRows(e,t);if(i){i.focus()}}__getIndexInGroup(t,e){const i=t.parentNode;if(i===this.$.items){return e!==undefined?e:t.index}return[...i.children].indexOf(t)}__navigateRows(t,e,i){const n=this.__getIndexInGroup(e,this._focusedItemIndex);const s=e.parentNode;const r=(s===this.$.items?this._flatSize:s.children.length)-1;let o=Math.max(0,Math.min(n+t,r));if(s!==this.$.items){if(o>n){while(o<r&&s.children[o].hidden){o+=1}}else if(o<n){while(o>0&&s.children[o].hidden){o-=1}}this.toggleAttribute("navigating",true);return{dstRow:s.children[o]}}let a=false;if(i){const r=lDt(i);if(s===this.$.items){const i=e._item;const{item:s}=this._dataProviderController.getFlatIndexContext(o);if(r){a=t===0}else{a=t===1&&this._isDetailsOpened(i)||t===-1&&o!==n&&this._isDetailsOpened(s)}if(a!==r&&(t===1&&a||t===-1&&!a)){o=n}}}this.__ensureFlatIndexInViewport(o);this._focusedItemIndex=o;this.toggleAttribute("navigating",true);return{dstRow:[...s.children].find((t=>!t.hidden&&t.index===o)),dstIsRowDetails:a}}_onCellNavigation(t,e,i){const n=t.parentNode;const{dstRow:s,dstIsRowDetails:r}=this.__navigateRows(i,n,t);if(!s){return}let o=[...n.children].indexOf(t);if(this.$.items.contains(t)){o=[...this.$.sizer.children].findIndex((e=>e._column===t._column))}const a=lDt(t);const l=n.parentNode;const u=this.__getIndexInGroup(n,this._focusedItemIndex);if(this._focusedColumnOrder===undefined){if(a){this._focusedColumnOrder=0}else{this._focusedColumnOrder=this._getColumns(l,u).filter((t=>!t.hidden))[o]._order}}if(r){const t=[...s.children].find(lDt);t.focus()}else{const n=this.__getIndexInGroup(s,this._focusedItemIndex);const r=this._getColumns(l,n).filter((t=>!t.hidden));const o=r.map((t=>t._order)).sort(((t,e)=>t-e));const u=o.length-1;const c=o.indexOf(o.slice(0).sort(((t,e)=>Math.abs(t-this._focusedColumnOrder)-Math.abs(e-this._focusedColumnOrder)))[0]);const h=i===0&&a?c:Math.max(0,Math.min(c+e,u));if(h!==c){this._focusedColumnOrder=undefined}const d=r.reduce(((t,e,i)=>{t[e._order]=i;return t}),{});const f=d[o[h]];let p;if(this.$.items.contains(t)){const t=this.$.sizer.children[f];if(this._lazyColumns){if(!this.__isColumnInViewport(t._column)){t.scrollIntoView()}this.__updateColumnsBodyContentHidden();this.__updateHorizontalScrollPosition()}p=[...s.children].find((e=>e._column===t._column));this._scrollHorizontallyToCell(p)}else{p=s.children[f];this._scrollHorizontallyToCell(p)}p.focus()}}_onInteractionKeyDown(t,e){const i=t.composedPath()[0];const n=i.localName==="input"&&!/^(button|checkbox|color|file|image|radio|range|reset|submit)$/iu.test(i.type);let s;switch(e){case"Enter":s=this.interacting?!n:true;break;case"Escape":s=false;break;case"F2":s=!this.interacting;break}const{cell:r}=this._getGridEventLocation(t);if(this.interacting!==s&&r!==null){if(s){const e=r._content.querySelector("[focus-target]")||[...r._content.querySelectorAll("*")].find((t=>this._isFocusable(t)));if(e){t.preventDefault();e.focus();this._setInteracting(true);this.toggleAttribute("navigating",false)}}else{t.preventDefault();this._focusedColumnOrder=undefined;r.focus();this._setInteracting(false);this.toggleAttribute("navigating",true)}}if(e==="Escape"){this._hideTooltip(true)}}_predictFocusStepTarget(t,e){const i=[this.$.table,this._headerFocusable,this.__emptyState?this.$.emptystatecell:this._itemsFocusable,this._footerFocusable,this.$.focusexit];let n=i.indexOf(t);n+=e;while(n>=0&&n<=i.length-1){let t=i[n];if(t&&!this.__rowFocusMode){t=i[n].parentNode}if(!t||t.hidden){n+=e}else{break}}let s=i[n];if(s&&!this.__isHorizontallyInViewport(s)){const t=this._getColumnsInOrder().find((t=>this.__isColumnInViewport(t)));if(t){if(s===this._headerFocusable){s=t._headerCell}else if(s===this._itemsFocusable){const e=s._column._cells.indexOf(s);s=t._cells[e]}else if(s===this._footerFocusable){s=t._footerCell}}}return s}_onTabKeyDown(t){const e=this._predictFocusStepTarget(t.composedPath()[0],t.shiftKey?-1:1);if(!e){return}t.stopPropagation();if(e===this.$.table){this.$.table.focus()}else if(e===this.$.focusexit){this.$.focusexit.focus()}else if(e===this._itemsFocusable){this.__ensureFlatIndexInViewport(this._focusedItemIndex);this.__updateItemsFocusable();t.preventDefault();this._itemsFocusable.focus()}else{t.preventDefault();e.focus()}this.toggleAttribute("navigating",true)}_onSpaceKeyDown(t){t.preventDefault();const e=t.composedPath()[0];const i=oDt(e);if(i||!e._content||!e._content.firstElementChild){this.dispatchEvent(new CustomEvent(i?"row-activate":"cell-activate",{detail:{model:this.__getRowModel(i?e:e.parentElement)}}))}}_onKeyUp(t){if(!/^( |SpaceBar)$/u.test(t.key)||this.interacting){return}t.preventDefault();const e=t.composedPath()[0];if(e._content&&e._content.firstElementChild){const i=this.hasAttribute("navigating");e._content.firstElementChild.dispatchEvent(new MouseEvent("click",{shiftKey:t.shiftKey,bubbles:true,composed:true,cancelable:true}));this.toggleAttribute("navigating",i)}}_onFocusIn(t){if(!this._isMousedown){this.toggleAttribute("navigating",true)}const e=t.composedPath()[0];if(e===this.$.table||e===this.$.focusexit){if(!this._isMousedown){this._predictFocusStepTarget(e,e===this.$.table?1:-1).focus()}this._setInteracting(false)}else{this._detectInteracting(t)}}_onFocusOut(t){this.toggleAttribute("navigating",false);this._detectInteracting(t);this._hideTooltip();this._focusedCell=null}_onContentFocusIn(t){const{section:e,cell:i,row:n}=this._getGridEventLocation(t);if(!i&&!this.__rowFocusMode){return}this._detectInteracting(t);if(e&&(i||n)){this._activeRowGroup=e;if(e===this.$.header){this._headerFocusable=this.__getFocusable(n,i)}else if(e===this.$.items){this._itemsFocusable=this.__getFocusable(n,i);this._focusedItemIndex=n.index}else if(e===this.$.footer){this._footerFocusable=this.__getFocusable(n,i)}if(i){const e=this.getEventContext(t);this.__pendingBodyCellFocus=this.loading&&e.section==="body";if(!this.__pendingBodyCellFocus&&i!==this.$.emptystatecell){i.dispatchEvent(new CustomEvent("cell-focus",{bubbles:true,composed:true,detail:{context:e}}))}this._focusedCell=i._focusButton||i;if(yPt()&&t.target===i){this._showTooltip(t)}}else{this._focusedCell=null}}}__dispatchPendingBodyCellFocus(){if(this.__pendingBodyCellFocus&&this.shadowRoot.activeElement===this._itemsFocusable){this._itemsFocusable.dispatchEvent(new Event("focusin",{bubbles:true,composed:true}))}}__getFocusable(t,e){return this.__rowFocusMode?t:e._focusButton||e}_detectInteracting(t){const e=t.composedPath().some((t=>t.localName==="slot"&&this.shadowRoot.contains(t)));this._setInteracting(e);this.__updateHorizontalScrollPosition()}_updateGridSectionFocusTarget(t){if(!t){return}const e=this._getGridSectionFromFocusTarget(t);const i=this.interacting&&e===this._activeRowGroup;t.tabIndex=i?-1:0}_preventScrollerRotatingCellFocus(){if(this._activeRowGroup!==this.$.items){return}this.__preventScrollerRotatingCellFocusDebouncer=_Nt.debounce(this.__preventScrollerRotatingCellFocusDebouncer,vNt,(()=>{const t=this._activeRowGroup===this.$.items;const e=this._getRenderedRows().some((t=>t.index===this._focusedItemIndex));if(e){this.__updateItemsFocusable();if(t&&!this.__rowFocusMode){this._focusedCell=this._itemsFocusable}if(this._navigatingIsHidden){this.toggleAttribute("navigating",true);this._navigatingIsHidden=false}}else if(t){this._focusedCell=null;if(this.hasAttribute("navigating")){this._navigatingIsHidden=true;this.toggleAttribute("navigating",false)}}}))}_getColumns(t,e){let i=this._columnTree.length-1;if(t===this.$.header){i=e}else if(t===this.$.footer){i=this._columnTree.length-1-e}return this._columnTree[i]}__isValidFocusable(t){return this.$.table.contains(t)&&t.offsetHeight}_resetKeyboardNavigation(){if(!this.$&&this.performUpdate){this.performUpdate()}["header","footer"].forEach((t=>{if(!this.__isValidFocusable(this[`_${t}Focusable`])){const e=[...this.$[t].children].find((t=>t.offsetHeight));const i=e?[...e.children].find((t=>!t.hidden)):null;if(e&&i){this[`_${t}Focusable`]=this.__getFocusable(e,i)}}}));if(!this.__isValidFocusable(this._itemsFocusable)&&this.$.items.firstElementChild){const t=this.__getFirstVisibleItem();const e=t?[...t.children].find((t=>!t.hidden)):null;if(e&&t){this._focusedColumnOrder=undefined;this._itemsFocusable=this.__getFocusable(t,e)}}else{this.__updateItemsFocusable()}}_scrollHorizontallyToCell(t){if(t.hasAttribute("frozen")||t.hasAttribute("frozen-to-end")||lDt(t)){return}const e=t.getBoundingClientRect();const i=t.parentNode;const n=Array.from(i.children).indexOf(t);const s=this.$.table.getBoundingClientRect();let r=s.left,o=s.right;for(let t=n-1;t>=0;t--){const e=i.children[t];if(e.hasAttribute("hidden")||lDt(e)){continue}if(e.hasAttribute("frozen")||e.hasAttribute("frozen-to-end")){r=e.getBoundingClientRect().right;break}}for(let t=n+1;t<i.children.length;t++){const e=i.children[t];if(e.hasAttribute("hidden")||lDt(e)){continue}if(e.hasAttribute("frozen")||e.hasAttribute("frozen-to-end")){o=e.getBoundingClientRect().left;break}}if(e.left<r){this.$.table.scrollLeft+=Math.round(e.left-r)}if(e.right>o){this.$.table.scrollLeft+=Math.round(e.right-o)}}_getGridEventLocation(t){const e=t.__composedPath||t.composedPath();const i=e.indexOf(this.$.table);const n=i>=1?e[i-1]:null;const s=i>=2?e[i-2]:null;const r=i>=3?e[i-3]:null;return{section:n,row:s,cell:r}}_getGridSectionFromFocusTarget(t){if(t===this._headerFocusable){return this.$.header}if(t===this._itemsFocusable){return this.$.items}if(t===this._footerFocusable){return this.$.footer}return null}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const cDt=t=>class e extends t{static get properties(){return{detailsOpenedItems:{type:Array,value:()=>[],sync:true},rowDetailsRenderer:{type:Function,sync:true},_detailsCells:{type:Array}}}static get observers(){return["_detailsOpenedItemsChanged(detailsOpenedItems, rowDetailsRenderer)","_rowDetailsRendererChanged(rowDetailsRenderer)"]}ready(){super.ready();this._detailsCellResizeObserver=new ResizeObserver((t=>{t.forEach((({target:t})=>{this._updateDetailsCellHeight(t.parentElement)}));this.__virtualizer.__adapter._resizeHandler()}))}_rowDetailsRendererChanged(t){if(!t){return}if(this._columnTree){UNt(this.$.items,(t=>{if(!t.querySelector("[part~=details-cell]")){this._updateRow(t,this._columnTree[this._columnTree.length-1]);const e=this._isDetailsOpened(t._item);this._toggleDetailsCell(t,e)}}))}}_detailsOpenedItemsChanged(t,e){UNt(this.$.items,(t=>{if(t.hasAttribute("details-opened")){this._updateItem(t,t._item);return}if(e&&this._isDetailsOpened(t._item)){this._updateItem(t,t._item)}}))}_configureDetailsCell(t){t.setAttribute("part","cell details-cell");t.toggleAttribute("frozen",true);this._detailsCellResizeObserver.observe(t)}_toggleDetailsCell(t,e){const i=t.querySelector('[part~="details-cell"]');if(!i){return}i.hidden=!e;if(i.hidden){return}if(this.rowDetailsRenderer){i._renderer=this.rowDetailsRenderer}}_updateDetailsCellHeight(t){const e=t.querySelector('[part~="details-cell"]');if(!e){return}this.__updateDetailsRowPadding(t,e);requestAnimationFrame((()=>this.__updateDetailsRowPadding(t,e)))}__updateDetailsRowPadding(t,e){if(e.hidden){t.style.removeProperty("padding-bottom")}else{t.style.setProperty("padding-bottom",`${e.offsetHeight}px`)}}_updateDetailsCellHeights(){UNt(this.$.items,(t=>{this._updateDetailsCellHeight(t)}))}_isDetailsOpened(t){return this.detailsOpenedItems&&this._getItemIndexInArray(t,this.detailsOpenedItems)!==-1}openItemDetails(t){if(!this._isDetailsOpened(t)){this.detailsOpenedItems=[...this.detailsOpenedItems,t]}}closeItemDetails(t){if(this._isDetailsOpened(t)){this.detailsOpenedItems=this.detailsOpenedItems.filter((e=>!this._itemsEqual(e,t)))}}}
/**
 * @license
 * Copyright (c) 2022 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const hDt=document.createElement("div");hDt.style.position="fixed";hDt.style.clip="rect(0px, 0px, 0px, 0px)";hDt.setAttribute("aria-live","polite");document.body.appendChild(hDt);
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const dDt=GOt((t=>class e extends t{ready(){super.ready();this.addEventListener("keydown",(t=>{this._onKeyDown(t)}));this.addEventListener("keyup",(t=>{this._onKeyUp(t)}))}_onKeyDown(t){switch(t.key){case"Enter":this._onEnter(t);break;case"Escape":this._onEscape(t);break}}_onKeyUp(t){}_onEnter(t){}_onEscape(t){}}));
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const fDt=t=>class e extends(bPt(dDt(t))){get _activeKeys(){return[" "]}ready(){super.ready();RFt(this,"down",(t=>{if(this._shouldSetActive(t)){this._setActive(true)}}));RFt(this,"up",(()=>{this._setActive(false)}))}disconnectedCallback(){super.disconnectedCallback();this._setActive(false)}_shouldSetActive(t){return!this.disabled}_onKeyDown(t){super._onKeyDown(t);if(this._shouldSetActive(t)&&this._activeKeys.includes(t.key)){this._setActive(true);document.addEventListener("keyup",(t=>{if(this._activeKeys.includes(t.key)){this._setActive(false)}}),{once:true})}}_setActive(t){this.toggleAttribute("active",t)}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const pDt=GOt((t=>class e extends t{get _keyboardActive(){return yPt()}ready(){this.addEventListener("focusin",(t=>{if(this._shouldSetFocus(t)){this._setFocused(true)}}));this.addEventListener("focusout",(t=>{if(this._shouldRemoveFocus(t)){this._setFocused(false)}}));super.ready()}disconnectedCallback(){super.disconnectedCallback();if(this.hasAttribute("focused")){this._setFocused(false)}}_setFocused(t){this.toggleAttribute("focused",t);this.toggleAttribute("focus-ring",t&&this._keyboardActive)}_shouldSetFocus(t){return true}_shouldRemoveFocus(t){return true}}));
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const mDt=GOt((t=>class e extends(pDt(SPt(t))){static get properties(){return{autofocus:{type:Boolean},focusElement:{type:Object,readOnly:true,observer:"_focusElementChanged"},_lastTabIndex:{value:0}}}constructor(){super();this._boundOnBlur=this._onBlur.bind(this);this._boundOnFocus=this._onFocus.bind(this)}ready(){super.ready();if(this.autofocus&&!this.disabled){requestAnimationFrame((()=>{this.focus();this.setAttribute("focus-ring","")}))}}focus(){if(this.focusElement&&!this.disabled){this.focusElement.focus()}}blur(){if(this.focusElement){this.focusElement.blur()}}click(){if(this.focusElement&&!this.disabled){this.focusElement.click()}}_focusElementChanged(t,e){if(t){t.disabled=this.disabled;this._addFocusListeners(t);this.__forwardTabIndex(this.tabindex)}else if(e){this._removeFocusListeners(e)}}_addFocusListeners(t){t.addEventListener("blur",this._boundOnBlur);t.addEventListener("focus",this._boundOnFocus)}_removeFocusListeners(t){t.removeEventListener("blur",this._boundOnBlur);t.removeEventListener("focus",this._boundOnFocus)}_onFocus(t){t.stopPropagation();this.dispatchEvent(new Event("focus"))}_onBlur(t){t.stopPropagation();this.dispatchEvent(new Event("blur"))}_shouldSetFocus(t){return t.target===this.focusElement}_shouldRemoveFocus(t){return t.target===this.focusElement}_disabledChanged(t,e){super._disabledChanged(t,e);if(this.focusElement){this.focusElement.disabled=t}if(t){this.blur()}}_tabindexChanged(t){this.__forwardTabIndex(t)}__forwardTabIndex(t){if(t!==undefined&&this.focusElement){this.focusElement.tabIndex=t;if(t!==-1){this.tabindex=undefined}}if(this.disabled&&t){if(t!==-1){this._lastTabIndex=t}this.tabindex=undefined}}}));
/**
 * @license
 * Copyright (c) 2023 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const yDt=new Map;function gDt(t){if(!yDt.has(t)){yDt.set(t,new WeakMap)}return yDt.get(t)}function vDt(t,e){if(!t){return}t.removeAttribute(e)}function wDt(t,e){if(!t||!e){return}const i=gDt(e);if(i.has(t)){return}const n=NNt(t.getAttribute(e));i.set(t,new Set(n))}function bDt(t,e){if(!t||!e){return}const i=gDt(e);const n=i.get(t);if(!n||n.size===0){t.removeAttribute(e)}else{FNt(t,e,PNt(n))}i.delete(t)}function SDt(t,e,i={newId:null,oldId:null,fromUser:false}){if(!t||!e){return}const{newId:n,oldId:s,fromUser:r}=i;const o=gDt(e);const a=o.get(t);if(!r&&!!a){s&&a.delete(s);n&&a.add(n);return}if(r){if(!a){wDt(t,e)}else if(!n){o.delete(t)}vDt(t,e)}DNt(t,e,s);const l=!n?PNt(a):n;if(l){FNt(t,e,l)}}function _Dt(t,e){wDt(t,e);vDt(t,e)}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class xDt{constructor(t){this.host=t;this.__required=false}setTarget(t){this.__target=t;this.__setAriaRequiredAttribute(this.__required);this.__setLabelIdToAriaAttribute(this.__labelId,this.__labelId);if(this.__labelIdFromUser!=null){this.__setLabelIdToAriaAttribute(this.__labelIdFromUser,this.__labelIdFromUser,true)}this.__setErrorIdToAriaAttribute(this.__errorId);this.__setHelperIdToAriaAttribute(this.__helperId);this.setAriaLabel(this.__label)}setRequired(t){this.__setAriaRequiredAttribute(t);this.__required=t}setAriaLabel(t){this.__setAriaLabelToAttribute(t);this.__label=t}setLabelId(t,e=false){const i=e?this.__labelIdFromUser:this.__labelId;this.__setLabelIdToAriaAttribute(t,i,e);if(e){this.__labelIdFromUser=t}else{this.__labelId=t}}setErrorId(t){this.__setErrorIdToAriaAttribute(t,this.__errorId);this.__errorId=t}setHelperId(t){this.__setHelperIdToAriaAttribute(t,this.__helperId);this.__helperId=t}__setAriaLabelToAttribute(t){if(!this.__target){return}if(t){_Dt(this.__target,"aria-labelledby");this.__target.setAttribute("aria-label",t)}else if(this.__label){bDt(this.__target,"aria-labelledby");this.__target.removeAttribute("aria-label")}}__setLabelIdToAriaAttribute(t,e,i){SDt(this.__target,"aria-labelledby",{newId:t,oldId:e,fromUser:i})}__setErrorIdToAriaAttribute(t,e){SDt(this.__target,"aria-describedby",{newId:t,oldId:e,fromUser:false})}__setHelperIdToAriaAttribute(t,e){SDt(this.__target,"aria-describedby",{newId:t,oldId:e,fromUser:false})}__setAriaRequiredAttribute(t){if(!this.__target){return}if(["input","textarea"].includes(this.__target.localName)){return}if(t){this.__target.setAttribute("aria-required","true")}else{this.__target.removeAttribute("aria-required")}}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */function MDt(t,e){const{scrollLeft:i}=t;if(e!=="rtl"){return i}return t.scrollWidth-t.clientWidth+i}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const TDt=new ResizeObserver((t=>{setTimeout((()=>{t.forEach((t=>{if(t.target.resizables){t.target.resizables.forEach((e=>{e._onResize(t.contentRect)}))}else{t.target._onResize(t.contentRect)}}))}))}));const ADt=GOt((t=>class e extends t{get _observeParent(){return false}connectedCallback(){super.connectedCallback();TDt.observe(this);if(this._observeParent){const t=this.parentNode instanceof ShadowRoot?this.parentNode.host:this.parentNode;if(!t.resizables){t.resizables=new Set;TDt.observe(t)}t.resizables.add(this);this.__parent=t}}disconnectedCallback(){super.disconnectedCallback();TDt.unobserve(this);const t=this.__parent;if(this._observeParent&&t){const e=t.resizables;if(e){e.delete(this);if(e.size===0){TDt.unobserve(t)}}this.__parent=null}}_onResize(t){}}));
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const IDt={SCROLLING:500,UPDATE_CONTENT_VISIBILITY:100};const kDt=t=>class e extends(ADt(t)){static get properties(){return{columnRendering:{type:String,value:"eager",sync:true},_frozenCells:{type:Array,value:()=>[]},_frozenToEndCells:{type:Array,value:()=>[]},_rowWithFocusedElement:Element}}static get observers(){return["__columnRenderingChanged(_columnTree, columnRendering)"]}get _scrollLeft(){return this.$.table.scrollLeft}get _scrollTop(){return this.$.table.scrollTop}set _scrollTop(t){this.$.table.scrollTop=t}get _lazyColumns(){return this.columnRendering==="lazy"}ready(){super.ready();this.scrollTarget=this.$.table;this.$.items.addEventListener("focusin",(t=>{const e=t.composedPath().indexOf(this.$.items);this._rowWithFocusedElement=t.composedPath()[e-1];if(this._rowWithFocusedElement){if(!this._isMousedown){this.__scrollIntoViewport(this._rowWithFocusedElement.index)}if(!this.$.table.contains(t.relatedTarget)){this.$.table.dispatchEvent(new CustomEvent("virtualizer-element-focused",{detail:{element:this._rowWithFocusedElement}}))}}}));this.$.items.addEventListener("focusout",(()=>{this._rowWithFocusedElement=undefined}));this.$.table.addEventListener("scroll",(()=>this._afterScroll()))}_onResize(){this._updateOverflow();this.__updateHorizontalScrollPosition();if(this._firefox){const t=!vPt(this);if(t&&this.__previousVisible===false){this._scrollTop=this.__memorizedScrollTop||0}this.__previousVisible=t}}_scrollToFlatIndex(t){t=Math.min(this._flatSize-1,Math.max(0,t));this.__virtualizer.scrollToIndex(t);this.__scrollIntoViewport(t)}__scrollIntoViewport(t){const e=[...this.$.items.children].find((e=>e.index===t));if(e){const t=e.getBoundingClientRect();const i=this.$.footer.getBoundingClientRect().top;const n=this.$.header.getBoundingClientRect().bottom;if(t.bottom>i){this.$.table.scrollTop+=t.bottom-i}else if(t.top<n){this.$.table.scrollTop-=n-t.top}}}_scheduleScrolling(){if(!this._scrollingFrame){this._scrollingFrame=requestAnimationFrame((()=>this.$.scroller.toggleAttribute("scrolling",true)))}this._debounceScrolling=_Nt.debounce(this._debounceScrolling,gNt.after(IDt.SCROLLING),(()=>{cancelAnimationFrame(this._scrollingFrame);delete this._scrollingFrame;this.$.scroller.toggleAttribute("scrolling",false)}))}_afterScroll(){this.__updateHorizontalScrollPosition();if(!this.hasAttribute("reordering")){this._scheduleScrolling()}if(!this.hasAttribute("navigating")){this._hideTooltip(true)}this._updateOverflow();this._debounceColumnContentVisibility=_Nt.debounce(this._debounceColumnContentVisibility,gNt.after(IDt.UPDATE_CONTENT_VISIBILITY),(()=>{if(this._lazyColumns&&this.__cachedScrollLeft!==this._scrollLeft){this.__cachedScrollLeft=this._scrollLeft;this.__updateColumnsBodyContentHidden()}}));if(this._firefox){const t=!vPt(this);if(t&&this.__previousVisible!==false){this.__memorizedScrollTop=this._scrollTop}}}__updateColumnsBodyContentHidden(){if(!this._columnTree||!this._areSizerCellsAssigned()){return}const t=this._getColumnsInOrder();let e=false;t.forEach((i=>{const n=this._lazyColumns&&!this.__isColumnInViewport(i);if(i._bodyContentHidden!==n){e=true;i._cells.forEach((e=>{if(e!==i._sizerCell){if(n){e.remove()}else if(e.__parentRow){const n=[...e.__parentRow.children].find((e=>t.indexOf(e._column)>t.indexOf(i)));e.__parentRow.insertBefore(e,n)}}}))}i._bodyContentHidden=n}));if(e){this._frozenCellsChanged()}if(this._lazyColumns){const e=[...t].reverse().find((t=>t.frozen));const i=this.__getColumnEnd(e);const n=t.find((t=>!t.frozen&&!t._bodyContentHidden));this.__lazyColumnsStart=this.__getColumnStart(n)-i;this.$.items.style.setProperty("--_grid-lazy-columns-start",`${this.__lazyColumnsStart}px`);this._resetKeyboardNavigation()}}__getColumnEnd(t){if(!t){return this.__isRTL?this.$.table.clientWidth:0}return t._sizerCell.offsetLeft+(this.__isRTL?0:t._sizerCell.offsetWidth)}__getColumnStart(t){if(!t){return this.__isRTL?this.$.table.clientWidth:0}return t._sizerCell.offsetLeft+(this.__isRTL?t._sizerCell.offsetWidth:0)}__isColumnInViewport(t){if(t.frozen||t.frozenToEnd){return true}return this.__isHorizontallyInViewport(t._sizerCell)}__isHorizontallyInViewport(t){return t.offsetLeft+t.offsetWidth>=this._scrollLeft&&t.offsetLeft<=this._scrollLeft+this.clientWidth}__columnRenderingChanged(t,e){if(e==="eager"){this.$.scroller.removeAttribute("column-rendering")}else{this.$.scroller.setAttribute("column-rendering",e)}this.__updateColumnsBodyContentHidden()}_updateOverflow(){this._debounceOverflow=_Nt.debounce(this._debounceOverflow,vNt,(()=>{this.__doUpdateOverflow()}))}__doUpdateOverflow(){let t="";const e=this.$.table;if(e.scrollTop<e.scrollHeight-e.clientHeight){t+=" bottom"}if(e.scrollTop>0){t+=" top"}const i=MDt(e,this.getAttribute("dir"));if(i>0){t+=" start"}if(i<e.scrollWidth-e.clientWidth){t+=" end"}if(this.__isRTL){t=t.replace(/start|end/giu,(t=>t==="start"?"end":"start"))}if(e.scrollLeft<e.scrollWidth-e.clientWidth){t+=" right"}if(e.scrollLeft>0){t+=" left"}const n=t.trim();if(n.length>0&&this.getAttribute("overflow")!==n){this.setAttribute("overflow",n)}else if(n.length===0&&this.hasAttribute("overflow")){this.removeAttribute("overflow")}}_frozenCellsChanged(){this._debouncerCacheElements=_Nt.debounce(this._debouncerCacheElements,bNt,(()=>{Array.from(this.shadowRoot.querySelectorAll('[part~="cell"]')).forEach((t=>{t.style.transform=""}));this._frozenCells=Array.prototype.slice.call(this.$.table.querySelectorAll("[frozen]"));this._frozenToEndCells=Array.prototype.slice.call(this.$.table.querySelectorAll("[frozen-to-end]"));this.__updateHorizontalScrollPosition()}));this._debounceUpdateFrozenColumn()}_debounceUpdateFrozenColumn(){this.__debounceUpdateFrozenColumn=_Nt.debounce(this.__debounceUpdateFrozenColumn,bNt,(()=>this._updateFrozenColumn()))}_updateFrozenColumn(){if(!this._columnTree){return}const t=this._columnTree[this._columnTree.length-1].slice(0);t.sort(((t,e)=>t._order-e._order));let e;let i;for(let n=0;n<t.length;n++){const s=t[n];s._lastFrozen=false;s._firstFrozenToEnd=false;if(i===undefined&&s.frozenToEnd&&!s.hidden){i=n}if(s.frozen&&!s.hidden){e=n}}if(e!==undefined){t[e]._lastFrozen=true}if(i!==undefined){t[i]._firstFrozenToEnd=true}this.__updateColumnsBodyContentHidden()}__updateHorizontalScrollPosition(){if(!this._columnTree){return}const t=this.$.table.scrollWidth;const e=this.$.table.clientWidth;const i=Math.max(0,this.$.table.scrollLeft);const n=MDt(this.$.table,this.getAttribute("dir"));const s=`translate(${-i}px, 0)`;this.$.header.style.transform=s;this.$.footer.style.transform=s;this.$.items.style.transform=s;const r=this.__isRTL?n+e-t:i;const o=`translate(${r}px, 0)`;this._frozenCells.forEach((t=>{t.style.transform=o}));const a=this.__isRTL?n:i+e-t;const l=`translate(${a}px, 0)`;let u=l;if(this._lazyColumns&&this._areSizerCellsAssigned()){const t=this._getColumnsInOrder();const e=[...t].reverse().find((t=>!t.frozenToEnd&&!t._bodyContentHidden));const i=this.__getColumnEnd(e);const n=t.find((t=>t.frozenToEnd));const s=this.__getColumnStart(n);const r=a+(s-i)+this.__lazyColumnsStart;u=`translate(${r}px, 0)`}this._frozenToEndCells.forEach((t=>{if(this.$.items.contains(t)){t.style.transform=u}else{t.style.transform=l}}));if(this.hasAttribute("navigating")&&this.__rowFocusMode){this.$.table.style.setProperty("--_grid-horizontal-scroll-position",`${-r}px`)}}_areSizerCellsAssigned(){return this._getColumnsInOrder().every((t=>t._sizerCell))}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const CDt=t=>class e extends t{static get properties(){return{selectedItems:{type:Object,notify:true,value:()=>[],sync:true},__selectedKeys:{type:Object,computed:"__computeSelectedKeys(itemIdPath, selectedItems)"}}}static get observers(){return["__selectedItemsChanged(itemIdPath, selectedItems)"]}_isSelected(t){return this.__selectedKeys.has(this.getItemId(t))}selectItem(t){if(!this._isSelected(t)){this.selectedItems=[...this.selectedItems,t]}}deselectItem(t){if(this._isSelected(t)){this.selectedItems=this.selectedItems.filter((e=>!this._itemsEqual(e,t)))}}_toggleItem(t){if(!this._isSelected(t)){this.selectItem(t)}else{this.deselectItem(t)}}__selectedItemsChanged(){this.requestContentUpdate()}__computeSelectedKeys(t,e){const i=e||[];const n=new Set;i.forEach((t=>{n.add(this.getItemId(t))}));return n}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;let EDt="prepend";const jDt=t=>class e extends t{static get properties(){return{multiSort:{type:Boolean,value:false},multiSortPriority:{type:String,value:()=>EDt},multiSortOnShiftClick:{type:Boolean,value:false},_sorters:{type:Array,value:()=>[]},_previousSorters:{type:Array,value:()=>[]}}}static setDefaultMultiSortPriority(t){EDt=["append","prepend"].includes(t)?t:"prepend"}ready(){super.ready();this.addEventListener("sorter-changed",this._onSorterChanged)}_onSorterChanged(t){const e=t.target;t.stopPropagation();e._grid=this;this.__updateSorter(e,t.detail.shiftClick,t.detail.fromSorterClick);this.__applySorters()}__removeSorters(t){if(t.length===0){return}this._sorters=this._sorters.filter((e=>!t.includes(e)));this.__applySorters()}__updateSortOrders(){this._sorters.forEach((t=>{t._order=null}));const t=this._getActiveSorters();if(t.length>1){t.forEach(((t,e)=>{t._order=e}))}}__updateSorter(t,e,i){if(!t.direction&&!this._sorters.includes(t)){return}t._order=null;const n=this._sorters.filter((e=>e!==t));if(this.multiSort&&(!this.multiSortOnShiftClick||!i)||this.multiSortOnShiftClick&&e){if(this.multiSortPriority==="append"){this._sorters=[...n,t]}else{this._sorters=[t,...n]}}else if(t.direction||this.multiSortOnShiftClick){this._sorters=t.direction?[t]:[];n.forEach((t=>{t._order=null;t.direction=null}))}}__applySorters(){this.__updateSortOrders();if(this.dataProvider&&this.isAttached&&JSON.stringify(this._previousSorters)!==JSON.stringify(this._mapSorters())){this.__debounceClearCache()}this._a11yUpdateSorters();this._previousSorters=this._mapSorters()}_getActiveSorters(){return this._sorters.filter((t=>t.direction&&t.isConnected))}_mapSorters(){return this._getActiveSorters().map((t=>({path:t.path,direction:t.direction})))}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const ODt=t=>class e extends t{static get properties(){return{cellClassNameGenerator:{type:Function,sync:true},cellPartNameGenerator:{type:Function,sync:true}}}static get observers(){return["__cellClassNameGeneratorChanged(cellClassNameGenerator)","__cellPartNameGeneratorChanged(cellPartNameGenerator)"]}__cellClassNameGeneratorChanged(){this.generateCellClassNames()}__cellPartNameGeneratorChanged(){this.generateCellPartNames()}generateCellClassNames(){UNt(this.$.items,(t=>{if(!t.hidden){this._generateCellClassNames(t,this.__getRowModel(t))}}))}generateCellPartNames(){UNt(this.$.items,(t=>{if(!t.hidden){this._generateCellPartNames(t,this.__getRowModel(t))}}))}_generateCellClassNames(t,e){BNt(t,(i=>{if(i.__generatedClasses){i.__generatedClasses.forEach((t=>i.classList.remove(t)))}if(this.cellClassNameGenerator&&!t.hasAttribute("loading")){const t=this.cellClassNameGenerator(i._column,e);i.__generatedClasses=t&&t.split(" ").filter((t=>t.length>0));if(i.__generatedClasses){i.__generatedClasses.forEach((t=>i.classList.add(t)))}}}))}_generateCellPartNames(t,e){BNt(t,(i=>{if(i.__generatedParts){i.__generatedParts.forEach((t=>{qNt(i,null,t)}))}if(this.cellPartNameGenerator&&!t.hasAttribute("loading")){const t=this.cellPartNameGenerator(i._column,e);i.__generatedParts=t&&t.split(" ").filter((t=>t.length>0));if(i.__generatedParts){i.__generatedParts.forEach((t=>{qNt(i,true,t)}))}}}))}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const RDt=t=>class extends(iFt(KFt(nDt(ZPt(kDt(CDt(jDt(cDt(uDt(HPt(rDt(VFt(qFt(sDt(eDt(ODt(SPt(t)))))))))))))))))){static get observers(){return["_columnTreeChanged(_columnTree)","_flatSizeChanged(_flatSize, __virtualizer, _hasData, _columnTree)"]}static get properties(){return{_safari:{type:Boolean,value:jPt},_ios:{type:Boolean,value:EPt},_firefox:{type:Boolean,value:IPt},_android:{type:Boolean,value:TPt},_touchDevice:{type:Boolean,value:OPt},allRowsVisible:{type:Boolean,value:false,reflectToAttribute:true},__pendingRecalculateColumnWidths:{type:Boolean,value:true},isAttached:{value:false},__gridElement:{type:Boolean,value:true},__hasEmptyStateContent:{type:Boolean,value:false},__emptyState:{type:Boolean,computed:"__computeEmptyState(_flatSize, __hasEmptyStateContent)"}}}constructor(){super();this.addEventListener("animationend",this._onAnimationEnd)}get _firstVisibleIndex(){const t=this.__getFirstVisibleItem();return t?t.index:undefined}get _lastVisibleIndex(){const t=this.__getLastVisibleItem();return t?t.index:undefined}connectedCallback(){super.connectedCallback();this.isAttached=true;this.recalculateColumnWidths()}disconnectedCallback(){super.disconnectedCallback();this.isAttached=false;this._hideTooltip(true)}__getFirstVisibleItem(){return this._getRenderedRows().find((t=>this._isInViewport(t)))}__getLastVisibleItem(){return this._getRenderedRows().reverse().find((t=>this._isInViewport(t)))}_isInViewport(t){const e=this.$.table.getBoundingClientRect();const i=t.getBoundingClientRect();const n=this.$.header.getBoundingClientRect().height;const s=this.$.footer.getBoundingClientRect().height;return i.bottom>e.top+n&&i.top<e.bottom-s}_getRenderedRows(){return Array.from(this.$.items.children).filter((t=>!t.hidden)).sort(((t,e)=>t.index-e.index))}_getRowContainingNode(t){const e=LNt("vaadin-grid-cell-content",t);if(!e){return}const i=e.assignedSlot.parentElement;return i.parentElement}_isItemAssignedToRow(t,e){const i=this.__getRowModel(e);return this.getItemId(t)===this.getItemId(i.item)}ready(){super.ready();this.__virtualizer=new qPt({createElements:this._createScrollerRows.bind(this),updateElement:this._updateScrollerItem.bind(this),scrollContainer:this.$.items,scrollTarget:this.$.table,reorderElements:true});new ResizeObserver((()=>setTimeout((()=>{this.__updateColumnsBodyContentHidden();this.__tryToRecalculateColumnWidthsIfPending()})))).observe(this.$.table);RNt(this);this._tooltipController=new FPt(this);this.addController(this._tooltipController);this._tooltipController.setManual(true);this.__emptyStateContentObserver=new RPt(this.$.emptystateslot,(({currentNodes:t})=>{this.$.emptystatecell._content=t[0];this.__hasEmptyStateContent=!!this.$.emptystatecell._content}))}__getBodyCellCoordinates(t){if(this.$.items.contains(t)&&t.localName==="td"){return{item:t.parentElement._item,column:t._column}}}__focusBodyCell({item:t,column:e}){const i=this._getRenderedRows().find((e=>e._item===t));const n=i&&[...i.children].find((t=>t._column===e));if(n){n.focus()}}_focusFirstVisibleRow(){const t=this.__getFirstVisibleItem();this.__rowFocusMode=true;t.focus()}_flatSizeChanged(t,e,i,n){if(e&&i&&n){const i=this.shadowRoot.activeElement;const n=this.__getBodyCellCoordinates(i);const s=e.size||0;e.size=t;e.update(s-1,s-1);if(t<s){e.update(t-1,t-1)}if(n&&i.parentElement.hidden){this.__focusBodyCell(n)}this._resetKeyboardNavigation()}}__getIntrinsicWidth(t){if(!this.__intrinsicWidthCache.has(t)){this.__calculateAndCacheIntrinsicWidths([t])}return this.__intrinsicWidthCache.get(t)}__getDistributedWidth(t,e){if(t==null||t===this){return 0}const i=Math.max(this.__getIntrinsicWidth(t),this.__getDistributedWidth((t.assignedSlot||t).parentElement,t));if(!e){return i}const n=t;const s=i;const r=n._visibleChildColumns.map((t=>this.__getIntrinsicWidth(t))).reduce(((t,e)=>t+e),0);const o=Math.max(0,s-r);const a=this.__getIntrinsicWidth(e)/r;const l=a*o;return this.__getIntrinsicWidth(e)+l}_recalculateColumnWidths(t){this.__virtualizer.flush();[...this.$.header.children,...this.$.footer.children].forEach((t=>{if(t.__debounceUpdateHeaderFooterRowVisibility){t.__debounceUpdateHeaderFooterRowVisibility.flush()}}));if(this._debouncerHiddenChanged){this._debouncerHiddenChanged.flush()}this.__intrinsicWidthCache=new Map;const e=this._firstVisibleIndex;const i=this._lastVisibleIndex;this.__viewportRowsCache=this._getRenderedRows().filter((t=>t.index>=e&&t.index<=i));this.__calculateAndCacheIntrinsicWidths(t);t.forEach((t=>{t.width=`${this.__getDistributedWidth(t)}px`}))}__setVisibleCellContentAutoWidth(t,e){t._allCells.filter((t=>{if(this.$.items.contains(t)){return this.__viewportRowsCache.includes(t.parentElement)}return true})).forEach((t=>{t.__measuringAutoWidth=e;if(t.__measuringAutoWidth){t.__originalWidth=t.style.width;t.style.width="auto";t.style.position="absolute"}else{t.style.width=t.__originalWidth;delete t.__originalWidth;t.style.position=""}}));if(e){this.$.scroller.setAttribute("measuring-auto-width","")}else{this.$.scroller.removeAttribute("measuring-auto-width")}}__getAutoWidthCellsMaxWidth(t){return t._allCells.reduce(((t,e)=>e.__measuringAutoWidth?Math.max(t,e.offsetWidth+1):t),0)}__calculateAndCacheIntrinsicWidths(t){t.forEach((t=>this.__setVisibleCellContentAutoWidth(t,true)));t.forEach((t=>{const e=this.__getAutoWidthCellsMaxWidth(t);this.__intrinsicWidthCache.set(t,e)}));t.forEach((t=>this.__setVisibleCellContentAutoWidth(t,false)))}recalculateColumnWidths(){if(!this._columnTree){return}if(vPt(this)||this._dataProviderController.isLoading()){this.__pendingRecalculateColumnWidths=true;return}const t=this._getColumns().filter((t=>!t.hidden&&t.autoWidth));const e=t.filter((t=>!customElements.get(t.localName)));if(e.length){Promise.all(e.map((t=>customElements.whenDefined(t.localName)))).then((()=>{this._recalculateColumnWidths(t)}))}else{this._recalculateColumnWidths(t)}}__tryToRecalculateColumnWidthsIfPending(){if(!this.__pendingRecalculateColumnWidths||vPt(this)||this._dataProviderController.isLoading()){return}const t=[...this.$.items.children].some((t=>t.index===undefined));if(t){return}const e=[...this.$.items.children].some((t=>t.clientHeight>0));if(e){this.__pendingRecalculateColumnWidths=false;this.recalculateColumnWidths()}}_onDataProviderPageLoaded(){super._onDataProviderPageLoaded();this.__tryToRecalculateColumnWidthsIfPending()}_createScrollerRows(t){const e=[];for(let i=0;i<t;i++){const t=document.createElement("tr");t.setAttribute("part","row body-row");t.setAttribute("role","row");t.setAttribute("tabindex","-1");if(this._columnTree){this._updateRow(t,this._columnTree[this._columnTree.length-1],"body",false,true)}e.push(t)}if(this._columnTree){this._columnTree[this._columnTree.length-1].forEach((t=>{if(t.isConnected&&t._cells){t._cells=[...t._cells]}}))}this.__afterCreateScrollerRowsDebouncer=_Nt.debounce(this.__afterCreateScrollerRowsDebouncer,vNt,(()=>{this._afterScroll();this.__tryToRecalculateColumnWidthsIfPending()}));return e}_createCell(t,e){const i=this._contentIndex=this._contentIndex+1||0;const n=`vaadin-grid-cell-content-${i}`;const s=document.createElement("vaadin-grid-cell-content");s.setAttribute("slot",n);const r=document.createElement(t);r.id=n.replace("-content-","-");r.setAttribute("role",t==="td"?"gridcell":"columnheader");if(!TPt&&!EPt){r.addEventListener("mouseenter",(t=>{if(!this.$.scroller.hasAttribute("scrolling")){this._showTooltip(t)}}));r.addEventListener("mouseleave",(()=>{this._hideTooltip()}));r.addEventListener("mousedown",(()=>{this._hideTooltip(true)}))}const o=document.createElement("slot");o.setAttribute("name",n);if(e&&e._focusButtonMode){const t=document.createElement("div");t.setAttribute("role","button");t.setAttribute("tabindex","-1");r.appendChild(t);r._focusButton=t;r.focus=function(t){r._focusButton.focus(t)};t.appendChild(o)}else{r.setAttribute("tabindex","-1");r.appendChild(o)}r._content=s;s.addEventListener("mousedown",(()=>{if(APt){const t=e=>{const i=s.contains(this.getRootNode().activeElement);const n=e.composedPath().includes(s);if(!i&&n){r.focus({preventScroll:true})}document.removeEventListener("mouseup",t,true)};document.addEventListener("mouseup",t,true)}else{setTimeout((()=>{if(!s.contains(this.getRootNode().activeElement)){r.focus({preventScroll:true})}}))}}));return r}_updateRow(t,e,i="body",n=false,s=false){const r=document.createDocumentFragment();BNt(t,(t=>{t._vacant=true}));t.innerHTML="";if(i==="body"){t.__cells=[];t.__detailsCell=null}e.filter((t=>!t.hidden)).forEach(((e,o,a)=>{let l;if(i==="body"){if(!e._cells){e._cells=[]}l=e._cells.find((t=>t._vacant));if(!l){l=this._createCell("td",e);if(e._onCellKeyDown){l.addEventListener("keydown",e._onCellKeyDown.bind(e))}e._cells.push(l)}l.setAttribute("part","cell body-cell");l.__parentRow=t;t.__cells.push(l);const i=t===this.$.sizer;if(!e._bodyContentHidden||i){t.appendChild(l)}if(i){e._sizerCell=l}if(o===a.length-1&&this.rowDetailsRenderer){if(!this._detailsCells){this._detailsCells=[]}const e=this._detailsCells.find((t=>t._vacant))||this._createCell("td");if(this._detailsCells.indexOf(e)===-1){this._detailsCells.push(e)}if(!e._content.parentElement){r.appendChild(e._content)}this._configureDetailsCell(e);t.appendChild(e);t.__detailsCell=e;this._a11ySetRowDetailsCell(t,e);e._vacant=false}if(!s){e._cells=[...e._cells]}}else{const s=i==="header"?"th":"td";if(n||e.localName==="vaadin-grid-column-group"){l=e[`_${i}Cell`];if(!l){l=this._createCell(s);if(e._onCellKeyDown){l.addEventListener("keydown",e._onCellKeyDown.bind(e))}}l._column=e;t.appendChild(l);e[`_${i}Cell`]=l}else{if(!e._emptyCells){e._emptyCells=[]}l=e._emptyCells.find((t=>t._vacant))||this._createCell(s);l._column=e;t.appendChild(l);if(e._emptyCells.indexOf(l)===-1){e._emptyCells.push(l)}}l.part.add("cell",`${i}-cell`)}if(!l._content.parentElement){r.appendChild(l._content)}l._vacant=false;l._column=e}));if(i!=="body"){this.__debounceUpdateHeaderFooterRowVisibility(t)}this.appendChild(r);this._frozenCellsChanged();this._updateFirstAndLastColumnForRow(t)}__debounceUpdateHeaderFooterRowVisibility(t){t.__debounceUpdateHeaderFooterRowVisibility=_Nt.debounce(t.__debounceUpdateHeaderFooterRowVisibility,bNt,(()=>this.__updateHeaderFooterRowVisibility(t)))}__updateHeaderFooterRowVisibility(t){if(!t){return}const e=Array.from(t.children).filter((e=>{const i=e._column;if(i._emptyCells&&i._emptyCells.indexOf(e)>-1){return false}if(t.parentElement===this.$.header){if(i.headerRenderer){return true}if(i.header===null){return false}if(i.path||i.header!==undefined){return true}}else if(i.footerRenderer){return true}return false}));if(t.hidden!==!e.length){t.hidden=!e.length}this._resetKeyboardNavigation()}_updateScrollerItem(t,e){this._preventScrollerRotatingCellFocus(t,e);if(!this._columnTree){return}this._updateRowOrderParts(t,e);this._a11yUpdateRowRowindex(t,e);this._getItem(e,t)}_columnTreeChanged(t){this._renderColumnTree(t);this.recalculateColumnWidths();this.__updateColumnsBodyContentHidden()}_updateRowOrderParts(t,e=t.index){WNt(t,{first:e===0,last:e===this._flatSize-1,odd:e%2!==0,even:e%2===0})}_updateRowStateParts(t,{expanded:e,selected:i,detailsOpened:n}){WNt(t,{expanded:e,collapsed:this.__isRowExpandable(t),selected:i,"details-opened":n})}__computeEmptyState(t,e){return t===0&&e}_renderColumnTree(t){UNt(this.$.items,(e=>{this._updateRow(e,t[t.length-1],"body",false,true);const i=this.__getRowModel(e);this._updateRowOrderParts(e);this._updateRowStateParts(e,i);this._filterDragAndDrop(e,i)}));while(this.$.header.children.length<t.length){const t=document.createElement("tr");t.setAttribute("part","row");t.setAttribute("role","row");t.setAttribute("tabindex","-1");this.$.header.appendChild(t);const e=document.createElement("tr");e.setAttribute("part","row");e.setAttribute("role","row");e.setAttribute("tabindex","-1");this.$.footer.appendChild(e)}while(this.$.header.children.length>t.length){this.$.header.removeChild(this.$.header.firstElementChild);this.$.footer.removeChild(this.$.footer.firstElementChild)}UNt(this.$.header,((e,i,n)=>{this._updateRow(e,t[i],"header",i===t.length-1);const s=zNt(e);HNt(s,"first-header-row-cell",i===0);HNt(s,"last-header-row-cell",i===n.length-1)}));UNt(this.$.footer,((e,i,n)=>{this._updateRow(e,t[t.length-1-i],"footer",i===0);const s=zNt(e);HNt(s,"first-footer-row-cell",i===0);HNt(s,"last-footer-row-cell",i===n.length-1)}));this._updateRow(this.$.sizer,t[t.length-1]);this._resizeHandler();this._frozenCellsChanged();this._updateFirstAndLastColumn();this._resetKeyboardNavigation();this._a11yUpdateHeaderRows();this._a11yUpdateFooterRows();this.generateCellClassNames();this.generateCellPartNames();this.__updateHeaderAndFooter()}_updateItem(t,e){t._item=e;const i=this.__getRowModel(t);this._toggleDetailsCell(t,i.detailsOpened);this._a11yUpdateRowLevel(t,i.level);this._a11yUpdateRowSelected(t,i.selected);this._updateRowStateParts(t,i);this._generateCellClassNames(t,i);this._generateCellPartNames(t,i);this._filterDragAndDrop(t,i);this.__updateDragSourceParts(t,i);UNt(t,(t=>{if(t._column&&!t._column.isConnected){return}if(t._renderer){const e=t._column||this;t._renderer.call(e,t._content,e,i)}}));this._updateDetailsCellHeight(t);this._a11yUpdateRowExpanded(t,i.expanded)}_resizeHandler(){this._updateDetailsCellHeights();this.__updateHorizontalScrollPosition()}_onAnimationEnd(t){if(t.animationName.indexOf("vaadin-grid-appear")===0){t.stopPropagation();this.__tryToRecalculateColumnWidthsIfPending();this._resetKeyboardNavigation();requestAnimationFrame((()=>{this.__scrollToPendingIndexes()}))}}__getRowModel(t){return{index:t.index,item:t._item,level:this._getIndexLevel(t.index),expanded:this._isExpanded(t._item),selected:this._isSelected(t._item),detailsOpened:!!this.rowDetailsRenderer&&this._isDetailsOpened(t._item)}}_showTooltip(t){const e=this._tooltipController.node;if(e&&e.isConnected){const i=t.target;if(!this.__isCellFullyVisible(i)){return}this._tooltipController.setTarget(i);this._tooltipController.setContext(this.getEventContext(t));e._stateController.open({focus:t.type==="focusin",hover:t.type==="mouseenter"})}}__isCellFullyVisible(t){if(t.hasAttribute("frozen")||t.hasAttribute("frozen-to-end")){return true}let{left:e,right:i}=this.getBoundingClientRect();const n=[...t.parentNode.children].find((t=>t.hasAttribute("last-frozen")));if(n){const t=n.getBoundingClientRect();e=this.__isRTL?e:t.right;i=this.__isRTL?t.left:i}const s=[...t.parentNode.children].find((t=>t.hasAttribute("first-frozen-to-end")));if(s){const t=s.getBoundingClientRect();e=this.__isRTL?t.right:e;i=this.__isRTL?i:t.left}const r=t.getBoundingClientRect();return r.left>=e&&r.right<=i}_hideTooltip(t){const e=this._tooltipController&&this._tooltipController.node;if(e){e._stateController.close(t)}}requestContentUpdate(){this.__updateHeaderAndFooter();this.__updateVisibleRows()}__updateHeaderAndFooter(){(this._columnTree||[]).forEach((t=>{t.forEach((t=>{if(t._renderHeaderAndFooter){t._renderHeaderAndFooter()}}))}))}__updateVisibleRows(t,e){if(this.__virtualizer){this.__virtualizer.update(t,e)}}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const LDt=UEt`
  @keyframes vaadin-grid-appear {
    to {
      opacity: 1;
    }
  }

  :host {
    display: flex;
    flex-direction: column;
    animation: 1ms vaadin-grid-appear;
    height: 400px;
    flex: 1 1 auto;
    align-self: stretch;
    position: relative;
  }

  :host([hidden]) {
    display: none !important;
  }

  :host([disabled]) {
    pointer-events: none;
  }

  #scroller {
    display: flex;
    flex-direction: column;
    min-height: 100%;
    transform: translateY(0);
    width: auto;
    height: auto;
    position: absolute;
    inset: 0;
  }

  :host([all-rows-visible]) {
    height: auto;
    align-self: flex-start;
    flex-grow: 0;
    width: 100%;
  }

  :host([all-rows-visible]) #scroller {
    width: 100%;
    height: 100%;
    position: relative;
  }

  :host([all-rows-visible]) #items {
    min-height: 1px;
  }

  #table {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    overflow: auto;
    position: relative;
    outline: none;
    /* Workaround for a Desktop Safari bug: new stacking context here prevents the scrollbar from getting hidden */
    z-index: 0;
  }

  #header,
  #footer {
    display: block;
    position: -webkit-sticky;
    position: sticky;
    left: 0;
    overflow: visible;
    width: 100%;
    z-index: 1;
  }

  #header {
    top: 0;
  }

  th {
    text-align: inherit;
  }

  /* Safari doesn't work with "inherit" */
  [safari] th {
    text-align: initial;
  }

  #footer {
    bottom: 0;
  }

  #items {
    flex-grow: 1;
    flex-shrink: 0;
    display: block;
    position: -webkit-sticky;
    position: sticky;
    width: 100%;
    left: 0;
    overflow: visible;
  }

  [part~='row'] {
    display: flex;
    width: 100%;
    box-sizing: border-box;
    margin: 0;
  }

  [part~='row'][loading] [part~='body-cell'] ::slotted(vaadin-grid-cell-content) {
    visibility: hidden;
  }

  [column-rendering='lazy'] [part~='body-cell']:not([frozen]):not([frozen-to-end]) {
    transform: translateX(var(--_grid-lazy-columns-start));
  }

  #items [part~='row'] {
    position: absolute;
  }

  #items [part~='row']:empty {
    height: 100%;
  }

  [part~='cell']:not([part~='details-cell']) {
    flex-shrink: 0;
    flex-grow: 1;
    box-sizing: border-box;
    display: flex;
    width: 100%;
    position: relative;
    align-items: center;
    padding: 0;
    white-space: nowrap;
  }

  [part~='cell'] {
    outline: none;
  }

  [part~='cell'] > [tabindex] {
    display: flex;
    align-items: inherit;
    outline: none;
    position: absolute;
    inset: 0;
  }

  /* Switch the focusButtonMode wrapping element to "position: static" temporarily
     when measuring real width of the cells in the auto-width columns. */
  [measuring-auto-width] [part~='cell'] > [tabindex] {
    position: static;
  }

  [part~='details-cell'] {
    position: absolute;
    bottom: 0;
    width: 100%;
    box-sizing: border-box;
    padding: 0;
  }

  [part~='cell'] ::slotted(vaadin-grid-cell-content) {
    display: block;
    width: 100%;
    box-sizing: border-box;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  [hidden] {
    display: none !important;
  }

  [frozen],
  [frozen-to-end] {
    z-index: 2;
    will-change: transform;
  }

  [no-scrollbars][safari] #table,
  [no-scrollbars][firefox] #table {
    overflow: hidden;
  }

  /* Empty state */

  #scroller:not([empty-state]) #emptystatebody,
  #scroller[empty-state] #items {
    display: none;
  }

  #emptystatebody {
    display: flex;
    position: sticky;
    inset: 0;
    flex: 1;
    overflow: hidden;
  }

  #emptystaterow {
    display: flex;
    flex: 1;
  }

  #emptystatecell {
    display: block;
    flex: 1;
    overflow: auto;
  }

  /* Reordering styles */
  :host([reordering]) [part~='cell'] ::slotted(vaadin-grid-cell-content),
  :host([reordering]) [part~='resize-handle'],
  #scroller[no-content-pointer-events] [part~='cell'] ::slotted(vaadin-grid-cell-content) {
    pointer-events: none;
  }

  [part~='reorder-ghost'] {
    visibility: hidden;
    position: fixed;
    pointer-events: none;
    opacity: 0.5;

    /* Prevent overflowing the grid in Firefox */
    top: 0;
    left: 0;
  }

  :host([reordering]) {
    -moz-user-select: none;
    -webkit-user-select: none;
    user-select: none;
  }

  /* Resizing styles */
  [part~='resize-handle'] {
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
    cursor: col-resize;
    z-index: 1;
  }

  [part~='resize-handle']::before {
    position: absolute;
    content: '';
    height: 100%;
    width: 35px;
    transform: translateX(-50%);
  }

  [last-column] [part~='resize-handle']::before,
  [last-frozen] [part~='resize-handle']::before {
    width: 18px;
    transform: none;
    right: 0;
  }

  [frozen-to-end] [part~='resize-handle'] {
    left: 0;
    right: auto;
  }

  [frozen-to-end] [part~='resize-handle']::before {
    left: 0;
    right: auto;
  }

  [first-frozen-to-end] [part~='resize-handle']::before {
    width: 18px;
    transform: none;
  }

  [first-frozen-to-end] {
    margin-inline-start: auto;
  }

  /* Hide resize handle if scrolled to end */
  :host(:not([overflow~='end'])) [first-frozen-to-end] [part~='resize-handle'] {
    display: none;
  }

  #scroller[column-resizing] {
    -ms-user-select: none;
    -moz-user-select: none;
    -webkit-user-select: none;
    user-select: none;
  }

  /* Sizer styles */
  #sizer {
    display: flex;
    position: absolute;
    visibility: hidden;
  }

  #sizer [part~='details-cell'] {
    display: none !important;
  }

  #sizer [part~='cell'][hidden] {
    display: none !important;
  }

  #sizer [part~='cell'] {
    display: block;
    flex-shrink: 0;
    line-height: 0;
    height: 0 !important;
    min-height: 0 !important;
    max-height: 0 !important;
    padding: 0 !important;
    border: none !important;
  }

  #sizer [part~='cell']::before {
    content: '-';
  }

  #sizer [part~='cell'] ::slotted(vaadin-grid-cell-content) {
    display: none !important;
  }

  /* RTL specific styles */

  :host([dir='rtl']) #items,
  :host([dir='rtl']) #header,
  :host([dir='rtl']) #footer {
    left: auto;
  }

  :host([dir='rtl']) [part~='reorder-ghost'] {
    left: auto;
    right: 0;
  }

  :host([dir='rtl']) [part~='resize-handle'] {
    left: 0;
    right: auto;
  }

  :host([dir='rtl']) [part~='resize-handle']::before {
    transform: translateX(50%);
  }

  :host([dir='rtl']) [last-column] [part~='resize-handle']::before,
  :host([dir='rtl']) [last-frozen] [part~='resize-handle']::before {
    left: 0;
    right: auto;
  }

  :host([dir='rtl']) [frozen-to-end] [part~='resize-handle'] {
    right: 0;
    left: auto;
  }

  :host([dir='rtl']) [frozen-to-end] [part~='resize-handle']::before {
    right: 0;
    left: auto;
  }

  @media (forced-colors: active) {
    [part~='selected-row'] [part~='first-column-cell']::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      border: 2px solid;
    }

    [part~='focused-cell']::before {
      outline: 2px solid !important;
      outline-offset: -1px;
    }
  }
`
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;rOt("vaadin-grid",LDt,{moduleId:"vaadin-grid-styles"});class NDt extends(RDt(pPt(cOt(tPt(hNt))))){static get template(){return uNt`
      <div
        id="scroller"
        safari$="[[_safari]]"
        ios$="[[_ios]]"
        loading$="[[loading]]"
        column-reordering-allowed$="[[columnReorderingAllowed]]"
        empty-state$="[[__emptyState]]"
      >
        <table id="table" role="treegrid" aria-multiselectable="true" tabindex="0">
          <caption id="sizer" part="row"></caption>
          <thead id="header" role="rowgroup"></thead>
          <tbody id="items" role="rowgroup"></tbody>
          <tbody id="emptystatebody">
            <tr id="emptystaterow">
              <td part="empty-state" id="emptystatecell" tabindex="0">
                <slot name="empty-state" id="emptystateslot"></slot>
              </td>
            </tr>
          </tbody>
          <tfoot id="footer" role="rowgroup"></tfoot>
        </table>

        <div part="reorder-ghost"></div>
      </div>

      <slot name="tooltip"></slot>

      <div id="focusexit" tabindex="0"></div>
    `}static get is(){return"vaadin-grid"}}REt(NDt);
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const PDt=t=>class extends(KNt(t)){static get properties(){return{_childColumns:{value(){return this._getChildColumns(this)}},flexGrow:{type:Number,readOnly:true,sync:true},width:{type:String,readOnly:true},_visibleChildColumns:Array,_colSpan:Number,_rootColumns:Array}}static get observers(){return["_groupFrozenChanged(frozen, _rootColumns)","_groupFrozenToEndChanged(frozenToEnd, _rootColumns)","_groupHiddenChanged(hidden)","_colSpanChanged(_colSpan, _headerCell, _footerCell)","_groupOrderChanged(_order, _rootColumns)","_groupReorderStatusChanged(_reorderStatus, _rootColumns)","_groupResizableChanged(resizable, _rootColumns)"]}connectedCallback(){super.connectedCallback();this._addNodeObserver();this._updateFlexAndWidth()}disconnectedCallback(){super.disconnectedCallback();if(this._observer){this._observer.disconnect()}}_columnPropChanged(t,e){if(t==="hidden"){this._preventHiddenSynchronization=true;this._updateVisibleChildColumns(this._childColumns);this._preventHiddenSynchronization=false}if(/flexGrow|width|hidden|_childColumns/u.test(t)){this._updateFlexAndWidth()}if(t==="frozen"&&!this.frozen){this.frozen=e}if(t==="lastFrozen"&&!this._lastFrozen){this._lastFrozen=e}if(t==="frozenToEnd"&&!this.frozenToEnd){this.frozenToEnd=e}if(t==="firstFrozenToEnd"&&!this._firstFrozenToEnd){this._firstFrozenToEnd=e}}_groupOrderChanged(t,e){if(e){const i=e.slice(0);if(!t){i.forEach((t=>{t._order=0}));return}const n=/(0+)$/u.exec(t).pop().length;const s=~~(Math.log(e.length)/Math.LN10)+1;const r=10**(n-s);if(i[0]&&i[0]._order){i.sort(((t,e)=>t._order-e._order))}GNt(i,r,t)}}_groupReorderStatusChanged(t,e){if(t===undefined||e===undefined){return}e.forEach((e=>{e._reorderStatus=t}))}_groupResizableChanged(t,e){if(t===undefined||e===undefined){return}e.forEach((e=>{e.resizable=t}))}_updateVisibleChildColumns(t){this._visibleChildColumns=Array.prototype.filter.call(t,(t=>!t.hidden));this._colSpan=this._visibleChildColumns.length;this._updateAutoHidden()}_updateFlexAndWidth(){if(!this._visibleChildColumns){return}if(this._visibleChildColumns.length>0){const t=this._visibleChildColumns.reduce(((t,e)=>{t+=` + ${(e.width||"0px").replace("calc","")}`;return t}),"").substring(3);this._setWidth(`calc(${t})`)}else{this._setWidth("0px")}this._setFlexGrow(Array.prototype.reduce.call(this._visibleChildColumns,((t,e)=>t+e.flexGrow),0))}__scheduleAutoFreezeWarning(t,e){if(this._grid){const i=e.replace(/([A-Z])/gu,"-$1").toLowerCase();const n=t[0][e]||t[0].hasAttribute(i);const s=t.every((t=>(t[e]||t.hasAttribute(i))===n));if(!s){this._grid.__autoFreezeWarningDebouncer=_Nt.debounce(this._grid.__autoFreezeWarningDebouncer,vNt,(()=>{console.warn(`WARNING: Joining ${e} and non-${e} Grid columns inside the same column group! `+`This will automatically freeze all the joined columns to avoid rendering issues. `+`If this was intentional, consider marking each joined column explicitly as ${e}. `+`Otherwise, exclude the ${e} columns from the joined group.`)}))}}}_groupFrozenChanged(t,e){if(e===undefined||t===undefined){return}if(t!==false){this.__scheduleAutoFreezeWarning(e,"frozen");Array.from(e).forEach((e=>{e.frozen=t}))}}_groupFrozenToEndChanged(t,e){if(e===undefined||t===undefined){return}if(t!==false){this.__scheduleAutoFreezeWarning(e,"frozenToEnd");Array.from(e).forEach((e=>{e.frozenToEnd=t}))}}_groupHiddenChanged(t){if(t||this.__groupHiddenInitialized){this._synchronizeHidden()}this.__groupHiddenInitialized=true}_updateAutoHidden(){const t=this._autoHidden;this._autoHidden=(this._visibleChildColumns||[]).length===0;if(t||this._autoHidden){this.hidden=this._autoHidden}}_synchronizeHidden(){if(this._childColumns&&!this._preventHiddenSynchronization){this._childColumns.forEach((t=>{t.hidden=this.hidden}))}}_colSpanChanged(t,e,i){if(e){e.setAttribute("colspan",t);if(this._grid){this._grid._a11yUpdateCellColspan(e,t)}}if(i){i.setAttribute("colspan",t);if(this._grid){this._grid._a11yUpdateCellColspan(i,t)}}}_getChildColumns(t){return YNt.getColumns(t)}_addNodeObserver(){this._observer=new YNt(this,(()=>{this._preventHiddenSynchronization=true;this._rootColumns=this._getChildColumns(this);this._childColumns=this._rootColumns;this._updateVisibleChildColumns(this._childColumns);this._preventHiddenSynchronization=false;if(this._grid&&this._grid._debounceUpdateColumnTree){this._grid._debounceUpdateColumnTree()}}));this._observer.flush()}_isColumnElement(t){return t.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/u.test(t.localName)}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class FDt extends(PDt(hNt)){static get is(){return"vaadin-grid-column-group"}}REt(FDt);rOt("vaadin-checkbox",UEt`
    :host {
      color: var(--vaadin-checkbox-label-color, var(--lumo-body-text-color));
      font-size: var(--vaadin-checkbox-label-font-size, var(--lumo-font-size-m));
      font-family: var(--lumo-font-family);
      line-height: var(--lumo-line-height-s);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      -webkit-tap-highlight-color: transparent;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
      cursor: default;
      outline: none;
      --_checkbox-size: var(--vaadin-checkbox-size, calc(var(--lumo-size-m) / 2));
      --_focus-ring-color: var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct));
      --_focus-ring-width: var(--vaadin-focus-ring-width, 2px);
      --_selection-color: var(--vaadin-selection-color, var(--lumo-primary-color));
      --_invalid-background: var(--vaadin-input-field-invalid-background, var(--lumo-error-color-10pct));
      --_disabled-checkmark-color: var(--vaadin-checkbox-disabled-checkmark-color, var(--lumo-contrast-30pct));
    }

    [part='label'] {
      display: flex;
      position: relative;
      max-width: max-content;
    }

    :host([has-label]) ::slotted(label) {
      padding: var(
        --vaadin-checkbox-label-padding,
        var(--lumo-space-xs) var(--lumo-space-s) var(--lumo-space-xs) var(--lumo-space-xs)
      );
    }

    :host([dir='rtl'][has-label]) ::slotted(label) {
      padding: var(--lumo-space-xs) var(--lumo-space-xs) var(--lumo-space-xs) var(--lumo-space-s);
    }

    :host([has-label][required]) ::slotted(label) {
      padding-inline-end: var(--lumo-space-m);
    }

    [part='checkbox'] {
      width: var(--_checkbox-size);
      height: var(--_checkbox-size);
      margin: var(--lumo-space-xs);
      position: relative;
      border-radius: var(--vaadin-checkbox-border-radius, var(--lumo-border-radius-s));
      background: var(--vaadin-checkbox-background, var(--lumo-contrast-20pct));
      transition:
        transform 0.2s cubic-bezier(0.12, 0.32, 0.54, 2),
        background-color 0.15s;
      cursor: var(--lumo-clickable-cursor);
      /* Default field border color */
      --_input-border-color: var(--vaadin-input-field-border-color, var(--lumo-contrast-50pct));
    }

    :host([indeterminate]),
    :host([checked]) {
      --vaadin-input-field-border-color: transparent;
    }

    :host([indeterminate]) [part='checkbox'],
    :host([checked]) [part='checkbox'] {
      background-color: var(--_selection-color);
    }

    /* Checkmark */
    [part='checkbox']::after {
      pointer-events: none;
      font-family: 'lumo-icons';
      content: var(--vaadin-checkbox-checkmark-char, var(--lumo-icons-checkmark));
      color: var(--vaadin-checkbox-checkmark-color, var(--lumo-primary-contrast-color));
      font-size: var(--vaadin-checkbox-checkmark-size, calc(var(--_checkbox-size) + 2px));
      line-height: 1;
      position: absolute;
      top: -1px;
      left: -1px;
      contain: content;
      opacity: 0;
    }

    :host([checked]) [part='checkbox']::after {
      opacity: 1;
    }

    :host([readonly]:not([checked]):not([indeterminate])) {
      color: var(--lumo-secondary-text-color);
    }

    :host([readonly]:not([checked]):not([indeterminate])) [part='checkbox'] {
      background: transparent;
      box-shadow: none;
    }

    :host([readonly]:not([checked]):not([indeterminate])) [part='checkbox']::after {
      content: '';
      box-sizing: border-box;
      width: 100%;
      height: 100%;
      border-radius: inherit;
      top: 0;
      left: 0;
      opacity: 1;
      border: var(--vaadin-input-field-readonly-border, 1px dashed var(--lumo-contrast-50pct));
    }

    /* Indeterminate checkmark */
    :host([indeterminate]) [part='checkbox']::after {
      content: var(--vaadin-checkbox-checkmark-char-indeterminate, '');
      opacity: 1;
      top: 45%;
      height: 10%;
      left: 22%;
      right: 22%;
      width: auto;
      border: 0;
      background-color: var(--lumo-primary-contrast-color);
    }

    /* Focus ring */
    :host([focus-ring]) [part='checkbox'] {
      box-shadow:
        0 0 0 1px var(--lumo-base-color),
        0 0 0 calc(var(--_focus-ring-width) + 1px) var(--_focus-ring-color),
        inset 0 0 0 var(--_input-border-width, 0) var(--_input-border-color);
    }

    :host([focus-ring][readonly]:not([checked]):not([indeterminate])) [part='checkbox'] {
      box-shadow:
        0 0 0 1px var(--lumo-base-color),
        0 0 0 calc(var(--_focus-ring-width) + 1px) var(--_focus-ring-color);
    }

    /* Disabled */
    :host([disabled]) {
      pointer-events: none;
      --vaadin-input-field-border-color: var(--lumo-contrast-20pct);
    }

    :host([disabled]) ::slotted(label) {
      color: inherit;
    }

    :host([disabled]) [part='checkbox'] {
      background-color: var(--vaadin-checkbox-disabled-background, var(--lumo-contrast-10pct));
    }

    :host([disabled]) [part='checkbox']::after {
      color: var(--_disabled-checkmark-color);
    }

    :host([disabled]) [part='label'],
    :host([disabled]) [part='helper-text'] {
      color: var(--lumo-disabled-text-color);
      -webkit-text-fill-color: var(--lumo-disabled-text-color);
    }

    :host([indeterminate][disabled]) [part='checkbox']::after {
      background-color: var(--_disabled-checkmark-color);
    }

    :host([readonly][checked]:not([disabled])) [part='checkbox'],
    :host([readonly][indeterminate]:not([disabled])) [part='checkbox'] {
      background-color: var(--vaadin-checkbox-readonly-checked-background, var(--lumo-contrast-70pct));
    }

    /* Used for activation "halo" */
    [part='checkbox']::before {
      pointer-events: none;
      color: transparent;
      width: 100%;
      height: 100%;
      line-height: var(--_checkbox-size);
      border-radius: inherit;
      background-color: inherit;
      transform: scale(1.4);
      opacity: 0;
      transition:
        transform 0.1s,
        opacity 0.8s;
    }

    /* Hover */
    :host(:not([checked]):not([indeterminate]):not([disabled]):not([readonly]):not([invalid]):hover) [part='checkbox'] {
      background: var(--vaadin-checkbox-background-hover, var(--lumo-contrast-30pct));
    }

    /* Disable hover for touch devices */
    @media (pointer: coarse) {
      /* prettier-ignore */
      :host(:not([checked]):not([indeterminate]):not([disabled]):not([readonly]):not([invalid]):hover) [part='checkbox'] {
        background: var(--vaadin-checkbox-background, var(--lumo-contrast-20pct));
      }
    }

    /* Active */
    :host([active]) [part='checkbox'] {
      transform: scale(0.9);
      transition-duration: 0.05s;
    }

    :host([active][checked]) [part='checkbox'] {
      transform: scale(1.1);
    }

    :host([active]:not([checked])) [part='checkbox']::before {
      transition-duration: 0.01s, 0.01s;
      transform: scale(0);
      opacity: 0.4;
    }

    /* Required */
    :host([required]) [part='required-indicator'] {
      position: absolute;
      top: var(--lumo-space-xs);
      right: var(--lumo-space-xs);
    }

    :host([required][dir='rtl']) [part='required-indicator'] {
      right: auto;
      left: var(--lumo-space-xs);
    }

    :host([required]) [part='required-indicator']::after {
      content: var(--lumo-required-field-indicator, '\\2022');
      transition: opacity 0.2s;
      color: var(--lumo-required-field-indicator-color, var(--lumo-primary-text-color));
      width: 1em;
      text-align: center;
    }

    /* Invalid */
    :host([invalid]) {
      --vaadin-input-field-border-color: var(--lumo-error-color);
    }

    :host([invalid]) [part='checkbox'] {
      background: var(--_invalid-background);
      background-image: linear-gradient(var(--_invalid-background) 0%, var(--_invalid-background) 100%);
    }

    :host([invalid]:hover) [part='checkbox'] {
      background-image: linear-gradient(var(--_invalid-background) 0%, var(--_invalid-background) 100%),
        linear-gradient(var(--_invalid-background) 0%, var(--_invalid-background) 100%);
    }

    :host([invalid][focus-ring]) {
      --_focus-ring-color: var(--lumo-error-color-50pct);
    }

    :host([invalid]) [part='required-indicator']::after {
      color: var(--lumo-required-field-indicator-color, var(--lumo-error-text-color));
    }

    /* Error message */
    [part='error-message'] {
      font-size: var(--vaadin-input-field-error-font-size, var(--lumo-font-size-xs));
      line-height: var(--lumo-line-height-xs);
      font-weight: var(--vaadin-input-field-error-font-weight, 400);
      color: var(--vaadin-input-field-error-color, var(--lumo-error-text-color));
      will-change: max-height;
      transition: 0.4s max-height;
      max-height: 5em;
      padding-inline-start: var(--lumo-space-xs);
    }

    :host([has-error-message]) [part='error-message']::after,
    :host([has-helper]) [part='helper-text']::after {
      content: '';
      display: block;
      height: 0.4em;
    }

    :host(:not([invalid])) [part='error-message'] {
      max-height: 0;
      overflow: hidden;
    }

    /* Helper */
    [part='helper-text'] {
      display: block;
      color: var(--vaadin-input-field-helper-color, var(--lumo-secondary-text-color));
      font-size: var(--vaadin-input-field-helper-font-size, var(--lumo-font-size-xs));
      line-height: var(--lumo-line-height-xs);
      font-weight: var(--vaadin-input-field-helper-font-weight, 400);
      margin-left: calc(var(--lumo-border-radius-m) / 4);
      transition: color 0.2s;
      padding-inline-start: var(--lumo-space-xs);
    }

    :host(:hover:not([readonly])) [part='helper-text'] {
      color: var(--lumo-body-text-color);
    }

    :host([has-error-message]) ::slotted(label),
    :host([has-helper]) ::slotted(label) {
      padding-bottom: 0;
    }
  `,{moduleId:"lumo-checkbox"});
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const DDt=GOt((t=>class e extends t{static get properties(){return{stateTarget:{type:Object,observer:"_stateTargetChanged"}}}static get delegateAttrs(){return[]}static get delegateProps(){return[]}ready(){super.ready();this._createDelegateAttrsObserver();this._createDelegatePropsObserver()}_stateTargetChanged(t){if(t){this._ensureAttrsDelegated();this._ensurePropsDelegated()}}_createDelegateAttrsObserver(){this._createMethodObserver(`_delegateAttrsChanged(${this.constructor.delegateAttrs.join(", ")})`)}_createDelegatePropsObserver(){this._createMethodObserver(`_delegatePropsChanged(${this.constructor.delegateProps.join(", ")})`)}_ensureAttrsDelegated(){this.constructor.delegateAttrs.forEach((t=>{this._delegateAttribute(t,this[t])}))}_ensurePropsDelegated(){this.constructor.delegateProps.forEach((t=>{this._delegateProperty(t,this[t])}))}_delegateAttrsChanged(...t){this.constructor.delegateAttrs.forEach(((e,i)=>{this._delegateAttribute(e,t[i])}))}_delegatePropsChanged(...t){this.constructor.delegateProps.forEach(((e,i)=>{this._delegateProperty(e,t[i])}))}_delegateAttribute(t,e){if(!this.stateTarget){return}if(t==="invalid"){this._delegateAttribute("aria-invalid",e?"true":false)}if(typeof e==="boolean"){this.stateTarget.toggleAttribute(t,e)}else if(e){this.stateTarget.setAttribute(t,e)}else{this.stateTarget.removeAttribute(t)}}_delegateProperty(t,e){if(!this.stateTarget){return}this.stateTarget[t]=e}}));
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const $Dt=GOt((t=>class e extends t{static get properties(){return{inputElement:{type:Object,readOnly:true,observer:"_inputElementChanged"},type:{type:String,readOnly:true},value:{type:String,value:"",observer:"_valueChanged",notify:true,sync:true},_hasInputValue:{type:Boolean,value:false,observer:"_hasInputValueChanged"}}}constructor(){super();this._boundOnInput=this.__onInput.bind(this);this._boundOnChange=this._onChange.bind(this)}get _hasValue(){return this.value!=null&&this.value!==""}get _inputElementValueProperty(){return"value"}get _inputElementValue(){return this.inputElement?this.inputElement[this._inputElementValueProperty]:undefined}set _inputElementValue(t){if(this.inputElement){this.inputElement[this._inputElementValueProperty]=t}}clear(){this._hasInputValue=false;this.value="";this._inputElementValue=""}_addInputListeners(t){t.addEventListener("input",this._boundOnInput);t.addEventListener("change",this._boundOnChange)}_removeInputListeners(t){t.removeEventListener("input",this._boundOnInput);t.removeEventListener("change",this._boundOnChange)}_forwardInputValue(t){if(!this.inputElement){return}this._inputElementValue=t!=null?t:""}_inputElementChanged(t,e){if(t){this._addInputListeners(t)}else if(e){this._removeInputListeners(e)}}_hasInputValueChanged(t,e){if(t||e){this.dispatchEvent(new CustomEvent("has-input-value-changed"))}}__onInput(t){this._setHasInputValue(t);this._onInput(t)}_onInput(t){const e=t.composedPath()[0];this.__userInput=t.isTrusted;this.value=e.value;this.__userInput=false}_onChange(t){}_toggleHasValue(t){this.toggleAttribute("has-value",t)}_valueChanged(t,e){this._toggleHasValue(this._hasValue);if(t===""&&e===undefined){return}if(this.__userInput){return}this._forwardInputValue(t)}_setHasInputValue(t){const e=t.composedPath()[0];this._hasInputValue=e.value.length>0}}));
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const zDt=GOt((t=>class e extends(DDt(bPt($Dt(t)))){static get properties(){return{checked:{type:Boolean,value:false,notify:true,reflectToAttribute:true}}}static get delegateProps(){return[...super.delegateProps,"checked"]}_onChange(t){const e=t.target;this._toggleChecked(e.checked)}_toggleChecked(t){this.checked=t}}));
/**
 * @license
 * Copyright (c) 2022 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class UDt extends PPt{constructor(t,e,i,n={}){super(t,e,i,{...n,useUniqueId:true})}initCustomNode(t){this.__updateNodeId(t);this.__notifyChange(t)}teardownNode(t){const e=this.getSlotChild();if(e&&e!==this.defaultNode){this.__notifyChange(e)}else{this.restoreDefaultNode();this.updateDefaultNode(this.node)}}attachDefaultNode(){const t=super.attachDefaultNode();if(t){this.__updateNodeId(t)}return t}restoreDefaultNode(){}updateDefaultNode(t){this.__notifyChange(t)}observeNode(t){if(this.__nodeObserver){this.__nodeObserver.disconnect()}this.__nodeObserver=new MutationObserver((t=>{t.forEach((t=>{const e=t.target;const i=e===this.node;if(t.type==="attributes"){if(i){this.__updateNodeId(e)}}else if(i||e.parentElement===this.node){this.__notifyChange(this.node)}}))}));this.__nodeObserver.observe(t,{attributes:true,attributeFilter:["id"],childList:true,subtree:true,characterData:true})}__hasContent(t){if(!t){return false}return t.nodeType===Node.ELEMENT_NODE&&(customElements.get(t.localName)||t.children.length>0)||t.textContent&&t.textContent.trim()!==""}__notifyChange(t){this.dispatchEvent(new CustomEvent("slot-content-changed",{detail:{hasContent:this.__hasContent(t),node:t}}))}__updateNodeId(t){const e=!this.nodes||t===this.nodes[0];if(t.nodeType===Node.ELEMENT_NODE&&(!this.multiple||e)&&!t.id){t.id=this.defaultId}}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class BDt extends UDt{constructor(t){super(t,"error-message","div")}setErrorMessage(t){this.errorMessage=t;this.updateDefaultNode(this.node)}setInvalid(t){this.invalid=t;this.updateDefaultNode(this.node)}initAddedNode(t){if(t!==this.defaultNode){this.initCustomNode(t)}}initNode(t){this.updateDefaultNode(t)}initCustomNode(t){if(t.textContent&&!this.errorMessage){this.errorMessage=t.textContent.trim()}super.initCustomNode(t)}restoreDefaultNode(){this.attachDefaultNode()}updateDefaultNode(t){const{errorMessage:e,invalid:i}=this;const n=Boolean(i&&e&&e.trim()!=="");if(t){t.textContent=n?e:"";t.hidden=!n;if(n){t.setAttribute("role","alert")}else{t.removeAttribute("role")}}super.updateDefaultNode(t)}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class GDt extends UDt{constructor(t){super(t,"helper",null)}setHelperText(t){this.helperText=t;const e=this.getSlotChild();if(!e){this.restoreDefaultNode()}if(this.node===this.defaultNode){this.updateDefaultNode(this.node)}}restoreDefaultNode(){const{helperText:t}=this;if(t&&t.trim()!==""){this.tagName="div";const t=this.attachDefaultNode();this.observeNode(t)}}updateDefaultNode(t){if(t){t.textContent=this.helperText}super.updateDefaultNode(t)}initCustomNode(t){super.initCustomNode(t);this.observeNode(t)}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class VDt extends UDt{constructor(t){super(t,"label","label")}setLabel(t){this.label=t;const e=this.getSlotChild();if(!e){this.restoreDefaultNode()}if(this.node===this.defaultNode){this.updateDefaultNode(this.node)}}restoreDefaultNode(){const{label:t}=this;if(t&&t.trim()!==""){const t=this.attachDefaultNode();this.observeNode(t)}}updateDefaultNode(t){if(t){t.textContent=this.label}super.updateDefaultNode(t)}initCustomNode(t){super.initCustomNode(t);this.observeNode(t)}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const qDt=GOt((t=>class e extends(tPt(t)){static get properties(){return{label:{type:String,observer:"_labelChanged"}}}constructor(){super();this._labelController=new VDt(this);this._labelController.addEventListener("slot-content-changed",(t=>{this.toggleAttribute("has-label",t.detail.hasContent)}))}get _labelId(){const t=this._labelNode;return t&&t.id}get _labelNode(){return this._labelController.node}ready(){super.ready();this.addController(this._labelController)}_labelChanged(t){this._labelController.setLabel(t)}}));
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const HDt=GOt((t=>class e extends t{static get properties(){return{invalid:{type:Boolean,reflectToAttribute:true,notify:true,value:false},required:{type:Boolean,reflectToAttribute:true}}}validate(){const t=this.checkValidity();this._setInvalid(!t);this.dispatchEvent(new CustomEvent("validated",{detail:{valid:t}}));return t}checkValidity(){return!this.required||!!this.value}_setInvalid(t){if(this._shouldSetInvalid(t)){this.invalid=t}}_shouldSetInvalid(t){return true}}));
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const WDt=t=>class e extends(HDt(qDt(tPt(t)))){static get properties(){return{ariaTarget:{type:Object,observer:"_ariaTargetChanged"},errorMessage:{type:String,observer:"_errorMessageChanged"},helperText:{type:String,observer:"_helperTextChanged"},accessibleName:{type:String,observer:"_accessibleNameChanged"},accessibleNameRef:{type:String,observer:"_accessibleNameRefChanged"}}}static get observers(){return["_invalidChanged(invalid)","_requiredChanged(required)"]}constructor(){super();this._fieldAriaController=new xDt(this);this._helperController=new GDt(this);this._errorController=new BDt(this);this._errorController.addEventListener("slot-content-changed",(t=>{this.toggleAttribute("has-error-message",t.detail.hasContent)}));this._labelController.addEventListener("slot-content-changed",(t=>{const{hasContent:e,node:i}=t.detail;this.__labelChanged(e,i)}));this._helperController.addEventListener("slot-content-changed",(t=>{const{hasContent:e,node:i}=t.detail;this.toggleAttribute("has-helper",e);this.__helperChanged(e,i)}))}get _errorNode(){return this._errorController.node}get _helperNode(){return this._helperController.node}ready(){super.ready();this.addController(this._fieldAriaController);this.addController(this._helperController);this.addController(this._errorController)}__helperChanged(t,e){if(t){this._fieldAriaController.setHelperId(e.id)}else{this._fieldAriaController.setHelperId(null)}}_accessibleNameChanged(t){this._fieldAriaController.setAriaLabel(t)}_accessibleNameRefChanged(t){this._fieldAriaController.setLabelId(t,true)}__labelChanged(t,e){if(t){this._fieldAriaController.setLabelId(e.id)}else{this._fieldAriaController.setLabelId(null)}}_errorMessageChanged(t){this._errorController.setErrorMessage(t)}_helperTextChanged(t){this._helperController.setHelperText(t)}_ariaTargetChanged(t){if(t){this._fieldAriaController.setTarget(t)}}_requiredChanged(t){this._fieldAriaController.setRequired(t)}_invalidChanged(t){this._errorController.setInvalid(t);setTimeout((()=>{if(t){const t=this._errorNode;this._fieldAriaController.setErrorId(t&&t.id)}else{this._fieldAriaController.setErrorId(null)}}))}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class ZDt extends PPt{constructor(t,e,i={}){const{uniqueIdPrefix:n}=i;super(t,"input","input",{initializer:(t,i)=>{if(i.value){t.value=i.value}if(i.type){t.setAttribute("type",i.type)}t.id=this.defaultId;if(typeof e==="function"){e(t)}},useUniqueId:true,uniqueIdPrefix:n})}}
/**
 * @license
 * Copyright (c) 2021 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */class JDt{constructor(t,e){this.input=t;this.__preventDuplicateLabelClick=this.__preventDuplicateLabelClick.bind(this);e.addEventListener("slot-content-changed",(t=>{this.__initLabel(t.detail.node)}));this.__initLabel(e.node)}__initLabel(t){if(t){t.addEventListener("click",this.__preventDuplicateLabelClick);if(this.input){t.setAttribute("for",this.input.id)}}}__preventDuplicateLabelClick(){const t=e=>{e.stopImmediatePropagation();this.input.removeEventListener("click",t)};this.input.addEventListener("click",t)}}
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const YDt=t=>class e extends(WDt(zDt(mDt(fDt(t))))){static get properties(){return{indeterminate:{type:Boolean,notify:true,value:false,reflectToAttribute:true},name:{type:String,value:""},readonly:{type:Boolean,value:false,reflectToAttribute:true},tabindex:{type:Number,value:0,reflectToAttribute:true}}}static get observers(){return["__readonlyChanged(readonly, inputElement)"]}static get delegateProps(){return[...super.delegateProps,"indeterminate"]}static get delegateAttrs(){return[...super.delegateAttrs,"name","invalid","required"]}constructor(){super();this._setType("checkbox");this._boundOnInputClick=this._onInputClick.bind(this);this.value="on"}ready(){super.ready();this.addController(new ZDt(this,(t=>{this._setInputElement(t);this._setFocusElement(t);this.stateTarget=t;this.ariaTarget=t})));this.addController(new JDt(this.inputElement,this._labelController));this._createMethodObserver("_checkedChanged(checked)")}_shouldSetActive(t){if(this.readonly||t.target.localName==="a"||t.target===this._helperNode||t.target===this._errorNode){return false}return super._shouldSetActive(t)}_addInputListeners(t){super._addInputListeners(t);t.addEventListener("click",this._boundOnInputClick)}_removeInputListeners(t){super._removeInputListeners(t);t.removeEventListener("click",this._boundOnInputClick)}_onInputClick(t){if(this.readonly){t.preventDefault()}}__readonlyChanged(t,e){if(!e){return}if(t){e.setAttribute("aria-readonly","true")}else{e.removeAttribute("aria-readonly")}}_toggleChecked(t){if(this.indeterminate){this.indeterminate=false}super._toggleChecked(t)}checkValidity(){return!this.required||!!this.checked}_setFocused(t){super._setFocused(t);if(!t&&document.hasFocus()){this.validate()}}_checkedChanged(t){if(t||this.__oldChecked){this.validate()}this.__oldChecked=t}_requiredChanged(t){super._requiredChanged(t);if(t===false){this.validate()}}_onRequiredIndicatorClick(){this._labelNode.click()}}
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const KDt=UEt`
  :host {
    display: inline-block;
  }

  :host([hidden]) {
    display: none !important;
  }

  :host([disabled]) {
    -webkit-tap-highlight-color: transparent;
  }

  .vaadin-checkbox-container {
    display: grid;
    grid-template-columns: auto 1fr;
    align-items: baseline;
  }

  [part='checkbox'],
  ::slotted(input),
  [part='label'] {
    grid-row: 1;
  }

  [part='checkbox'],
  ::slotted(input) {
    grid-column: 1;
  }

  [part='helper-text'],
  [part='error-message'] {
    grid-column: 2;
  }

  :host(:not([has-helper])) [part='helper-text'],
  :host(:not([has-error-message])) [part='error-message'] {
    display: none;
  }

  [part='checkbox'] {
    width: var(--vaadin-checkbox-size, 1em);
    height: var(--vaadin-checkbox-size, 1em);
    --_input-border-width: var(--vaadin-input-field-border-width, 0);
    --_input-border-color: var(--vaadin-input-field-border-color, transparent);
    box-shadow: inset 0 0 0 var(--_input-border-width, 0) var(--_input-border-color);
  }

  [part='checkbox']::before {
    display: block;
    content: '\\202F';
    line-height: var(--vaadin-checkbox-size, 1em);
    contain: paint;
  }

  /* visually hidden */
  ::slotted(input) {
    opacity: 0;
    cursor: inherit;
    margin: 0;
    align-self: stretch;
    -webkit-appearance: none;
    width: initial;
    height: initial;
  }

  @media (forced-colors: active) {
    [part='checkbox'] {
      outline: 1px solid;
      outline-offset: -1px;
    }

    :host([disabled]) [part='checkbox'],
    :host([disabled]) [part='checkbox']::after {
      outline-color: GrayText;
    }

    :host(:is([checked], [indeterminate])) [part='checkbox']::after {
      outline: 1px solid;
      outline-offset: -1px;
      border-radius: inherit;
    }

    :host([focused]) [part='checkbox'],
    :host([focused]) [part='checkbox']::after {
      outline-width: 2px;
    }
  }
`
/**
 * @license
 * Copyright (c) 2017 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;rOt("vaadin-checkbox",KDt,{moduleId:"vaadin-checkbox-styles"});class QDt extends(YDt(pPt(cOt(hNt)))){static get is(){return"vaadin-checkbox"}static get template(){return uNt`
      <div class="vaadin-checkbox-container">
        <div part="checkbox" aria-hidden="true"></div>
        <slot name="input"></slot>
        <div part="label">
          <slot name="label"></slot>
          <div part="required-indicator" on-click="_onRequiredIndicatorClick"></div>
        </div>
        <div part="helper-text">
          <slot name="helper"></slot>
        </div>
        <div part="error-message">
          <slot name="error-message"></slot>
        </div>
      </div>
      <slot name="tooltip"></slot>
    `}ready(){super.ready();this._tooltipController=new FPt(this);this._tooltipController.setAriaTarget(this.inputElement);this.addController(this._tooltipController)}}REt(QDt);
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const XDt=t=>class e extends t{static get properties(){return{width:{type:String,value:"58px",sync:true},autoWidth:{type:Boolean,value:true},flexGrow:{type:Number,value:0,sync:true},selectAll:{type:Boolean,value:false,notify:true,sync:true},autoSelect:{type:Boolean,value:false,sync:true},dragSelect:{type:Boolean,value:false,sync:true},_indeterminate:{type:Boolean,sync:true},_selectAllHidden:Boolean}}static get observers(){return["_onHeaderRendererOrBindingChanged(_headerRenderer, _headerCell, path, header, selectAll, _indeterminate, _selectAllHidden)"]}_defaultHeaderRenderer(t,e){let i=t.firstElementChild;if(!i){i=document.createElement("vaadin-checkbox");i.setAttribute("aria-label","Select All");i.classList.add("vaadin-grid-select-all-checkbox");t.appendChild(i);i.addEventListener("checked-changed",this.__onSelectAllCheckedChanged.bind(this))}const n=this.__isChecked(this.selectAll,this._indeterminate);i.__rendererChecked=n;i.checked=n;i.hidden=this._selectAllHidden;i.indeterminate=this._indeterminate}_defaultRenderer(t,e,{item:i,selected:n}){let s=t.firstElementChild;if(!s){s=document.createElement("vaadin-checkbox");s.setAttribute("aria-label","Select Row");t.appendChild(s);s.addEventListener("checked-changed",this.__onSelectRowCheckedChanged.bind(this));RFt(t,"track",this.__onCellTrack.bind(this));t.addEventListener("mousedown",this.__onCellMouseDown.bind(this));t.addEventListener("click",this.__onCellClick.bind(this))}s.__item=i;s.__rendererChecked=n;s.checked=n}__onSelectAllCheckedChanged(t){if(t.target.checked===t.target.__rendererChecked){return}if(this._indeterminate||t.target.checked){this._selectAll()}else{this._deselectAll()}}__onSelectRowCheckedChanged(t){if(t.target.checked===t.target.__rendererChecked){return}if(t.target.checked){this._selectItem(t.target.__item)}else{this._deselectItem(t.target.__item)}}__onCellTrack(t){if(!this.dragSelect){return}this.__dragCurrentY=t.detail.y;this.__dragDy=t.detail.dy;if(t.detail.state==="start"){const e=this._grid._getRenderedRows();const i=e.find((e=>e.contains(t.currentTarget.assignedSlot)));this.__selectOnDrag=!this._grid._isSelected(i._item);this.__dragStartIndex=i.index;this.__dragStartItem=i._item;this.__dragAutoScroller()}else if(t.detail.state==="end"){if(this.__dragStartItem){if(this.__selectOnDrag){this._selectItem(this.__dragStartItem)}else{this._deselectItem(this.__dragStartItem)}}setTimeout((()=>{this.__dragStartIndex=undefined}))}}__onCellMouseDown(t){if(this.dragSelect){t.preventDefault()}}__onCellClick(t){if(this.__dragStartIndex!==undefined){t.preventDefault()}}_onCellKeyDown(t){const e=t.composedPath()[0];if(t.keyCode===32&&(e===this._headerCell||this._cells.includes(e)&&!this.autoSelect)){const t=e._content.firstElementChild;t.checked=!t.checked}}__dragAutoScroller(){if(this.__dragStartIndex===undefined){return}const t=this._grid._getRenderedRows();const e=t.find((t=>{const e=t.getBoundingClientRect();return this.__dragCurrentY>=e.top&&this.__dragCurrentY<=e.bottom}));let i=e?e.index:undefined;const n=this.__getScrollableArea();if(this.__dragCurrentY<n.top){i=this._grid._firstVisibleIndex}else if(this.__dragCurrentY>n.bottom){i=this._grid._lastVisibleIndex}if(i!==undefined){t.forEach((t=>{if(i>this.__dragStartIndex&&t.index>=this.__dragStartIndex&&t.index<=i||i<this.__dragStartIndex&&t.index<=this.__dragStartIndex&&t.index>=i){if(this.__selectOnDrag){this._selectItem(t._item)}else{this._deselectItem(t._item)}this.__dragStartItem=undefined}}))}const s=n.height*.15;const r=10;if(this.__dragDy<0&&this.__dragCurrentY<n.top+s){const t=n.top+s-this.__dragCurrentY;const e=Math.min(1,t/s);this._grid.$.table.scrollTop-=e*r}if(this.__dragDy>0&&this.__dragCurrentY>n.bottom-s){const t=this.__dragCurrentY-(n.bottom-s);const e=Math.min(1,t/s);this._grid.$.table.scrollTop+=e*r}setTimeout((()=>this.__dragAutoScroller()),10)}__getScrollableArea(){const t=this._grid.$.table.getBoundingClientRect();const e=this._grid.$.header.getBoundingClientRect();const i=this._grid.$.footer.getBoundingClientRect();return{top:t.top+e.height,bottom:t.bottom-i.height,left:t.left,right:t.right,height:t.height-e.height-i.height,width:t.width}}_selectAll(){}_deselectAll(){}_selectItem(t){}_deselectItem(t){}__isChecked(t,e){return e||t}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;const t$t=t=>class extends(XDt(t)){static get properties(){return{__previousActiveItem:Object}}static get observers(){return["__onSelectAllChanged(selectAll)"]}constructor(){super();this.__boundOnActiveItemChanged=this.__onActiveItemChanged.bind(this);this.__boundOnDataProviderChanged=this.__onDataProviderChanged.bind(this);this.__boundOnSelectedItemsChanged=this.__onSelectedItemsChanged.bind(this)}disconnectedCallback(){this._grid.removeEventListener("active-item-changed",this.__boundOnActiveItemChanged);this._grid.removeEventListener("data-provider-changed",this.__boundOnDataProviderChanged);this._grid.removeEventListener("filter-changed",this.__boundOnSelectedItemsChanged);this._grid.removeEventListener("selected-items-changed",this.__boundOnSelectedItemsChanged);super.disconnectedCallback()}connectedCallback(){super.connectedCallback();if(this._grid){this._grid.addEventListener("active-item-changed",this.__boundOnActiveItemChanged);this._grid.addEventListener("data-provider-changed",this.__boundOnDataProviderChanged);this._grid.addEventListener("filter-changed",this.__boundOnSelectedItemsChanged);this._grid.addEventListener("selected-items-changed",this.__boundOnSelectedItemsChanged)}}__onSelectAllChanged(t){if(t===undefined||!this._grid){return}if(!this.__selectAllInitialized){this.__selectAllInitialized=true;return}if(this._selectAllChangeLock){return}if(t&&this.__hasArrayDataProvider()){this.__withFilteredItemsArray((t=>{this._grid.selectedItems=t}))}else{this._grid.selectedItems=[]}}__arrayContains(t,e){return Array.isArray(t)&&Array.isArray(e)&&e.every((e=>t.includes(e)))}_selectAll(){this.selectAll=true}_deselectAll(){this.selectAll=false}_selectItem(t){this._grid.selectItem(t)}_deselectItem(t){this._grid.deselectItem(t)}__onActiveItemChanged(t){const e=t.detail.value;if(this.autoSelect){const t=e||this.__previousActiveItem;if(t){this._grid._toggleItem(t)}}this.__previousActiveItem=e}__hasArrayDataProvider(){return Array.isArray(this._grid.items)&&!!this._grid.dataProvider}__onSelectedItemsChanged(){this._selectAllChangeLock=true;if(this.__hasArrayDataProvider()){this.__withFilteredItemsArray((t=>{if(!this._grid.selectedItems.length){this.selectAll=false;this._indeterminate=false}else if(this.__arrayContains(this._grid.selectedItems,t)){this.selectAll=true;this._indeterminate=false}else{this.selectAll=false;this._indeterminate=true}}))}this._selectAllChangeLock=false}__onDataProviderChanged(){this._selectAllHidden=!Array.isArray(this._grid.items)}__withFilteredItemsArray(t){const e={page:0,pageSize:Infinity,sortOrders:[],filters:this._grid._mapFilters()};this._grid.dataProvider(e,(e=>t(e)))}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class e$t extends(t$t(XNt)){static get is(){return"vaadin-grid-selection-column"}}REt(e$t);rOt("vaadin-grid-sorter",UEt`
    :host {
      justify-content: flex-start;
      align-items: baseline;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
      cursor: var(--lumo-clickable-cursor);
    }

    [part='content'] {
      display: inline-block;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    [part='indicators'] {
      margin-left: var(--lumo-space-s);
    }

    [part='indicators']::before {
      transform: scale(0.8);
    }

    :host(:not([direction]):not(:hover)) [part='indicators'] {
      color: var(--lumo-tertiary-text-color);
    }

    :host([direction]) {
      color: var(--vaadin-selection-color-text, var(--lumo-primary-text-color));
    }

    [part='order'] {
      font-size: var(--lumo-font-size-xxs);
      line-height: 1;
    }

    /* RTL specific styles */

    :host([dir='rtl']) [part='indicators'] {
      margin-right: var(--lumo-space-s);
      margin-left: 0;
    }
  `,{moduleId:"lumo-grid-sorter"});
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */const i$t=document.createElement("template");i$t.innerHTML=`\n  <style>\n    @font-face {\n      font-family: 'vaadin-grid-sorter-icons';\n      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAQwAA0AAAAABuwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEFAAAABkAAAAcfep+mUdERUYAAAP4AAAAHAAAAB4AJwAOT1MvMgAAAZgAAAA/AAAAYA8TBPpjbWFwAAAB7AAAAFUAAAFeF1fZ4mdhc3AAAAPwAAAACAAAAAgAAAAQZ2x5ZgAAAlgAAABcAAAAnMvguMloZWFkAAABMAAAAC8AAAA2C5Ap72hoZWEAAAFgAAAAHQAAACQGbQPHaG10eAAAAdgAAAAUAAAAHAoAAABsb2NhAAACRAAAABIAAAASAIwAYG1heHAAAAGAAAAAFgAAACAACwAKbmFtZQAAArQAAAECAAACZxWCgKhwb3N0AAADuAAAADUAAABZCrApUXicY2BkYGAA4rDECVrx/DZfGbhZGEDgyqNPOxH0/wNMq5kPALkcDEwgUQBWRA0dAHicY2BkYGA+8P8AAwMLAwgwrWZgZEAFbABY4QM8AAAAeJxjYGRgYOAAQiYGEICQSAAAAi8AFgAAeJxjYGY6yziBgZWBgWkm0xkGBoZ+CM34msGYkZMBFTAKoAkwODAwvmRiPvD/AIMDMxCD1CDJKjAwAgBktQsXAHicY2GAAMZQCM0EwqshbAALxAEKeJxjYGBgZoBgGQZGBhCIAPIYwXwWBhsgzcXAwcAEhIwMCi+Z/v/9/x+sSuElA4T9/4k4K1gHFwMMMILMY2QDYmaoABOQYGJABUA7WBiGNwAAJd4NIQAAAAAAAAAACAAIABAAGAAmAEAATgAAeJyNjLENgDAMBP9tIURJwQCMQccSZgk2i5fIYBDAidJjycXr7x5EPwE2wY8si7jmyBNXGo/bNBerxJNrpxhbO3/fEFpx8ZICpV+ghxJ74fAMe+h7Ox14AbrsHB14nK2QQWrDMBRER4mTkhQK3ZRQKOgCNk7oGQqhhEIX2WSlWEI1BAlkJ5CDdNsj5Ey9Rncdi38ES+jzNJo/HwTgATcoDEthhY3wBHc4CE+pfwsX5F/hGe7Vo/AcK/UhvMSz+mGXKhZU6pww8ISz3oWn1BvhgnwTnuEJf8Jz1OpFeIlX9YULDLdFi4ASHolkSR0iuYdjLak1vAequBhj21D61Nqyi6l3qWybGPjySbPHGScGJl6dP58MYcQRI0bts7mjebBqrFENH7t3qWtj0OuqHnXcW7b0HOTZFnKryRGW2hFX1m0O2vEM3opNMfTau+CS6Z3Vx6veNnEXY6jwDxhsc2gAAHicY2BiwA84GBgYmRiYGJkZmBlZGFkZ2djScyoLMgzZS/MyDQwMwLSrpYEBlIbxjQDrzgsuAAAAAAEAAf//AA94nGNgZGBg4AFiMSBmYmAEQnYgZgHzGAAD6wA2eJxjYGBgZACCKyoz1cD0o087YTQATOcIewAAAA==) format('woff');\n      font-weight: normal;\n      font-style: normal;\n    }\n  </style>\n`;document.head.appendChild(i$t.content);rOt("vaadin-grid-sorter",UEt`
    :host {
      display: inline-flex;
      cursor: pointer;
      max-width: 100%;
    }

    [part='content'] {
      flex: 1 1 auto;
    }

    [part='indicators'] {
      position: relative;
      align-self: center;
      flex: none;
    }

    [part='order'] {
      display: inline;
      vertical-align: super;
    }

    [part='indicators']::before {
      font-family: 'vaadin-grid-sorter-icons';
      display: inline-block;
    }

    :host(:not([direction])) [part='indicators']::before {
      content: '\\e901';
    }

    :host([direction='asc']) [part='indicators']::before {
      content: '\\e900';
    }

    :host([direction='desc']) [part='indicators']::before {
      content: '\\e902';
    }
  `,{moduleId:"vaadin-grid-sorter-styles"});const n$t=t=>class e extends t{static get properties(){return{path:String,direction:{type:String,reflectToAttribute:true,notify:true,value:null,sync:true},_order:{type:Number,value:null,sync:true}}}static get observers(){return["_pathOrDirectionChanged(path, direction)"]}ready(){super.ready();this.addEventListener("click",this._onClick.bind(this))}connectedCallback(){super.connectedCallback();if(this._grid){this._grid.__applySorters()}else{this.__dispatchSorterChangedEvenIfPossible()}}disconnectedCallback(){super.disconnectedCallback();if(!this.parentNode&&this._grid){this._grid.__removeSorters([this])}else if(this._grid){this._grid.__applySorters()}}_pathOrDirectionChanged(){this.__dispatchSorterChangedEvenIfPossible()}__dispatchSorterChangedEvenIfPossible(){if(this.path===undefined||this.direction===undefined||!this.isConnected){return}this.dispatchEvent(new CustomEvent("sorter-changed",{detail:{shiftClick:Boolean(this._shiftClick),fromSorterClick:Boolean(this._fromSorterClick)},bubbles:true,composed:true}));this._fromSorterClick=false;this._shiftClick=false}_getDisplayOrder(t){return t===null?"":t+1}_onClick(t){if(t.defaultPrevented){return}const e=this.getRootNode().activeElement;if(this!==e&&this.contains(e)){return}t.preventDefault();this._shiftClick=t.shiftKey;this._fromSorterClick=true;if(this.direction==="asc"){this.direction="desc"}else if(this.direction==="desc"){this.direction=null}else{this.direction="asc"}}}
/**
 * @license
 * Copyright (c) 2016 - 2024 Vaadin Ltd.
 * This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
 */;class s$t extends(n$t(cOt(jNt(hNt)))){static get template(){return uNt`
      <div part="content">
        <slot></slot>
      </div>
      <div part="indicators">
        <span part="order">[[_getDisplayOrder(_order)]]</span>
      </div>
    `}static get is(){return"vaadin-grid-sorter"}}REt(s$t);let r$t=class extends Tm.EventedAccessor{constructor(t){super(t),this.cellPartNameGenerator=(t,e)=>{let i="";e?.item&&this.rowHighlightIds.includes(e.item.objectId)&&(i+=" highlight");const n=this.findColumn(t?.path);return n?(n.invalid&&(i+=" invalid"),n.textWrap&&(i+=" text-wrap"),"editInfo"in n&&n.editInfo&&n.editInfo.rowData?.index===e.index&&(i+=" editing"),i):i},this.columnPerformanceModeEnabled=!0,this.columnReorderingEnabled=!0,this.columns=new Vm,this.dataProvider=async(t,e)=>{const{store:i}=this;if(!e)return;if(!i)return void(e&&e([]));e(await i.fetchItems(t))},this.maxSize=null,this.multipleSelectionEnabled=!0,this.multiSortEnabled=!1,this.paginationEnabled=!1,this.rowDetailsRenderer=null,this.store=null}get actionColumn(){return this.allColumns.find((t=>t.fieldName===ykt.action))}get allColumns(){return this.columns.toArray().flatMap((t=>[t,...fkt(t)&&t.columns?.length?t.columns:[]]))}get columnMenuIsOpen(){return this.allColumns.some((t=>t.menuIsOpen))}get editing(){return this.editableColumns.some((t=>t.editInfo))}get editableColumns(){return this.allColumns.filter((t=>"editable"in t))}get effectiveSize(){const{filterBySelectionEnabled:t,highlightIds:e,objectIds:i,pageSize:n,size:s}=this;if(this.paginationEnabled){const r=this.pageCount===this.pageIndex+1?s%n:n;return t?Math.min(e.length,r):i.length?Math.min(i.length,r):r}return t?e.length:i.length?i.length:s}get fieldColumns(){return this.allColumns.filter((t=>dkt(t)))}get filterBySelectionEnabled(){return!!this._get("filterBySelectionEnabled")}set filterBySelectionEnabled(t){this._set("filterBySelectionEnabled",t)}get groupColumns(){return this.columns.toArray().filter((t=>fkt(t)))}get highlightIds(){return this._get("highlightIds")||new Vm}set highlightIds(t){const e=Array.isArray(t)?new Vm(t):t;this.multipleSelectionEnabled||e.splice(1,e.length-1),this._set("highlightIds",AM(e,this._get("highlightIds"),Vm))}get objectIds(){return this._get("objectIds")??new Vm}set objectIds(t){this._set("objectIds",AM(t,this._get("objectIds"),Vm))}get pageCount(){const{pageSize:t,size:e}=this;return 0===e||0===t?1:Math.ceil(e/t)}get pageIndex(){return this._get("pageIndex")||0}set pageIndex(t){const{pageCount:e}=this;Ikt(t,e)&&this._set("pageIndex",t)}get pageSize(){return this._get("pageSize")??50}set pageSize(t){this.store?.set("pageSize",t),this._set("pageSize",t)}get relationshipColumns(){return this.allColumns.filter((t=>pkt(t)))}get rowHighlightIds(){return this._get("rowHighlightIds")||new Vm}set rowHighlightIds(t){this._set("rowHighlightIds",AM(t,this._get("rowHighlightIds"),Vm))}get size(){const t=this.store?.count??0,{maxSize:e}=this;return null!=t&&null!=e?Math.min(e,t):t}get state(){return this.store?.state??"disabled"}closeColumnMenus(){this.allColumns.forEach((t=>t.closeMenu()))}sortColumn(t,e){if(!t)return;const i=this.findColumn(t);i&&(i.direction=e)}hideColumn(t){const e=this.findColumn(t);!1===e?.hidden&&(e.hidden=!0)}showColumn(t){const e=this.findColumn(t);e?.hidden&&(e.hidden=!1)}showAllColumns(){this.allColumns.forEach((t=>{t.hidden&&(t.hidden=!1)}))}findColumn(t){return this.allColumns.find((e=>e.fieldName===t))}refresh(){this.store&&(this.store.reset(),this.store.load())}toggleColumnVisibility(t){const e=this.findColumn(t);e&&(e.hidden=!e.hidden)}};r([Je()],r$t.prototype,"actionColumn",null),r([Je()],r$t.prototype,"allColumns",null),r([Je()],r$t.prototype,"cellPartNameGenerator",void 0),r([Je()],r$t.prototype,"columnMenuIsOpen",null),r([Je()],r$t.prototype,"columnPerformanceModeEnabled",void 0),r([Je()],r$t.prototype,"columnReorderingEnabled",void 0),r([Je()],r$t.prototype,"columns",void 0),r([Je()],r$t.prototype,"dataProvider",void 0),r([Je()],r$t.prototype,"editing",null),r([Je()],r$t.prototype,"editableColumns",null),r([Je()],r$t.prototype,"effectiveSize",null),r([Je()],r$t.prototype,"fieldColumns",null),r([Je()],r$t.prototype,"filterBySelectionEnabled",null),r([Je()],r$t.prototype,"groupColumns",null),r([Je()],r$t.prototype,"highlightIds",null),r([Je()],r$t.prototype,"maxSize",void 0),r([Je()],r$t.prototype,"multipleSelectionEnabled",void 0),r([Je()],r$t.prototype,"multiSortEnabled",void 0),r([Je()],r$t.prototype,"objectIds",null),r([Je()],r$t.prototype,"pageCount",null),r([Je()],r$t.prototype,"pageIndex",null),r([Je()],r$t.prototype,"pageSize",null),r([Je()],r$t.prototype,"paginationEnabled",void 0),r([Je()],r$t.prototype,"relationshipColumns",null),r([Je()],r$t.prototype,"rowHighlightIds",null),r([Je()],r$t.prototype,"rowDetailsRenderer",void 0),r([Je({readOnly:!0})],r$t.prototype,"size",null),r([Je()],r$t.prototype,"store",void 0),r([Je({readOnly:!0})],r$t.prototype,"state",null),r$t=r([ln("esri.widgets.FeatureTable.Grid.GridViewModel")],r$t);const o$t=r$t;const a$t="esri-grid",l$t="compact column-borders",u$t={base:a$t,content:`${a$t}__content`,grid:`${a$t}__grid`},c$t={sort:["Enter"," "]};let h$t=class extends A3{constructor(t,e){super(t,e),this._columnElements=[],this._grid=null,this.itemIdPath=null,this.messages=null,this.selectionColumnEnabled=!0,this.viewModel=new o$t,this._onSelectedItemsChange=this._onSelectedItemsChange.bind(this)}initialize(){this.addHandles([this.columns.on("before-changes",(()=>this.renderNow())),this.columns.on("change",(()=>this.onColumnChange())),sy((()=>this.highlightIds),"before-add",(({target:t})=>{!this.multipleSelectionEnabled&&t.length&&t.removeAll()})),this.rowHighlightIds.on("change",(()=>this.generateCellPartNames())),ey((()=>this.effectiveSize),(()=>this._updateGridSize())),ey((()=>this.viewModel.editing),(()=>{this.generateCellPartNames(),this.requestContentUpdate()})),ey((()=>this.store?.state),((t,e)=>{"ready"!==t||"loaded"!==e&&"error"!==e||this.refreshPageCache()})),sy((()=>this._table),"scroll",(()=>this.viewModel.closeColumnMenus())),sy((()=>this._table),"scrollend",(()=>{this.paginationEnabled||(this.pageIndex=this.getVirtualPageIndex())})),ey((()=>this.multipleSelectionEnabled),(t=>{!t&&this.highlightIds.length>1&&this.highlightIds.removeAll()}))])}destroy(){this.resetColumns(),this.columns.destroyed||this.columns.destroy()}resetColumns(){this.columns.drain((t=>!t.destroyed&&t.destroy()))}get _editInfos(){return this.viewModel.editableColumns.map((t=>t.editInfo)).filter(C)}get _columnRendering(){return this.columnPerformanceModeEnabled?"lazy":"eager"}get _selectedItems(){const{highlightIds:t,store:e}=this;return t.toArray().map((t=>e?.getItemByObjectId(t)??{objectId:t}))}get _table(){return this._grid?.$?.table}get cellPartNameGenerator(){return this.viewModel.cellPartNameGenerator}set cellPartNameGenerator(t){this.viewModel.cellPartNameGenerator=t}get columns(){return this.viewModel.columns}set columns(t){this.viewModel.columns=t}get columnPerformanceModeEnabled(){return this.viewModel.columnPerformanceModeEnabled}set columnPerformanceModeEnabled(t){this.viewModel.columnPerformanceModeEnabled=t}get columnReorderingEnabled(){return this.viewModel.columnReorderingEnabled}set columnReorderingEnabled(t){this.viewModel.columnReorderingEnabled=t}get pageIndex(){return this.viewModel.pageIndex}set pageIndex(t){this.viewModel.pageIndex=t}get dataProvider(){return this.viewModel.dataProvider}set dataProvider(t){this.viewModel.dataProvider=t}get effectiveSize(){return this.viewModel.effectiveSize}get highlightIds(){return this.viewModel.highlightIds}set highlightIds(t){this.viewModel.highlightIds=t}get isEditingActive(){return!!this._editInfos.length}get isReady(){return!!this._grid}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get multipleSelectionEnabled(){return this.viewModel.multipleSelectionEnabled}set multipleSelectionEnabled(t){this.viewModel.multipleSelectionEnabled=t}get multiSortEnabled(){return this.viewModel.multiSortEnabled}set multiSortEnabled(t){this.viewModel.multiSortEnabled=t}get pageSize(){return this.viewModel.pageSize}set pageSize(t){this.viewModel.pageSize=t}get paginationEnabled(){return this.viewModel.paginationEnabled}set paginationEnabled(t){this.viewModel.paginationEnabled=t}get rowDetailsRenderer(){return this.viewModel.rowDetailsRenderer}set rowDetailsRenderer(t){this.viewModel.rowDetailsRenderer=t}get rowHighlightIds(){return this.viewModel.rowHighlightIds}set rowHighlightIds(t){this.viewModel.rowHighlightIds=t}get size(){return this.viewModel.size}get sortOrders(){return this._grid?._sorters?this._grid._sorters.filter((t=>!!t&&t.path)).map((({direction:t,path:e})=>({direction:t,path:e}))):[]}get store(){return this.viewModel.store}set store(t){this.viewModel.store=t}addSorter(t){this._grid?.__updateSorter(t,!1,!1),this.notifyChange("sortOrders")}getColumnProps(t,e){const{id:i}=this,{autoWidth:n,direction:s,fieldName:r,flexGrow:o,frozen:a,frozenToEnd:l,hidden:u,label:c,resizable:h,textAlign:d,width:f}=t,p=`${i}_${r}_${e}`,{renderFunction:m,footerRenderFunction:y,headerRenderFunction:g}=t,v=y?(t,e)=>y({root:t,column:e}):void 0,w=g?(t,e)=>g({root:t,column:e}):void 0,b=m?(t,e,i)=>m({root:t,column:e,rowData:i}):void 0;let S="";return t.direction&&(S+=" direction"),t.invalid&&(S+=" invalid"),{footerRenderer:v,headerRenderer:w,renderer:b,autoWidth:n,direction:s,flexGrow:o,frozen:a,frozenToEnd:l,headerPartName:S,hidden:u,key:p,resizable:h,bind:this,"data-fieldName":r,header:c,path:r,"text-align":d,width:"number"==typeof f?`${f}px`:f,afterCreate:this._afterColumnCreate,afterRemoved:this._afterColumnRemoved}}clearSelection(){this._clearSelection(),this.scheduleRender()}clearSort(){let t=!1;if(this._grid){if(this._grid._sorters?.length&&(this._grid._sorters.forEach((t=>{t._order=null,t.direction=null})),t=!0),this.columns.length){this.columns.some((t=>!!t.direction))&&(this.columns.forEach((t=>t.direction=null)),t=!0)}t&&(this.notifyChange("sortOrders"),this.scheduleRender())}}findColumn(t){return this.viewModel.findColumn(t)}generateCellPartNames(){this._grid?.generateCellPartNames()}getFirstVisibleRowIndex(){return this._grid?._firstVisibleIndex||0}getVirtualPageIndex(){return Math.floor(this.getFirstVisibleRowIndex()/this.pageSize)}getLastVisibleRowIndex(){return this._grid?._lastVisibleIndex||0}getVisibleItemsCount(){return this._grid?._visibleItemsCount||0}getRowContainingNode(t){try{return this._grid?._getRowContainingNode(t)}catch{return null}}getSlotElementByName(t){return this._grid?.shadowRoot?.querySelector(`slot[name='${t}']`)??null}hasSorter(t){return this._grid?._sorters?.includes(t)||!1}hideColumn(t){this.viewModel.hideColumn(t)}recalculateColumnWidths(){this._grid?.recalculateColumnWidths()}async reset(){this._clearSelection(),await(this.store?.reset()),this.scrollToTop()}refreshPageCache(){this._grid?.clearCache()}requestContentUpdate(){this._grid?.requestContentUpdate()}selectRows(t){const{itemIdPath:e}=this,i=t?.filter((t=>!this.highlightIds.includes(t[e]))),n=i.map((t=>t[e]));n.length&&(this.multipleSelectionEnabled||(this.highlightIds.removeAll(),n.splice(1)),this.highlightIds.addMany(n))}deselectRows(t){const{itemIdPath:e}=this,i=t?.map((t=>t[e]))||[];i.length&&this.highlightIds.removeMany(i)}showColumn(t){this.viewModel.showColumn(t)}sort({path:t,direction:e}){this.viewModel.sortColumn(t,e),this.notifyChange("sortOrders")}scrollToIndex(t){this._grid?.isConnected&&this._grid?.scrollToIndex(t)}scrollToTop(){this.scrollToIndex(0)}scrollToBottom(){this.scrollToIndex(1/0)}scrollLeft(t){const{_table:e}=this;e&&(e.scrollLeft=t)}toggleColumnVisibility(t){this.viewModel.toggleColumnVisibility(t)}onColumnChange(){this._columnElements.forEach((t=>{this._applyRenderersToColumnElement(t)})),this.requestContentUpdate()}render(){return V3("div",{bind:this,class:this.classes(u$t.base,P3.widget)},V3("div",{bind:this,class:u$t.content},this._renderGrid()))}_renderGrid(){return V3("vaadin-grid",{afterCreate:this._afterGridCreate,afterUpdate:this._afterGridUpdate,bind:this,cellPartNameGenerator:this.cellPartNameGenerator,class:u$t.grid,columnRendering:this._columnRendering,columnReorderingAllowed:this.columnReorderingEnabled,dataProvider:this.dataProvider,id:`${this.id}_grid`,itemIdPath:this.itemIdPath,multiSort:this.multiSortEnabled,pageSize:this.pageSize,ref:"grid",rowDetailsRenderer:this.rowDetailsRenderer,selectedItems:this._selectedItems,size:this.effectiveSize},this._renderAllColumns())}_renderAllColumns(){return"disabled"!==this.viewModel.state&&this.columns.length?[this._renderSelectionColumn(),this._renderColumns()]:null}_renderSelectionColumn(){return V3("vaadin-grid-selection-column",{_selectAllHidden:!0,autoWidth:!1,bind:this,dragSelect:!0,frozen:!0,hidden:!this.selectionColumnEnabled,selectAll:!1,sortable:!1,textAlign:"center"})}_renderColumns(){return Array.from(this.columns,((t,e)=>"columns"in t?this._renderGroupColumn(t,e):V3("vaadin-grid-column",{...this.getColumnProps(t,e)}))).filter(C)}_renderGroupColumn(t,e){const i=this.getColumnProps(t,e);if(i.hidden||!t.columns)return null;const n=t.columns.filter((({hidden:t})=>!t));return n.length?V3("vaadin-grid-column-group",{...i},n.map((t=>V3("vaadin-grid-column",{...this.getColumnProps(t,e)})))):null}_afterGridCreate(t){const e=this._grid=t;e.setAttribute("theme",l$t),customElements.whenDefined("vaadin-grid").then((()=>{this._appendStyles(),this._addGridEventListeners()})),e.__updateSorter=(t,i,n)=>{const s=e._sorters,r=!s.includes(t);if(!t.direction&&r)return;t._order=null;const{multiSort:o,multiSortOnShiftClick:a,multiSortPriority:l}=e,u=s.filter((e=>e!==t));o&&(!a||!n)||a&&i?null!=t._initialOrder?(r?s[t._initialOrder]=t:s.splice(t._initialOrder,0,t),t._initialOrder=null):e._sorters="append"===l?[...u,t]:[t,...u]:(t.direction||a)&&(e._sorters=t.direction?[t]:[],u.forEach((t=>{t._order=null,t.direction=null})))},e.__removeSorters=t=>{if(0===t.length)return;const i=new Set(t.filter((t=>!t.direction)));e._sorters=e._sorters.filter((t=>!i.has(t))),e.__applySorters()}}_appendStyles(){const t=this._grid?.shadowRoot,e=document.createElement("style");t&&(e.textContent='\n      #items [part~="row"][editing],\n      #items [part~="row"][editing][selected] {\n        z-index: 2;\n      }\n\n      #items [part~="editing"],\n      #items [part~="editing"][selected] {\n        z-index: 3;\n      }\n\n      [frozen], [frozen-to-end] {\n        z-index: 4;\n      }\n\n      [last-frozen] {\n        overflow: visible;\n      }\n\n      [part~=\'cell\'] ::slotted(vaadin-grid-cell-content) {\n        align-items: center;\n        box-sizing: border-box !important;\n        height: 100%;\n        line-height: 2em;\n        min-height: 40px;\n      }\n\n      #items [part~="text-wrap"] {\n        text-wrap: wrap;\n      }\n    ',t.appendChild(e))}_afterGridUpdate(t){this._grid||(this._grid=t)}_afterColumnCreate(t){this._columnElements.push(t)}_afterColumnRemoved(t){const e=this._columnElements.indexOf(t,0);e>-1&&this._columnElements.splice(e,1)}_updateGridSize(){this._grid&&(this._grid.size=this.effectiveSize,this.scheduleRender())}_addGridEventListeners(){const t=this._grid;Tn(t),this.addHandles([vs(t,["click","dblclick","keydown","pointerover","pointerout"],(t=>this._onGridInteraction(t))),vs(t,"selected-items-changed",this._onSelectedItemsChange),vs(t,"sorter-changed",(()=>this.notifyChange("sortOrders"))),vs(t,"column-resize",(t=>{const e=t.detail.resizedColumn,i=e.getAttribute("data-fieldName"),n=this.findColumn(i);n?.set({width:e.width})})),vs(t,"column-reorder",(()=>this._onColumnOrderChange()))])}_onGridInteraction(t){const e=this._grid;if(Tn(e),("pointerover"===t.type||"pointerout"===t.type)&&t.relatedTarget!==e){const{target:e,relatedTarget:i}=t;if(!this._isGridCellContentNode(e)||!this._isGridCellContentNode(i))return}let i=null;try{i=e.getEventContext(t)}catch(t){}if(!i)return;const{column:n,index:s,item:r,section:o}=i;if(!o)return;if("header"===o&&"keydown"===t.type&&n?.path){const e=t.key;c$t.sort.includes(e)&&this.findColumn(n.path)?.sort()}const a=`cell-${t.type}`;this.emit(a,{type:a,context:i,index:s,item:r,native:t,path:n?.path??void 0})}_isGridCellContentNode(t){return!!(t&&t instanceof HTMLElement&&"vaadin-grid-cell-content"===t.localName)}_onColumnOrderChange(){const t=this._grid;Tn(t);const e=t._getColumnsInOrder(0),i=[],n=(this.viewModel.groupColumns.length?t._getColumnsInOrder(1):e).map((t=>t.getAttribute("data-fieldName")));e?.forEach((t=>{const e=t.getAttribute("data-fieldName");if(null!=e){const t=this.findColumn(e);i.push(e),t&&"columns"in t&&t.columns?.length&&t.columns.sort(((t,e)=>n.indexOf(t.fieldName)>n.indexOf(e.fieldName)?1:-1))}})),this.columns.sort(((t,e)=>i.indexOf(t.fieldName)>i.indexOf(e.fieldName)?1:-1)),this.notifyChange("sortOrders"),this.emit("column-reorder",{type:"column-reorder"})}_clearSelection(){this.highlightIds.removeAll()}_onSelectedItemsChange(t){const{highlightIds:e,itemIdPath:i}=this,n=t.detail.value.map((t=>t[i])),s=n.filter((t=>!e.includes(t)));if(!this.multipleSelectionEnabled&&s.length&&e.length)e.removeAll(),e.add(s[0]);else{const t=e.filter((t=>!n.includes(t)));e.removeMany(t),e.addMany(s)}}_applyRenderersToColumnElement(t){const e=t?.path,i=null!=e?this.findColumn(e):void 0;if(i)try{const{renderFunction:e,footerRenderFunction:n,headerRenderFunction:s}=i;e&&"renderer"in t&&(t.renderer=(t,i,n)=>e({root:t,column:i,rowData:n})),n&&(t.footerRenderer=(t,e)=>n({root:t,column:e})),s&&(t.headerRenderer=(t,e)=>s({root:t,column:e}))}catch(t){}}};r([Je()],h$t.prototype,"_editInfos",null),r([Je()],h$t.prototype,"_columnElements",void 0),r([Je()],h$t.prototype,"_columnRendering",null),r([Je()],h$t.prototype,"_selectedItems",null),r([Je()],h$t.prototype,"_grid",void 0),r([Je()],h$t.prototype,"_table",null),r([Je()],h$t.prototype,"cellPartNameGenerator",null),r([Je()],h$t.prototype,"columns",null),r([Je()],h$t.prototype,"columnPerformanceModeEnabled",null),r([Je()],h$t.prototype,"columnReorderingEnabled",null),r([Je()],h$t.prototype,"pageIndex",null),r([Je()],h$t.prototype,"dataProvider",null),r([Je()],h$t.prototype,"effectiveSize",null),r([Je()],h$t.prototype,"highlightIds",null),r([Je()],h$t.prototype,"isEditingActive",null),r([Je()],h$t.prototype,"isReady",null),r([Je()],h$t.prototype,"itemIdPath",void 0),r([Je()],h$t.prototype,"label",null),r([Je(),z3("esri/widgets/FeatureTable/t9n/FeatureTable")],h$t.prototype,"messages",void 0),r([Je()],h$t.prototype,"multipleSelectionEnabled",null),r([Je()],h$t.prototype,"multiSortEnabled",null),r([Je()],h$t.prototype,"pageSize",null),r([Je()],h$t.prototype,"paginationEnabled",null),r([Je()],h$t.prototype,"rowDetailsRenderer",null),r([Je()],h$t.prototype,"rowHighlightIds",null),r([Je()],h$t.prototype,"selectionColumnEnabled",void 0),r([Je()],h$t.prototype,"size",null),r([Je({readOnly:!0})],h$t.prototype,"sortOrders",null),r([Je()],h$t.prototype,"store",null),r([Je()],h$t.prototype,"viewModel",void 0),h$t=r([ln("esri.widgets.FeatureTable.Grid.Grid")],h$t);const d$t=h$t;let f$t=class extends Pkt{constructor(t){super(t),this.columns=null,this.sortable=!1}initialize(){this._set("fieldName",`group:${this.label}`)}destroy(){this.columns?.forEach((t=>!t.destroyed&&t.destroy()))}};r([Je()],f$t.prototype,"columns",void 0),r([Je({readOnly:!0})],f$t.prototype,"sortable",void 0),f$t=r([ln("esri.widgets.FeatureTable.Grid.GroupColumn")],f$t);const p$t=f$t;let m$t=class extends Io{constructor(t){super(t),this.autoWidth=!1,this.description=null,this.direction=null,this.flexGrow=1,this.fieldName=null,this.formatFunction=null,this.frozen=!1,this.frozenToEnd=!1,this.icon=null,this.initialSortPriority=null,this.invalid=!1,this.label=null,this.menuConfig=null,this.resizable=!0,this.sortable=!1,this.textAlign="start",this.textWrap=!1,this.timeZone=null,this.type=null,this.visible=!0,this.width=200}};r([Je()],m$t.prototype,"autoWidth",void 0),r([Je()],m$t.prototype,"description",void 0),r([Je()],m$t.prototype,"direction",void 0),r([Je()],m$t.prototype,"flexGrow",void 0),r([Je({type:String})],m$t.prototype,"fieldName",void 0),r([Je()],m$t.prototype,"formatFunction",void 0),r([Je()],m$t.prototype,"frozen",void 0),r([Je()],m$t.prototype,"frozenToEnd",void 0),r([Je()],m$t.prototype,"icon",void 0),r([Je()],m$t.prototype,"initialSortPriority",void 0),r([Je()],m$t.prototype,"invalid",void 0),r([Je()],m$t.prototype,"label",void 0),r([Je()],m$t.prototype,"menuConfig",void 0),r([Je()],m$t.prototype,"resizable",void 0),r([Je()],m$t.prototype,"sortable",void 0),r([Je()],m$t.prototype,"textAlign",void 0),r([Je()],m$t.prototype,"textWrap",void 0),r([Je()],m$t.prototype,"timeZone",void 0),r([Je({type:String,json:{read:!1,write:!0}})],m$t.prototype,"type",void 0),r([Je()],m$t.prototype,"visible",void 0),r([Je()],m$t.prototype,"width",void 0),m$t=r([ln("esri.widgets.FeatureTable.support.ColumnTemplateBase")],m$t);const y$t=m$t;let g$t=class extends y$t{constructor(t){super(t),this.attachmentsViewEnabled=!0,this.icon="attachment",this.sortable=!1,this.textAlign="center",this.thumbnailAppearance="image",this.thumbnailCount=8,this.thumbnailsEnabled=!0,this.thumbnailIconScale="m",this.type="attachment"}};r([Je()],g$t.prototype,"attachmentsViewEnabled",void 0),r([Je()],g$t.prototype,"icon",void 0),r([Je()],g$t.prototype,"sortable",void 0),r([Je()],g$t.prototype,"textAlign",void 0),r([Je()],g$t.prototype,"thumbnailAppearance",void 0),r([Je()],g$t.prototype,"thumbnailCount",void 0),r([Je()],g$t.prototype,"thumbnailsEnabled",void 0),r([Je()],g$t.prototype,"thumbnailIconScale",void 0),r([Je({type:String,json:{read:!1,write:!0}})],g$t.prototype,"type",void 0),g$t=r([ln("esri.widgets.FeatureTable.support.AttachmentsColumnTemplate")],g$t);const v$t=g$t;let w$t=class extends ao{constructor(t){super(t),this.attachmentId=null,this.attachmentInfos=[],this.candidates=null,this.error=null,this.form=null,this.mode="list",this.objectId=null}initialize(){this.addHandles([ey((()=>this.objectId),(()=>this.reset())),ey((()=>this.candidates),(()=>{this.error=null})),ey((()=>this.attachmentInfos.length),(t=>{0===t&&(this.mode="file")}))])}onEditComplete(){this.attachmentId=null,this.candidates=null,this.mode="list"}reset(){this.attachmentId=null,this.candidates=null,this.error=null}};r([Je()],w$t.prototype,"attachmentId",void 0),r([Je()],w$t.prototype,"attachmentInfos",void 0),r([Je()],w$t.prototype,"candidates",void 0),r([Je()],w$t.prototype,"error",void 0),r([Je()],w$t.prototype,"form",void 0),r([Je()],w$t.prototype,"mode",void 0),r([Je()],w$t.prototype,"objectId",void 0),w$t=r([ln("esri.widgets.FeatureTable.support.AttachmentsViewOptions")],w$t);const b$t=w$t;function S$t(t){return Object.keys(t.attributes).map((e=>{const i=t.attributes[e];return"objectid"===e.toLowerCase()||"fid"===e.toLowerCase()?new h$({name:e,alias:e,type:"oid"}):new h$("number"==typeof i?{name:e,alias:e,type:"double"}:{name:e,alias:e,type:"string"})}))}function _$t(t){if(!t.fields){const e=t.features[0];if(e.layer){t.fields=e.layer.fields;const i=Object.keys(e.attributes),n=t.fields.filter((t=>i.includes(t.name)));t.fields=n}else t.fields=S$t(e)}return t}function x$t(t){return t.map((({attributes:t})=>t))}function M$t(t){const{delimiter:e,fields:i=[],outFields:n=[]}=t,s=e||",",r=i.map((t=>t.name));return t=>{let e="";return r.filter((t=>n.includes(t))).forEach((n=>{const r=i.find((({name:t})=>t===n));let o=t[n]||"";if("date"===r?.type&&(o=new Date(o).toString()),r?.domain&&"coded-value"===r.domain.type){const t=r.domain.codedValues.find((t=>o===t.code));t&&(o=t.name)}"string"==typeof o&&o.includes(s)&&(o=`"${o}"`),e+=`${o}${s}`})),`${e}\r\n`}}async function T$t(t,{includeGeometry:e=!0,delimiter:i=",",outFields:n=["*"]}={}){t=_$t(t),e&&"point"!==t.geometryType&&jt.getLogger("esri.exports.csv").warn(`The input geometry ${t.geometryType} is not supported. Geometry will be excluded from export.`);const{features:s}=t;if(!s.length)return null;let r=t.fields;const[o]=n;"*"===o&&(n=r.map((t=>t.name))),e&&"point"===t.geometryType&&(r.some((t=>"x"===t.name||"y"===t.name))||(r=[...r,new h$({name:"lon",alias:"Longitude",type:"double"}),new h$({name:"lat",alias:"Latitude",type:"double"})],n=[...n,"lon","lat"]),s.forEach((({attributes:t,geometry:e})=>{t.lon="point"===e?.type?e.longitude:null,t.lat="point"===e?.type?e.latitude:null}))),r=r.filter((t=>n.includes(t.name)));const a=i||",",l=x$t(s),u=r.map((t=>t.name)).join(a),c=M$t({delimiter:a,outFields:n||r.map((t=>t.name)),fields:r});let h=`${u}${a}\r\n`;l.forEach((t=>{h+=c(t)}));const d=new RegExp(`${a}\r\n\\s*$`,"g");return h.replace(d,"")}function A$t(){return"showSaveFilePicker"in window&&(()=>{try{return window.self===window.top}catch{return!1}})()}async function I$t(t){const{layer:e,includeGeometry:i,objectIds:n,outFields:s}=t,r=s??e.outFields??["*"],o=e.createQuery();o.objectIds=n,o.outFields=r;const a=await e.queryFeatures(o),l=await T$t(a,{includeGeometry:!e.isTable&&(i||"point"===a.geometryType),outFields:r});if(!l)throw new Ve("export-csv:no-output","Unable to generate a valid export string");const u=new Blob([l],{type:"text/csv"}),c=ux.sanitize(e.title);if(A$t())try{const t=await showSaveFilePicker({suggestedName:c,types:[{accept:{"text/csv":[".csv"]}}]}),e=await t.createWritable();await e.write(u),await e.close()}catch(t){if(t instanceof Ve&&"AbortError"!==t.name)throw t}else Ba(u,`${c}.csv`)}async function k$t(t){if(!t?.url)return;const e=await za(`${t.url}/${t.name}`);Ba(e,t.name)}let C$t=class extends ao{constructor(t){super(t),this._attachmentsOperationQueue=new Vm,this._defaultOutFields=["*"],this._editOperationQueue=new Vm,this._loaded=!1,this._loadError=!1,this._loading=!1,this._objectIdCache=new Vm,this._queryOperationQueue=new Vm,this.attachmentsEnabled=!1,this.count=0,this.failures=new Vm,this.filterGeometry=null,this.initialSize=null,this.layer=null,this.objectIds=null,this.outFields=null,this.pageCache=new VD,this.pageSize=50,this.relationshipConfig=null,this.relatedRecordsEnabled=!1,this.returnGeometry=!1,this.returnZ=!1,this.returnM=!1,this.sortOrders=[],this.timeExtent=null,this.view=null,this.where=null}initialize(){this.addHandles([ey((()=>[this.filterGeometry,this.layer,this.objectIds,this.outFields,this.pageSize,this.relationshipConfig,this.returnGeometry,this.returnM,this.returnZ,this.timeExtent,this.where]),(()=>this._reset())),ey((()=>this.orderByFields),(()=>this._clearCaches()),{equals:m}),iy((()=>this.attachmentsEnabled),(()=>this._reset())),iy((()=>this.relatedRecordsEnabled),(()=>this._reset()))])}destroy(){this.layer=null,this.itemCache?.destroy(),this.failures?.destroy()}get _capabilities(){const{layer:t}=this;return t?.effectiveCapabilities??t?.capabilities}get _effectiveReturnZ(){return this.returnZ&&this.supportsZ}get _effectiveReturnM(){return this.returnM&&this.supportsM}get _layerWithAttachments(){const{layer:t}=this;return t&&this._capabilities&&this.attachmentsEnabled&&this.supportsAttachments&&Skt(t)?t:null}get _layerWithAttachmentsEditing(){const{_layerWithAttachments:t}=this;return t&&_kt(t)&&this.supportsEditing?t:null}get _layerWithEditing(){const t=this.layer;return xkt(t)&&this.supportsEditing?t:null}get _layerWithRelationships(){const t=this.layer;return Mkt(t)&&this.supportsQueryRelated?t:null}get _relatedLayer(){return this.relationshipConfig?.relatedLayer}get _relatedLayerCapabilities(){const{_relatedLayer:t}=this;return t?.effectiveCapabilities??t?.capabilities}get _relatedLayerSupportsCacheHint(){return!!this._relatedLayerCapabilities?.queryRelated?.supportsCacheHint}get _relatedLayerSupportsQuery(){return!!this._relatedLayerCapabilities?.operations.supportsQuery}get _relatedLayerSupportsQueryRelated(){const{_relatedLayerCapabilities:t}=this;return!!t?.queryRelated?.supportsCount&&!!t?.queryRelated?.supportsPagination}get _sortedFieldNames(){return this.sortOrders.map((({fieldName:t})=>t))}get _canUseRelatedLayer(){return!(!this._relatedLayerSupportsQuery||!this._relatedLayerSupportsQueryRelated)}get canAddRelatedFeature(){const{state:t,relationship:e,supportsAdd:i,supportsEditing:n}=this;if("loaded"!==t||!e||!i||!n)return!1;const{count:s}=this,{cardinality:r,role:o}=e,a=s>0;return("one-to-one"!==r||!a)&&("one-to-many"!==r||"origin"!==o||!a)}get effectiveOutFields(){const{layer:t,outFields:e}=this;if(!t||!e?.length)return this._defaultOutFields;const i=[];e.forEach((e=>{const n=t.fieldsIndex.normalizeFieldName(e);n&&i.push(n)}));const{objectIdField:n}=t,s=t.fieldsIndex.normalizeFieldName(n)??n;return s&&!i.includes(s)&&i.unshift(s),i}get effectiveTimeExtent(){const{layer:t,timeExtent:e}=this;return e||t&&"timeExtent"in t&&t.timeExtent||null}get effectiveWhere(){return this.where||this.layer?.definitionExpression||"1=1"}get itemCache(){return new Vm({items:[...this.pageCache.values()].flat()})}get layerView(){const{layer:t,view:e}=this;if(!t||!e)return null;const i="sublayer"===t.type?t.parent:t;return e.allLayerViews.find((t=>t.layer===i))}get orderByFields(){const{_sortedFieldNames:t,layer:e,sortOrders:i}=this,n=i.filter((({fieldName:e,direction:i},n)=>t.indexOf(e)===n&&null!=i)).map((({fieldName:t,direction:e})=>`${t} ${e?.toUpperCase()}`));if(e&&!n.length&&!e.objectIdField&&e.fields?.length){const t=e.fields.find((t=>t.name));if(t){const i=e.fieldsIndex.normalizeFieldName(t.name);i&&n.push(`${i} ASC`)}}return n}get querying(){return this._queryOperationQueue.length>0}get relationship(){const{relationshipConfig:t}=this;return null==t?.relationshipId?null:this.relationships?.find((e=>e.id===t.relationshipId))}get relationshipIds(){return this.relationships?.map((t=>t.id))??[]}get relationshipInfos(){const{_layerWithRelationships:t,relatedRecordsEnabled:e,relationships:i,view:n}=this,s=[];return e&&t?.loaded&&n?.map&&i?.length?(i.forEach((e=>{const i=Akt(t,n,e);i&&(i.load(),s.push({layer:t,relatedLayer:i,relationshipId:e.id}))})),s):s}get relationships(){return this._layerWithRelationships?.relationships}get state(){const{layer:t,_loaded:e,_loadError:i,_loading:n}=this;return!t||t.destroyed?"disabled":i||t.loadError?"error":"loaded"===t.loadStatus&&e?"loaded":n?"loading":"ready"}get supportsAdd(){return!!this._capabilities?.operations.supportsAdd}get supportsAddingAttachments(){return!(!this._layerWithAttachmentsEditing||!this.supportsAdd)}get supportsAttachments(){const{_capabilities:t}=this;return!(!t?.data?.supportsAttachment||!t?.operations.supportsQueryAttachments)}get supportsCacheHint(){return!!this._capabilities?.query?.supportsCacheHint}get supportsCacheHintQueryRelated(){return!!this._capabilities?.queryRelated?.supportsCacheHint}get supportsDelete(){return!!this._capabilities?.operations.supportsDelete}get supportsDeletingAttachments(){return!(!this._layerWithAttachmentsEditing||!this.supportsDelete)}get supportsEditing(){return!!this._capabilities?.operations.supportsEditing}get supportsM(){return!!this.layer?.hasM&&!!this._capabilities?.data?.supportsM}get supportsOrderBy(){return!!this._capabilities?.query?.supportsOrderBy}get supportsPagination(){return!!this._capabilities?.query?.supportsPagination}get supportsQuery(){return!!this._capabilities?.operations.supportsQuery}get supportsQueryRelated(){const{_capabilities:t}=this;return!!t?.queryRelated?.supportsCount&&!!t?.queryRelated?.supportsPagination}get supportsResizeAttachments(){const{_capabilities:t}=this;return!(!this.supportsAttachments||!t?.operations?.supportsResizeAttachments)}get supportsUpdate(){return!!this._capabilities?.operations.supportsUpdate}get supportsUpdateAttachments(){return!(!this._layerWithAttachmentsEditing||!this.supportsUpdate)}get supportsZ(){return!!this.layer?.hasZ&&!!this._capabilities?.data?.supportsZ}get syncing(){return this.syncingFeatureEdits||this.syncingAttachmentEdits}get syncingAttachmentEdits(){return this._attachmentsOperationQueue.length>0}get syncingFeatureEdits(){return this._editOperationQueue.length>0}async addAttachment(t,e){const{_layerWithAttachmentsEditing:i}=this;if(!i||!this.supportsAddingAttachments)return{};const n=await this._queueAttachmentsOperation(t,(()=>i.addAttachment(this._createBaseGraphic(i,t),e)));return this._ensureArrayContent(n)}async deleteAttachments(t,e){const{_layerWithAttachmentsEditing:i}=this;if(!i||!this.supportsDeletingAttachments||!e.length)return[];const n=await this._queueAttachmentsOperation(t,(()=>i.deleteAttachments(this._createBaseGraphic(i,t),e)));return this._ensureArray(n)}async deleteRowsByObjectId(t){const{_layerWithEditing:e}=this;if(!this.supportsDelete||!e)throw new Ve("store:delete-error","Delete is not supported.");const i=t.map((t=>this.getItemByObjectId(t)?.feature)).filter(C);return this._queueEditOperation((()=>e.applyEdits({deleteFeatures:i})))}async fetchItems(t){const{page:e}=t,{pageSize:i}=this,n=e*i,s=n+i,{layer:r,state:o}=this;return r&&"loaded"===o?this._query({layer:r,start:n,num:s,page:e,pageSize:i}):[]}async getAttachmentsByObjectId(t,e){const i=this.getItemByObjectId(t)?.attachments??[];if(!i.length&&e){return(await this._queryAttachments([t]))[t]??[]}return i}getItemByObjectId(t){for(const e of this.pageCache.values())for(const i of e)if(i.objectId===t)return i}getItemIndexByObjectId(t){const{pageCache:e,pageSize:i}=this,n=e.entries();let s=-1;for(const[e,r]of n)if(r.some(((n,r)=>{const o=n.objectId===t;return o&&(s=e*i+r),o})),s>-1)break;return s}async load(){const{layer:t}=this;if(!this._loading&&!this._loaded&&t){this._reset(),this._loading=!0;try{await t.load(),t.parent&&HT(t.parent)&&await t.parent.loadAll(),await t.when();const e=this.initialSize;this.initialSize=null,await this.refresh(e),this._loaded=!0,this._loading=!1}catch(t){throw this._reset(),this._loadError=!0,this._logError("store:load-error","An error occurred."),t}}}async query(t){const{state:e}=this;return this.supportsQuery&&"loaded"===e?this._query(t):[]}async refresh(t){this._clearCaches(),await this._syncCount(t),await this._syncObjectIdCache()}async reset(){this._reset()}async updateAttachment(t,e,i){const{_layerWithAttachmentsEditing:n}=this;if(!n||!this.supportsUpdateAttachments)return{};const s=await this._queueAttachmentsOperation(t,(()=>n.updateAttachment(this._createBaseGraphic(n,t),e,i)));return this._ensureArrayContent(s)}async updateItem(t){const{_sortedFieldNames:e}=this,i=t.updates.map((({fieldName:t})=>t)),n=await this._update(t);return!n.updateFeatureResults.find((t=>t.error))&&i.some((t=>e.includes(t)))&&this._clearCaches(),n}async verifyFeaturesByObjectId(t){const{layer:e,state:i}=this;if(!e||"loaded"!==i)return[];const{objectIdField:n}=e,s=await this._verifyFeaturesByObjectId(t);return t.map((t=>s.some((e=>{const i=e.getObjectId()??e.attributes[n];return t===i}))))}_clearCaches(){this.pageCache.clear(),this._objectIdCache.removeAll()}_createBaseGraphic(t,e){return new OD({attributes:{[t.objectIdField]:e}})}_ensureArray(t){return Array.isArray(t)?t:[t]}_ensureArrayContent(t){return Array.isArray(t)?t[0]:t}_getObjectIdsForPage(t,e){const i=this._objectIdCache.toArray();return i.length>=t+e?i.slice(t,t+e):i.slice(t)}_logError(t,e){jt.getLogger(this).error(t,e)}_reset(){this._clearCaches(),this.failures.removeAll(),this._attachmentsOperationQueue.removeAll(),this._editOperationQueue.removeAll(),this._queryOperationQueue.removeAll(),this._loading=!1,this._loaded=!1,this._loadError=!1,this._set("count",0)}async _syncCount(t){null==t?await this._queryCount().then((t=>this._set("count",t))):this._set("count",t)}async _syncObjectIdCache(){if(this.supportsPagination)return;const t=await this._queryObjectIds();this._objectIdCache.removeAll(),this._objectIdCache.addMany(t)}async _verifyFeaturesByObjectId(t){const{layer:e}=this;if(!e||!this.supportsQuery)throw new Ve("store:query-error","Layer does not support query operation.");const{effectiveTimeExtent:i,effectiveWhere:n,orderByFields:s,supportsCacheHint:r,supportsOrderBy:o}=this,a=e.createQuery();a.where=n,a.timeExtent=i,a.returnGeometry=!1,a.objectIds=t.length?t:void 0,a.outFields=[e.objectIdField],o&&(a.orderByFields=s),r&&(a.cacheHint=!0);return(await e.queryFeatures(a)).features}async _update(t){const{objectId:e,updates:i}=t,{_layerWithEditing:n}=this;if(!this.supportsUpdate||!n)throw new Ve("store:update-error","Update is not supported.");const s=this.getItemByObjectId(e)?.feature;if(!s)throw new Ve("store:update-error","Feature with provided 'objectId' not found.");const r=nt(s.attributes);i.forEach((({fieldName:t,value:e})=>r[t]=e));const o=new OD({attributes:r}),a=n.applyEdits({updateFeatures:[o]}).then((t=>{const{updateFeatureResults:e}=t,i=e.find((t=>!!t.error));if(i)throw i.error;return e.length&&(s.attributes=r),t}));return this._queueEditOperation((()=>a))}_prepareFeatureData(t){const{attachments:e,features:i,layer:n,relatedRecords:s}=t,r=n.objectIdField;return i.map((t=>{const i=t.getObjectId()??t.attributes[r],o=[];return t.layer||t.sourceLayer||(t.layer=n,t.sourceLayer=n),s.forEach(((t,e)=>{o.push({relationshipId:e,count:t[i]??0})})),{objectId:i,feature:t,attachments:e[i]??null,relatedRecords:o}}))}async _query(t){const{page:e,refresh:i}=t;!0===i&&await this.refresh();const n=this.pageCache.get(e);if(n)return n;const s=await this._queryPage(t);return this.pageCache.set(e,s),s}_queryAttachments(t){const{_layerWithAttachments:e,effectiveWhere:i,supportsCacheHint:n}=this;return e?t.some((t=>"number"!=typeof t))?Promise.reject(new Ve("invalid-object-id","Only numeric object ids are valid to query attachments")):e.queryAttachments(new Mct({cacheHint:n,objectIds:t,where:i,returnMetadata:!0})):Promise.resolve({})}async _queryCount(){const{_relatedLayerSupportsCacheHint:t,layer:e,relationshipConfig:i,supportsCacheHint:n}=this;if(!e)return 0;if(i&&this._canUseRelatedLayer){const{objectId:e,relatedLayer:n,relationshipId:s}=i;return(await n.queryRelatedFeaturesCount(new Ict({cacheHint:t,relationshipId:s,objectIds:[e]})))[e]??0}const{effectiveTimeExtent:s,effectiveWhere:r,filterGeometry:o,objectIds:a}=this,l=e.createQuery();return l.geometry=o,l.returnGeometry=!1,l.where=r,l.timeExtent=s,l.objectIds=a?.length?a:void 0,n&&(l.cacheHint=!0),e.queryFeatureCount(l)}async _queryFeatures(t){const{relationshipConfig:e}=this;if(e&&this._canUseRelatedLayer)return this._queryRelatedFeatures(t,e);const{_effectiveReturnM:i,_effectiveReturnZ:n,effectiveOutFields:s,effectiveTimeExtent:r,effectiveWhere:o,filterGeometry:a,objectIds:l,orderByFields:u,pageSize:c,returnGeometry:h,supportsCacheHint:d,supportsOrderBy:f,supportsPagination:p}=this,{layer:m,start:y}=t,g=l?.length,v=m.createQuery();v.returnGeometry=h,v.outFields=s,v.returnM=i,v.returnZ=n,p?(v.start=y,v.num=c,v.where=o,v.timeExtent=r,v.objectIds=g?l:void 0):v.objectIds=g?l:this._getObjectIdsForPage(y,c??0),f&&(v.orderByFields=u),a&&(v.geometry=a),d&&(v.cacheHint=!0);return(await m.queryFeatures(v)).features}_queryObjectIds(){const{effectiveTimeExtent:t,effectiveWhere:e,filterGeometry:i,layer:n,objectIds:s,orderByFields:r,supportsCacheHint:o,supportsOrderBy:a}=this;if(!n)return Promise.resolve([]);const l=n.createQuery();return l.geometry=i,l.outFields=[n.objectIdField],l.returnGeometry=!1,l.where=e,l.timeExtent=t,l.objectIds=s?.length?s:void 0,a&&(l.orderByFields=r),o&&(l.cacheHint=!0),n.queryObjectIds(l)}async _queryPage(t){const{layer:e}=t;return this._queueQueryOperation((async()=>{const i=await this._queryFeatures(t),n=i.map((t=>t.getObjectId()??t.attributes[e.objectIdField])),s=await this._queryAttachments(n),r=await this._queryRelatedCounts(n);return this._prepareFeatureData({layer:e,features:i,attachments:s,relatedRecords:r})||[]}))}async _queryRelatedCounts(t){const{_layerWithRelationships:e,relationshipIds:i,supportsCacheHintQueryRelated:n}=this,s=new Map;return e&&t?.length&&i.length?(await Promise.allSettled(i.map((async i=>{const r=await e.queryRelatedFeaturesCount(new Ict({cacheHint:n,relationshipId:i,objectIds:t}));s.set(i,r)}))),s):s}async _queryRelatedFeatures(t,e){const{_defaultOutFields:i,_effectiveReturnM:n,_effectiveReturnZ:s,orderByFields:r,pageSize:o,returnGeometry:a,supportsCacheHint:l}=this,{layer:u,start:c}=t,{objectId:h,relatedLayer:d,relationshipId:f}=e,p=u.createQuery(),m=new Ict({cacheHint:l,num:o,objectIds:[h],orderByFields:r,outFields:i,relationshipId:f,returnGeometry:a,returnM:n,returnZ:s,start:c,where:p.where??void 0}),y=await d.queryRelatedFeatures(m);return y[h]?.features||[]}_queueAttachmentsOperation(t,e){return this._attachmentsOperationQueue.push(e),e().then((async i=>{this._attachmentsOperationQueue.remove(e);const n=this._ensureArray(i),s=n.some((t=>t.error)),r=this.getItemByObjectId(t);if(r&&(!s||n.length>1)){const e=await this._queryAttachments([t]);r.attachments=e[t]}return i})).catch((async i=>{this._logError("store:attachment-error","An error occurred.");const n={error:i,retry:()=>{this.failures.remove(n),this._queueAttachmentsOperation(t,e)},cancel:()=>this.failures.remove(n)};throw this.failures.add(n),this._attachmentsOperationQueue.remove(e),i}))}_queueEditOperation(t){return this._editOperationQueue.push(t),t().then((e=>(this._editOperationQueue.remove(t),e))).catch((e=>{this._logError("store:edit-error","An error occurred.");const i={error:e,retry:()=>{this.failures.remove(i),this._queueEditOperation(t)},cancel:()=>this.failures.remove(i)};throw this.failures.add(i),this._editOperationQueue.remove(t),e}))}_queueQueryOperation(t){return this._queryOperationQueue.push(t),t().then((e=>this._queryOperationQueue.includes(t)?e:[])).catch((e=>{this._logError("store:query-error","An error occurred.");const i={error:e,retry:()=>{this.failures.remove(i),this._queueQueryOperation(t)},cancel:()=>this.failures.remove(i)};return this.failures.add(i),[]})).then((e=>(this._queryOperationQueue.remove(t),e)))}};r([Je()],C$t.prototype,"_attachmentsOperationQueue",void 0),r([Je({readOnly:!0})],C$t.prototype,"_capabilities",null),r([Je()],C$t.prototype,"_defaultOutFields",void 0),r([Je()],C$t.prototype,"_editOperationQueue",void 0),r([Je()],C$t.prototype,"_effectiveReturnZ",null),r([Je()],C$t.prototype,"_effectiveReturnM",null),r([Je({readOnly:!0})],C$t.prototype,"_layerWithAttachments",null),r([Je({readOnly:!0})],C$t.prototype,"_layerWithAttachmentsEditing",null),r([Je({readOnly:!0})],C$t.prototype,"_layerWithEditing",null),r([Je({readOnly:!0})],C$t.prototype,"_layerWithRelationships",null),r([Je()],C$t.prototype,"_loaded",void 0),r([Je()],C$t.prototype,"_loadError",void 0),r([Je()],C$t.prototype,"_loading",void 0),r([Je()],C$t.prototype,"_objectIdCache",void 0),r([Je()],C$t.prototype,"_queryOperationQueue",void 0),r([Je({readOnly:!0})],C$t.prototype,"_relatedLayer",null),r([Je({readOnly:!0})],C$t.prototype,"_relatedLayerCapabilities",null),r([Je({readOnly:!0})],C$t.prototype,"_relatedLayerSupportsCacheHint",null),r([Je()],C$t.prototype,"_relatedLayerSupportsQuery",null),r([Je()],C$t.prototype,"_relatedLayerSupportsQueryRelated",null),r([Je()],C$t.prototype,"_sortedFieldNames",null),r([Je()],C$t.prototype,"_canUseRelatedLayer",null),r([Je()],C$t.prototype,"attachmentsEnabled",void 0),r([Je()],C$t.prototype,"canAddRelatedFeature",null),r([Je({readOnly:!0})],C$t.prototype,"count",void 0),r([Je()],C$t.prototype,"effectiveOutFields",null),r([Je()],C$t.prototype,"effectiveTimeExtent",null),r([Je()],C$t.prototype,"effectiveWhere",null),r([Je({readOnly:!0})],C$t.prototype,"failures",void 0),r([Je()],C$t.prototype,"filterGeometry",void 0),r([Je()],C$t.prototype,"initialSize",void 0),r([Je({readOnly:!0})],C$t.prototype,"itemCache",null),r([Je()],C$t.prototype,"layer",void 0),r([Je()],C$t.prototype,"layerView",null),r([Je()],C$t.prototype,"objectIds",void 0),r([Je()],C$t.prototype,"orderByFields",null),r([Je()],C$t.prototype,"outFields",void 0),r([Je({readOnly:!0})],C$t.prototype,"pageCache",void 0),r([Je()],C$t.prototype,"pageSize",void 0),r([Je({readOnly:!0})],C$t.prototype,"querying",null),r([Je()],C$t.prototype,"relationship",null),r([Je()],C$t.prototype,"relationshipConfig",void 0),r([Je()],C$t.prototype,"relationshipIds",null),r([Je()],C$t.prototype,"relationshipInfos",null),r([Je()],C$t.prototype,"relationships",null),r([Je()],C$t.prototype,"relatedRecordsEnabled",void 0),r([Je()],C$t.prototype,"returnGeometry",void 0),r([Je()],C$t.prototype,"returnZ",void 0),r([Je()],C$t.prototype,"returnM",void 0),r([Je()],C$t.prototype,"sortOrders",void 0),r([Je({readOnly:!0})],C$t.prototype,"state",null),r([Je()],C$t.prototype,"supportsAdd",null),r([Je()],C$t.prototype,"supportsAddingAttachments",null),r([Je()],C$t.prototype,"supportsAttachments",null),r([Je()],C$t.prototype,"supportsCacheHint",null),r([Je()],C$t.prototype,"supportsCacheHintQueryRelated",null),r([Je()],C$t.prototype,"supportsDelete",null),r([Je()],C$t.prototype,"supportsDeletingAttachments",null),r([Je()],C$t.prototype,"supportsEditing",null),r([Je()],C$t.prototype,"supportsM",null),r([Je()],C$t.prototype,"supportsOrderBy",null),r([Je()],C$t.prototype,"supportsPagination",null),r([Je()],C$t.prototype,"supportsQuery",null),r([Je()],C$t.prototype,"supportsQueryRelated",null),r([Je()],C$t.prototype,"supportsResizeAttachments",null),r([Je()],C$t.prototype,"supportsUpdate",null),r([Je()],C$t.prototype,"supportsUpdateAttachments",null),r([Je()],C$t.prototype,"supportsZ",null),r([Je({readOnly:!0})],C$t.prototype,"syncing",null),r([Je({readOnly:!0})],C$t.prototype,"syncingAttachmentEdits",null),r([Je({readOnly:!0})],C$t.prototype,"syncingFeatureEdits",null),r([Je()],C$t.prototype,"timeExtent",void 0),r([Je()],C$t.prototype,"view",void 0),r([Je()],C$t.prototype,"where",void 0),C$t=r([ln("esri.widgets.FeatureTable.support.FeatureStore")],C$t);const E$t=C$t;const j$t=t=>{let e=class extends t{constructor(){super(...arguments),this.editable=!0,this.hint=null,this.input=null,this.required=!1}};return r([Je({type:Boolean,json:{write:!0}})],e.prototype,"editable",void 0),r([Je({type:String,json:{write:!0}})],e.prototype,"hint",void 0),r([Je({types:hat,json:{read:{source:"inputType"},write:{target:"inputType"}}})],e.prototype,"input",void 0),r([Je()],e.prototype,"required",void 0),e=r([ln("esri.widgets.FeatureTable.support.EditableColumnTemplateMixin")],e),e};let O$t=class extends(j$t(y$t)){constructor(t){super(t),this.domain=null,this.editableExpression=null,this.format=null,this.formatFunction=null,this.requiredExpression=null,this.sortable=!0,this.type="field",this.valueExpression=null,this.visibilityExpression=null}};r([Je({types:r$,json:{read:{reader:o$},write:!0}})],O$t.prototype,"domain",void 0),r([Je({type:String,json:{write:!0}}),Je()],O$t.prototype,"editableExpression",void 0),r([Je()],O$t.prototype,"format",void 0),r([Je()],O$t.prototype,"formatFunction",void 0),r([Je({type:String,json:{write:!0}})],O$t.prototype,"requiredExpression",void 0),r([Je()],O$t.prototype,"sortable",void 0),r([Je({type:String,json:{read:!1,write:!0}})],O$t.prototype,"type",void 0),r([Je({type:String,json:{write:!0}})],O$t.prototype,"valueExpression",void 0),r([Je({type:String,json:{write:!0}})],O$t.prototype,"visibilityExpression",void 0),O$t=r([ln("esri.widgets.FeatureTable.support.FieldColumnTemplate")],O$t);const R$t=O$t;let L$t=class extends y$t{constructor(t){super(t),this.collapsed=!1,this.icon="link",this.relationshipId=null,this.sortable=!1,this.textAlign="center",this.type="relationship"}};r([Je()],L$t.prototype,"collapsed",void 0),r([Je()],L$t.prototype,"icon",void 0),r([Je()],L$t.prototype,"relationshipId",void 0),r([Je()],L$t.prototype,"sortable",void 0),r([Je()],L$t.prototype,"textAlign",void 0),r([Je({type:String,json:{read:!1,write:!0}})],L$t.prototype,"type",void 0),L$t=r([ln("esri.widgets.FeatureTable.support.RelationshipColumnTemplate")],L$t);const N$t=L$t;let P$t=class extends(j$t(y$t)){constructor(t){super(t),this.type="column"}};r([Je({type:String,json:{read:!1,write:!0}})],P$t.prototype,"type",void 0),P$t=r([ln("esri.widgets.FeatureTable.support.ColumnTemplate")],P$t);const F$t=P$t;let D$t=class extends y$t{constructor(t){super(t),this.columnTemplates=null,this.type="group"}castColumnTemplates(t){if(!t||!Array.isArray(t))return[];const e=[];return t.forEach((t=>{if(t instanceof R$t||t instanceof F$t||t instanceof v$t||t instanceof N$t)e.push(t);else if(hkt(t)){const i=t.type;"field"===i?e.push(new R$t(t)):"group"===i?jt.getLogger(this).warn("A GroupColumnTemplate cannot contain other GroupColumn templates. Template removed from 'GroupColumnTemplate.columnTemplates'."):"column"===i?e.push(new F$t(t)):"attachment"===i?e.push(new v$t(t)):"relationship"===i&&e.push(new N$t(t))}else jt.getLogger(this).warn("Property 'type' is missing from the provided template. Template removed from 'tableTemplate.columnTemplates'.")})),e}};r([Je({json:{write:!0}})],D$t.prototype,"columnTemplates",void 0),r([Ah("columnTemplates")],D$t.prototype,"castColumnTemplates",null),r([Je({type:String,json:{read:!1,write:!0}})],D$t.prototype,"type",void 0),D$t=r([ln("esri.widgets.FeatureTable.support.GroupColumnTemplate")],D$t);const $$t=D$t;var z$t;let U$t=z$t=class extends Io{constructor(t){super(t),this.columnTemplates=[]}castColumnTemplates(t){if(!t||!Array.isArray(t))return[];const e=[];return t.forEach((t=>{if(t instanceof R$t||t instanceof $$t||t instanceof F$t||t instanceof v$t||t instanceof N$t)e.push(t);else if(hkt(t)){const i=t.type;"field"===i?e.push(new R$t(t)):"group"===i?e.push(new $$t(t)):"column"===i?e.push(new F$t(t)):"attachment"===i?e.push(new v$t(t)):"relationship"===i&&e.push(new N$t(t))}else jt.getLogger(this).warn("Property 'type' is missing from the provided template. Template removed from 'tableTemplate.columnTemplates'.")})),e}clone(){return new z$t({columnTemplates:nt(this.columnTemplates)})}};r([Je()],U$t.prototype,"columnTemplates",void 0),r([Ah("columnTemplates")],U$t.prototype,"castColumnTemplates",null),U$t=z$t=r([ln("esri.widgets.FeatureTable.support.TableTemplate")],U$t);const B$t=U$t;const G$t="80px";let V$t=class extends o$t{constructor(t){super(t),this._debounceRefresh=$s((()=>this._refresh())),this._highlights=new Sn,this.actionColumnConfig=null,this.attachmentsViewOptions=new b$t,this.attributeTableTemplate=null,this.autoRefreshEnabled=!0,this.columns=new Vm,this.dataProvider=async(t,e)=>{const{layer:i,store:n}=this;if(!e)return;if(!i||!n)return void(e&&e([]));await i.load();const{objectIds:s}=this;if(this.filterBySelectionEnabled&&!this.highlightIds.length||1===s.length&&-1===s.items[0])return void e([]);"loaded"!==n.state&&"loading"!==n.state&&await n.load();const r=this.paginationEnabled?this.pageIndex:t.page,o=await n.fetchItems({...t,page:r});e&&e(o)},this.editingEnabled=!1,this.grid=null,this.highlightEnabled=!0,this.itemIdPath="objectId",this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.messagesURIUtils=null,this.prompt=null,this.relatedTables=new Vm,this.relationshipColumnConfigs=null,this.selectionSource="table",this.showRelatedTableCallback=null,this.store=null,this.tableController=null,this.tableParent=null,this.tableTemplate=null,this.tableTemplateOverride=null,this._onLayerRefresh=this._onLayerRefresh.bind(this),this._onShowPromptCallback=this._onShowPromptCallback.bind(this),this._set("store",new E$t),this._set("grid",new d$t({itemIdPath:this.itemIdPath,viewModel:this}))}initialize(){const t=async()=>{this.messages=await hv("esri/widgets/FeatureTable/t9n/FeatureTable"),this.messagesCommon=await hv("esri/t9n/common"),this.messagesUnits=await hv("esri/core/t9n/Units"),this.messagesURIUtils=await hv("esri/widgets/support/t9n/uriUtils")};t(),this.addHandles([Qy((()=>{t(),this._generateColumns()})),ey((()=>[this.messages,this.messagesCommon,this.messagesURIUtils]),(()=>{const t=this.messages;this.grid&&(this.grid.messages=t),this.allColumns.forEach((e=>{e.messages=t,e.messagesCommon=this.messagesCommon,e.messagesURIUtils=this.messagesURIUtils})),this.refreshCellContent()}),dy),sy((()=>this.highlightIds),"change",(t=>this._onHighlightIdsChange(t)),{onListenerAdd:()=>this._syncSelection(),onListenerRemove:()=>this._highlights.removeAll()}),ey((()=>this.attachmentsEnabled),(()=>this.layer?.loaded&&this._generateColumns())),ey((()=>this._viewSelection),(()=>{this._viewSelectionReady&&(this.highlightIds.items=this._viewSelection)})),ey((()=>[this._tableHighlightsReady,this._viewSelectionReady]),(()=>this._syncSelection())),ey((()=>this.layer),(async(t,e)=>{const i=this.grid;i&&(i.clearSort(),t&&e&&await this.reset()),this.goToPage(0),this._drainColumns(),this.store.layer=t,t&&(t.loaded?this._onLayerLoad():t.load().catch((()=>{})))})),ey((()=>this.layer?.loaded),(t=>t&&this._onLayerLoad())),ey((()=>this.store.state),(t=>{"loaded"===t&&(this.scrollToTop(),this.refreshCellContent())})),ey((()=>this._effectiveTableTemplate),(()=>{this.scrollLeft(),this.layer?.loaded&&this._generateColumns()})),ey((()=>this.editingEnabled),(t=>{this.editableColumns.forEach((e=>e.tableEditingEnabled=t)),this.refreshCellContent()})),ey((()=>this.timeZone??this.view?.timeZone),(()=>this.refreshCellContent())),ey((()=>this.layer?.definitionExpression),((t,e)=>(t||e)&&"loaded"===this.store.state&&this.reset())),ey((()=>this.layer?.timeExtent),((t,e)=>(t||e)&&!this.timeExtent&&"loaded"===this.store.state&&this.reset())),sy((()=>this.layer),"refresh",(t=>this._onLayerRefresh(t))),sy((()=>this.grid),["cell-click","cell-dblclick","cell-pointerover","cell-pointerout","cell-keydown","column-reorder"],(({index:t,item:e,native:i,path:n,type:s})=>{const r=e?.feature,o=r?.getObjectId(),a="cell-keydown"===s&&i&&i instanceof KeyboardEvent&&"Enter"===i.key;this.emit(s,{feature:r,index:t,native:i,type:s,fieldName:n??void 0,objectId:o}),(a||"cell-click"===s)&&this._onCellInteraction(o)})),ey((()=>this.actionColumnConfig),(t=>{const{actionColumn:e,columns:i}=this;e?t?e.set(t):i.remove(e):t&&i.length&&i.add(this._generateActionColumn(),!1!==t.frozenToEnd?void 0:this._getIndexOfFirstFrozenToEndColumn())})),ey((()=>this.relatedRecordsEnabled),(()=>this.layer?.loaded&&this._generateColumns())),sy((()=>this.objectIds),"change",(()=>this._onObjectIdsChange()),{onListenerAdd:()=>this._onObjectIdsChange()}),ey((()=>[this.paginationEnabled,this.pageIndex]),(()=>this.refreshPageCache())),ey((()=>this.activeSortOrders),(t=>this.store.sortOrders=t)),ey((()=>this.pageCount),(()=>{this.pageIndex>=this.pageCount&&this.goToPage(0)})),ey((()=>this.state),(t=>{"disabled"===t&&this.relatedTables.length&&this.drainRelatedTables()})),sy((()=>this.tableParent?.highlightIds),"change",(({added:t})=>{const{relationshipConfig:e}=this,i=t[0];if(null==i||!e)return;const{relatedLayer:n,relationshipId:s}=e;this.relationshipConfig={objectId:i,relatedLayer:n,relationshipId:s}})),sy((()=>this.tableParent),"cell-click",(t=>{const{tableParent:e}=this,{objectId:i}=t;e&&null!=i&&e.highlightIds.add(i)})),ey((()=>this.attachmentsViewOptions.objectId),((t,e)=>{null!=t?null==e&&this.showAttachmentsView({objectId:t}):this.hideAttachmentsView()}))])}destroy(){this._drainColumns(),this._highlights.removeAll(),this._highlights.destroy(),this.grid?.destroy(),this.columns.destroyed||this.columns.destroy(),this.layer=null,this.view=null}get _defaultHiddenFields(){return gj(this.layer)}get _effectiveTableTemplate(){return this.tableTemplateOverride||this.tableTemplate}get _effectiveAttributeTableTemplate(){return this.attributeTableTemplate||this.layer?.attributeTableTemplate}get _highlightableLayerView(){const t=this.layerView;return _gt(t)?t:null}get _relationshipInfos(){return this.store.relationshipInfos}get _selectionManager(){const{view:t}=this;return!t||t.destroyed?null:t.selectionManager?.sources?.length?t.selectionManager:null}get _selectableLayer(){const{layer:t}=this;return q$(t)&&this._selectionManager?.sources.includes(t)?t:null}get _subtypes(){return oA(this.layer)}get _tableHighlightsReady(){return!("table"!==this.selectionSource||!this.highlightEnabled||!this._highlightableLayerView)}get _viewSelection(){const{_selectableLayer:t}=this;return t?this._selectionManager?.getSelection(t)??[]:[]}get _viewSelectionReady(){return!(!this.layer||"view"!==this.selectionSource||!this._selectionManager)}get allRelatedTablesVisible(){return!!(this.relatedRecordsEnabled&&this.relatedTables.length&&this.showAllRelatedTables)}get activeFilters(){const{filterGeometry:t,objectIds:e,filterBySelectionEnabled:i,highlightIds:n}=this,s=new Vm;return t&&s.push({type:"geometry",geometry:t}),i?s.push({type:"selection",objectIds:n.toArray()}):e.length&&s.push({type:"objectId",objectIds:e.toArray()}),s}get activeSortOrders(){return this.grid?.sortOrders?this.grid.sortOrders.map((({path:t,direction:e})=>({fieldName:t,direction:e}))).filter((t=>t.fieldName&&t.direction)):[]}get attachmentsEnabled(){return this.store.attachmentsEnabled}set attachmentsEnabled(t){this.store.attachmentsEnabled=t}get clearPrompt(){return()=>this.prompt=null}set clearPrompt(t){this._overrideIfSome("clearPrompt",t)}get filterGeometry(){return this.store.filterGeometry}set filterGeometry(t){this.store.filterGeometry=t}get filterBySelectionEnabled(){return!!this._get("filterBySelectionEnabled")}set filterBySelectionEnabled(t){const{objectIds:e}=this,i=e.length;t?(i&&(e.removeAll(),this._logWarning("Selection filter has been applied with an objectID filter. Object ID filter has been removed.")),this.filterGeometry&&this._logWarning("Selection filter has been applied with a geometry filter. Results may appear inconsistent"),this._syncObjectIdsWithStore(this.highlightIds.toArray())):i||this._syncObjectIdsWithStore(null),this._set("filterBySelectionEnabled",t)}get hiddenFields(){return this._get("hiddenFields")??new Vm}set hiddenFields(t){this._set("hiddenFields",AM(t,this._get("hiddenFields"),Vm))}get initialSize(){return this.store.initialSize}set initialSize(t){this.store.initialSize=t}get isQueryingOrSyncing(){const{store:t}=this;return t?.syncing||t?.querying||this.relatedTables.some((t=>!!t.isQueryingOrSyncing))}get isSyncingAttachments(){return this.store.syncingAttachmentEdits||this.relatedTables.some((t=>!!t.isSyncingAttachments))}get layer(){return this._get("layer")}set layer(t){this.drainRelatedTables(),this._set("layer",t)}get layerView(){return this.store.layerView}get outFields(){return this.store.outFields}set outFields(t){this.store.outFields=t}get relatedRecordsEnabled(){return this.store.relatedRecordsEnabled}set relatedRecordsEnabled(t){this.store.relatedRecordsEnabled=t}get relatedTable(){return this.relatedTables.at(-1)}get relationship(){const t=this.relationshipConfig?.relationshipId;return null==t?null:this.relationships?.find((({id:e})=>e===t))}get relationshipConfig(){return this.store.relationshipConfig}set relationshipConfig(t){this.highlightIds.removeAll(),this.objectIds.removeAll(),this.filterBySelectionEnabled=!1,this.store.relationshipConfig=t}get relationships(){return this.store.relationships}get returnGeometryEnabled(){return this.store.returnGeometry}set returnGeometryEnabled(t){this.store.returnGeometry=t}get returnMEnabled(){return this.store.returnM}set returnMEnabled(t){this.store.returnM=t}get returnZEnabled(){return this.store.returnZ}set returnZEnabled(t){this.store.returnZ=t}get showAllRelatedTables(){return this._get("showAllRelatedTables")}set showAllRelatedTables(t){const{relatedTable:e}=this;this._set("showAllRelatedTables",t),e&&(t?this._showAllRelatedTables(e):this._hideAllRelatedTables(e))}get showPrompt(){return t=>{this.prompt?.cancel?.(),this.prompt=t}}set showPrompt(t){this._overrideIfSome("showPrompt",t)}get supportsAttachments(){return this.store.supportsAttachments}get supportsAddAttachments(){const{store:{supportsAddingAttachments:t,supportsEditing:e}}=this;return this.editingEnabled&&e&&t}get supportsDeleteAttachments(){const{store:{supportsDeletingAttachments:t,supportsEditing:e}}=this;return this.editingEnabled&&e&&t}get supportsResizeAttachments(){return this.store.supportsResizeAttachments}get supportsUpdateAttachments(){const{store:{supportsUpdateAttachments:t,supportsEditing:e}}=this;return this.editingEnabled&&e&&t}get timeExtent(){return this.store.timeExtent}set timeExtent(t){this.store.timeExtent=t}get timeZone(){return this._get("timeZone")}set timeZone(t){this.allColumns.forEach((e=>e.tableTimeZone=t)),this._set("timeZone",t)}get view(){return this.store.view}set view(t){this.store.view=t,this.fieldColumns.forEach((e=>e.view=t)),this.refreshCellContent()}async addAttachment(t,e){const{attachmentsViewOptions:i,store:n}=this,s=i.objectId===t;await n.addAttachment(t,e).catch((t=>{s&&t&&"object"==typeof t&&"error"in t&&t.error instanceof Ve&&(this._logWarning(`Unable to add attachment. ${t.error.name} ${t.error.message}`),i.error=t.error)})),s&&!i.error&&(i.onEditComplete(),i.attachmentInfos=await n.getAttachmentsByObjectId(t,!0)),this.refreshCellContent()}async deleteAttachments(t,e){const{attachmentsViewOptions:i,store:n}=this,s=i.objectId===t;await n.deleteAttachments(t,e).catch((t=>{s&&t&&"object"==typeof t&&"error"in t&&t.error instanceof Ve&&(this._logWarning(`Unable to delete attachment(s). ${t.error.name} ${t.error.message}`),i.error=t.error)})),s&&!i.error&&(i.onEditComplete(),i.attachmentInfos=await n.getAttachmentsByObjectId(t,!0)),this.refreshCellContent()}collapseRelatedTable(t,e){const{relatedLayer:i,objectId:n,relationshipId:s}=e,{objectIdField:r}=i,o=Ekt(i,s),a=i.displayField||o?.keyField||r;t.set({highlightIds:new Vm([n]),multipleSelectionEnabled:!1,tableTemplateOverride:this._getTableTemplateForRelatedTableView(t,a,s)});const l=t.hiddenFields;l.includes(ykt.action)||l.add(ykt.action),l.includes(ykt.attachments)||l.add(ykt.attachments),t.scrollLeft()}async deleteSelection(){const t=this.highlightIds.toArray();if(!t?.length)return;const{deleteFeatureResults:e}=await this.store.deleteRowsByObjectId(t),i=e.filter((t=>!t.error)).map((t=>t.objectId));i.length&&(this.highlightIds.removeMany(i),await this.refresh())}async downloadAttachmentById(t,e){const i=(await this.store.getAttachmentsByObjectId(t,!0)).find((t=>t.id===e));k$t(i)}drainRelatedTables(){this.relatedTables.drain((t=>t.destroy())),this.set({multipleSelectionEnabled:!0,relationshipColumnConfigs:null,showAllRelatedTables:!1,tableTemplateOverride:null}),this.hiddenFields.removeMany([ykt.action,ykt.attachments])}drainRelatedTablesAboveIndex(t){const{relatedTables:e}=this,i=e.slice(t+1);e.removeMany(i).forEach((t=>t.destroy()));const n=e.at(-1);n&&(n.attachmentsViewOptions.objectId=null,this.allRelatedTablesVisible?this._showAllRelatedTables(n):this._hideAllRelatedTables(n))}async exportSelectionToCSV(t){const{highlightIds:e,layer:i,outFields:n}=this;i&&e.length?await I$t({layer:i,objectIds:e.toArray(),outFields:n,includeGeometry:t}):this._logWarning("Export failed.")}filterBySelection(){this.filterBySelectionEnabled?this._logWarning("Property 'filterBySelectionEnabled' is already 'true'. This method has no effect."):(pn(jt.getLogger(this),"`FeatureTable.filterBySelection` is deprecated in favor of 'filterBySelectionEnabled' and 'objectIds'",{replacement:"FeatureTable.filterBySelectionEnabled or FeatureTable.objectIds",version:"4.30",warnOnce:!0}),this.objectIds.addMany(this.highlightIds.toArray()))}getObjectIdIndex(t){return this.store.getItemIndexByObjectId(t)}getValue(t,e){const i=this.store.getItemByObjectId(t);return i?.feature?.attributes[e]}getVirtualPageIndex(){return this.grid?.getVirtualPageIndex()??0}goToPage(t){if(null==t||!Number.isInteger(t))return void this._logWarning("Invalid 'page' parameter provided to 'goToPage()'. Current page will remain the same.");const{pageCount:e}=this;(t>=e||-1===t)&&(t=e-1),t<-1&&(t=0),t!==this.pageIndex&&(this.pageIndex=t),this.paginationEnabled||this.scrollToIndex(t*this.pageSize)}hideAttachmentsView(){this.attachmentsViewOptions.objectId=null,this.set({relationshipColumnConfigs:null,multipleSelectionEnabled:!0,tableTemplateOverride:null}),this.hiddenFields.remove(ykt.action)}nextPage(){const t=this.paginationEnabled?this.pageIndex:this.getVirtualPageIndex();this.goToPage(t+1)}previousPage(){const t=this.paginationEnabled?this.pageIndex:this.getVirtualPageIndex();this.goToPage(t-1)}async refresh(){return this.relatedTables.forEach((async t=>await t.refresh())),js(this._debounceRefresh())}refreshCellContent(){this.grid?.requestContentUpdate()}refreshPageCache(){this.grid?.refreshPageCache()}async reset(){this.goToPage(0),await(this.grid?.reset())}scrollLeft(){this.grid?.scrollLeft(0)}scrollToBottom(){this.grid?.scrollToBottom()}scrollToIndex(t){this.grid?.scrollToIndex(t)}scrollToRow(t){const e=this.store.getItemIndexByObjectId(t);e>-1?this.grid?.scrollToIndex(e):this._logWarning("Row not found. Associated data may not be loaded yet.")}scrollToTop(){this.grid?.scrollToTop()}async saveAttachmentsViewForm(){const{attachmentId:t,form:e,objectId:i}=this.attachmentsViewOptions;null!=i&&e&&(null!=t?await this.updateAttachment(i,t,e):await this.addAttachment(i,e))}async showAttachmentsView({objectId:t}){const{attachmentsViewOptions:e,hiddenFields:i,layer:n}=this;if(!this.attachmentsEnabled||!n)return void this._logWarning("The 'attachmentsEnabled' property is currently false.");await n.load();const s=n.displayField||n.objectIdField,r=await this.store.getAttachmentsByObjectId(t,!0),o=this.store.getItemIndexByObjectId(t);e.set({attachmentInfos:r,mode:r.length?"list":"file",objectId:t}),this.set({highlightIds:new Vm([t]),multipleSelectionEnabled:!1,relationshipColumnConfigs:[],tableTemplateOverride:this._getTableTemplateForAttachmentsView(s)}),i.includes(ykt.action)||i.add(ykt.action),null!=o&&this.scrollToIndex(o)}clearSelectionFilter(){pn(jt.getLogger(this),"`FeatureTable.clearSelectionFilter` is deprecated in favor of 'filterBySelectionEnabled' and 'objectIds'",{replacement:"FeatureTable.filterBySelectionEnabled or FeatureTable.objectIds",version:"4.30",warnOnce:!0}),this.objectIds.removeAll()}async updateAttachment(t,e,i){const{attachmentsViewOptions:n,store:s}=this,r=n.objectId===t;await s.updateAttachment(t,e,i).catch((t=>{r&&t&&"object"==typeof t&&"error"in t&&t.error instanceof Ve&&(this._logWarning(`Unable to update attachment. ${t.error.name} ${t.error.message}`),n.error=t.error)})),r&&!n.error&&(n.onEditComplete(),n.attachmentInfos=await s.getAttachmentsByObjectId(t,!0)),this.refreshCellContent()}async zoomToSelection(){const{layer:t,view:e}=this,i=this.highlightIds.toArray();if(!t||!e||!i.length)return;const n=t.createQuery();n.objectIds=i,n.returnGeometry=!0;const s=await t.queryFeatures(n);try{await e.goTo(s.features)}catch(t){"AbortError"!==t.name&&console.error(t)}}async _refresh(){await this.store.refresh();const t=this.highlightIds.toArray();if(t.length){(await this.store.verifyFeaturesByObjectId(t)).forEach(((e,i)=>{e||this.highlightIds.remove(t[i])}))}this.refreshPageCache();const e=this.attachmentsViewOptions;null!=e?.objectId&&(e.attachmentInfos=await this.store.getAttachmentsByObjectId(e.objectId,!0))}async _onLayerLoad(){const{layer:t,pageSize:e}=this;if(!t)return;t.parent&&HT(t.parent)&&await t.parent.loadAll();const i=t.capabilities.query?.maxRecordCount,n=i&&i<e,s=n?i:e;n&&(this._logWarning("The value for 'pageSize' has been adjusted due to the provided layer's max record count."),this.pageSize=s),this.grid?.set("pageSize",s),this.store.load(),this._generateColumns()}_onLayerRefresh(t){this.autoRefreshEnabled&&t.dataChanged&&this.refresh()}_generateColumns(){this._drainColumns();const{_effectiveTableTemplate:t,_effectiveAttributeTableTemplate:e}=this,i=t?.columnTemplates,n=this._generateColumnsFromColumnTemplates(i)??this._generateColumnsFromAttributeTableTemplate(e)??this._generateDefaultFieldColumns();n.length&&(this.attachmentsEnabled&&!n.some((t=>mkt(t)))&&n.push(this._generateDefaultAttachmentsColumn()),this.relatedRecordsEnabled&&this._relationshipInfos.length&&!n.some((t=>pkt(t)))&&n.push(...this._generateDefaultRelationshipColumns()),this.actionColumnConfig&&n.push(this._generateActionColumn()),n.sort(((t,e)=>t.frozen&&e.frozen||t.frozenToEnd&&e.frozenToEnd?0:t.frozen||e.frozenToEnd?-1:0)),this.columns.addMany(n))}_generateColumnsFromAttributeTableTemplate(t){const{layer:e}=this;if(!t||!e)return null;const{elements:i,orderByFields:n}=t,s=hpt(e),r=[];r.push(...this._generateColumnsFromAttributeTableElements(i,n));const o=s.map((t=>{if(!t.fieldName||Okt(t.fieldName,r))return null;const{fieldName:i}=t,s=jkt(e,i);return s?this._generateDefaultFieldColumn(s,{hidden:!0,orderByFields:n}):(this._logTemplateWarning("A valid 'field' could not be found for the provided template."),null)})).filter(C);return r.push(...o),this.attachmentsEnabled&&Skt(e)&&!r.some((t=>mkt(t)))&&r.push(this._generateDefaultAttachmentsColumn({hidden:!0})),this.relatedRecordsEnabled&&Mkt(e)&&e.relationships?.forEach((({id:t},e)=>{const i=this._relationshipInfos.find((e=>e.relationshipId===t));i&&!r.some((e=>pkt(e)&&e.relationshipId===t))&&r.push(this._generateDefaultRelationshipColumn({hidden:!0,info:i,index:e}))})),r.length?r:null}_generateColumnsFromAttributeTableElements(t,e){const{layer:i}=this;return i?t?.map(((t,i)=>{switch(t.type){case"field":return this._createFieldColumnFromElement({element:t,orderByFields:e});case"group":return this._createGroupColumnFromElement({element:t,orderByFields:e});case"attachment":return this._createAttachmentColumnFromElement({element:t,index:i});case"relationship":return this._createRelationshipColumnFromElement({element:t,index:i})}})).filter((t=>!!t))??[]:[]}_createFieldColumnFromElement(t){const{layer:e}=this;if(!e)return null;const{element:i,orderByFields:n}=t,{fieldName:s}=i;if(null==s)return this._logTemplateWarning("A valid 'fieldName' must be provided."),null;const r=jkt(e,s);if(!r)return this._logTemplateWarning("A valid 'field' could not be found for the provided template."),null;const{description:o,label:a}=i,l=n?.findIndex((({field:t})=>t&&t===s))??-1,u=l>-1?n?.at(l)?.order:void 0,c=l>-1?l:null,{editingEnabled:h,grid:d,messages:f,messagesCommon:p,messagesURIUtils:m,store:y,timeZone:g,view:v}=this;return new CEt({description:o,direction:u,field:r,fieldName:s,grid:d,initialSortPriority:c,label:a,layer:e,messages:f,messagesCommon:p,messagesURIUtils:m,store:y,tableEditingEnabled:h,tableTimeZone:g,view:v,onShowPromptCallback:this._onShowPromptCallback})}_createGroupColumnFromElement(t){const{element:e,orderByFields:i}=t,{description:n,label:s}=e;if(!s)return this._logTemplateWarning("Group columns require a label."),null;if(!e.elements.length)return this._logTemplateWarning("Group columns require child columns."),null;const{grid:r,messages:o,messagesCommon:a,messagesURIUtils:l,store:u,timeZone:c}=this;return new p$t({columns:this._generateColumnsFromAttributeTableElements(e.elements,i),description:n,grid:r,label:s,messages:o,messagesCommon:a,messagesURIUtils:l,store:u,tableTimeZone:c})}_createAttachmentColumnFromElement(t){if(!this.attachmentsEnabled)return void this._logTemplateWarning("The 'attachmentsEnabled' property is currently false.");const{element:e,index:i}=t,{description:n,label:s}=e,{grid:r,layer:o,messages:a,messagesCommon:l,messagesURIUtils:u,store:c,timeZone:h}=this;return new Gkt({description:n,fieldName:`${ykt.attachments}-${i}`,grid:r,label:s,layer:o,messages:a,messagesCommon:l,messagesURIUtils:u,store:c,tableTimeZone:h,onShowAttachments:t=>this._onShowAttachments(t)})}_createRelationshipColumnFromElement(t){if(!this.relatedRecordsEnabled)return void this._logTemplateWarning("Relationship columns require related records to be enabled on the table.");const{element:e,index:i}=t,{description:n,label:s,relationshipId:r}=e,o=this._relationshipInfos.find((t=>t.relationshipId===r));if(!o)return this._logTemplateWarning("Unable to find valid related layer target based on the provided relationship id."),null;const{grid:a,messages:l,messagesCommon:u,messagesURIUtils:c,store:h,timeZone:d}=this;return new OEt({description:n,fieldName:`${ykt.relationship}-${r}-${i}`,grid:a,label:s,messages:l,messagesCommon:u,messagesURIUtils:c,relationshipId:r,store:h,tableTimeZone:d,layer:o.relatedLayer,relatedLayer:o.layer,showRelatedTableCallback:t=>this._onShowRelatedTable(t)})}_generateColumnsFromColumnTemplates(t){const{editingEnabled:e,grid:i,layer:n,messages:s,messagesCommon:r,messagesURIUtils:o,store:a,timeZone:l,view:u}=this;if(!t?.length||!n)return null;const c=[];return t.forEach(((t,h)=>{const{autoWidth:d,description:f,direction:p,flexGrow:m,fieldName:y,formatFunction:g,frozen:v,frozenToEnd:w,icon:b,initialSortPriority:S,invalid:_,label:x,menuConfig:M,resizable:T,sortable:A,textAlign:I,textWrap:k,timeZone:C,type:E,width:j}=t;if(!E)return void this._logTemplateWarning("Property 'type' is missing from the provided template.");if(v&&w)return void this._logTemplateWarning("Properties 'frozen' and 'frozenToEnd' cannot both be true for the same column.");const O=!1===t.visible;if("group"===E){if(!t.columnTemplates?.length)return void this._logTemplateWarning("Group columns must contain column templates.");if(!t.label)return void this._logTemplateWarning("Group columns require a label.");const e=this._generateColumnsFromColumnTemplates(t.columnTemplates),n=O||this._isFieldHidden(t.label);c.push(new p$t({autoWidth:d,columns:e,description:f,flexGrow:m,frozen:v,frozenToEnd:w,grid:i,hidden:n,icon:b,invalid:_,label:x,menuConfig:M,messages:s,messagesCommon:r,messagesURIUtils:o,resizable:T,tableTimeZone:l,textAlign:I,textWrap:k,timeZone:C,width:j}))}else if("attachment"===E){if(!this.attachmentsEnabled)return void this._logTemplateWarning("Attachment columns require attachments to be enabled on the table.");c.push(this._generateAttachmentsColumnFromTemplate(t,h))}else if("relationship"===E){if(!this.relatedRecordsEnabled)return void this._logTemplateWarning("Relationship columns require related records to be enabled on the table.");const{relationshipId:e}=t;if(null==e)return void this._logTemplateWarning("Property 'relationshipId' is missing from the provided template.");const i=this._relationshipInfos.find((t=>t.relationshipId===e));if(!i)return void this._logTemplateWarning("Unable to find valid related layer target based on the provided relationship id.");c.push(this._generateRelationshipColumnFromTemplate(i,t,h))}else if(!y)return void this._logTemplateWarning("Value for 'fieldName' property was missing from the provided template.");const R=O||this._isFieldHidden(y);if("column"===E)c.push(new Pkt({autoWidth:d,description:f,direction:p,fieldName:y,flexGrow:m,formatFunction:g,frozen:v,frozenToEnd:w,grid:i,hidden:R,icon:b,initialSortPriority:S,invalid:_,label:x,menuConfig:M,messages:s,messagesCommon:r,messagesURIUtils:o,resizable:T,sortable:A,tableTimeZone:l,textAlign:I,textWrap:k,timeZone:C,width:j}));else if("field"===E){const h=jkt(n,t.fieldName);if(!h)return void this._logTemplateWarning("A valid 'field' could not be found for the provided template.");const{editable:y,required:E}=t;c.push(new CEt({autoWidth:d,description:f,direction:p,editable:y,field:h,fieldName:h.name,flexGrow:m,formatFunction:g,frozen:v,frozenToEnd:w,grid:i,hidden:R,icon:b,initialSortPriority:S,invalid:_,label:x,layer:n,messages:s,messagesCommon:r,messagesURIUtils:o,menuConfig:M,required:E,resizable:T,sortable:A,store:a,tableEditingEnabled:e,tableTimeZone:l,template:t,textAlign:I,textWrap:k,timeZone:C,width:j,view:u,onShowPromptCallback:this._onShowPromptCallback}))}})),c.length?c:null}_generateDefaultFieldColumns(){return this.layer?.fields?.map((t=>this._generateDefaultFieldColumn(t))).filter(C)??[]}_generateDefaultFieldColumn(t,e){const{editingEnabled:i,grid:n,layer:s,messages:r,messagesCommon:o,messagesURIUtils:a,store:l,timeZone:u,view:c}=this,h=e?.orderByFields;if(!t.visible||"geometry"===t.type)return null;const d=t.name,f=h?.findIndex((t=>t.field&&t.field===d)),p=null!=f?h?.at(f)?.order:null,m=null!=f&&f>-1?f:void 0;return new CEt({direction:p,field:t,fieldName:d,grid:n,hidden:e?.hidden||this._isFieldHidden(d),initialSortPriority:m,layer:s,messages:r,messagesCommon:o,messagesURIUtils:a,store:l,tableEditingEnabled:i,tableTimeZone:u,view:c,onShowPromptCallback:this._onShowPromptCallback})}_generateAttachmentsColumnFromTemplate(t,e){const{grid:i,layer:n,messages:s,messagesCommon:r,messagesURIUtils:o,store:a,timeZone:l}=this,{attachmentsViewEnabled:u,autoWidth:c,description:h,flexGrow:d,fieldName:f,formatFunction:p,frozen:m,frozenToEnd:y,icon:g,invalid:v,label:w,menuConfig:b,resizable:S,textAlign:_,textWrap:x,thumbnailAppearance:M,thumbnailCount:T,thumbnailIconScale:A,thumbnailsEnabled:I,timeZone:k,width:C}=t;return new Gkt({attachmentsViewEnabled:u,autoWidth:c,description:h,fieldName:`${ykt.attachments}-${e}`,flexGrow:d,formatFunction:p,frozen:m,frozenToEnd:y,grid:i,hidden:!1===t.visible||this._isFieldHidden(w)||this._isFieldHidden(f),icon:g,invalid:v,label:w,layer:n,menuConfig:b,messages:s,messagesCommon:r,messagesURIUtils:o,resizable:S,store:a,tableTimeZone:l,textAlign:_,textWrap:x,thumbnailAppearance:M,thumbnailCount:T,thumbnailIconScale:A,thumbnailsEnabled:I,timeZone:k,width:C,onShowAttachments:t=>this._onShowAttachments(t)})}_generateDefaultAttachmentsColumn(t){const{grid:e,layer:i,messages:n,messagesCommon:s,messagesURIUtils:r,store:o,timeZone:a}=this,l=ykt.attachments;return new Gkt({fieldName:l,grid:e,hidden:t?.hidden||this._isFieldHidden(l),layer:i,messages:n,messagesCommon:s,messagesURIUtils:r,store:o,tableTimeZone:a,onShowAttachments:t=>this._onShowAttachments(t)})}_generateRelationshipColumnFromTemplate(t,e,i){const{grid:n,messages:s,messagesCommon:r,messagesURIUtils:o,store:a,timeZone:l}=this,{autoWidth:u,collapsed:c,description:h,flexGrow:d,fieldName:f,formatFunction:p,frozen:m,frozenToEnd:y,icon:g,invalid:v,label:w,menuConfig:b,relationshipId:S,resizable:_,textAlign:x,textWrap:M,timeZone:T,width:A}=e;return new OEt({autoWidth:u,collapsed:c,description:h,fieldName:`${ykt.relationship}-${S}-${i}`,flexGrow:d,formatFunction:p,frozen:m,frozenToEnd:y,grid:n,hidden:!1===e.visible||this._isFieldHidden(w)||this._isFieldHidden(f),icon:g,invalid:v,label:w,menuConfig:b,messages:s,messagesCommon:r,messagesURIUtils:o,relationshipId:S,resizable:_,store:a,tableTimeZone:l,textAlign:x,textWrap:M,timeZone:T,width:A,layer:t.relatedLayer,relatedLayer:t.layer,showRelatedTableCallback:t=>this._onShowRelatedTable(t)})}_generateDefaultRelationshipColumns(){const{_relationshipInfos:t,relationshipColumnConfigs:e}=this,i=[];return t?.length?(e?e.forEach(((e,n)=>{const{relationshipId:s}=e,r=t.find((t=>t.relationshipId===s));r&&i.push(this._generateDefaultRelationshipColumn({config:e,index:n,info:r}))})):t.forEach(((t,e)=>i.push(this._generateDefaultRelationshipColumn({index:e,info:t})))),i):i}_generateDefaultRelationshipColumn(t){const{config:e,hidden:i,index:n,info:s}=t,{grid:r,messages:o,messagesCommon:a,messagesURIUtils:l}=this,{relationshipId:u}=s;return new OEt({...e,fieldName:`${ykt.relationship}-${u}-${n}`,grid:r,hidden:i,messages:o,messagesCommon:a,messagesURIUtils:l,layer:s.relatedLayer,relatedLayer:s.layer,relationshipId:u,showRelatedTableCallback:t=>this._onShowRelatedTable(t)})}_generateActionColumn(){return new $kt({hidden:this._isFieldHidden(ykt.action),...this.actionColumnConfig})}_isFieldHidden(t){const e=t?.toLowerCase();return(this.hiddenFields??this._defaultHiddenFields).some((t=>t.toLowerCase()===e))}_addTableHighlight(t){const{_highlightableLayerView:e,layer:i}=this;if(e&&i){const n=this.store.getItemByObjectId(t),s=n?.feature??t;this._highlights.add(e.highlight(s),`${i.id}-${t}`)}}_removeTableHighlight(t){const{layer:e}=this;e&&this._highlights.remove(`${e.id}-${t}`)}_syncSelection(){this._highlights.removeAll(),this._tableHighlightsReady?this.highlightIds.forEach((t=>this._addTableHighlight(t))):this._viewSelectionReady&&(this.highlightIds.items=this._viewSelection)}_appendToViewSelection(t){const{_selectableLayer:e}=this;e&&this._selectionManager?.appendToSelection(e,t)}_removeFromViewSelection(t){const{_selectableLayer:e}=this;e&&this._selectionManager?.removeFromSelection(e,t)}async _onHighlightIdsChange(t){const{added:e,removed:i}=t,{attachmentsViewOptions:n}=this;if(this._tableHighlightsReady?(i.forEach((t=>this._removeTableHighlight(t))),e.forEach((t=>this._addTableHighlight(t)))):this._viewSelectionReady&&(this._removeFromViewSelection(i),this._appendToViewSelection(e)),this.filterBySelectionEnabled&&this._syncObjectIdsWithStore(this.highlightIds.toArray()),null!=n.objectId){const t=this.highlightIds.at(0);if(null!=t){const e=await this.store.getAttachmentsByObjectId(t,!0);n.set({attachmentInfos:e,objectId:t,mode:e.length?"list":"file"})}}}_onShowRelatedTable(t){const{highlightIds:e}=this,{objectId:i}=t;e.removeAll(),e.add(i),this.showRelatedTableCallback?this.showRelatedTableCallback(t):this.emit("show-related-table",t)}_onObjectIdsChange(){const t=this.objectIds.toArray();t.length&&this.filterBySelectionEnabled&&(this.filterBySelectionEnabled=!1,this._logWarning("Object ID filter was applied while a selection filter was applied. Selection filter has been removed.")),this._syncObjectIdsWithStore(t)}_syncObjectIdsWithStore(t){this.store.objectIds=t,this.refreshPageCache()}_drainColumns(){this.columns.drain((t=>!t.destroyed&&t.destroy()))}_showAllRelatedTables(t){const e=t.layer;if(!e)return;const i=e.displayField||e.objectIdField;t.set({relationshipColumnConfigs:[],tableTemplateOverride:this._getTableTemplateForShowAllTablesView(t,i)});const n=t.hiddenFields;n.includes(ykt.action)||n.add(ykt.action),n.includes(ykt.attachments)||n.add(ykt.attachments)}_hideAllRelatedTables(t){const{layer:e,relationship:i}=t;if(e&&null!=i?.id)if(null!=t.attachmentsViewOptions.objectId){const e=t.layer?.displayField||t.layer?.objectIdField||"";t.set({multipleSelectionEnabled:!1,relationshipColumnConfigs:[],showAllRelatedTables:!1,tableTemplateOverride:this._getTableTemplateForAttachmentsView(e)})}else t.set({multipleSelectionEnabled:!0,relationshipColumnConfigs:Ckt(e,i.id),showAllRelatedTables:!1,tableTemplateOverride:null}),t.hiddenFields.removeMany([ykt.action,ykt.attachments])}_getTableTemplateForRelatedTableView(t,e,i){return new B$t({columnTemplates:[new R$t({fieldName:e,editable:!1,menuConfig:{selectionMode:"single",icon:"chevron-down",items:this._extractFieldColumnInfosFromTableTemplate(t.viewModel).map((([n,s])=>({selected:n===e,label:s||n,clickFunction:()=>{t.tableTemplateOverride=this._getTableTemplateForRelatedTableView(t,n,i)}})))},resizable:!1}),new N$t({autoWidth:!1,collapsed:!0,flexGrow:0,label:"",resizable:!1,relationshipId:i,width:G$t})]})}_getTableTemplateForShowAllTablesView(t,e){const i=[new R$t({fieldName:e,editable:!1,menuConfig:{selectionMode:"single",icon:"chevron-down",items:this._extractFieldColumnInfosFromTableTemplate(t.viewModel).map((([i,n])=>({selected:i===e,label:n||i,clickFunction:()=>{t.tableTemplateOverride=this._getTableTemplateForShowAllTablesView(t,i)}})))},resizable:!1})];return null!=t.attachmentsViewOptions.objectId&&i.push(new v$t({attachmentsViewEnabled:!1,autoWidth:!1,flexGrow:0,label:"",resizable:!1,thumbnailsEnabled:!1,width:G$t})),new B$t({columnTemplates:i})}async _onShowPromptCallback(t){const{column:e,objectId:i,oldValue:n,value:s}=t,{_subtypes:r,layer:o}=this;if(!o||!r.length)return void e.cancel();const a=r.find((t=>t.code===s));if(!a)return void e.cancel();const l=zs(),u=this._createSubtypeEditPrompt(n,a,l),c=!!o.parent;try{this.showPrompt(u);const t=await l.promise,n=[{fieldName:e.fieldName,value:s}];switch(t){case"update-fields":for(const[t,e]of Object.entries(a.defaultValues))null!=e&&n.push({fieldName:t,value:e});await e.updateItems({objectId:i,updates:n}),c&&this.refresh();break;case"keep-existing":await e.updateItems({objectId:i,updates:n}),c&&this.refresh();break;case"undo":e.cancel()}}finally{this.clearPrompt()}}_createSubtypeEditPrompt(t,e,i){const{_subtypes:n,messages:s,messagesCommon:r}=this,o=n.find((e=>e.code===t))?.name??`${t}`;let a="update-fields";const l=[{label:s.subtypes.useDefaultValuesOption,value:"update-fields"},{label:s.subtypes.keepCurrentValuesOption,value:"keep-existing"}];return{context:"info",title:s.subtypes.changeWarningTitle,message:Xg(s.subtypes.changeWarning,{originalType:o,newType:e.name}),radios:l,defaultRadioSelection:"update-fields",onRadioSelection:t=>{a=t},actions:{primary:{label:r.apply,action:()=>i.resolve(a),type:"positive"},secondary:{label:r.cancel,type:"neutral",action:()=>i.resolve("undo")}},cancel:()=>i.reject()}}_onShowAttachments({objectId:t}){this.attachmentsViewOptions.objectId=t}_getTableTemplateForAttachmentsView(t){return new B$t({columnTemplates:[new R$t({fieldName:t,editable:!1,menuConfig:{selectionMode:"single",icon:"chevron-down",items:this._extractFieldColumnInfosFromTableTemplate(this).map((([e,i])=>({selected:e===t,label:i||e,clickFunction:()=>{this.tableTemplateOverride=this._getTableTemplateForAttachmentsView(e)}})))},resizable:!1}),new v$t({attachmentsViewEnabled:!1,autoWidth:!1,flexGrow:0,label:"",resizable:!1,thumbnailsEnabled:!1,width:G$t})]})}_extractFieldColumnInfosFromTableTemplate(t){const e=t??this,{layer:i,tableTemplate:n}=e;return n?n.columnTemplates.filter((({type:t})=>"field"===t||"column"===t)).map((({fieldName:t,label:e})=>[t,e])):i?.fields.map((t=>[t.name,t.alias]))??[]}_getIndexOfFirstFrozenToEndColumn(){const t=this.columns.findIndex((t=>t.frozenToEnd));return t>-1?t:void 0}_logWarning(t,e){e?jt.getLogger(this).warnOnce(t):jt.getLogger(this).warn(t)}_logTemplateWarning(t){this._logWarning(`${t} Skipped generating a column using the provided template.`,!0)}_onCellInteraction(t){null!=t&&null!=this.attachmentsViewOptions.objectId&&this.highlightIds.add(t)}};r([Je()],V$t.prototype,"_defaultHiddenFields",null),r([Je()],V$t.prototype,"_effectiveTableTemplate",null),r([Je()],V$t.prototype,"_effectiveAttributeTableTemplate",null),r([Je()],V$t.prototype,"_highlights",void 0),r([Je()],V$t.prototype,"_highlightableLayerView",null),r([Je()],V$t.prototype,"_relationshipInfos",null),r([Je()],V$t.prototype,"_selectionManager",null),r([Je()],V$t.prototype,"_selectableLayer",null),r([Je()],V$t.prototype,"_subtypes",null),r([Je()],V$t.prototype,"_tableHighlightsReady",null),r([Je()],V$t.prototype,"_viewSelection",null),r([Je()],V$t.prototype,"_viewSelectionReady",null),r([Je()],V$t.prototype,"actionColumnConfig",void 0),r([Je()],V$t.prototype,"allRelatedTablesVisible",null),r([Je()],V$t.prototype,"activeFilters",null),r([Je({readOnly:!0})],V$t.prototype,"activeSortOrders",null),r([Je()],V$t.prototype,"attachmentsEnabled",null),r([Je()],V$t.prototype,"attachmentsViewOptions",void 0),r([Je({type:Qut})],V$t.prototype,"attributeTableTemplate",void 0),r([Je()],V$t.prototype,"autoRefreshEnabled",void 0),r([Je()],V$t.prototype,"clearPrompt",null),r([Je({readOnly:!0})],V$t.prototype,"columns",void 0),r([Je()],V$t.prototype,"dataProvider",void 0),r([Je()],V$t.prototype,"editingEnabled",void 0),r([Je()],V$t.prototype,"filterGeometry",null),r([Je()],V$t.prototype,"filterBySelectionEnabled",null),r([Je({readOnly:!0})],V$t.prototype,"grid",void 0),r([Je()],V$t.prototype,"hiddenFields",null),r([Je()],V$t.prototype,"highlightEnabled",void 0),r([Je()],V$t.prototype,"initialSize",null),r([Je()],V$t.prototype,"isQueryingOrSyncing",null),r([Je()],V$t.prototype,"isSyncingAttachments",null),r([Je({readOnly:!0})],V$t.prototype,"itemIdPath",void 0),r([Je()],V$t.prototype,"layer",null),r([Je()],V$t.prototype,"layerView",null),r([Je()],V$t.prototype,"messages",void 0),r([Je(),z3("esri/t9n/common")],V$t.prototype,"messagesCommon",void 0),r([Je(),z3("esri/core/t9n/Units")],V$t.prototype,"messagesUnits",void 0),r([Je(),z3("esri/widgets/support/t9n/uriUtils")],V$t.prototype,"messagesURIUtils",void 0),r([Je()],V$t.prototype,"outFields",null),r([Je()],V$t.prototype,"prompt",void 0),r([Je()],V$t.prototype,"relatedRecordsEnabled",null),r([Je()],V$t.prototype,"relatedTable",null),r([Je()],V$t.prototype,"relatedTables",void 0),r([Je()],V$t.prototype,"relationship",null),r([Je()],V$t.prototype,"relationshipColumnConfigs",void 0),r([Je()],V$t.prototype,"relationshipConfig",null),r([Je()],V$t.prototype,"relationships",null),r([Je()],V$t.prototype,"returnGeometryEnabled",null),r([Je()],V$t.prototype,"returnMEnabled",null),r([Je()],V$t.prototype,"returnZEnabled",null),r([Je()],V$t.prototype,"selectionSource",void 0),r([Je()],V$t.prototype,"showAllRelatedTables",null),r([Je()],V$t.prototype,"showPrompt",null),r([Je()],V$t.prototype,"showRelatedTableCallback",void 0),r([Je({readOnly:!0,type:E$t})],V$t.prototype,"store",void 0),r([Je()],V$t.prototype,"supportsAttachments",null),r([Je()],V$t.prototype,"supportsAddAttachments",null),r([Je()],V$t.prototype,"supportsDeleteAttachments",null),r([Je()],V$t.prototype,"supportsResizeAttachments",null),r([Je()],V$t.prototype,"supportsUpdateAttachments",null),r([Je()],V$t.prototype,"tableController",void 0),r([Je()],V$t.prototype,"tableParent",void 0),r([Je({type:B$t})],V$t.prototype,"tableTemplate",void 0),r([Je()],V$t.prototype,"tableTemplateOverride",void 0),r([Je()],V$t.prototype,"timeExtent",null),r([Je()],V$t.prototype,"timeZone",null),r([Je()],V$t.prototype,"view",null),V$t=r([ln("esri.widgets.FeatureTable.FeatureTableViewModel")],V$t);const q$t=V$t;let H$t=class extends ao{constructor(t){super(t),this.clearSelection=!0,this.deleteSelection=!0,this.exportSelectionToCSV=!0,this.refreshData=!0,this.selectedRecordsShowAllToggle=!0,this.selectedRecordsShowSelectedToggle=!0,this.toggleColumns=!0,this.zoomToSelection=!0}};r([Je({type:Boolean,nonNullable:!0})],H$t.prototype,"clearSelection",void 0),r([Je({type:Boolean,nonNullable:!0})],H$t.prototype,"deleteSelection",void 0),r([Je({type:Boolean,nonNullable:!0})],H$t.prototype,"exportSelectionToCSV",void 0),r([Je({type:Boolean,nonNullable:!0})],H$t.prototype,"refreshData",void 0),r([Je({type:Boolean,nonNullable:!0})],H$t.prototype,"selectedRecordsShowAllToggle",void 0),r([Je({type:Boolean,nonNullable:!0})],H$t.prototype,"selectedRecordsShowSelectedToggle",void 0),r([Je({type:Boolean,nonNullable:!0})],H$t.prototype,"toggleColumns",void 0),r([Je({type:Boolean,nonNullable:!0})],H$t.prototype,"zoomToSelection",void 0),H$t=r([ln("esri.widgets.FeatureTable.TableMenuVisibleElements")],H$t);const W$t=H$t;let Z$t=class extends ao{constructor(t){super(t),this.columnDescriptions=!0,this.columnMenus=!0,this.columnMenuItems=new lkt,this.close=!1,this.header=!0,this.layerDropdown=!1,this.menu=!0,this.menuItems=new W$t,this.progress=!0,this.selectionColumn=!0,this.tooltips=!0}};r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"columnDescriptions",void 0),r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"columnMenus",void 0),r([Je({type:lkt,nonNullable:!0})],Z$t.prototype,"columnMenuItems",void 0),r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"close",void 0),r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"header",void 0),r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"layerDropdown",void 0),r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"menu",void 0),r([Je({type:W$t,nonNullable:!0})],Z$t.prototype,"menuItems",void 0),r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"progress",void 0),r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"selectionColumn",void 0),r([Je({type:Boolean,nonNullable:!0})],Z$t.prototype,"tooltips",void 0),Z$t=r([ln("esri.widgets.FeatureTable.VisibleElements")],Z$t);const J$t=Z$t;var Y$t;const K$t="esri-feature-table",Q$t=`${K$t}__prompt`,X$t=`${K$t}__attachments-view`,tzt={base:K$t,content:`${K$t}__content`,menuPopover:`${K$t}__menu-popover`,layerDropdownMenu:`${K$t}__layer-switcher-menu`,tableContainer:`${K$t}__table-container`,tableContainerWithAttachments:`${K$t}__table-container--attachments`,tableNavigation:`${K$t}__table-navigation`,attachmentsView:X$t,attachmentsViewContent:`${X$t}__content`,attachmentsViewDropArea:`${X$t}__drop-area`,attachmentsViewIcon:`${X$t}__icon`,attachmentsViewInformation:`${X$t}__information`,attachmentsViewList:`${X$t}__list`,attachmentsViewListFileSize:`${X$t}__list__filesize`,attachmentsViewListItemDelete:`${X$t}__list-item--delete`,attachmentsViewListThumbnail:`${X$t}__list__thumbnail`,expanded:`${K$t}__expanded`,collapsed:`${K$t}__collapsed`,promptContainer:Q$t,promptHeader:`${Q$t}__header`,promptHeading:`${Q$t}__header__heading`,promptMessage:`${Q$t}__message`,promptDivider:`${Q$t}__divider`,promptActions:`${Q$t}__actions`},ezt={attachment:"attachment",chevronDown:"chevron-down",chevronLeft:"chevron-left",chevronRight:"chevron-right",clearSelection:"clear-selection",downloadTo:"download-to",exclamationMarkTriangle:"exclamation-mark-triangle",exportToCSV:"file-csv",folderOpen:"folder-open",delete:"trash",launch:"launch",layers:"layers",moveUp:"move-up",plus:"plus",refresh:"refresh",replaceImage:"replace-image",save:"save",showAll:"selection-x",showColumn:"show-column",showSelected:"selection-filter",upload:"upload",zoomToSelection:"zoom-to-object"};let izt=Y$t=class extends A3{constructor(t,e){super(t,e),this._attachmentsInput=null,this._columnVisibilityActions=new Map,this.attachmentsList=null,this.description=null,this.disabled=!1,this.layers=null,this.menuConfig=null,this.title=null,this.viewModel=new q$t,this.visibleElements=new J$t,this._showDeletePrompt=this._showDeletePrompt.bind(this),this._onDeleteSelectionClick=this._onDeleteSelectionClick.bind(this)}initialize(){this.addHandles([ey((()=>[this.viewModel.store.querying,this.viewModel.store.syncing,this.editingEnabled]),(()=>this.scheduleRender())),ey((()=>[this._effectiveVisibleElements,this._effectiveVisibleElements.columnDescriptions,this._effectiveVisibleElements.columnMenus,this._effectiveVisibleElements.columnMenuItems,this.columns.length]),(()=>{this.columns.forEach((t=>t.visibleElements=this._effectiveVisibleElements)),this.refreshCellContent()}),hy),ey((()=>this._effectiveVisibleElements.selectionColumn),(t=>{this.grid&&(this.grid.selectionColumnEnabled=t)}),dy),sy((()=>this.viewModel),"show-related-table",(t=>this._onShowRelatedTable(t)))])}loadDependencies(){return Promise.all([o3({action:()=>import("./p-255edeba.js"),alert:()=>import("./p-840e091c.js"),button:()=>import("./p-5b44be17.js"),chip:()=>import("./p-b8acd634.js"),dropdown:()=>import("./p-b0fc8730.js"),"dropdown-group":()=>import("./p-038de826.js"),"dropdown-item":()=>import("./p-814492c7.js"),icon:()=>import("./p-a8caa0f1.js"),label:()=>import("./p-6fa88b99.js"),list:()=>import("./p-4bdb39fa.js"),"list-item":()=>import("./p-0b8be892.js"),pagination:()=>import("./p-384f3161.js"),panel:()=>import("./p-0dfbea12.js"),popover:()=>import("./p-fd16e356.js"),progress:()=>import("./p-4f69a2ef.js"),switch:()=>import("./p-19ab385b.js"),tooltip:()=>import("./p-c63113ff.js")}),skt(),wkt()])}destroy(){this.drainRelatedTables(),this.clearPrompt()}get _effectiveDescription(){const{description:t}=this;return null!=t?ux.sanitize("function"==typeof t?t():t):void 0}get _effectiveLayers(){const{layer:t,layers:e}=this,i=e?.length?e.filter(bkt):[],n=i.length?i:[...this._viewLayers];return t&&!n.includes(t)&&n.push(t),n}get _effectiveTitle(){const{layer:t,messages:e,state:i,highlightIds:n,title:s,size:r}=this;if(s)return ux.sanitize("function"==typeof s?s():s);if(!t)return e.noLayer;switch(i){case"disabled":return e.errorLayer;case"ready":case"loading":return e.loading;case"error":return e.errorData}return Xg(e.header,{title:ux.sanitize(t.title),count:r,selected:n.length})}get _effectiveVisibleElements(){return this.visibleElementsOverride??this.visibleElements}get _filteredTables(){const t=this.relatedTables.toArray(),e=1===t.length;return this.allRelatedTablesVisible?t:e?[t[0]]:this._shouldShowAttachmentsView?t.slice(-1):t.slice(-2)}get _hasAttachmentsViewError(){return null!=this.attachmentsViewOptions.error}get _hasCustomMenuItems(){return!!this.menuConfig?.items?.length}get _hasDefaultMenuItems(){return!!(this._showClearSelectionAction||this._showDeleteSelectionAction||this._showExportSelectionToCSVAction||this._showRefreshDataAction||this._showZoomToSelectionAction||this._showSelectedRecordsShowSelectedAction||this._showSelectedRecordsShowAllAction||this._showColumnsVisibilityAction)}get _shouldShowGrid(){return this.allRelatedTablesVisible||1===this.relatedTables.length&&!this._shouldShowAttachmentsView}get _shouldShowMenu(){const{header:t,menu:e}=this._effectiveVisibleElements;return!(!t||!e||!this._hasDefaultMenuItems&&!this._hasCustomMenuItems)}get _shouldShowAttachmentsView(){return!(null==this.attachmentsViewOptions.objectId&&!this.relatedTables.some((t=>null!=t.attachmentsViewOptions.objectId)))}get _showClearSelectionAction(){return!(!this.highlightIds.length||!this._effectiveVisibleElements.menuItems?.clearSelection||this.relatedTables.length)}get _showColumnsVisibilityAction(){const{header:t,menu:e,menuItems:i}=this._effectiveVisibleElements;return!(!(t&&e&&i?.toggleColumns)||this.showRelatedTableCallback||this.allRelatedTablesVisible||this._shouldShowAttachmentsView)}get _showDeleteSelectionAction(){return!(!(this.editingEnabled&&this.highlightIds.length&&this._effectiveVisibleElements.menuItems?.deleteSelection&&this.layer?.capabilities?.operations?.supportsDelete)||this.relatedTables.length)}get _showExportSelectionToCSVAction(){return!(!(this._effectiveVisibleElements.menuItems.exportSelectionToCSV&&this.layer&&this.highlightIds.length)||this.relatedTables.length)}get _showLayerDropdown(){return!(!this._effectiveLayers.length||!this._effectiveVisibleElements.layerDropdown)}get _shouldShowNavigationBar(){const t=!!this.relatedTable||this._shouldShowAttachmentsView;return!this.tableParent&&t}get _showRefreshDataAction(){return!!this._effectiveVisibleElements.menuItems?.refreshData}get _showSelectedRecordsShowSelectedAction(){const t=this.objectIds.length,e=this.highlightIds.length;return!(!e||!this._effectiveVisibleElements.menuItems?.selectedRecordsShowSelectedToggle||t&&e===t||this.relatedTables.length)}get _showSelectedRecordsShowAllAction(){return!(!this._effectiveVisibleElements.menuItems?.selectedRecordsShowAllToggle||!this.objectIds.length||this.relatedTables.length)}get _showZoomToSelectionAction(){return!(!this.view||!this.highlightIds.length||this.effectiveTable.layer?.isTable||!this._effectiveVisibleElements.menuItems?.zoomToSelection)}get _viewLayers(){const t=this.view?.map;if(!t)return[];const e=new Set,i=t=>{!bkt(t)||HT(t)||e.has(t)||e.add(t)},n=t=>{HA(t)||"catalog-footprint"===t.type||(VT(t)?(t.layers?.forEach(i),t.tables?.forEach(i)):Tkt(t)?(t.sublayers?.forEach(i),t.subtables?.forEach(i)):HT(t)?t.sublayers?.forEach(i):i(t))};return t.allLayers.forEach(n),t.allTables.forEach(n),[...e.values()]}get grid(){return this.viewModel.grid}get actionColumnConfig(){return this.viewModel.actionColumnConfig}set actionColumnConfig(t){this.viewModel.actionColumnConfig=t}get activeFilters(){return this.viewModel.activeFilters}get activeSortOrders(){return this.viewModel.activeSortOrders}get allColumns(){return this.viewModel.allColumns}get allRelatedTablesVisible(){return this.viewModel.allRelatedTablesVisible}get attachmentsEnabled(){return this.viewModel.attachmentsEnabled}set attachmentsEnabled(t){this.viewModel.attachmentsEnabled=t}get attachmentsViewOptions(){return this.viewModel.attachmentsViewOptions}set attachmentsViewOptions(t){this.viewModel.attachmentsViewOptions=t}get attributeTableTemplate(){return this.viewModel.attributeTableTemplate}set attributeTableTemplate(t){this.viewModel.attributeTableTemplate=t}get autoRefreshEnabled(){return this.viewModel.autoRefreshEnabled}set autoRefreshEnabled(t){this.viewModel.autoRefreshEnabled=t}get clearPrompt(){return this.viewModel.clearPrompt}set clearPrompt(t){this.viewModel.clearPrompt=t}get columnPerformanceModeEnabled(){return this.viewModel.columnPerformanceModeEnabled}set columnPerformanceModeEnabled(t){this.viewModel.columnPerformanceModeEnabled=t}get columnReorderingEnabled(){return this.viewModel.columnReorderingEnabled}set columnReorderingEnabled(t){this.viewModel.columnReorderingEnabled=t}get columns(){return this.viewModel.columns}get editingEnabled(){return this.viewModel.editingEnabled}set editingEnabled(t){this.viewModel.editingEnabled=t}get effectiveSize(){return this.viewModel.effectiveSize}get effectiveTable(){return this.relatedTable||this}get filterGeometry(){return this.viewModel.filterGeometry}set filterGeometry(t){this.viewModel.filterGeometry=t}get filterBySelectionEnabled(){return this.viewModel.filterBySelectionEnabled}set filterBySelectionEnabled(t){this.viewModel.filterBySelectionEnabled=t}get hiddenFields(){return this.viewModel.hiddenFields}set hiddenFields(t){this.viewModel.hiddenFields=t}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(t){this.viewModel.highlightEnabled=t}get highlightIds(){return this.viewModel.highlightIds}set highlightIds(t){this.viewModel.highlightIds=t}get icon(){return"table"}set icon(t){this._overrideIfSome("icon",t)}get initialSize(){return this.viewModel.initialSize}set initialSize(t){this.viewModel.initialSize=t}get isQueryingOrSyncing(){return this.viewModel.isQueryingOrSyncing}get isSyncingAttachments(){return this.viewModel.isSyncingAttachments}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get layer(){return this.viewModel.layer}set layer(t){this.viewModel.layer=t}get layerView(){return this.viewModel.layerView}get maxSize(){return this.viewModel.maxSize}set maxSize(t){this.viewModel.maxSize=t}get messages(){return this.viewModel.messages}set messages(t){this.viewModel.messages=t}get messagesCommon(){return this.viewModel.messagesCommon}set messagesCommon(t){this.viewModel.messagesCommon=t}get messagesUnits(){return this.viewModel.messagesUnits}set messagesUnits(t){this.viewModel.messagesUnits=t}get messagesURIUtils(){return this.viewModel.messagesURIUtils}set messagesURIUtils(t){this.viewModel.messagesURIUtils=t}get multipleSelectionEnabled(){return this.viewModel.multipleSelectionEnabled}set multipleSelectionEnabled(t){this.viewModel.multipleSelectionEnabled=t}get multiSortEnabled(){return this.viewModel.multiSortEnabled}set multiSortEnabled(t){this.viewModel.multiSortEnabled=t}get objectIds(){return this.viewModel.objectIds}set objectIds(t){this.viewModel.objectIds=t}get outFields(){return this.viewModel.outFields}set outFields(t){this.viewModel.outFields=t}get pageCount(){return this.viewModel.pageCount}get pageIndex(){return this.viewModel.pageIndex}set pageIndex(t){this.viewModel.pageIndex=t}get pageSize(){return this.viewModel.pageSize}set pageSize(t){this.viewModel.pageSize=t}get paginationEnabled(){return this.viewModel.paginationEnabled}set paginationEnabled(t){this.viewModel.paginationEnabled=t}get prompt(){return this.viewModel.prompt}set prompt(t){this.viewModel.prompt=t}get relatedRecordsEnabled(){return this.viewModel.relatedRecordsEnabled}set relatedRecordsEnabled(t){this.viewModel.relatedRecordsEnabled=t}get relatedTable(){return this.viewModel.relatedTable}get relatedTables(){return this.viewModel.relatedTables}set relatedTables(t){this.viewModel.relatedTables=t}get relationship(){return this.viewModel.relationship}get relationshipColumnConfigs(){return this.viewModel.relationshipColumnConfigs}set relationshipColumnConfigs(t){this.viewModel.relationshipColumnConfigs=t}get relationshipConfig(){return this.viewModel.relationshipConfig}set relationshipConfig(t){this.viewModel.relationshipConfig=t}get returnGeometryEnabled(){return this.viewModel.returnGeometryEnabled}set returnGeometryEnabled(t){this.viewModel.returnGeometryEnabled=t}get returnMEnabled(){return this.viewModel.returnMEnabled}set returnMEnabled(t){this.viewModel.returnMEnabled=t}get returnZEnabled(){return this.viewModel.returnZEnabled}set returnZEnabled(t){this.viewModel.returnZEnabled=t}get rowHighlightIds(){return this.viewModel.rowHighlightIds}set rowHighlightIds(t){this.viewModel.rowHighlightIds=t}get selectionSource(){return this.viewModel.selectionSource}set selectionSource(t){this.viewModel.selectionSource=t}get showAllRelatedTables(){return this.viewModel.showAllRelatedTables}set showAllRelatedTables(t){this.viewModel.showAllRelatedTables=t}get showPrompt(){return this.viewModel.showPrompt}set showPrompt(t){this.viewModel.showPrompt=t}get showRelatedTableCallback(){return this.viewModel.showRelatedTableCallback}set showRelatedTableCallback(t){this.viewModel.showRelatedTableCallback=t}get size(){return this.viewModel.size}get state(){return this.viewModel.state}get tableController(){return this.viewModel.tableController}set tableController(t){this.viewModel.tableController=t}get tableParent(){return this.viewModel.tableParent}set tableParent(t){this.viewModel.tableParent=t}get tableTemplate(){return this.viewModel.tableTemplate}set tableTemplate(t){this.viewModel.tableTemplate=t}get tableTemplateOverride(){return this.viewModel.tableTemplateOverride}set tableTemplateOverride(t){this.viewModel.tableTemplateOverride=t}get timeExtent(){return this.viewModel.timeExtent}set timeExtent(t){this.viewModel.timeExtent=t}get timeZone(){return this.viewModel.timeZone}set timeZone(t){this.viewModel.timeZone=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get visibleElementsOverride(){const{attachmentsViewOptions:t,relatedTable:e,tableController:i,visibleElements:n}=this,{columnDescriptions:s,columnMenus:r,tooltips:o}=n,a=null!=t.objectId;if(e)return new J$t({columnDescriptions:s,columnMenus:r,tooltips:o,close:n.close,header:n.header,layerDropdown:n.layerDropdown,menu:n.menu,menuItems:n.menuItems,progress:n.progress,selectionColumn:!1,columnMenuItems:new lkt({sortAscending:!1,sortDescending:!1})});if(i){const t=i.relatedTable===this,e=i.allRelatedTablesVisible,l=t&&n.selectionColumn&&!e&&!a,u=t&&!e&&!a;return new J$t({columnDescriptions:s,columnMenus:r,tooltips:o,selectionColumn:l,close:!1,header:!1,layerDropdown:!1,menu:!1,progress:!1,columnMenuItems:new lkt({sortAscending:u,sortDescending:u})})}return a?new J$t({columnDescriptions:s,columnMenus:r,tooltips:o,close:n.close,header:n.header,layerDropdown:n.layerDropdown,menu:n.menu,menuItems:n.menuItems,progress:n.progress,selectionColumn:!1,columnMenuItems:new lkt({sortAscending:!1,sortDescending:!1})}):null}clearSelectionFilter(){this.viewModel.clearSelectionFilter()}async deleteAttachments(t,e,i){null!=t&&e?.length&&(i?this._showDeleteAttachmentPrompt(t,e):await this.viewModel.deleteAttachments(t,e))}deleteSelection(t){return this.highlightIds.length?t?(this._showDeletePrompt(),this.scheduleRender(),Promise.resolve()):this.viewModel.deleteSelection():Promise.resolve()}async downloadAttachmentById(t,e){return this.viewModel.downloadAttachmentById(t,e)}drainRelatedTables(){this.viewModel.drainRelatedTables()}exportSelectionToCSV(t){this.viewModel.exportSelectionToCSV(t)}filterBySelection(){this.viewModel.filterBySelection()}findColumn(t){return this.viewModel.findColumn(t)}goToPage(t){this.viewModel.goToPage(t)}hideColumn(t){this.grid?.hideColumn(t)}nextPage(){this.viewModel.nextPage()}previousPage(){this.viewModel.previousPage()}async refresh(){await this.viewModel.refresh()}refreshCellContent(){this.viewModel.refreshCellContent()}async saveAttachmentsViewForm(){await this.viewModel.saveAttachmentsViewForm()}showAllColumns(){this.viewModel.showAllColumns()}showColumn(t){this.grid?.showColumn(t)}sortColumn(t,e){this.viewModel.sortColumn(t,e)}scrollLeft(){this.viewModel.scrollLeft()}scrollToBottom(){this.viewModel.scrollToBottom()}scrollToIndex(t){this.viewModel.scrollToIndex(t)}scrollToRow(t){this.viewModel.scrollToRow(t)}scrollToTop(){this.viewModel.scrollToTop()}toggleColumnVisibility(t){this.viewModel.toggleColumnVisibility(t)}zoomToSelection(){this.effectiveTable.viewModel.zoomToSelection()}render(){const{_effectiveVisibleElements:t,isQueryingOrSyncing:e,menuConfig:i,state:n}=this;return V3("div",{bind:this,class:this.classes(tzt.base,P3.widget)},V3("calcite-panel",{bind:this,class:tzt.content,closable:t.close,description:this._effectiveDescription,disabled:this.disabled||"disabled"===n&&!this._effectiveLayers?.length,heading:t.header?this._effectiveTitle:void 0,loading:"loading"===n,menuOpen:!!i?.open,overlayPositioning:"fixed",onCalcitePanelClose:t=>{t.target.closed=!1,this.emit("close")}},t.progress?V3("calcite-progress",{type:e?"indeterminate":"determinate"}):null,this._showLayerDropdown?this._renderLayerDropdown():null,this._renderColumnVisibilityAction(),this._renderHeaderMenuActions(),this._renderNavigationBar(),this._renderTables(),this._renderError()),this._renderPrompt())}_renderTables(){const{grid:t,relatedTables:e}=this,i=this.classes(tzt.tableContainer);if(e.length){const n=this.classes(tzt.base,this.allRelatedTablesVisible?tzt.expanded:tzt.collapsed,this._shouldShowAttachmentsView?tzt.tableContainerWithAttachments:void 0);return V3("div",{class:i},V3("calcite-panel",{overlayPositioning:"fixed"},V3("div",null,[this._shouldShowGrid?V3("div",{class:n},t?.render(),this._renderPagination()):void 0,...this._filteredTables.map((t=>{const i=e.indexOf(t);return V3("div",{class:n,key:`related-${i}`},t.render())})),,])))}return null!=this.attachmentsViewOptions.objectId?V3("div",{class:i},V3("calcite-panel",{overlayPositioning:"fixed"},V3("div",null,[V3("div",{class:this.classes(tzt.base,tzt.collapsed)},t?.render(),this._renderPagination()),this._renderAttachmentsView()]))):[V3("div",{class:i},t?.render()),this._renderPagination()]}_renderPagination(){if(this.paginationEnabled)return V3("calcite-pagination",{pageSize:1,startItem:this.pageIndex+1,totalItems:this.pageCount,onCalcitePaginationChange:t=>this.goToPage(t.target.startItem-1)})}_renderError(){const{messages:t}=this;return V3("calcite-alert",{autoClose:!0,autoCloseDuration:"fast",icon:ezt.exclamationMarkTriangle,kind:"danger",label:t.errorOccured,open:this._hasAttachmentsViewError,slot:"alerts",onCalciteAlertClose:()=>{this.attachmentsViewOptions.error=null}},V3("span",{slot:"message"},t.errorOccured))}_renderPrompt(){return this.prompt?V3(rkt,{...this.prompt,headingLevel:2}):void 0}_showDeletePrompt(){const{messages:t,messagesCommon:e}=this,i=Xg(t.deleteSelectionCount,{count:this.highlightIds.length});this.showPrompt({title:i,message:t.deleteRecordsRemoved,context:"danger",actions:{primary:{label:e.delete,action:this._onDeleteSelectionClick},secondary:{label:t.keepRecords,action:()=>this.clearPrompt()}}})}_showDeleteAttachmentPrompt(t,e){const{messages:i,messagesCommon:n}=this,s=Xg(i.deleteAttachmentCount,{count:e.length});this.showPrompt({title:s,message:i.deleteAttachmentConfirmation,context:"danger",actions:{primary:{label:n.delete,action:async()=>{try{await this.deleteAttachments(t,e,!1)}finally{this.clearPrompt()}}},secondary:{label:n.cancel,action:()=>this.clearPrompt()}}})}async _onDeleteSelectionClick(){try{await this.viewModel.deleteSelection()}finally{this.clearPrompt()}}_renderHeaderMenuAction(t){const{disabled:e,hidden:i,icon:n,text:s,clickFunction:r}=t;if(!i)return V3("calcite-action",{disabled:e??this.menuConfig?.disabled,icon:n??void 0,key:s,onclick:()=>r(),slot:"header-menu-actions",text:s,textEnabled:!0,title:s})}_renderHeaderMenuActions(){return this._shouldShowMenu?[this._renderDefaultHeaderMenuActions(),this._renderCustomHeaderMenuActions()]:[]}_renderDefaultHeaderMenuActions(){if(!this._hasDefaultMenuItems)return[];const{messages:t}=this;return[this._showRefreshDataAction&&{icon:ezt.refresh,text:t.refreshData,clickFunction:()=>this.refresh()},this._showDeleteSelectionAction&&{icon:ezt.delete,text:t.deleteSelection,clickFunction:()=>this.deleteSelection(!0)},this._showClearSelectionAction&&{icon:ezt.clearSelection,text:t.clearSelection,clickFunction:()=>this.highlightIds?.removeAll()},this._showZoomToSelectionAction&&{icon:ezt.zoomToSelection,text:t.zoomToSelection,clickFunction:()=>this.zoomToSelection()},this._showSelectedRecordsShowSelectedAction&&{icon:ezt.showSelected,text:t.showSelected,clickFunction:()=>{const{objectIds:t}=this;t.removeAll(),t.addMany(this.highlightIds.toArray())}},this._showSelectedRecordsShowAllAction&&{icon:ezt.showAll,text:t.showAllRecords,clickFunction:()=>this.objectIds.removeAll()},this._showExportSelectionToCSVAction&&{icon:ezt.exportToCSV,text:t.exportSelectionCSV,clickFunction:()=>this.exportSelectionToCSV()}].filter(C).map((t=>t&&this._renderHeaderMenuAction(t)))}_renderCustomHeaderMenuActions(){return this.menuConfig?.items?.map((({disabled:t,hidden:e,icon:i,label:n,clickFunction:s})=>this._renderHeaderMenuAction({hidden:"function"==typeof e?e():e,icon:i,text:n,disabled:t,clickFunction:t=>s(t)})))??[]}_renderColumnVisibilityAction(){if(!this._showColumnsVisibilityAction)return[];const{_columnVisibilityActions:t,_effectiveVisibleElements:e,effectiveTable:i,id:n,messages:s}=this,r=i.columns.toArray(),o=s?.toggleColumns,a=`${n}__toggle-columns-action`,l=[V3("calcite-action",{afterCreate:e=>t.set(n,e),afterRemoved:()=>t.delete(n),appearance:"transparent",bind:this,disabled:i.menuConfig?.disabled,icon:ezt.showColumn,id:a,slot:"header-actions-end",text:o},e.tooltips?V3("calcite-tooltip",{closeOnClick:!0,overlayPositioning:"fixed",placement:"bottom-end",slot:"tooltip"},o):null)];return i.menuConfig?.disabled||l.push(V3("calcite-popover",{autoClose:!0,class:tzt.menuPopover,label:o,overlayPositioning:"fixed",placement:"top-end",pointerDisabled:!0,referenceElement:t.get(n)},V3("calcite-list",{filterEnabled:!0,filterPlaceholder:s.toggleColumns,selectionMode:"multiple"},...r.map((t=>{const e="columns"in t&&t.columns?.length?t.columns.map((t=>this._renderColumnListItem({column:t,table:i,ignoreSelect:!0}))):void 0;return this._renderColumnListItem({column:t,table:i,items:e})}))))),l}_renderColumnListItem(t){const{column:e,table:i,items:n,ignoreSelect:s}=t,{effectiveLabel:r,fieldName:o,hidden:a}=e;return V3("calcite-list-item",{key:`toggle-columns__item-${o}`,label:r,open:!(!n?.length||a)||void 0,selected:!a,value:o,onCalciteListItemSelect:t=>{s||i.toggleColumnVisibility(t.target.value)}},n)}_renderLayerDropdown(){const t=this.messages.selectALayer;return V3("div",{class:tzt.layerDropdownMenu,key:`${this.id}-layerDropdown`,slot:"header-actions-start"},V3("calcite-dropdown",{bind:this,maxItems:5,overlayPositioning:"fixed",placement:"bottom-start"},V3("calcite-action",{icon:ezt.layers,slot:"trigger",text:t,title:t}),V3("calcite-dropdown-group",{selectionMode:"single"},this._effectiveLayers.map(((t,e)=>this._renderLayerDropdownItem(t,e)))??null)))}_renderLayerDropdownItem(t,e){return V3("calcite-dropdown-item",{key:`dropdown-item-${e}`,label:t.title??"",selected:t===this.layer,value:t.id,onCalciteDropdownItemSelect:()=>{this.layer=t}},t.title)}_onRelatedNavigationItemClick(t){this.viewModel.drainRelatedTablesAboveIndex(t)}_collapseRelatedTable(t){this.viewModel.collapseRelatedTable(this.effectiveTable,t)}_onShowRelatedTable(t){this.showRelatedTableCallback||(this._collapseRelatedTable(t),this._createRelatedTable(t))}async _createRelatedTable(t){const{editingEnabled:e,effectiveTable:i,paginationEnabled:n,pageSize:s,view:r,viewModel:o}=this,{layer:a,objectId:l,relatedLayer:u,relationshipId:c}=t;await a.load();const h=this.attachmentsEnabled&&Skt(a),d=new Y$t({layer:a,attachmentsEnabled:h,editingEnabled:e,paginationEnabled:n,pageSize:s,relatedRecordsEnabled:!0,relationshipConfig:{objectId:l,relatedLayer:u,relationshipId:c},relationshipColumnConfigs:Ckt(a,c),tableController:this,tableParent:i,view:r,showRelatedTableCallback:t=>o.emit("show-related-table",t)});this.relatedTables.add(d),this.scheduleRender()}_renderAttachmentsView(){const{attachmentInfos:t,mode:e,objectId:i}=this.attachmentsViewOptions;return"file"!==e&&t.length&&null!=i?this._renderAttachmentsViewList():this._renderAttachmentsViewFilePane()}_renderAttachmentsViewFilePane(){const{attachmentsViewOptions:t,isSyncingAttachments:e,messages:i,messagesUnits:n,viewModel:{supportsAddAttachments:s}}=this,{attachmentId:r,attachmentInfos:o,candidates:a,objectId:l}=t,u=o.find((t=>t.id===r)),c=o.length,h=a?.length,d=u?V3("calcite-label",{alignment:"center",key:"replace-file-node",scale:"l"},i.replaceFile):void 0,f=h?void 0:V3("calcite-label",{alignment:"center",key:"message-node",scale:"m"},s?null==l?i.noFeature:i.dragAndDropToUpload:i.editingRestricted),p=Array.from(a??[]).pop(),m=p?V3("calcite-label",{key:"filename-node"},p.name):void 0,y=s&&null!=l,g=y&&h,v=V3("input",{afterCreate:rx,afterRemoved:sx,afterUpdate:rx,bind:this,"data-node-ref":"_attachmentsInput",files:a,hidden:!0,name:"attachment",onchange:t=>this._onAttachmentsViewCandidateChange(t),type:"file"}),w=y?V3("calcite-button",{appearance:"outline-fill",bind:this,disabled:e,iconStart:ezt.folderOpen,key:"select-node",loading:!1,onclick:()=>{this._attachmentsInput?.click()},width:"full"},i.selectFile):void 0,b=g?V3("calcite-button",{appearance:"outline-fill",bind:this,disabled:e,iconStart:ezt.save,key:"save-node",loading:e,onclick:()=>{this.saveAttachmentsViewForm()},width:"full"},u?i.updateAttachment:i.addAttachment):void 0,S=c||h?V3("calcite-button",{appearance:"transparent",bind:this,disabled:e,key:"cancel-node",onclick:()=>{this._attachmentsInput&&(this._attachmentsInput.value=""),t.reset(),t.attachmentInfos?.length&&(t.mode="list")},width:"full"},this.messagesCommon.cancel):void 0;return[V3("div",{class:tzt.attachmentsView,key:"attachments-view"},V3("div",{class:tzt.attachmentsViewContent,key:"attachments-view-content"},V3("div",{bind:this,class:tzt.attachmentsViewDropArea,ondragover:t=>t.preventDefault(),ondrop:this._onAttachmentsViewDrop},V3("calcite-icon",{class:tzt.attachmentsViewIcon,icon:ezt.upload,scale:"l"}),d,f,V3("form",{afterCreate:e=>t.form=e,afterRemoved:()=>t.form=null,bind:this,key:"attachments-form"},V3("fieldset",null,m,v,w,b,S)))),null!=l&&null!=u?V3("div",{class:tzt.attachmentsViewInformation,key:"information"},this._renderAttachmentsViewThumbnail(u,200),V3("label",{key:"file-label"},i.fileName),V3("span",{key:"file-span"},u.name),V3("label",{key:"size-label"},i.size),V3("span",{key:"size-span"},KIt(n,u.size??0))):void 0)]}_renderAttachmentsViewList(){const{attachmentsViewOptions:t,messages:e,messagesUnits:i,viewModel:{store:{syncingAttachmentEdits:n},supportsDeleteAttachments:s,supportsUpdateAttachments:r}}=this,{attachmentInfos:o,objectId:a}=t;return V3("calcite-list",{afterCreate:rx,afterRemoved:sx,afterUpdate:rx,bind:this,class:tzt.attachmentsViewList,"data-node-ref":"attachmentsList",key:`attachments-list-${a}`,loading:n,ondragover:t=>t.preventDefault(),ondrop:this._onAttachmentsViewDrop,selectionMode:"multiple",onCalciteListChange:()=>this.scheduleRender()},...o?.map((n=>{const{id:o,name:l,size:u,url:c}=n,h=KIt(i,u??0);return V3("calcite-list-item",{afterRemoved:()=>this.scheduleRender(),key:`attachment-${o}`,label:l,value:o},this._renderAttachmentsViewListThumbnail(n),V3("span",{class:tzt.attachmentsViewListFileSize,slot:"actions-end",title:h},h),V3("calcite-action",{appearance:"transparent",icon:ezt.downloadTo,key:`download-attachment-${o}`,label:`${l}`,onclick:t=>{t.preventDefault(),this.downloadAttachmentById(a??-1,o)},slot:"actions-end",text:e.downloadAttachment,title:e.downloadAttachment}),r&&null!=a?V3("calcite-action",{appearance:"transparent",disabled:!r,icon:ezt.replaceImage,key:`replace-attachment-${o}`,label:`${l}`,onclick:()=>{t.mode="file",t.attachmentId=o},slot:"actions-end",text:e.updateAttachment,title:e.updateAttachment}):void 0,V3("calcite-action",{appearance:"transparent",icon:ezt.launch,key:`launch-attachment-${o}`,label:`${l}`,onclick:()=>{c&&window.open(c,"_blank")},slot:"actions-end",text:e.viewAttachment,title:e.viewAttachment}),s&&null!=a?V3("calcite-action",{appearance:"transparent",class:tzt.attachmentsViewListItemDelete,disabled:!s,icon:ezt.delete,key:`delete-attachment-${o}`,label:`${l}`,onclick:()=>{this.deleteAttachments(a,[o],!0)},slot:"actions-end",text:e.deleteAttachment,title:e.deleteAttachment}):void 0)})))}_renderAttachmentsViewListThumbnail(t){return V3("div",{class:tzt.attachmentsViewListThumbnail,slot:"content-start"},V3("a",{href:t.url??"",rel:"noreferrer",target:"_blank"},this._renderAttachmentsViewThumbnail(t)))}_renderAttachmentsViewThumbnail(t,e=64){const{contentType:i,name:n,size:s,url:r}=t,o=`${r}${r?.includes("?")?"&":"?"}w=${e}&s=${s}`;return this.viewModel.supportsResizeAttachments&&QIt(i)?V3("img",{alt:n,key:`thumbnail-image-${n}`,src:o,title:n}):V3("calcite-icon",{icon:tkt(i),key:`thumbnail-icon-${n}`,scale:"l",textLabel:n,title:n})}_onAttachmentsViewCandidateChange({target:t}){this.attachmentsViewOptions.candidates=t?.files}_onAttachmentsViewDrop(t){const{viewModel:e}=this;t.preventDefault(),(e.supportsAddAttachments||e.supportsUpdateAttachments)&&this.attachmentsViewOptions.set({mode:"file",candidates:t.dataTransfer?.files})}_renderNavigationBar(){const{effectiveTable:t,messages:e,messagesCommon:i,relatedTable:n,relatedTables:s}=this;if(!this._shouldShowNavigationBar)return;const{attachmentsList:r,attachmentsViewOptions:o,layer:a,viewModel:{supportsAddAttachments:l,supportsDeleteAttachments:u}}=t;if(!a)return;const{attachmentInfos:c,objectId:h}=o,d=null!=h,f=c.length,p=r?.selectedItems?.length??0,m=`${a.objectIdField}: ${h}`,y=Xg(e.selectedCount,{count:p}),g=Xg(e.attachmentsCount,{count:f}),v=d?V3("calcite-action",{bind:this,icon:ezt.chevronRight,iconFlipRtl:!0,key:"navigation-feature",onclick:()=>t.scrollToRow(h),text:m,textEnabled:!0,title:m}):void 0,w=d?V3("calcite-action",{icon:ezt.chevronRight,iconFlipRtl:!0,key:"navigation-attachments-label",label:g,onclick:()=>{f>0&&(o.mode="list")},text:g,textEnabled:!0,title:g}):void 0,b=d?V3("calcite-chip",{closable:!0,closed:0===p,key:"navigation-chip",kind:"inverse",label:y,selected:!0,title:y,value:"selected",onCalciteChipClose:()=>r?.selectedItems?.forEach((t=>t.selected=!1))},y):void 0,S=n?V3("calcite-label",{layout:"inline"},e.showAllTables,V3("calcite-switch",{checked:this.allRelatedTablesVisible,onCalciteSwitchChange:t=>this.showAllRelatedTables=!!t.target.checked})):void 0,_=d&&"list"===o.mode&&null!=h&&p&&u?V3("calcite-action",{icon:ezt.delete,iconFlipRtl:!0,key:"attachments-trash-all",onclick:()=>{t.deleteAttachments(h,r?.selectedItems?.map((t=>t.value))??[],!0)},text:i.delete,textEnabled:!0,title:Xg(e.deleteAttachmentCount,{count:p})}):void 0,x=d&&"list"===o.mode&&l?V3("calcite-action",{bind:this,icon:ezt.plus,iconFlipRtl:!0,key:"attachments-add",onclick:()=>{o.attachmentId=null,o.mode="file"},text:e.addAttachment,textEnabled:!0,title:e.addAttachment}):void 0;return V3("div",{class:tzt.tableNavigation,key:"table-nav"},V3("calcite-action",{icon:ezt.moveUp,iconFlipRtl:!0,key:"go-back",onclick:()=>{n&&this.drainRelatedTables(),t.attachmentsViewOptions.objectId=null},text:this.layer?.title??"",textEnabled:!1,title:n?e.exitRelatedRecords:e.exitAttachments}),s.toArray().map(((t,e)=>this._renderRelatedTableNavigationAction(t,e))),v,w,V3("div",null,b,S,_,x))}_renderRelatedTableNavigationAction(t,e){const i=this._getLabelForRelatedTableNavigationAction(t);return V3("calcite-action",{icon:ezt.chevronRight,iconFlipRtl:!0,key:e,onclick:()=>this._onRelatedNavigationItemClick(e),text:i,textEnabled:!0,title:t.layer?.title||""})}_getLabelForRelatedTableNavigationAction(t){const e=t.layer?.title;if(!e)return"";const{relatedTables:i}=this;if(i.length<=1)return e;return i.indexOf(t)!==i.length-1&&e.length>20?`${e.slice(0,20)}...`:e}};r([Je()],izt.prototype,"_attachmentsInput",void 0),r([Je()],izt.prototype,"_columnVisibilityActions",void 0),r([Je()],izt.prototype,"_effectiveDescription",null),r([Je()],izt.prototype,"_effectiveLayers",null),r([Je()],izt.prototype,"_effectiveTitle",null),r([Je()],izt.prototype,"_effectiveVisibleElements",null),r([Je()],izt.prototype,"_filteredTables",null),r([Je()],izt.prototype,"_hasAttachmentsViewError",null),r([Je()],izt.prototype,"_hasCustomMenuItems",null),r([Je()],izt.prototype,"_hasDefaultMenuItems",null),r([Je()],izt.prototype,"_shouldShowGrid",null),r([Je()],izt.prototype,"_shouldShowMenu",null),r([Je()],izt.prototype,"_shouldShowAttachmentsView",null),r([Je()],izt.prototype,"_showClearSelectionAction",null),r([Je()],izt.prototype,"_showColumnsVisibilityAction",null),r([Je()],izt.prototype,"_showDeleteSelectionAction",null),r([Je()],izt.prototype,"_showExportSelectionToCSVAction",null),r([Je()],izt.prototype,"_showLayerDropdown",null),r([Je()],izt.prototype,"_shouldShowNavigationBar",null),r([Je()],izt.prototype,"_showRefreshDataAction",null),r([Je()],izt.prototype,"_showSelectedRecordsShowSelectedAction",null),r([Je()],izt.prototype,"_showSelectedRecordsShowAllAction",null),r([Je()],izt.prototype,"_showZoomToSelectionAction",null),r([Je()],izt.prototype,"_viewLayers",null),r([Je()],izt.prototype,"attachmentsList",void 0),r([Je({readOnly:!0})],izt.prototype,"grid",null),r([Je()],izt.prototype,"actionColumnConfig",null),r([Je({readOnly:!0})],izt.prototype,"activeFilters",null),r([Je({readOnly:!0})],izt.prototype,"activeSortOrders",null),r([Je()],izt.prototype,"allColumns",null),r([Je({readOnly:!0})],izt.prototype,"allRelatedTablesVisible",null),r([Je()],izt.prototype,"attachmentsEnabled",null),r([Je()],izt.prototype,"attachmentsViewOptions",null),r([Je({type:Qut})],izt.prototype,"attributeTableTemplate",null),r([Je()],izt.prototype,"autoRefreshEnabled",null),r([Je()],izt.prototype,"clearPrompt",null),r([Je()],izt.prototype,"columnPerformanceModeEnabled",null),r([Je()],izt.prototype,"columnReorderingEnabled",null),r([Je({readOnly:!0})],izt.prototype,"columns",null),r([Je()],izt.prototype,"description",void 0),r([Je()],izt.prototype,"disabled",void 0),r([Je()],izt.prototype,"editingEnabled",null),r([Je()],izt.prototype,"effectiveSize",null),r([Je()],izt.prototype,"effectiveTable",null),r([Je()],izt.prototype,"filterGeometry",null),r([Je()],izt.prototype,"filterBySelectionEnabled",null),r([Je()],izt.prototype,"hiddenFields",null),r([Je()],izt.prototype,"highlightEnabled",null),r([Je()],izt.prototype,"highlightIds",null),r([Je()],izt.prototype,"icon",null),r([Je()],izt.prototype,"initialSize",null),r([Je()],izt.prototype,"isQueryingOrSyncing",null),r([Je()],izt.prototype,"isSyncingAttachments",null),r([Je()],izt.prototype,"label",null),r([Je()],izt.prototype,"layer",null),r([Je()],izt.prototype,"layers",void 0),r([Je()],izt.prototype,"layerView",null),r([Je()],izt.prototype,"maxSize",null),r([Je(),z3("esri/widgets/FeatureTable/t9n/FeatureTable")],izt.prototype,"messages",null),r([Je(),z3("esri/t9n/common")],izt.prototype,"messagesCommon",null),r([Je(),z3("esri/core/t9n/Units")],izt.prototype,"messagesUnits",null),r([Je(),z3("esri/widgets/support/t9n/uriUtils")],izt.prototype,"messagesURIUtils",null),r([Je()],izt.prototype,"menuConfig",void 0),r([Je()],izt.prototype,"multipleSelectionEnabled",null),r([Je()],izt.prototype,"multiSortEnabled",null),r([Je()],izt.prototype,"objectIds",null),r([Je()],izt.prototype,"outFields",null),r([Je()],izt.prototype,"pageCount",null),r([Je()],izt.prototype,"pageIndex",null),r([Je()],izt.prototype,"pageSize",null),r([Je()],izt.prototype,"paginationEnabled",null),r([Je()],izt.prototype,"prompt",null),r([Je()],izt.prototype,"relatedRecordsEnabled",null),r([Je()],izt.prototype,"relatedTable",null),r([Je()],izt.prototype,"relatedTables",null),r([Je()],izt.prototype,"relationship",null),r([Je()],izt.prototype,"relationshipColumnConfigs",null),r([Je()],izt.prototype,"relationshipConfig",null),r([Je()],izt.prototype,"returnGeometryEnabled",null),r([Je()],izt.prototype,"returnMEnabled",null),r([Je()],izt.prototype,"returnZEnabled",null),r([Je()],izt.prototype,"rowHighlightIds",null),r([Je()],izt.prototype,"selectionSource",null),r([Je()],izt.prototype,"showAllRelatedTables",null),r([Je()],izt.prototype,"showPrompt",null),r([Je()],izt.prototype,"showRelatedTableCallback",null),r([Je()],izt.prototype,"size",null),r([Je({readOnly:!0})],izt.prototype,"state",null),r([Je({constructOnly:!0})],izt.prototype,"tableController",null),r([Je({constructOnly:!0})],izt.prototype,"tableParent",null),r([Je()],izt.prototype,"tableTemplate",null),r([Je()],izt.prototype,"tableTemplateOverride",null),r([Je()],izt.prototype,"title",void 0),r([Je()],izt.prototype,"timeExtent",null),r([Je()],izt.prototype,"timeZone",null),r([Je()],izt.prototype,"view",null),r([Je({type:q$t}),gwt(["cell-click","cell-dblclick","cell-pointerover","cell-pointerout","cell-keydown","column-reorder","show-related-table"])],izt.prototype,"viewModel",void 0),r([Je({type:J$t,nonNullable:!0})],izt.prototype,"visibleElements",void 0),r([Je({type:J$t})],izt.prototype,"visibleElementsOverride",null),izt=Y$t=r([ln("esri.widgets.FeatureTable")],izt);const nzt=izt;let szt=class extends ao{constructor(t){super(t),this._viewpointHandle=null,this.group=null}initialize(){this.addHandles(sy((()=>this.view?.ui),"expand",(t=>{const{target:e}=t;e&&e!==this&&e.expanded&&e.group&&e.group===this.group&&this._collapse()})))}destroy(){this._viewpointHandle=null,this.view=null}set autoCollapse(t){this._set("autoCollapse",t),this._watchViewpoint()}set expanded(t){const e=!!t;this._set("expanded",e);const i=this.view?.ui;i&&i.emit("expand",{target:this}),this._viewpointHandleChange(e)}get state(){return this.view?.ready?"ready":"disabled"}set view(t){this._get("view")!==t&&(this._set("view",t),t&&iy((()=>t.ready),(()=>{this.view===t&&this._watchViewpoint()}),{once:!0,initial:!0}))}_viewpointHandleChange(t){this._viewpointHandle&&(t?iy((()=>this.view?.stationary),(()=>this._viewpointHandle?.resume()),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const t="viewpoint";this.removeHandles(t),this._viewpointHandle=null;const{autoCollapse:e,view:i}=this;if(!i||!e)return;const n=cy((()=>"3d"===i.type?i.camera:i.viewpoint),(()=>this._collapse()));this.addHandles(n,t),this._viewpointHandle=n}_collapse(){this.expanded=!1}};r([Je({value:!1})],szt.prototype,"autoCollapse",null),r([Je({value:!1})],szt.prototype,"expanded",null),r([Je()],szt.prototype,"group",void 0),r([Je({readOnly:!0})],szt.prototype,"state",null),r([Je({value:null})],szt.prototype,"view",null),szt=r([ln("esri.widgets.Expand.ExpandViewModel")],szt);const rzt=szt;const ozt="esri-expand",azt={base:ozt,toggle:`${ozt}__toggle`,popoverContent:`${ozt}__popover-content`,panel:`${ozt}__panel`,panelContent:`${ozt}__panel-content`,sheet:`${ozt}__sheet`,panelIconNumber:`${ozt}__panel-icon-number`,contentContainer:`${ozt}__content-container`,icon:"esri-collapse__icon",iconFlip:"esri-collapse__icon-flip",iconExpanded:`${ozt}__icon--expanded`,iconNumber:`${ozt}__icon-number`,content:`${ozt}__content`,contentExpanded:`${ozt}__content--expanded`},lzt="chevrons-left",uzt="chevrons-right";let czt=class extends A3{constructor(t,e){super(t,e),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.placement=null,this.viewModel=new rzt,this.toggle=()=>{this.viewModel.expanded=!this.viewModel.expanded},this._handlePopoverClose=t=>{t.target===this._popoverEl&&(this.viewModel.expanded=t.target.open)},this._handleSheetClose=t=>{this.viewModel.expanded=t.target.open},this._handlePanelClose=t=>{this.viewModel.expanded=!t.target.closed},this._handleKeyDown=t=>{this.viewModel.expanded&&"Escape"===t.key&&!this._willCloseOnEsc(t)&&t.preventDefault()},this._storeToggleActionEl=t=>{this._toggleActionEl=t},this._storePopoverEl=t=>{this._popoverEl=t}}loadDependencies(){return o3({action:()=>import("./p-255edeba.js"),icon:()=>import("./p-a8caa0f1.js"),panel:()=>import("./p-0dfbea12.js"),popover:()=>import("./p-fd16e356.js"),sheet:()=>import("./p-3fa0a837.js")})}get expandTitle(){const{expanded:t,messagesCommon:e,collapseTooltip:i,expandTooltip:n}=this;return(t?i||e?.collapse:n||e?.expand)??""}get _displaySheet(){switch(this.mode){case"drawer":return!0;case"auto":return"xsmall"===this.viewModel.view?.widthBreakpoint;default:return!1}}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(t){this.viewModel.autoCollapse=t}get collapseIcon(){return uzt}set collapseIcon(t){this._overrideIfSome("collapseIcon",t)}get expanded(){return this.viewModel.expanded}set expanded(t){this.viewModel.expanded=t}get expandIcon(){return hbt(this.content)?this.content.icon:lzt}set expandIcon(t){this._overrideIfSome("expandIcon",t)}get group(){return this.viewModel.group}set group(t){this.viewModel.group=t}get icon(){return null}get label(){return(hbt(this.content)?this.content.label:null)??this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}render(){const{_displaySheet:t,_toggleActionEl:e,viewModel:{expanded:i},label:n,placement:s}=this;return V3("div",{class:this.classes(azt.base,P3.widget)},this._renderToggle(),t?V3("calcite-sheet",{class:azt.sheet,heightScale:"l",label:n,onkeydown:this._handleKeyDown,open:i,position:"block-end",onCalciteSheetClose:this._handleSheetClose},V3("calcite-panel",{class:azt.panel,closable:!0,closed:!i,heading:n,onkeydown:this._handleKeyDown,onCalcitePanelClose:this._handlePanelClose},V3("div",{class:azt.panelContent},this._renderContent()))):e?V3("calcite-popover",{afterCreate:this._storePopoverEl,afterUpdate:this._storePopoverEl,label:n,onkeydown:this._handleKeyDown,open:i,overlayPositioning:"fixed",placement:s??this._getPlacement(),referenceElement:e,onCalcitePopoverClose:this._handlePopoverClose},V3("div",{class:azt.popoverContent},this._renderContent())):null)}_getPlacement(){const{container:t,view:e}=this,i=t&&e?e.ui.getPosition(t):null;if(!i||"manual"===i)return"auto";const[n,s]=i.split("-");return`${"right"===s?"left":"right"}-${"bottom"===n?"end":"start"}`}_willCloseOnEsc(t){const{closeOnEsc:e}=this;return"function"==typeof e?e(t):e}_renderBadgeNumber(){const{expanded:t,iconNumber:e}=this;return e&&!t?V3("span",{class:azt.iconNumber,key:"expand__icon-number"},e):null}_renderToggleButton(){const{expanded:t,expandTitle:e,expandIcon:i,collapseIcon:n}=this,s=t?n:i,r=s===lzt||s===uzt;return V3("calcite-action",{afterCreate:this._storeToggleActionEl,afterUpdate:this._storeToggleActionEl,class:P3.widgetButton,onclick:this.toggle,scale:"s",text:e,title:e},s?V3("calcite-icon",{class:this.classes(azt.icon,r&&azt.iconFlip),icon:s,scale:"s"}):null)}_renderToggle(){return V3("div",{class:azt.toggle},this._renderToggleButton(),this._renderBadgeNumber())}_renderContent(){const{content:t}=this;return"string"==typeof t?V3("div",{class:azt.contentContainer,innerHTML:t,key:"content__string"}):hbt(t)?V3("div",{class:azt.contentContainer,key:"content__widget"},t.render()):t instanceof HTMLElement?V3("div",{afterCreate:this._attachToNode,bind:t,class:azt.contentContainer,key:"content__html-element"}):dbt(t)?V3("div",{afterCreate:this._attachToNode,bind:t.domNode,class:azt.contentContainer,key:"content__node"}):null}_attachToNode(t){const e=this;t.appendChild(e)}};r([Je({readOnly:!0})],czt.prototype,"expandTitle",null),r([Je()],czt.prototype,"_toggleActionEl",void 0),r([Je()],czt.prototype,"_displaySheet",null),r([Je()],czt.prototype,"autoCollapse",null),r([Je()],czt.prototype,"closeOnEsc",void 0),r([Je()],czt.prototype,"collapseIcon",null),r([Je()],czt.prototype,"collapseTooltip",void 0),r([Je()],czt.prototype,"content",void 0),r([Je()],czt.prototype,"expanded",null),r([Je()],czt.prototype,"expandIcon",null),r([Je()],czt.prototype,"expandTooltip",void 0),r([Je()],czt.prototype,"group",null),r([Je()],czt.prototype,"icon",null),r([Je()],czt.prototype,"iconNumber",void 0),r([Je()],czt.prototype,"label",null),r([Je(),z3("esri/widgets/Expand/t9n/Expand")],czt.prototype,"messages",void 0),r([Je(),z3("esri/t9n/common")],czt.prototype,"messagesCommon",void 0),r([Je()],czt.prototype,"mode",void 0),r([Je()],czt.prototype,"placement",void 0),r([Je()],czt.prototype,"view",null),r([Je({type:rzt})],czt.prototype,"viewModel",void 0),czt=r([ln("esri.widgets.Expand")],czt);const hzt=czt;var dzt;!function(t){t[t.NORTH=0]="NORTH",t[t.NORTH_EAST=1]="NORTH_EAST",t[t.EAST=2]="EAST",t[t.SOUTH_EAST=3]="SOUTH_EAST",t[t.SOUTH=4]="SOUTH",t[t.SOUTH_WEST=5]="SOUTH_WEST",t[t.WEST=6]="WEST",t[t.NORTH_WEST=7]="NORTH_WEST"}(dzt||(dzt={}));function fzt(t){return pzt(t)||tc(t)||ic(t)}function pzt(t){return Zu(t)||Yu(t)}const mzt=12;class yzt{constructor(t){const e=yzt.checkUnsupported(t);if(null!=e)throw e;const i=t;this.spatialReference=i.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=Hu(this.spatialReference),this.origin=[i.origin.x,i.origin.y],this.pixelSize=i.size[0],this.dpi=i.dpi;const n=i.lods.reduce(((t,e)=>(e.level<t.minLod.level&&(t.minLod=e),t.max=Math.max(t.max,e.level),t)),{minLod:i.lods[0],max:-1/0}),s=n.minLod,r=2**s.level;let o=s.resolution*r,a=s.scale*r;this.levels=new Array(n.max+1);for(let t=0;t<this.levels.length;t++)this.levels[t]={resolution:o,scale:a,tileSize:[o*i.size[0],o*i.size[1]]},o/=2,a/=2}clone(){return new yzt(this.toTileInfo())}toTileInfo(){return new fS({dpi:this.dpi,origin:new Kh({x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference}),size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map(((t,e)=>new lS({level:e,scale:t.scale,resolution:t.resolution})))})}getExtent(t,e,i,n){const s=this.levels[t],r=s.tileSize[0],o=s.tileSize[1];n[0]=this.origin[0]+i*r,n[2]=this.origin[0]+(i+1)*r,n[3]=this.origin[1]-e*o,n[1]=this.origin[1]-(e+1)*o}convertExtentToRadians(t,e){this._isWebMercator?(e[0]=jh(t[0]),e[1]=Oh(t[1]),e[2]=jh(t[2]),e[3]=Oh(t[3])):this._isGCS&&(e[0]=xf(t[0]),e[1]=xf(t[1]),e[2]=xf(t[2]),e[3]=xf(t[3]))}getExtentGeometry(t,e,i,n=new Od){return this.getExtent(t,e,i,vzt),n.spatialReference=this.spatialReference,n.xmin=vzt[0],n.ymin=vzt[1],n.xmax=vzt[2],n.ymax=vzt[3],n.zmin=void 0,n.zmax=void 0,n}ensureMaxLod(t){if(null==t)return!1;let e=!1;for(;this.levels.length<=t;){const{resolution:t,scale:i}=this.levels[this.levels.length-1],n=t/2*this.pixelSize;this.levels.push({resolution:t/2,scale:i/2,tileSize:[n,n]}),e=!0}return e}capMaxLod(t){this.levels.length>t+1&&(this.levels.length=t+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(t){return this.levels[0].scale/2**t}levelAtScale(t){const e=this.levels[0].scale;return t>=e?0:Math.log(e/t)*Math.LOG2E}resolutionAtLevel(t){return this.levels[0].resolution/2**t}compatibleWith(t,e=1/0){if(yzt.checkUnsupported(t))return!1;const i=new yzt(t);if(!i.spatialReference.equals(this.spatialReference))return!1;if(i.pixelSize!==this.pixelSize)return!1;const n=Math.min(this.levels.length-1,i.levels.length-1,e),s=this.levels[n].resolution;let r=.5*s;if(!If(i.origin[0],this.origin[0],r)||!If(i.origin[1],this.origin[1],r))return!1;return r=.5*s/2**n/this.pixelSize*mzt,If(s,i.levels[n].resolution,r)}rootTilesInExtent(t,e=null,i=1/0){const n=new Array,s=this.levels[0].tileSize;if(null==t||0===s[0]||0===s[1])return n;yzt.computeRowColExtent(t,s,this.origin,vzt);let r=vzt[1],o=vzt[3],a=vzt[0],l=vzt[2];const u=l-a,c=o-r;if(u*c>i){const t=Math.floor(Math.sqrt(i));c>t&&(r=r+Math.floor(.5*c)-Math.floor(.5*t),o=r+t),u>t&&(a=a+Math.floor(.5*u)-Math.floor(.5*t),l=a+t)}for(let t=r;t<o;t++)for(let e=a;e<l;e++)n.push([0,t,e]);return null!=e&&(e[0]=this.origin[0]+a*s[0],e[1]=this.origin[1]-o*s[1],e[2]=this.origin[0]+l*s[0],e[3]=this.origin[1]-r*s[1]),n}static computeRowColExtent(t,e,i,n){const s=.001*(t[2]-t[0]+(t[3]-t[1]));n[0]=Math.max(0,Math.floor((t[0]+s-i[0])/e[0])),n[2]=Math.max(0,Math.ceil((t[2]-s-i[0])/e[0])),n[1]=Math.max(0,Math.floor((i[1]-t[3]+s)/e[1])),n[3]=Math.max(0,Math.ceil((i[1]-t[1]-s)/e[1]))}static isPowerOfTwo(t){const e=t.lods,i=e[0].resolution*2**e[0].level;return!e.some((t=>!Nf(t.resolution,i/2**t.level)))}static hasGapInLevels(t){const e=t.lods.map((t=>t.level));e.sort(((t,e)=>t-e));for(let t=1;t<e.length;t++)if(e[t]!==e[0]+t)return!0;return!1}static tileSizeSupported(t){const e=t.size[1];return e===t.size[0]&&!(e&e-1)&&e>=128&&e<=512}static hasOriginPerLODs(t){const e=t.origin;return t.lods.some((t=>null!=t.origin&&(t.origin[0]!==e.x||t.origin[1]!==e.y)))}static getMissingTileInfoError(){return new Ve("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(t){return null==t?gzt():t.lods.length<1?new Ve("tilingscheme:generic","Tiling scheme must have at least one level"):yzt.isPowerOfTwo(t)?yzt.hasGapInLevels(t)?new Ve("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):yzt.tileSizeSupported(t)?yzt.hasOriginPerLODs(t)?new Ve("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new Ve("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new Ve("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(t,e){const i=t[2]-t[0],n=t[3]-t[1],s=Yc(e),r=1.2*Math.max(i,n),o=256,a=r/o,l=a*s*(96/.0254),u=new yzt(new fS({size:[o,o],origin:new Kh({x:t[0]-.5*(r-i),y:t[3]+.5*(r-n)}),lods:[new lS({level:0,resolution:a,scale:l})],spatialReference:e}));return u.ensureMaxLod(20),u}static makeWebMercatorAuxiliarySphere(t){const e=new yzt(yzt.WebMercatorAuxiliarySphereTileInfo);return e.ensureMaxLod(t),e}static makeGCSWithTileSize(t,e=256,i=16){const n=256/e,s=new yzt(new fS({size:[e,e],origin:new Kh({x:-180,y:90,spatialReference:t}),spatialReference:t,lods:[new lS({level:0,resolution:.703125*n,scale:295497598.570834*n})]}));return s.ensureMaxLod(i),s}get test(){}}function gzt(){return new Ve("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}yzt.WebMercatorAuxiliarySphereTileInfo=new fS({size:[256,256],origin:new Kh({x:-20037508.342787,y:20037508.342787,spatialReference:wh.WebMercator}),spatialReference:wh.WebMercator,lods:[new lS({level:0,resolution:156543.03392800014,scale:591657527.591555})]}),yzt.WebMercatorAuxiliarySphere=yzt.makeWebMercatorAuxiliarySphere(19);const vzt=Bf();const wzt=64;Pf($f/10);const bzt=Bf();yzt.WebMercatorAuxiliarySphere.getExtent(0,0,0,bzt);const Szt=Yv(),_zt=Yv(),xzt=Yv(),Mzt=Yv();function Tzt(t,e,i=0){const n=t.extent;if(null==n)return!1;if(0===i)return Xf(n,e);const s=Math.min(n[2]-n[0],n[3]-n[1]);return ep(n,e,i*s)}function Azt(t,e,i,n){QW(Szt,i),Szt[n]=e[n];const s=eZ(Szt,Szt,e),r=eZ(_zt,t,e),o=bZ(r,s),a=bZ(s,s);let l;l=o<=0?e:a<=o?i:tZ(Szt,e,dZ(s,s,o/a));const u=eZ(Szt,t,l);return Math.PI/2-Math.atan(u[2]/Math.sqrt(u[0]*u[0]+u[1]*u[1]))}function Izt(t,e,i){const n=t.extent;if(null==n)return 0;xzt[0]=n[0],xzt[1]=n[1],xzt[2]=i,Mzt[0]=n[2],Mzt[1]=n[3],Mzt[2]=i;let s=1/0,r=1/0;return e[0]<xzt[0]?s=Azt(e,xzt,Mzt,0):e[0]>Mzt[0]&&(s=Azt(e,Mzt,xzt,0)),e[1]<xzt[1]?r=Azt(e,xzt,Mzt,1):e[1]>Mzt[1]&&(r=Azt(e,Mzt,xzt,1)),Math.min(s,r)}function kzt(t,e,i,n){if(null==t)return gzt();const s=t.spatialReference;if(s.isGeographic&&!pzt(s))return new Ve("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const r=yzt.checkUnsupported(t);if(null!=r)return r;if(null==i)return new Ve("tilingscheme:extent-not-exist","The layer does not provide a layer extent.");const o=Czt(t,i);return o||(null==e||s.equals(e)||e.isWGS84&&s.isWebMercator?null:new Ve("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"))}function Czt(t,e){const i=t.lods,n=i[0].resolution*2**i[0].level,s=[n*t.size[0],n*t.size[1]],r=[t.origin.x,t.origin.y],o=qf(e),a=Bf();yzt.computeRowColExtent(o,s,r,a);const l=(a[2]-a[0])*(a[3]-a[1]);if(l>wzt){const e=i[0].scale*2**i[0].level;let s=Math.max((o[3]-o[1])/t.size[1],(o[2]-o[0])/t.size[0])*e/n;const r=Math.floor(Math.log(s)/Math.log(10));return s=Math.ceil(s/10**r)*10**r,new Ve("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(e).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+s.toLocaleString()+".",{level0Scale:e,suggestedLevel0Scale:s,requiredNumRootTiles:l,allowedNumRootTiles:wzt})}return null}const Ezt=Object.freeze(Object.defineProperty({__proto__:null,checkIfTileInfoSupportedForViewSR:kzt,isInsideExtent:Tzt,tiltToExtentEdge:Izt},Symbol.toStringTag,{value:"Module"}));function jzt(){return!0}function Ozt(){return 0}function Rzt(t,e,i,n){if(null==t)return gzt();const s=t?.lods.length-1,r=t.spatialReference;if(r.isWebMercator){if(!yzt.makeWebMercatorAuxiliarySphere(s).compatibleWith(t,n))return new Ve("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!fzt(r))return new Ve("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!yzt.makeGCSWithTileSize(t.spatialReference,t.size[0],s).compatibleWith(t,n))return t.spatialReference.isWGS84?new Ve("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new Ve("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}return null==e||t.spatialReference.equals(e)?null:new Ve("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}const Lzt=Object.freeze(Object.defineProperty({__proto__:null,checkIfTileInfoSupportedForViewSR:Rzt,isInsideExtent:jzt,tiltToExtentEdge:Ozt},Symbol.toStringTag,{value:"Module"}));const Nzt={[TU.Global]:Lzt,[TU.Local]:Ezt};function Pzt(t,e,i,n,s){return Nzt[n].checkIfTileInfoSupportedForViewSR(t,i,e,s)}function Fzt(t,e,i){const n=tA(t);if(null!=n){if(!Vm.isCollection(n))return{tileInfo:n.tileInfo,fullExtent:n.fullExtent};{const t=n.find((t=>null==Pzt(t.tileInfo,t.fullExtent,e,i)));if(t)return{tileInfo:t.tileInfo,fullExtent:t.fullExtent}}}return{tileInfo:null,fullExtent:null}}function Dzt(t,e){return null!=t&&(null==e||(e===TU.Local?!t.isGeographic||(t.isWGS84||t.wkid===Ru.CGCS2000):t.isWebMercator||t.isWGS84||t.wkid===Ru.CGCS2000||t.wkid===Ru.GCSMARS2000||t.wkid===Ru.GCSMARS2000_SPHERE||t.wkid===Ru.GCSMOON2000))}async function $zt(t,e={}){const{basemap:i,view:n}=t;await i.load(e),Bzt(i),await Vzt(i,n,e),_s(e)}async function zzt(t,e={}){const{basemap:i,view:n}=t;_s(e);const s=i.baseLayers.find((t=>"unknown"===t.type))?.loadError;if(null!=s)throw s;if(!n||"spatialReferenceLocked"in n&&!n.spatialReferenceLocked)return;if(await i.load(e),_s(e),0===i.baseLayers.length)return;const r=i.baseLayers.at(0);if(!JT(r))return;if(i.spatialReference){if(n.spatialReference.equals(i.spatialReference))return;Uzt()}await r.load(e),_s(e);const o=(("supportedSpatialReferences"in r?r.supportedSpatialReferences:null)||["tileInfo"in r?r.tileInfo?.spatialReference:null]).filter(C);0!==o.length&&o.every((t=>!n.spatialReference.equals(t)))&&Uzt()}function Uzt(){throw new Ve("basemap-compatibility:incompatible-spatial-reference","Basemap spatial reference is not compatible with the view")}function Bzt(t){if(0===t.baseLayers.length&&0===t.referenceLayers.length)return;const e=t.baseLayers.concat(t.referenceLayers).toArray().filter((t=>!BT(t))).map((t=>Gzt(t)));if(e.length)throw e[0]}function Gzt(t){return new Ve("basemap-compatibility:unsupported-basemap-layer-type","Unsupported basemap layer type ${operationalLayerType}",{layer:t,operationalLayerType:t.operationalLayerType||"unknown"})}async function Vzt(t,e,i){if(0===t.baseLayers.length)return;const n=t.baseLayers.at(0);if(ZT(n)){try{await n.load(i)}catch(t){const e="basemap-compatibility:unknown-error",i="Unknown basemap compatibility error",{name:n=e,message:s=i,details:r}=t;throw new Ve(n,s,r)}qzt(n,e)}}function qzt(t,e){const i=e.state.viewingMode;if(!i)return;let n,s;if("wmts"===t?.type){const r=Fzt(t,e.spatialReference,i);if(null==r.tileInfo)throw new Ve("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view");n=r.tileInfo,s=r.fullExtent}else n=t.tileInfo,s=t.fullExtent;if(null==n)return;if(!Dzt(n.spatialReference,i))throw new Ve(`basemapgalleryitem:spatial-reference-unsupported-${AU(i)}`,`Basemap spatial reference is unsupported in ${AU(i)} mode`);const r="vector-tile"===t?.type?n.getCompatibleForVTL(256):null;if(i===TU.Global){let e=Pzt(n,s,null,i);if(e&&"vector-tile"===t?.type&&null!=s&&r&&!Pzt(r,s,null,i)&&(e=null),e){const t=n.spatialReference.isWebMercator?"web-mercator":"wgs84";throw new Ve(`basemapgalleryitem:tiling-scheme-unsupported-${t}-global`,"Basemap tiling scheme is unsupported in global mode",{error:e})}}else if(yzt.checkUnsupported(n))throw new Ve("basemapgalleryitem:tiling-scheme-unsupported-local","Basemap tiling scheme is unsupported in local mode");const o=e.basemapTerrain?.tilingScheme;if(o&&!o.compatibleWith(n)&&("vector-tile"!==t?.type||!r||!o.compatibleWith(r)))throw new Ve("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view")}let Hzt=class extends(dC(ao)){constructor(t){super(t),this.compatibilityFunction=null,this.error=null,this.state="loading",this.view=null}initialize(){const t=()=>this.refresh();this.addHandles([ey((()=>this.basemap?.loadStatus),t),ey((()=>this.compatibilityFunction),t),ey((()=>this.view&&"basemapTerrain"in this.view&&this.view.basemapTerrain?.tilingScheme),t),ey((()=>this.view?.ready),t),ey((()=>this.view?.spatialReference),t)]),this.refresh()}destroy(){this._cancelRefresh(),this.basemap=null,this.compatibilityFunction=null,this.view=null}get _spatialReferenceTask(){return qk(this.view,this.basemap)}set basemap(t){t&&t.load().catch((()=>{})),this._set("basemap",t)}get spatialReference(){return this._spatialReferenceTask.spatialReference}refresh(){this._cancelRefresh(),this._set("state","loading");const t=this.basemap?.loadStatus;if("loaded"!==t&&"failed"!==t)return;if(!this.compatibilityFunction)return void("loaded"===t?(this._set("state","ready"),this._set("error",null)):(this._set("state","error"),this._set("error",this.basemap.loadError)));const e=new AbortController,{signal:i}=e;this.compatibilityFunction(this,{signal:i}).then((()=>oy((()=>!this._spatialReferenceTask.updating),i))).then((()=>{this._set("state","ready"),this._set("error",null)})).catch((t=>{Es(t)||(this._set("state","error"),this._set("error",t))})),this._refreshController=e}_cancelRefresh(){this._refreshController&&(this._refreshController.abort(),this._refreshController=null)}};r([Je({readOnly:!0})],Hzt.prototype,"_spatialReferenceTask",null),r([Je()],Hzt.prototype,"basemap",null),r([Je()],Hzt.prototype,"compatibilityFunction",void 0),r([Je({readOnly:!0})],Hzt.prototype,"error",void 0),r([Je({readOnly:!0})],Hzt.prototype,"spatialReference",null),r([Je({readOnly:!0})],Hzt.prototype,"state",void 0),r([Je()],Hzt.prototype,"view",void 0),Hzt=r([ln("esri.widgets.BasemapGallery.support.BasemapGalleryItem")],Hzt);const Wzt=Hzt;const Zzt=Vm.ofType(bA);let Jzt=class extends ao{constructor(t){super(t),this.basemaps=new Zzt}destroy(){this.basemaps.forEach((t=>t.destroy()))}get state(){return"ready"}refresh(){}};r([Je({type:Zzt})],Jzt.prototype,"basemaps",void 0),r([Je({readOnly:!0})],Jzt.prototype,"state",null),Jzt=r([ln("esri.widgets.BasemapGallery.support.LocalBasemapsSource")],Jzt);const Yzt=Jzt;const Kzt=Vm.ofType(bA);let Qzt=class extends($M.LoadableMixin(jM(Yzt))){constructor(t){super(t),this._lastPortalBasemapFetchController=null,this.basemaps=new Kzt,this.filterFunction=null,this.portal=uT.getDefault(),this.query=null,this.updateBasemapsCallback=null,this.viewType=null}initialize(){this.addHandles(ey((()=>[this.filterFunction,this.loadStatus,this.portal?.basemapGalleryGroupQuery,this.portal?.basemapGalleryGroupQuery3D,this.portal?.user,this.query,this.updateBasemapsCallback]),(()=>this.refresh()),dy))}destroy(){this.filterFunction=null,this.portal=null,this.basemaps.forEach((t=>t.destroy()))}get state(){return"not-loaded"===this.loadStatus?"not-loaded":"loading"===this.loadStatus||this._lastPortalBasemapFetchController?"loading":"ready"}load(t){return this.addResolvingPromise(this.portal.load(t)),Promise.resolve(this)}async refresh(){if("loaded"!==this.loadStatus)return;this._lastPortalBasemapFetchController&&(this._lastPortalBasemapFetchController.abort(),this._lastPortalBasemapFetchController=null);const t=this.portal,e=new AbortController;this._lastPortalBasemapFetchController=e,this.notifyChange("state");try{const i=await t.fetchBasemaps(this._toQueryString(this.query),{signal:e.signal,include3d:"3d"===this.viewType||void 0});await this._updateBasemaps(i)}catch(t){if(Es(t))throw t;jt.getLogger(this).warn(new Ve("basemap-source:fetch-basemaps-error","Could not fetch basemaps from portal.",{error:t})),await this._updateBasemaps()}this._lastPortalBasemapFetchController=null,this.notifyChange("state")}_toQueryString(t){return t&&"string"!=typeof t?Object.keys(t).map((e=>`${e}:${t[e]}`)).join(" AND "):t}async _updateBasemaps(t=[]){let e=await this._filterBasemaps(t);e=this.updateBasemapsCallback?await this.updateBasemapsCallback(e):e,this.basemaps.removeAll(),this.basemaps.addMany(e)}async _filterBasemaps(t){if(!this.filterFunction)return t;const e=t.map(this.filterFunction),i=await Promise.all(e);return t.filter(((t,e)=>i[e]))}};r([Je({readOnly:!0,type:Kzt})],Qzt.prototype,"basemaps",void 0),r([Je()],Qzt.prototype,"filterFunction",void 0),r([Je({type:uT})],Qzt.prototype,"portal",void 0),r([Je()],Qzt.prototype,"query",void 0),r([Je({readOnly:!0})],Qzt.prototype,"state",null),r([Je()],Qzt.prototype,"updateBasemapsCallback",void 0),r([Je()],Qzt.prototype,"viewType",void 0),Qzt=r([ln("esri.widgets.BasemapGallery.support.PortalBasemapsSource")],Qzt);const Xzt=Qzt;const tUt=Vm.ofType(Wzt);function eUt(t){return t&&"esri.portal.Portal"===t.declaredClass}function iUt(t){return t&&!(t instanceof Xzt)&&(!!t.portal||!!t.query)}function nUt(t){return t&&"basemaps"in t&&"state"in t&&"refresh"in t}let sUt=class extends $M{constructor(t){super(t),this._loadingProjectionEngine=!1,this.items=new tUt,this.source=new Xzt,this.view=null}initialize(){const t=()=>this._recreateItems();this.addHandles([ey((()=>"ready"===this.state?this.compatibilityFunction:null),(()=>this._updateItems())),sy((()=>this.source?.basemaps),"change",t,{onListenerAdd:t}),iy((()=>this.view),(()=>{this.source instanceof Xzt&&(this.source.viewType=this.view?.type)}),{once:!0})])}destroy(){const t=this.source.basemaps.find((t=>t===this.activeBasemap));t&&this.source.basemaps.remove(t),this.source?.destroy()}get activeBasemap(){return this.view?.map?.basemap??null}set activeBasemap(t){const e=this.view;if(!e?.map)return;const i="string"==typeof t?bA.fromId(t):t;if(!i||!e.ready)return e.map.basemap=i,void this._clearOverride("activeBasemap");const n=i.spatialReference||this.items?.find((t=>this.basemapEquals(i,t.basemap)))?.spatialReference;if(n&&"spatialReferenceLocked"in e&&!e.spatialReferenceLocked){const s=e.spatialReference;if(null!=n&&!Gu(s,n)&&!Gb(e.spatialReference,n)&&!Ib())return this._override("activeBasemap",i),this._loadingProjectionEngine=!0,void jb().then((()=>{this._get("activeBasemap")===t&&(e.map.basemap=t,e.spatialReference=n,this._clearOverride("activeBasemap"))}),(()=>{})).then((()=>{this._loadingProjectionEngine=!1}));e.map.basemap=i,this._clearOverride("activeBasemap"),null==n||Gu(e.spatialReference,n)||(e.spatialReference=n)}else e.map.basemap=i,this._clearOverride("activeBasemap")}get activeBasemapIndex(){const{state:t,activeBasemap:e}=this;return"ready"!==t?-1:this._findBasemapIndex(e)}get compatibilityFunction(){return"3d"===this.view?.type?$zt:zzt}set compatibilityFunction(t){this._overrideIfSome("compatibilityFunction",t)}castSource(t){return Array.isArray(t)||Vm.isCollection(t)?new Yzt({basemaps:Array.isArray(t)?new Vm(t):t}):eUt(t)?new Xzt({portal:t}):iUt(t)?new Xzt(t):nUt(t)?t:null}get state(){return this.view?.ready&&this.source?abt(this.view)&&!this.view.inGeographicLayout?"unsupported":this._loadingProjectionEngine?"loading":"ready":"disabled"}basemapEquals(t,e){return Bk(t,e)}refresh(){this._recreateItems()}load(){return this.loadSource()}loadSource(t){return this.addResolvingPromise($M.isLoadable(this.source)?this.source.load(t):null),Promise.resolve(this)}_findBasemapIndex(t){const{items:e}=this,i=e.findIndex((e=>e.basemap===t));return-1===i?e.findIndex((e=>this.basemapEquals(e.basemap,t))):i}_recreateItems(){const t=this.source?.basemaps??[],{view:e,compatibilityFunction:i}=this,n=new Map(this.items.map((t=>[t.basemap,t]))),s=t.map((t=>{const s=n.get(t);return s?(n.delete(t),s):new Wzt({basemap:t,compatibilityFunction:i,view:e})}));this.items.removeAll(),this.items.addMany(s),n.forEach((t=>t.destroy()))}_updateItems(){for(const t of this.items)t.compatibilityFunction=this.compatibilityFunction,t.view=this.view}};r([Je()],sUt.prototype,"_loadingProjectionEngine",void 0),r([Je()],sUt.prototype,"activeBasemap",null),r([Je({readOnly:!0})],sUt.prototype,"activeBasemapIndex",null),r([Je()],sUt.prototype,"compatibilityFunction",null),r([Je({readOnly:!0,type:tUt})],sUt.prototype,"items",void 0),r([Je()],sUt.prototype,"source",void 0),r([Ah("source")],sUt.prototype,"castSource",null),r([Je({readOnly:!0})],sUt.prototype,"state",null),r([Je()],sUt.prototype,"view",void 0),sUt=r([ln("esri.widgets.BasemapGallery.BasemapGalleryViewModel")],sUt);const rUt=sUt;const oUt="esri-basemap-gallery",aUt={base:oUt,sourceLoading:`${oUt}--source-loading`,layoutGrid:`${oUt}--grid`,narrowItems:`${oUt}--narrow-items`,loader:`${oUt}__loader`,item:`${oUt}__item`,itemContainer:`${oUt}__item-container`,itemContent:`${oUt}__item-content`,itemTitle:`${oUt}__item-title`,itemTagsContainer:`${oUt}__item-tags-container`,itemThumbnail:`${oUt}__item-thumbnail`,selectedItem:`${oUt}__item--selected`,itemError:`${oUt}__item--error`};const lUt={small:200,default:280,wide:420};let uUt=class extends A3{constructor(t,e){super(t,e),this.disabled=!1,this.headingLevel=2,this.messages=null,this.viewModel=new rUt,this._focusBasemapItemEnabled=!1,this._container=null,this._width=0,this._onContainerCreated=t=>{this._container=t}}initialize(){this.addHandles([ix((()=>this._container),(({contentRect:t})=>{this._width=t.width})),iy((()=>this.source),(()=>this.viewModel.loadSource()),{sync:!0,initial:!0})])}loadDependencies(){return o3({scrim:()=>import("./p-b4a3ac03.js"),chip:()=>import("./p-b8acd634.js")})}get activeBasemap(){return this.viewModel.activeBasemap}set activeBasemap(t){this.viewModel.activeBasemap=t}get icon(){return"basemap"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get source(){return this.viewModel.source}set source(t){this.viewModel.source=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t="loading"===this.source.state,e=this.disabled||"disabled"===this.viewModel.state,i={[aUt.sourceLoading]:t,[P3.disabled]:e},n=this._width;n<=lUt.small||n>=lUt.wide?i[aUt.layoutGrid]=!0:n<lUt.default&&(i[aUt.narrowItems]=!0);const s=this._getContext();return V3("div",{afterCreate:this._onContainerCreated,class:this.classes(aUt.base,P3.widget,P3.panel,i),key:"container",styles:{"--esri-basemap-gallery-small":`${lUt.small}px`}},0===this._width?null:s)}_getContext(){if("unsupported"===this.viewModel.state)return V3("div",{class:P3.empty,key:"empty-message"},V3(ZAt,{level:this.headingLevel},this.messages.unsupported));if("loading"===this.source.state)return V3("div",{class:aUt.loader,key:"loader"});const t=this.viewModel.items;return t.length>0?V3("ul",{"aria-disabled":this.disabled,"aria-label":this.label,bind:this,class:aUt.itemContainer,key:"item-container",onkeydown:this._handleKeyDown,role:"radiogroup"},t.map(((t,e)=>this._renderBasemapGalleryItem(t,e))).toArray()):V3("div",{class:P3.empty,key:"empty-message"},V3(ZAt,{level:this.headingLevel},this.messages.noBasemaps))}_getRoundRobinIndex(t,e){return(t+e)%e}_handleKeyDown(t){const{key:e}=t;if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e))return;t.preventDefault();const{items:i,activeBasemapIndex:n}=this.viewModel,s="ArrowUp"===e||"ArrowLeft"===e?this._getRoundRobinIndex(Math.max(n-1,-1),i.length):this._getRoundRobinIndex(n+1,i.length),r=i.at(s);"ready"===r?.state&&(this.viewModel.activeBasemap=r.basemap),this._focusBasemapItemEnabled=!0}_focusBasemapItem(t){this._focusBasemapItemEnabled&&0===t.tabIndex&&(t.focus(),this._focusBasemapItemEnabled=!1)}_handleClick(t){const e=t.currentTarget["data-item"];"ready"===e.state&&(this.viewModel.activeBasemap=e.basemap)}_renderBasemapGalleryItem(t,e){const i=rC(t.basemap)||ru("esri/themes/base/images/basemap-toggle-64.svg"),n=t.basemap.title,s=t.basemap.portalItem?.snippet,r=t.error?.message||s||n,{viewModel:{state:o,activeBasemapIndex:a}}=this,l=this.disabled||"disabled"===o,u=a===e,c=u||-1===a&&0===e?0:-1,h="loading"===o,d={[aUt.selectedItem]:u,[aUt.itemError]:"error"===t.state},f=`basemapgallery-item-${t.uid}`;return V3("li",{afterUpdate:this._focusBasemapItem,"aria-checked":u.toString(),"aria-disabled":l.toString(),"aria-labelledby":f,bind:this,class:this.classes(aUt.item,d),"data-item":t,key:t.uid,onclick:this._handleClick,onkeydown:this._handleClick,role:"radio",tabIndex:c,title:r},V3("img",{alt:"",class:aUt.itemThumbnail,src:i}),V3("div",{class:aUt.itemContent,key:"content"},V3("div",{class:aUt.itemTitle,key:"title"},V3("span",{id:f},n)),$k(t.basemap)?this._renderTags(t.basemap):null),"loading"===t.state||u&&h?V3("calcite-scrim",null,V3("span",{"aria-hidden":"true",class:P3.loaderAnimation,key:"loader",role:"presentation"})):null)}_renderTags(t){return V3("div",{class:aUt.itemTagsContainer,key:"tag"},this._render3DTag(),zk(t)?this._renderBetaTag():null)}_render3DTag(){const{messages:t}=this;return V3("calcite-chip",{key:"tag-3d",scale:"s",value:t.tag3D},this.messages.tag3D)}_renderBetaTag(){const{messages:t}=this;return V3("calcite-chip",{appearance:"outline-fill",key:"tag-beta",scale:"s",value:t.tagBeta},this.messages.tagBeta)}};r([Je()],uUt.prototype,"activeBasemap",null),r([Je()],uUt.prototype,"disabled",void 0),r([Je()],uUt.prototype,"headingLevel",void 0),r([Je()],uUt.prototype,"icon",null),r([Je()],uUt.prototype,"label",null),r([Je(),z3("esri/widgets/BasemapGallery/t9n/BasemapGallery")],uUt.prototype,"messages",void 0),r([Je()],uUt.prototype,"source",null),r([Je()],uUt.prototype,"view",null),r([Je()],uUt.prototype,"viewModel",void 0),r([Je()],uUt.prototype,"_focusBasemapItemEnabled",void 0),r([Je()],uUt.prototype,"_container",void 0),r([Je()],uUt.prototype,"_width",void 0),r([F3()],uUt.prototype,"_handleClick",null),uUt=r([ln("esri.widgets.BasemapGallery")],uUt);const cUt=uUt;const hUt="esri-identity-modal",dUt={base:hUt,info:`${hUt}__info`,notice:`${hUt}__notice`},fUt="ArcGIS Online";let pUt=class extends A3{constructor(t,e){super(t,e),this.container=document.createElement("div"),this.error=null,this.oAuthPrompt=!1,this.open=!1,this.signingIn=!1,this.server=null,this.resource=null,this._usernameInputNode=null,this._passwordInputNode=null,document.body.appendChild(this.container)}loadDependencies(){return o3({button:()=>import("./p-5b44be17.js"),dialog:()=>import("./p-466f29f0.js"),input:()=>import("./p-0949d63c.js"),label:()=>import("./p-6fa88b99.js"),notice:()=>import("./p-cebdc047.js")})}get title(){return this.commonMessages?.auth.signIn}render(){const{open:t,title:e,messages:i,signingIn:n,oAuthPrompt:s,server:r,resource:o,error:a}=this,{info:l,oAuthInfo:u,lblItem:c,invalidUser:h,noAuthService:d,lblUser:f,lblPwd:p,lblCancel:m,lblSigning:y,lblOk:g}=i;return V3("div",{class:this.classes(dUt.base,$0())},V3("form",{bind:this,onsubmit:this._submit},V3("calcite-dialog",{bind:this,heading:e,modal:!0,open:t,outsideCloseDisabled:!0,scale:"s",widthScale:"s",onCalciteDialogClose:this._cancel,onCalciteDialogOpen:this._focusUsernameInput},V3("div",{class:dUt.info},Xg(s?u:l,{server:r&&/\.arcgis\.com/i.test(r)?fUt:r,resource:`(${o||c})`})),a?V3("calcite-notice",{class:dUt.notice,icon:"exclamation-mark-triangle",kind:"danger",open:!0},V3("div",{slot:"message"},a.details?.httpStatus?h:d)):null,s?null:[V3("calcite-label",null,f,V3("calcite-input",{afterCreate:t=>this._usernameInputNode=t,autocomplete:"off",bind:this,name:"username",required:!0,spellcheck:!1,type:"text",value:""})),V3("calcite-label",null,p,V3("calcite-input",{afterCreate:t=>this._passwordInputNode=t,bind:this,name:"password",required:!0,type:"password",value:""}))],V3("calcite-button",{appearance:"outline",bind:this,onclick:this._cancel,slot:"footer-end",type:"button"},m),V3("calcite-button",{loading:!!n,slot:"footer-end",type:"submit"},n?y:g))))}_focusUsernameInput(){return hx((()=>this._usernameInputNode))}_cancel(){this._set("signingIn",!1),this.open=!1,this._usernameInputNode&&(this._usernameInputNode.value=""),this._passwordInputNode&&(this._passwordInputNode.value=""),this.emit("cancel")}_submit(t){t.preventDefault(),this._set("signingIn",!0);const e=this.oAuthPrompt?{}:{username:this._usernameInputNode?.value,password:this._passwordInputNode?.value};this.emit("submit",e)}};r([Je({readOnly:!0})],pUt.prototype,"container",void 0),r([Je(),z3("esri/t9n/common")],pUt.prototype,"commonMessages",void 0),r([Je()],pUt.prototype,"error",void 0),r([Je(),z3("esri/identity/t9n/identity")],pUt.prototype,"messages",void 0),r([Je()],pUt.prototype,"oAuthPrompt",void 0),r([Je()],pUt.prototype,"open",void 0),r([Je()],pUt.prototype,"signingIn",void 0),r([Je()],pUt.prototype,"server",void 0),r([Je({readOnly:!0})],pUt.prototype,"title",null),r([Je()],pUt.prototype,"resource",void 0),pUt=r([ln("esri.identity.IdentityModal")],pUt);const mUt=pUt;const yUt="esriJSAPIOAuth";class gUt{constructor(t,e){this.oAuthInfo=null,this.storage=null,this.appId=null,this.codeVerifier=null,this.expires=null,this.refreshToken=null,this.ssl=null,this.stateUID=null,this.token=null,this.userId=null,this.oAuthInfo=t,this.storage=e,this._init()}isValid(){let t=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)t=!0;else if(this.expires){const e=Date.now();if(this.expires>e){(this.expires-e)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}}return t}save(){if(!this.storage)return!1;const t=this._load(),e=this.oAuthInfo;if(e?.authNamespace&&e.portalUrl){let i=t[e.authNamespace];i||(i=t[e.authNamespace]={}),this.appId||(this.appId=e.appId),i[e.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem(yUt,JSON.stringify(t))}catch(t){return console.warn(t),!1}return!0}return!1}destroy(){const t=this._load(),e=this.oAuthInfo;if(e?.appId&&e?.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){const t=e.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",i=new FormData;if(i.append("f","json"),i.append("auth_token",this.refreshToken||this.token),i.append("client_id",e.appId),i.append("token_type_hint",this.refreshToken?"refresh_token":"access_token"),"function"==typeof navigator.sendBeacon)navigator.sendBeacon(t,i);else{const e=new XMLHttpRequest;e.open("POST",t),e.send(i)}}if(e?.authNamespace&&e.portalUrl&&this.storage){const i=t[e.authNamespace];if(i){delete i[e.portalUrl];try{this.storage.setItem(yUt,JSON.stringify(t))}catch(t){console.log(t)}}}e&&(e._oAuthCred=null,this.oAuthInfo=null)}_init(){const t=this._load(),e=this.oAuthInfo;if(e?.authNamespace&&e.portalUrl){let i=t[e.authNamespace];i&&(i=i[e.portalUrl],i&&(this.appId=i.appId,this.codeVerifier=i.codeVerifier,this.expires=i.expires,this.refreshToken=i.refreshToken,this.ssl=i.ssl,this.stateUID=i.stateUID,this.token=i.token,this.userId=i.userId))}}_load(){let t={};if(this.storage){const e=this.storage.getItem(yUt);if(e)try{t=JSON.parse(e)}catch(t){console.warn(t)}}return t}}gUt.prototype.declaredClass="esri.identity.OAuthCredential";var vUt;let wUt=vUt=class extends Io{constructor(t){super(t),this._oAuthCred=null,this.appId=null,this.authNamespace="/",this.expiration=20160,this.flowType="auto",this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl="oauth-callback.html",this.popupWindowFeatures="height=490,width=800,resizable,scrollbars,status",this.portalUrl="https://www.arcgis.com",this.preserveUrlHash=!1,this.userId=null}clone(){return vUt.fromJSON(this.toJSON())}};r([Je({json:{write:!0}})],wUt.prototype,"appId",void 0),r([Je({json:{write:!0}})],wUt.prototype,"authNamespace",void 0),r([Je({json:{write:!0}})],wUt.prototype,"expiration",void 0),r([Je({json:{write:!0}})],wUt.prototype,"flowType",void 0),r([Je({json:{write:!0}})],wUt.prototype,"forceLogin",void 0),r([Je({json:{write:!0}})],wUt.prototype,"forceUserId",void 0),r([Je({json:{write:!0}})],wUt.prototype,"locale",void 0),r([Je({json:{write:!0}})],wUt.prototype,"minTimeUntilExpiration",void 0),r([Je({json:{write:!0}})],wUt.prototype,"popup",void 0),r([Je({json:{write:!0}})],wUt.prototype,"popupCallbackUrl",void 0),r([Je({json:{write:!0}})],wUt.prototype,"popupWindowFeatures",void 0),r([Je({json:{write:!0}})],wUt.prototype,"portalUrl",void 0),r([Je({json:{write:!0}})],wUt.prototype,"preserveUrlHash",void 0),r([Je({json:{write:!0}})],wUt.prototype,"userId",void 0),wUt=vUt=r([ln("esri.identity.OAuthInfo")],wUt);const bUt=wUt;let SUt=class extends Io{constructor(t){super(t),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};r([Je({json:{write:!0}})],SUt.prototype,"adminTokenServiceUrl",void 0),r([Je({json:{write:!0}})],SUt.prototype,"currentVersion",void 0),r([Je({json:{write:!0}})],SUt.prototype,"hasPortal",void 0),r([Je({json:{write:!0}})],SUt.prototype,"hasServer",void 0),r([Je({json:{write:!0}})],SUt.prototype,"owningSystemUrl",void 0),r([Je({json:{write:!0}})],SUt.prototype,"owningTenant",void 0),r([Je({json:{write:!0}})],SUt.prototype,"server",void 0),r([Je({json:{write:!0}})],SUt.prototype,"shortLivedTokenValidity",void 0),r([Je({json:{write:!0}})],SUt.prototype,"tokenServiceUrl",void 0),r([Je({json:{write:!0}})],SUt.prototype,"webTierAuth",void 0),SUt=r([ln("esri.identity.ServerInfo")],SUt);const _Ut=SUt;const xUt={},MUt=t=>{const e=new ea(t.owningSystemUrl).host,i=new ea(t.server).host,n=/.+\.arcgis\.com$/i;return n.test(e)&&n.test(i)},TUt=(t,e)=>!!(MUt(t)&&e&&e.some((e=>e.test(t.server))));let AUt=null,IUt=null;try{AUt=window.localStorage,IUt=window.sessionStorage}catch{}class kUt extends Tm{constructor(){super(),this._portalConfig=globalThis.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this._defaultOAuthInfo=null,this._defaultTokenValidity=60,this.dialog=null,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appOrigin="null"!==window.origin?window.origin:window.location.origin,this._appUrlObj=ca(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthLocationParams=null,this._gwTokenUrl="/sharing/rest/generateToken",this._agsRest="/rest/services",this._agsPortal=/\/sharing(\/|$)/i,this._agsAdmin=/(https?:\/\/[^/]+\/[^/]+)\/admin\/?(\/.*)?$/i,this._adminSvcs=/\/rest\/admin\/services(\/|$)/i,this._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}],this._legacyFed=[],this._regexSDirUrl=/http.+\/rest\/services\/?/gi,this._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MissionServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer|VideoServer)).*/gi,this._gwUser=/http.+\/users\/([^/]+).*/i,this._gwItem=/http.+\/items\/([^/]+).*/i,this._gwGroup=/http.+\/groups\/([^/]+).*/i,this._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getPlatformSelfError=null,this._getOAuthLocationParams(),window.addEventListener("pageshow",(t=>{this._pageShowHandler(t)}))}registerServers(t){const e=this.serverInfos;e?(t=t.filter((t=>!this.findServerInfo(t.server))),this.serverInfos=e.concat(t)):this.serverInfos=t,t.forEach((t=>{t.owningSystemUrl&&this._portals.push(t.owningSystemUrl),t.hasPortal&&this._portals.push(t.server)}))}registerOAuthInfos(t){const e=this.oAuthInfos;if(e){for(const i of t){const t=this.findOAuthInfo(i.portalUrl);t&&e.splice(e.indexOf(t),1)}this.oAuthInfos=e.concat(t)}else this.oAuthInfos=t}registerToken(t){t={...t};const e=this._sanitizeUrl(t.server),i=this._isServerRsrc(e);let n,s=this.findServerInfo(e),r=!0;s||(s=new _Ut,s.server=this._getServerInstanceRoot(e),i?s.hasServer=!0:(s.tokenServiceUrl=this._getTokenSvcUrl(e),s.hasPortal=!0),this.registerServers([s])),n=this._findCredential(e),n?(delete t.server,Object.assign(n,t),r=!1):(n=new CUt({userId:t.userId,server:s.server??void 0,token:t.token,expires:t.expires,ssl:t.ssl,scope:i?"server":"portal"}),n.resources=[e],this.credentials.push(n)),n.emitTokenChange(!1),r||n.refreshServerTokens()}toJSON(){return it({serverInfos:this.serverInfos.map((t=>t.toJSON())),oAuthInfos:this.oAuthInfos.map((t=>t.toJSON())),credentials:this.credentials.map((t=>t.toJSON()))})}initialize(t){if(!t)return;"string"==typeof t&&(t=JSON.parse(t));const e=t.serverInfos,i=t.oAuthInfos,n=t.credentials;if(e){const t=[];e.forEach((e=>{e.server&&e.tokenServiceUrl&&t.push(e.declaredClass?e:new _Ut(e))})),t.length&&this.registerServers(t)}if(i){const t=[];i.forEach((e=>{e.appId&&t.push(e.declaredClass?e:new bUt(e))})),t.length&&this.registerOAuthInfos(t)}n&&n.forEach((t=>{t.server&&t.token&&t.expires&&t.expires>Date.now()&&((t=t.declaredClass?t:new CUt(t)).emitTokenChange(),this.credentials.push(t))}))}findServerInfo(t){let e;t=this._sanitizeUrl(t);for(const i of this.serverInfos)if(this._hasSameServerInstance(i.server,t)){e=i;break}return e}findOAuthInfo(t){let e;t=this._sanitizeUrl(t);for(const i of this.oAuthInfos)if(this._hasSameServerInstance(i.portalUrl,t)){e=i;break}return e}findCredential(t,e){if(!t)return;let i;t=this._sanitizeUrl(t);const n=this._isServerRsrc(t)?"server":"portal";if(e){for(const s of this.credentials)if(this._hasSameServerInstance(s.server,t)&&e===s.userId&&s.scope===n){i=s;break}}else for(const e of this.credentials)if(this._hasSameServerInstance(e.server,t)&&-1!==this._getIdenticalSvcIdx(t,e)&&e.scope===n){i=e;break}return i}getCredential(t,e){let i,n,s=!0;e&&(i=!!e.token,n=e.error,s=!1!==e.prompt),e={...e},t=this._sanitizeUrl(t);const r=new AbortController,o=zs();if(e.signal&&Is(e.signal,(()=>{r.abort()})),Is(r,(()=>{o.reject(new Ve("identity-manager:user-aborted","ABORTED"))})),Ms(r))return o.promise;e.signal=r.signal;const a=this._isAdminResource(t),l=i?this.findCredential(t):null;let u;if(l&&n&&n.details&&498===n.details.httpStatus)l.destroy();else if(l)return u=new Ve("identity-manager:not-authorized","You are currently signed in as: '"+l.userId+"'. You do not have access to this resource: "+t,{error:n}),o.reject(u),o.promise;const c=this._findCredential(t,e);if(c)return o.resolve(c),o.promise;let h=this.findServerInfo(t);if(h)!h.hasPortal&&h.server&&h.owningSystemUrl&&this._hasSameServerInstance(h.server,h.owningSystemUrl)&&(h.hasPortal=!0),!h.hasServer&&this._isServerRsrc(t)&&(h._restInfoPms=this._getTokenSvcUrl(t),h.hasServer=!0);else{const e=this._getTokenSvcUrl(t);if(!e)return u=new Ve("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),o.reject(u),o.promise;h=new _Ut,h.server=this._getServerInstanceRoot(t),"string"==typeof e?(h.tokenServiceUrl=e,h.hasPortal=!0):(h._restInfoPms=e,h.hasServer=!0),this.registerServers([h])}return h.hasPortal&&void 0===h._selfReq&&(s||Ma(h.tokenServiceUrl,this._appOrigin)||this._gwDomains.some((t=>t.tokenServiceUrl===h.tokenServiceUrl)))&&(h._selfReq={owningTenant:e?.owningTenant,selfDfd:this._getPortalSelf(h.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),t)}),this._enqueue(t,h,e,o,a)}getResourceName(t){return this._isRESTService(t)?t.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(t)&&t.replace(this._gwUser,"$1")||this._gwItem.test(t)&&t.replace(this._gwItem,"$1")||this._gwGroup.test(t)&&t.replace(this._gwGroup,"$1")||""}generateToken(t,e,i){const n=this._rePortalTokenSvc.test(t.tokenServiceUrl),s=new ea(this._appOrigin),r=t.shortLivedTokenValidity;let o,a,l,u,c,h,d,f;e&&(f=this.tokenValidity||r||this._defaultTokenValidity,f>r&&r>0&&(f=r)),i&&(o=i.isAdmin,a=i.serverUrl,l=i.token,h=i.signal,d=i.ssl,t.customParameters=i.customParameters),o?u=t.adminTokenServiceUrl:(u=t.tokenServiceUrl,c=new ea(u.toLowerCase()),t.webTierAuth&&i?.serverUrl&&!d&&"http"===s.scheme&&(Ma(s.uri,u,!0)||"https"===c.scheme&&s.host===c.host&&"7080"===s.port&&"7443"===c.port)&&(u=u.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));const p={query:{request:"getToken",username:e?.username,password:e?.password,serverUrl:a,token:l,expiration:f,referer:o||n?this._appOrigin:null,client:o?"referer":null,f:"json",...t.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(t,i),signal:h,...i?.ioArgs};n||(p.withCredentials=!1);return Pl(u,p).then((i=>{const n=i.data;if(!n?.token)return new Ve("identity-manager:authentication-failed","Unable to generate token");const s=t.server;return xUt[s]||(xUt[s]={}),e&&(xUt[s][e.username]=e.password),n.validity=f,n}))}isBusy(){return!!this._busy}async checkSignInStatus(t){return(await this.checkAppAccess(t,"")).credential}checkAppAccess(t,e,i){let n=!1;return this.getCredential(t,{prompt:!1}).then((s=>{let r;const o={f:"json"};if("portal"===s.scope)if(e&&(this._doPortalSignIn(t)||i?.force))r=s.server+"/sharing/rest/oauth2/validateAppAccess",o.client_id=e;else{if(!s.token)return{credential:s};r=s.server+"/sharing/rest"}else{if(!s.token)return{credential:s};r=s.server+"/rest/services"}return s.token&&(o.token=s.token),Pl(r,{query:o,authMode:"anonymous"}).then((t=>{if(!1===t.data.valid)throw new Ve("identity-manager:not-authorized",`You are currently signed in as: '${s.userId}'.`,t.data);return n=!!t.data.viewOnlyUserTypeApp,{credential:s}})).catch((t=>{if("identity-manager:not-authorized"===t.name)throw t;const e=t.details?.httpStatus;if(498===e)throw s.destroy(),new Ve("identity-manager:not-authenticated","User is not signed in.");if(400===e)throw new Ve("identity-manager:invalid-request");return{credential:s}}))})).then((t=>({credential:t.credential,viewOnly:n})))}setOAuthResponseHash(t){t&&("#"===t.charAt(0)&&(t=t.slice(1)),this._processOAuthPopupParams(ha(t)))}setOAuthRedirectionHandler(t){this._oAuthRedirectFunc=t}setProtocolErrorHandler(t){this._protocolFunc=t}signIn(t,e,i={}){const n=zs(),s=()=>{a?.remove(),l?.remove(),this.dialog?.destroy(),this.dialog=a=l=null},r=()=>{s(),this._oAuthDfd=null,n.reject(new Ve("identity-manager:user-aborted","ABORTED"))};i.signal&&Is(i.signal,(()=>{r()}));const o=new mUt({open:!0,resource:this.getResourceName(t),server:e.server});this.dialog=o,this.emit("dialog-create");let a=o.on("cancel",r),l=o.on("submit",(t=>{this.generateToken(e,t,{isAdmin:i.isAdmin,signal:i.signal}).then((r=>{s();const o=new CUt({userId:t.username,server:e.server??void 0,token:r.token,expires:null!=r.expires?Number(r.expires):null,ssl:!!r.ssl,isAdmin:i.isAdmin,validity:r.validity});n.resolve(o)})).catch((t=>{o.error=t,o.signingIn=!1}))}));return n.promise}oAuthSignIn(t,e,i,n){this._oAuthDfd=zs();const s=this._oAuthDfd;let r;n?.signal&&Is(n.signal,(()=>{const t=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;t&&!t.closed?t.close():this.dialog&&u()})),s.resUrl_=t,s.sinfo_=e,s.oinfo_=i;const o=i._oAuthCred;if(o.storage&&("authorization-code"===i.flowType||"auto"===i.flowType&&e.currentVersion>=8.4)){let t=crypto.getRandomValues(new Uint8Array(32));r=Pa(t),o.codeVerifier=r,t=crypto.getRandomValues(new Uint8Array(32)),o.stateUID=Pa(t),o.save()||(o.codeVerifier=r=null)}else o.codeVerifier=null;let a,l;this._getCodeChallenge(r).then((s=>{const r=!n||!1!==n.oAuthPopupConfirmation;if(!i.popup||!r)return void this._doOAuthSignIn(t,e,i,s);const o=new mUt({oAuthPrompt:!0,server:e.server,open:!0});this.dialog=o,this.emit("dialog-create"),a=o.on("cancel",u),l=o.on("submit",(()=>{c(),this._doOAuthSignIn(t,e,i,s)}))}));const u=()=>{c(),this._oAuthDfd=null,s.reject(new Ve("identity-manager:user-aborted","ABORTED"))},c=()=>{a?.remove(),l?.remove(),this.dialog?.destroy(),this.dialog=null};return s.promise}destroyCredentials(){if(this.credentials){this.credentials.slice().forEach((t=>{t.destroy()}))}this.emit("credentials-destroy")}enablePostMessageAuth(t="https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=vs(window,"message",(e=>{if((e.origin===this._appOrigin||e.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===e.data?.type){const i=e.source;this.getCredential(t).then((t=>{i.postMessage({type:"arcgis:auth:credential",credential:{expires:t.expires,server:t.server,ssl:t.ssl,token:t.token,userId:t.userId}},e.origin)})).catch((t=>{i.postMessage({type:"arcgis:auth:error",error:{name:t.name,message:t.message}},e.origin)}))}}))}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthLocationParams(){let t=window.location.hash;if(t){"#"===t.charAt(0)&&(t=t.slice(1));const e=ha(t);let i=!1;if(e.access_token&&e.expires_in&&e.state&&e.hasOwnProperty("username"))try{e.state=JSON.parse(e.state),e.state.portalUrl&&(this._oAuthLocationParams=e,i=!0)}catch{}else if(e.error&&e.error_description&&(console.log("IdentityManager OAuth Error: ",e.error," - ",e.error_description),"access_denied"===e.error&&(i=!0,e.state)))try{e.state=JSON.parse(e.state)}catch{}i&&(window.location.hash=e.state?.hash||"")}let e=window.location.search;if(e){"?"===e.charAt(0)&&(e=e.slice(1));const t=ha(e);let i=!1;if(t.code&&t.state)try{t.state=JSON.parse(t.state),t.state.portalUrl&&t.state.uid&&(this._oAuthLocationParams=t,i=!0)}catch{}else if(t.error&&t.error_description&&(console.log("IdentityManager OAuth Error: ",t.error," - ",t.error_description),"access_denied"===t.error&&(i=!0,t.state)))try{t.state=JSON.parse(t.state)}catch{}if(i){const e={...t};["code","error","error_description","message_code","persist","state"].forEach((t=>{delete e[t]}));const i=da(e),n=window.location.pathname+(i?`?${i}`:"")+(t.state?.hash||"");window.history.replaceState(window.history.state,"",n)}}}_getOAuthToken(t,e,i,n,s){return t=t.replace(/^http:/i,"https:"),Pl(`${t}/sharing/rest/oauth2/token`,{authMode:"anonymous",method:"post",query:n&&s?{grant_type:"authorization_code",code:e,redirect_uri:n,client_id:i,code_verifier:s}:{grant_type:"refresh_token",refresh_token:e,client_id:i}}).then((t=>t.data))}async _getCodeChallenge(t){if(t&&globalThis.isSecureContext){const e=(new TextEncoder).encode(t),i=await crypto.subtle.digest("SHA-256",e);return Pa(new Uint8Array(i))}return null}_pageShowHandler(t){if(t.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const t=new Ve("identity-manager:user-aborted","ABORTED");this._errbackFunc(t)}}_findCredential(t,e){let i,n,s,r,o=-1;const a=e?.token,l=e?.resource,u=this._isServerRsrc(t)?"server":"portal",c=this.credentials.filter((e=>this._hasSameServerInstance(e.server,t)&&e.scope===u));if(t=l||t,c.length)if(1===c.length){if(i=c[0],s=this.findServerInfo(i.server),n=s?.owningSystemUrl,r=n?this.findCredential(n,i.userId):void 0,o=this._getIdenticalSvcIdx(t,i),!a)return-1===o&&i.resources.push(t),this._addResource(t,r),i;-1!==o&&(i.resources.splice(o,1),this._removeResource(t,r))}else{let e,i;if(c.some((a=>(i=this._getIdenticalSvcIdx(t,a),-1!==i&&(e=a,s=this.findServerInfo(e.server),n=s?.owningSystemUrl,r=n?this.findCredential(n,e.userId):void 0,o=i,!0)))),a)e&&(e.resources.splice(o,1),this._removeResource(t,r));else if(e)return this._addResource(t,r),e}}_findOAuthInfo(t){let e=this.findOAuthInfo(t);if(!e)for(const i of this.oAuthInfos)if(this._isIdProvider(i.portalUrl,t)){e=i;break}return e}_addResource(t,e){e&&-1===this._getIdenticalSvcIdx(t,e)&&e.resources.push(t)}_removeResource(t,e){let i=-1;e&&(i=this._getIdenticalSvcIdx(t,e),i>-1&&e.resources.splice(i,1))}_useProxy(t,e){return e?.isAdmin&&!Ma(t.adminTokenServiceUrl,this._appOrigin)||!this._isPortalDomain(t.tokenServiceUrl)&&"10.1"===String(t.currentVersion)&&!Ma(t.tokenServiceUrl,this._appOrigin)}_getOrigin(t){const e=new ea(t);return e.scheme+"://"+e.host+(null!=e.port?":"+e.port:"")}_getServerInstanceRoot(t){const e=t.toLowerCase();let i=e.indexOf(this._agsRest);return-1===i&&this._isAdminResource(t)&&(i=this._agsAdmin.test(t)?t.replace(this._agsAdmin,"$1").length:t.search(this._adminSvcs)),-1!==i||zo(e)||(i=e.indexOf("/sharing")),-1===i&&e.endsWith("/")&&(i=e.length-1),i>-1?t.slice(0,i):t}_hasSameServerInstance(t,e){return t.endsWith("/")&&(t=t.slice(0,-1)),t=t.toLowerCase(),e=this._getServerInstanceRoot(e).toLowerCase(),t=Uo(t),e=Uo(e),(t=t.slice(Math.max(0,t.indexOf(":"))))===(e=e.slice(Math.max(0,e.indexOf(":"))))}_sanitizeUrl(t){const e=(St.request.proxyUrl||"").toLowerCase(),i=e?t.toLowerCase().indexOf(e+"?"):-1;return-1!==i&&(t=t.slice(i+e.length+1)),t=Ca(t),ca(t).path}_isRESTService(t){return t.includes(this._agsRest)}_isAdminResource(t){return this._agsAdmin.test(t)||this._adminSvcs.test(t)}_isServerRsrc(t){return this._isRESTService(t)||this._isAdminResource(t)}_isIdenticalService(t,e){let i=!1;if(this._isRESTService(t)&&this._isRESTService(e)){const n=this._getSuffix(t).toLowerCase(),s=this._getSuffix(e).toLowerCase();if(i=n===s,!i){const t=/(.*)\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi;i=n.replaceAll(t,"$1")===s.replaceAll(t,"$1")}}else this._isAdminResource(t)&&this._isAdminResource(e)?i=!0:this._isServerRsrc(t)||this._isServerRsrc(e)||!this._isPortalDomain(t)||(i=!0);return i}_isPortalDomain(t){const e=new ea(t.toLowerCase()),i=this._portalConfig;let n=this._gwDomains.some((t=>t.regex.test(e.uri)));return!n&&i&&(n=this._hasSameServerInstance(this._getServerInstanceRoot(i.restBaseUrl),e.uri)),n||St.portalUrl&&(n=Ma(e,St.portalUrl,!0)),n||(n=this._portals.some((t=>this._hasSameServerInstance(t,e.uri)))),n=n||this._agsPortal.test(e.path),n}_isIdProvider(t,e){let i=-1,n=-1;this._gwDomains.forEach(((s,r)=>{-1===i&&s.regex.test(t)&&(i=r),-1===n&&s.regex.test(e)&&(n=r)}));let s=!1;if(i>-1&&n>-1&&(0===i||4===i?0!==n&&4!==n||(s=!0):1===i?1!==n&&2!==n||(s=!0):2===i?2===n&&(s=!0):3===i&&3===n&&(s=!0)),!s){const i=this.findServerInfo(e),n=i?.owningSystemUrl;n&&MUt(i)&&this._isPortalDomain(n)&&this._isIdProvider(t,n)&&(s=!0)}return s}_getIdenticalSvcIdx(t,e){let i=-1;for(let n=0;n<e.resources.length;n++){const s=e.resources[n];if(this._isIdenticalService(t,s)){i=n;break}}return i}_getSuffix(t){return t.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")}_getTokenSvcUrl(t){let e,i,n;if(this._isRESTService(t)||this._isAdminResource(t)){const n=this._getServerInstanceRoot(t);return e=n+"/admin/generateToken",i=Pl(t=n+"/rest/info",{query:{f:"json"}}).then((t=>t.data)),{adminUrl:e,promise:i}}if(this._isPortalDomain(t)){let e="";if(this._gwDomains.some((i=>(i.regex.test(t)&&(e=i.tokenServiceUrl),!!e))),e||this._portals.some((i=>(this._hasSameServerInstance(i,t)&&(e=i+this._gwTokenUrl),!!e))),e||(n=t.toLowerCase().indexOf("/sharing"),-1!==n&&(e=t.slice(0,n)+this._gwTokenUrl)),e||(e=this._getOrigin(t)+this._gwTokenUrl),e){const i=new ea(t).port;/^http:\/\//i.test(t)&&"7080"===i&&(e=e.replace(/:7080/i,":7443")),e=e.replace(/http:/i,"https:")}return e}}_processOAuthResponseParams(t,e,i){const n=e._oAuthCred;if(t.code){const s=n.codeVerifier;return n.codeVerifier=null,n.stateUID=null,n.save(),this._getOAuthToken(i.server,t.code,e.appId,this._getRedirectURI(e,!0),s).then((s=>{const r=new CUt({userId:s.username,server:i.server??void 0,token:s.access_token,expires:Date.now()+1e3*s.expires_in,ssl:s.ssl,oAuthState:t.state,_oAuthCred:n});return e.userId=r.userId,n.storage=s.persist?AUt:IUt,n.refreshToken=s.refresh_token,n.token=null,n.expires=s.refresh_token_expires_in?Date.now()+1e3*s.refresh_token_expires_in:null,n.userId=r.userId,n.ssl=r.ssl,n.save(),r}))}const s=new CUt({userId:t.username,server:i.server??void 0,token:t.access_token,expires:Date.now()+1e3*Number(t.expires_in),ssl:"true"===t.ssl,oAuthState:t.state,_oAuthCred:n});return e.userId=s.userId,n.storage=t.persist?AUt:IUt,n.refreshToken=null,n.token=s.token,n.expires=s.expires,n.userId=s.userId,n.ssl=s.ssl,n.save(),Promise.resolve(s)}_processOAuthPopupParams(t){const e=this._oAuthDfd;if(this._oAuthDfd=null,e)if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle?.remove(),t.error){const i="access_denied"===t.error,n=new Ve(i?"identity-manager:user-aborted":"identity-manager:authentication-failed",i?"ABORTED":"OAuth: "+t.error+" - "+t.error_description);e.reject(n)}else this._processOAuthResponseParams(t,e.oinfo_,e.sinfo_).then((t=>{e.resolve(t)})).catch((t=>{e.reject(t)}))}_setOAuthResponseQueryString(t){t&&("?"===t.charAt(0)&&(t=t.slice(1)),this._processOAuthPopupParams(ha(t)))}async _exchangeToken(t,e,i){return(await Pl(`${t}/sharing/rest/oauth2/exchangeToken`,{authMode:"anonymous",method:"post",query:{f:"json",client_id:e,token:i}})).data.token}async _getPlatformSelf(t,e){if(this._getPlatformSelfError&&Date.now()-this._getPlatformSelfError[1]<1e3)throw this._getPlatformSelfError[0];t=t.replace(/^http:/i,"https:");try{const i=await Pl(`${t}/sharing/rest/oauth2/platformSelf`,{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":e,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json",expiration:30},withCredentials:!0});return this._getPlatformSelfError=null,i.data}catch(t){throw"OAUTH_0066"===t.details?.messageCode&&(this._getPlatformSelfError=[t,Date.now()]),t}}_getPortalSelf(t,e){let i;if(this._gwDomains.some((e=>(e.regex.test(t)&&(i=e.customBaseUrl),!!i))),i)return Promise.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:i,portalMode:"multitenant",supportsOAuth:!0});this._appOrigin.startsWith("https:")?t=t.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(e)&&(t=t.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return Pl(t,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then((t=>t.data))}_doPortalSignIn(t){const e=this._portalConfig,i=window.location.href,n=this.findServerInfo(t);return!(!e&&!this._isPortalDomain(i)||!(n?n.hasPortal||n.owningSystemUrl&&this._isPortalDomain(n.owningSystemUrl):this._isPortalDomain(t))||!(this._isIdProvider(i,t)||e&&(this._hasSameServerInstance(this._getServerInstanceRoot(e.restBaseUrl),t)||this._isIdProvider(e.restBaseUrl,t))||Ma(i,t,!0)))}_checkProtocol(t,e,i,n){let s=!0;const r=n?e.adminTokenServiceUrl:e.tokenServiceUrl;if(r.trim().toLowerCase().startsWith("https:")&&!this._appOrigin.startsWith("https:")&&wa(r)&&(s=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:t,serverInfo:e}),!s)){i(new Ve("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection."))}return s}_enqueue(t,e,i,n,s,r){return n||(n=zs()),n.resUrl_=t,n.sinfo_=e,n.options_=i,n.admin_=s,n.refresh_=r,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(t),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(n)):this._xoReqs.push(n):this._doSignIn(n),n.promise}_doSignIn(t){this._busy=t,this._rejectOnPersistedPageShow=!1;const e=e=>{const i=t.options_?.resource,n=t.resUrl_,s=t.refresh_;let r=!1;this.credentials.includes(e)||(s&&this.credentials.includes(s)?(s.userId=e.userId,s.token=e.token,s.expires=e.expires,s.validity=e.validity,s.ssl=e.ssl,s.creationTime=e.creationTime,r=!0,e=s):this.credentials.push(e)),e.resources||(e.resources=[]),e.resources.includes(i||n)||e.resources.push(i||n),e.scope=this._isServerRsrc(n)?"server":"portal",e.emitTokenChange();const o=this._soReqs,a={};this._soReqs=[],o.forEach((t=>{if(!this._isIdenticalService(n,t.resUrl_)){const i=this._getSuffix(t.resUrl_);a[i]||(a[i]=!0,e.resources.push(t.resUrl_))}})),t.resolve(e),o.forEach((t=>{this._hasSameServerInstance(this._getServerInstanceRoot(n),t.resUrl_)?t.resolve(e):this._soReqs.push(t)})),this._busy=t.resUrl_=t.sinfo_=t.refresh_=null,r||this.emit("credential-create",{credential:e}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},i=e=>{t.reject(e),this._busy=t.resUrl_=t.sinfo_=t.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},n=(s,r,o,a)=>{const l=t.sinfo_,u=!t.options_||!1!==t.options_.prompt,c=l.hasPortal&&this._findOAuthInfo(t.resUrl_);let h,d;if(s)e(new CUt({userId:s,server:l.server??void 0,token:o??void 0,expires:null!=a?Number(a):null,ssl:!!r}));else if(window!==window.parent&&this._appUrlObj.query?.["arcgis-auth-origin"]&&this._appUrlObj.query?.["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),t.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);const n=vs(window,"message",(t=>{t.source===window.parent&&t.data&&("arcgis:auth:credential"===t.data.type?(n.remove(),t.data.credential.expires<Date.now()?i(new Ve("identity-manager:credential-request-failed","Parent application's token has expired.")):e(new CUt(t.data.credential))):"arcgis:auth:error"===t.data.type&&(n.remove(),"tokenExpiredError"===t.data.error.name?i(new Ve("identity-manager:credential-request-failed","Parent application's token has expired.")):i(Ve.fromJSON(t.data.error))))}));Is(t.options_?.signal,(()=>{n.remove()}))}else if(c){let s=c._oAuthCred;if(!s){const t=new gUt(c,AUt),e=new gUt(c,IUt);t.isValid()&&e.isValid()?t.expires>e.expires?(s=t,e.destroy()):(s=e,t.destroy()):s=t.isValid()?t:e,c._oAuthCred=s}if(s.isValid()){h=new CUt({userId:s.userId??void 0,server:l.server??void 0,token:s.token??void 0,expires:s.expires,ssl:s.ssl??void 0,_oAuthCred:s});const r=c.appId!==s.appId&&this._doPortalSignIn(t.resUrl_);r||s.refreshToken?(t._pendingDfd=s.refreshToken?this._getOAuthToken(l.server,s.refreshToken,s.appId).then((t=>(h.expires=Date.now()+1e3*t.expires_in,h.token=t.access_token,h))):Promise.resolve(h),t._pendingDfd.then((t=>r?this._exchangeToken(t.server,c.appId,t.token).then((e=>(t.token=e,t))).catch((()=>t)):t)).then((t=>{e(t)})).catch((t=>{const e=t.details?.httpStatus;e>0&&404!==e?(s.destroy(),n()):i(t)}))):e(h)}else if(this._oAuthLocationParams&&this._hasSameServerInstance(c.portalUrl,this._oAuthLocationParams.state.portalUrl)&&(this._oAuthLocationParams.access_token||this._oAuthLocationParams.code&&this._oAuthLocationParams.state.uid===s.stateUID&&s.codeVerifier)){const n=this._oAuthLocationParams;this._oAuthLocationParams=null,t._pendingDfd=this._processOAuthResponseParams(n,c,l).then((t=>{e(t)})).catch(i)}else{const n=()=>{u?t._pendingDfd=this.oAuthSignIn(t.resUrl_,l,c,t.options_).then(e,i):(d=new Ve("identity-manager:not-authenticated","User is not signed in."),i(d))};this._doPortalSignIn(t.resUrl_)?t._pendingDfd=this._getPlatformSelf(l.server,c.appId).then((t=>{Ma(t.portalUrl,this._appOrigin,!0)?(h=new CUt({userId:t.username,server:l.server??void 0,expires:Date.now()+1e3*t.expires_in,token:t.token}),e(h)):n()})).catch(n):n()}}else if(u){if(this._checkProtocol(t.resUrl_,l,i,t.admin_)){let n=t.options_;t.admin_&&(n=n||{},n.isAdmin=!0),t._pendingDfd=this.signIn(t.resUrl_,l,n).then(e,i)}}else d=new Ve("identity-manager:not-authenticated","User is not signed in."),i(d)},s=()=>{const n=t.sinfo_,s=n.owningSystemUrl,r=t.options_;let o,a,l,u;if(r&&(o=r.token,a=r.error,l=r.prompt),u=this._findCredential(s,{token:o,resource:t.resUrl_}),!u)for(const t of this.credentials)if(this._isIdProvider(s,t.server)){u=t;break}if(u){const s=this.findCredential(t.resUrl_,u.userId);if(s)e(s);else if(TUt(n,this._legacyFed)){const t=u.toJSON();t.server=n.server,t.resources=null,e(new CUt(t))}else{(t._pendingDfd=this.generateToken(this.findServerInfo(u.server),null,{serverUrl:t.resUrl_,token:u.token,signal:t.options_.signal,ssl:u.ssl})).then((i=>{e(new CUt({userId:u?.userId,server:n.server??void 0,token:i.token,expires:null!=i.expires?Number(i.expires):null,ssl:!!i.ssl,isAdmin:t.admin_,validity:i.validity}))}),i)}}else{this._busy=null,o&&(t.options_.token=null);(t._pendingDfd=this.getCredential(s.replace(/\/?$/,"/sharing"),{resource:t.resUrl_,owningTenant:n.owningTenant,signal:t.options_.signal,token:o,error:a,prompt:l})).then((()=>{this._enqueue(t.resUrl_,t.sinfo_,t.options_,t,t.admin_)}),(e=>{t.resUrl_=t.sinfo_=t.refresh_=null,t.reject(e)}))}};this._errbackFunc=i;const r=t.sinfo_.owningSystemUrl,o=this._isServerRsrc(t.resUrl_),a=t.sinfo_._restInfoPms;a?a.promise.then((e=>{const i=t.sinfo_;if(i._restInfoPms){i.adminTokenServiceUrl=i._restInfoPms.adminUrl,i._restInfoPms=null,i.tokenServiceUrl=(yt("authInfo.tokenServicesUrl",e)||yt("authInfo.tokenServiceUrl",e)||yt("tokenServiceUrl",e))??null,i.shortLivedTokenValidity=yt("authInfo.shortLivedTokenValidity",e)??null,i.currentVersion=e.currentVersion,i.owningTenant=e.owningTenant;const t=i.owningSystemUrl=e.owningSystemUrl;t&&this._portals.push(t)}o&&i.owningSystemUrl?s():n()}),(()=>{t.sinfo_._restInfoPms=null;const e=new Ve("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");i(e)})):o&&r?s():t.sinfo_._selfReq?t.sinfo_._selfReq.selfDfd.then((e=>{const i={};let n,s,r,o;return e&&(n=e.user?.username,i.username=n,i.allSSL=e.allSSL,s=e.supportsOAuth,o=parseFloat(e.currentVersion),"multitenant"===e.portalMode&&(r=e.customBaseUrl),t.sinfo_.currentVersion=o),t.sinfo_.webTierAuth=!!n,n&&this.normalizeWebTierAuth?this.generateToken(t.sinfo_,null,{ssl:i.allSSL}).catch((()=>null)).then((t=>(i.portalToken=t?.token,i.tokenExpiration=t?.expires,i))):!n&&s&&o>=4.4&&!this._findOAuthInfo(t.resUrl_)?this._generateOAuthInfo({portalUrl:t.sinfo_.server,customBaseUrl:r,owningTenant:t.sinfo_._selfReq.owningTenant}).catch((()=>null)).then((()=>i)):i})).catch((()=>null)).then((e=>{t.sinfo_._selfReq=null,e?n(e.username,e.allSSL,e.portalToken,e.tokenExpiration):n()})):n()}_generateOAuthInfo(t){let e,i=null,n=t.portalUrl;const s=t.customBaseUrl,r=t.owningTenant,o=!this._defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(o){i=window.location.href;let t=i.indexOf("?");t>-1&&(i=i.slice(0,t)),t=i.search(/\/(apps|home)\//),i=t>-1?i.slice(0,t):null}return o&&i?(this._hasTestedIfAppIsOnPortal=!0,e=Pl(i+"/sharing/rest",{query:{f:"json"}}).then((()=>{this._defaultOAuthInfo=new bUt({appId:"arcgisonline",popupCallbackUrl:i+"/home/oauth-callback.html"})}))):e=Promise.resolve(),e.then((()=>{if(this._defaultOAuthInfo)return n=n.replace(/^http:/i,"https:"),Pl(n+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:r,client_id:this._defaultOAuthInfo.appId,redirect_uri:Ia(this._defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then((t=>{if(t.data.valid){const e=this._defaultOAuthInfo.clone();t.data.urlKey&&s?e.portalUrl="https://"+t.data.urlKey.toLowerCase()+"."+s:e.portalUrl=n,e.popup=window!==window.top||!(Ma(n,this._appOrigin)||this._gwDomains.some((t=>t.regex.test(n)&&t.regex.test(this._appOrigin)))),this.oAuthInfos.push(e)}}))}))}_doOAuthSignIn(t,e,i,n){const s=i._oAuthCred,r={portalUrl:i.portalUrl};!i.popup&&i.preserveUrlHash&&window.location.hash&&(r.hash=window.location.hash),s.stateUID&&(r.uid=s.stateUID);const o={client_id:i.appId,response_type:s.codeVerifier?"code":"token",state:JSON.stringify(r),expiration:i.expiration,locale:i.locale,redirect_uri:this._getRedirectURI(i,!!s.codeVerifier)};i.forceLogin&&(o.force_login=!0),i.forceUserId&&i.userId&&(o.prepopulatedusername=i.userId),!i.popup&&this._doPortalSignIn(t)&&(o.redirectToUserOrgUrl=!0),s.codeVerifier&&(o.code_challenge=n||s.codeVerifier,o.code_challenge_method=n?"S256":"plain");const a=i.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",l=a+"?"+da(o);if(i.popup){const t=window.open(l,"esriJSAPIOAuth",i.popupWindowFeatures);if(t)t.focus(),this._oAuthDfd.oAuthWin_=t,this._oAuthIntervalId=setInterval((()=>{if(t.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle.remove();const t=this._oAuthDfd;if(t){const e=new Ve("identity-manager:user-aborted","ABORTED");t.reject(e)}}}),500),this._oAuthOnPopupHandle=vs(window,["arcgis:auth:hash","arcgis:auth:location:search"],(t=>{"arcgis:auth:hash"===t.type?this.setOAuthResponseHash(t.detail):this._setOAuthResponseQueryString(t.detail)}));else{const t=new Ve("identity-manager:popup-blocked","ABORTED");this._oAuthDfd.reject(t)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:o,authorizeUrl:a,resourceUrl:t,serverInfo:e,oAuthInfo:i}):window.location.href=l}_getRedirectURI(t,e){const i=window.location.href.replace(/#.*$/,"");if(t.popup)return Ia(t.popupCallbackUrl);if(e){const t=ca(i);return t.query&&["code","error","error_description","message_code","persist","state"].forEach((e=>{delete t.query[e]})),dl(t.path,t.query)}return i}}kUt.prototype.declaredClass="esri.identity.IdentityManagerBase";let CUt=class extends Tm.EventedAccessor{constructor(t){super(t),this._oAuthCred=null,this.tokenRefreshBuffer=2,t?._oAuthCred&&(this._oAuthCred=t._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const t=Sl,e=t.findServerInfo(this.server),i=e?.owningSystemUrl,n=!!i&&"server"===this.scope,s=n&&TUt(e,t._legacyFed),r=e.webTierAuth,o=r&&t.normalizeWebTierAuth,a=xUt[this.server],l=a?.[this.userId];let u,c=this.resources&&this.resources[0],h=n?t.findServerInfo(i):null,d={username:this.userId,password:l};if(r&&!o)return;n&&!h&&t.serverInfos.some((e=>(t._isIdProvider(i,e.server)&&(h=e),!!h)));const f=h?t.findCredential(h.server,this.userId):null;if(!n||f){if(!s){if(n)u={serverUrl:c,token:f?.token,ssl:f?.ssl};else if(o)d=null,u={ssl:this.ssl};else{if(!l){let i;return c&&(c=t._sanitizeUrl(c),this._enqueued=1,i=t._enqueue(c,e,null,null,this.isAdmin,this),i.then((()=>{this._enqueued=0,this.refreshServerTokens()})).catch((()=>{this._enqueued=0}))),i}this.isAdmin&&(u={isAdmin:!0})}return t.generateToken(n?h:e,n?null:d,u).then((t=>{this.token=t.token,this.expires=null!=t.expires?Number(t.expires):null,this.creationTime=Date.now(),this.validity=t.validity,this.emitTokenChange(),this.refreshServerTokens()})).catch((()=>{}))}f?.refreshToken()}}refreshServerTokens(){if("portal"===this.scope){const t=Sl;t.credentials.forEach((e=>{const i=t.findServerInfo(e.server),n=i?.owningSystemUrl;e!==this&&e.userId===this.userId&&n&&"server"===e.scope&&(t._hasSameServerInstance(this.server,n)||t._isIdProvider(n,this.server))&&(TUt(i,t._legacyFed)?(e.token=this.token,e.expires=this.expires,e.creationTime=this.creationTime,e.validity=this.validity,e.emitTokenChange()):e.refreshToken())}))}}emitTokenChange(t){clearTimeout(this._refreshTimer);const e=Sl,i=this.server?e.findServerInfo(this.server):null,n=i?.owningSystemUrl,s=n?e.findServerInfo(n):null;!1===t||n&&"portal"!==this.scope&&(!s?.webTierAuth||e.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit("token-change")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const t=Sl,e=t.credentials.indexOf(this);e>-1&&t.credentials.splice(e,1),this.emitTokenChange(),this.emit("destroy")}toJSON(){const t=it({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),e=this.resources;return e&&e.length>0&&(t.resources=e.slice()),t}_startRefreshTimer(){clearTimeout(this._refreshTimer);const t=6e4*this.tokenRefreshBuffer,e=2**31-1;let i=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();i<0?i=0:i>e&&(i=e),this._refreshTimer=setTimeout(this.refreshToken.bind(this),i>t?i-t:i)}};r([Je()],CUt.prototype,"creationTime",void 0),r([Je()],CUt.prototype,"expires",void 0),r([Je()],CUt.prototype,"isAdmin",void 0),r([Je()],CUt.prototype,"oAuthState",void 0),r([Je()],CUt.prototype,"resources",void 0),r([Je()],CUt.prototype,"scope",void 0),r([Je()],CUt.prototype,"server",void 0),r([Je()],CUt.prototype,"ssl",void 0),r([Je()],CUt.prototype,"token",void 0),r([Je()],CUt.prototype,"tokenRefreshBuffer",void 0),r([Je()],CUt.prototype,"userId",void 0),r([Je()],CUt.prototype,"validity",void 0),CUt=r([ln("esri.identity.Credential")],CUt);class EUt extends kUt{}EUt.prototype.declaredClass="esri.identity.IdentityManager";const jUt=new EUt;xl(jUt);const OUt=Object.freeze({__proto__:null,default:jUt});const RUt="#mapDiv{height:100%;width:100%;flex-grow:3}#tableDiv{flex-grow:1}.table{height:100%;min-height:300px}#mapWrapper{display:flex;flex-direction:column;height:100%;width:100%}";const LUt=class{constructor(t){e(this,t);this.mapViewExtentChanged=i(this,"mapViewExtentChanged",7);this.mapSaved=i(this,"mapSaved",7);this.serviceAreaUrl="https://route-api.arcgis.com/arcgis/rest/services/World/ServiceAreas/NAServer/ServiceArea_World";this.mapId=null;this.features=null;this.center=[0,0];this.zoom=10;this.datasetIds=[];this.showLegend=true;this.showTable=true;this.showLayers=false;this.showSearch=true;this.showBasemaps=false;this.showServiceAreas=false;this.serviceAreaBreaks=[.07,.37,.75];this.travelMode=null;this.serviceAreaPoint=null;this.session=null;this.basemap="arcgis-topographic";this._item=null;this.datasetEls={}}async addFeatures(t){if(t){const e=await new Mpt({title:t.title,source:t.source,fields:t.fields,objectIdField:t.objectIdField,geometryType:t.geometryType});this.webMap.add(e)}}updateServiceArea(t){this.createServiceAreas(t)}async updateDatasets(t,e){console.debug("hub-compass-map: updateDatasets",{newDatasetIds:t,oldDatasetIds:e});t.forEach((t=>{if(e.includes(t)){console.debug("hub-compass-map: updateDatasets duplicate",{datasetId:t});return}console.debug("hub-compass-map: updateDatasets adding",{datasetId:t});this.addDatasetToMap(t)}))}async updateCenter(t){this.mapView.goTo({center:t,zoom:this.zoom});const e=this.createGraphic(this.mapView.center);this.mapView.graphics.addMany([e],0)}async updateZoom(t){this.mapView.goTo({center:this.center,zoom:t})}async saveMap(t="New webmap",e="Created by Hub AI assistant"){if(this._item===null){this._item={title:t,snippet:e,tags:["hub-radar-map"]}}console.debug("hub-compass-map: saveMap() start",{item:this._item});const i=await this.webMap.updateFrom(this.mapView);const n=await this.webMap.saveAs(this._item);const s={id:n.id,url:n.url};console.debug("hub-compass-map: saveMap() complete",{result:s,updateResult:i,saveResult:n});this._item.id=n.id;this.mapSaved.emit({item:this._item});return s}async addDatasetToMap(t){var e;const i=new Mpt({portalItem:{id:t}});this.webMap.add(i);await ry((()=>i.loadStatus==="loaded"));i.popupEnabled=true;(e=this.datasetEls)[t]||(e[t]={});this.datasetEls[t].layer=i;this.addTable(t,i);return true}componentWillLoad(){if(!!this.session){jUt.registerToken(this.session)}}componentDidLoad(){this.webMap=new Jmt({basemap:this.basemap});this.mapView=new G5({map:this.webMap,center:this.center,zoom:this.zoom,container:this.mapEl});this.mapView.popup.dockOptions={buttonEnabled:false,breakpoint:true};this.mapView.popup.defaultPopupTemplateEnabled=true;this.mapView.popup.dockEnabled=true;if(this.showSearch){const t=new Awt({view:this.mapView});this.mapView.ui.add(t,{position:"top-right"})}if(this.showLegend){const t=new vIt({view:this.mapView,layerInfos:[]});this.mapView.ui.add(new hzt({content:t,view:this.mapView,expanded:true,group:"top-right"}),"bottom-right")}if(this.showLayers){const t=new Rbt({view:this.mapView});this.mapView.ui.add(new hzt({content:t,view:this.mapView,group:"top-right"}),{position:"top-right"})}if(this.showBasemaps){this.mapView.ui.add([new hzt({content:new cUt({view:this.mapView}),view:this.mapView,expandIcon:"basemap",group:"top-right"})],{position:"top-right"})}this.mapView.when((()=>{const t=this.createGraphic(this.mapView.center);this.mapView.graphics.addMany([t],0)}));this.mapView.on("click",(t=>{if(this.showServiceAreas){this.createServiceAreas(t.mapPoint)}}));this.mapView.watch("extent",(()=>{let t=new wh({wkid:4326});const e=Ob(this.mapView.extent,t);const i=Ob(this.mapView.center,t);const n=this.mapView.zoom;this.mapViewExtentChanged.emit({extent:e,center:i,zoom:n})}));if(!!this.datasetIds&&this.datasetIds.length>0){this.datasetIds.forEach((t=>this.addDatasetToMap(t)))}}async filterTables(t){Object.keys(this.datasetEls).forEach((e=>{const i=this.datasetEls[e].table;i.filterGeometry=t}))}async addTable(t,e){console.debug("addTable: ",{datasetId:t,featureLayer:e,datasetEls:this.datasetEls});const i=new nzt({view:this.mapView,layer:e,visibleElements:{menuItems:{clearSelection:true,refreshData:true,toggleColumns:true,selectedRecordsShowAllToggle:true,zoomToSelection:true}},container:this.datasetEls[t].view});this.datasetEls[t].table=i}createServiceAreas(t){this.mapView.graphics.removeAll();const e=this.createGraphic(t);this.findServiceArea(e)}createGraphic(t){let e={type:"simple-marker",color:"white",size:8};const i=new OD({geometry:t,symbol:e});this.mapView.graphics.add(i);return i}async findServiceArea(t){if(!this.travelMode){const t=await zyt(this.serviceAreaUrl);console.debug("networkDescription.supportedTravelModes",{modes:t.supportedTravelModes});this.travelMode=t.supportedTravelModes.find((t=>t.name==="Walking Distance"))}console.debug("travelMode",this.travelMode);const e=new kyt({facilities:new Zat({features:[t]}),defaultBreaks:this.serviceAreaBreaks,travelMode:this.travelMode,travelDirection:"to-facility",outSpatialReference:this.mapView.spatialReference,trimOuterPolygon:true});const{serviceAreaPolygons:i}=await rgt(this.serviceAreaUrl,e);console.debug("hub-compass-map: findServiceArea",{geom:i.features[0]});this.filterTables(i.features[0].geometry);this.addServiceAreas(i)}addServiceAreas(t){const e=t.features.map((t=>{t.symbol={type:"simple-fill",color:`rgba(${Math.floor(Math.random()*200)}, 0, 0, 0.25)`};return t}));this.mapView.graphics.addMany(e,0)}render(){return n(s,null,n("slot",null),n("div",{id:"mapWrapper"},n("div",{ref:t=>this.mapEl=t,id:"mapDiv"}),n("div",{ref:t=>this.tableEl=t,id:"tableDiv"},this.showTable?this.renderTables(this.datasetIds):"")))}renderTables(t){return t.length>0&&n("calcite-tabs",{ref:t=>{this.tableTabsEl=t}},n("calcite-tab-nav",{slot:"title-group",ref:t=>{this.tableTabsNavEl=t}},t.map((t=>this.renderTableNav(t)))),t.map((t=>this.renderTableView(t))))}renderTableNav(t){var e;(e=this.datasetEls)[t]||(e[t]={});console.debug("renderTableNav: ",{datasetId:t,datasetEls:this.datasetEls});const i=n("calcite-tab-title",{selected:true,ref:e=>{this.datasetEls[t].nav=e}},"Table");return i}renderTableView(t){console.debug("renderTableView: ",{datasetId:t,datasetEls:this.datasetEls});const e=n("calcite-tab",null,n("div",{class:"table",ref:e=>{this.datasetEls[t].view=e}}));return e}static get watchers(){return{features:["addFeatures"],serviceAreaPoint:["updateServiceArea"],datasetIds:["updateDatasets"],center:["updateCenter"],zoom:["updateZoom"]}}};LUt.style=RUt;export{Yv as $,Zlt as A,Jlt as B,Wlt as C,Vlt as D,Od as E,C as F,MC as G,hU as H,Ea as I,Gb as J,St as K,XT as L,k as M,Ns as N,gt as O,Ts as P,Hb as Q,t1 as R,NT as S,wh as T,Pl as U,Qc as V,ml as W,V$ as X,cm as Y,NA as Z,Io as _,i4 as a,sm as a$,Kh as a0,gn as a1,FZ as a2,_s as a3,W9 as a4,Z9 as a5,J9 as a6,nt as a7,wG as a8,yb as a9,nA as aA,Jj as aB,Hu as aC,Zu as aD,Ku as aE,Vat as aF,qu as aG,om as aH,fI as aI,ett as aJ,ntt as aK,stt as aL,ftt as aM,_tt as aN,xtt as aO,gtt as aP,vtt as aQ,Stt as aR,ktt as aS,Ctt as aT,SZ as aU,qZ as aV,wZ as aW,bZ as aX,mI as aY,Zc as aZ,im as a_,Tn as aa,C$ as ab,ao as ac,ca as ad,Zat as ae,Cs as af,QW as ag,xf as ah,uw as ai,cw as aj,hw as ak,Mf as al,WI as am,tw as an,Qv as ao,Kv as ap,ZI as aq,AI as ar,uk as as,eut as at,Xlt as au,zs as av,rA as aw,Da as ax,LG as ay,Vm as az,uT as b,ebt as b$,nm as b0,em as b1,ON as b2,jN as b3,Vf as b4,Nn as b5,um as b6,yh as b7,ee as b8,Oo as b9,d1 as bA,_bt as bB,Tm as bC,dy as bD,sy as bE,$wt as bF,dC as bG,VD as bH,Lwt as bI,tbt as bJ,o3 as bK,V3 as bL,P3 as bM,hx as bN,Ebt as bO,obt as bP,z3 as bQ,gwt as bR,A3 as bS,hbt as bT,zR as bU,GR as bV,HR as bW,cbt as bX,Ne as bY,Ah as bZ,Nwt as b_,wg as ba,z$ as bb,N$ as bc,P$ as bd,Dh as be,$h as bf,Ph as bg,Rb as bh,qb as bi,sc as bj,Np as bk,tm as bl,eh as bm,rc as bn,M2 as bo,P2 as bp,d2 as bq,t3 as br,k1 as bs,S1 as bt,E1 as bu,L1 as bv,T2 as bw,f1 as bx,J2 as by,H2 as bz,m as c,WB as c$,mn as c0,qp as c1,Kp as c2,Dd as c3,TQ as c4,PK as c5,JK as c6,XK as c7,mQ as c8,$K as c9,hst as cA,snt as cB,Ont as cC,Tnt as cD,At as cE,ynt as cF,pnt as cG,mnt as cH,dnt as cI,gnt as cJ,vnt as cK,QA as cL,_nt as cM,Mnt as cN,eet as cO,qit as cP,Fet as cQ,nnt as cR,ant as cS,ont as cT,fnt as cU,XA as cV,sK as cW,Se as cX,vs as cY,BB as cZ,ZB as c_,U as ca,V as cb,H as cc,g as cd,SQ as ce,yQ as cf,tQ as cg,qK as ch,WK as ci,iQ as cj,KK as ck,VK as cl,fQ as cm,In as cn,ZK as co,YK as cp,pQ as cq,K as cr,wQ as cs,qet as ct,Het as cu,Fnt as cv,rnt as cw,Ent as cx,Vit as cy,Qit as cz,aU as d,Xm as d$,JB as d0,uG as d1,LK as d2,RK as d3,Int as d4,iK as d5,eK as d6,Kit as d7,GK as d8,As as d9,UU as dA,vI as dB,GQ as dC,NY as dD,vK as dE,wK as dF,PY as dG,gK as dH,VY as dI,qY as dJ,HY as dK,WY as dL,$Y as dM,An as dN,NK as dO,FK as dP,dM as dQ,M0 as dR,ir as dS,kn as dT,aK as dU,HK as dV,ul as dW,wf as dX,Sn as dY,SS as dZ,Cn as d_,_Q as da,Is as db,Ss as dc,KY as dd,BK as de,MQ as df,tK as dg,OW as dh,Es as di,HQ as dj,MY as dk,TY as dl,ks as dm,oK as dn,rK as dp,uq as dq,zK as dr,mK as ds,yK as dt,UK as du,XW as dv,VV as dw,BV as dx,UV as dy,zV as dz,OD as e,TV as e$,Yc as e0,Uh as e1,EG as e2,Pc as e3,dgt as e4,Cb as e5,Ob as e6,qV as e7,eB as e8,NB as e9,tB as eA,SV as eB,vY as eC,af as eD,of as eE,Bf as eF,Kd as eG,ip as eH,YJ as eI,gp as eJ,FG as eK,Vu as eL,Y7 as eM,js as eN,o7 as eO,a7 as eP,r7 as eQ,ZQ as eR,pX as eS,km as eT,oi as eU,Pbt as eV,AY as eW,vW as eX,RV as eY,$V as eZ,GB as e_,hB as ea,kB as eb,Sq as ec,GV as ed,$U as ee,PG as ef,o as eg,UY as eh,BY as ei,VQ as ej,xY as ek,vM as el,eI as em,Y3 as en,dZ as eo,KW as ep,_m as eq,iy as er,MV as es,nI as et,tV as eu,iB as ev,bV as ew,YG as ex,yV as ey,dV as ez,r4 as f,vp as f$,HB as f0,PV as f1,kZ as f2,JQ as f3,YQ as f4,iX as f5,lK as f6,uK as f7,cK as f8,hK as f9,Sit as fA,Pet as fB,GY as fC,xnt as fD,_Y as fE,pK as fF,fK as fG,SY as fH,YB as fI,wB as fJ,Pt as fK,TB as fL,DK as fM,eQ as fN,QK as fO,vQ as fP,Bs as fQ,lQ as fR,aQ as fS,$d as fT,oit as fU,eit as fV,zd as fW,iit as fX,Zd as fY,knt as fZ,vit as f_,ZY as fa,bf as fb,YY as fc,fq as fd,mq as fe,JY as ff,yX as fg,rX as fh,oX as fi,aX as fj,lX as fk,c as fl,eX as fm,FY as fn,DY as fo,OK as fp,tX as fq,uX as fr,nK as fs,tI as ft,A0 as fu,i9 as fv,gY as fw,RA as fx,git as fy,Net as fz,rm as g,hd as g$,uit as g0,Ait as g1,$et as g2,Iit as g3,kit as g4,wp as g5,uf as g6,qd as g7,Td as g8,Cit as g9,$g as gA,Dg as gB,Uj as gC,Jg as gD,edt as gE,WC as gF,dK as gG,ort as gH,zY as gI,yt as gJ,LV as gK,QY as gL,Hd as gM,gQ as gN,IY as gO,kY as gP,RY as gQ,LY as gR,CY as gS,EY as gT,jY as gU,OY as gV,gw as gW,fw as gX,dw as gY,Kt as gZ,PX as g_,pf as ga,nP as gb,EV as gc,cnt as gd,hnt as ge,int as gf,bnt as gg,Dit as gh,Ket as gi,Uet as gj,Bet as gk,Get as gl,cit as gm,Fit as gn,zit as go,Qet as gp,oP as gq,Wf as gr,e7 as gs,lnt as gt,unt as gu,og as gv,ag as gw,FE as gx,OE as gy,Gj as gz,y as h,sCt as h$,Ad as h0,Xh as h1,td as h2,rg as h3,G7 as h4,Mt as h5,Jy as h6,Ao as h7,yG as h8,Qd as h9,Fpt as hA,q7 as hB,V7 as hC,Tt as hD,zf as hE,lU as hF,el as hG,YT as hH,Sl as hI,D4 as hJ,rpt as hK,BMt as hL,ZMt as hM,P_t as hN,p as hO,Nt as hP,Mct as hQ,iCt as hR,rx as hS,sx as hT,KIt as hU,XIt as hV,QIt as hW,nx as hX,ywt as hY,ZAt as hZ,nCt as h_,pG as ha,mG as hb,we as hc,ru as hd,oy as he,t4 as hf,QT as hg,yU as hh,Vk as hi,Gk as hj,B4 as hk,V4 as hl,ba as hm,K5 as hn,qk as ho,X0 as hp,Ls as hq,Os as hr,fl as hs,Dpt as ht,bG as hu,vG as hv,umt as hw,ko as hx,hmt as hy,Zpt as hz,X5 as i,Sh as i$,jR as i0,OO as i1,aCt as i2,Lkt as i3,GCt as i4,Ict as i5,pCt as i6,wCt as i7,mCt as i8,hCt as i9,TCt as iA,ACt as iB,RCt as iC,BCt as iD,$Ct as iE,JCt as iF,YCt as iG,dbt as iH,Lb as iI,Q3 as iJ,sD as iK,ggt as iL,hy as iM,zh as iN,yMt as iO,CC as iP,_gt as iQ,Owt as iR,jwt as iS,dr as iT,h$ as iU,ce as iV,RD as iW,EW as iX,NW as iY,FH as iZ,BW as i_,cCt as ia,rCt as ib,zO as ic,ECt as id,Xg as ie,Yz as ig,D0 as ih,FCt as ii,PCt as ij,Mpt as ik,MO as il,pR as im,_R as io,NO as ip,KCt as iq,lEt as ir,QCt as is,zpt as it,Upt as iu,q3 as iv,apt as iw,LCt as ix,NCt as iy,zCt as iz,Gu as j,ZU as j$,wX as j0,AM as j1,jK as j2,fy as j3,fX as j4,_X as j5,xX as j6,abt as j7,Mgt as j8,jM as j9,Bbt as jA,_j as jB,rj as jC,uj as jD,aj as jE,cj as jF,KE as jG,uO as jH,hX as jI,XE as jJ,vt as jK,gC as jL,Hf as jM,fS as jN,tL as jO,Vrt as jP,Jst as jQ,IM as jR,tSt as jS,Ib as jT,jb as jU,Pb as jV,pu as jW,du as jX,hu as jY,vu as jZ,Tu as j_,Agt as ja,hgt as jb,Hbt as jc,Gbt as jd,ZC as je,Xp as jf,lD as jg,YE as jh,PE as ji,Fs as jj,Jd as jk,bl as jl,dj as jm,JE as jn,Wv as jo,K8 as jp,Lbt as jq,DL as jr,bY as js,Pst as jt,ipt as ju,yft as jv,uut as jw,If as jx,mut as jy,QE as jz,Vb as k,Us as k$,cV as k0,dX as k1,de as k2,sQ as k3,ha as k4,da as k5,RN as k6,dl as k7,hN as k8,LN as k9,MW as kA,Y as kB,cq as kC,srt as kD,Aet as kE,xet as kF,Tet as kG,Fq as kH,hs as kI,b as kJ,HJ as kK,v as kL,Blt as kM,Dft as kN,Cut as kO,FC as kP,Ypt as kQ,Ipt as kR,Bpt as kS,Sa as kT,Xat as kU,dft as kV,Sft as kW,Y5 as kX,En as kY,qC as kZ,ict as k_,bp as ka,gN as kb,Ybt as kc,ad as kd,wd as ke,qf as kf,NV as kg,FV as kh,my as ki,pyt as kj,gD as kk,fyt as kl,Gyt as km,Vyt as kn,hyt as ko,qyt as kp,ayt as kq,dyt as kr,uyt as ks,Hyt as kt,cyt as ku,Tyt as kv,vyt as kw,Wyt as kx,lyt as ky,B7 as kz,s4 as l,Wu as l$,Q as l0,bIt as l1,cr as l2,Ms as l3,uS as l4,TN as l5,zN as l6,tp as l7,Fh as l8,Km as l9,qj as lA,Bj as lB,Dnt as lC,Dp as lD,rf as lE,kN as lF,JH as lG,xs as lH,sp as lI,pZ as lJ,Tf as lK,$Z as lL,eZ as lM,tZ as lN,vf as lO,J as lP,YV as lQ,Df as lR,jV as lS,ub as lT,Yu as lU,tc as lV,ic as lW,Oh as lX,Lf as lY,SI as lZ,gZ as l_,np as la,ixt as lb,MSt as lc,qSt as ld,WSt as le,ZSt as lf,PSt as lg,rxt as lh,ket as li,HSt as lj,TSt as lk,Snt as ll,est as lm,nc as ln,yC as lo,Dst as lp,Fst as lq,Hj as lr,kMt as ls,BE as lt,Tj as lu,lg as lv,Mj as lw,EN as lx,a$ as ly,Vj as lz,Co as m,j8 as m$,CI as m0,jI as m1,IZ as m2,uc as m3,cc as m4,hc as m5,dc as m6,Xu as m7,ec as m8,MI as m9,Gy as mA,rrt as mB,nrt as mC,rs as mD,hY as mE,Ia as mF,$ as mG,CZ as mH,aw as mI,oZ as mJ,VZ as mK,HZ as mL,ZV as mM,Ttt as mN,bw as mO,Qu as mP,Ftt as mQ,TU as mR,lZ as mS,zZ as mT,fZ as mU,aZ as mV,iZ as mW,uZ as mX,mc as mY,Xv as mZ,k7 as m_,Sw as ma,Xw as mb,tb as mc,vw as md,PI as me,xI as mf,ww as mg,Ub as mh,_ut as mi,Qm as mj,vr as mk,Sr as ml,br as mm,_r as mn,wr as mo,O as mp,P as mq,Kf as mr,Qj as ms,Xj as mt,lO as mu,Pf as mv,Tr as mw,Ry as mx,Lo as my,wc as mz,jt as n,kl as n$,mb as n0,lSt as n1,Met as n2,sSt as n3,nSt as n4,iSt as n5,a8 as n6,l8 as n7,eSt as n8,$f as n9,ytt as nA,Sf as nB,ek as nC,sI as nD,f as nE,h as nF,d as nG,CN as nH,vN as nI,MN as nJ,xN as nK,Lt as nL,bQ as nM,Jtt as nN,gpt as nO,Utt as nP,ztt as nQ,lw as nR,Ytt as nS,Qf as nT,PN as nU,_I as nV,EI as nW,JU as nX,nQ as nY,Ra as nZ,La as n_,yZ as na,Af as nb,$tt as nc,DI as nd,Ud as ne,xZ as nf,mZ as ng,G as nh,q as ni,wi as nj,wn as nk,vn as nl,Ha as nm,Ma as nn,Ja as no,oU as np,Qp as nq,es as nr,dN as ns,znt as nt,S as nu,yr as nv,M as nw,KI as nx,ck as ny,jB as nz,$4 as o,aC as o$,AN as o0,IN as o1,dk as o2,hk as o3,Fft as o4,lS as o5,rct as o6,opt as o7,$rt as o8,tct as o9,hct as oA,Drt as oB,$n as oC,$ht as oD,sut as oE,bft as oF,Vft as oG,Rct as oH,rht as oI,Gct as oJ,spt as oK,Uo as oL,Jft as oM,Mo as oN,hm as oO,gm as oP,Ut as oQ,Nb as oR,aft as oS,WE as oT,fg as oU,Xut as oV,Wft as oW,sL as oX,HF as oY,RC as oZ,jC as o_,Yft as oa,UM as ob,_L as oc,Glt as od,Qat as oe,zM as of,uct as og,nct as oh,sct as oi,cct as oj,cU as ok,uU as ol,fU as om,pU as on,nh as oo,wT as op,bT as oq,act as or,vut as os,qE as ot,pct as ou,$at as ov,Mdt as ow,Xft as ox,ect as oy,dct as oz,Je as p,_f as p$,pA as p0,m4 as p1,Me as p2,P9 as p3,ph as p4,fh as p5,mh as p6,Vt as p7,G9 as p8,v8 as p9,kt as pA,Bn as pB,By as pC,$lt as pD,Ult as pE,gut as pF,Pdt as pG,wft as pH,Bft as pI,Gft as pJ,jn as pK,yN as pL,qbt as pM,T5 as pN,e4 as pO,Tht as pP,Bt as pQ,yD as pR,f$ as pS,fht as pT,ght as pU,Zbt as pV,hD as pW,Zf as pX,op as pY,ap as pZ,_B as p_,G8 as pa,X_t as pb,k9 as pc,txt as pd,h9 as pe,P7 as pf,T7 as pg,Frt as ph,o8 as pi,mrt as pj,dU as pk,Yy as pl,Ju as pm,Xb as pn,gT as po,Ye as pp,vT as pq,CT as pr,Un as ps,Oa as pt,xT as pu,De as pv,MT as pw,Qdt as px,za as py,ET as pz,ln as q,Ect as q$,fC as q0,Ua as q1,wa as q2,pa as q3,bs as q4,ea as q5,il as q6,Ca as q7,Va as q8,vD as q9,$A as qA,OX as qB,lN as qC,uN as qD,aN as qE,mN as qF,fN as qG,ka as qH,tl as qI,Rs as qJ,JI as qK,HI as qL,vZ as qM,qI as qN,pn as qO,NN as qP,iht as qQ,xi as qR,jet as qS,_St as qT,U_t as qU,S8 as qV,Vct as qW,Jct as qX,Qut as qY,i7 as qZ,t7 as q_,wD as qa,bD as qb,xyt as qc,egt as qd,Fyt as qe,$yt as qf,zyt as qg,Dyt as qh,Zyt as qi,Syt as qj,byt as qk,wyt as ql,Ymt as qm,Xmt as qn,eyt as qo,myt as qp,gyt as qq,Qmt as qr,iyt as qs,syt as qt,Hrt as qu,k4 as qv,tht as qw,sht as qx,qht as qy,Ldt as qz,r,pB as r$,Oct as r0,Nct as r1,Pct as r2,Zct as r3,Fct as r4,Dct as r5,$ct as r6,zct as r7,Uct as r8,Bct as r9,R as rA,bxt as rB,tt as rC,X as rD,et as rE,Na as rF,$I as rG,OI as rH,nB as rI,SB as rJ,aL as rK,cu as rL,lu as rM,Su as rN,Yg as rO,oh as rP,Kc as rQ,Hc as rR,cG as rS,VB as rT,tf as rU,ef as rV,dB as rW,yB as rX,bB as rY,mB as rZ,DZ as r_,er as ra,B as rb,nl as rc,la as rd,oc as re,$o as rf,TT as rg,Ol as rh,Pht as ri,wI as rj,vC as rk,nZ as rl,lct as rm,mU as rn,_o as ro,Nu as rp,yc as rq,Gs as rr,Vs as rs,Ml as rt,a as ru,xe as rv,_e as rw,Fdt as rx,GZ as ry,_q as rz,Ve as s,Tpt as s$,TIt as s0,kIt as s1,pm as s2,CB as s3,KU as s4,IIt as s5,xIt as s6,ih as s7,nM as s8,uh as s9,MIt as sA,qh as sB,gc as sC,sh as sD,OIt as sE,_z as sF,Lr as sG,fB as sH,BU as sI,OB as sJ,RB as sK,sf as sL,KH as sM,s7 as sN,oI as sO,lB as sP,uB as sQ,OZ as sR,Eet as sS,YU as sT,Iz as sU,LUt as sV,cb as sW,rS as sX,f0 as sY,C9 as sZ,kct as s_,WIt as sa,LIt as sb,AIt as sc,PIt as sd,zIt as se,NIt as sf,FIt as sg,UIt as sh,DIt as si,BIt as sj,$It as sk,GIt as sl,VIt as sm,qIt as sn,_It as so,RIt as sp,Dc as sq,$c as sr,ex as ss,Fc as st,hr as su,z0 as sv,iI as sw,EIt as sx,CIt as sy,jIt as sz,$M as t,n4 as u,$s as v,ey as w,u as x,Xct as y,Uat as z};
//# sourceMappingURL=p-aad64c9f.js.map